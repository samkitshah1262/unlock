[
  {
    "id": "ai-reinforcement-finetuning-decision-making-flowchart-1",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "When Should You Use SFT vs. RFT?",
    "title": "Decision-Making Flowchart",
    "order": 1,
    "orderInChapter": 1,
    "contentHtml": "<ul>\n  <li>The following flowchart from Predibase (<a href=\"https://predibase.com/blog/how-reinforcement-learning-beats-supervised-fine-tuning-when-data-is-scarce\">source</a>) shows a summary diagram of typical conditions where RFT is a more appropriate fine-tuning strategy than SFT.</li>\n</ul>\n<p><img src=\"/primers/ai/assets/RFT/WhenToUseRFT.webp\" alt=\"\"></p>",
    "contentMarkdown": "*   The following flowchart from Predibase ([source](https://predibase.com/blog/how-reinforcement-learning-beats-supervised-fine-tuning-when-data-is-scarce)) shows a summary diagram of typical conditions where RFT is a more appropriate fine-tuning strategy than SFT.\n\n![](/primers/ai/assets/RFT/WhenToUseRFT.webp)",
    "contentLength": 362,
    "wordCount": 25,
    "hasCode": false,
    "hasMath": false,
    "hasImages": true,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#decision-making-flowchart"
  },
  {
    "id": "ai-reinforcement-finetuning-absence-of-labeled-data-but-availability-of-verifi-2",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "When Should You Use SFT vs. RFT?",
    "title": "Absence of Labeled Data but Availability of Verifiable Feedback",
    "order": 2,
    "orderInChapter": 2,
    "contentHtml": "<ul>\n  <li>\n    <p>One of the most compelling advantages of RFT is that it removes the dependency on traditional labeled datasets. Rather than requiring a fixed set of input-output pairs to train from, RFT allows models to learn by exploring various outputs and receiving scalar rewards based on how correct or useful those outputs are.</p>\n  </li>\n  <li>\n    <p>What makes this powerful is that correctness doesn’t need to be determined by a human annotator—it can be algorithmically verified. This expands the applicability of RFT to domains where labeled data is scarce or even infeasible to produce. If the success criteria for a task can be expressed in the form of programmatic tests, validators, or logic-based constraints, then reward functions can substitute for explicit labels.</p>\n  </li>\n  <li>\n    <p>In the simplest case—when labeled data does exist—reward evaluation can fall back to exact match comparison. However, RFT is far more general. It can be applied in tasks where output quality is determined by downstream behavior, execution results, logical validity, or compliance with rules rather than fixed answers. This makes RFT especially valuable in real-world applications where ground-truth labels are not always well-defined.</p>\n  </li>\n  <li>\n    <p>A classic example is code transpilation, where a model converts code from one language (e.g., Java) into another (e.g., Python). You may not have a labeled Python equivalent for every Java function, but you can still define success as “produces the correct output for all test cases.” Even when there are multiple valid solutions, a programmatic test suite can confirm functional correctness.</p>\n  </li>\n  <li>\n    <p>Similarly, RFT enables learning in domains that are inherently simulation-driven or verification-bound:</p>\n\n    <ul>\n      <li>\n        <p><strong>Game-playing agents</strong>: The model’s success can be measured through well-defined metrics like win/loss, number of moves, or score improvements. No annotated dataset is needed—just the game logic and outcome tracking.</p>\n      </li>\n      <li>\n        <p><strong>Mathematical proofs or symbolic computation</strong>: Solvers can validate the correctness of a derived expression or equation, enabling the model to learn without step-by-step labeled traces.</p>\n      </li>\n      <li>\n        <p><strong>Scientific simulations and physics modeling</strong>: Outputs can be evaluated based on adherence to conservation laws, threshold tolerances, or stability criteria.</p>\n      </li>\n      <li>\n        <p><strong>Data transformations and conversions</strong>: Whether converting file formats or normalizing structured records, programmatic validators can confirm whether the output meets format specifications or integrity rules.</p>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>These reward-based learning setups enable RFT to scale in task domains where traditional annotation is prohibitively expensive, time-consuming, or ambiguous. As long as the outputs can be verified—by logic, by simulation, or by test execution—the model can learn autonomously. This makes RFT uniquely positioned to address open-ended, high-complexity problems where labels are hard to define but correctness is easy to check.</p>\n  </li>\n</ul>\n<p>One of the most compelling advantages of RFT is that it removes the dependency on traditional labeled datasets. Rather than requiring a fixed set of input-output pairs to train from, RFT allows models to learn by exploring various outputs and receiving scalar rewards based on how correct or useful those outputs are.</p>\n<p>What makes this powerful is that correctness doesn’t need to be determined by a human annotator—it can be algorithmically verified. This expands the applicability of RFT to domains where labeled data is scarce or even infeasible to produce. If the success criteria for a task can be expressed in the form of programmatic tests, validators, or logic-based constraints, then reward functions can substitute for explicit labels.</p>\n<p>In the simplest case—when labeled data does exist—reward evaluation can fall back to exact match comparison. However, RFT is far more general. It can be applied in tasks where output quality is determined by downstream behavior, execution results, logical validity, or compliance with rules rather than fixed answers. This makes RFT especially valuable in real-world applications where ground-truth labels are not always well-defined.</p>\n<p>A classic example is code transpilation, where a model converts code from one language (e.g., Java) into another (e.g., Python). You may not have a labeled Python equivalent for every Java function, but you can still define success as “produces the correct output for all test cases.” Even when there are multiple valid solutions, a programmatic test suite can confirm functional correctness.</p>\n<p>Similarly, RFT enables learning in domains that are inherently simulation-driven or verification-bound:</p>\n<ul>\n      <li>\n        <p><strong>Game-playing agents</strong>: The model’s success can be measured through well-defined metrics like win/loss, number of moves, or score improvements. No annotated dataset is needed—just the game logic and outcome tracking.</p>\n      </li>\n      <li>\n        <p><strong>Mathematical proofs or symbolic computation</strong>: Solvers can validate the correctness of a derived expression or equation, enabling the model to learn without step-by-step labeled traces.</p>\n      </li>\n      <li>\n        <p><strong>Scientific simulations and physics modeling</strong>: Outputs can be evaluated based on adherence to conservation laws, threshold tolerances, or stability criteria.</p>\n      </li>\n      <li>\n        <p><strong>Data transformations and conversions</strong>: Whether converting file formats or normalizing structured records, programmatic validators can confirm whether the output meets format specifications or integrity rules.</p>\n      </li>\n    </ul>\n<p><strong>Game-playing agents</strong>: The model’s success can be measured through well-defined metrics like win/loss, number of moves, or score improvements. No annotated dataset is needed—just the game logic and outcome tracking.</p>\n<p><strong>Mathematical proofs or symbolic computation</strong>: Solvers can validate the correctness of a derived expression or equation, enabling the model to learn without step-by-step labeled traces.</p>\n<p><strong>Scientific simulations and physics modeling</strong>: Outputs can be evaluated based on adherence to conservation laws, threshold tolerances, or stability criteria.</p>\n<p><strong>Data transformations and conversions</strong>: Whether converting file formats or normalizing structured records, programmatic validators can confirm whether the output meets format specifications or integrity rules.</p>\n<p>These reward-based learning setups enable RFT to scale in task domains where traditional annotation is prohibitively expensive, time-consuming, or ambiguous. As long as the outputs can be verified—by logic, by simulation, or by test execution—the model can learn autonomously. This makes RFT uniquely positioned to address open-ended, high-complexity problems where labels are hard to define but correctness is easy to check.</p>",
    "contentMarkdown": "*   One of the most compelling advantages of RFT is that it removes the dependency on traditional labeled datasets. Rather than requiring a fixed set of input-output pairs to train from, RFT allows models to learn by exploring various outputs and receiving scalar rewards based on how correct or useful those outputs are.\n    \n*   What makes this powerful is that correctness doesn’t need to be determined by a human annotator—it can be algorithmically verified. This expands the applicability of RFT to domains where labeled data is scarce or even infeasible to produce. If the success criteria for a task can be expressed in the form of programmatic tests, validators, or logic-based constraints, then reward functions can substitute for explicit labels.\n    \n*   In the simplest case—when labeled data does exist—reward evaluation can fall back to exact match comparison. However, RFT is far more general. It can be applied in tasks where output quality is determined by downstream behavior, execution results, logical validity, or compliance with rules rather than fixed answers. This makes RFT especially valuable in real-world applications where ground-truth labels are not always well-defined.\n    \n*   A classic example is code transpilation, where a model converts code from one language (e.g., Java) into another (e.g., Python). You may not have a labeled Python equivalent for every Java function, but you can still define success as “produces the correct output for all test cases.” Even when there are multiple valid solutions, a programmatic test suite can confirm functional correctness.\n    \n*   Similarly, RFT enables learning in domains that are inherently simulation-driven or verification-bound:\n    \n    *   **Game-playing agents**: The model’s success can be measured through well-defined metrics like win/loss, number of moves, or score improvements. No annotated dataset is needed—just the game logic and outcome tracking.\n        \n    *   **Mathematical proofs or symbolic computation**: Solvers can validate the correctness of a derived expression or equation, enabling the model to learn without step-by-step labeled traces.\n        \n    *   **Scientific simulations and physics modeling**: Outputs can be evaluated based on adherence to conservation laws, threshold tolerances, or stability criteria.\n        \n    *   **Data transformations and conversions**: Whether converting file formats or normalizing structured records, programmatic validators can confirm whether the output meets format specifications or integrity rules.\n        \n*   These reward-based learning setups enable RFT to scale in task domains where traditional annotation is prohibitively expensive, time-consuming, or ambiguous. As long as the outputs can be verified—by logic, by simulation, or by test execution—the model can learn autonomously. This makes RFT uniquely positioned to address open-ended, high-complexity problems where labels are hard to define but correctness is easy to check.\n    \n\nOne of the most compelling advantages of RFT is that it removes the dependency on traditional labeled datasets. Rather than requiring a fixed set of input-output pairs to train from, RFT allows models to learn by exploring various outputs and receiving scalar rewards based on how correct or useful those outputs are.\n\nWhat makes this powerful is that correctness doesn’t need to be determined by a human annotator—it can be algorithmically verified. This expands the applicability of RFT to domains where labeled data is scarce or even infeasible to produce. If the success criteria for a task can be expressed in the form of programmatic tests, validators, or logic-based constraints, then reward functions can substitute for explicit labels.\n\nIn the simplest case—when labeled data does exist—reward evaluation can fall back to exact match comparison. However, RFT is far more general. It can be applied in tasks where output quality is determined by downstream behavior, execution results, logical validity, or compliance with rules rather than fixed answers. This makes RFT especially valuable in real-world applications where ground-truth labels are not always well-defined.\n\nA classic example is code transpilation, where a model converts code from one language (e.g., Java) into another (e.g., Python). You may not have a labeled Python equivalent for every Java function, but you can still define success as “produces the correct output for all test cases.” Even when there are multiple valid solutions, a programmatic test suite can confirm functional correctness.\n\nSimilarly, RFT enables learning in domains that are inherently simulation-driven or verification-bound:\n\n*   **Game-playing agents**: The model’s success can be measured through well-defined metrics like win/loss, number of moves, or score improvements. No annotated dataset is needed—just the game logic and outcome tracking.\n    \n*   **Mathematical proofs or symbolic computation**: Solvers can validate the correctness of a derived expression or equation, enabling the model to learn without step-by-step labeled traces.\n    \n*   **Scientific simulations and physics modeling**: Outputs can be evaluated based on adherence to conservation laws, threshold tolerances, or stability criteria.\n    \n*   **Data transformations and conversions**: Whether converting file formats or normalizing structured records, programmatic validators can confirm whether the output meets format specifications or integrity rules.\n    \n\n**Game-playing agents**: The model’s success can be measured through well-defined metrics like win/loss, number of moves, or score improvements. No annotated dataset is needed—just the game logic and outcome tracking.\n\n**Mathematical proofs or symbolic computation**: Solvers can validate the correctness of a derived expression or equation, enabling the model to learn without step-by-step labeled traces.\n\n**Scientific simulations and physics modeling**: Outputs can be evaluated based on adherence to conservation laws, threshold tolerances, or stability criteria.\n\n**Data transformations and conversions**: Whether converting file formats or normalizing structured records, programmatic validators can confirm whether the output meets format specifications or integrity rules.\n\nThese reward-based learning setups enable RFT to scale in task domains where traditional annotation is prohibitively expensive, time-consuming, or ambiguous. As long as the outputs can be verified—by logic, by simulation, or by test execution—the model can learn autonomously. This makes RFT uniquely positioned to address open-ended, high-complexity problems where labels are hard to define but correctness is easy to check.",
    "contentLength": 7269,
    "wordCount": 946,
    "hasCode": false,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#absence-of-labeled-data-but-availability-of-verifiable-feedback"
  },
  {
    "id": "ai-reinforcement-finetuning-scenarios-with-limited-labeled-data-3",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "When Should You Use SFT vs. RFT?",
    "title": "Scenarios with Limited Labeled Data",
    "order": 3,
    "orderInChapter": 3,
    "contentHtml": "<ul>\n  <li>RFT is particularly effective when you do have some labeled data, but the quantity is too small to support robust supervised learning. This is often the case in domains where labeling is expensive, time-consuming, or requires expert knowledge.</li>\n  <li>In such low-data settings, SFT tends to overfit by memorizing specific examples without learning generalizable patterns. By contrast, RFT is less prone to overfitting because the model is never explicitly shown the “correct” answer—it must learn through exploration and reward feedback.</li>\n  <li>\n    <p><a href=\"https://predibase.com/blog/how-reinforcement-learning-beats-supervised-fine-tuning-when-data-is-scarce\">Predibase’s experiments</a> using the Countdown numbers game illustrate the following observations:</p>\n\n    <ul>\n      <li>With just 10 labeled examples, RFT was able to improve over the base model’s CoT performance by 18%.</li>\n      <li>At 100 examples, RFT improved performance by 60%, while SFT’s performance degraded—likely due to overfitting or CoT degradation (i.e., the “Lost in the Middle” effect).</li>\n      <li>Even at 1,000 examples, RFT continued to generalize effectively, while SFT struggled to match the base model’s performance.</li>\n    </ul>\n  </li>\n  <li>This demonstrates that RFT not only tolerates small data volumes—it thrives in them, making it ideal for domains like law, medicine, science, or financial analysis, where labeled datasets are often constrained.</li>\n</ul>\n<p><a href=\"https://predibase.com/blog/how-reinforcement-learning-beats-supervised-fine-tuning-when-data-is-scarce\">Predibase’s experiments</a> using the Countdown numbers game illustrate the following observations:</p>\n<ul>\n      <li>With just 10 labeled examples, RFT was able to improve over the base model’s CoT performance by 18%.</li>\n      <li>At 100 examples, RFT improved performance by 60%, while SFT’s performance degraded—likely due to overfitting or CoT degradation (i.e., the “Lost in the Middle” effect).</li>\n      <li>Even at 1,000 examples, RFT continued to generalize effectively, while SFT struggled to match the base model’s performance.</li>\n    </ul>",
    "contentMarkdown": "*   RFT is particularly effective when you do have some labeled data, but the quantity is too small to support robust supervised learning. This is often the case in domains where labeling is expensive, time-consuming, or requires expert knowledge.\n*   In such low-data settings, SFT tends to overfit by memorizing specific examples without learning generalizable patterns. By contrast, RFT is less prone to overfitting because the model is never explicitly shown the “correct” answer—it must learn through exploration and reward feedback.\n*   [Predibase’s experiments](https://predibase.com/blog/how-reinforcement-learning-beats-supervised-fine-tuning-when-data-is-scarce) using the Countdown numbers game illustrate the following observations:\n    \n    *   With just 10 labeled examples, RFT was able to improve over the base model’s CoT performance by 18%.\n    *   At 100 examples, RFT improved performance by 60%, while SFT’s performance degraded—likely due to overfitting or CoT degradation (i.e., the “Lost in the Middle” effect).\n    *   Even at 1,000 examples, RFT continued to generalize effectively, while SFT struggled to match the base model’s performance.\n*   This demonstrates that RFT not only tolerates small data volumes—it thrives in them, making it ideal for domains like law, medicine, science, or financial analysis, where labeled datasets are often constrained.\n\n[Predibase’s experiments](https://predibase.com/blog/how-reinforcement-learning-beats-supervised-fine-tuning-when-data-is-scarce) using the Countdown numbers game illustrate the following observations:\n\n*   With just 10 labeled examples, RFT was able to improve over the base model’s CoT performance by 18%.\n*   At 100 examples, RFT improved performance by 60%, while SFT’s performance degraded—likely due to overfitting or CoT degradation (i.e., the “Lost in the Middle” effect).\n*   Even at 1,000 examples, RFT continued to generalize effectively, while SFT struggled to match the base model’s performance.",
    "contentLength": 2157,
    "wordCount": 264,
    "hasCode": false,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#scenarios-with-limited-labeled-data"
  },
  {
    "id": "ai-reinforcement-finetuning-tasks-enhanced-by-chain-of-thought-reasoning-4",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "When Should You Use SFT vs. RFT?",
    "title": "Tasks Enhanced by Chain-of-Thought Reasoning",
    "order": 4,
    "orderInChapter": 4,
    "contentHtml": "<ul>\n  <li>CoT prompting enables models to perform multi-step reasoning by verbalizing intermediate steps. While SFT can imitate CoT examples, it often fails to teach genuine reasoning strategies, especially if the base model lacks the ability to reason in the first place.</li>\n  <li>RFT changes this dynamic by rewarding successful reasoning, allowing the model to explore different chains of logic and gradually reinforce those that lead to correct answers. It enables models to discover novel reasoning paths that weren’t explicitly included in training data.</li>\n  <li>\n    <p>Predibase’s experiments show:</p>\n\n    <ul>\n      <li>RFT significantly improves reasoning-intensive tasks like math games, symbolic logic, and diagnostics.</li>\n      <li>In the Countdown task, RFT-enabled models achieved consistently higher accuracy than SFT-tuned counterparts when using CoT prompting.</li>\n      <li>RFT-trained models even outperformed teacher models like DeepSeek-R1-Distill when it came to step-by-step logic.</li>\n    </ul>\n  </li>\n  <li>RFT’s ability to refine reasoning strategies makes it uniquely suited for domains like scientific discovery, legal argumentation, and multi-hop question answering, where inference plays a larger role than memorization.</li>\n</ul>\n<p>Predibase’s experiments show:</p>\n<ul>\n      <li>RFT significantly improves reasoning-intensive tasks like math games, symbolic logic, and diagnostics.</li>\n      <li>In the Countdown task, RFT-enabled models achieved consistently higher accuracy than SFT-tuned counterparts when using CoT prompting.</li>\n      <li>RFT-trained models even outperformed teacher models like DeepSeek-R1-Distill when it came to step-by-step logic.</li>\n    </ul>",
    "contentMarkdown": "*   CoT prompting enables models to perform multi-step reasoning by verbalizing intermediate steps. While SFT can imitate CoT examples, it often fails to teach genuine reasoning strategies, especially if the base model lacks the ability to reason in the first place.\n*   RFT changes this dynamic by rewarding successful reasoning, allowing the model to explore different chains of logic and gradually reinforce those that lead to correct answers. It enables models to discover novel reasoning paths that weren’t explicitly included in training data.\n*   Predibase’s experiments show:\n    \n    *   RFT significantly improves reasoning-intensive tasks like math games, symbolic logic, and diagnostics.\n    *   In the Countdown task, RFT-enabled models achieved consistently higher accuracy than SFT-tuned counterparts when using CoT prompting.\n    *   RFT-trained models even outperformed teacher models like DeepSeek-R1-Distill when it came to step-by-step logic.\n*   RFT’s ability to refine reasoning strategies makes it uniquely suited for domains like scientific discovery, legal argumentation, and multi-hop question answering, where inference plays a larger role than memorization.\n\nPredibase’s experiments show:\n\n*   RFT significantly improves reasoning-intensive tasks like math games, symbolic logic, and diagnostics.\n*   In the Countdown task, RFT-enabled models achieved consistently higher accuracy than SFT-tuned counterparts when using CoT prompting.\n*   RFT-trained models even outperformed teacher models like DeepSeek-R1-Distill when it came to step-by-step logic.",
    "contentLength": 1722,
    "wordCount": 212,
    "hasCode": false,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#tasks-enhanced-by-chain-of-thought-reasoning"
  },
  {
    "id": "ai-reinforcement-finetuning-complex-tasks-that-support-programmatic-validation-5",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "When Should You Use SFT vs. RFT?",
    "title": "Complex Tasks That Support Programmatic Validation",
    "order": 5,
    "orderInChapter": 5,
    "contentHtml": "<ul>\n  <li>There are many real-world tasks that are difficult to label but relatively easy to validate. These are ideal candidates for RFT because they allow for reward-based learning even in the absence of fixed training targets.</li>\n  <li>\n    <p>Examples include:</p>\n\n    <ul>\n      <li><strong>Mathematical computation tasks</strong>: where outputs can be verified via equations or symbolic solvers.</li>\n      <li><strong>Physics or chemistry simulations</strong>: where model predictions must satisfy known conservation laws or equilibrium rules.</li>\n      <li><strong>Structured data generation</strong>: like producing valid JSON schemas, database queries, or configuration files.</li>\n    </ul>\n  </li>\n  <li>RFT thrives in these environments because it provides a natural fit for tasks that resemble <a href=\"https://en.wikipedia.org/wiki/NP_(complexity)\">NP problems</a>—those where solutions are hard to compute, but easy to verify. Even in such domains, RFT can lead to meaningful improvements with minimal labeled supervision, as long as there’s a mechanism to define and compute verifiable reward functions.</li>\n</ul>\n<p>Examples include:</p>\n<ul>\n      <li><strong>Mathematical computation tasks</strong>: where outputs can be verified via equations or symbolic solvers.</li>\n      <li><strong>Physics or chemistry simulations</strong>: where model predictions must satisfy known conservation laws or equilibrium rules.</li>\n      <li><strong>Structured data generation</strong>: like producing valid JSON schemas, database queries, or configuration files.</li>\n    </ul>",
    "contentMarkdown": "*   There are many real-world tasks that are difficult to label but relatively easy to validate. These are ideal candidates for RFT because they allow for reward-based learning even in the absence of fixed training targets.\n*   Examples include:\n    \n    *   **Mathematical computation tasks**: where outputs can be verified via equations or symbolic solvers.\n    *   **Physics or chemistry simulations**: where model predictions must satisfy known conservation laws or equilibrium rules.\n    *   **Structured data generation**: like producing valid JSON schemas, database queries, or configuration files.\n*   RFT thrives in these environments because it provides a natural fit for tasks that resemble [NP problems](https://en.wikipedia.org/wiki/NP_\\(complexity\\))—those where solutions are hard to compute, but easy to verify. Even in such domains, RFT can lead to meaningful improvements with minimal labeled supervision, as long as there’s a mechanism to define and compute verifiable reward functions.\n\nExamples include:\n\n*   **Mathematical computation tasks**: where outputs can be verified via equations or symbolic solvers.\n*   **Physics or chemistry simulations**: where model predictions must satisfy known conservation laws or equilibrium rules.\n*   **Structured data generation**: like producing valid JSON schemas, database queries, or configuration files.",
    "contentLength": 1591,
    "wordCount": 184,
    "hasCode": false,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#complex-tasks-that-support-programmatic-validation"
  },
  {
    "id": "ai-reinforcement-finetuning-cases-where-generalization-is-preferred-over-memor-6",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "When Should You Use SFT vs. RFT?",
    "title": "Cases Where Generalization is Preferred Over Memorization",
    "order": 6,
    "orderInChapter": 6,
    "contentHtml": "<ul>\n  <li>A common problem in SFT is that, when trained on limited data, models tend to memorize training examples rather than learn patterns that generalize. This not only limits performance but can also be risky in domains where adaptability is crucial.</li>\n  <li>RFT avoids this by not exposing the model to ground-truth answers during training. Instead, it learns by optimizing for higher-scoring behaviors through reward signals, which naturally favors robust, reusable strategies over brittle, memorized ones.</li>\n  <li>This makes RFT highly applicable for:\n    <ul>\n      <li><strong>Modular fine-tuning</strong> with LoRA adapters.</li>\n      <li><strong>Small model training</strong> where parameter budgets are constrained.</li>\n      <li><strong>Continual learning scenarios</strong> where model capabilities must evolve in production.</li>\n    </ul>\n  </li>\n</ul>\n<ul>\n      <li><strong>Modular fine-tuning</strong> with LoRA adapters.</li>\n      <li><strong>Small model training</strong> where parameter budgets are constrained.</li>\n      <li><strong>Continual learning scenarios</strong> where model capabilities must evolve in production.</li>\n    </ul>",
    "contentMarkdown": "*   A common problem in SFT is that, when trained on limited data, models tend to memorize training examples rather than learn patterns that generalize. This not only limits performance but can also be risky in domains where adaptability is crucial.\n*   RFT avoids this by not exposing the model to ground-truth answers during training. Instead, it learns by optimizing for higher-scoring behaviors through reward signals, which naturally favors robust, reusable strategies over brittle, memorized ones.\n*   This makes RFT highly applicable for:\n    *   **Modular fine-tuning** with LoRA adapters.\n    *   **Small model training** where parameter budgets are constrained.\n    *   **Continual learning scenarios** where model capabilities must evolve in production.\n\n*   **Modular fine-tuning** with LoRA adapters.\n*   **Small model training** where parameter budgets are constrained.\n*   **Continual learning scenarios** where model capabilities must evolve in production.",
    "contentLength": 1172,
    "wordCount": 135,
    "hasCode": false,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#cases-where-generalization-is-preferred-over-memorization"
  },
  {
    "id": "ai-reinforcement-finetuning-rapid-performance-bootstrapping-with-minimal-data-7",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "When Should You Use SFT vs. RFT?",
    "title": "Rapid Performance Bootstrapping with Minimal Data",
    "order": 7,
    "orderInChapter": 7,
    "contentHtml": "<ul>\n  <li>Another practical advantage of RFT is how quickly it can yield returns. In Predibase’s experiments, models trained with RFT showed rapid learning trajectories, often reaching competitive performance levels within just a few hundred training steps.</li>\n  <li>This makes RFT ideal for scenarios such as:\n    <ul>\n      <li><strong>Rapid prototyping</strong> of internal tools.</li>\n      <li><strong>Domain adaptation</strong> with minimal bootstrapping data.</li>\n      <li><strong>Academic or research projects</strong> with limited annotation budgets.</li>\n      <li><strong>Early-stage model iteration</strong> before full-scale deployment.</li>\n    </ul>\n  </li>\n  <li>Even in complex code generation tasks, models trained with fewer than 15 examples were able to learn useful behaviors simply through reward-based reinforcement.</li>\n</ul>\n<ul>\n      <li><strong>Rapid prototyping</strong> of internal tools.</li>\n      <li><strong>Domain adaptation</strong> with minimal bootstrapping data.</li>\n      <li><strong>Academic or research projects</strong> with limited annotation budgets.</li>\n      <li><strong>Early-stage model iteration</strong> before full-scale deployment.</li>\n    </ul>",
    "contentMarkdown": "*   Another practical advantage of RFT is how quickly it can yield returns. In Predibase’s experiments, models trained with RFT showed rapid learning trajectories, often reaching competitive performance levels within just a few hundred training steps.\n*   This makes RFT ideal for scenarios such as:\n    *   **Rapid prototyping** of internal tools.\n    *   **Domain adaptation** with minimal bootstrapping data.\n    *   **Academic or research projects** with limited annotation budgets.\n    *   **Early-stage model iteration** before full-scale deployment.\n*   Even in complex code generation tasks, models trained with fewer than 15 examples were able to learn useful behaviors simply through reward-based reinforcement.\n\n*   **Rapid prototyping** of internal tools.\n*   **Domain adaptation** with minimal bootstrapping data.\n*   **Academic or research projects** with limited annotation budgets.\n*   **Early-stage model iteration** before full-scale deployment.",
    "contentLength": 1207,
    "wordCount": 127,
    "hasCode": false,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#rapid-performance-bootstrapping-with-minimal-data"
  },
  {
    "id": "ai-reinforcement-finetuning-when-to-use-lora-based-rft-vs-grpo-based-policy-gr-8",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "Comparative Analysis",
    "title": "When to Use LoRA-based RFT vs. GRPO-based Policy Gradient Updates",
    "order": 8,
    "orderInChapter": 1,
    "contentHtml": "<ul>\n  <li><strong>When to use LoRA-based RFT with GRPO:</strong>\n    <ul>\n      <li><strong>Modular fine-tuning for flexibility:</strong> LoRA inserts trainable low-rank adapters into attention and feed-forward layers, allowing multiple domain-specific fine-tunings without touching the base model.\n        <ul>\n          <li><strong>Example:</strong> Fine-tune a general LLM to solve legal reasoning tasks using a LoRA adapter trained with a reward function based on contract clause extraction accuracy.</li>\n          <li><strong>Tip:</strong> LoRA is extremely memory-efficient and allows switching between domains by swapping adapters.</li>\n        </ul>\n      </li>\n      <li><strong>High efficiency with RL-based tuning:</strong> LoRA combined with GRPO allows fine-tuning with minimal GPU resources while still capturing complex exploration strategies during RL training.\n        <ul>\n          <li><strong>Example:</strong> Fine-tuning for code transpilation (Python <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5\"><span class=\"mo\" id=\"MathJax-Span-6\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-2\">\\rightarrow</script> Triton) where passing unit tests defines the reward.</li>\n          <li><strong>Practical setup:</strong> LoRA rank typically between 4–64, a GRPO clipping factor set around 0.2–0.3 for stability, and KL-divergence penalties for maintaining output fluency.</li>\n        </ul>\n      </li>\n      <li><strong>Continual learning or fast updates:</strong> LoRA excels when frequent model updates or domain adaptation is needed, say as part of a continual learning loop.</li>\n    </ul>\n  </li>\n  <li><strong>When to use GRPO-based policy gradient updates (full model, no LoRA):</strong>\n    <ul>\n      <li><strong>You have full model access and training resources:</strong> When large compute clusters are available and deep changes to internal representations (such as attention mechanisms or expert routing) are needed – especially when training from scratch. This level of integration typically requires full model updates.\n        <ul>\n          <li><strong>Example:</strong> Training something like DeepSeek-R1 from scratch to self-evolve reasoning without human labels.</li>\n          <li><strong>Practical setup:</strong> Full checkpoint saving, optimizer tuning (AdamW with lower learning rates during policy phase), and careful use of GRPO’s dual clipping mechanism to balance stability and learning speed.</li>\n        </ul>\n      </li>\n      <li><strong>Long-horizon, multi-step reasoning tasks:</strong> Full GRPO supports gradual improvement across multi-turn or multi-hop reasoning sequences, where shallow adaptations (like LoRA) might plateau early.\n        <ul>\n          <li><strong>Example:</strong> Teaching a model to generate full proofs for math theorems through staged reward shaping.</li>\n          <li>Implementation tip: Use curriculum learning—starting with easy problems and gradually increasing complexity to avoid sparse reward traps.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n</ul>\n<ul>\n      <li><strong>Modular fine-tuning for flexibility:</strong> LoRA inserts trainable low-rank adapters into attention and feed-forward layers, allowing multiple domain-specific fine-tunings without touching the base model.\n        <ul>\n          <li><strong>Example:</strong> Fine-tune a general LLM to solve legal reasoning tasks using a LoRA adapter trained with a reward function based on contract clause extraction accuracy.</li>\n          <li><strong>Tip:</strong> LoRA is extremely memory-efficient and allows switching between domains by swapping adapters.</li>\n        </ul>\n      </li>\n      <li><strong>High efficiency with RL-based tuning:</strong> LoRA combined with GRPO allows fine-tuning with minimal GPU resources while still capturing complex exploration strategies during RL training.\n        <ul>\n          <li><strong>Example:</strong> Fine-tuning for code transpilation (Python <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5\"><span class=\"mo\" id=\"MathJax-Span-6\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-2\">\\rightarrow</script> Triton) where passing unit tests defines the reward.</li>\n          <li><strong>Practical setup:</strong> LoRA rank typically between 4–64, a GRPO clipping factor set around 0.2–0.3 for stability, and KL-divergence penalties for maintaining output fluency.</li>\n        </ul>\n      </li>\n      <li><strong>Continual learning or fast updates:</strong> LoRA excels when frequent model updates or domain adaptation is needed, say as part of a continual learning loop.</li>\n    </ul>\n<ul>\n          <li><strong>Example:</strong> Fine-tune a general LLM to solve legal reasoning tasks using a LoRA adapter trained with a reward function based on contract clause extraction accuracy.</li>\n          <li><strong>Tip:</strong> LoRA is extremely memory-efficient and allows switching between domains by swapping adapters.</li>\n        </ul>\n<ul>\n          <li><strong>Example:</strong> Fine-tuning for code transpilation (Python <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5\"><span class=\"mo\" id=\"MathJax-Span-6\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-2\">\\rightarrow</script> Triton) where passing unit tests defines the reward.</li>\n          <li><strong>Practical setup:</strong> LoRA rank typically between 4–64, a GRPO clipping factor set around 0.2–0.3 for stability, and KL-divergence penalties for maintaining output fluency.</li>\n        </ul>\n<ul>\n      <li><strong>You have full model access and training resources:</strong> When large compute clusters are available and deep changes to internal representations (such as attention mechanisms or expert routing) are needed – especially when training from scratch. This level of integration typically requires full model updates.\n        <ul>\n          <li><strong>Example:</strong> Training something like DeepSeek-R1 from scratch to self-evolve reasoning without human labels.</li>\n          <li><strong>Practical setup:</strong> Full checkpoint saving, optimizer tuning (AdamW with lower learning rates during policy phase), and careful use of GRPO’s dual clipping mechanism to balance stability and learning speed.</li>\n        </ul>\n      </li>\n      <li><strong>Long-horizon, multi-step reasoning tasks:</strong> Full GRPO supports gradual improvement across multi-turn or multi-hop reasoning sequences, where shallow adaptations (like LoRA) might plateau early.\n        <ul>\n          <li><strong>Example:</strong> Teaching a model to generate full proofs for math theorems through staged reward shaping.</li>\n          <li>Implementation tip: Use curriculum learning—starting with easy problems and gradually increasing complexity to avoid sparse reward traps.</li>\n        </ul>\n      </li>\n    </ul>\n<ul>\n          <li><strong>Example:</strong> Training something like DeepSeek-R1 from scratch to self-evolve reasoning without human labels.</li>\n          <li><strong>Practical setup:</strong> Full checkpoint saving, optimizer tuning (AdamW with lower learning rates during policy phase), and careful use of GRPO’s dual clipping mechanism to balance stability and learning speed.</li>\n        </ul>\n<ul>\n          <li><strong>Example:</strong> Teaching a model to generate full proofs for math theorems through staged reward shaping.</li>\n          <li>Implementation tip: Use curriculum learning—starting with easy problems and gradually increasing complexity to avoid sparse reward traps.</li>\n        </ul>",
    "contentMarkdown": "*   **When to use LoRA-based RFT with GRPO:**\n    *   **Modular fine-tuning for flexibility:** LoRA inserts trainable low-rank adapters into attention and feed-forward layers, allowing multiple domain-specific fine-tunings without touching the base model.\n        *   **Example:** Fine-tune a general LLM to solve legal reasoning tasks using a LoRA adapter trained with a reward function based on contract clause extraction accuracy.\n        *   **Tip:** LoRA is extremely memory-efficient and allows switching between domains by swapping adapters.\n    *   **High efficiency with RL-based tuning:** LoRA combined with GRPO allows fine-tuning with minimal GPU resources while still capturing complex exploration strategies during RL training.\n        *   **Example:** Fine-tuning for code transpilation (Python →→\\\\rightarrow Triton) where passing unit tests defines the reward.\n        *   **Practical setup:** LoRA rank typically between 4–64, a GRPO clipping factor set around 0.2–0.3 for stability, and KL-divergence penalties for maintaining output fluency.\n    *   **Continual learning or fast updates:** LoRA excels when frequent model updates or domain adaptation is needed, say as part of a continual learning loop.\n*   **When to use GRPO-based policy gradient updates (full model, no LoRA):**\n    *   **You have full model access and training resources:** When large compute clusters are available and deep changes to internal representations (such as attention mechanisms or expert routing) are needed – especially when training from scratch. This level of integration typically requires full model updates.\n        *   **Example:** Training something like DeepSeek-R1 from scratch to self-evolve reasoning without human labels.\n        *   **Practical setup:** Full checkpoint saving, optimizer tuning (AdamW with lower learning rates during policy phase), and careful use of GRPO’s dual clipping mechanism to balance stability and learning speed.\n    *   **Long-horizon, multi-step reasoning tasks:** Full GRPO supports gradual improvement across multi-turn or multi-hop reasoning sequences, where shallow adaptations (like LoRA) might plateau early.\n        *   **Example:** Teaching a model to generate full proofs for math theorems through staged reward shaping.\n        *   Implementation tip: Use curriculum learning—starting with easy problems and gradually increasing complexity to avoid sparse reward traps.\n\n*   **Modular fine-tuning for flexibility:** LoRA inserts trainable low-rank adapters into attention and feed-forward layers, allowing multiple domain-specific fine-tunings without touching the base model.\n    *   **Example:** Fine-tune a general LLM to solve legal reasoning tasks using a LoRA adapter trained with a reward function based on contract clause extraction accuracy.\n    *   **Tip:** LoRA is extremely memory-efficient and allows switching between domains by swapping adapters.\n*   **High efficiency with RL-based tuning:** LoRA combined with GRPO allows fine-tuning with minimal GPU resources while still capturing complex exploration strategies during RL training.\n    *   **Example:** Fine-tuning for code transpilation (Python →→\\\\rightarrow Triton) where passing unit tests defines the reward.\n    *   **Practical setup:** LoRA rank typically between 4–64, a GRPO clipping factor set around 0.2–0.3 for stability, and KL-divergence penalties for maintaining output fluency.\n*   **Continual learning or fast updates:** LoRA excels when frequent model updates or domain adaptation is needed, say as part of a continual learning loop.\n\n*   **Example:** Fine-tune a general LLM to solve legal reasoning tasks using a LoRA adapter trained with a reward function based on contract clause extraction accuracy.\n*   **Tip:** LoRA is extremely memory-efficient and allows switching between domains by swapping adapters.\n\n*   **Example:** Fine-tuning for code transpilation (Python →→\\\\rightarrow Triton) where passing unit tests defines the reward.\n*   **Practical setup:** LoRA rank typically between 4–64, a GRPO clipping factor set around 0.2–0.3 for stability, and KL-divergence penalties for maintaining output fluency.\n\n*   **You have full model access and training resources:** When large compute clusters are available and deep changes to internal representations (such as attention mechanisms or expert routing) are needed – especially when training from scratch. This level of integration typically requires full model updates.\n    *   **Example:** Training something like DeepSeek-R1 from scratch to self-evolve reasoning without human labels.\n    *   **Practical setup:** Full checkpoint saving, optimizer tuning (AdamW with lower learning rates during policy phase), and careful use of GRPO’s dual clipping mechanism to balance stability and learning speed.\n*   **Long-horizon, multi-step reasoning tasks:** Full GRPO supports gradual improvement across multi-turn or multi-hop reasoning sequences, where shallow adaptations (like LoRA) might plateau early.\n    *   **Example:** Teaching a model to generate full proofs for math theorems through staged reward shaping.\n    *   Implementation tip: Use curriculum learning—starting with easy problems and gradually increasing complexity to avoid sparse reward traps.\n\n*   **Example:** Training something like DeepSeek-R1 from scratch to self-evolve reasoning without human labels.\n*   **Practical setup:** Full checkpoint saving, optimizer tuning (AdamW with lower learning rates during policy phase), and careful use of GRPO’s dual clipping mechanism to balance stability and learning speed.\n\n*   **Example:** Teaching a model to generate full proofs for math theorems through staged reward shaping.\n*   Implementation tip: Use curriculum learning—starting with easy problems and gradually increasing complexity to avoid sparse reward traps.",
    "contentLength": 10730,
    "wordCount": 780,
    "hasCode": false,
    "hasMath": true,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#when-to-use-lora-based-rft-vs.-grpo-based-policy-gradient-updates"
  },
  {
    "id": "ai-reinforcement-finetuning-when-to-use-rft-vs-sft-9",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "Comparative Analysis",
    "title": "When to Use RFT vs. SFT",
    "order": 9,
    "orderInChapter": 2,
    "contentHtml": "<ul>\n  <li><strong>Use RFT for verifiable, low-data tasks:</strong>\n    <ul>\n      <li>Best suited when you have fewer than 100 high-quality examples.</li>\n      <li>The task allows for programmatic or algorithmic verification of success (e.g., test passing, constraint satisfaction).</li>\n      <li>Chain-of-Thought (CoT) prompting or reasoning steps boost model performance by encouraging exploration and structured problem-solving.</li>\n      <li><strong>Implementation:</strong> Start with SFT on a handful of CoT examples if possible (“cold start”), then transition into RFT by setting up a reward function evaluating correctness, completeness, or logical validity.</li>\n    </ul>\n  </li>\n  <li><strong>Use SFT for high-data, low-reasoning tasks:</strong>\n    <ul>\n      <li>Preferred when you have abundant labeled examples (&gt;100k) and the task mainly requires mimicking a fixed format, style, or output pattern (e.g., translation, summarization).</li>\n      <li>Example: Fine-tuning a model to rewrite articles into simplified English, where correctness is subjective and exploration is unnecessary.</li>\n      <li>Practical setup: Classic supervised loss (cross-entropy), batching high-quality labeled examples with strong regularization to prevent overfitting.</li>\n    </ul>\n  </li>\n  <li><strong>Domain fit matters:</strong>\n    <ul>\n      <li><strong>RFT</strong> is the right tool when success is about “correct or incorrect” judgments based on logical or computational outcomes.</li>\n      <li><strong>SFT</strong> dominates when the primary goal is matching human-provided targets where ambiguity or nuance is acceptable.</li>\n      <li>Pro tip: If unsure, use the decision flow—small data and verifiable = RFT; large data and imitation = SFT.</li>\n    </ul>\n  </li>\n</ul>\n<ul>\n      <li>Best suited when you have fewer than 100 high-quality examples.</li>\n      <li>The task allows for programmatic or algorithmic verification of success (e.g., test passing, constraint satisfaction).</li>\n      <li>Chain-of-Thought (CoT) prompting or reasoning steps boost model performance by encouraging exploration and structured problem-solving.</li>\n      <li><strong>Implementation:</strong> Start with SFT on a handful of CoT examples if possible (“cold start”), then transition into RFT by setting up a reward function evaluating correctness, completeness, or logical validity.</li>\n    </ul>\n<ul>\n      <li>Preferred when you have abundant labeled examples (&gt;100k) and the task mainly requires mimicking a fixed format, style, or output pattern (e.g., translation, summarization).</li>\n      <li>Example: Fine-tuning a model to rewrite articles into simplified English, where correctness is subjective and exploration is unnecessary.</li>\n      <li>Practical setup: Classic supervised loss (cross-entropy), batching high-quality labeled examples with strong regularization to prevent overfitting.</li>\n    </ul>\n<ul>\n      <li><strong>RFT</strong> is the right tool when success is about “correct or incorrect” judgments based on logical or computational outcomes.</li>\n      <li><strong>SFT</strong> dominates when the primary goal is matching human-provided targets where ambiguity or nuance is acceptable.</li>\n      <li>Pro tip: If unsure, use the decision flow—small data and verifiable = RFT; large data and imitation = SFT.</li>\n    </ul>",
    "contentMarkdown": "*   **Use RFT for verifiable, low-data tasks:**\n    *   Best suited when you have fewer than 100 high-quality examples.\n    *   The task allows for programmatic or algorithmic verification of success (e.g., test passing, constraint satisfaction).\n    *   Chain-of-Thought (CoT) prompting or reasoning steps boost model performance by encouraging exploration and structured problem-solving.\n    *   **Implementation:** Start with SFT on a handful of CoT examples if possible (“cold start”), then transition into RFT by setting up a reward function evaluating correctness, completeness, or logical validity.\n*   **Use SFT for high-data, low-reasoning tasks:**\n    *   Preferred when you have abundant labeled examples (>100k) and the task mainly requires mimicking a fixed format, style, or output pattern (e.g., translation, summarization).\n    *   Example: Fine-tuning a model to rewrite articles into simplified English, where correctness is subjective and exploration is unnecessary.\n    *   Practical setup: Classic supervised loss (cross-entropy), batching high-quality labeled examples with strong regularization to prevent overfitting.\n*   **Domain fit matters:**\n    *   **RFT** is the right tool when success is about “correct or incorrect” judgments based on logical or computational outcomes.\n    *   **SFT** dominates when the primary goal is matching human-provided targets where ambiguity or nuance is acceptable.\n    *   Pro tip: If unsure, use the decision flow—small data and verifiable = RFT; large data and imitation = SFT.\n\n*   Best suited when you have fewer than 100 high-quality examples.\n*   The task allows for programmatic or algorithmic verification of success (e.g., test passing, constraint satisfaction).\n*   Chain-of-Thought (CoT) prompting or reasoning steps boost model performance by encouraging exploration and structured problem-solving.\n*   **Implementation:** Start with SFT on a handful of CoT examples if possible (“cold start”), then transition into RFT by setting up a reward function evaluating correctness, completeness, or logical validity.\n\n*   Preferred when you have abundant labeled examples (>100k) and the task mainly requires mimicking a fixed format, style, or output pattern (e.g., translation, summarization).\n*   Example: Fine-tuning a model to rewrite articles into simplified English, where correctness is subjective and exploration is unnecessary.\n*   Practical setup: Classic supervised loss (cross-entropy), batching high-quality labeled examples with strong regularization to prevent overfitting.\n\n*   **RFT** is the right tool when success is about “correct or incorrect” judgments based on logical or computational outcomes.\n*   **SFT** dominates when the primary goal is matching human-provided targets where ambiguity or nuance is acceptable.\n*   Pro tip: If unsure, use the decision flow—small data and verifiable = RFT; large data and imitation = SFT.",
    "contentLength": 3361,
    "wordCount": 402,
    "hasCode": false,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#when-to-use-rft-vs.-sft"
  },
  {
    "id": "ai-reinforcement-finetuning-tabular-comparison-10",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "Comparative Analysis",
    "title": "Tabular Comparison",
    "order": 10,
    "orderInChapter": 3,
    "contentHtml": "<div align=\"center\"> <table class=\"tg\"> <thead> <tr> <th class=\"tg-hcenter-valign-first\"><strong>Feature</strong></th> <th class=\"tg-hcenter-valign-first\"><strong>SFT</strong></th> <th class=\"tg-hcenter-valign-second\"><strong>RFT</strong></th> </tr> </thead> <tbody> <tr> <td class=\"tg-tleft-valign-first\">Learning Paradigm</td> <td class=\"tg-tleft-valign-first\">Offline learning using static datasets where model weights are adjusted to match labeled outputs.</td> <td class=\"tg-tleft-valign-second\">Online learning where model iteratively generates outputs, receives scores, and updates based on feedback.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Data Requirement</td> <td class=\"tg-tleft-valign-first\">Requires thousands of labeled examples to generalize well, especially in complex domains.</td> <td class=\"tg-tleft-valign-second\">Achieves robust performance with as few as 10–100 high-quality prompts and verifiable reward mechanisms.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Supervision Method</td> <td class=\"tg-tleft-valign-first\">Relies entirely on human-curated prompt-response pairs for training.</td> <td class=\"tg-tleft-valign-second\">Uses reward functions that score outputs based on correctness, structure, compilation success, or task-specific logic.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Reasoning Capability</td> <td class=\"tg-tleft-valign-first\">Limited to patterns observed in training data; does not generalize well to unseen logic or reasoning strategies.</td> <td class=\"tg-tleft-valign-second\">Encourages exploratory behavior and chain-of-thought development to solve complex or multi-step tasks.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Adaptability</td> <td class=\"tg-tleft-valign-first\">Inflexible once trained—new data or distribution shifts require retraining from scratch.</td> <td class=\"tg-tleft-valign-second\">Dynamic learning enabled by online feedback allows the model to continually improve and adapt.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Use Case Fit</td> <td class=\"tg-tleft-valign-first\">Best suited for tasks like translation, rephrasing, or summarization where outputs have stylistic or format regularity.</td> <td class=\"tg-tleft-valign-second\">Ideal for domains requiring objective correctness, such as code generation, scientific reasoning, and decision-making support.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Overfitting Risk</td> <td class=\"tg-tleft-valign-first\">High, particularly in small dataset scenarios. The model tends to memorize rather than generalize.</td> <td class=\"tg-tleft-valign-second\">Lower risk due to stochastic exploration and reward-based correction mechanisms.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Cost Efficiency</td> <td class=\"tg-tleft-valign-first\">Can be expensive due to the need for large-scale data collection and compute-intensive retraining cycles.</td> <td class=\"tg-tleft-valign-second\">More efficient with small datasets, especially when using LoRA adapters for modular fine-tuning.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Examples from Industry</td> <td class=\"tg-tleft-valign-first\">Language modeling, translation, instruction-following with curated corpora (e.g., FLAN, Alpaca).</td> <td class=\"tg-tleft-valign-second\">CUDA kernel generation from PyTorch (Triton), legal case summarization, rare disease diagnosis, financial modeling.</td> </tr> </tbody> </table> </div>\n<table class=\"tg\"> <thead> <tr> <th class=\"tg-hcenter-valign-first\"><strong>Feature</strong></th> <th class=\"tg-hcenter-valign-first\"><strong>SFT</strong></th> <th class=\"tg-hcenter-valign-second\"><strong>RFT</strong></th> </tr> </thead> <tbody> <tr> <td class=\"tg-tleft-valign-first\">Learning Paradigm</td> <td class=\"tg-tleft-valign-first\">Offline learning using static datasets where model weights are adjusted to match labeled outputs.</td> <td class=\"tg-tleft-valign-second\">Online learning where model iteratively generates outputs, receives scores, and updates based on feedback.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Data Requirement</td> <td class=\"tg-tleft-valign-first\">Requires thousands of labeled examples to generalize well, especially in complex domains.</td> <td class=\"tg-tleft-valign-second\">Achieves robust performance with as few as 10–100 high-quality prompts and verifiable reward mechanisms.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Supervision Method</td> <td class=\"tg-tleft-valign-first\">Relies entirely on human-curated prompt-response pairs for training.</td> <td class=\"tg-tleft-valign-second\">Uses reward functions that score outputs based on correctness, structure, compilation success, or task-specific logic.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Reasoning Capability</td> <td class=\"tg-tleft-valign-first\">Limited to patterns observed in training data; does not generalize well to unseen logic or reasoning strategies.</td> <td class=\"tg-tleft-valign-second\">Encourages exploratory behavior and chain-of-thought development to solve complex or multi-step tasks.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Adaptability</td> <td class=\"tg-tleft-valign-first\">Inflexible once trained—new data or distribution shifts require retraining from scratch.</td> <td class=\"tg-tleft-valign-second\">Dynamic learning enabled by online feedback allows the model to continually improve and adapt.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Use Case Fit</td> <td class=\"tg-tleft-valign-first\">Best suited for tasks like translation, rephrasing, or summarization where outputs have stylistic or format regularity.</td> <td class=\"tg-tleft-valign-second\">Ideal for domains requiring objective correctness, such as code generation, scientific reasoning, and decision-making support.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Overfitting Risk</td> <td class=\"tg-tleft-valign-first\">High, particularly in small dataset scenarios. The model tends to memorize rather than generalize.</td> <td class=\"tg-tleft-valign-second\">Lower risk due to stochastic exploration and reward-based correction mechanisms.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Cost Efficiency</td> <td class=\"tg-tleft-valign-first\">Can be expensive due to the need for large-scale data collection and compute-intensive retraining cycles.</td> <td class=\"tg-tleft-valign-second\">More efficient with small datasets, especially when using LoRA adapters for modular fine-tuning.</td> </tr> <tr> <td class=\"tg-tleft-valign-first\">Examples from Industry</td> <td class=\"tg-tleft-valign-first\">Language modeling, translation, instruction-following with curated corpora (e.g., FLAN, Alpaca).</td> <td class=\"tg-tleft-valign-second\">CUDA kernel generation from PyTorch (Triton), legal case summarization, rare disease diagnosis, financial modeling.</td> </tr> </tbody> </table>",
    "contentMarkdown": "**Feature**\n\n**SFT**\n\n**RFT**\n\nLearning Paradigm\n\nOffline learning using static datasets where model weights are adjusted to match labeled outputs.\n\nOnline learning where model iteratively generates outputs, receives scores, and updates based on feedback.\n\nData Requirement\n\nRequires thousands of labeled examples to generalize well, especially in complex domains.\n\nAchieves robust performance with as few as 10–100 high-quality prompts and verifiable reward mechanisms.\n\nSupervision Method\n\nRelies entirely on human-curated prompt-response pairs for training.\n\nUses reward functions that score outputs based on correctness, structure, compilation success, or task-specific logic.\n\nReasoning Capability\n\nLimited to patterns observed in training data; does not generalize well to unseen logic or reasoning strategies.\n\nEncourages exploratory behavior and chain-of-thought development to solve complex or multi-step tasks.\n\nAdaptability\n\nInflexible once trained—new data or distribution shifts require retraining from scratch.\n\nDynamic learning enabled by online feedback allows the model to continually improve and adapt.\n\nUse Case Fit\n\nBest suited for tasks like translation, rephrasing, or summarization where outputs have stylistic or format regularity.\n\nIdeal for domains requiring objective correctness, such as code generation, scientific reasoning, and decision-making support.\n\nOverfitting Risk\n\nHigh, particularly in small dataset scenarios. The model tends to memorize rather than generalize.\n\nLower risk due to stochastic exploration and reward-based correction mechanisms.\n\nCost Efficiency\n\nCan be expensive due to the need for large-scale data collection and compute-intensive retraining cycles.\n\nMore efficient with small datasets, especially when using LoRA adapters for modular fine-tuning.\n\nExamples from Industry\n\nLanguage modeling, translation, instruction-following with curated corpora (e.g., FLAN, Alpaca).\n\nCUDA kernel generation from PyTorch (Triton), legal case summarization, rare disease diagnosis, financial modeling.\n\n**Feature**\n\n**SFT**\n\n**RFT**\n\nLearning Paradigm\n\nOffline learning using static datasets where model weights are adjusted to match labeled outputs.\n\nOnline learning where model iteratively generates outputs, receives scores, and updates based on feedback.\n\nData Requirement\n\nRequires thousands of labeled examples to generalize well, especially in complex domains.\n\nAchieves robust performance with as few as 10–100 high-quality prompts and verifiable reward mechanisms.\n\nSupervision Method\n\nRelies entirely on human-curated prompt-response pairs for training.\n\nUses reward functions that score outputs based on correctness, structure, compilation success, or task-specific logic.\n\nReasoning Capability\n\nLimited to patterns observed in training data; does not generalize well to unseen logic or reasoning strategies.\n\nEncourages exploratory behavior and chain-of-thought development to solve complex or multi-step tasks.\n\nAdaptability\n\nInflexible once trained—new data or distribution shifts require retraining from scratch.\n\nDynamic learning enabled by online feedback allows the model to continually improve and adapt.\n\nUse Case Fit\n\nBest suited for tasks like translation, rephrasing, or summarization where outputs have stylistic or format regularity.\n\nIdeal for domains requiring objective correctness, such as code generation, scientific reasoning, and decision-making support.\n\nOverfitting Risk\n\nHigh, particularly in small dataset scenarios. The model tends to memorize rather than generalize.\n\nLower risk due to stochastic exploration and reward-based correction mechanisms.\n\nCost Efficiency\n\nCan be expensive due to the need for large-scale data collection and compute-intensive retraining cycles.\n\nMore efficient with small datasets, especially when using LoRA adapters for modular fine-tuning.\n\nExamples from Industry\n\nLanguage modeling, translation, instruction-following with curated corpora (e.g., FLAN, Alpaca).\n\nCUDA kernel generation from PyTorch (Triton), legal case summarization, rare disease diagnosis, financial modeling.",
    "contentLength": 6853,
    "wordCount": 520,
    "hasCode": false,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#tabular-comparison"
  },
  {
    "id": "ai-reinforcement-finetuning-preventing-overfitting-11",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "The Role of the Grader",
    "title": "Preventing Overfitting",
    "order": 11,
    "orderInChapter": 1,
    "contentHtml": "<ul>\n  <li>\n    <p>Mitigating overfitting is a key concern when training under reinforcement signals—especially when data is sparse. RFT systems incorporate several mechanisms to ensure generalization:</p>\n\n    <ul>\n      <li>\n        <p><strong>Validation prompts</strong> are used to evaluate whether improvements generalize to unseen examples. If a model performs well only on training tasks but poorly on validation prompts, it may be overfitting to the reward function itself.</p>\n      </li>\n      <li>\n        <p><strong>Partial credit scoring</strong> helps reduce the brittleness of learning by avoiding binary pass/fail conditions that can stall progress. This ensures that models are encouraged for getting close, rather than punished for being imperfect.</p>\n      </li>\n      <li>\n        <p><strong>Anti-reward hacking tools</strong> like monkey-patching ensure that the model doesn’t simply find tricks to “pass the test” without solving the problem. For example, if a model generates code that bypasses a kernel by outputting <code class=\"language-plaintext highlighter-rouge\">torch.sum()</code> instead of executing a GPU-level reduction, the grader can detect this and nullify the reward.</p>\n      </li>\n    </ul>\n  </li>\n</ul>\n<p>Mitigating overfitting is a key concern when training under reinforcement signals—especially when data is sparse. RFT systems incorporate several mechanisms to ensure generalization:</p>\n<ul>\n      <li>\n        <p><strong>Validation prompts</strong> are used to evaluate whether improvements generalize to unseen examples. If a model performs well only on training tasks but poorly on validation prompts, it may be overfitting to the reward function itself.</p>\n      </li>\n      <li>\n        <p><strong>Partial credit scoring</strong> helps reduce the brittleness of learning by avoiding binary pass/fail conditions that can stall progress. This ensures that models are encouraged for getting close, rather than punished for being imperfect.</p>\n      </li>\n      <li>\n        <p><strong>Anti-reward hacking tools</strong> like monkey-patching ensure that the model doesn’t simply find tricks to “pass the test” without solving the problem. For example, if a model generates code that bypasses a kernel by outputting <code class=\"language-plaintext highlighter-rouge\">torch.sum()</code> instead of executing a GPU-level reduction, the grader can detect this and nullify the reward.</p>\n      </li>\n    </ul>\n<p><strong>Validation prompts</strong> are used to evaluate whether improvements generalize to unseen examples. If a model performs well only on training tasks but poorly on validation prompts, it may be overfitting to the reward function itself.</p>\n<p><strong>Partial credit scoring</strong> helps reduce the brittleness of learning by avoiding binary pass/fail conditions that can stall progress. This ensures that models are encouraged for getting close, rather than punished for being imperfect.</p>\n<p><strong>Anti-reward hacking tools</strong> like monkey-patching ensure that the model doesn’t simply find tricks to “pass the test” without solving the problem. For example, if a model generates code that bypasses a kernel by outputting <code class=\"language-plaintext highlighter-rouge\">torch.sum()</code> instead of executing a GPU-level reduction, the grader can detect this and nullify the reward.</p>",
    "contentMarkdown": "*   Mitigating overfitting is a key concern when training under reinforcement signals—especially when data is sparse. RFT systems incorporate several mechanisms to ensure generalization:\n    \n    *   **Validation prompts** are used to evaluate whether improvements generalize to unseen examples. If a model performs well only on training tasks but poorly on validation prompts, it may be overfitting to the reward function itself.\n        \n    *   **Partial credit scoring** helps reduce the brittleness of learning by avoiding binary pass/fail conditions that can stall progress. This ensures that models are encouraged for getting close, rather than punished for being imperfect.\n        \n    *   **Anti-reward hacking tools** like monkey-patching ensure that the model doesn’t simply find tricks to “pass the test” without solving the problem. For example, if a model generates code that bypasses a kernel by outputting `torch.sum()` instead of executing a GPU-level reduction, the grader can detect this and nullify the reward.\n        \n\nMitigating overfitting is a key concern when training under reinforcement signals—especially when data is sparse. RFT systems incorporate several mechanisms to ensure generalization:\n\n*   **Validation prompts** are used to evaluate whether improvements generalize to unseen examples. If a model performs well only on training tasks but poorly on validation prompts, it may be overfitting to the reward function itself.\n    \n*   **Partial credit scoring** helps reduce the brittleness of learning by avoiding binary pass/fail conditions that can stall progress. This ensures that models are encouraged for getting close, rather than punished for being imperfect.\n    \n*   **Anti-reward hacking tools** like monkey-patching ensure that the model doesn’t simply find tricks to “pass the test” without solving the problem. For example, if a model generates code that bypasses a kernel by outputting `torch.sum()` instead of executing a GPU-level reduction, the grader can detect this and nullify the reward.\n    \n\n**Validation prompts** are used to evaluate whether improvements generalize to unseen examples. If a model performs well only on training tasks but poorly on validation prompts, it may be overfitting to the reward function itself.\n\n**Partial credit scoring** helps reduce the brittleness of learning by avoiding binary pass/fail conditions that can stall progress. This ensures that models are encouraged for getting close, rather than punished for being imperfect.\n\n**Anti-reward hacking tools** like monkey-patching ensure that the model doesn’t simply find tricks to “pass the test” without solving the problem. For example, if a model generates code that bypasses a kernel by outputting `torch.sum()` instead of executing a GPU-level reduction, the grader can detect this and nullify the reward.",
    "contentLength": 3372,
    "wordCount": 407,
    "hasCode": true,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#preventing-overfitting"
  },
  {
    "id": "ai-reinforcement-finetuning-why-use-rft-for-this-task-12",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "Case Study: Python-to-Triton Transpilation",
    "title": "Why Use RFT for This Task?",
    "order": 12,
    "orderInChapter": 1,
    "contentHtml": "<ul>\n  <li>\n    <p>This particular problem—converting PyTorch functions into efficient Triton kernels—was exceptionally well-suited to a RL approach, and the team at Predibase selected RL over traditional supervised fine-tuning for several compelling reasons:</p>\n\n    <ul>\n      <li>\n        <p><strong>Lack of Labeled Data</strong>: There is no widely available dataset mapping PyTorch code to optimized Triton kernels. Building such a dataset would require substantial manual effort from domain experts. Instead, the team curated a small, high-quality dataset of just 13 examples, demonstrating RL’s ability to learn effectively even when labeled data is minimal.</p>\n      </li>\n      <li>\n        <p><strong>Programmatic Verifiability</strong>: While labeled outputs are hard to define in this context, it is easy to verify whether a generated kernel is valid. The model’s outputs can be tested deterministically—checking if they compile, if they pass runtime tests, and if their outputs match the original PyTorch implementations. This makes RL ideal, as it allows the use of reward functions to define success, rather than relying on labeled pairs.</p>\n      </li>\n      <li>\n        <p><strong>Large Search Space</strong>: There are many possible ways to write a correct Triton kernel, and not all are equally efficient. RL helps the model explore this vast search space of possible solutions, balancing the need to discover new implementations with reinforcing successful strategies already learned from pretraining.</p>\n      </li>\n    </ul>\n  </li>\n  <li>These properties—label-scarcity, reward-driven supervision, and a wide search landscape—make RL not just applicable, but optimal for this kind of code generation task.</li>\n  <li>One important point to note is that per <a href=\"https://predibase.com/blog/introducing-reinforcement-fine-tuning-on-predibase\">Introducing the First End-to-End Platform for Reinforcement Fine-Tuning</a>, baking in a limited supervised fine-tuning warm-up step to the training recipe before initiating RFT can improve performance.</li>\n</ul>\n<p>This particular problem—converting PyTorch functions into efficient Triton kernels—was exceptionally well-suited to a RL approach, and the team at Predibase selected RL over traditional supervised fine-tuning for several compelling reasons:</p>\n<ul>\n      <li>\n        <p><strong>Lack of Labeled Data</strong>: There is no widely available dataset mapping PyTorch code to optimized Triton kernels. Building such a dataset would require substantial manual effort from domain experts. Instead, the team curated a small, high-quality dataset of just 13 examples, demonstrating RL’s ability to learn effectively even when labeled data is minimal.</p>\n      </li>\n      <li>\n        <p><strong>Programmatic Verifiability</strong>: While labeled outputs are hard to define in this context, it is easy to verify whether a generated kernel is valid. The model’s outputs can be tested deterministically—checking if they compile, if they pass runtime tests, and if their outputs match the original PyTorch implementations. This makes RL ideal, as it allows the use of reward functions to define success, rather than relying on labeled pairs.</p>\n      </li>\n      <li>\n        <p><strong>Large Search Space</strong>: There are many possible ways to write a correct Triton kernel, and not all are equally efficient. RL helps the model explore this vast search space of possible solutions, balancing the need to discover new implementations with reinforcing successful strategies already learned from pretraining.</p>\n      </li>\n    </ul>\n<p><strong>Lack of Labeled Data</strong>: There is no widely available dataset mapping PyTorch code to optimized Triton kernels. Building such a dataset would require substantial manual effort from domain experts. Instead, the team curated a small, high-quality dataset of just 13 examples, demonstrating RL’s ability to learn effectively even when labeled data is minimal.</p>\n<p><strong>Programmatic Verifiability</strong>: While labeled outputs are hard to define in this context, it is easy to verify whether a generated kernel is valid. The model’s outputs can be tested deterministically—checking if they compile, if they pass runtime tests, and if their outputs match the original PyTorch implementations. This makes RL ideal, as it allows the use of reward functions to define success, rather than relying on labeled pairs.</p>\n<p><strong>Large Search Space</strong>: There are many possible ways to write a correct Triton kernel, and not all are equally efficient. RL helps the model explore this vast search space of possible solutions, balancing the need to discover new implementations with reinforcing successful strategies already learned from pretraining.</p>",
    "contentMarkdown": "*   This particular problem—converting PyTorch functions into efficient Triton kernels—was exceptionally well-suited to a RL approach, and the team at Predibase selected RL over traditional supervised fine-tuning for several compelling reasons:\n    \n    *   **Lack of Labeled Data**: There is no widely available dataset mapping PyTorch code to optimized Triton kernels. Building such a dataset would require substantial manual effort from domain experts. Instead, the team curated a small, high-quality dataset of just 13 examples, demonstrating RL’s ability to learn effectively even when labeled data is minimal.\n        \n    *   **Programmatic Verifiability**: While labeled outputs are hard to define in this context, it is easy to verify whether a generated kernel is valid. The model’s outputs can be tested deterministically—checking if they compile, if they pass runtime tests, and if their outputs match the original PyTorch implementations. This makes RL ideal, as it allows the use of reward functions to define success, rather than relying on labeled pairs.\n        \n    *   **Large Search Space**: There are many possible ways to write a correct Triton kernel, and not all are equally efficient. RL helps the model explore this vast search space of possible solutions, balancing the need to discover new implementations with reinforcing successful strategies already learned from pretraining.\n        \n*   These properties—label-scarcity, reward-driven supervision, and a wide search landscape—make RL not just applicable, but optimal for this kind of code generation task.\n*   One important point to note is that per [Introducing the First End-to-End Platform for Reinforcement Fine-Tuning](https://predibase.com/blog/introducing-reinforcement-fine-tuning-on-predibase), baking in a limited supervised fine-tuning warm-up step to the training recipe before initiating RFT can improve performance.\n\nThis particular problem—converting PyTorch functions into efficient Triton kernels—was exceptionally well-suited to a RL approach, and the team at Predibase selected RL over traditional supervised fine-tuning for several compelling reasons:\n\n*   **Lack of Labeled Data**: There is no widely available dataset mapping PyTorch code to optimized Triton kernels. Building such a dataset would require substantial manual effort from domain experts. Instead, the team curated a small, high-quality dataset of just 13 examples, demonstrating RL’s ability to learn effectively even when labeled data is minimal.\n    \n*   **Programmatic Verifiability**: While labeled outputs are hard to define in this context, it is easy to verify whether a generated kernel is valid. The model’s outputs can be tested deterministically—checking if they compile, if they pass runtime tests, and if their outputs match the original PyTorch implementations. This makes RL ideal, as it allows the use of reward functions to define success, rather than relying on labeled pairs.\n    \n*   **Large Search Space**: There are many possible ways to write a correct Triton kernel, and not all are equally efficient. RL helps the model explore this vast search space of possible solutions, balancing the need to discover new implementations with reinforcing successful strategies already learned from pretraining.\n    \n\n**Lack of Labeled Data**: There is no widely available dataset mapping PyTorch code to optimized Triton kernels. Building such a dataset would require substantial manual effort from domain experts. Instead, the team curated a small, high-quality dataset of just 13 examples, demonstrating RL’s ability to learn effectively even when labeled data is minimal.\n\n**Programmatic Verifiability**: While labeled outputs are hard to define in this context, it is easy to verify whether a generated kernel is valid. The model’s outputs can be tested deterministically—checking if they compile, if they pass runtime tests, and if their outputs match the original PyTorch implementations. This makes RL ideal, as it allows the use of reward functions to define success, rather than relying on labeled pairs.\n\n**Large Search Space**: There are many possible ways to write a correct Triton kernel, and not all are equally efficient. RL helps the model explore this vast search space of possible solutions, balancing the need to discover new implementations with reinforcing successful strategies already learned from pretraining.",
    "contentLength": 4792,
    "wordCount": 629,
    "hasCode": false,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#why-use-rft-for-this-task?"
  },
  {
    "id": "ai-reinforcement-finetuning-system-user-messages-13",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "Case Study: Python-to-Triton Transpilation",
    "title": "System & User Messages",
    "order": 13,
    "orderInChapter": 2,
    "contentHtml": "<ul>\n  <li>\n    <p>To effectively steer the model’s generation, Predibase designed specific system and user messages that framed the task with clarity and constraints. This prompt engineering step ensured the model understood the task boundaries and could avoid common failure patterns.</p>\n  </li>\n  <li><strong>System messages</strong> defined the role and expectations of the model. The model was instructed to:\n    <ul>\n      <li>Generate Triton kernels for given PyTorch functions.</li>\n      <li>Wrap the kernel code inside specific tags, such as <code class=\"language-plaintext highlighter-rouge\">&lt;triton_code&gt; ... &lt;/triton_code&gt;</code>, so that it could be programmatically extracted and validated.</li>\n      <li>Import the necessary Triton modules.</li>\n      <li>Maintain a consistent and valid function signature.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Additionally, the prompt discouraged use of PyTorch functions that would bypass actual GPU computation. This ensured the generated solution truly used Triton, not fallback CPU operations.</p>\n  </li>\n  <li>\n    <p>This structured prompting was essential in preemptively addressing common generation issues—such as returning PyTorch results, omitting imports, or failing to encapsulate code in the required tags.</p>\n  </li>\n  <li>The following figure (<a href=\"https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning\">source</a>) shows an example of how system and user messages were designed to enforce structured responses.</li>\n</ul>\n<p>To effectively steer the model’s generation, Predibase designed specific system and user messages that framed the task with clarity and constraints. This prompt engineering step ensured the model understood the task boundaries and could avoid common failure patterns.</p>\n<ul>\n      <li>Generate Triton kernels for given PyTorch functions.</li>\n      <li>Wrap the kernel code inside specific tags, such as <code class=\"language-plaintext highlighter-rouge\">&lt;triton_code&gt; ... &lt;/triton_code&gt;</code>, so that it could be programmatically extracted and validated.</li>\n      <li>Import the necessary Triton modules.</li>\n      <li>Maintain a consistent and valid function signature.</li>\n    </ul>\n<p>Additionally, the prompt discouraged use of PyTorch functions that would bypass actual GPU computation. This ensured the generated solution truly used Triton, not fallback CPU operations.</p>\n<p>This structured prompting was essential in preemptively addressing common generation issues—such as returning PyTorch results, omitting imports, or failing to encapsulate code in the required tags.</p>\n<p><img src=\"/primers/ai/assets/RFT/SystemUserMessagesExample.jpg\" alt=\"\"></p>\n<ul>\n  <li>These constraints provided the foundation upon which the reward mechanisms could operate reliably—ensuring that evaluations of formatting, compilation, and correctness were meaningful and measurable.</li>\n</ul>",
    "contentMarkdown": "*   To effectively steer the model’s generation, Predibase designed specific system and user messages that framed the task with clarity and constraints. This prompt engineering step ensured the model understood the task boundaries and could avoid common failure patterns.\n    \n*   **System messages** defined the role and expectations of the model. The model was instructed to:\n    *   Generate Triton kernels for given PyTorch functions.\n    *   Wrap the kernel code inside specific tags, such as `<triton_code> ... </triton_code>`, so that it could be programmatically extracted and validated.\n    *   Import the necessary Triton modules.\n    *   Maintain a consistent and valid function signature.\n*   Additionally, the prompt discouraged use of PyTorch functions that would bypass actual GPU computation. This ensured the generated solution truly used Triton, not fallback CPU operations.\n    \n*   This structured prompting was essential in preemptively addressing common generation issues—such as returning PyTorch results, omitting imports, or failing to encapsulate code in the required tags.\n    \n*   The following figure ([source](https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning)) shows an example of how system and user messages were designed to enforce structured responses.\n\nTo effectively steer the model’s generation, Predibase designed specific system and user messages that framed the task with clarity and constraints. This prompt engineering step ensured the model understood the task boundaries and could avoid common failure patterns.\n\n*   Generate Triton kernels for given PyTorch functions.\n*   Wrap the kernel code inside specific tags, such as `<triton_code> ... </triton_code>`, so that it could be programmatically extracted and validated.\n*   Import the necessary Triton modules.\n*   Maintain a consistent and valid function signature.\n\nAdditionally, the prompt discouraged use of PyTorch functions that would bypass actual GPU computation. This ensured the generated solution truly used Triton, not fallback CPU operations.\n\nThis structured prompting was essential in preemptively addressing common generation issues—such as returning PyTorch results, omitting imports, or failing to encapsulate code in the required tags.\n\n![](/primers/ai/assets/RFT/SystemUserMessagesExample.jpg)\n\n*   These constraints provided the foundation upon which the reward mechanisms could operate reliably—ensuring that evaluations of formatting, compilation, and correctness were meaningful and measurable.",
    "contentLength": 2965,
    "wordCount": 333,
    "hasCode": true,
    "hasMath": false,
    "hasImages": true,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#system-&-user-messages"
  },
  {
    "id": "ai-reinforcement-finetuning-rewards-14",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "Case Study: Python-to-Triton Transpilation",
    "title": "Rewards",
    "order": 14,
    "orderInChapter": 3,
    "contentHtml": "<h4 id=\"formatting-reward\">Formatting Reward</h4>\n<ul>\n  <li>\n    <p>The formatting reward was designed to ensure that the model adhered to the syntactic and structural requirements of Triton kernels.</p>\n\n    <ul>\n      <li>The grader checked whether generated completions contained the necessary structure, such as wrapping code within <code class=\"language-plaintext highlighter-rouge\">&lt;triton_code&gt;</code> tags.</li>\n      <li>It verified if the <code class=\"language-plaintext highlighter-rouge\">@triton.jit</code> decorator was used and whether the Triton library was correctly imported.</li>\n      <li>Beyond these simple checks, the grader also rewarded the correct use of Triton-specific constructs, such as:\n        <ul>\n          <li>Avoiding non-Triton operations.</li>\n          <li>Correct use of masking during memory load/store operations.</li>\n          <li>Properly initialized output buffers (e.g., using <code class=\"language-plaintext highlighter-rouge\">torch.zeros()</code> or <code class=\"language-plaintext highlighter-rouge\">torch.full()</code>).</li>\n        </ul>\n      </li>\n      <li>The score for this reward was computed by summing fractional credit assigned to each formatting criterion. The final reward was normalized to fall between 0 and 1.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The following example (<a href=\"https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning\">source</a>) shows what a correctly formatted response looks like, including required tags and structural compliance.</p>\n  </li>\n</ul>\n<p>The formatting reward was designed to ensure that the model adhered to the syntactic and structural requirements of Triton kernels.</p>\n<ul>\n      <li>The grader checked whether generated completions contained the necessary structure, such as wrapping code within <code class=\"language-plaintext highlighter-rouge\">&lt;triton_code&gt;</code> tags.</li>\n      <li>It verified if the <code class=\"language-plaintext highlighter-rouge\">@triton.jit</code> decorator was used and whether the Triton library was correctly imported.</li>\n      <li>Beyond these simple checks, the grader also rewarded the correct use of Triton-specific constructs, such as:\n        <ul>\n          <li>Avoiding non-Triton operations.</li>\n          <li>Correct use of masking during memory load/store operations.</li>\n          <li>Properly initialized output buffers (e.g., using <code class=\"language-plaintext highlighter-rouge\">torch.zeros()</code> or <code class=\"language-plaintext highlighter-rouge\">torch.full()</code>).</li>\n        </ul>\n      </li>\n      <li>The score for this reward was computed by summing fractional credit assigned to each formatting criterion. The final reward was normalized to fall between 0 and 1.</li>\n    </ul>\n<ul>\n          <li>Avoiding non-Triton operations.</li>\n          <li>Correct use of masking during memory load/store operations.</li>\n          <li>Properly initialized output buffers (e.g., using <code class=\"language-plaintext highlighter-rouge\">torch.zeros()</code> or <code class=\"language-plaintext highlighter-rouge\">torch.full()</code>).</li>\n        </ul>\n<p>The following example (<a href=\"https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning\">source</a>) shows what a correctly formatted response looks like, including required tags and structural compliance.</p>\n<p><img src=\"/primers/ai/assets/RFT/FormattingRewardExample.jpg\" alt=\"\"></p>\n<h4 id=\"compilation-reward\">Compilation Reward</h4>\n<ul>\n  <li>\n    <p>The compilation reward evaluated whether the generated code could be parsed and executed without any runtime or syntax errors.</p>\n\n    <ul>\n      <li>The primary objective was to enforce a consistent code structure that could pass through Triton’s compiler successfully.</li>\n      <li>This reward acted as a critical stepping stone: it ensured that even if the generated kernel wasn’t yet functionally correct, it was at least syntactically valid.</li>\n      <li>This allowed the model to incrementally improve output fidelity without stalling due to hard compilation failures.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The following visual (<a href=\"https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning\">source</a>) shows how compilation success is validated as part of the reward pipeline.</p>\n  </li>\n</ul>\n<p>The compilation reward evaluated whether the generated code could be parsed and executed without any runtime or syntax errors.</p>\n<ul>\n      <li>The primary objective was to enforce a consistent code structure that could pass through Triton’s compiler successfully.</li>\n      <li>This reward acted as a critical stepping stone: it ensured that even if the generated kernel wasn’t yet functionally correct, it was at least syntactically valid.</li>\n      <li>This allowed the model to incrementally improve output fidelity without stalling due to hard compilation failures.</li>\n    </ul>\n<p>The following visual (<a href=\"https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning\">source</a>) shows how compilation success is validated as part of the reward pipeline.</p>\n<p><img src=\"/primers/ai/assets/RFT/CompilationSuccessCheck.jpg\" alt=\"\"></p>\n<h4 id=\"correctness-reward\">Correctness Reward</h4>\n<ul>\n  <li>\n    <p>The correctness reward provided the strongest signal in the system, directly measuring the output accuracy of the generated kernel.</p>\n\n    <ul>\n      <li>At first, the model was rewarded for simply generating code that could execute without crashing (i.e., avoiding runtime exceptions). This helped the model get past critical errors and focus on logical correctness.</li>\n      <li>More rigorous correctness was later enforced by comparing the output of the generated Triton kernel to that of the reference PyTorch implementation across several test inputs.</li>\n      <li>Initially, two test cases were used. This was later expanded to four to provide finer-grained reward shaping.</li>\n      <li>The score was scaled based on how many test cases passed:<br>\n<code class=\"language-plaintext highlighter-rouge\">correctness_score = (# of passed test cases) / (total test cases)</code></li>\n      <li>This reward was capped at 1.0 and provided a continuous signal for partial correctness.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The following figure (<a href=\"https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning\">source</a>) illustrates how the model’s outputs are scored based on test case validation.</p>\n  </li>\n</ul>\n<p>The correctness reward provided the strongest signal in the system, directly measuring the output accuracy of the generated kernel.</p>\n<ul>\n      <li>At first, the model was rewarded for simply generating code that could execute without crashing (i.e., avoiding runtime exceptions). This helped the model get past critical errors and focus on logical correctness.</li>\n      <li>More rigorous correctness was later enforced by comparing the output of the generated Triton kernel to that of the reference PyTorch implementation across several test inputs.</li>\n      <li>Initially, two test cases were used. This was later expanded to four to provide finer-grained reward shaping.</li>\n      <li>The score was scaled based on how many test cases passed:<br>\n<code class=\"language-plaintext highlighter-rouge\">correctness_score = (# of passed test cases) / (total test cases)</code></li>\n      <li>This reward was capped at 1.0 and provided a continuous signal for partial correctness.</li>\n    </ul>\n<p>The following figure (<a href=\"https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning\">source</a>) illustrates how the model’s outputs are scored based on test case validation.</p>\n<p><img src=\"/primers/ai/assets/RFT/CorrectnessEvaluationExample.jpg\" alt=\"\"></p>\n<h4 id=\"anti-reward-hacking-mechanisms\">Anti-Reward Hacking Mechanisms</h4>\n<ul>\n  <li>\n    <p>As with many RL systems, the model began to exploit loopholes in the reward structure early in training.</p>\n\n    <ul>\n      <li>For instance, it learned to simply return outputs from the original PyTorch function instead of computing results using the Triton kernel. In one case, the model returned <code class=\"language-plaintext highlighter-rouge\">torch.sum()</code> rather than performing an actual reduction operation within the kernel.</li>\n      <li>To detect this behavior, the development team implemented monkey-patching techniques: they would replace the generated Triton kernel with a no-op version and compare the results. If the outputs matched the no-op, the model received a reward of 0, signaling a “reward hacking” attempt.</li>\n      <li>These mechanisms were essential to steering the model away from shortcut solutions and encouraging genuine kernel implementation.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The following figure (<a href=\"https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning\">source</a>) shows how the system detects and penalizes reward hacking behaviors.</p>\n  </li>\n</ul>\n<p>As with many RL systems, the model began to exploit loopholes in the reward structure early in training.</p>\n<ul>\n      <li>For instance, it learned to simply return outputs from the original PyTorch function instead of computing results using the Triton kernel. In one case, the model returned <code class=\"language-plaintext highlighter-rouge\">torch.sum()</code> rather than performing an actual reduction operation within the kernel.</li>\n      <li>To detect this behavior, the development team implemented monkey-patching techniques: they would replace the generated Triton kernel with a no-op version and compare the results. If the outputs matched the no-op, the model received a reward of 0, signaling a “reward hacking” attempt.</li>\n      <li>These mechanisms were essential to steering the model away from shortcut solutions and encouraging genuine kernel implementation.</li>\n    </ul>\n<p>The following figure (<a href=\"https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning\">source</a>) shows how the system detects and penalizes reward hacking behaviors.</p>\n<p><img src=\"/primers/ai/assets/RFT/AntiHackingDetection.jpg\" alt=\"\"></p>",
    "contentMarkdown": "#### Formatting Reward\n\n*   The formatting reward was designed to ensure that the model adhered to the syntactic and structural requirements of Triton kernels.\n    \n    *   The grader checked whether generated completions contained the necessary structure, such as wrapping code within `<triton_code>` tags.\n    *   It verified if the `@triton.jit` decorator was used and whether the Triton library was correctly imported.\n    *   Beyond these simple checks, the grader also rewarded the correct use of Triton-specific constructs, such as:\n        *   Avoiding non-Triton operations.\n        *   Correct use of masking during memory load/store operations.\n        *   Properly initialized output buffers (e.g., using `torch.zeros()` or `torch.full()`).\n    *   The score for this reward was computed by summing fractional credit assigned to each formatting criterion. The final reward was normalized to fall between 0 and 1.\n*   The following example ([source](https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning)) shows what a correctly formatted response looks like, including required tags and structural compliance.\n    \n\nThe formatting reward was designed to ensure that the model adhered to the syntactic and structural requirements of Triton kernels.\n\n*   The grader checked whether generated completions contained the necessary structure, such as wrapping code within `<triton_code>` tags.\n*   It verified if the `@triton.jit` decorator was used and whether the Triton library was correctly imported.\n*   Beyond these simple checks, the grader also rewarded the correct use of Triton-specific constructs, such as:\n    *   Avoiding non-Triton operations.\n    *   Correct use of masking during memory load/store operations.\n    *   Properly initialized output buffers (e.g., using `torch.zeros()` or `torch.full()`).\n*   The score for this reward was computed by summing fractional credit assigned to each formatting criterion. The final reward was normalized to fall between 0 and 1.\n\n*   Avoiding non-Triton operations.\n*   Correct use of masking during memory load/store operations.\n*   Properly initialized output buffers (e.g., using `torch.zeros()` or `torch.full()`).\n\nThe following example ([source](https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning)) shows what a correctly formatted response looks like, including required tags and structural compliance.\n\n![](/primers/ai/assets/RFT/FormattingRewardExample.jpg)\n\n#### Compilation Reward\n\n*   The compilation reward evaluated whether the generated code could be parsed and executed without any runtime or syntax errors.\n    \n    *   The primary objective was to enforce a consistent code structure that could pass through Triton’s compiler successfully.\n    *   This reward acted as a critical stepping stone: it ensured that even if the generated kernel wasn’t yet functionally correct, it was at least syntactically valid.\n    *   This allowed the model to incrementally improve output fidelity without stalling due to hard compilation failures.\n*   The following visual ([source](https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning)) shows how compilation success is validated as part of the reward pipeline.\n    \n\nThe compilation reward evaluated whether the generated code could be parsed and executed without any runtime or syntax errors.\n\n*   The primary objective was to enforce a consistent code structure that could pass through Triton’s compiler successfully.\n*   This reward acted as a critical stepping stone: it ensured that even if the generated kernel wasn’t yet functionally correct, it was at least syntactically valid.\n*   This allowed the model to incrementally improve output fidelity without stalling due to hard compilation failures.\n\nThe following visual ([source](https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning)) shows how compilation success is validated as part of the reward pipeline.\n\n![](/primers/ai/assets/RFT/CompilationSuccessCheck.jpg)\n\n#### Correctness Reward\n\n*   The correctness reward provided the strongest signal in the system, directly measuring the output accuracy of the generated kernel.\n    \n    *   At first, the model was rewarded for simply generating code that could execute without crashing (i.e., avoiding runtime exceptions). This helped the model get past critical errors and focus on logical correctness.\n    *   More rigorous correctness was later enforced by comparing the output of the generated Triton kernel to that of the reference PyTorch implementation across several test inputs.\n    *   Initially, two test cases were used. This was later expanded to four to provide finer-grained reward shaping.\n    *   The score was scaled based on how many test cases passed:  \n        `correctness_score = (# of passed test cases) / (total test cases)`\n    *   This reward was capped at 1.0 and provided a continuous signal for partial correctness.\n*   The following figure ([source](https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning)) illustrates how the model’s outputs are scored based on test case validation.\n    \n\nThe correctness reward provided the strongest signal in the system, directly measuring the output accuracy of the generated kernel.\n\n*   At first, the model was rewarded for simply generating code that could execute without crashing (i.e., avoiding runtime exceptions). This helped the model get past critical errors and focus on logical correctness.\n*   More rigorous correctness was later enforced by comparing the output of the generated Triton kernel to that of the reference PyTorch implementation across several test inputs.\n*   Initially, two test cases were used. This was later expanded to four to provide finer-grained reward shaping.\n*   The score was scaled based on how many test cases passed:  \n    `correctness_score = (# of passed test cases) / (total test cases)`\n*   This reward was capped at 1.0 and provided a continuous signal for partial correctness.\n\nThe following figure ([source](https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning)) illustrates how the model’s outputs are scored based on test case validation.\n\n![](/primers/ai/assets/RFT/CorrectnessEvaluationExample.jpg)\n\n#### Anti-Reward Hacking Mechanisms\n\n*   As with many RL systems, the model began to exploit loopholes in the reward structure early in training.\n    \n    *   For instance, it learned to simply return outputs from the original PyTorch function instead of computing results using the Triton kernel. In one case, the model returned `torch.sum()` rather than performing an actual reduction operation within the kernel.\n    *   To detect this behavior, the development team implemented monkey-patching techniques: they would replace the generated Triton kernel with a no-op version and compare the results. If the outputs matched the no-op, the model received a reward of 0, signaling a “reward hacking” attempt.\n    *   These mechanisms were essential to steering the model away from shortcut solutions and encouraging genuine kernel implementation.\n*   The following figure ([source](https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning)) shows how the system detects and penalizes reward hacking behaviors.\n    \n\nAs with many RL systems, the model began to exploit loopholes in the reward structure early in training.\n\n*   For instance, it learned to simply return outputs from the original PyTorch function instead of computing results using the Triton kernel. In one case, the model returned `torch.sum()` rather than performing an actual reduction operation within the kernel.\n*   To detect this behavior, the development team implemented monkey-patching techniques: they would replace the generated Triton kernel with a no-op version and compare the results. If the outputs matched the no-op, the model received a reward of 0, signaling a “reward hacking” attempt.\n*   These mechanisms were essential to steering the model away from shortcut solutions and encouraging genuine kernel implementation.\n\nThe following figure ([source](https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning)) shows how the system detects and penalizes reward hacking behaviors.\n\n![](/primers/ai/assets/RFT/AntiHackingDetection.jpg)",
    "contentLength": 10430,
    "wordCount": 1092,
    "hasCode": true,
    "hasMath": false,
    "hasImages": true,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#rewards"
  },
  {
    "id": "ai-reinforcement-finetuning-coupling-grpo-and-lora-15",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "Case Study: Python-to-Triton Transpilation",
    "title": "Coupling GRPO and LoRA",
    "order": 15,
    "orderInChapter": 4,
    "contentHtml": "<ul>\n  <li>While GRPO provides structured, relative reward signals without needing a critic, LoRA enables efficient fine-tuning with low compute/memory footprint. Combined, they allow scalable reinforcement fine-tuning on large models with limited data and compute.</li>\n  <li>In this section, how a policy optimization algorithm such as GRPO and a parameter-efficient fine-tuning method such as LoRA are coupled together.</li>\n</ul>\n<h4 id=\"background-grpo-and-its-loss-function\">Background: GRPO and Its Loss Function</h4>\n<ul>\n  <li>\n    <p>In GRPO, for each prompt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-10\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-11\"><span class=\"mi\" id=\"MathJax-Span-12\" style=\"font-family: STIXGeneral-Italic;\">q</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-4\">q</script>, a group of <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-13\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-14\"><span class=\"mi\" id=\"MathJax-Span-15\" style=\"font-family: STIXGeneral-Italic;\">G</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>G</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-5\">G</script> completions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>2</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>o</mi><mi>G</mi></msub><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-16\" style=\"width: 7.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1006.41em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-17\"><span class=\"mo\" id=\"MathJax-Span-18\" style=\"font-family: STIXGeneral-Regular;\">{</span><span class=\"msubsup\" id=\"MathJax-Span-19\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-20\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-21\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-22\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-23\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-24\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-25\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-26\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-27\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">…</span><span class=\"mo\" id=\"MathJax-Span-28\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-29\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-30\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-31\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-32\" style=\"font-family: STIXGeneral-Regular;\">}</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo fence=\"false\" stretchy=\"false\">{</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>o</mi><mi>G</mi></msub><mo fence=\"false\" stretchy=\"false\">}</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-6\">\\{ o_1, o_2, \\ldots, o_G \\}</script> is sampled from the frozen old policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-33\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.62em, 2.555em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-34\"><span class=\"msubsup\" id=\"MathJax-Span-35\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-36\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-37\"><span class=\"mrow\" id=\"MathJax-Span-38\"><span class=\"msubsup\" id=\"MathJax-Span-39\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-40\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-41\"><span class=\"mrow\" id=\"MathJax-Span-42\"><span class=\"mtext\" id=\"MathJax-Span-43\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-7\">\\pi_{\\theta_{\\text{old}}}</script>. Each completion <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-44\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-45\"><span class=\"msubsup\" id=\"MathJax-Span-46\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-47\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-48\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-8\">o_i</script> is evaluated with a reward function, giving reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-49\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-50\"><span class=\"msubsup\" id=\"MathJax-Span-51\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-52\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-53\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-9\">r_i</script>.</p>\n  </li>\n  <li>\n    <p>We then compute the advantage for each output, which measures how much better or worse completion <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-54\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-55\"><span class=\"msubsup\" id=\"MathJax-Span-56\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-57\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-58\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-10\">o_i</script> is compared to its peers:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mi>&amp;#x03BC;</mi></mrow><mi>&amp;#x03C3;</mi></mfrac></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-59\" style=\"width: 5.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.794em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.836em, 1004.79em, 3.023em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-60\"><span class=\"msubsup\" id=\"MathJax-Span-61\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-62\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-63\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-64\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-65\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.284em, 1002.35em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.195em;\"><span class=\"mrow\" id=\"MathJax-Span-66\"><span class=\"msubsup\" id=\"MathJax-Span-67\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-68\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-69\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-70\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-71\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">μ</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;\"><span class=\"mi\" id=\"MathJax-Span-72\" style=\"font-family: STIXGeneral-Italic;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1002.5em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.503em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi></mrow><mi>σ</mi></mfrac></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-11\">A_i = \\frac{r_i - \\mu}{\\sigma}</script>\n\n    <ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BC;</mi><mo>=</mo><mfrac><mn>1</mn><mi>G</mi></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><msub><mi>r</mi><mi>j</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-73\" style=\"width: 6.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1005.73em, 2.815em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-74\"><span class=\"mi\" id=\"MathJax-Span-75\" style=\"font-family: STIXGeneral-Italic;\">μ</span><span class=\"mo\" id=\"MathJax-Span-76\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-77\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -4.424em; left: 50%; margin-left: -0.154em;\"><span class=\"mn\" id=\"MathJax-Span-78\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.258em;\"><span class=\"mi\" id=\"MathJax-Span-79\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.628em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-80\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-81\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-82\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.326em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-83\"><span class=\"mrow\" id=\"MathJax-Span-84\"><span class=\"mi\" id=\"MathJax-Span-85\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-86\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-87\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-88\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-89\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-90\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.622em; border-left: 0px solid; width: 0px; height: 1.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>μ</mi><mo>=</mo><mfrac><mn>1</mn><mi>G</mi></mfrac><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><msub><mi>r</mi><mi>j</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-12\">\\mu = \\frac{1}{G} \\sum_{j=1}^G r_j</script> is the group mean</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-91\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-92\"><span class=\"mi\" id=\"MathJax-Span-93\" style=\"font-family: STIXGeneral-Italic;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>σ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-13\">\\sigma</script> is the standard deviation across the group</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>The advantage estimations feed into the GRPO objective function, which can be written as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\"><span class=\"MathJax MathJax_FullWidth\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>J</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>GRPO</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>q</mi><mo>&amp;#x223C;</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><msub><mi>o</mi><mi>i</mi></msub><msubsup><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>O</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mrow><mo>[</mo><mrow><mfrac><mn>1</mn><mi>G</mi></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mrow><mo>(</mo><mrow><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><msub><mi>A</mi><mi>i</mi></msub><mo>,</mo><mtext>clip</mtext><mrow><mo>(</mo><mrow><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>,</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03F5;</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>&amp;#x03F5;</mi></mrow><mo>)</mo></mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>&amp;#x2212;</mo><mi>&amp;#x03B2;</mi><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>KL</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-94\" style=\"width: 100%; display: inline-block; min-width: 42.971em;\"><span style=\"display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(8.128em, 1035.58em, 16.409em, -999.997em); top: -8.956em; left: 0em; width: 100%;\"><span class=\"mrow\" id=\"MathJax-Span-95\"><span style=\"display: inline-block; position: relative; width: 100%; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.54em, 4.326em, -999.997em); top: -4.008em; left: 50%; margin-left: -1.768em;\"><span class=\"msubsup\" id=\"MathJax-Span-96\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-97\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-98\"><span class=\"mrow\" id=\"MathJax-Span-99\"><span class=\"mtext\" id=\"MathJax-Span-100\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">GRPO</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-101\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-102\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-103\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(2.138em, 1035.58em, 5.523em, -999.997em); top: -1.612em; left: 50%; margin-left: -17.862em;\"><span class=\"mo\" id=\"MathJax-Span-104\" style=\"font-family: STIXGeneral-Regular;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-105\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 8.492em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-106\"><span class=\"mrow\" id=\"MathJax-Span-107\"><span class=\"mi\" id=\"MathJax-Span-108\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.747em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-109\"><span class=\"mrow\" id=\"MathJax-Span-110\"><span class=\"mi\" id=\"MathJax-Span-111\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-112\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"mi\" id=\"MathJax-Span-113\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-114\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-115\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-116\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-117\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-118\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">{</span><span class=\"msubsup\" id=\"MathJax-Span-119\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-120\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-121\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-122\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-123\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">}</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.42em, 4.169em, -999.997em); top: -4.32em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-124\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.78em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-125\"><span class=\"mrow\" id=\"MathJax-Span-126\"><span class=\"mi\" id=\"MathJax-Span-127\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-128\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-129\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-130\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"msubsup\" id=\"MathJax-Span-131\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-132\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-133\"><span class=\"mrow\" id=\"MathJax-Span-134\"><span class=\"msubsup\" id=\"MathJax-Span-135\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-136\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-137\"><span class=\"mrow\" id=\"MathJax-Span-138\"><span class=\"mtext\" id=\"MathJax-Span-139\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-140\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-141\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">O</span><span class=\"texatom\" id=\"MathJax-Span-142\"><span class=\"mrow\" id=\"MathJax-Span-143\"><span class=\"mo\" id=\"MathJax-Span-144\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-145\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-146\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-147\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-148\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-149\"><span class=\"mfrac\" id=\"MathJax-Span-150\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-151\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.362em;\"><span class=\"mi\" id=\"MathJax-Span-152\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.84em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.836em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-153\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-154\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.94em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-155\"><span class=\"mrow\" id=\"MathJax-Span-156\"><span class=\"mi\" id=\"MathJax-Span-157\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-158\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-159\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.52em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-160\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-161\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">min</span><span class=\"mrow\" id=\"MathJax-Span-162\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-163\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-164\"><span class=\"mfrac\" id=\"MathJax-Span-165\"><span style=\"display: inline-block; position: relative; width: 4.013em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.13em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.612em;\"><span class=\"mrow\" id=\"MathJax-Span-166\"><span class=\"msubsup\" id=\"MathJax-Span-167\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-168\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-169\"><span class=\"mrow\" id=\"MathJax-Span-170\"><span class=\"mi\" id=\"MathJax-Span-171\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-172\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-173\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-174\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-175\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-176\"><span class=\"mrow\" id=\"MathJax-Span-177\"><span class=\"mo\" id=\"MathJax-Span-178\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-179\" style=\"font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-180\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.8em, 4.43em, -999.997em); top: -3.331em; left: 50%; margin-left: -1.924em;\"><span class=\"mrow\" id=\"MathJax-Span-181\"><span class=\"msubsup\" id=\"MathJax-Span-182\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-183\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-184\"><span class=\"mrow\" id=\"MathJax-Span-185\"><span class=\"msubsup\" id=\"MathJax-Span-186\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-187\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-188\"><span class=\"mrow\" id=\"MathJax-Span-189\"><span class=\"mtext\" id=\"MathJax-Span-190\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-191\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-192\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-193\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-194\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-195\"><span class=\"mrow\" id=\"MathJax-Span-196\"><span class=\"mo\" id=\"MathJax-Span-197\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-198\" style=\"font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-199\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.01em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.013em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-200\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-201\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-202\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-203\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-204\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">clip</span><span class=\"mrow\" id=\"MathJax-Span-205\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-206\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-207\"><span class=\"mfrac\" id=\"MathJax-Span-208\"><span style=\"display: inline-block; position: relative; width: 4.013em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.13em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.612em;\"><span class=\"mrow\" id=\"MathJax-Span-209\"><span class=\"msubsup\" id=\"MathJax-Span-210\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-211\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-212\"><span class=\"mrow\" id=\"MathJax-Span-213\"><span class=\"mi\" id=\"MathJax-Span-214\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-215\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-216\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-217\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-218\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-219\"><span class=\"mrow\" id=\"MathJax-Span-220\"><span class=\"mo\" id=\"MathJax-Span-221\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-222\" style=\"font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-223\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.8em, 4.43em, -999.997em); top: -3.331em; left: 50%; margin-left: -1.924em;\"><span class=\"mrow\" id=\"MathJax-Span-224\"><span class=\"msubsup\" id=\"MathJax-Span-225\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-226\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-227\"><span class=\"mrow\" id=\"MathJax-Span-228\"><span class=\"msubsup\" id=\"MathJax-Span-229\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-230\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-231\"><span class=\"mrow\" id=\"MathJax-Span-232\"><span class=\"mtext\" id=\"MathJax-Span-233\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-234\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-235\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-236\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-237\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-238\"><span class=\"mrow\" id=\"MathJax-Span-239\"><span class=\"mo\" id=\"MathJax-Span-240\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-241\" style=\"font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-242\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.01em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.013em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-243\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-244\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-245\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-246\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">ϵ</span><span class=\"mo\" id=\"MathJax-Span-247\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-248\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-249\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-250\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">ϵ</span></span><span class=\"mo\" id=\"MathJax-Span-251\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">)</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-252\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-253\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-254\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-255\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">)</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.065em;\"></span></span><span style=\"position: absolute; clip: rect(2.138em, 1007.19em, 5.523em, -999.997em); top: 1.93em; left: 50%; margin-left: -3.747em;\"><span class=\"mrow\" id=\"MathJax-Span-147-MathJax-Continue-1\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-149-MathJax-Continue-1\"><span class=\"mo\" id=\"MathJax-Span-256\" style=\"font-family: STIXGeneral-Regular;\">−</span><span class=\"mi\" id=\"MathJax-Span-257\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-258\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-259\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-260\"><span class=\"mrow\" id=\"MathJax-Span-261\"><span class=\"mtext\" id=\"MathJax-Span-262\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">KL</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-263\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-264\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-265\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-266\"><span class=\"mrow\" id=\"MathJax-Span-267\"><span class=\"mi\" id=\"MathJax-Span-268\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-269\"><span class=\"mrow\" id=\"MathJax-Span-270\"><span class=\"mo\" id=\"MathJax-Span-271\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"texatom\" id=\"MathJax-Span-272\"><span class=\"mrow\" id=\"MathJax-Span-273\"><span class=\"mo\" id=\"MathJax-Span-274\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-275\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-276\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-277\"><span class=\"mrow\" id=\"MathJax-Span-278\"><span class=\"mtext\" id=\"MathJax-Span-279\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-280\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-281\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.065em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 8.961em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -8.809em; border-left: 0px solid; width: 0px; height: 9.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>J</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>GRPO</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>q</mi><mo>∼</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mo fence=\"false\" stretchy=\"false\">{</mo><msub><mi>o</mi><mi>i</mi></msub><msubsup><mo fence=\"false\" stretchy=\"false\">}</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo>∼</mo><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><mi>O</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></msub><mrow><mo>[</mo><mrow><mfrac><mn>1</mn><mi>G</mi></mfrac><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><mo movablelimits=\"true\" form=\"prefix\">min</mo><mrow><mo>(</mo><mrow><mfrac><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>θ</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>q</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><msub><mi>A</mi><mi>i</mi></msub><mo>,</mo><mtext>clip</mtext><mrow><mo>(</mo><mrow><mfrac><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>θ</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>q</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>,</mo><mn>1</mn><mo>−</mo><mi>ϵ</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>ϵ</mi></mrow><mo>)</mo></mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>−</mo><mi>β</mi><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>KL</mtext></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>θ</mi></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-14\">J_{\\text{GRPO}}(\\theta) = \\mathbb{E}_{q \\sim P(Q), \\{o_i\\}_{i=1}^G \\sim \\pi_{\\theta_{\\text{old}}}(O|q)} \\left[ \\frac{1}{G} \\sum_{i=1}^G \\min \\left( \\frac{\\pi_{\\theta}(o_i|q)}{\\pi_{\\theta_{\\text{old}}}(o_i|q)} A_i, \\text{clip} \\left(\\frac{\\pi_{\\theta}(o_i|q)}{\\pi_{\\theta_{\\text{old}}}(o_i|q)}, 1-\\epsilon, 1+\\epsilon \\right) A_i \\right) - \\beta D_{\\text{KL}}(\\pi_{\\theta} || \\pi_{\\text{ref}}) \\right]</script>\n\n    <ul>\n      <li>This includes:\n        <ul>\n          <li>A clipped importance-weighted advantage term (inspired by PPO)</li>\n          <li>A KL penalty to keep the fine-tuned model close to a reference (e.g., SFT) model</li>\n          <li>All updates are based on comparing completions within the same group — no critic needed</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n</ul>\n<p>In GRPO, for each prompt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-10\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-11\"><span class=\"mi\" id=\"MathJax-Span-12\" style=\"font-family: STIXGeneral-Italic;\">q</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-4\">q</script>, a group of <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-13\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-14\"><span class=\"mi\" id=\"MathJax-Span-15\" style=\"font-family: STIXGeneral-Italic;\">G</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>G</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-5\">G</script> completions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>2</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>o</mi><mi>G</mi></msub><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-16\" style=\"width: 7.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1006.41em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-17\"><span class=\"mo\" id=\"MathJax-Span-18\" style=\"font-family: STIXGeneral-Regular;\">{</span><span class=\"msubsup\" id=\"MathJax-Span-19\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-20\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-21\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-22\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-23\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-24\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-25\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-26\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-27\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">…</span><span class=\"mo\" id=\"MathJax-Span-28\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-29\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-30\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-31\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-32\" style=\"font-family: STIXGeneral-Regular;\">}</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo fence=\"false\" stretchy=\"false\">{</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>o</mi><mi>G</mi></msub><mo fence=\"false\" stretchy=\"false\">}</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-6\">\\{ o_1, o_2, \\ldots, o_G \\}</script> is sampled from the frozen old policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-33\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.62em, 2.555em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-34\"><span class=\"msubsup\" id=\"MathJax-Span-35\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-36\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-37\"><span class=\"mrow\" id=\"MathJax-Span-38\"><span class=\"msubsup\" id=\"MathJax-Span-39\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-40\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-41\"><span class=\"mrow\" id=\"MathJax-Span-42\"><span class=\"mtext\" id=\"MathJax-Span-43\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-7\">\\pi_{\\theta_{\\text{old}}}</script>. Each completion <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-44\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-45\"><span class=\"msubsup\" id=\"MathJax-Span-46\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-47\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-48\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-8\">o_i</script> is evaluated with a reward function, giving reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-49\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-50\"><span class=\"msubsup\" id=\"MathJax-Span-51\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-52\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-53\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-9\">r_i</script>.</p>\n<p>We then compute the advantage for each output, which measures how much better or worse completion <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-54\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-55\"><span class=\"msubsup\" id=\"MathJax-Span-56\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-57\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-58\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-10\">o_i</script> is compared to its peers:</p>\n<ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BC;</mi><mo>=</mo><mfrac><mn>1</mn><mi>G</mi></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><msub><mi>r</mi><mi>j</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-73\" style=\"width: 6.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1005.73em, 2.815em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-74\"><span class=\"mi\" id=\"MathJax-Span-75\" style=\"font-family: STIXGeneral-Italic;\">μ</span><span class=\"mo\" id=\"MathJax-Span-76\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-77\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -4.424em; left: 50%; margin-left: -0.154em;\"><span class=\"mn\" id=\"MathJax-Span-78\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.258em;\"><span class=\"mi\" id=\"MathJax-Span-79\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.628em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-80\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-81\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-82\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.326em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-83\"><span class=\"mrow\" id=\"MathJax-Span-84\"><span class=\"mi\" id=\"MathJax-Span-85\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-86\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-87\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-88\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-89\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-90\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.622em; border-left: 0px solid; width: 0px; height: 1.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>μ</mi><mo>=</mo><mfrac><mn>1</mn><mi>G</mi></mfrac><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><msub><mi>r</mi><mi>j</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-12\">\\mu = \\frac{1}{G} \\sum_{j=1}^G r_j</script> is the group mean</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-91\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-92\"><span class=\"mi\" id=\"MathJax-Span-93\" style=\"font-family: STIXGeneral-Italic;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>σ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-13\">\\sigma</script> is the standard deviation across the group</li>\n        </ul>\n      </li>\n    </ul>\n<p>where:</p>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BC;</mi><mo>=</mo><mfrac><mn>1</mn><mi>G</mi></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><msub><mi>r</mi><mi>j</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-73\" style=\"width: 6.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1005.73em, 2.815em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-74\"><span class=\"mi\" id=\"MathJax-Span-75\" style=\"font-family: STIXGeneral-Italic;\">μ</span><span class=\"mo\" id=\"MathJax-Span-76\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-77\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -4.424em; left: 50%; margin-left: -0.154em;\"><span class=\"mn\" id=\"MathJax-Span-78\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.258em;\"><span class=\"mi\" id=\"MathJax-Span-79\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.628em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-80\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-81\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-82\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.326em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-83\"><span class=\"mrow\" id=\"MathJax-Span-84\"><span class=\"mi\" id=\"MathJax-Span-85\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-86\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-87\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-88\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-89\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-90\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.622em; border-left: 0px solid; width: 0px; height: 1.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>μ</mi><mo>=</mo><mfrac><mn>1</mn><mi>G</mi></mfrac><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><msub><mi>r</mi><mi>j</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-12\">\\mu = \\frac{1}{G} \\sum_{j=1}^G r_j</script> is the group mean</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-91\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-92\"><span class=\"mi\" id=\"MathJax-Span-93\" style=\"font-family: STIXGeneral-Italic;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>σ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-13\">\\sigma</script> is the standard deviation across the group</li>\n        </ul>\n<p>The advantage estimations feed into the GRPO objective function, which can be written as:</p>\n<ul>\n      <li>This includes:\n        <ul>\n          <li>A clipped importance-weighted advantage term (inspired by PPO)</li>\n          <li>A KL penalty to keep the fine-tuned model close to a reference (e.g., SFT) model</li>\n          <li>All updates are based on comparing completions within the same group — no critic needed</li>\n        </ul>\n      </li>\n    </ul>\n<ul>\n          <li>A clipped importance-weighted advantage term (inspired by PPO)</li>\n          <li>A KL penalty to keep the fine-tuned model close to a reference (e.g., SFT) model</li>\n          <li>All updates are based on comparing completions within the same group — no critic needed</li>\n        </ul>\n<h4 id=\"background-lora-rightarrow-efficient-low-rank-updates\">Background: LoRA <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-282\" style=\"width: 1.21em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.002em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.585em, 1000.92em, 2.252em, -999.998em); top: -2.165em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-283\"><span class=\"mo\" id=\"MathJax-Span-284\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.169em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.552em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-15\">\\rightarrow</script> Efficient Low-Rank Updates</h4>\n<ul>\n  <li>LoRA replaces full weight updates with low-rank decompositions. For a pre-trained weight matrix <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>W</mi><mn>0</mn></msub><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mo>&amp;#x00D7;</mo><mi>k</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-285\" style=\"width: 5.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.43em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1004.43em, 2.555em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-286\"><span class=\"msubsup\" id=\"MathJax-Span-287\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-288\" style=\"font-family: STIXGeneral-Italic;\">W<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.836em;\"><span class=\"mn\" id=\"MathJax-Span-289\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-290\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"msubsup\" id=\"MathJax-Span-291\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-292\"><span class=\"mrow\" id=\"MathJax-Span-293\"><span class=\"mi\" id=\"MathJax-Span-294\" style=\"font-family: STIXGeneral-Regular;\">ℝ</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-295\"><span class=\"mrow\" id=\"MathJax-Span-296\"><span class=\"mi\" id=\"MathJax-Span-297\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-298\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">×</span><span class=\"mi\" id=\"MathJax-Span-299\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>W</mi><mn>0</mn></msub><mo>∈</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">R</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>d</mi><mo>×</mo><mi>k</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">W_0 \\in \\mathbb{R}^{d \\times k}</script>, LoRA introduces:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>W</mi><mo>=</mo><msub><mi>W</mi><mn>0</mn></msub><mo>+</mo><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><mi>W</mi><mo>=</mo><msub><mi>W</mi><mn>0</mn></msub><mo>+</mo><mi>B</mi><mi>A</mi></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-300\" style=\"width: 13.44em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1011.15em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-301\"><span class=\"mi\" id=\"MathJax-Span-302\" style=\"font-family: STIXGeneral-Italic;\">W<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-303\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-304\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-305\" style=\"font-family: STIXGeneral-Italic;\">W<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.836em;\"><span class=\"mn\" id=\"MathJax-Span-306\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-307\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-308\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">Δ</span><span class=\"mi\" id=\"MathJax-Span-309\" style=\"font-family: STIXGeneral-Italic;\">W<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-310\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-311\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-312\" style=\"font-family: STIXGeneral-Italic;\">W<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.836em;\"><span class=\"mn\" id=\"MathJax-Span-313\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-314\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-315\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">B</span><span class=\"mi\" id=\"MathJax-Span-316\" style=\"font-family: STIXGeneral-Italic;\">A</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>W</mi><mo>=</mo><msub><mi>W</mi><mn>0</mn></msub><mo>+</mo><mi mathvariant=\"normal\">Δ</mi><mi>W</mi><mo>=</mo><msub><mi>W</mi><mn>0</mn></msub><mo>+</mo><mi>B</mi><mi>A</mi></math></span></span></div>\n<ul>\n  <li>where:\n    <ul>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>B</mi><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mo>&amp;#x00D7;</mo><mi>r</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-317\" style=\"width: 4.586em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1003.8em, 2.451em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-318\"><span class=\"mi\" id=\"MathJax-Span-319\" style=\"font-family: STIXGeneral-Italic;\">B</span><span class=\"mo\" id=\"MathJax-Span-320\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"msubsup\" id=\"MathJax-Span-321\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-322\"><span class=\"mrow\" id=\"MathJax-Span-323\"><span class=\"mi\" id=\"MathJax-Span-324\" style=\"font-family: STIXGeneral-Regular;\">ℝ</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-325\"><span class=\"mrow\" id=\"MathJax-Span-326\"><span class=\"mi\" id=\"MathJax-Span-327\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-328\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">×</span><span class=\"mi\" id=\"MathJax-Span-329\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>B</mi><mo>∈</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">R</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>d</mi><mo>×</mo><mi>r</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">B \\in \\mathbb{R}^{d \\times r}</script>, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mo>&amp;#x00D7;</mo><mi>k</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-330\" style=\"width: 4.586em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1003.8em, 2.451em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-331\"><span class=\"mi\" id=\"MathJax-Span-332\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-333\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"msubsup\" id=\"MathJax-Span-334\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-335\"><span class=\"mrow\" id=\"MathJax-Span-336\"><span class=\"mi\" id=\"MathJax-Span-337\" style=\"font-family: STIXGeneral-Regular;\">ℝ</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-338\"><span class=\"mrow\" id=\"MathJax-Span-339\"><span class=\"mi\" id=\"MathJax-Span-340\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-341\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">×</span><span class=\"mi\" id=\"MathJax-Span-342\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi><mo>∈</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">R</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>r</mi><mo>×</mo><mi>k</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">A \\in \\mathbb{R}^{r \\times k}</script></li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo>&amp;#x226A;</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mo stretchy=&quot;false&quot;>(</mo><mi>d</mi><mo>,</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-343\" style=\"width: 6.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1005.42em, 2.555em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-344\"><span class=\"mi\" id=\"MathJax-Span-345\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-346\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">≪</span><span class=\"mo\" id=\"MathJax-Span-347\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">min</span><span class=\"mo\" id=\"MathJax-Span-348\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-349\" style=\"font-family: STIXGeneral-Italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-350\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-351\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-352\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo>≪</mo><mo movablelimits=\"true\" form=\"prefix\">min</mo><mo stretchy=\"false\">(</mo><mi>d</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-20\">r \\ll \\min(d, k)</script> (e.g., 1–8)</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>W</mi><mn>0</mn></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-353\" style=\"width: 1.513em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.25em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-354\"><span class=\"msubsup\" id=\"MathJax-Span-355\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-356\" style=\"font-family: STIXGeneral-Italic;\">W<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.836em;\"><span class=\"mn\" id=\"MathJax-Span-357\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>W</mi><mn>0</mn></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-21\">W_0</script> is frozen</li>\n      <li>Only <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-358\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-359\"><span class=\"mi\" id=\"MathJax-Span-360\" style=\"font-family: STIXGeneral-Italic;\">A</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-22\">A</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>B</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-361\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-362\"><span class=\"mi\" id=\"MathJax-Span-363\" style=\"font-family: STIXGeneral-Italic;\">B</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>B</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-23\">B</script> are trained</li>\n    </ul>\n  </li>\n  <li>At inference, we compute:</li>\n</ul>\n<ul>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>B</mi><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mo>&amp;#x00D7;</mo><mi>r</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-317\" style=\"width: 4.586em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1003.8em, 2.451em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-318\"><span class=\"mi\" id=\"MathJax-Span-319\" style=\"font-family: STIXGeneral-Italic;\">B</span><span class=\"mo\" id=\"MathJax-Span-320\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"msubsup\" id=\"MathJax-Span-321\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-322\"><span class=\"mrow\" id=\"MathJax-Span-323\"><span class=\"mi\" id=\"MathJax-Span-324\" style=\"font-family: STIXGeneral-Regular;\">ℝ</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-325\"><span class=\"mrow\" id=\"MathJax-Span-326\"><span class=\"mi\" id=\"MathJax-Span-327\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-328\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">×</span><span class=\"mi\" id=\"MathJax-Span-329\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>B</mi><mo>∈</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">R</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>d</mi><mo>×</mo><mi>r</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">B \\in \\mathbb{R}^{d \\times r}</script>, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mo>&amp;#x00D7;</mo><mi>k</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-330\" style=\"width: 4.586em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1003.8em, 2.451em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-331\"><span class=\"mi\" id=\"MathJax-Span-332\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-333\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"msubsup\" id=\"MathJax-Span-334\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-335\"><span class=\"mrow\" id=\"MathJax-Span-336\"><span class=\"mi\" id=\"MathJax-Span-337\" style=\"font-family: STIXGeneral-Regular;\">ℝ</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-338\"><span class=\"mrow\" id=\"MathJax-Span-339\"><span class=\"mi\" id=\"MathJax-Span-340\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-341\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">×</span><span class=\"mi\" id=\"MathJax-Span-342\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi><mo>∈</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">R</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>r</mi><mo>×</mo><mi>k</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">A \\in \\mathbb{R}^{r \\times k}</script></li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo>&amp;#x226A;</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mo stretchy=&quot;false&quot;>(</mo><mi>d</mi><mo>,</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-343\" style=\"width: 6.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1005.42em, 2.555em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-344\"><span class=\"mi\" id=\"MathJax-Span-345\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-346\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">≪</span><span class=\"mo\" id=\"MathJax-Span-347\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">min</span><span class=\"mo\" id=\"MathJax-Span-348\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-349\" style=\"font-family: STIXGeneral-Italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-350\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-351\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-352\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo>≪</mo><mo movablelimits=\"true\" form=\"prefix\">min</mo><mo stretchy=\"false\">(</mo><mi>d</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-20\">r \\ll \\min(d, k)</script> (e.g., 1–8)</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>W</mi><mn>0</mn></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-353\" style=\"width: 1.513em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.25em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-354\"><span class=\"msubsup\" id=\"MathJax-Span-355\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-356\" style=\"font-family: STIXGeneral-Italic;\">W<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.836em;\"><span class=\"mn\" id=\"MathJax-Span-357\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>W</mi><mn>0</mn></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-21\">W_0</script> is frozen</li>\n      <li>Only <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-358\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-359\"><span class=\"mi\" id=\"MathJax-Span-360\" style=\"font-family: STIXGeneral-Italic;\">A</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-22\">A</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>B</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-361\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-362\"><span class=\"mi\" id=\"MathJax-Span-363\" style=\"font-family: STIXGeneral-Italic;\">B</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>B</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-23\">B</script> are trained</li>\n    </ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>h</mi><mo>=</mo><msub><mi>W</mi><mn>0</mn></msub><mi>x</mi><mo>+</mo><mi>B</mi><mi>A</mi><mi>x</mi></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-364\" style=\"width: 7.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1006.46em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-365\"><span class=\"mi\" id=\"MathJax-Span-366\" style=\"font-family: STIXGeneral-Italic;\">h</span><span class=\"mo\" id=\"MathJax-Span-367\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-368\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-369\" style=\"font-family: STIXGeneral-Italic;\">W<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.836em;\"><span class=\"mn\" id=\"MathJax-Span-370\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-371\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-372\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-373\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">B</span><span class=\"mi\" id=\"MathJax-Span-374\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mi\" id=\"MathJax-Span-375\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>h</mi><mo>=</mo><msub><mi>W</mi><mn>0</mn></msub><mi>x</mi><mo>+</mo><mi>B</mi><mi>A</mi><mi>x</mi></math></span></span></div>\n<ul>\n  <li>This provides a lightweight, efficient mechanism to adapt large models without touching most of their parameters.</li>\n  <li>A detailed discourse of LoRA is available in our <a href=\"../parameter-efficient-fine-tuning\">Parameter Efficient Fine-Tuning</a> primer.</li>\n</ul>\n<h4 id=\"integrating-grpo-and-lora-together\">Integrating GRPO and LoRA Together</h4>\n<ul>\n  <li>\n    <p>During GRPO training with LoRA:</p>\n\n    <ol>\n      <li><strong>Generate</strong>: Sample <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-376\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-377\"><span class=\"mi\" id=\"MathJax-Span-378\" style=\"font-family: STIXGeneral-Italic;\">G</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>G</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-25\">G</script> completions from <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-379\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.62em, 2.555em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-380\"><span class=\"msubsup\" id=\"MathJax-Span-381\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-382\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-383\"><span class=\"mrow\" id=\"MathJax-Span-384\"><span class=\"msubsup\" id=\"MathJax-Span-385\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-386\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-387\"><span class=\"mrow\" id=\"MathJax-Span-388\"><span class=\"mtext\" id=\"MathJax-Span-389\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-26\">\\pi_{\\theta_{\\text{old}}}</script></li>\n      <li>\n        <p><strong>Evaluate</strong>: Compute rewards <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-390\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-391\"><span class=\"msubsup\" id=\"MathJax-Span-392\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-393\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-394\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-27\">r_i</script> for each output</p>\n      </li>\n      <li>\n        <p><strong>Compute Advantage</strong>:<br>\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mi>&amp;#x03BC;</mi></mrow><mi>&amp;#x03C3;</mi></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-395\" style=\"width: 4.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.753em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1003.75em, 2.711em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-396\"><span class=\"msubsup\" id=\"MathJax-Span-397\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-398\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-399\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-400\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-401\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.492em, 1001.3em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -0.674em;\"><span class=\"mrow\" id=\"MathJax-Span-402\"><span class=\"msubsup\" id=\"MathJax-Span-403\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-404\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-405\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-406\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mi\" id=\"MathJax-Span-407\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">μ</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.206em;\"><span class=\"mi\" id=\"MathJax-Span-408\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1001.46em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.461em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi></mrow><mi>σ</mi></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">A_i = \\frac{r_i - \\mu}{\\sigma}</script></p>\n      </li>\n      <li><strong>Optimize LoRA Parameters Only</strong>:\n        <ul>\n          <li>Use the GRPO loss:</li>\n        </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>J</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>GRPO</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>q</mi><mo>,</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><msub><mi>o</mi><mi>i</mi></msub><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></mrow></msub><mrow><mo>[</mo><mrow><mfrac><mn>1</mn><mi>G</mi></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mrow><mo>(</mo><mrow><msub><mi>&amp;#x03C1;</mi><mi>i</mi></msub><msub><mi>A</mi><mi>i</mi></msub><mo>,</mo><mtext>clip</mtext><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C1;</mi><mi>i</mi></msub><mo>,</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03F5;</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>&amp;#x03F5;</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi>A</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>&amp;#x2212;</mo><mi>&amp;#x03B2;</mi><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>KL</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-409\" style=\"width: 38.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 31.878em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1031.57em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-410\"><span class=\"msubsup\" id=\"MathJax-Span-411\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-412\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-413\"><span class=\"mrow\" id=\"MathJax-Span-414\"><span class=\"mtext\" id=\"MathJax-Span-415\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">GRPO</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-416\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-417\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-418\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-419\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-420\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-421\"><span class=\"mrow\" id=\"MathJax-Span-422\"><span class=\"mi\" id=\"MathJax-Span-423\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-424\"><span class=\"mrow\" id=\"MathJax-Span-425\"><span class=\"mi\" id=\"MathJax-Span-426\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-427\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-428\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">{</span><span class=\"msubsup\" id=\"MathJax-Span-429\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-430\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-431\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-432\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">}</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-433\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-434\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-435\"><span class=\"mfrac\" id=\"MathJax-Span-436\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-437\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.362em;\"><span class=\"mi\" id=\"MathJax-Span-438\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.84em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.836em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-439\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-440\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.94em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-441\"><span class=\"mrow\" id=\"MathJax-Span-442\"><span class=\"mi\" id=\"MathJax-Span-443\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-444\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-445\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.52em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-446\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-447\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">min</span><span class=\"mrow\" id=\"MathJax-Span-448\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-449\" style=\"vertical-align: 0em;\"><span style=\"font-family: STIXGeneral-Regular;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-450\"><span class=\"msubsup\" id=\"MathJax-Span-451\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-452\" style=\"font-family: STIXGeneral-Italic;\">ρ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-453\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-454\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-455\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-456\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-457\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-458\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">clip</span><span class=\"mo\" id=\"MathJax-Span-459\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-460\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-461\" style=\"font-family: STIXGeneral-Italic;\">ρ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-462\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-463\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-464\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-465\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-466\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">ϵ</span><span class=\"mo\" id=\"MathJax-Span-467\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-468\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-469\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-470\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">ϵ</span><span class=\"mo\" id=\"MathJax-Span-471\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-472\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-473\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-474\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-475\" style=\"vertical-align: 0em;\"><span style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span class=\"mo\" id=\"MathJax-Span-476\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-477\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-478\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-479\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-480\"><span class=\"mrow\" id=\"MathJax-Span-481\"><span class=\"mtext\" id=\"MathJax-Span-482\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">KL</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-483\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-484\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-485\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-486\"><span class=\"mrow\" id=\"MathJax-Span-487\"><span class=\"mi\" id=\"MathJax-Span-488\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-489\"><span class=\"mrow\" id=\"MathJax-Span-490\"><span class=\"mo\" id=\"MathJax-Span-491\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"texatom\" id=\"MathJax-Span-492\"><span class=\"mrow\" id=\"MathJax-Span-493\"><span class=\"mo\" id=\"MathJax-Span-494\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-495\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-496\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-497\"><span class=\"mrow\" id=\"MathJax-Span-498\"><span class=\"mtext\" id=\"MathJax-Span-499\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-500\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-501\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>J</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>GRPO</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>q</mi><mo>,</mo><mo fence=\"false\" stretchy=\"false\">{</mo><msub><mi>o</mi><mi>i</mi></msub><mo fence=\"false\" stretchy=\"false\">}</mo></mrow></msub><mrow><mo>[</mo><mrow><mfrac><mn>1</mn><mi>G</mi></mfrac><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><mo movablelimits=\"true\" form=\"prefix\">min</mo><mrow><mo>(</mo><mrow><msub><mi>ρ</mi><mi>i</mi></msub><msub><mi>A</mi><mi>i</mi></msub><mo>,</mo><mtext>clip</mtext><mo stretchy=\"false\">(</mo><msub><mi>ρ</mi><mi>i</mi></msub><mo>,</mo><mn>1</mn><mo>−</mo><mi>ϵ</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>ϵ</mi><mo stretchy=\"false\">)</mo><msub><mi>A</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>−</mo><mi>β</mi><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>KL</mtext></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>θ</mi></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-29\">J_{\\text{GRPO}}(\\theta) = \\mathbb{E}_{q, \\{o_i\\}} \\left[ \\frac{1}{G} \\sum_{i=1}^G \\min \\left( \\rho_i A_i, \\text{clip}(\\rho_i, 1-\\epsilon, 1+\\epsilon) A_i \\right) - \\beta D_{\\text{KL}}(\\pi_{\\theta} || \\pi_{\\text{ref}}) \\right]</script>\n\n        <ul>\n          <li>where:\n  <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C1;</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-502\" style=\"width: 6.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.211em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.992em, 1005.21em, 3.023em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-503\"><span class=\"msubsup\" id=\"MathJax-Span-504\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-505\" style=\"font-family: STIXGeneral-Italic;\">ρ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-506\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-507\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-508\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.24em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -1.143em;\"><span class=\"mrow\" id=\"MathJax-Span-509\"><span class=\"msubsup\" id=\"MathJax-Span-510\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-511\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-512\"><span class=\"mrow\" id=\"MathJax-Span-513\"><span class=\"mi\" id=\"MathJax-Span-514\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-515\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-516\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-517\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-518\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-519\"><span class=\"mrow\" id=\"MathJax-Span-520\"><span class=\"mo\" id=\"MathJax-Span-521\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-522\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-523\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.87em, 4.43em, -999.997em); top: -3.591em; left: 50%; margin-left: -1.456em;\"><span class=\"mrow\" id=\"MathJax-Span-524\"><span class=\"msubsup\" id=\"MathJax-Span-525\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-526\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-527\"><span class=\"mrow\" id=\"MathJax-Span-528\"><span class=\"msubsup\" id=\"MathJax-Span-529\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-530\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-531\"><span class=\"mrow\" id=\"MathJax-Span-532\"><span class=\"mtext\" id=\"MathJax-Span-533\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-534\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-535\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-536\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-537\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-538\"><span class=\"mrow\" id=\"MathJax-Span-539\"><span class=\"mo\" id=\"MathJax-Span-540\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-541\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-542\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.02em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.023em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>ρ</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>θ</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>q</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-30\">\\rho_i = \\frac{\\pi_{\\theta}(o_i | q)}{\\pi_{\\theta_{\\text{old}}}(o_i | q)}</script></li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Backpropagation is applied only to LoRA parameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi><mo>=</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-543\" style=\"width: 5.529em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.548em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.346em, 1004.45em, 2.534em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-544\"><span class=\"mi\" id=\"MathJax-Span-545\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-546\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.313em;\">=</span><span class=\"mo\" id=\"MathJax-Span-547\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.313em;\">{</span><span class=\"mi\" id=\"MathJax-Span-548\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-549\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-550\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.209em;\">B</span><span class=\"mo\" id=\"MathJax-Span-551\" style=\"font-family: STIXGeneral-Regular;\">}</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>θ</mi><mo>=</mo><mo fence=\"false\" stretchy=\"false\">{</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo fence=\"false\" stretchy=\"false\">}</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-31\">\\theta = \\{A, B\\}</script></strong>:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>A</mi><mo>,</mo><mi>B</mi></mrow></msub><msub><mi>J</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>GRPO</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-552\" style=\"width: 6.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.42em, 2.607em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-553\"><span class=\"msubsup\" id=\"MathJax-Span-554\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-555\" style=\"font-family: STIXGeneral-Regular;\">∇</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-556\"><span class=\"mrow\" id=\"MathJax-Span-557\"><span class=\"mi\" id=\"MathJax-Span-558\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-559\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-560\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">B</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-561\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-562\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-563\"><span class=\"mrow\" id=\"MathJax-Span-564\"><span class=\"mtext\" id=\"MathJax-Span-565\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">GRPO</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-566\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-567\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-568\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi mathvariant=\"normal\">∇</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>A</mi><mo>,</mo><mi>B</mi></mrow></msub><msub><mi>J</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>GRPO</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-32\">\\nabla_{A, B} J_{\\text{GRPO}}(\\theta)</script>\n      </li>\n    </ol>\n  </li>\n  <li>\n    <p>This lets the model learn to prefer completions that perform better than peers, while efficiently adapting using just a few trainable parameters.</p>\n  </li>\n</ul>\n<p>During GRPO training with LoRA:</p>\n<ol>\n      <li><strong>Generate</strong>: Sample <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-376\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-377\"><span class=\"mi\" id=\"MathJax-Span-378\" style=\"font-family: STIXGeneral-Italic;\">G</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>G</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-25\">G</script> completions from <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-379\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.62em, 2.555em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-380\"><span class=\"msubsup\" id=\"MathJax-Span-381\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-382\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-383\"><span class=\"mrow\" id=\"MathJax-Span-384\"><span class=\"msubsup\" id=\"MathJax-Span-385\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-386\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-387\"><span class=\"mrow\" id=\"MathJax-Span-388\"><span class=\"mtext\" id=\"MathJax-Span-389\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-26\">\\pi_{\\theta_{\\text{old}}}</script></li>\n      <li>\n        <p><strong>Evaluate</strong>: Compute rewards <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-390\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-391\"><span class=\"msubsup\" id=\"MathJax-Span-392\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-393\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-394\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-27\">r_i</script> for each output</p>\n      </li>\n      <li>\n        <p><strong>Compute Advantage</strong>:<br>\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mi>&amp;#x03BC;</mi></mrow><mi>&amp;#x03C3;</mi></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-395\" style=\"width: 4.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.753em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1003.75em, 2.711em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-396\"><span class=\"msubsup\" id=\"MathJax-Span-397\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-398\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-399\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-400\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-401\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.492em, 1001.3em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -0.674em;\"><span class=\"mrow\" id=\"MathJax-Span-402\"><span class=\"msubsup\" id=\"MathJax-Span-403\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-404\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-405\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-406\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mi\" id=\"MathJax-Span-407\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">μ</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.206em;\"><span class=\"mi\" id=\"MathJax-Span-408\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1001.46em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.461em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi></mrow><mi>σ</mi></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">A_i = \\frac{r_i - \\mu}{\\sigma}</script></p>\n      </li>\n      <li><strong>Optimize LoRA Parameters Only</strong>:\n        <ul>\n          <li>Use the GRPO loss:</li>\n        </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>J</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>GRPO</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>q</mi><mo>,</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><msub><mi>o</mi><mi>i</mi></msub><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></mrow></msub><mrow><mo>[</mo><mrow><mfrac><mn>1</mn><mi>G</mi></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mrow><mo>(</mo><mrow><msub><mi>&amp;#x03C1;</mi><mi>i</mi></msub><msub><mi>A</mi><mi>i</mi></msub><mo>,</mo><mtext>clip</mtext><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C1;</mi><mi>i</mi></msub><mo>,</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03F5;</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>&amp;#x03F5;</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi>A</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>&amp;#x2212;</mo><mi>&amp;#x03B2;</mi><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>KL</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-409\" style=\"width: 38.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 31.878em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1031.57em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-410\"><span class=\"msubsup\" id=\"MathJax-Span-411\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-412\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-413\"><span class=\"mrow\" id=\"MathJax-Span-414\"><span class=\"mtext\" id=\"MathJax-Span-415\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">GRPO</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-416\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-417\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-418\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-419\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-420\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-421\"><span class=\"mrow\" id=\"MathJax-Span-422\"><span class=\"mi\" id=\"MathJax-Span-423\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-424\"><span class=\"mrow\" id=\"MathJax-Span-425\"><span class=\"mi\" id=\"MathJax-Span-426\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-427\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-428\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">{</span><span class=\"msubsup\" id=\"MathJax-Span-429\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-430\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-431\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-432\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">}</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-433\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-434\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-435\"><span class=\"mfrac\" id=\"MathJax-Span-436\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-437\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.362em;\"><span class=\"mi\" id=\"MathJax-Span-438\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.84em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.836em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-439\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-440\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.94em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-441\"><span class=\"mrow\" id=\"MathJax-Span-442\"><span class=\"mi\" id=\"MathJax-Span-443\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-444\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-445\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.52em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-446\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-447\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">min</span><span class=\"mrow\" id=\"MathJax-Span-448\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-449\" style=\"vertical-align: 0em;\"><span style=\"font-family: STIXGeneral-Regular;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-450\"><span class=\"msubsup\" id=\"MathJax-Span-451\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-452\" style=\"font-family: STIXGeneral-Italic;\">ρ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-453\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-454\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-455\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-456\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-457\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-458\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">clip</span><span class=\"mo\" id=\"MathJax-Span-459\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-460\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-461\" style=\"font-family: STIXGeneral-Italic;\">ρ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-462\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-463\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-464\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-465\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-466\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">ϵ</span><span class=\"mo\" id=\"MathJax-Span-467\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-468\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-469\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-470\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">ϵ</span><span class=\"mo\" id=\"MathJax-Span-471\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-472\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-473\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-474\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-475\" style=\"vertical-align: 0em;\"><span style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span class=\"mo\" id=\"MathJax-Span-476\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-477\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-478\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-479\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-480\"><span class=\"mrow\" id=\"MathJax-Span-481\"><span class=\"mtext\" id=\"MathJax-Span-482\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">KL</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-483\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-484\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-485\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-486\"><span class=\"mrow\" id=\"MathJax-Span-487\"><span class=\"mi\" id=\"MathJax-Span-488\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-489\"><span class=\"mrow\" id=\"MathJax-Span-490\"><span class=\"mo\" id=\"MathJax-Span-491\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"texatom\" id=\"MathJax-Span-492\"><span class=\"mrow\" id=\"MathJax-Span-493\"><span class=\"mo\" id=\"MathJax-Span-494\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-495\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-496\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-497\"><span class=\"mrow\" id=\"MathJax-Span-498\"><span class=\"mtext\" id=\"MathJax-Span-499\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-500\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-501\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>J</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>GRPO</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>q</mi><mo>,</mo><mo fence=\"false\" stretchy=\"false\">{</mo><msub><mi>o</mi><mi>i</mi></msub><mo fence=\"false\" stretchy=\"false\">}</mo></mrow></msub><mrow><mo>[</mo><mrow><mfrac><mn>1</mn><mi>G</mi></mfrac><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><mo movablelimits=\"true\" form=\"prefix\">min</mo><mrow><mo>(</mo><mrow><msub><mi>ρ</mi><mi>i</mi></msub><msub><mi>A</mi><mi>i</mi></msub><mo>,</mo><mtext>clip</mtext><mo stretchy=\"false\">(</mo><msub><mi>ρ</mi><mi>i</mi></msub><mo>,</mo><mn>1</mn><mo>−</mo><mi>ϵ</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>ϵ</mi><mo stretchy=\"false\">)</mo><msub><mi>A</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>−</mo><mi>β</mi><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>KL</mtext></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>θ</mi></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-29\">J_{\\text{GRPO}}(\\theta) = \\mathbb{E}_{q, \\{o_i\\}} \\left[ \\frac{1}{G} \\sum_{i=1}^G \\min \\left( \\rho_i A_i, \\text{clip}(\\rho_i, 1-\\epsilon, 1+\\epsilon) A_i \\right) - \\beta D_{\\text{KL}}(\\pi_{\\theta} || \\pi_{\\text{ref}}) \\right]</script>\n\n        <ul>\n          <li>where:\n  <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C1;</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-502\" style=\"width: 6.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.211em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.992em, 1005.21em, 3.023em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-503\"><span class=\"msubsup\" id=\"MathJax-Span-504\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-505\" style=\"font-family: STIXGeneral-Italic;\">ρ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-506\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-507\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-508\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.24em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -1.143em;\"><span class=\"mrow\" id=\"MathJax-Span-509\"><span class=\"msubsup\" id=\"MathJax-Span-510\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-511\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-512\"><span class=\"mrow\" id=\"MathJax-Span-513\"><span class=\"mi\" id=\"MathJax-Span-514\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-515\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-516\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-517\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-518\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-519\"><span class=\"mrow\" id=\"MathJax-Span-520\"><span class=\"mo\" id=\"MathJax-Span-521\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-522\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-523\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.87em, 4.43em, -999.997em); top: -3.591em; left: 50%; margin-left: -1.456em;\"><span class=\"mrow\" id=\"MathJax-Span-524\"><span class=\"msubsup\" id=\"MathJax-Span-525\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-526\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-527\"><span class=\"mrow\" id=\"MathJax-Span-528\"><span class=\"msubsup\" id=\"MathJax-Span-529\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-530\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-531\"><span class=\"mrow\" id=\"MathJax-Span-532\"><span class=\"mtext\" id=\"MathJax-Span-533\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-534\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-535\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-536\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-537\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-538\"><span class=\"mrow\" id=\"MathJax-Span-539\"><span class=\"mo\" id=\"MathJax-Span-540\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-541\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-542\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.02em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.023em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>ρ</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>θ</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>q</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-30\">\\rho_i = \\frac{\\pi_{\\theta}(o_i | q)}{\\pi_{\\theta_{\\text{old}}}(o_i | q)}</script></li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Backpropagation is applied only to LoRA parameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi><mo>=</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-543\" style=\"width: 5.529em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.548em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.346em, 1004.45em, 2.534em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-544\"><span class=\"mi\" id=\"MathJax-Span-545\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-546\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.313em;\">=</span><span class=\"mo\" id=\"MathJax-Span-547\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.313em;\">{</span><span class=\"mi\" id=\"MathJax-Span-548\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-549\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-550\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.209em;\">B</span><span class=\"mo\" id=\"MathJax-Span-551\" style=\"font-family: STIXGeneral-Regular;\">}</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>θ</mi><mo>=</mo><mo fence=\"false\" stretchy=\"false\">{</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo fence=\"false\" stretchy=\"false\">}</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-31\">\\theta = \\{A, B\\}</script></strong>:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>A</mi><mo>,</mo><mi>B</mi></mrow></msub><msub><mi>J</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>GRPO</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-552\" style=\"width: 6.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.42em, 2.607em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-553\"><span class=\"msubsup\" id=\"MathJax-Span-554\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-555\" style=\"font-family: STIXGeneral-Regular;\">∇</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-556\"><span class=\"mrow\" id=\"MathJax-Span-557\"><span class=\"mi\" id=\"MathJax-Span-558\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-559\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-560\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">B</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-561\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-562\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-563\"><span class=\"mrow\" id=\"MathJax-Span-564\"><span class=\"mtext\" id=\"MathJax-Span-565\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">GRPO</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-566\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-567\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-568\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi mathvariant=\"normal\">∇</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>A</mi><mo>,</mo><mi>B</mi></mrow></msub><msub><mi>J</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>GRPO</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-32\">\\nabla_{A, B} J_{\\text{GRPO}}(\\theta)</script>\n      </li>\n    </ol>\n<p><strong>Evaluate</strong>: Compute rewards <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-390\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-391\"><span class=\"msubsup\" id=\"MathJax-Span-392\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-393\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-394\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-27\">r_i</script> for each output</p>\n<p><strong>Compute Advantage</strong>:<br>\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mi>&amp;#x03BC;</mi></mrow><mi>&amp;#x03C3;</mi></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-395\" style=\"width: 4.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.753em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1003.75em, 2.711em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-396\"><span class=\"msubsup\" id=\"MathJax-Span-397\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-398\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-399\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-400\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-401\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.492em, 1001.3em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -0.674em;\"><span class=\"mrow\" id=\"MathJax-Span-402\"><span class=\"msubsup\" id=\"MathJax-Span-403\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-404\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-405\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-406\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mi\" id=\"MathJax-Span-407\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">μ</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.206em;\"><span class=\"mi\" id=\"MathJax-Span-408\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1001.46em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.461em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi></mrow><mi>σ</mi></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">A_i = \\frac{r_i - \\mu}{\\sigma}</script></p>\n<ul>\n          <li>Use the GRPO loss:</li>\n        </ul>\n<ul>\n          <li>where:\n  <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C1;</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-502\" style=\"width: 6.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.211em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.992em, 1005.21em, 3.023em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-503\"><span class=\"msubsup\" id=\"MathJax-Span-504\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-505\" style=\"font-family: STIXGeneral-Italic;\">ρ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-506\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-507\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-508\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.24em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -1.143em;\"><span class=\"mrow\" id=\"MathJax-Span-509\"><span class=\"msubsup\" id=\"MathJax-Span-510\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-511\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-512\"><span class=\"mrow\" id=\"MathJax-Span-513\"><span class=\"mi\" id=\"MathJax-Span-514\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-515\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-516\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-517\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-518\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-519\"><span class=\"mrow\" id=\"MathJax-Span-520\"><span class=\"mo\" id=\"MathJax-Span-521\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-522\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-523\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.87em, 4.43em, -999.997em); top: -3.591em; left: 50%; margin-left: -1.456em;\"><span class=\"mrow\" id=\"MathJax-Span-524\"><span class=\"msubsup\" id=\"MathJax-Span-525\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-526\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-527\"><span class=\"mrow\" id=\"MathJax-Span-528\"><span class=\"msubsup\" id=\"MathJax-Span-529\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-530\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-531\"><span class=\"mrow\" id=\"MathJax-Span-532\"><span class=\"mtext\" id=\"MathJax-Span-533\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-534\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-535\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-536\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-537\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-538\"><span class=\"mrow\" id=\"MathJax-Span-539\"><span class=\"mo\" id=\"MathJax-Span-540\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-541\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-542\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.02em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.023em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>ρ</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>θ</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>q</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>i</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-30\">\\rho_i = \\frac{\\pi_{\\theta}(o_i | q)}{\\pi_{\\theta_{\\text{old}}}(o_i | q)}</script></li>\n        </ul>\n<p><strong>Backpropagation is applied only to LoRA parameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi><mo>=</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-543\" style=\"width: 5.529em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.548em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.346em, 1004.45em, 2.534em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-544\"><span class=\"mi\" id=\"MathJax-Span-545\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-546\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.313em;\">=</span><span class=\"mo\" id=\"MathJax-Span-547\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.313em;\">{</span><span class=\"mi\" id=\"MathJax-Span-548\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-549\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-550\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.209em;\">B</span><span class=\"mo\" id=\"MathJax-Span-551\" style=\"font-family: STIXGeneral-Regular;\">}</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>θ</mi><mo>=</mo><mo fence=\"false\" stretchy=\"false\">{</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo fence=\"false\" stretchy=\"false\">}</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-31\">\\theta = \\{A, B\\}</script></strong>:</p>\n<p>This lets the model learn to prefer completions that perform better than peers, while efficiently adapting using just a few trainable parameters.</p>",
    "contentMarkdown": "*   While GRPO provides structured, relative reward signals without needing a critic, LoRA enables efficient fine-tuning with low compute/memory footprint. Combined, they allow scalable reinforcement fine-tuning on large models with limited data and compute.\n*   In this section, how a policy optimization algorithm such as GRPO and a parameter-efficient fine-tuning method such as LoRA are coupled together.\n\n#### Background: GRPO and Its Loss Function\n\n*   In GRPO, for each prompt qqq, a group of GGG completions {o1,o2,…,oG}{o1,o2,…,oG}\\\\{ o\\_1, o\\_2, \\\\ldots, o\\_G \\\\} is sampled from the frozen old policy πθoldπθold\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}. Each completion oioio\\_i is evaluated with a reward function, giving reward ririr\\_i.\n    \n*   We then compute the advantage for each output, which measures how much better or worse completion oioio\\_i is compared to its peers:\n    \n    Ai\\=ri−μσAi\\=ri−μσ\n    \n    A\\_i = \\\\frac{r\\_i - \\\\mu}{\\\\sigma}\n    *   where:\n        \n        *   μ\\=1G∑Gj\\=1rjμ\\=1G∑j\\=1Grj\\\\mu = \\\\frac{1}{G} \\\\sum\\_{j=1}^G r\\_j is the group mean\n        *   σσ\\\\sigma is the standard deviation across the group\n*   The advantage estimations feed into the GRPO objective function, which can be written as:\n    \n    JGRPO(θ)\\=𝔼q∼P(Q),{oi}Gi\\=1∼πθold(O|q)\\[1G∑i\\=1Gmin(πθ(oi|q)πθold(oi|q)Ai,clip(πθ(oi|q)πθold(oi|q),1−ϵ,1+ϵ)Ai)−βDKL(πθ||πref)\\]JGRPO(θ)\\=Eq∼P(Q),{oi}i\\=1G∼πθold(O|q)\\[1G∑i\\=1Gmin(πθ(oi|q)πθold(oi|q)Ai,clip(πθ(oi|q)πθold(oi|q),1−ϵ,1+ϵ)Ai)−βDKL(πθ||πref)\\]\n    \n    J\\_{\\\\text{GRPO}}(\\\\theta) = \\\\mathbb{E}\\_{q \\\\sim P(Q), \\\\{o\\_i\\\\}\\_{i=1}^G \\\\sim \\\\pi\\_{\\\\theta\\_{\\\\text{old}}}(O|q)} \\\\left\\[ \\\\frac{1}{G} \\\\sum\\_{i=1}^G \\\\min \\\\left( \\\\frac{\\\\pi\\_{\\\\theta}(o\\_i|q)}{\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}(o\\_i|q)} A\\_i, \\\\text{clip} \\\\left(\\\\frac{\\\\pi\\_{\\\\theta}(o\\_i|q)}{\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}(o\\_i|q)}, 1-\\\\epsilon, 1+\\\\epsilon \\\\right) A\\_i \\\\right) - \\\\beta D\\_{\\\\text{KL}}(\\\\pi\\_{\\\\theta} || \\\\pi\\_{\\\\text{ref}}) \\\\right\\]\n    *   This includes:\n        *   A clipped importance-weighted advantage term (inspired by PPO)\n        *   A KL penalty to keep the fine-tuned model close to a reference (e.g., SFT) model\n        *   All updates are based on comparing completions within the same group — no critic needed\n\nIn GRPO, for each prompt qqq, a group of GGG completions {o1,o2,…,oG}{o1,o2,…,oG}\\\\{ o\\_1, o\\_2, \\\\ldots, o\\_G \\\\} is sampled from the frozen old policy πθoldπθold\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}. Each completion oioio\\_i is evaluated with a reward function, giving reward ririr\\_i.\n\nWe then compute the advantage for each output, which measures how much better or worse completion oioio\\_i is compared to its peers:\n\n*   where:\n    \n    *   μ\\=1G∑Gj\\=1rjμ\\=1G∑j\\=1Grj\\\\mu = \\\\frac{1}{G} \\\\sum\\_{j=1}^G r\\_j is the group mean\n    *   σσ\\\\sigma is the standard deviation across the group\n\nwhere:\n\n*   μ\\=1G∑Gj\\=1rjμ\\=1G∑j\\=1Grj\\\\mu = \\\\frac{1}{G} \\\\sum\\_{j=1}^G r\\_j is the group mean\n*   σσ\\\\sigma is the standard deviation across the group\n\nThe advantage estimations feed into the GRPO objective function, which can be written as:\n\n*   This includes:\n    *   A clipped importance-weighted advantage term (inspired by PPO)\n    *   A KL penalty to keep the fine-tuned model close to a reference (e.g., SFT) model\n    *   All updates are based on comparing completions within the same group — no critic needed\n\n*   A clipped importance-weighted advantage term (inspired by PPO)\n*   A KL penalty to keep the fine-tuned model close to a reference (e.g., SFT) model\n*   All updates are based on comparing completions within the same group — no critic needed\n\n#### Background: LoRA →→\\\\rightarrow Efficient Low-Rank Updates\n\n*   LoRA replaces full weight updates with low-rank decompositions. For a pre-trained weight matrix W0∈ℝd×kW0∈Rd×kW\\_0 \\\\in \\\\mathbb{R}^{d \\\\times k}, LoRA introduces:\n\nW\\=W0+ΔW\\=W0+BAW\\=W0+ΔW\\=W0+BA\n\n*   where:\n    *   B∈ℝd×rB∈Rd×rB \\\\in \\\\mathbb{R}^{d \\\\times r}, A∈ℝr×kA∈Rr×kA \\\\in \\\\mathbb{R}^{r \\\\times k}\n    *   r≪min(d,k)r≪min(d,k)r \\\\ll \\\\min(d, k) (e.g., 1–8)\n    *   W0W0W\\_0 is frozen\n    *   Only AAA and BBB are trained\n*   At inference, we compute:\n\n*   B∈ℝd×rB∈Rd×rB \\\\in \\\\mathbb{R}^{d \\\\times r}, A∈ℝr×kA∈Rr×kA \\\\in \\\\mathbb{R}^{r \\\\times k}\n*   r≪min(d,k)r≪min(d,k)r \\\\ll \\\\min(d, k) (e.g., 1–8)\n*   W0W0W\\_0 is frozen\n*   Only AAA and BBB are trained\n\nh\\=W0x+BAxh\\=W0x+BAx\n\n*   This provides a lightweight, efficient mechanism to adapt large models without touching most of their parameters.\n*   A detailed discourse of LoRA is available in our [Parameter Efficient Fine-Tuning](../parameter-efficient-fine-tuning) primer.\n\n#### Integrating GRPO and LoRA Together\n\n*   During GRPO training with LoRA:\n    \n    1.  **Generate**: Sample GGG completions from πθoldπθold\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}\n    2.  **Evaluate**: Compute rewards ririr\\_i for each output\n        \n    3.  **Compute Advantage**:  \n        Ai\\=ri−μσAi\\=ri−μσA\\_i = \\\\frac{r\\_i - \\\\mu}{\\\\sigma}\n        \n    4.  **Optimize LoRA Parameters Only**:\n        \n        *   Use the GRPO loss:\n        \n        JGRPO(θ)\\=𝔼q,{oi}\\[1G∑i\\=1Gmin(ρiAi,clip(ρi,1−ϵ,1+ϵ)Ai)−βDKL(πθ||πref)\\]JGRPO(θ)\\=Eq,{oi}\\[1G∑i\\=1Gmin(ρiAi,clip(ρi,1−ϵ,1+ϵ)Ai)−βDKL(πθ||πref)\\]\n        \n        J\\_{\\\\text{GRPO}}(\\\\theta) = \\\\mathbb{E}\\_{q, \\\\{o\\_i\\\\}} \\\\left\\[ \\\\frac{1}{G} \\\\sum\\_{i=1}^G \\\\min \\\\left( \\\\rho\\_i A\\_i, \\\\text{clip}(\\\\rho\\_i, 1-\\\\epsilon, 1+\\\\epsilon) A\\_i \\\\right) - \\\\beta D\\_{\\\\text{KL}}(\\\\pi\\_{\\\\theta} || \\\\pi\\_{\\\\text{ref}}) \\\\right\\]\n        *   where: ρi\\=πθ(oi|q)πθold(oi|q)ρi\\=πθ(oi|q)πθold(oi|q)\\\\rho\\_i = \\\\frac{\\\\pi\\_{\\\\theta}(o\\_i | q)}{\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}(o\\_i | q)}\n    5.  **Backpropagation is applied only to LoRA parameters θ\\={A,B}θ\\={A,B}\\\\theta = \\\\{A, B\\\\}**:\n        \n        ∇A,BJGRPO(θ)∇A,BJGRPO(θ)\n        \n        \\\\nabla\\_{A, B} J\\_{\\\\text{GRPO}}(\\\\theta)\n*   This lets the model learn to prefer completions that perform better than peers, while efficiently adapting using just a few trainable parameters.\n    \n\nDuring GRPO training with LoRA:\n\n1.  **Generate**: Sample GGG completions from πθoldπθold\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}\n2.  **Evaluate**: Compute rewards ririr\\_i for each output\n    \n3.  **Compute Advantage**:  \n    Ai\\=ri−μσAi\\=ri−μσA\\_i = \\\\frac{r\\_i - \\\\mu}{\\\\sigma}\n    \n4.  **Optimize LoRA Parameters Only**:\n    \n    *   Use the GRPO loss:\n    \n    JGRPO(θ)\\=𝔼q,{oi}\\[1G∑i\\=1Gmin(ρiAi,clip(ρi,1−ϵ,1+ϵ)Ai)−βDKL(πθ||πref)\\]JGRPO(θ)\\=Eq,{oi}\\[1G∑i\\=1Gmin(ρiAi,clip(ρi,1−ϵ,1+ϵ)Ai)−βDKL(πθ||πref)\\]\n    \n    J\\_{\\\\text{GRPO}}(\\\\theta) = \\\\mathbb{E}\\_{q, \\\\{o\\_i\\\\}} \\\\left\\[ \\\\frac{1}{G} \\\\sum\\_{i=1}^G \\\\min \\\\left( \\\\rho\\_i A\\_i, \\\\text{clip}(\\\\rho\\_i, 1-\\\\epsilon, 1+\\\\epsilon) A\\_i \\\\right) - \\\\beta D\\_{\\\\text{KL}}(\\\\pi\\_{\\\\theta} || \\\\pi\\_{\\\\text{ref}}) \\\\right\\]\n    *   where: ρi\\=πθ(oi|q)πθold(oi|q)ρi\\=πθ(oi|q)πθold(oi|q)\\\\rho\\_i = \\\\frac{\\\\pi\\_{\\\\theta}(o\\_i | q)}{\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}(o\\_i | q)}\n5.  **Backpropagation is applied only to LoRA parameters θ\\={A,B}θ\\={A,B}\\\\theta = \\\\{A, B\\\\}**:\n    \n    ∇A,BJGRPO(θ)∇A,BJGRPO(θ)\n    \n    \\\\nabla\\_{A, B} J\\_{\\\\text{GRPO}}(\\\\theta)\n\n**Evaluate**: Compute rewards ririr\\_i for each output\n\n**Compute Advantage**:  \nAi\\=ri−μσAi\\=ri−μσA\\_i = \\\\frac{r\\_i - \\\\mu}{\\\\sigma}\n\n*   Use the GRPO loss:\n\n*   where: ρi\\=πθ(oi|q)πθold(oi|q)ρi\\=πθ(oi|q)πθold(oi|q)\\\\rho\\_i = \\\\frac{\\\\pi\\_{\\\\theta}(o\\_i | q)}{\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}(o\\_i | q)}\n\n**Backpropagation is applied only to LoRA parameters θ\\={A,B}θ\\={A,B}\\\\theta = \\\\{A, B\\\\}**:\n\nThis lets the model learn to prefer completions that perform better than peers, while efficiently adapting using just a few trainable parameters.",
    "contentLength": 243850,
    "wordCount": 828,
    "hasCode": false,
    "hasMath": true,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#coupling-grpo-and-lora"
  },
  {
    "id": "ai-reinforcement-finetuning-training-dynamics-and-scaling-16",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "Case Study: Python-to-Triton Transpilation",
    "title": "Training Dynamics and Scaling",
    "order": 16,
    "orderInChapter": 5,
    "contentHtml": "<ul>\n  <li>\n    <p>Throughout training, the interaction of these reward functions shaped the model’s learning trajectory:</p>\n\n    <ul>\n      <li>Within the first 100–200 training steps, the model learned to generate code that passed formatting checks.</li>\n      <li>By around 1,000 steps, it could reliably generate compilable code.</li>\n      <li>Over approximately 5,000 steps, correctness scores improved, with the model eventually producing Triton kernels that matched reference PyTorch outputs in 40% of held-out examples.</li>\n      <li>Expanding the number of test cases and layering partial credit across the reward types helped provide a more nuanced gradient for learning, especially as the model moved from syntactic correctness to deep functional accuracy.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The following graphs (<a href=\"https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning\">source</a>) show the learning curves from Predibase’s initial training run.</p>\n  </li>\n</ul>\n<p>Throughout training, the interaction of these reward functions shaped the model’s learning trajectory:</p>\n<ul>\n      <li>Within the first 100–200 training steps, the model learned to generate code that passed formatting checks.</li>\n      <li>By around 1,000 steps, it could reliably generate compilable code.</li>\n      <li>Over approximately 5,000 steps, correctness scores improved, with the model eventually producing Triton kernels that matched reference PyTorch outputs in 40% of held-out examples.</li>\n      <li>Expanding the number of test cases and layering partial credit across the reward types helped provide a more nuanced gradient for learning, especially as the model moved from syntactic correctness to deep functional accuracy.</li>\n    </ul>\n<p>The following graphs (<a href=\"https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning\">source</a>) show the learning curves from Predibase’s initial training run.</p>\n<p><img src=\"/primers/ai/assets/RFT/TrainingProgressGraphs1.jpg\" alt=\"\"></p>\n<ul>\n  <li>The following graphs (<a href=\"https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning\">source</a>) show the learning curves from the final training run, which included partial credit rewards, anti-reward hacking safeguards, and compilation-based evaluation.</li>\n</ul>\n<p><img src=\"/primers/ai/assets/RFT/TrainingProgressGraphs2.jpg\" alt=\"\"></p>",
    "contentMarkdown": "*   Throughout training, the interaction of these reward functions shaped the model’s learning trajectory:\n    \n    *   Within the first 100–200 training steps, the model learned to generate code that passed formatting checks.\n    *   By around 1,000 steps, it could reliably generate compilable code.\n    *   Over approximately 5,000 steps, correctness scores improved, with the model eventually producing Triton kernels that matched reference PyTorch outputs in 40% of held-out examples.\n    *   Expanding the number of test cases and layering partial credit across the reward types helped provide a more nuanced gradient for learning, especially as the model moved from syntactic correctness to deep functional accuracy.\n*   The following graphs ([source](https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning)) show the learning curves from Predibase’s initial training run.\n    \n\nThroughout training, the interaction of these reward functions shaped the model’s learning trajectory:\n\n*   Within the first 100–200 training steps, the model learned to generate code that passed formatting checks.\n*   By around 1,000 steps, it could reliably generate compilable code.\n*   Over approximately 5,000 steps, correctness scores improved, with the model eventually producing Triton kernels that matched reference PyTorch outputs in 40% of held-out examples.\n*   Expanding the number of test cases and layering partial credit across the reward types helped provide a more nuanced gradient for learning, especially as the model moved from syntactic correctness to deep functional accuracy.\n\nThe following graphs ([source](https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning)) show the learning curves from Predibase’s initial training run.\n\n![](/primers/ai/assets/RFT/TrainingProgressGraphs1.jpg)\n\n*   The following graphs ([source](https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning)) show the learning curves from the final training run, which included partial credit rewards, anti-reward hacking safeguards, and compilation-based evaluation.\n\n![](/primers/ai/assets/RFT/TrainingProgressGraphs2.jpg)",
    "contentLength": 2492,
    "wordCount": 257,
    "hasCode": false,
    "hasMath": false,
    "hasImages": true,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#training-dynamics-and-scaling"
  },
  {
    "id": "ai-reinforcement-finetuning-optimization-algorithms-17",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "How RLVR Differs from RFT",
    "title": "Optimization Algorithms",
    "order": 17,
    "orderInChapter": 1,
    "contentHtml": "<ul>\n  <li>RFT uses policy optimization algorithms such as GRPO (as implemented in the <a href=\"https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning\">Predibase Triton project</a>), a technique inspired by PPO but designed to be more efficient and easier to tune. GRPO works by comparing a batch of completions, assigning rewards, and computing relative advantages to adjust the model.</li>\n  <li>RLVR, especially in its original form (e.g., as described in the Tülu 3 paper), primarily applies PPO as the optimization algorithm. PPO is more general-purpose but computationally heavier.</li>\n</ul>",
    "contentMarkdown": "*   RFT uses policy optimization algorithms such as GRPO (as implemented in the [Predibase Triton project](https://predibase.com/blog/teaching-ai-to-write-gpu-code-a-deep-dive-into-reinforcement-fine-tuning)), a technique inspired by PPO but designed to be more efficient and easier to tune. GRPO works by comparing a batch of completions, assigning rewards, and computing relative advantages to adjust the model.\n*   RLVR, especially in its original form (e.g., as described in the Tülu 3 paper), primarily applies PPO as the optimization algorithm. PPO is more general-purpose but computationally heavier.",
    "contentLength": 643,
    "wordCount": 78,
    "hasCode": false,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#optimization-algorithms"
  },
  {
    "id": "ai-reinforcement-finetuning-fine-tuning-strategy-18",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "How RLVR Differs from RFT",
    "title": "Fine-Tuning Strategy",
    "order": 18,
    "orderInChapter": 2,
    "contentHtml": "<ul>\n  <li>RFT integrates LoRA (Low-Rank Adaptation) during fine-tuning. Each training step outputs a new LoRA checkpoint representing the latest adapted weights. These are used in inference and updated iteratively based on reward feedback.</li>\n  <li>RLVR also supports PPO-based updates directly on the model weights, without necessarily relying on LoRA adapters. However, it can be combined with LoRA for more efficient training, especially in large models.</li>\n</ul>",
    "contentMarkdown": "*   RFT integrates LoRA (Low-Rank Adaptation) during fine-tuning. Each training step outputs a new LoRA checkpoint representing the latest adapted weights. These are used in inference and updated iteratively based on reward feedback.\n*   RLVR also supports PPO-based updates directly on the model weights, without necessarily relying on LoRA adapters. However, it can be combined with LoRA for more efficient training, especially in large models.",
    "contentLength": 471,
    "wordCount": 65,
    "hasCode": false,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#fine-tuning-strategy"
  },
  {
    "id": "ai-reinforcement-finetuning-training-data-and-process-19",
    "articleSlug": "reinforcement-finetuning",
    "articleTitle": "Reinforcement Fine-Tuning",
    "category": "NLP/LLMs",
    "chapter": "How RLVR Differs from RFT",
    "title": "Training Data and Process",
    "order": 19,
    "orderInChapter": 3,
    "contentHtml": "<ul>\n  <li>Both approaches assume no or limited labeled data, instead relying on verifiable reward signals. However, RFT often starts with a small, curated dataset and then expands its learning through feedback loops, while RLVR may begin with exploration across a much larger search space, particularly in game-like or simulation environments.</li>\n</ul>",
    "contentMarkdown": "*   Both approaches assume no or limited labeled data, instead relying on verifiable reward signals. However, RFT often starts with a small, curated dataset and then expands its learning through feedback loops, while RLVR may begin with exploration across a much larger search space, particularly in game-like or simulation environments.",
    "contentLength": 355,
    "wordCount": 50,
    "hasCode": false,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/reinforcement-finetuning/#training-data-and-process"
  }
]