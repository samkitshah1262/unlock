[
  {
    "id": "ai-agentic-RL-what-is-imitation-learning-and-why-sft-is-used-bef-1",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Background: When SFT Fails (and Why RL is Required) for Tool-Calling Agents",
    "title": "What is Imitation Learning and Why SFT is Used Before RL",
    "subtitle": "Background: When SFT Fails (and Why RL is Required) for Tool-Calling Agents",
    "contentHtml": "<ul>\n  <li>\n    <p>Before applying reinforcement learning to teach tool-calling behavior, modern LLM systems almost always begin with <strong>imitation learning</strong>. In the LLM context, imitation learning is implemented via <strong>Supervised Fine-Tuning (SFT)</strong> — training the model to reproduce expert-authored examples of correct tool usage.</p>\n  </li>\n  <li>\n    <p>This section explains (i) what imitation learning is, (ii) why SFT is a special case of it, and (iii) why imitation learning is a necessary warm-start for RL in tool-use settings.</p>\n  </li>\n</ul>\n<p>Before applying reinforcement learning to teach tool-calling behavior, modern LLM systems almost always begin with <strong>imitation learning</strong>. In the LLM context, imitation learning is implemented via <strong>Supervised Fine-Tuning (SFT)</strong> — training the model to reproduce expert-authored examples of correct tool usage.</p>\n<p>This section explains (i) what imitation learning is, (ii) why SFT is a special case of it, and (iii) why imitation learning is a necessary warm-start for RL in tool-use settings.</p>\n<h4 id=\"what-is-imitation-learning\">What is Imitation Learning?</h4>\n<ul>\n  <li>\n    <p>Imitation learning trains a policy by <strong>directly copying expert actions</strong> instead of learning via trial-and-error. No rewards, no exploration, no environment optimisation — just supervised mapping from states to actions.</p>\n  </li>\n  <li>\n    <p>Formally, given demonstration trajectories <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C4;</mi><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mn>0</mn></msub><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>T</mi></msub><mo>,</mo><msub><mi>a</mi><mi>T</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-201\" style=\"width: 15.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1013.13em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-202\"><span class=\"mi\" id=\"MathJax-Span-203\" style=\"font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-204\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-205\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-206\"><span class=\"mo\" id=\"MathJax-Span-207\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-208\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-209\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-210\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-211\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-212\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-213\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-214\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-215\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-216\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-217\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-218\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-219\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-220\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-221\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-222\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-223\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-224\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-225\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-226\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-227\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">…</span><span class=\"mo\" id=\"MathJax-Span-228\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"mo\" id=\"MathJax-Span-229\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-230\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-231\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-232\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-233\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-234\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-235\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-236\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-237\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>τ</mi><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mo>…</mo><mo>,</mo><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>T</mi></msub><mo>,</mo><msub><mi>a</mi><mi>T</mi></msub><mo stretchy=\"false\">)</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">\\tau = {(s_0, a_0), (s_1, a_1), \\dots, (s_T, a_T)}</script>, imitation learning maximises the likelihood of expert actions:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>I</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></munderover><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msubsup><mi>a</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>x</mi><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>t</mi></mrow></msubsup><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-238\" style=\"width: 15.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.315em, 1012.97em, 3.648em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-239\"><span class=\"msubsup\" id=\"MathJax-Span-240\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-241\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-242\"><span class=\"mrow\" id=\"MathJax-Span-243\"><span class=\"mi\" id=\"MathJax-Span-244\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">I</span><span class=\"mi\" id=\"MathJax-Span-245\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-246\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-247\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-248\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-249\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-250\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">−</span><span class=\"munderover\" id=\"MathJax-Span-251\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-252\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-253\"><span class=\"mrow\" id=\"MathJax-Span-254\"><span class=\"mi\" id=\"MathJax-Span-255\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-256\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-257\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-258\"><span class=\"mrow\" id=\"MathJax-Span-259\"><span class=\"mi\" id=\"MathJax-Span-260\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-261\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-262\"></span><span class=\"msubsup\" id=\"MathJax-Span-263\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-264\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-265\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-266\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-267\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-268\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1001.83em, 4.326em, -999.997em); top: -4.529em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-269\"><span class=\"mrow\" id=\"MathJax-Span-270\"><span class=\"mi\" id=\"MathJax-Span-271\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-272\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">x</span><span class=\"mi\" id=\"MathJax-Span-273\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">p</span><span class=\"mi\" id=\"MathJax-Span-274\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-275\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-276\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-277\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-278\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"msubsup\" id=\"MathJax-Span-279\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-280\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-281\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-282\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">I</mi><mi mathvariant=\"normal\">L</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi></mrow></munderover><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msubsup><mi>a</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">x</mi><mi mathvariant=\"normal\">p</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">t</mi></mrow></msubsup><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-17\">L_{\\rm IL}(\\theta)\n= - \\sum_{t=0}^{T} \\log p_\\theta(a_t^{\\rm expert} \\mid s_t)</script>\n  </li>\n  <li>\n    <p>This is close to standard supervised learning, but in robotics and RL theory it is known as <strong>behavior cloning</strong>, one of the simplest imitation-learning methods.</p>\n  </li>\n</ul>\n<p>Imitation learning trains a policy by <strong>directly copying expert actions</strong> instead of learning via trial-and-error. No rewards, no exploration, no environment optimisation — just supervised mapping from states to actions.</p>\n<p>Formally, given demonstration trajectories <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C4;</mi><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mn>0</mn></msub><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>T</mi></msub><mo>,</mo><msub><mi>a</mi><mi>T</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-201\" style=\"width: 15.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1013.13em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-202\"><span class=\"mi\" id=\"MathJax-Span-203\" style=\"font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-204\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-205\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-206\"><span class=\"mo\" id=\"MathJax-Span-207\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-208\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-209\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-210\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-211\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-212\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-213\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-214\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-215\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-216\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-217\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-218\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-219\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-220\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-221\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-222\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-223\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-224\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-225\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-226\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-227\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">…</span><span class=\"mo\" id=\"MathJax-Span-228\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"mo\" id=\"MathJax-Span-229\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-230\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-231\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-232\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-233\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-234\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-235\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-236\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-237\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>τ</mi><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mo>…</mo><mo>,</mo><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>T</mi></msub><mo>,</mo><msub><mi>a</mi><mi>T</mi></msub><mo stretchy=\"false\">)</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">\\tau = {(s_0, a_0), (s_1, a_1), \\dots, (s_T, a_T)}</script>, imitation learning maximises the likelihood of expert actions:</p>\n<p>This is close to standard supervised learning, but in robotics and RL theory it is known as <strong>behavior cloning</strong>, one of the simplest imitation-learning methods.</p>\n<h4 id=\"why-sft-is-exactly-imitation-learning\">Why SFT is Exactly Imitation Learning</h4>\n<ul>\n  <li>\n    <p>When training LLMs to produce reasoning traces, tool-call JSON, or final answers using labelled examples, SFT implements the above loss directly. The model does not explore, does not observe tool outputs, and is not rewarded for correct long-term actions.</p>\n  </li>\n  <li>\n    <p>In the tool-calling context, SFT teaches:</p>\n\n    <ul>\n      <li>how tool calls look (syntax),</li>\n      <li>rough patterns of when humans call tools,</li>\n      <li>typical argument structures,</li>\n      <li>final-answer formatting.</li>\n    </ul>\n  </li>\n  <li>\n    <p>It is <strong>imitation</strong>, not <strong>policy optimisation</strong>.</p>\n  </li>\n</ul>\n<p>When training LLMs to produce reasoning traces, tool-call JSON, or final answers using labelled examples, SFT implements the above loss directly. The model does not explore, does not observe tool outputs, and is not rewarded for correct long-term actions.</p>\n<p>In the tool-calling context, SFT teaches:</p>\n<ul>\n      <li>how tool calls look (syntax),</li>\n      <li>rough patterns of when humans call tools,</li>\n      <li>typical argument structures,</li>\n      <li>final-answer formatting.</li>\n    </ul>\n<p>It is <strong>imitation</strong>, not <strong>policy optimisation</strong>.</p>\n<h4 id=\"why-imitation-learning-is-essential-before-rl\">Why Imitation Learning is Essential Before RL</h4>\n<ul>\n  <li>\n    <p>Reinforcement learning over raw text is unstable. The action space is huge, syntax is fragile, and initial random exploration produces invalid tool calls. Therefore, all effective tool-use RL systems warm-start with SFT to give the model <strong>baseline competencies</strong>:</p>\n\n    <ul>\n      <li>\n        <p><strong>Basic tool syntax and schema literacy</strong>: Without SFT, the model would produce malformed JSON during RL, causing constant errors and noisy gradients.</p>\n      </li>\n      <li>\n        <p><strong>A minimal “when/which/how” prior</strong>: SFT examples give the model at least a heuristic pattern of tool timing, tool choice, and argument formation.</p>\n      </li>\n      <li>\n        <p><strong>Reduced exploration burden</strong>: Starting RL from scratch would require immense exploration before any correct tool call is sampled. SFT drastically reduces the search space.</p>\n      </li>\n      <li>\n        <p><strong>Stability and safety in early RL training</strong>: RL at random-init leads to:</p>\n        <ul>\n          <li>runaway tool-call loops,</li>\n          <li>malformed arguments,</li>\n          <li>no successful episodes,</li>\n          <li>degenerate policies.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>SFT prevents this collapse by anchoring the initial model to sane behavior.</p>\n  </li>\n</ul>\n<p>Reinforcement learning over raw text is unstable. The action space is huge, syntax is fragile, and initial random exploration produces invalid tool calls. Therefore, all effective tool-use RL systems warm-start with SFT to give the model <strong>baseline competencies</strong>:</p>\n<ul>\n      <li>\n        <p><strong>Basic tool syntax and schema literacy</strong>: Without SFT, the model would produce malformed JSON during RL, causing constant errors and noisy gradients.</p>\n      </li>\n      <li>\n        <p><strong>A minimal “when/which/how” prior</strong>: SFT examples give the model at least a heuristic pattern of tool timing, tool choice, and argument formation.</p>\n      </li>\n      <li>\n        <p><strong>Reduced exploration burden</strong>: Starting RL from scratch would require immense exploration before any correct tool call is sampled. SFT drastically reduces the search space.</p>\n      </li>\n      <li>\n        <p><strong>Stability and safety in early RL training</strong>: RL at random-init leads to:</p>\n        <ul>\n          <li>runaway tool-call loops,</li>\n          <li>malformed arguments,</li>\n          <li>no successful episodes,</li>\n          <li>degenerate policies.</li>\n        </ul>\n      </li>\n    </ul>\n<p><strong>Basic tool syntax and schema literacy</strong>: Without SFT, the model would produce malformed JSON during RL, causing constant errors and noisy gradients.</p>\n<p><strong>A minimal “when/which/how” prior</strong>: SFT examples give the model at least a heuristic pattern of tool timing, tool choice, and argument formation.</p>\n<p><strong>Reduced exploration burden</strong>: Starting RL from scratch would require immense exploration before any correct tool call is sampled. SFT drastically reduces the search space.</p>\n<p><strong>Stability and safety in early RL training</strong>: RL at random-init leads to:</p>\n<ul>\n          <li>runaway tool-call loops,</li>\n          <li>malformed arguments,</li>\n          <li>no successful episodes,</li>\n          <li>degenerate policies.</li>\n        </ul>\n<p>SFT prevents this collapse by anchoring the initial model to sane behavior.</p>\n<h4 id=\"why-imitation-learning-alone-is-insufficient-recap\">Why Imitation Learning Alone is Insufficient (recap)</h4>\n<ul>\n  <li>\n    <p>SFT gives you <strong>competence</strong>, not <strong>policy mastery</strong>. After SFT, models still fail at:</p>\n\n    <ul>\n      <li>deciding <em>when</em> to avoid unnecessary tool calls,</li>\n      <li>selecting among multiple tools based on trade-offs,</li>\n      <li>tuning arguments based on execution feedback,</li>\n      <li>multi-step planning,</li>\n      <li>minimising tool-use cost,</li>\n      <li>stopping when enough information is gathered.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Imitation learning provides the <strong>starting point</strong>, while RL provides the <strong>decision-making optimisation</strong> needed for real tool-use proficiency.</p>\n  </li>\n</ul>\n<p>SFT gives you <strong>competence</strong>, not <strong>policy mastery</strong>. After SFT, models still fail at:</p>\n<ul>\n      <li>deciding <em>when</em> to avoid unnecessary tool calls,</li>\n      <li>selecting among multiple tools based on trade-offs,</li>\n      <li>tuning arguments based on execution feedback,</li>\n      <li>multi-step planning,</li>\n      <li>minimising tool-use cost,</li>\n      <li>stopping when enough information is gathered.</li>\n    </ul>\n<p>Imitation learning provides the <strong>starting point</strong>, while RL provides the <strong>decision-making optimisation</strong> needed for real tool-use proficiency.</p>",
    "contentMarkdown": "*   Before applying reinforcement learning to teach tool-calling behavior, modern LLM systems almost always begin with **imitation learning**. In the LLM context, imitation learning is implemented via **Supervised Fine-Tuning (SFT)** — training the model to reproduce expert-authored examples of correct tool usage.\n    \n*   This section explains (i) what imitation learning is, (ii) why SFT is a special case of it, and (iii) why imitation learning is a necessary warm-start for RL in tool-use settings.\n    \n\nBefore applying reinforcement learning to teach tool-calling behavior, modern LLM systems almost always begin with **imitation learning**. In the LLM context, imitation learning is implemented via **Supervised Fine-Tuning (SFT)** — training the model to reproduce expert-authored examples of correct tool usage.\n\nThis section explains (i) what imitation learning is, (ii) why SFT is a special case of it, and (iii) why imitation learning is a necessary warm-start for RL in tool-use settings.\n\n#### What is Imitation Learning?\n\n*   Imitation learning trains a policy by **directly copying expert actions** instead of learning via trial-and-error. No rewards, no exploration, no environment optimisation — just supervised mapping from states to actions.\n    \n*   Formally, given demonstration trajectories τ\\=(s0,a0),(s1,a1),…,(sT,aT)τ\\=(s0,a0),(s1,a1),…,(sT,aT)\\\\tau = {(s\\_0, a\\_0), (s\\_1, a\\_1), \\\\dots, (s\\_T, a\\_T)}, imitation learning maximises the likelihood of expert actions:\n    \n    LIL(θ)\\=−∑t\\=0Tlogpθ(aexpertt∣st)LIL(θ)\\=−∑t\\=0Tlog⁡pθ(atexpert∣st)\n    \n    L\\_{\\\\rm IL}(\\\\theta) = - \\\\sum\\_{t=0}^{T} \\\\log p\\_\\\\theta(a\\_t^{\\\\rm expert} \\\\mid s\\_t)\n*   This is close to standard supervised learning, but in robotics and RL theory it is known as **behavior cloning**, one of the simplest imitation-learning methods.\n    \n\nImitation learning trains a policy by **directly copying expert actions** instead of learning via trial-and-error. No rewards, no exploration, no environment optimisation — just supervised mapping from states to actions.\n\nFormally, given demonstration trajectories τ\\=(s0,a0),(s1,a1),…,(sT,aT)τ\\=(s0,a0),(s1,a1),…,(sT,aT)\\\\tau = {(s\\_0, a\\_0), (s\\_1, a\\_1), \\\\dots, (s\\_T, a\\_T)}, imitation learning maximises the likelihood of expert actions:\n\nThis is close to standard supervised learning, but in robotics and RL theory it is known as **behavior cloning**, one of the simplest imitation-learning methods.\n\n#### Why SFT is Exactly Imitation Learning\n\n*   When training LLMs to produce reasoning traces, tool-call JSON, or final answers using labelled examples, SFT implements the above loss directly. The model does not explore, does not observe tool outputs, and is not rewarded for correct long-term actions.\n    \n*   In the tool-calling context, SFT teaches:\n    \n    *   how tool calls look (syntax),\n    *   rough patterns of when humans call tools,\n    *   typical argument structures,\n    *   final-answer formatting.\n*   It is **imitation**, not **policy optimisation**.\n    \n\nWhen training LLMs to produce reasoning traces, tool-call JSON, or final answers using labelled examples, SFT implements the above loss directly. The model does not explore, does not observe tool outputs, and is not rewarded for correct long-term actions.\n\nIn the tool-calling context, SFT teaches:\n\n*   how tool calls look (syntax),\n*   rough patterns of when humans call tools,\n*   typical argument structures,\n*   final-answer formatting.\n\nIt is **imitation**, not **policy optimisation**.\n\n#### Why Imitation Learning is Essential Before RL\n\n*   Reinforcement learning over raw text is unstable. The action space is huge, syntax is fragile, and initial random exploration produces invalid tool calls. Therefore, all effective tool-use RL systems warm-start with SFT to give the model **baseline competencies**:\n    \n    *   **Basic tool syntax and schema literacy**: Without SFT, the model would produce malformed JSON during RL, causing constant errors and noisy gradients.\n        \n    *   **A minimal “when/which/how” prior**: SFT examples give the model at least a heuristic pattern of tool timing, tool choice, and argument formation.\n        \n    *   **Reduced exploration burden**: Starting RL from scratch would require immense exploration before any correct tool call is sampled. SFT drastically reduces the search space.\n        \n    *   **Stability and safety in early RL training**: RL at random-init leads to:\n        \n        *   runaway tool-call loops,\n        *   malformed arguments,\n        *   no successful episodes,\n        *   degenerate policies.\n*   SFT prevents this collapse by anchoring the initial model to sane behavior.\n    \n\nReinforcement learning over raw text is unstable. The action space is huge, syntax is fragile, and initial random exploration produces invalid tool calls. Therefore, all effective tool-use RL systems warm-start with SFT to give the model **baseline competencies**:\n\n*   **Basic tool syntax and schema literacy**: Without SFT, the model would produce malformed JSON during RL, causing constant errors and noisy gradients.\n    \n*   **A minimal “when/which/how” prior**: SFT examples give the model at least a heuristic pattern of tool timing, tool choice, and argument formation.\n    \n*   **Reduced exploration burden**: Starting RL from scratch would require immense exploration before any correct tool call is sampled. SFT drastically reduces the search space.\n    \n*   **Stability and safety in early RL training**: RL at random-init leads to:\n    \n    *   runaway tool-call loops,\n    *   malformed arguments,\n    *   no successful episodes,\n    *   degenerate policies.\n\n**Basic tool syntax and schema literacy**: Without SFT, the model would produce malformed JSON during RL, causing constant errors and noisy gradients.\n\n**A minimal “when/which/how” prior**: SFT examples give the model at least a heuristic pattern of tool timing, tool choice, and argument formation.\n\n**Reduced exploration burden**: Starting RL from scratch would require immense exploration before any correct tool call is sampled. SFT drastically reduces the search space.\n\n**Stability and safety in early RL training**: RL at random-init leads to:\n\n*   runaway tool-call loops,\n*   malformed arguments,\n*   no successful episodes,\n*   degenerate policies.\n\nSFT prevents this collapse by anchoring the initial model to sane behavior.\n\n#### Why Imitation Learning Alone is Insufficient (recap)\n\n*   SFT gives you **competence**, not **policy mastery**. After SFT, models still fail at:\n    \n    *   deciding _when_ to avoid unnecessary tool calls,\n    *   selecting among multiple tools based on trade-offs,\n    *   tuning arguments based on execution feedback,\n    *   multi-step planning,\n    *   minimising tool-use cost,\n    *   stopping when enough information is gathered.\n*   Imitation learning provides the **starting point**, while RL provides the **decision-making optimisation** needed for real tool-use proficiency.\n    \n\nSFT gives you **competence**, not **policy mastery**. After SFT, models still fail at:\n\n*   deciding _when_ to avoid unnecessary tool calls,\n*   selecting among multiple tools based on trade-offs,\n*   tuning arguments based on execution feedback,\n*   multi-step planning,\n*   minimising tool-use cost,\n*   stopping when enough information is gathered.\n\nImitation learning provides the **starting point**, while RL provides the **decision-making optimisation** needed for real tool-use proficiency.",
    "order": 1,
    "orderInChapter": 1,
    "difficulty": 3,
    "estimatedMinutes": 6,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "reinforcement learning",
      "supervised learning",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 1015,
      "contentLength": 35431
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#what-is-imitation-learning-and-why-sft-is-used-before-rl",
    "scrapedAt": "2025-12-28T11:47:36.150Z"
  },
  {
    "id": "ai-agentic-RL-motivation-2",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Background: Teaching Agents Tool-Calling with RL",
    "title": "Motivation",
    "subtitle": "Background: Teaching Agents Tool-Calling with RL",
    "contentHtml": "<ul>\n  <li>\n    <p>In recent years, the paradigm of tool-augmented reasoning with Large Language Models (LLMs) has gained traction: for example, <a href=\"https://arxiv.org/abs/2304.08354\">Tool Learning with Foundation Models</a> by Qin et al. (2023) provides a systematic overview of how foundation models can select and invoke external tools (e.g., APIs) to solve complex tasks.</p>\n  </li>\n  <li>\n    <p>Teaching an LLM to use tools is fundamentally a <strong>three-part learning problem</strong>:</p>\n\n    <ol>\n      <li><strong>When</strong> to call a tool: deciding whether a tool invocation is necessary, optional, or unnecessary for a given query.</li>\n      <li><strong>Which</strong> tool to call: selecting the correct tool among several available tools.</li>\n      <li><strong>How</strong> to call a tool: generating valid, correctly structured arguments that allow the tool to execute successfully.</li>\n    </ol>\n\n    <ul>\n      <li>These three categories correspond to <em>decision-level</em>, <em>selection-level</em>, and <em>argument-level</em> competencies, each requiring distinct supervision and reward signals.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Prior work such as <a href=\"https://arxiv.org/abs/2504.11536\">ReTool: Reinforcement Learning for Strategic Tool Use in LLMs</a> by Feng et al. (2025) and <a href=\"https://arxiv.org/abs/2504.13958\">ToolRL: Reward is All Tool Learning Needs</a> by Qian et al. (2025) demonstrates that <strong>fine-grained decomposition of the tool-learning problem significantly boosts RL stability and policy quality</strong>, especially when separating the decision to call a tool from the actual mechanics of tool invocation.</p>\n  </li>\n  <li>\n    <p>This write-up presents a full end-to-end RL recipe where a <strong>single policy</strong> is optimized with PPO or related algorithms to simultaneously learn:</p>\n\n    <ul>\n      <li><strong>When</strong> to call a tool,</li>\n      <li><strong>Which</strong> tool to choose, and</li>\n      <li><strong>How</strong> to construct correct arguments.</li>\n    </ul>\n  </li>\n</ul>\n<p>In recent years, the paradigm of tool-augmented reasoning with Large Language Models (LLMs) has gained traction: for example, <a href=\"https://arxiv.org/abs/2304.08354\">Tool Learning with Foundation Models</a> by Qin et al. (2023) provides a systematic overview of how foundation models can select and invoke external tools (e.g., APIs) to solve complex tasks.</p>\n<p>Teaching an LLM to use tools is fundamentally a <strong>three-part learning problem</strong>:</p>\n<ol>\n      <li><strong>When</strong> to call a tool: deciding whether a tool invocation is necessary, optional, or unnecessary for a given query.</li>\n      <li><strong>Which</strong> tool to call: selecting the correct tool among several available tools.</li>\n      <li><strong>How</strong> to call a tool: generating valid, correctly structured arguments that allow the tool to execute successfully.</li>\n    </ol>\n<ul>\n      <li>These three categories correspond to <em>decision-level</em>, <em>selection-level</em>, and <em>argument-level</em> competencies, each requiring distinct supervision and reward signals.</li>\n    </ul>\n<p>Prior work such as <a href=\"https://arxiv.org/abs/2504.11536\">ReTool: Reinforcement Learning for Strategic Tool Use in LLMs</a> by Feng et al. (2025) and <a href=\"https://arxiv.org/abs/2504.13958\">ToolRL: Reward is All Tool Learning Needs</a> by Qian et al. (2025) demonstrates that <strong>fine-grained decomposition of the tool-learning problem significantly boosts RL stability and policy quality</strong>, especially when separating the decision to call a tool from the actual mechanics of tool invocation.</p>\n<p>This write-up presents a full end-to-end RL recipe where a <strong>single policy</strong> is optimized with PPO or related algorithms to simultaneously learn:</p>\n<ul>\n      <li><strong>When</strong> to call a tool,</li>\n      <li><strong>Which</strong> tool to choose, and</li>\n      <li><strong>How</strong> to construct correct arguments.</li>\n    </ul>\n<h4 id=\"why-when--which--how-decomposition-is-necessary\">Why “when / Which / How” Decomposition is Necessary</h4>\n<ul>\n  <li>\n    <p><strong>When</strong>: The timing of tool usage determines the efficiency and correctness of solutions. Over-calling leads to unnecessary cost and latency, while under-calling leads to incomplete or incorrect answers. Tool timing thus forms a <strong>binary or multi-class policy decision</strong> that must be explicitly learned.</p>\n  </li>\n  <li>\n    <p><strong>Which</strong>: Even when a tool call is appropriate, the model must choose the correct tool among a library of APIs. This is a <strong>classification problem</strong>, requiring a structured action space and tool-selection reward.</p>\n  </li>\n  <li>\n    <p><strong>How</strong>: Tool arguments must be valid JSON, consistent with schemas, and semantically correct. This is a <strong>structured generation problem</strong>, requiring rewards for syntax, executability, and argument quality.</p>\n  </li>\n  <li>\n    <p>Even within one policy, these decisions require <strong>different supervision signals</strong>, and RL benefits from isolating their reward terms so the model knows why a trajectory is good or bad.</p>\n  </li>\n  <li>\n    <p>Research such as <a href=\"https://arxiv.org/abs/2504.13958\">ToolRL</a> shows that <strong>decomposed reward components</strong> for these distinct competencies improve reward signal clarity, reduce credit assignment difficulty, and produce more controllable execution-time behavior.</p>\n  </li>\n</ul>\n<p><strong>When</strong>: The timing of tool usage determines the efficiency and correctness of solutions. Over-calling leads to unnecessary cost and latency, while under-calling leads to incomplete or incorrect answers. Tool timing thus forms a <strong>binary or multi-class policy decision</strong> that must be explicitly learned.</p>\n<p><strong>Which</strong>: Even when a tool call is appropriate, the model must choose the correct tool among a library of APIs. This is a <strong>classification problem</strong>, requiring a structured action space and tool-selection reward.</p>\n<p><strong>How</strong>: Tool arguments must be valid JSON, consistent with schemas, and semantically correct. This is a <strong>structured generation problem</strong>, requiring rewards for syntax, executability, and argument quality.</p>\n<p>Even within one policy, these decisions require <strong>different supervision signals</strong>, and RL benefits from isolating their reward terms so the model knows why a trajectory is good or bad.</p>\n<p>Research such as <a href=\"https://arxiv.org/abs/2504.13958\">ToolRL</a> shows that <strong>decomposed reward components</strong> for these distinct competencies improve reward signal clarity, reduce credit assignment difficulty, and produce more controllable execution-time behavior.</p>",
    "contentMarkdown": "*   In recent years, the paradigm of tool-augmented reasoning with Large Language Models (LLMs) has gained traction: for example, [Tool Learning with Foundation Models](https://arxiv.org/abs/2304.08354) by Qin et al. (2023) provides a systematic overview of how foundation models can select and invoke external tools (e.g., APIs) to solve complex tasks.\n    \n*   Teaching an LLM to use tools is fundamentally a **three-part learning problem**:\n    \n    1.  **When** to call a tool: deciding whether a tool invocation is necessary, optional, or unnecessary for a given query.\n    2.  **Which** tool to call: selecting the correct tool among several available tools.\n    3.  **How** to call a tool: generating valid, correctly structured arguments that allow the tool to execute successfully.\n    \n    *   These three categories correspond to _decision-level_, _selection-level_, and _argument-level_ competencies, each requiring distinct supervision and reward signals.\n*   Prior work such as [ReTool: Reinforcement Learning for Strategic Tool Use in LLMs](https://arxiv.org/abs/2504.11536) by Feng et al. (2025) and [ToolRL: Reward is All Tool Learning Needs](https://arxiv.org/abs/2504.13958) by Qian et al. (2025) demonstrates that **fine-grained decomposition of the tool-learning problem significantly boosts RL stability and policy quality**, especially when separating the decision to call a tool from the actual mechanics of tool invocation.\n    \n*   This write-up presents a full end-to-end RL recipe where a **single policy** is optimized with PPO or related algorithms to simultaneously learn:\n    \n    *   **When** to call a tool,\n    *   **Which** tool to choose, and\n    *   **How** to construct correct arguments.\n\nIn recent years, the paradigm of tool-augmented reasoning with Large Language Models (LLMs) has gained traction: for example, [Tool Learning with Foundation Models](https://arxiv.org/abs/2304.08354) by Qin et al. (2023) provides a systematic overview of how foundation models can select and invoke external tools (e.g., APIs) to solve complex tasks.\n\nTeaching an LLM to use tools is fundamentally a **three-part learning problem**:\n\n1.  **When** to call a tool: deciding whether a tool invocation is necessary, optional, or unnecessary for a given query.\n2.  **Which** tool to call: selecting the correct tool among several available tools.\n3.  **How** to call a tool: generating valid, correctly structured arguments that allow the tool to execute successfully.\n\n*   These three categories correspond to _decision-level_, _selection-level_, and _argument-level_ competencies, each requiring distinct supervision and reward signals.\n\nPrior work such as [ReTool: Reinforcement Learning for Strategic Tool Use in LLMs](https://arxiv.org/abs/2504.11536) by Feng et al. (2025) and [ToolRL: Reward is All Tool Learning Needs](https://arxiv.org/abs/2504.13958) by Qian et al. (2025) demonstrates that **fine-grained decomposition of the tool-learning problem significantly boosts RL stability and policy quality**, especially when separating the decision to call a tool from the actual mechanics of tool invocation.\n\nThis write-up presents a full end-to-end RL recipe where a **single policy** is optimized with PPO or related algorithms to simultaneously learn:\n\n*   **When** to call a tool,\n*   **Which** tool to choose, and\n*   **How** to construct correct arguments.\n\n#### Why “when / Which / How” Decomposition is Necessary\n\n*   **When**: The timing of tool usage determines the efficiency and correctness of solutions. Over-calling leads to unnecessary cost and latency, while under-calling leads to incomplete or incorrect answers. Tool timing thus forms a **binary or multi-class policy decision** that must be explicitly learned.\n    \n*   **Which**: Even when a tool call is appropriate, the model must choose the correct tool among a library of APIs. This is a **classification problem**, requiring a structured action space and tool-selection reward.\n    \n*   **How**: Tool arguments must be valid JSON, consistent with schemas, and semantically correct. This is a **structured generation problem**, requiring rewards for syntax, executability, and argument quality.\n    \n*   Even within one policy, these decisions require **different supervision signals**, and RL benefits from isolating their reward terms so the model knows why a trajectory is good or bad.\n    \n*   Research such as [ToolRL](https://arxiv.org/abs/2504.13958) shows that **decomposed reward components** for these distinct competencies improve reward signal clarity, reduce credit assignment difficulty, and produce more controllable execution-time behavior.\n    \n\n**When**: The timing of tool usage determines the efficiency and correctness of solutions. Over-calling leads to unnecessary cost and latency, while under-calling leads to incomplete or incorrect answers. Tool timing thus forms a **binary or multi-class policy decision** that must be explicitly learned.\n\n**Which**: Even when a tool call is appropriate, the model must choose the correct tool among a library of APIs. This is a **classification problem**, requiring a structured action space and tool-selection reward.\n\n**How**: Tool arguments must be valid JSON, consistent with schemas, and semantically correct. This is a **structured generation problem**, requiring rewards for syntax, executability, and argument quality.\n\nEven within one policy, these decisions require **different supervision signals**, and RL benefits from isolating their reward terms so the model knows why a trajectory is good or bad.\n\nResearch such as [ToolRL](https://arxiv.org/abs/2504.13958) shows that **decomposed reward components** for these distinct competencies improve reward signal clarity, reduce credit assignment difficulty, and produce more controllable execution-time behavior.",
    "order": 2,
    "orderInChapter": 1,
    "difficulty": 2,
    "estimatedMinutes": 4,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 799,
      "contentLength": 6921
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#motivation",
    "scrapedAt": "2025-12-28T11:47:36.150Z"
  },
  {
    "id": "ai-agentic-RL-recipe-3",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Background: Teaching Agents Tool-Calling with RL",
    "title": "Recipe",
    "subtitle": "Background: Teaching Agents Tool-Calling with RL",
    "contentHtml": "<ul>\n  <li>\n    <p>Here is a summary of the major phases to be implemented:</p>\n\n    <ol>\n      <li>\n        <p><strong>Define an environment and action space</strong> that supports:</p>\n\n        <ul>\n          <li>when-decisions (tool vs. no-tool),</li>\n          <li>which-decisions (tool selection),</li>\n          <li>how-decisions (argument generation).</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Annotate or derive labels</strong> for each learning axis:</p>\n\n        <ul>\n          <li><strong>when-labels</strong>: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>when</mtext></mrow></msub><mo>&amp;#x2208;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-283\" style=\"width: 5.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1004.59em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-284\"><span class=\"msubsup\" id=\"MathJax-Span-285\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-286\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-287\"><span class=\"mrow\" id=\"MathJax-Span-288\"><span class=\"mtext\" id=\"MathJax-Span-289\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">when</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-290\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"texatom\" id=\"MathJax-Span-291\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-292\"><span class=\"mn\" id=\"MathJax-Span-293\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-294\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-295\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>when</mtext></mrow></msub><mo>∈</mo><mrow class=\"MJX-TeXAtom-ORD\"><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">y_{\\text{when}} \\in {0,1}</script></li>\n          <li><strong>which-labels</strong>: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>which</mtext></mrow></msub><mo>&amp;#x2208;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><mi>K</mi></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-296\" style=\"width: 8.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.878em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1006.88em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-297\"><span class=\"msubsup\" id=\"MathJax-Span-298\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-299\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-300\"><span class=\"mrow\" id=\"MathJax-Span-301\"><span class=\"mtext\" id=\"MathJax-Span-302\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">which</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-303\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"texatom\" id=\"MathJax-Span-304\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-305\"><span class=\"mn\" id=\"MathJax-Span-306\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-307\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-308\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">…</span><span class=\"mo\" id=\"MathJax-Span-309\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"mi\" id=\"MathJax-Span-310\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>which</mtext></mrow></msub><mo>∈</mo><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>K</mi></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">y_{\\text{which}} \\in {1,\\dots,K}</script> for <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-311\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-312\"><span class=\"mi\" id=\"MathJax-Span-313\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-20\">K</script> tools</li>\n          <li><strong>how-labels</strong>: argument-schema exemplars or reference traces</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Bootstrap the LLM via supervised fine-tuning</strong> (imitation learning) so the policy starts with a basic understanding of:</p>\n\n        <ul>\n          <li>tool timing,</li>\n          <li>tool selection,</li>\n          <li>valid argument formats.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Design a multi-component reward function</strong> including:</p>\n\n        <ul>\n          <li>a <strong>when-reward</strong> for correct tool/no-tool decisions,</li>\n          <li>a <strong>which-reward</strong> for correct tool selection,</li>\n          <li>a <strong>how-reward</strong> for syntax validity, executability, and argument quality,</li>\n          <li>a final <strong>task-success reward</strong>.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Train using PPO (or GRPO)</strong> over trajectories with the combined reward:</p>\n\n        <ul>\n          <li>compute returns <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-314\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-315\"><span class=\"msubsup\" id=\"MathJax-Span-316\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-317\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-318\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-21\">R_t</script>,</li>\n          <li>compute advantages <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-319\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-320\"><span class=\"msubsup\" id=\"MathJax-Span-321\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-322\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-323\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-22\">A_t</script> (e.g., with GAE),</li>\n          <li>update policy and value model with KL regularization to a supervised fallback policy.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Curriculum design</strong>: progress from simple supervised traces to complex multi-step workflows where the model must interleave “when”, “which”, and “how” decisions.</p>\n      </li>\n      <li>\n        <p><strong>Diagnostics and evaluation</strong>: track metrics for each axis separately:</p>\n\n        <ul>\n          <li>when-accuracy,</li>\n          <li>which-accuracy,</li>\n          <li>argument correctness,</li>\n          <li>executability rate,</li>\n          <li>and final task accuracy.</li>\n        </ul>\n      </li>\n    </ol>\n  </li>\n</ul>\n<p>Here is a summary of the major phases to be implemented:</p>\n<ol>\n      <li>\n        <p><strong>Define an environment and action space</strong> that supports:</p>\n\n        <ul>\n          <li>when-decisions (tool vs. no-tool),</li>\n          <li>which-decisions (tool selection),</li>\n          <li>how-decisions (argument generation).</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Annotate or derive labels</strong> for each learning axis:</p>\n\n        <ul>\n          <li><strong>when-labels</strong>: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>when</mtext></mrow></msub><mo>&amp;#x2208;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-283\" style=\"width: 5.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1004.59em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-284\"><span class=\"msubsup\" id=\"MathJax-Span-285\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-286\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-287\"><span class=\"mrow\" id=\"MathJax-Span-288\"><span class=\"mtext\" id=\"MathJax-Span-289\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">when</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-290\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"texatom\" id=\"MathJax-Span-291\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-292\"><span class=\"mn\" id=\"MathJax-Span-293\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-294\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-295\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>when</mtext></mrow></msub><mo>∈</mo><mrow class=\"MJX-TeXAtom-ORD\"><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">y_{\\text{when}} \\in {0,1}</script></li>\n          <li><strong>which-labels</strong>: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>which</mtext></mrow></msub><mo>&amp;#x2208;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><mi>K</mi></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-296\" style=\"width: 8.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.878em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1006.88em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-297\"><span class=\"msubsup\" id=\"MathJax-Span-298\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-299\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-300\"><span class=\"mrow\" id=\"MathJax-Span-301\"><span class=\"mtext\" id=\"MathJax-Span-302\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">which</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-303\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"texatom\" id=\"MathJax-Span-304\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-305\"><span class=\"mn\" id=\"MathJax-Span-306\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-307\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-308\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">…</span><span class=\"mo\" id=\"MathJax-Span-309\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"mi\" id=\"MathJax-Span-310\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>which</mtext></mrow></msub><mo>∈</mo><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>K</mi></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">y_{\\text{which}} \\in {1,\\dots,K}</script> for <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-311\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-312\"><span class=\"mi\" id=\"MathJax-Span-313\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-20\">K</script> tools</li>\n          <li><strong>how-labels</strong>: argument-schema exemplars or reference traces</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Bootstrap the LLM via supervised fine-tuning</strong> (imitation learning) so the policy starts with a basic understanding of:</p>\n\n        <ul>\n          <li>tool timing,</li>\n          <li>tool selection,</li>\n          <li>valid argument formats.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Design a multi-component reward function</strong> including:</p>\n\n        <ul>\n          <li>a <strong>when-reward</strong> for correct tool/no-tool decisions,</li>\n          <li>a <strong>which-reward</strong> for correct tool selection,</li>\n          <li>a <strong>how-reward</strong> for syntax validity, executability, and argument quality,</li>\n          <li>a final <strong>task-success reward</strong>.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Train using PPO (or GRPO)</strong> over trajectories with the combined reward:</p>\n\n        <ul>\n          <li>compute returns <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-314\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-315\"><span class=\"msubsup\" id=\"MathJax-Span-316\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-317\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-318\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-21\">R_t</script>,</li>\n          <li>compute advantages <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-319\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-320\"><span class=\"msubsup\" id=\"MathJax-Span-321\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-322\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-323\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-22\">A_t</script> (e.g., with GAE),</li>\n          <li>update policy and value model with KL regularization to a supervised fallback policy.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Curriculum design</strong>: progress from simple supervised traces to complex multi-step workflows where the model must interleave “when”, “which”, and “how” decisions.</p>\n      </li>\n      <li>\n        <p><strong>Diagnostics and evaluation</strong>: track metrics for each axis separately:</p>\n\n        <ul>\n          <li>when-accuracy,</li>\n          <li>which-accuracy,</li>\n          <li>argument correctness,</li>\n          <li>executability rate,</li>\n          <li>and final task accuracy.</li>\n        </ul>\n      </li>\n    </ol>\n<p><strong>Define an environment and action space</strong> that supports:</p>\n<ul>\n          <li>when-decisions (tool vs. no-tool),</li>\n          <li>which-decisions (tool selection),</li>\n          <li>how-decisions (argument generation).</li>\n        </ul>\n<p><strong>Annotate or derive labels</strong> for each learning axis:</p>\n<ul>\n          <li><strong>when-labels</strong>: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>when</mtext></mrow></msub><mo>&amp;#x2208;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-283\" style=\"width: 5.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1004.59em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-284\"><span class=\"msubsup\" id=\"MathJax-Span-285\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-286\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-287\"><span class=\"mrow\" id=\"MathJax-Span-288\"><span class=\"mtext\" id=\"MathJax-Span-289\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">when</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-290\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"texatom\" id=\"MathJax-Span-291\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-292\"><span class=\"mn\" id=\"MathJax-Span-293\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-294\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-295\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>when</mtext></mrow></msub><mo>∈</mo><mrow class=\"MJX-TeXAtom-ORD\"><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">y_{\\text{when}} \\in {0,1}</script></li>\n          <li><strong>which-labels</strong>: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>which</mtext></mrow></msub><mo>&amp;#x2208;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><mi>K</mi></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-296\" style=\"width: 8.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.878em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1006.88em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-297\"><span class=\"msubsup\" id=\"MathJax-Span-298\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-299\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-300\"><span class=\"mrow\" id=\"MathJax-Span-301\"><span class=\"mtext\" id=\"MathJax-Span-302\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">which</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-303\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"texatom\" id=\"MathJax-Span-304\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-305\"><span class=\"mn\" id=\"MathJax-Span-306\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-307\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-308\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">…</span><span class=\"mo\" id=\"MathJax-Span-309\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"mi\" id=\"MathJax-Span-310\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>which</mtext></mrow></msub><mo>∈</mo><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>K</mi></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">y_{\\text{which}} \\in {1,\\dots,K}</script> for <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-311\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-312\"><span class=\"mi\" id=\"MathJax-Span-313\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-20\">K</script> tools</li>\n          <li><strong>how-labels</strong>: argument-schema exemplars or reference traces</li>\n        </ul>\n<p><strong>Bootstrap the LLM via supervised fine-tuning</strong> (imitation learning) so the policy starts with a basic understanding of:</p>\n<ul>\n          <li>tool timing,</li>\n          <li>tool selection,</li>\n          <li>valid argument formats.</li>\n        </ul>\n<p><strong>Design a multi-component reward function</strong> including:</p>\n<ul>\n          <li>a <strong>when-reward</strong> for correct tool/no-tool decisions,</li>\n          <li>a <strong>which-reward</strong> for correct tool selection,</li>\n          <li>a <strong>how-reward</strong> for syntax validity, executability, and argument quality,</li>\n          <li>a final <strong>task-success reward</strong>.</li>\n        </ul>\n<p><strong>Train using PPO (or GRPO)</strong> over trajectories with the combined reward:</p>\n<ul>\n          <li>compute returns <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-314\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-315\"><span class=\"msubsup\" id=\"MathJax-Span-316\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-317\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-318\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-21\">R_t</script>,</li>\n          <li>compute advantages <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-319\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-320\"><span class=\"msubsup\" id=\"MathJax-Span-321\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-322\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-323\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-22\">A_t</script> (e.g., with GAE),</li>\n          <li>update policy and value model with KL regularization to a supervised fallback policy.</li>\n        </ul>\n<p><strong>Curriculum design</strong>: progress from simple supervised traces to complex multi-step workflows where the model must interleave “when”, “which”, and “how” decisions.</p>\n<p><strong>Diagnostics and evaluation</strong>: track metrics for each axis separately:</p>\n<ul>\n          <li>when-accuracy,</li>\n          <li>which-accuracy,</li>\n          <li>argument correctness,</li>\n          <li>executability rate,</li>\n          <li>and final task accuracy.</li>\n        </ul>",
    "contentMarkdown": "*   Here is a summary of the major phases to be implemented:\n    \n    1.  **Define an environment and action space** that supports:\n        \n        *   when-decisions (tool vs. no-tool),\n        *   which-decisions (tool selection),\n        *   how-decisions (argument generation).\n    2.  **Annotate or derive labels** for each learning axis:\n        \n        *   **when-labels**: ywhen∈0,1ywhen∈0,1y\\_{\\\\text{when}} \\\\in {0,1}\n        *   **which-labels**: ywhich∈1,…,Kywhich∈1,…,Ky\\_{\\\\text{which}} \\\\in {1,\\\\dots,K} for KKK tools\n        *   **how-labels**: argument-schema exemplars or reference traces\n    3.  **Bootstrap the LLM via supervised fine-tuning** (imitation learning) so the policy starts with a basic understanding of:\n        \n        *   tool timing,\n        *   tool selection,\n        *   valid argument formats.\n    4.  **Design a multi-component reward function** including:\n        \n        *   a **when-reward** for correct tool/no-tool decisions,\n        *   a **which-reward** for correct tool selection,\n        *   a **how-reward** for syntax validity, executability, and argument quality,\n        *   a final **task-success reward**.\n    5.  **Train using PPO (or GRPO)** over trajectories with the combined reward:\n        \n        *   compute returns RtRtR\\_t,\n        *   compute advantages AtAtA\\_t (e.g., with GAE),\n        *   update policy and value model with KL regularization to a supervised fallback policy.\n    6.  **Curriculum design**: progress from simple supervised traces to complex multi-step workflows where the model must interleave “when”, “which”, and “how” decisions.\n        \n    7.  **Diagnostics and evaluation**: track metrics for each axis separately:\n        \n        *   when-accuracy,\n        *   which-accuracy,\n        *   argument correctness,\n        *   executability rate,\n        *   and final task accuracy.\n\nHere is a summary of the major phases to be implemented:\n\n1.  **Define an environment and action space** that supports:\n    \n    *   when-decisions (tool vs. no-tool),\n    *   which-decisions (tool selection),\n    *   how-decisions (argument generation).\n2.  **Annotate or derive labels** for each learning axis:\n    \n    *   **when-labels**: ywhen∈0,1ywhen∈0,1y\\_{\\\\text{when}} \\\\in {0,1}\n    *   **which-labels**: ywhich∈1,…,Kywhich∈1,…,Ky\\_{\\\\text{which}} \\\\in {1,\\\\dots,K} for KKK tools\n    *   **how-labels**: argument-schema exemplars or reference traces\n3.  **Bootstrap the LLM via supervised fine-tuning** (imitation learning) so the policy starts with a basic understanding of:\n    \n    *   tool timing,\n    *   tool selection,\n    *   valid argument formats.\n4.  **Design a multi-component reward function** including:\n    \n    *   a **when-reward** for correct tool/no-tool decisions,\n    *   a **which-reward** for correct tool selection,\n    *   a **how-reward** for syntax validity, executability, and argument quality,\n    *   a final **task-success reward**.\n5.  **Train using PPO (or GRPO)** over trajectories with the combined reward:\n    \n    *   compute returns RtRtR\\_t,\n    *   compute advantages AtAtA\\_t (e.g., with GAE),\n    *   update policy and value model with KL regularization to a supervised fallback policy.\n6.  **Curriculum design**: progress from simple supervised traces to complex multi-step workflows where the model must interleave “when”, “which”, and “how” decisions.\n    \n7.  **Diagnostics and evaluation**: track metrics for each axis separately:\n    \n    *   when-accuracy,\n    *   which-accuracy,\n    *   argument correctness,\n    *   executability rate,\n    *   and final task accuracy.\n\n**Define an environment and action space** that supports:\n\n*   when-decisions (tool vs. no-tool),\n*   which-decisions (tool selection),\n*   how-decisions (argument generation).\n\n**Annotate or derive labels** for each learning axis:\n\n*   **when-labels**: ywhen∈0,1ywhen∈0,1y\\_{\\\\text{when}} \\\\in {0,1}\n*   **which-labels**: ywhich∈1,…,Kywhich∈1,…,Ky\\_{\\\\text{which}} \\\\in {1,\\\\dots,K} for KKK tools\n*   **how-labels**: argument-schema exemplars or reference traces\n\n**Bootstrap the LLM via supervised fine-tuning** (imitation learning) so the policy starts with a basic understanding of:\n\n*   tool timing,\n*   tool selection,\n*   valid argument formats.\n\n**Design a multi-component reward function** including:\n\n*   a **when-reward** for correct tool/no-tool decisions,\n*   a **which-reward** for correct tool selection,\n*   a **how-reward** for syntax validity, executability, and argument quality,\n*   a final **task-success reward**.\n\n**Train using PPO (or GRPO)** over trajectories with the combined reward:\n\n*   compute returns RtRtR\\_t,\n*   compute advantages AtAtA\\_t (e.g., with GAE),\n*   update policy and value model with KL regularization to a supervised fallback policy.\n\n**Curriculum design**: progress from simple supervised traces to complex multi-step workflows where the model must interleave “when”, “which”, and “how” decisions.\n\n**Diagnostics and evaluation**: track metrics for each axis separately:\n\n*   when-accuracy,\n*   which-accuracy,\n*   argument correctness,\n*   executability rate,\n*   and final task accuracy.",
    "order": 3,
    "orderInChapter": 2,
    "difficulty": 3,
    "estimatedMinutes": 4,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "regularization",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 613,
      "contentLength": 39785
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#recipe",
    "scrapedAt": "2025-12-28T11:47:36.150Z"
  },
  {
    "id": "ai-agentic-RL-environment-mdp-formulation-and-action-space-4",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Background: Teaching Agents Tool-Calling with RL",
    "title": "Environment, MDP Formulation, and Action Space",
    "subtitle": "Background: Teaching Agents Tool-Calling with RL",
    "contentHtml": "<ul>\n  <li>Tool-augmented LLMs must make three decisions during reasoning:\n    <ol>\n      <li>whether a tool should be invoked (<strong>when</strong>),</li>\n      <li>which tool is appropriate (<strong>which</strong>), and</li>\n      <li>how to construct valid and effective arguments (<strong>how</strong>).</li>\n    </ol>\n  </li>\n  <li>This decomposition mirrors the behavioral factorization used in systems such as <a href=\"https://arxiv.org/abs/2302.04761\">Toolformer</a> by Schick et al. (2023) and the structured planning seen in <a href=\"https://arxiv.org/abs/2210.03629\">ReAct</a> by Yao et al. (2022). It also aligns with the policy design in recent RL approaches like <a href=\"https://arxiv.org/abs/2504.11536\">ReTool</a> by Feng et al. (2025) and <a href=\"https://arxiv.org/abs/2504.13958\">ToolRL</a> (2025), where tool selection is modeled as a multi-stage decision.</li>\n</ul>\n<ol>\n      <li>whether a tool should be invoked (<strong>when</strong>),</li>\n      <li>which tool is appropriate (<strong>which</strong>), and</li>\n      <li>how to construct valid and effective arguments (<strong>how</strong>).</li>\n    </ol>\n<h4 id=\"the-mdp-for-when--which--how\">The MDP for “When / Which / How”</h4>\n<ul>\n  <li>\n    <p>We model tool use as an MDP:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>M</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>S</mi><mo>,</mo><mi>A</mi><mo>,</mo><mi>P</mi><mo>,</mo><mi>R</mi><mo>,</mo><mi>&amp;#x03B3;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-324\" style=\"width: 9.273em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1007.66em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-325\"><span class=\"mi\" id=\"MathJax-Span-326\" style=\"font-family: STIXGeneral-Italic;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-327\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-328\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"mi\" id=\"MathJax-Span-329\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-330\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-331\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">A</span><span class=\"mo\" id=\"MathJax-Span-332\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-333\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">P</span><span class=\"mo\" id=\"MathJax-Span-334\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-335\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">R</span><span class=\"mo\" id=\"MathJax-Span-336\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-337\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-338\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>M</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>S</mi><mo>,</mo><mi>A</mi><mo>,</mo><mi>P</mi><mo>,</mo><mi>R</mi><mo>,</mo><mi>γ</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-23\">M = (S, A, P, R, \\gamma)</script>\n\n    <ul>\n      <li>… with a factored action space that explicitly captures the “when/which/how” structure.</li>\n    </ul>\n  </li>\n</ul>\n<p>We model tool use as an MDP:</p>\n<ul>\n      <li>… with a factored action space that explicitly captures the “when/which/how” structure.</li>\n    </ul>\n<h4 id=\"state-s_t\">State (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-339\" style=\"width: 0.835em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.669em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.585em, 1000.67em, 2.46em, -999.998em); top: -2.165em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-340\"><span class=\"msubsup\" id=\"MathJax-Span-341\"><span style=\"display: inline-block; position: relative; width: 0.669em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.419em, 1000.38em, 4.127em, -999.998em); top: -3.998em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-342\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.002em;\"></span></span><span style=\"position: absolute; top: -3.831em; left: 0.377em;\"><span class=\"mi\" id=\"MathJax-Span-343\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.002em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.002em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.169em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.802em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-24\">s_t</script>)</h4>\n<ul>\n  <li>\n    <p>Each state encodes:</p>\n\n    <ul>\n      <li>the user’s query</li>\n      <li>ongoing reasoning steps</li>\n      <li>past tool calls and outputs</li>\n      <li>system instructions</li>\n      <li>optional episodic memory (short-term trajectories)</li>\n    </ul>\n  </li>\n  <li>\n    <p>The full state is serialized into a structured text prompt fed into the LLM, much like ReAct-style reasoning traces.</p>\n  </li>\n</ul>\n<p>Each state encodes:</p>\n<ul>\n      <li>the user’s query</li>\n      <li>ongoing reasoning steps</li>\n      <li>past tool calls and outputs</li>\n      <li>system instructions</li>\n      <li>optional episodic memory (short-term trajectories)</li>\n    </ul>\n<p>The full state is serialized into a structured text prompt fed into the LLM, much like ReAct-style reasoning traces.</p>\n<h4 id=\"structured-factored-action-space\">Structured, Factored Action Space</h4>\n<ul>\n  <li>\n    <p>The action space is decomposed into:</p>\n\n    <ol>\n      <li><strong>When</strong> to call a tool</li>\n      <li><strong>Which</strong> tool to call (conditional on calling)</li>\n      <li><strong>How</strong> to construct arguments (conditional on chosen tool)</li>\n    </ol>\n  </li>\n  <li>\n    <p>This yields two disjoint high-level action types:</p>\n  </li>\n</ul>\n<p>The action space is decomposed into:</p>\n<ol>\n      <li><strong>When</strong> to call a tool</li>\n      <li><strong>Which</strong> tool to call (conditional on calling)</li>\n      <li><strong>How</strong> to construct arguments (conditional on chosen tool)</li>\n    </ol>\n<p>This yields two disjoint high-level action types:</p>\n<h4 id=\"action-type-1-answerfinal_text\">Action Type 1: <code class=\"language-plaintext Highlighter-rouge\">ANSWER(final_text)</code></h4>\n<ul>\n  <li>Used when the model decides <em>no more tool calls are needed</em>.</li>\n</ul>\n<h4 id=\"action-type-2-calltool_name-args_json\">Action Type 2: <code class=\"language-plaintext Highlighter-rouge\">CALL(tool_name, Args_json)</code></h4>\n<ul>\n  <li>\n    <p>Further factored into:</p>\n\n    <ul>\n      <li><strong>When</strong>: deciding to call a tool rather than answer</li>\n      <li><strong>Which</strong>: selecting a tool from the available toolset</li>\n      <li><strong>How</strong>: generating a valid argument JSON for that tool</li>\n    </ul>\n  </li>\n  <li>\n    <p>This factorization improves learning by ensuring that RL gradients reflect distinct sub-skills within tool usage.</p>\n  </li>\n</ul>\n<p>Further factored into:</p>\n<ul>\n      <li><strong>When</strong>: deciding to call a tool rather than answer</li>\n      <li><strong>Which</strong>: selecting a tool from the available toolset</li>\n      <li><strong>How</strong>: generating a valid argument JSON for that tool</li>\n    </ul>\n<p>This factorization improves learning by ensuring that RL gradients reflect distinct sub-skills within tool usage.</p>\n<h4 id=\"structured-action-encoding\">Structured Action Encoding</h4>\n<ul>\n  <li>\n    <p>To stabilize RL training, each action is formatted in strict machine-readable JSON, following the practice in ReTool and Toolformer:</p>\n\n    <ul>\n      <li>Example: <strong>CALL action</strong></li>\n    </ul>\n\n    <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><div><button class=\"btn-copy\" data-clipboard-action=\"copy\" data-clipboard-target=\"#code0\"><img src=\"https://aman.ai/images/copy.png\" style=\"margin:0; border:none; padding:2px 0px; width:100%; height:18px; width:18px;\"></button></div><code id=\"code0\">&lt;action&gt;\n  {\n    \"type\": \"call\",\n    \"when\": true,\n    \"which\": \"weather_api\",\n    \"how\": { \"city\": \"Berlin\", \"date\": \"2025-05-09\" }\n  }\n&lt;/action&gt;\n</code></pre></div>    </div>\n\n    <ul>\n      <li>Example: <strong>ANSWER action</strong></li>\n    </ul>\n\n    <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><div><button class=\"btn-copy\" data-clipboard-action=\"copy\" data-clipboard-target=\"#code1\"><img src=\"https://aman.ai/images/copy.png\" style=\"margin:0; border:none; padding:2px 0px; width:100%; height:18px; width:18px;\"></button></div><code id=\"code1\">&lt;action&gt;\n  {\n    \"type\": \"answer\",\n    \"when\": false,\n    \"content\": \"It will rain in Berlin tomorrow.\"\n  }\n&lt;/action&gt;\n</code></pre></div>    </div>\n  </li>\n  <li>\n    <p>The <strong>when</strong> flag can be made explicit or implicit; explicit inclusion helps debugging and credit assignment.</p>\n  </li>\n</ul>\n<p>To stabilize RL training, each action is formatted in strict machine-readable JSON, following the practice in ReTool and Toolformer:</p>\n<ul>\n      <li>Example: <strong>CALL action</strong></li>\n    </ul>\n<pre class=\"highlight\"><div><button class=\"btn-copy\" data-clipboard-action=\"copy\" data-clipboard-target=\"#code0\"><img src=\"https://aman.ai/images/copy.png\" style=\"margin:0; border:none; padding:2px 0px; width:100%; height:18px; width:18px;\"></button></div><code id=\"code0\">&lt;action&gt;\n  {\n    \"type\": \"call\",\n    \"when\": true,\n    \"which\": \"weather_api\",\n    \"how\": { \"city\": \"Berlin\", \"date\": \"2025-05-09\" }\n  }\n&lt;/action&gt;\n</code></pre>\n<ul>\n      <li>Example: <strong>ANSWER action</strong></li>\n    </ul>\n<pre class=\"highlight\"><div><button class=\"btn-copy\" data-clipboard-action=\"copy\" data-clipboard-target=\"#code1\"><img src=\"https://aman.ai/images/copy.png\" style=\"margin:0; border:none; padding:2px 0px; width:100%; height:18px; width:18px;\"></button></div><code id=\"code1\">&lt;action&gt;\n  {\n    \"type\": \"answer\",\n    \"when\": false,\n    \"content\": \"It will rain in Berlin tomorrow.\"\n  }\n&lt;/action&gt;\n</code></pre>\n<p>The <strong>when</strong> flag can be made explicit or implicit; explicit inclusion helps debugging and credit assignment.</p>\n<h4 id=\"episode-dynamics\">Episode Dynamics</h4>\n<ul>\n  <li>\n    <p>An episode proceeds as follows:</p>\n\n    <ol>\n      <li>LLM receives state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mn>0</mn></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-344\" style=\"width: 1.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.84em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-345\"><span class=\"msubsup\" id=\"MathJax-Span-346\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-347\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-348\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mn>0</mn></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-25\">s_0</script>.</li>\n      <li>LLM produces a structured action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mn>0</mn></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-349\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-350\"><span class=\"msubsup\" id=\"MathJax-Span-351\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-352\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-353\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mn>0</mn></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-26\">a_0</script> containing “when/which/how”.</li>\n      <li>Environment parses the action:\n        <ul>\n          <li>If <code class=\"language-plaintext highlighter-rouge\">ANSWER</code> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-354\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-355\"><span class=\"mo\" id=\"MathJax-Span-356\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-27\">\\rightarrow</script> episode ends.</li>\n          <li>If <code class=\"language-plaintext highlighter-rouge\">CALL</code> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-357\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-358\"><span class=\"mo\" id=\"MathJax-Span-359\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">\\rightarrow</script> execute tool, append output to context, produce next state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mn>1</mn></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-360\" style=\"width: 1.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.84em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-361\"><span class=\"msubsup\" id=\"MathJax-Span-362\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-363\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-364\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mn>1</mn></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-29\">s_1</script>.</li>\n        </ul>\n      </li>\n      <li>Reward is computed for “when”, “which”, “how” correctness and final answer quality.</li>\n      <li>Continue until ANSWER or max-step limit.</li>\n    </ol>\n  </li>\n  <li>\n    <p>This multi-step structure supports multi-hop reasoning as used in <a href=\"https://arxiv.org/abs/2210.03629\">ReAct</a> and aligns with task settings in <a href=\"https://arxiv.org/abs/2302.04761\">Toolformer</a>.</p>\n  </li>\n</ul>\n<p>An episode proceeds as follows:</p>\n<ol>\n      <li>LLM receives state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mn>0</mn></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-344\" style=\"width: 1.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.84em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-345\"><span class=\"msubsup\" id=\"MathJax-Span-346\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-347\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-348\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mn>0</mn></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-25\">s_0</script>.</li>\n      <li>LLM produces a structured action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mn>0</mn></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-349\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-350\"><span class=\"msubsup\" id=\"MathJax-Span-351\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-352\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-353\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mn>0</mn></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-26\">a_0</script> containing “when/which/how”.</li>\n      <li>Environment parses the action:\n        <ul>\n          <li>If <code class=\"language-plaintext highlighter-rouge\">ANSWER</code> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-354\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-355\"><span class=\"mo\" id=\"MathJax-Span-356\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-27\">\\rightarrow</script> episode ends.</li>\n          <li>If <code class=\"language-plaintext highlighter-rouge\">CALL</code> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-357\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-358\"><span class=\"mo\" id=\"MathJax-Span-359\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">\\rightarrow</script> execute tool, append output to context, produce next state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mn>1</mn></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-360\" style=\"width: 1.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.84em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-361\"><span class=\"msubsup\" id=\"MathJax-Span-362\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-363\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-364\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mn>1</mn></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-29\">s_1</script>.</li>\n        </ul>\n      </li>\n      <li>Reward is computed for “when”, “which”, “how” correctness and final answer quality.</li>\n      <li>Continue until ANSWER or max-step limit.</li>\n    </ol>\n<ul>\n          <li>If <code class=\"language-plaintext highlighter-rouge\">ANSWER</code> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-354\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-355\"><span class=\"mo\" id=\"MathJax-Span-356\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-27\">\\rightarrow</script> episode ends.</li>\n          <li>If <code class=\"language-plaintext highlighter-rouge\">CALL</code> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-357\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-358\"><span class=\"mo\" id=\"MathJax-Span-359\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">\\rightarrow</script> execute tool, append output to context, produce next state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mn>1</mn></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-360\" style=\"width: 1.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.84em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-361\"><span class=\"msubsup\" id=\"MathJax-Span-362\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-363\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-364\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mn>1</mn></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-29\">s_1</script>.</li>\n        </ul>\n<p>This multi-step structure supports multi-hop reasoning as used in <a href=\"https://arxiv.org/abs/2210.03629\">ReAct</a> and aligns with task settings in <a href=\"https://arxiv.org/abs/2302.04761\">Toolformer</a>.</p>\n<h4 id=\"handling-invalidmalformed-actions\">Handling Invalid/Malformed Actions</h4>\n<ul>\n  <li>\n    <p>Invalid “when/which/how” choices should not terminate the episode. Instead:</p>\n\n    <ul>\n      <li>Assign negative syntax or validity rewards</li>\n      <li>Return an error message to the model</li>\n      <li>Allow the agent to continue</li>\n    </ul>\n  </li>\n  <li>\n    <p>This is consistent with reward-shaping strategies from <a href=\"https://arxiv.org/abs/1706.03741\">Deep RL from Human Preferences</a> by Christiano et al. (2017).</p>\n  </li>\n</ul>\n<p>Invalid “when/which/how” choices should not terminate the episode. Instead:</p>\n<ul>\n      <li>Assign negative syntax or validity rewards</li>\n      <li>Return an error message to the model</li>\n      <li>Allow the agent to continue</li>\n    </ul>\n<p>This is consistent with reward-shaping strategies from <a href=\"https://arxiv.org/abs/1706.03741\">Deep RL from Human Preferences</a> by Christiano et al. (2017).</p>\n<h4 id=\"integrating-when--which--how-of-tool-calling-into-the-action-space\">Integrating “When / Which / How” of Tool-Calling Into the Action Space</h4>\n<ul>\n  <li>\n    <p>During RL optimization:</p>\n\n    <ul>\n      <li>The policy gradient is computed over the entire structured action</li>\n      <li>But reward is decomposed along the three decision axes</li>\n      <li>PPO or GRPO provides stable updates (as seen in ReTool and ToolRL)</li>\n    </ul>\n  </li>\n  <li>\n    <p>Thus, the policy learns simultaneously:</p>\n\n    <ul>\n      <li><strong>When</strong> a tool is appropriate</li>\n      <li><strong>Which</strong> tool should be chosen</li>\n      <li><strong>How</strong> to construct high-quality arguments</li>\n    </ul>\n  </li>\n  <li>\n    <p>This modularity also makes reward engineering substantially easier, as each component can be trained and debugged independently.</p>\n  </li>\n</ul>\n<p>During RL optimization:</p>\n<ul>\n      <li>The policy gradient is computed over the entire structured action</li>\n      <li>But reward is decomposed along the three decision axes</li>\n      <li>PPO or GRPO provides stable updates (as seen in ReTool and ToolRL)</li>\n    </ul>\n<p>Thus, the policy learns simultaneously:</p>\n<ul>\n      <li><strong>When</strong> a tool is appropriate</li>\n      <li><strong>Which</strong> tool should be chosen</li>\n      <li><strong>How</strong> to construct high-quality arguments</li>\n    </ul>\n<p>This modularity also makes reward engineering substantially easier, as each component can be trained and debugged independently.</p>",
    "contentMarkdown": "*   Tool-augmented LLMs must make three decisions during reasoning:\n    1.  whether a tool should be invoked (**when**),\n    2.  which tool is appropriate (**which**), and\n    3.  how to construct valid and effective arguments (**how**).\n*   This decomposition mirrors the behavioral factorization used in systems such as [Toolformer](https://arxiv.org/abs/2302.04761) by Schick et al. (2023) and the structured planning seen in [ReAct](https://arxiv.org/abs/2210.03629) by Yao et al. (2022). It also aligns with the policy design in recent RL approaches like [ReTool](https://arxiv.org/abs/2504.11536) by Feng et al. (2025) and [ToolRL](https://arxiv.org/abs/2504.13958) (2025), where tool selection is modeled as a multi-stage decision.\n\n1.  whether a tool should be invoked (**when**),\n2.  which tool is appropriate (**which**), and\n3.  how to construct valid and effective arguments (**how**).\n\n#### The MDP for “When / Which / How”\n\n*   We model tool use as an MDP:\n    \n    M\\=(S,A,P,R,γ)M\\=(S,A,P,R,γ)\n    \n    M = (S, A, P, R, \\\\gamma)\n    *   … with a factored action space that explicitly captures the “when/which/how” structure.\n\nWe model tool use as an MDP:\n\n*   … with a factored action space that explicitly captures the “when/which/how” structure.\n\n#### State (ststs\\_t)\n\n*   Each state encodes:\n    \n    *   the user’s query\n    *   ongoing reasoning steps\n    *   past tool calls and outputs\n    *   system instructions\n    *   optional episodic memory (short-term trajectories)\n*   The full state is serialized into a structured text prompt fed into the LLM, much like ReAct-style reasoning traces.\n    \n\nEach state encodes:\n\n*   the user’s query\n*   ongoing reasoning steps\n*   past tool calls and outputs\n*   system instructions\n*   optional episodic memory (short-term trajectories)\n\nThe full state is serialized into a structured text prompt fed into the LLM, much like ReAct-style reasoning traces.\n\n#### Structured, Factored Action Space\n\n*   The action space is decomposed into:\n    \n    1.  **When** to call a tool\n    2.  **Which** tool to call (conditional on calling)\n    3.  **How** to construct arguments (conditional on chosen tool)\n*   This yields two disjoint high-level action types:\n    \n\nThe action space is decomposed into:\n\n1.  **When** to call a tool\n2.  **Which** tool to call (conditional on calling)\n3.  **How** to construct arguments (conditional on chosen tool)\n\nThis yields two disjoint high-level action types:\n\n#### Action Type 1: `ANSWER(final_text)`\n\n*   Used when the model decides _no more tool calls are needed_.\n\n#### Action Type 2: `CALL(tool_name, Args_json)`\n\n*   Further factored into:\n    \n    *   **When**: deciding to call a tool rather than answer\n    *   **Which**: selecting a tool from the available toolset\n    *   **How**: generating a valid argument JSON for that tool\n*   This factorization improves learning by ensuring that RL gradients reflect distinct sub-skills within tool usage.\n    \n\nFurther factored into:\n\n*   **When**: deciding to call a tool rather than answer\n*   **Which**: selecting a tool from the available toolset\n*   **How**: generating a valid argument JSON for that tool\n\nThis factorization improves learning by ensuring that RL gradients reflect distinct sub-skills within tool usage.\n\n#### Structured Action Encoding\n\n*   To stabilize RL training, each action is formatted in strict machine-readable JSON, following the practice in ReTool and Toolformer:\n    \n    *   Example: **CALL action**\n    \n    ![](https://aman.ai/images/copy.png)\n    \n    `<action>   {     \"type\": \"call\",     \"when\": true,     \"which\": \"weather_api\",     \"how\": { \"city\": \"Berlin\", \"date\": \"2025-05-09\" }   } </action>`\n    \n    *   Example: **ANSWER action**\n    \n    ![](https://aman.ai/images/copy.png)\n    \n    `<action>   {     \"type\": \"answer\",     \"when\": false,     \"content\": \"It will rain in Berlin tomorrow.\"   } </action>`\n    \n*   The **when** flag can be made explicit or implicit; explicit inclusion helps debugging and credit assignment.\n    \n\nTo stabilize RL training, each action is formatted in strict machine-readable JSON, following the practice in ReTool and Toolformer:\n\n*   Example: **CALL action**\n\n![](https://aman.ai/images/copy.png)\n\n`<action>   {     \"type\": \"call\",     \"when\": true,     \"which\": \"weather_api\",     \"how\": { \"city\": \"Berlin\", \"date\": \"2025-05-09\" }   } </action>`\n\n*   Example: **ANSWER action**\n\n![](https://aman.ai/images/copy.png)\n\n`<action>   {     \"type\": \"answer\",     \"when\": false,     \"content\": \"It will rain in Berlin tomorrow.\"   } </action>`\n\nThe **when** flag can be made explicit or implicit; explicit inclusion helps debugging and credit assignment.\n\n#### Episode Dynamics\n\n*   An episode proceeds as follows:\n    \n    1.  LLM receives state s0s0s\\_0.\n    2.  LLM produces a structured action a0a0a\\_0 containing “when/which/how”.\n    3.  Environment parses the action:\n        *   If `ANSWER` →→\\\\rightarrow episode ends.\n        *   If `CALL` →→\\\\rightarrow execute tool, append output to context, produce next state s1s1s\\_1.\n    4.  Reward is computed for “when”, “which”, “how” correctness and final answer quality.\n    5.  Continue until ANSWER or max-step limit.\n*   This multi-step structure supports multi-hop reasoning as used in [ReAct](https://arxiv.org/abs/2210.03629) and aligns with task settings in [Toolformer](https://arxiv.org/abs/2302.04761).\n    \n\nAn episode proceeds as follows:\n\n1.  LLM receives state s0s0s\\_0.\n2.  LLM produces a structured action a0a0a\\_0 containing “when/which/how”.\n3.  Environment parses the action:\n    *   If `ANSWER` →→\\\\rightarrow episode ends.\n    *   If `CALL` →→\\\\rightarrow execute tool, append output to context, produce next state s1s1s\\_1.\n4.  Reward is computed for “when”, “which”, “how” correctness and final answer quality.\n5.  Continue until ANSWER or max-step limit.\n\n*   If `ANSWER` →→\\\\rightarrow episode ends.\n*   If `CALL` →→\\\\rightarrow execute tool, append output to context, produce next state s1s1s\\_1.\n\nThis multi-step structure supports multi-hop reasoning as used in [ReAct](https://arxiv.org/abs/2210.03629) and aligns with task settings in [Toolformer](https://arxiv.org/abs/2302.04761).\n\n#### Handling Invalid/Malformed Actions\n\n*   Invalid “when/which/how” choices should not terminate the episode. Instead:\n    \n    *   Assign negative syntax or validity rewards\n    *   Return an error message to the model\n    *   Allow the agent to continue\n*   This is consistent with reward-shaping strategies from [Deep RL from Human Preferences](https://arxiv.org/abs/1706.03741) by Christiano et al. (2017).\n    \n\nInvalid “when/which/how” choices should not terminate the episode. Instead:\n\n*   Assign negative syntax or validity rewards\n*   Return an error message to the model\n*   Allow the agent to continue\n\nThis is consistent with reward-shaping strategies from [Deep RL from Human Preferences](https://arxiv.org/abs/1706.03741) by Christiano et al. (2017).\n\n#### Integrating “When / Which / How” of Tool-Calling Into the Action Space\n\n*   During RL optimization:\n    \n    *   The policy gradient is computed over the entire structured action\n    *   But reward is decomposed along the three decision axes\n    *   PPO or GRPO provides stable updates (as seen in ReTool and ToolRL)\n*   Thus, the policy learns simultaneously:\n    \n    *   **When** a tool is appropriate\n    *   **Which** tool should be chosen\n    *   **How** to construct high-quality arguments\n*   This modularity also makes reward engineering substantially easier, as each component can be trained and debugged independently.\n    \n\nDuring RL optimization:\n\n*   The policy gradient is computed over the entire structured action\n*   But reward is decomposed along the three decision axes\n*   PPO or GRPO provides stable updates (as seen in ReTool and ToolRL)\n\nThus, the policy learns simultaneously:\n\n*   **When** a tool is appropriate\n*   **Which** tool should be chosen\n*   **How** to construct high-quality arguments\n\nThis modularity also makes reward engineering substantially easier, as each component can be trained and debugged independently.",
    "order": 4,
    "orderInChapter": 3,
    "difficulty": 3,
    "estimatedMinutes": 6,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "optimization"
    ],
    "metadata": {
      "hasCode": true,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 1085,
      "contentLength": 37225
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#environment,-mdp-formulation,-and-action-space",
    "scrapedAt": "2025-12-28T11:47:36.150Z"
  },
  {
    "id": "ai-agentic-RL-annotation-sources-for-reward-components-when-whic-5",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Background: Teaching Agents Tool-Calling with RL",
    "title": "Annotation Sources for Reward Components (“When”, “Which”, and “How”)",
    "subtitle": "Background: Teaching Agents Tool-Calling with RL",
    "contentHtml": "<ul>\n  <li>\n    <p>This section explains how to generate supervision signals for <em>all</em> reward components in the RL system, reflecting the decomposition of tool-use behavior into:</p>\n\n    <ul>\n      <li><strong>When</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-365\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-366\"><span class=\"mo\" id=\"MathJax-Span-367\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-30\">\\rightarrow</script> deciding <em>if and when</em> a tool should be used</li>\n      <li><strong>Which</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-368\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-369\"><span class=\"mo\" id=\"MathJax-Span-370\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-31\">\\rightarrow</script> selecting <em>which</em> tool to call</li>\n      <li><strong>How</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-371\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-372\"><span class=\"mo\" id=\"MathJax-Span-373\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-32\">\\rightarrow</script> constructing <em>how</em> to call it via correctly formed arguments</li>\n    </ul>\n  </li>\n  <li>\n    <p>To support this, the reward is decomposed into the following components:</p>\n\n    <ol>\n      <li><strong>Call (when-to-call)</strong>: whether a tool should be called.</li>\n      <li><strong>Tool-selection</strong>: whether the correct tool was chosen (which).</li>\n      <li><strong>Tool-syntax correctness</strong>: whether the tool call was formatted properly.</li>\n      <li><strong>Tool-execution correctness</strong>: whether the tool executed successfully.</li>\n      <li><strong>Argument quality</strong>: whether the arguments were appropriate (how).</li>\n      <li><strong>Final task success</strong>: whether the entire episode produced the right answer.</li>\n      <li><strong>Preference-based / generative evaluation</strong>: higher-level judgment (LLM-as-a-Judge).</li>\n    </ol>\n  </li>\n  <li>\n    <p>Each reward dimension can be supervised using a mixture of:</p>\n    <ul>\n      <li>Rule-based heuristics</li>\n      <li>Discriminative reward models trained on human data</li>\n      <li>Generative reward models (LLM-as-a-Judge as in <a href=\"https://arxiv.org/abs/2501.12948\">DeepSeek-R1</a> by Guo et al. (2025)).</li>\n    </ul>\n  </li>\n</ul>\n<p>This section explains how to generate supervision signals for <em>all</em> reward components in the RL system, reflecting the decomposition of tool-use behavior into:</p>\n<ul>\n      <li><strong>When</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-365\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-366\"><span class=\"mo\" id=\"MathJax-Span-367\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-30\">\\rightarrow</script> deciding <em>if and when</em> a tool should be used</li>\n      <li><strong>Which</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-368\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-369\"><span class=\"mo\" id=\"MathJax-Span-370\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-31\">\\rightarrow</script> selecting <em>which</em> tool to call</li>\n      <li><strong>How</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-371\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-372\"><span class=\"mo\" id=\"MathJax-Span-373\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-32\">\\rightarrow</script> constructing <em>how</em> to call it via correctly formed arguments</li>\n    </ul>\n<p>To support this, the reward is decomposed into the following components:</p>\n<ol>\n      <li><strong>Call (when-to-call)</strong>: whether a tool should be called.</li>\n      <li><strong>Tool-selection</strong>: whether the correct tool was chosen (which).</li>\n      <li><strong>Tool-syntax correctness</strong>: whether the tool call was formatted properly.</li>\n      <li><strong>Tool-execution correctness</strong>: whether the tool executed successfully.</li>\n      <li><strong>Argument quality</strong>: whether the arguments were appropriate (how).</li>\n      <li><strong>Final task success</strong>: whether the entire episode produced the right answer.</li>\n      <li><strong>Preference-based / generative evaluation</strong>: higher-level judgment (LLM-as-a-Judge).</li>\n    </ol>\n<p>Each reward dimension can be supervised using a mixture of:</p>\n<ul>\n      <li>Rule-based heuristics</li>\n      <li>Discriminative reward models trained on human data</li>\n      <li>Generative reward models (LLM-as-a-Judge as in <a href=\"https://arxiv.org/abs/2501.12948\">DeepSeek-R1</a> by Guo et al. (2025)).</li>\n    </ul>\n<h4 id=\"reward-component-tool-call-deciding-when-a-tool-should-be-invoked\">Reward Component: Tool Call (Deciding “When” a Tool Should be Invoked)</h4>\n<ul>\n  <li>This component supports the <strong>when</strong> dimension: Is a tool call appropriate/necessary at this point in the reasoning process?</li>\n</ul>\n<h5 id=\"rule-based-supervision\">Rule-based Supervision</h5>\n<ul>\n  <li>\n    <p>Use deterministic rules and intent detectors inspired by works like <a href=\"https://arxiv.org/abs/2302.04761\">Toolformer</a> by Schick et al. (2023):</p>\n\n    <ul>\n      <li>Weather questions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-374\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-375\"><span class=\"mo\" id=\"MathJax-Span-376\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-33\">\\rightarrow</script> require weather API</li>\n      <li>Math expressions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-34-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-377\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-378\"><span class=\"mo\" id=\"MathJax-Span-379\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-34\">\\rightarrow</script> require calculator</li>\n      <li>“Define X / explain Y” <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-35-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-380\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-381\"><span class=\"mo\" id=\"MathJax-Span-382\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-35\">\\rightarrow</script> no tool</li>\n      <li>Factual queries <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-36-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-383\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-384\"><span class=\"mo\" id=\"MathJax-Span-385\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-36\">\\rightarrow</script> search tool</li>\n      <li>Actionable tasks (e.g., booking) <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-37-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-386\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-387\"><span class=\"mo\" id=\"MathJax-Span-388\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-37\">\\rightarrow</script> appropriate domain tool</li>\n    </ul>\n  </li>\n  <li>\n    <p>This produces binary or graded labels <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>call</mtext></mrow></msub><mo>&amp;#x2208;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-389\" style=\"width: 5.107em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.221em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1004.12em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-390\"><span class=\"msubsup\" id=\"MathJax-Span-391\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-392\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-393\"><span class=\"mrow\" id=\"MathJax-Span-394\"><span class=\"mtext\" id=\"MathJax-Span-395\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">call</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-396\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"texatom\" id=\"MathJax-Span-397\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-398\"><span class=\"mn\" id=\"MathJax-Span-399\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-400\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-401\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>call</mtext></mrow></msub><mo>∈</mo><mrow class=\"MJX-TeXAtom-ORD\"><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-38\">y_{\\text{call}} \\in {0,1}</script>.</p>\n  </li>\n</ul>\n<p>Use deterministic rules and intent detectors inspired by works like <a href=\"https://arxiv.org/abs/2302.04761\">Toolformer</a> by Schick et al. (2023):</p>\n<ul>\n      <li>Weather questions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-374\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-375\"><span class=\"mo\" id=\"MathJax-Span-376\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-33\">\\rightarrow</script> require weather API</li>\n      <li>Math expressions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-34-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-377\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-378\"><span class=\"mo\" id=\"MathJax-Span-379\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-34\">\\rightarrow</script> require calculator</li>\n      <li>“Define X / explain Y” <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-35-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-380\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-381\"><span class=\"mo\" id=\"MathJax-Span-382\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-35\">\\rightarrow</script> no tool</li>\n      <li>Factual queries <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-36-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-383\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-384\"><span class=\"mo\" id=\"MathJax-Span-385\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-36\">\\rightarrow</script> search tool</li>\n      <li>Actionable tasks (e.g., booking) <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-37-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-386\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-387\"><span class=\"mo\" id=\"MathJax-Span-388\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-37\">\\rightarrow</script> appropriate domain tool</li>\n    </ul>\n<p>This produces binary or graded labels <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>call</mtext></mrow></msub><mo>&amp;#x2208;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-389\" style=\"width: 5.107em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.221em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1004.12em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-390\"><span class=\"msubsup\" id=\"MathJax-Span-391\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-392\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-393\"><span class=\"mrow\" id=\"MathJax-Span-394\"><span class=\"mtext\" id=\"MathJax-Span-395\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">call</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-396\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"texatom\" id=\"MathJax-Span-397\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-398\"><span class=\"mn\" id=\"MathJax-Span-399\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-400\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-401\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>call</mtext></mrow></msub><mo>∈</mo><mrow class=\"MJX-TeXAtom-ORD\"><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-38\">y_{\\text{call}} \\in {0,1}</script>.</p>\n<h5 id=\"discriminative-reward-model\">Discriminative Reward Model</h5>\n<ul>\n  <li>Train a classifier <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-39-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03D5;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-402\" style=\"width: 2.398em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.93em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-403\"><span class=\"msubsup\" id=\"MathJax-Span-404\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-405\" style=\"font-family: STIXGeneral-Italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-406\"><span class=\"mrow\" id=\"MathJax-Span-407\"><span class=\"mi\" id=\"MathJax-Span-408\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-409\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-410\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-411\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>f</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>ϕ</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-39\">f_{\\phi}(x)</script> predicting <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>call</mtext></mrow></msub><mo>=</mo><mn>1</mn><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-412\" style=\"width: 7.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1005.84em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-413\"><span class=\"mi\" id=\"MathJax-Span-414\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-415\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-416\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-417\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-418\"><span class=\"mrow\" id=\"MathJax-Span-419\"><span class=\"mtext\" id=\"MathJax-Span-420\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">call</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-421\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-422\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">1</span><span class=\"mo\" id=\"MathJax-Span-423\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-424\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-425\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>call</mtext></mrow></msub><mo>=</mo><mn>1</mn><mo>∣</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-40\">P(y_{\\text{call}} = 1 \\mid x)</script> using human-labeled examples indicating if/how strongly the query requires tool use.</li>\n  <li>This mirrors methodology from RLHF as in <a href=\"https://arxiv.org/abs/2203.02155\">InstructGPT</a> by Ouyang et al. (2022).</li>\n</ul>\n<h5 id=\"generative-reward-model-llm-as-a-judge\">Generative Reward Model (LLM-as-a-Judge)</h5>\n<ul>\n  <li>\n    <p>Use a judge model (e.g., DeepSeek-V3 per <a href=\"https://arxiv.org/abs/2501.12948\">DeepSeek-R1</a>):</p>\n  </li>\n  <li>\n    <p>Prompt: “Given this user query and available tools, should the agent call a tool at this stage? Provide yes/no and reasoning.”</p>\n  </li>\n  <li>\n    <p>Extract a scalar reward from the generative verdict.</p>\n  </li>\n  <li>\n    <p>This can capture nuanced timing requirements over multiple steps.</p>\n  </li>\n</ul>\n<p>Use a judge model (e.g., DeepSeek-V3 per <a href=\"https://arxiv.org/abs/2501.12948\">DeepSeek-R1</a>):</p>\n<p>Prompt: “Given this user query and available tools, should the agent call a tool at this stage? Provide yes/no and reasoning.”</p>\n<p>Extract a scalar reward from the generative verdict.</p>\n<p>This can capture nuanced timing requirements over multiple steps.</p>\n<h4 id=\"reward-component-tool-selection-choosing-which-tool\">Reward Component: Tool Selection (Choosing “Which” Tool)</h4>\n<ul>\n  <li>This component supports the <strong>which</strong> dimension: Given that a tool is to be called, was the <em>correct</em> tool chosen?</li>\n</ul>\n<h5 id=\"rule-based-supervision-1\">Rule-based Supervision</h5>\n<ul>\n  <li>\n    <p>If rules map tasks to a specific tool or tool category, then:</p>\n\n    <ul>\n      <li>If the predicted tool matches the rule <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-426\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-427\"><span class=\"mo\" id=\"MathJax-Span-428\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">\\rightarrow</script> +reward</li>\n      <li>Otherwise <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-429\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-430\"><span class=\"mo\" id=\"MathJax-Span-431\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">\\rightarrow</script> −reward</li>\n    </ul>\n  </li>\n  <li>\n    <p>This is similar to mapping tool types in <a href=\"https://arxiv.org/abs/2210.03629\">ReAct</a> by Yao et al. (2022).</p>\n  </li>\n</ul>\n<p>If rules map tasks to a specific tool or tool category, then:</p>\n<ul>\n      <li>If the predicted tool matches the rule <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-426\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-427\"><span class=\"mo\" id=\"MathJax-Span-428\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">\\rightarrow</script> +reward</li>\n      <li>Otherwise <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-429\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-430\"><span class=\"mo\" id=\"MathJax-Span-431\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">\\rightarrow</script> −reward</li>\n    </ul>\n<p>This is similar to mapping tool types in <a href=\"https://arxiv.org/abs/2210.03629\">ReAct</a> by Yao et al. (2022).</p>\n<h5 id=\"discriminative-reward-model-1\">Discriminative Reward Model</h5>\n<ul>\n  <li>Train a classifier <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-432\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.44em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.39em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-433\"><span class=\"msubsup\" id=\"MathJax-Span-434\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-435\" style=\"font-family: STIXGeneral-Italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-436\"><span class=\"mrow\" id=\"MathJax-Span-437\"><span class=\"mi\" id=\"MathJax-Span-438\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-439\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-440\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-441\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-442\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-443\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-444\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-445\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-446\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-447\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>f</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>ψ</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-43\">f_{\\psi}(s_t, a_t)</script> that judges whether the selected tool matches human expectations for that state.</li>\n</ul>\n<h5 id=\"generative-reward-model\">Generative Reward Model</h5>\n<ul>\n  <li>\n    <p>Ask a judge LLM: “Was TOOL_X the best tool choice for this request at this step?”</p>\n  </li>\n  <li>\n    <p>Score the answer and normalize.</p>\n  </li>\n</ul>\n<p>Ask a judge LLM: “Was TOOL_X the best tool choice for this request at this step?”</p>\n<p>Score the answer and normalize.</p>\n<h4 id=\"reward-component-tool-syntax-correctness\">Reward Component: <strong>Tool-Syntax Correctness</strong></h4>\n<ul>\n  <li>\n    <p>Supports the <strong>how</strong> dimension partially, focusing on <em>format</em>:</p>\n\n    <ul>\n      <li>JSON validity</li>\n      <li>Required argument fields</li>\n      <li>Correct schema shape</li>\n    </ul>\n  </li>\n</ul>\n<p>Supports the <strong>how</strong> dimension partially, focusing on <em>format</em>:</p>\n<ul>\n      <li>JSON validity</li>\n      <li>Required argument fields</li>\n      <li>Correct schema shape</li>\n    </ul>\n<h5 id=\"rule-based\">Rule-based</h5>\n<ul>\n  <li>JSON parse success</li>\n  <li>Schema validation</li>\n  <li>\n    <p>Argument-type validation</p>\n  </li>\n  <li>\n    <p><strong>Reward:</strong></p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>syntax</mtext></mrow></msubsup><mo>=</mo><mrow><mo>{</mo><mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;><mtr><mtd><mo>+</mo><mn>1</mn></mtd><mtd><mtext>if JSON + schema valid</mtext><mtext>&amp;#xA0;</mtext><mo>&amp;#x2212;</mo><mn>1</mn></mtd><mtd><mtext>otherwise</mtext></mtd></mtr></mtable><mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;></mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-448\" style=\"width: 28.128em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 23.44em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1023.44em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-449\"><span class=\"msubsup\" id=\"MathJax-Span-450\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-451\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1001.93em, 4.326em, -999.997em); top: -4.529em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-452\"><span class=\"mrow\" id=\"MathJax-Span-453\"><span class=\"mtext\" id=\"MathJax-Span-454\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">syntax</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-455\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-456\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mrow\" id=\"MathJax-Span-457\" style=\"padding-left: 0.315em;\"><span class=\"mo\" id=\"MathJax-Span-458\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">{</span></span><span class=\"mtable\" id=\"MathJax-Span-459\" style=\"padding-right: 0.159em; padding-left: 0.159em;\"><span style=\"display: inline-block; position: relative; width: 18.961em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.232em, 1001.1em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1001.1em, 4.221em, -999.997em); top: -3.956em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-460\"><span class=\"mrow\" id=\"MathJax-Span-461\"><span class=\"mo\" id=\"MathJax-Span-462\" style=\"font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-463\" style=\"font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.232em, 1011.51em, 4.378em, -999.997em); top: -4.008em; left: 2.294em;\"><span style=\"display: inline-block; position: relative; width: 11.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1011.51em, 4.326em, -999.997em); top: -3.956em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-464\"><span class=\"mrow\" id=\"MathJax-Span-465\"><span class=\"mtext\" id=\"MathJax-Span-466\" style=\"font-family: STIXGeneral-Regular;\">if JSON + schema valid</span><span class=\"mtext\" id=\"MathJax-Span-467\" style=\"font-family: STIXGeneral-Regular;\">&nbsp;</span><span class=\"mo\" id=\"MathJax-Span-468\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mn\" id=\"MathJax-Span-469\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.232em, 1003.86em, 4.221em, -999.997em); top: -4.008em; left: 15.055em;\"><span style=\"display: inline-block; position: relative; width: 3.909em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.86em, 4.169em, -999.997em); top: -3.956em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-470\"><span class=\"mrow\" id=\"MathJax-Span-471\"><span class=\"mtext\" id=\"MathJax-Span-472\" style=\"font-family: STIXGeneral-Regular;\">otherwise</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-473\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>syntax</mtext></mrow></msubsup><mo>=</mo><mrow><mo>{</mo><mtable columnalign=\"left left\" rowspacing=\".2em\" columnspacing=\"1em\" displaystyle=\"false\"><mtr><mtd><mo>+</mo><mn>1</mn></mtd><mtd><mtext>if JSON + schema valid</mtext><mtext>&nbsp;</mtext><mo>−</mo><mn>1</mn></mtd><mtd><mtext>otherwise</mtext></mtd></mtr></mtable><mo fence=\"true\" stretchy=\"true\" symmetric=\"true\"></mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-44\">r_t^{\\text{syntax}} =\n\\begin{cases}\n+1 & \\text{if JSON + schema valid} \\\n-1 & \\text{otherwise}\n\\end{cases}</script>\n  </li>\n  <li>This echoes structured action enforcement in <a href=\"https://arxiv.org/abs/2210.03629\">ReAct</a>.</li>\n</ul>\n<p>Argument-type validation</p>\n<p><strong>Reward:</strong></p>\n<h5 id=\"discriminative-reward-model-2\">Discriminative Reward Model</h5>\n<ul>\n  <li>Classify correct vs. incorrect tool-call formats.</li>\n</ul>\n<h5 id=\"generative-reward-model-1\">Generative Reward Model</h5>\n<ul>\n  <li>Ask an LLM judge whether the formatting is correct (1–10), normalize to reward.</li>\n</ul>\n<h4 id=\"reward-component-tool-execution-correctness\">Reward Component: <strong>Tool-Execution Correctness</strong></h4>\n<ul>\n  <li>Did the tool run without error?</li>\n</ul>\n<h5 id=\"rule-based-1\">Rule-based</h5>\n<ul>\n  <li>HTTP 200 or success flag <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-474\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-475\"><span class=\"mo\" id=\"MathJax-Span-476\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-45\">\\rightarrow</script> +reward</li>\n  <li>Errors / exceptions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-46-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-477\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-478\"><span class=\"mo\" id=\"MathJax-Span-479\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-46\">\\rightarrow</script> −reward</li>\n</ul>\n<h5 id=\"discriminative-reward-model-3\">Discriminative Reward Model</h5>\n<ul>\n  <li>Trained to predict execution feasibility or correctness.</li>\n</ul>\n<h5 id=\"generative-reward-model-2\">Generative Reward Model</h5>\n<ul>\n  <li>Judge evaluates based on logs and outputs.</li>\n</ul>\n<h4 id=\"reward-component-argument-quality-deciding-how-to-call-a-tool\">Reward Component: Argument Quality (Deciding “How” to Call a Tool)</h4>\n<ul>\n  <li>This is the core of the <strong>how</strong> dimension: constructing appropriate arguments.</li>\n</ul>\n<h5 id=\"rule-based-2\">Rule-based</h5>\n<ul>\n  <li>For numeric or structured problems:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-47-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>args</mtext></mrow></msubsup><mo>=</mo><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>pred</mtext></mrow></msub><mo>&amp;#x2212;</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>gold</mtext></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-480\" style=\"width: 10.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.857em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1008.75em, 2.971em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-481\"><span class=\"msubsup\" id=\"MathJax-Span-482\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-483\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1001.25em, 4.326em, -999.997em); top: -4.529em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-484\"><span class=\"mrow\" id=\"MathJax-Span-485\"><span class=\"mtext\" id=\"MathJax-Span-486\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">args</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-487\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-488\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-489\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">−</span><span class=\"texatom\" id=\"MathJax-Span-490\"><span class=\"mrow\" id=\"MathJax-Span-491\"><span class=\"mo\" id=\"MathJax-Span-492\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-493\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-494\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-495\"><span class=\"mrow\" id=\"MathJax-Span-496\"><span class=\"mtext\" id=\"MathJax-Span-497\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">pred</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-498\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-499\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-500\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-501\"><span class=\"mrow\" id=\"MathJax-Span-502\"><span class=\"mtext\" id=\"MathJax-Span-503\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">gold</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-504\"><span class=\"mrow\" id=\"MathJax-Span-505\"><span class=\"mo\" id=\"MathJax-Span-506\" style=\"font-family: STIXVariants;\">|</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>args</mtext></mrow></msubsup><mo>=</mo><mo>−</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>pred</mtext></mrow></msub><mo>−</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>gold</mtext></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow></math></span></span></div>\n<ul>\n  <li>For strings, use embedding similarity or fuzzy match.</li>\n</ul>\n<h5 id=\"discriminative-reward-model-4\">Discriminative Reward Model</h5>\n<ul>\n  <li>Trained to identify argument errors (bad city name, missing date, etc.).</li>\n</ul>\n<h5 id=\"generative-reward-model-3\">Generative Reward Model</h5>\n<ul>\n  <li>LLM-as-a-Judge evaluates argument plausibility/fit to the query.</li>\n</ul>\n<h4 id=\"reward-component-final-task-success\">Reward Component: <strong>Final Task Success</strong></h4>\n<ul>\n  <li>Whether the overall trajectory produced a correct answer.</li>\n</ul>\n<h5 id=\"rule-based-3\">Rule-based</h5>\n<ul>\n  <li>Unit test pass</li>\n  <li>Exact match</li>\n  <li>Tolerance-based numeric match</li>\n</ul>\n<h5 id=\"discriminative-reward-model-5\">Discriminative Reward Model</h5>\n<ul>\n  <li>Using preference modeling as in <a href=\"https://arxiv.org/abs/1706.03741\">Deep RL from Human Preferences</a> by Christiano et al. (2017), train:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-48-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>RM</mtext></mrow></msub><mo>=</mo><mo>&amp;#x2212;</mo><mi>log</mi><mo>&amp;#x2061;</mo><mfrac><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C4;</mi><mi>A</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mrow><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C4;</mi><mi>A</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>+</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C4;</mi><mi>B</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></mrow></mfrac><mo>.</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-507\" style=\"width: 13.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.523em, 1011.46em, 3.128em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-508\"><span class=\"msubsup\" id=\"MathJax-Span-509\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-510\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-511\"><span class=\"mrow\" id=\"MathJax-Span-512\"><span class=\"mtext\" id=\"MathJax-Span-513\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">RM</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-514\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-515\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">−</span><span class=\"mi\" id=\"MathJax-Span-516\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-517\"></span><span class=\"mfrac\" id=\"MathJax-Span-518\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 5.888em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.023em, 1002.29em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.143em;\"><span class=\"msubsup\" id=\"MathJax-Span-519\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-520\" style=\"font-family: STIXGeneral-Italic;\">e</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-521\"><span class=\"mrow\" id=\"MathJax-Span-522\"><span class=\"msubsup\" id=\"MathJax-Span-523\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-524\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-525\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-526\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-527\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-528\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-529\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-530\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.076em, 1005.78em, 4.221em, -999.997em); top: -3.227em; left: 50%; margin-left: -2.862em;\"><span class=\"mrow\" id=\"MathJax-Span-531\"><span class=\"msubsup\" id=\"MathJax-Span-532\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-533\" style=\"font-family: STIXGeneral-Italic;\">e</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-534\"><span class=\"mrow\" id=\"MathJax-Span-535\"><span class=\"msubsup\" id=\"MathJax-Span-536\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-537\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-538\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-539\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-540\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-541\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-542\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-543\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-544\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-545\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-546\" style=\"font-family: STIXGeneral-Italic;\">e</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-547\"><span class=\"mrow\" id=\"MathJax-Span-548\"><span class=\"msubsup\" id=\"MathJax-Span-549\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-550\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-551\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-552\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-553\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-554\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-555\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">B</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-556\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1005.89em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.888em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-557\" style=\"font-family: STIXGeneral-Regular;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.997em; border-left: 0px solid; width: 0px; height: 2.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>RM</mtext></mrow></msub><mo>=</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mfrac><msup><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>r</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>τ</mi><mi>A</mi></msub><mo stretchy=\"false\">)</mo></mrow></msup><mrow><msup><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>r</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>τ</mi><mi>A</mi></msub><mo stretchy=\"false\">)</mo></mrow></msup><mo>+</mo><msup><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>r</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>τ</mi><mi>B</mi></msub><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mfrac><mo>.</mo></math></span></span></div>\n<h5 id=\"generative-reward-model-4\">Generative Reward Model</h5>\n<ul>\n  <li>Judge LLM compares model prediction with ground truth (as in <a href=\"https://arxiv.org/abs/2501.12948\">DeepSeek-R1</a>).</li>\n</ul>\n<h4 id=\"merged-preference-based-rewards-for-call-which-and-how\">Merged Preference-Based Rewards (For <code class=\"language-plaintext Highlighter-rouge\">CALL</code>, “Which”, and “How”)</h4>\n<ul>\n  <li>\n    <p>You can construct pairs of trajectories differing in:</p>\n\n    <ul>\n      <li>timing of tool calls (call),</li>\n      <li>choice of tool (which), and</li>\n      <li>argument construction (how)</li>\n    </ul>\n  </li>\n  <li>\n    <p>Let the judge or human annotator choose the better one.</p>\n  </li>\n  <li>\n    <p>Train a preference RM to provide combined signals.</p>\n  </li>\n</ul>\n<p>You can construct pairs of trajectories differing in:</p>\n<ul>\n      <li>timing of tool calls (call),</li>\n      <li>choice of tool (which), and</li>\n      <li>argument construction (how)</li>\n    </ul>\n<p>Let the judge or human annotator choose the better one.</p>\n<p>Train a preference RM to provide combined signals.</p>\n<h4 id=\"unified-reward-formulation\">Unified Reward Formulation</h4>\n<ul>\n  <li>\n    <p>All reward signals—process and outcome—are merged into one scalar:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-49-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><menclose notation=&quot;box&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>R</mi><mo>=</mo><munder><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><munder><mrow><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>call</mtext></mrow></msub><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>call</mtext></mrow></msup></mrow><mo>&amp;#x23DF;</mo></munder></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>when</mtext></mrow></munder><mo>+</mo><munder><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><munder><mrow><mo>(</mo><mrow><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>tool</mtext></mrow></msub><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>tool</mtext></mrow></msup></mrow><mo>)</mo></mrow><mo>&amp;#x23DF;</mo></munder></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>which</mtext></mrow></munder><mo>+</mo><munder><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><munder><mrow><mo>(</mo><mrow><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>syntax</mtext></mrow></msub><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>syntax</mtext></mrow></msup><mo>+</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>exec</mtext></mrow></msub><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>exec</mtext></mrow></msup><mo>+</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>args</mtext></mrow></msub><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>args</mtext></mrow></msup></mrow><mo>)</mo></mrow><mo>&amp;#x23DF;</mo></munder></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>how</mtext></mrow></munder><mo>+</mo><munder><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><munder><mrow><mo>(</mo><mrow><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>task</mtext></mrow></msub><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>task</mtext></mrow></msup><mo>+</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>pref</mtext></mrow></msub><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>pref</mtext></mrow></msup></mrow><mo>)</mo></mrow><mo>&amp;#x23DF;</mo></munder></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>outcome-level</mtext></mrow></munder></mrow></mstyle></mrow></menclose></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-558\" style=\"width: 34.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 28.596em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.784em, 1028.6em, 8.076em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-559\"><span class=\"menclose\" id=\"MathJax-Span-560\"><span style=\"display: inline-block; position: relative; width: 28.596em; height: 0px;\"><span id=\"MathJax-frame-560\" style=\"border: 0.107em solid; display: inline-block; overflow: hidden; width: 28.44em; height: 6.826em; vertical-align: -0.102em; position: absolute; top: -1.195em; left: 0em;\"></span><span style=\"position: absolute; clip: rect(6.357em, 1028.02em, 13.076em, -999.997em); top: -7.393em; left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-561\"><span class=\"texatom\" id=\"MathJax-Span-562\"><span class=\"mrow\" id=\"MathJax-Span-563\"><span class=\"mstyle\" id=\"MathJax-Span-564\"><span class=\"mrow\" id=\"MathJax-Span-565\"><span class=\"texatom\" id=\"MathJax-Span-566\"><span class=\"mrow\" id=\"MathJax-Span-567\"><span style=\"display: inline-block; position: relative; width: 28.023em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.971em, 1028.02em, 6.253em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-568\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-569\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-570\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.971em, 1003.34em, 5.211em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-571\"><span class=\"mrow\" id=\"MathJax-Span-572\"><span class=\"munderover\" id=\"MathJax-Span-573\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.971em, 1003.34em, 4.326em, -999.997em); top: -4.008em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-574\"><span class=\"msubsup\" id=\"MathJax-Span-575\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-576\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-577\"><span class=\"mrow\" id=\"MathJax-Span-578\"><span class=\"mtext\" id=\"MathJax-Span-579\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">call</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-580\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-581\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-582\"><span class=\"mrow\" id=\"MathJax-Span-583\"><span class=\"mtext\" id=\"MathJax-Span-584\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">call</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.701em, 1003.34em, 4.69em, -999.997em); top: -3.487em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-585\" style=\"\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px;\"><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 0.003em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 2.398em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 0.732em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.51em, 4.273em, -999.997em); top: -2.289em; left: 0.888em;\"><span class=\"texatom\" id=\"MathJax-Span-586\"><span class=\"mrow\" id=\"MathJax-Span-587\"><span class=\"mtext\" id=\"MathJax-Span-588\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">when</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-589\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"munderover\" id=\"MathJax-Span-590\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 4.43em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.971em, 1004.43em, 5.419em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-591\"><span class=\"mrow\" id=\"MathJax-Span-592\"><span class=\"munderover\" id=\"MathJax-Span-593\"><span style=\"display: inline-block; position: relative; width: 4.43em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.971em, 1004.27em, 4.534em, -999.997em); top: -4.008em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-594\"><span class=\"mo\" id=\"MathJax-Span-595\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-596\"><span class=\"msubsup\" id=\"MathJax-Span-597\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-598\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-599\"><span class=\"mrow\" id=\"MathJax-Span-600\"><span class=\"mtext\" id=\"MathJax-Span-601\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">tool</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-602\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-603\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-604\"><span class=\"mrow\" id=\"MathJax-Span-605\"><span class=\"mtext\" id=\"MathJax-Span-606\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">tool</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-607\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.701em, 1004.43em, 4.69em, -999.997em); top: -3.279em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-608\" style=\"\"><span style=\"display: inline-block; position: relative; width: 4.43em; height: 0px;\"><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 0.003em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 3.492em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 1.305em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 0.784em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 3.023em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.273em, -999.997em); top: -2.081em; left: 1.357em;\"><span class=\"texatom\" id=\"MathJax-Span-609\"><span class=\"mrow\" id=\"MathJax-Span-610\"><span class=\"mtext\" id=\"MathJax-Span-611\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">which</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-612\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"munderover\" id=\"MathJax-Span-613\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 15.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.971em, 1015.89em, 5.419em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-614\"><span class=\"mrow\" id=\"MathJax-Span-615\"><span class=\"munderover\" id=\"MathJax-Span-616\"><span style=\"display: inline-block; position: relative; width: 15.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.971em, 1015.73em, 4.534em, -999.997em); top: -4.008em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-617\"><span class=\"mo\" id=\"MathJax-Span-618\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-619\"><span class=\"msubsup\" id=\"MathJax-Span-620\"><span style=\"display: inline-block; position: relative; width: 2.607em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-621\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-622\"><span class=\"mrow\" id=\"MathJax-Span-623\"><span class=\"mtext\" id=\"MathJax-Span-624\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">syntax</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-625\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-626\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-627\"><span class=\"mrow\" id=\"MathJax-Span-628\"><span class=\"mtext\" id=\"MathJax-Span-629\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">syntax</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-630\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-631\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-632\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-633\"><span class=\"mrow\" id=\"MathJax-Span-634\"><span class=\"mtext\" id=\"MathJax-Span-635\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">exec</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-636\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-637\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-638\"><span class=\"mrow\" id=\"MathJax-Span-639\"><span class=\"mtext\" id=\"MathJax-Span-640\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">exec</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-641\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-642\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-643\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-644\"><span class=\"mrow\" id=\"MathJax-Span-645\"><span class=\"mtext\" id=\"MathJax-Span-646\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">args</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-647\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-648\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-649\"><span class=\"mrow\" id=\"MathJax-Span-650\"><span class=\"mtext\" id=\"MathJax-Span-651\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">args</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-652\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.701em, 1015.89em, 4.69em, -999.997em); top: -3.279em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-653\" style=\"\"><span style=\"display: inline-block; position: relative; width: 15.888em; height: 0px;\"><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 0.003em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 14.951em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 7.034em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 0.836em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 1.409em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 1.982em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 2.503em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 3.076em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 3.648em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 4.221em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 4.742em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 5.315em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 5.888em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 6.461em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 8.805em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 9.326em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 9.898em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 10.471em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 11.044em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 11.565em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 12.138em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 12.711em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 13.284em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 13.805em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 14.378em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.2em, 4.273em, -999.997em); top: -2.081em; left: 7.346em;\"><span class=\"texatom\" id=\"MathJax-Span-654\"><span class=\"mrow\" id=\"MathJax-Span-655\"><span class=\"mtext\" id=\"MathJax-Span-656\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">how</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(2.971em, 1010.26em, 6.253em, -999.997em); top: -0.57em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-657\" style=\"font-family: STIXGeneral-Regular;\">+</span><span class=\"munderover\" id=\"MathJax-Span-658\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 9.273em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.971em, 1009.27em, 5.419em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-659\"><span class=\"mrow\" id=\"MathJax-Span-660\"><span class=\"munderover\" id=\"MathJax-Span-661\"><span style=\"display: inline-block; position: relative; width: 9.273em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.971em, 1009.12em, 4.534em, -999.997em); top: -4.008em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-662\"><span class=\"mo\" id=\"MathJax-Span-663\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-664\"><span class=\"msubsup\" id=\"MathJax-Span-665\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-666\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-667\"><span class=\"mrow\" id=\"MathJax-Span-668\"><span class=\"mtext\" id=\"MathJax-Span-669\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">task</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-670\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-671\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-672\"><span class=\"mrow\" id=\"MathJax-Span-673\"><span class=\"mtext\" id=\"MathJax-Span-674\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">task</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-675\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-676\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-677\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-678\"><span class=\"mrow\" id=\"MathJax-Span-679\"><span class=\"mtext\" id=\"MathJax-Span-680\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">pref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-681\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-682\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-683\"><span class=\"mrow\" id=\"MathJax-Span-684\"><span class=\"mtext\" id=\"MathJax-Span-685\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">pref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-686\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.701em, 1009.27em, 4.69em, -999.997em); top: -3.279em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-687\" style=\"\"><span style=\"display: inline-block; position: relative; width: 9.273em; height: 0px;\"><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 0.003em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 8.388em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 3.701em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 0.836em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 1.409em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 1.982em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 2.555em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 3.128em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 5.523em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 6.096em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 6.669em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 7.242em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 7.815em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1004.01em, 4.273em, -999.997em); top: -2.081em; left: 2.607em;\"><span class=\"texatom\" id=\"MathJax-Span-688\"><span class=\"mrow\" id=\"MathJax-Span-689\"><span class=\"mtext\" id=\"MathJax-Span-690\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">outcome-level</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 7.398em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -6.997em; border-left: 0px solid; width: 0px; height: 8.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><menclose notation=\"box\"><mrow class=\"MJX-TeXAtom-ORD\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mrow class=\"MJX-TeXAtom-ORD\"><mi>R</mi><mo>=</mo><munder><mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"><munder><mrow><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>call</mtext></mrow></msub><msup><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>call</mtext></mrow></msup></mrow><mo>⏟</mo></munder></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>when</mtext></mrow></munder><mo>+</mo><munder><mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"><munder><mrow><mo>(</mo><mrow><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>tool</mtext></mrow></msub><msup><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>tool</mtext></mrow></msup></mrow><mo>)</mo></mrow><mo>⏟</mo></munder></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>which</mtext></mrow></munder><mo>+</mo><munder><mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"><munder><mrow><mo>(</mo><mrow><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>syntax</mtext></mrow></msub><msup><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>syntax</mtext></mrow></msup><mo>+</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>exec</mtext></mrow></msub><msup><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>exec</mtext></mrow></msup><mo>+</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>args</mtext></mrow></msub><msup><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>args</mtext></mrow></msup></mrow><mo>)</mo></mrow><mo>⏟</mo></munder></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>how</mtext></mrow></munder><mo>+</mo><munder><mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"><munder><mrow><mo>(</mo><mrow><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>task</mtext></mrow></msub><msup><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>task</mtext></mrow></msup><mo>+</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>pref</mtext></mrow></msub><msup><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>pref</mtext></mrow></msup></mrow><mo>)</mo></mrow><mo>⏟</mo></munder></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>outcome-level</mtext></mrow></munder></mrow></mstyle></mrow></menclose></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-49\">\\boxed{\nR =\n\\underbrace{\nw_{\\text{call}} r^{\\text{call}}\n}_{\\text{when}}\n+\n\\underbrace{\n\\left(\nw_{\\text{tool}} r^{\\text{tool}}\n\\right)\n}_{\\text{which}}\n+\n\\underbrace{\n\\left(\nw_{\\text{syntax}} r^{\\text{syntax}}\n+\nw_{\\text{exec}} r^{\\text{exec}}\n+\nw_{\\text{args}} r^{\\text{args}}\n\\right)\n}_{\\text{how}}\n+\n\\underbrace{\n\\left(\nw_{\\text{task}} r^{\\text{task}}\n+\nw_{\\text{pref}} r^{\\text{pref}}\n\\right)\n}_{\\text{outcome-level}}\n}</script>\n\n    <ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li>The <strong>when</strong> group controls <em>whether</em> a tool is invoked.</li>\n          <li>The <strong>which + how</strong> group supervises <em>tool choice</em> and <em>argument construction</em>.</li>\n          <li>The <strong>outcome-level</strong> group ensures the final result is correct and aligns with human/judge preferences.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>This single scalar reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-50-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-691\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-692\"><span class=\"mi\" id=\"MathJax-Span-693\" style=\"font-family: STIXGeneral-Italic;\">R</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-50\">R</script> is what enters the RL optimizer (e.g., PPO or GRPO).</p>\n  </li>\n  <li>\n    <p>Weights <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-51-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-694\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-695\"><span class=\"mi\" id=\"MathJax-Span-696\" style=\"font-family: STIXGeneral-Italic;\">w</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>w</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-51\">w</script> are tuned to balance shaping vs. final correctness.</p>\n  </li>\n</ul>\n<p>All reward signals—process and outcome—are merged into one scalar:</p>\n<ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li>The <strong>when</strong> group controls <em>whether</em> a tool is invoked.</li>\n          <li>The <strong>which + how</strong> group supervises <em>tool choice</em> and <em>argument construction</em>.</li>\n          <li>The <strong>outcome-level</strong> group ensures the final result is correct and aligns with human/judge preferences.</li>\n        </ul>\n      </li>\n    </ul>\n<p>where:</p>\n<ul>\n          <li>The <strong>when</strong> group controls <em>whether</em> a tool is invoked.</li>\n          <li>The <strong>which + how</strong> group supervises <em>tool choice</em> and <em>argument construction</em>.</li>\n          <li>The <strong>outcome-level</strong> group ensures the final result is correct and aligns with human/judge preferences.</li>\n        </ul>\n<p>This single scalar reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-50-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-691\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-692\"><span class=\"mi\" id=\"MathJax-Span-693\" style=\"font-family: STIXGeneral-Italic;\">R</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-50\">R</script> is what enters the RL optimizer (e.g., PPO or GRPO).</p>\n<p>Weights <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-51-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-694\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-695\"><span class=\"mi\" id=\"MathJax-Span-696\" style=\"font-family: STIXGeneral-Italic;\">w</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>w</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-51\">w</script> are tuned to balance shaping vs. final correctness.</p>\n<h4 id=\"asymmetric-rewards-in-tool-calling-rl\">Asymmetric Rewards in Tool-Calling RL</h4>\n<ul>\n  <li>\n    <p>This section explains why tool-calling RL systems use <strong>asymmetric rewards</strong> (positive rewards much larger than negative rewards), how this stabilizes PPO/GRPO, and how asymmetry applies across the <strong>when / which / how</strong> components. A full worked example and a comprehensive reward table are included.</p>\n  </li>\n  <li>\n    <p>Asymmetric reward schedules are used in practical tool-use RL systems such as ReTool, ToolRL, DeepSeek-R1, and RLHF pipelines. They ensure that:</p>\n\n    <ul>\n      <li>Success is highly rewarded.</li>\n      <li>Failure incurs penalties but not catastrophic ones.</li>\n      <li>Exploration does not collapse into inert policies (e.g., “never call tools”).</li>\n      <li>The hierarchy — deciding <strong>when</strong> to call tools, <strong>which</strong> tool to call, and <strong>how</strong> to construct correct arguments — all receive stable and interpretable feedback.</li>\n    </ul>\n  </li>\n</ul>\n<p>This section explains why tool-calling RL systems use <strong>asymmetric rewards</strong> (positive rewards much larger than negative rewards), how this stabilizes PPO/GRPO, and how asymmetry applies across the <strong>when / which / how</strong> components. A full worked example and a comprehensive reward table are included.</p>\n<p>Asymmetric reward schedules are used in practical tool-use RL systems such as ReTool, ToolRL, DeepSeek-R1, and RLHF pipelines. They ensure that:</p>\n<ul>\n      <li>Success is highly rewarded.</li>\n      <li>Failure incurs penalties but not catastrophic ones.</li>\n      <li>Exploration does not collapse into inert policies (e.g., “never call tools”).</li>\n      <li>The hierarchy — deciding <strong>when</strong> to call tools, <strong>which</strong> tool to call, and <strong>how</strong> to construct correct arguments — all receive stable and interpretable feedback.</li>\n    </ul>\n<h5 id=\"why-asymmetry-is-required\">Why Asymmetry is Required</h5>\n<ul>\n  <li>\n    <p>Because tool-calling introduces many potential failure points (incorrect timing, wrong tool, malformed arguments, bad final answer), symmetric rewards would cause massive early negative returns. The policy would quickly learn the degenerate strategy: “Never call any tool; always respond directly.”</p>\n  </li>\n  <li>\n    <p>Asymmetric rewards avoid this by:</p>\n\n    <ul>\n      <li>Using <strong>large positive</strong> rewards for correct full trajectories.</li>\n      <li>Using <strong>mild or moderate negative</strong> rewards for mistakes.</li>\n      <li>Ensuring that exploratory attempts are only <em>slightly</em> penalized.</li>\n      <li>Allowing the policy to differentiate between “bad idea but learning” vs. “excellent behavior.”</li>\n    </ul>\n  </li>\n  <li>\n    <p>This encourages exploration in the factored action space and prevents PPO/GRPO from collapsing into trivial policies.</p>\n  </li>\n</ul>\n<p>Because tool-calling introduces many potential failure points (incorrect timing, wrong tool, malformed arguments, bad final answer), symmetric rewards would cause massive early negative returns. The policy would quickly learn the degenerate strategy: “Never call any tool; always respond directly.”</p>\n<p>Asymmetric rewards avoid this by:</p>\n<ul>\n      <li>Using <strong>large positive</strong> rewards for correct full trajectories.</li>\n      <li>Using <strong>mild or moderate negative</strong> rewards for mistakes.</li>\n      <li>Ensuring that exploratory attempts are only <em>slightly</em> penalized.</li>\n      <li>Allowing the policy to differentiate between “bad idea but learning” vs. “excellent behavior.”</li>\n    </ul>\n<p>This encourages exploration in the factored action space and prevents PPO/GRPO from collapsing into trivial policies.</p>\n<h5 id=\"reward-table-positive-and-negative-rewards-by-category\">Reward Table: Positive and Negative Rewards by Category</h5>\n<ul>\n  <li>Below is a consolidated table representing <strong>typical</strong> asymmetric reward magnitudes for each component. These values are illustrative and are often tuned per domain.</li>\n</ul>\n<h6 id=\"reward-values-for-when--which--how-and-outcome-level-components\">Reward Values for “When / Which / How” and Outcome-Level Components</h6>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Reward Component</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Description</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Positive Reward Range</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Negative Reward Range</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><b>When</b> (call decision)</td>\n<td class=\"tg-tleft-valign-first\">Correctly calling a tool when needed</td>\n<td class=\"tg-tleft-valign-first\">+0.5 to +1.5</td>\n<td class=\"tg-tleft-valign-second\">−0.2 (tool required but not called)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"></td>\n<td class=\"tg-tleft-valign-first\">Correctly not calling a tool</td>\n<td class=\"tg-tleft-valign-first\">+0.3 to +1</td>\n<td class=\"tg-tleft-valign-second\">−0.2 (tool called when unnecessary)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><b>Which</b> (tool selection)</td>\n<td class=\"tg-tleft-valign-first\">Selecting correct tool</td>\n<td class=\"tg-tleft-valign-first\">+0.5 to +2.0</td>\n<td class=\"tg-tleft-valign-second\">−0.3 to −0.7 (wrong tool)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><b>How: Syntax</b></td>\n<td class=\"tg-tleft-valign-first\">JSON validity and schema correctness</td>\n<td class=\"tg-tleft-valign-first\">+0.3 to +1.0</td>\n<td class=\"tg-tleft-valign-second\">−1.0 (malformed JSON or wrong schema)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><b>How: Execution</b></td>\n<td class=\"tg-tleft-valign-first\">Tool executes successfully (HTTP 200, etc.)</td>\n<td class=\"tg-tleft-valign-first\">+0.5 to +1.0</td>\n<td class=\"tg-tleft-valign-second\">−1.0 to −2.0 (execution error)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><b>How: Argument Quality</b></td>\n<td class=\"tg-tleft-valign-first\">High-quality arguments (correct fields, values)</td>\n<td class=\"tg-tleft-valign-first\">+0.5 to +2.0</td>\n<td class=\"tg-tleft-valign-second\">−0.5 to −1.5 (missing/incorrect/poor arguments)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><b>Outcome: Final Task Success</b></td>\n<td class=\"tg-tleft-valign-first\">Producing correct final answer using tool output</td>\n<td class=\"tg-tleft-valign-first\">+8.0 to +15.0</td>\n<td class=\"tg-tleft-valign-second\">−0.3 to −1.0 (incorrect final answer)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><b>Outcome: Preference/Judge Score</b></td>\n<td class=\"tg-tleft-valign-first\">Judge or LLM-as-a-critic evaluation of final output</td>\n<td class=\"tg-tleft-valign-first\">+1.0 to +5.0</td>\n<td class=\"tg-tleft-valign-second\">−0.1 to −1.0</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Reward Component</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Description</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Positive Reward Range</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Negative Reward Range</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><b>When</b> (call decision)</td>\n<td class=\"tg-tleft-valign-first\">Correctly calling a tool when needed</td>\n<td class=\"tg-tleft-valign-first\">+0.5 to +1.5</td>\n<td class=\"tg-tleft-valign-second\">−0.2 (tool required but not called)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"></td>\n<td class=\"tg-tleft-valign-first\">Correctly not calling a tool</td>\n<td class=\"tg-tleft-valign-first\">+0.3 to +1</td>\n<td class=\"tg-tleft-valign-second\">−0.2 (tool called when unnecessary)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><b>Which</b> (tool selection)</td>\n<td class=\"tg-tleft-valign-first\">Selecting correct tool</td>\n<td class=\"tg-tleft-valign-first\">+0.5 to +2.0</td>\n<td class=\"tg-tleft-valign-second\">−0.3 to −0.7 (wrong tool)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><b>How: Syntax</b></td>\n<td class=\"tg-tleft-valign-first\">JSON validity and schema correctness</td>\n<td class=\"tg-tleft-valign-first\">+0.3 to +1.0</td>\n<td class=\"tg-tleft-valign-second\">−1.0 (malformed JSON or wrong schema)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><b>How: Execution</b></td>\n<td class=\"tg-tleft-valign-first\">Tool executes successfully (HTTP 200, etc.)</td>\n<td class=\"tg-tleft-valign-first\">+0.5 to +1.0</td>\n<td class=\"tg-tleft-valign-second\">−1.0 to −2.0 (execution error)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><b>How: Argument Quality</b></td>\n<td class=\"tg-tleft-valign-first\">High-quality arguments (correct fields, values)</td>\n<td class=\"tg-tleft-valign-first\">+0.5 to +2.0</td>\n<td class=\"tg-tleft-valign-second\">−0.5 to −1.5 (missing/incorrect/poor arguments)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><b>Outcome: Final Task Success</b></td>\n<td class=\"tg-tleft-valign-first\">Producing correct final answer using tool output</td>\n<td class=\"tg-tleft-valign-first\">+8.0 to +15.0</td>\n<td class=\"tg-tleft-valign-second\">−0.3 to −1.0 (incorrect final answer)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><b>Outcome: Preference/Judge Score</b></td>\n<td class=\"tg-tleft-valign-first\">Judge or LLM-as-a-critic evaluation of final output</td>\n<td class=\"tg-tleft-valign-first\">+1.0 to +5.0</td>\n<td class=\"tg-tleft-valign-second\">−0.1 to −1.0</td>\n</tr>\n</tbody>\n</table>\n<ul>\n  <li>\n    <p>This table reflects the following structural principles:</p>\n\n    <ul>\n      <li>The <strong>largest rewards</strong> are reserved for correct <em>end-to-end</em> solution quality.</li>\n      <li>The <strong>largest penalties</strong> correspond only to errors that break execution (syntax, runtime failure).</li>\n      <li>Small errors in timing, selection, or argument quality incur <strong>light penalties</strong>.</li>\n      <li>Rewards across “when / which / how” are significantly <strong>lower</strong> than final-task success, ensuring shaping rewards guide early learning but final correctness dominates late learning.</li>\n    </ul>\n  </li>\n</ul>\n<p>This table reflects the following structural principles:</p>\n<ul>\n      <li>The <strong>largest rewards</strong> are reserved for correct <em>end-to-end</em> solution quality.</li>\n      <li>The <strong>largest penalties</strong> correspond only to errors that break execution (syntax, runtime failure).</li>\n      <li>Small errors in timing, selection, or argument quality incur <strong>light penalties</strong>.</li>\n      <li>Rewards across “when / which / how” are significantly <strong>lower</strong> than final-task success, ensuring shaping rewards guide early learning but final correctness dominates late learning.</li>\n    </ul>\n<h5 id=\"worked-example-with-asymmetric-rewards\">Worked Example with Asymmetric Rewards</h5>\n<ul>\n  <li>\n    <p>Consider the user query: “What’s the weather in Paris tomorrow?”</p>\n  </li>\n  <li>\n    <p>Correct behavior requires:</p>\n\n    <ol>\n      <li>Deciding a tool is required (<strong>when</strong>).</li>\n      <li>Selecting the weather API (<strong>which</strong>).</li>\n      <li>Providing correct arguments in JSON (<strong>how</strong>).</li>\n      <li>Producing the correct final answer using the tool output.</li>\n    </ol>\n  </li>\n  <li>\n    <p>Below are two trajectories demonstrating asymmetry.</p>\n  </li>\n</ul>\n<p>Consider the user query: “What’s the weather in Paris tomorrow?”</p>\n<p>Correct behavior requires:</p>\n<ol>\n      <li>Deciding a tool is required (<strong>when</strong>).</li>\n      <li>Selecting the weather API (<strong>which</strong>).</li>\n      <li>Providing correct arguments in JSON (<strong>how</strong>).</li>\n      <li>Producing the correct final answer using the tool output.</li>\n    </ol>\n<p>Below are two trajectories demonstrating asymmetry.</p>\n<h6 id=\"trajectory-a-imperfect-but-reasonable-exploration\">Trajectory A: Imperfect but Reasonable Exploration</h6>\n<ol>\n  <li><strong>When</strong> decision correct <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-52-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-697\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-698\"><span class=\"mo\" id=\"MathJax-Span-699\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-52\">\\rightarrow</script> +1.0</li>\n  <li><strong>Which</strong> tool wrong <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-53-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-700\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-701\"><span class=\"mo\" id=\"MathJax-Span-702\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-53\">\\rightarrow</script> −0.5</li>\n  <li>JSON syntax valid <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-54-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-703\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-704\"><span class=\"mo\" id=\"MathJax-Span-705\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-54\">\\rightarrow</script> +0.5</li>\n  <li>Tool executes (but irrelevant) <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-55-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-706\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-707\"><span class=\"mo\" id=\"MathJax-Span-708\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-55\">\\rightarrow</script> 0</li>\n  <li>Final answer wrong <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-56-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-709\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-710\"><span class=\"mo\" id=\"MathJax-Span-711\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-56\">\\rightarrow</script> −0.5</li>\n</ol>\n<ul>\n  <li>Total reward:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-57-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>R</mi><mi>A</mi></msub><mo>=</mo><mn>1.0</mn><mo>&amp;#x2212;</mo><mn>0.5</mn><mo>+</mo><mn>0.5</mn><mo>+</mo><mn>0</mn><mo>&amp;#x2212;</mo><mn>0.5</mn><mo>=</mo><mn>0.5</mn></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-712\" style=\"width: 17.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.586em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1014.53em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-713\"><span class=\"msubsup\" id=\"MathJax-Span-714\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-715\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-716\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-717\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-718\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">1.0</span><span class=\"mo\" id=\"MathJax-Span-719\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mn\" id=\"MathJax-Span-720\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">0.5</span><span class=\"mo\" id=\"MathJax-Span-721\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-722\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">0.5</span><span class=\"mo\" id=\"MathJax-Span-723\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-724\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">0</span><span class=\"mo\" id=\"MathJax-Span-725\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mn\" id=\"MathJax-Span-726\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">0.5</span><span class=\"mo\" id=\"MathJax-Span-727\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-728\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0.5</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>R</mi><mi>A</mi></msub><mo>=</mo><mn>1.0</mn><mo>−</mo><mn>0.5</mn><mo>+</mo><mn>0.5</mn><mo>+</mo><mn>0</mn><mo>−</mo><mn>0.5</mn><mo>=</mo><mn>0.5</mn></math></span></span></div>\n<ul>\n  <li>Even though the overall answer is wrong, the trajectory gets a <em>small positive</em> reward because several subcomponents were correct. This prevents the model from concluding that tool use is too risky.</li>\n</ul>\n<h6 id=\"trajectory-b-full-correct-behavior\">Trajectory B: Full Correct Behavior</h6>\n<ol>\n  <li>Correct <strong>when</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-58-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-729\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-730\"><span class=\"mo\" id=\"MathJax-Span-731\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-58\">\\rightarrow</script> +1.0</li>\n  <li>Correct <strong>which</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-59-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-732\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-733\"><span class=\"mo\" id=\"MathJax-Span-734\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-59\">\\rightarrow</script> +1.5</li>\n  <li>Correct JSON arguments <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-60-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-735\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-736\"><span class=\"mo\" id=\"MathJax-Span-737\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-60\">\\rightarrow</script> +1.0</li>\n  <li>Successful tool execution <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-61-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-738\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-739\"><span class=\"mo\" id=\"MathJax-Span-740\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-61\">\\rightarrow</script> +1.0</li>\n  <li>Correct final answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-62-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-741\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-742\"><span class=\"mo\" id=\"MathJax-Span-743\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-62\">\\rightarrow</script> +10.0</li>\n</ol>\n<ul>\n  <li>Total reward:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-63-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>R</mi><mi>B</mi></msub><mo>=</mo><mn>1.0</mn><mo>+</mo><mn>1.5</mn><mo>+</mo><mn>1.0</mn><mo>+</mo><mn>1.0</mn><mo>+</mo><mn>10.0</mn><mo>=</mo><mn>14.5</mn></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-744\" style=\"width: 19.638em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.357em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1016.3em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-745\"><span class=\"msubsup\" id=\"MathJax-Span-746\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-747\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-748\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">B</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-749\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-750\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">1.0</span><span class=\"mo\" id=\"MathJax-Span-751\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-752\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">1.5</span><span class=\"mo\" id=\"MathJax-Span-753\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-754\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">1.0</span><span class=\"mo\" id=\"MathJax-Span-755\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-756\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">1.0</span><span class=\"mo\" id=\"MathJax-Span-757\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-758\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">10.0</span><span class=\"mo\" id=\"MathJax-Span-759\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-760\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">14.5</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>R</mi><mi>B</mi></msub><mo>=</mo><mn>1.0</mn><mo>+</mo><mn>1.5</mn><mo>+</mo><mn>1.0</mn><mo>+</mo><mn>1.0</mn><mo>+</mo><mn>10.0</mn><mo>=</mo><mn>14.5</mn></math></span></span></div>\n<ul>\n  <li>The tremendous difference between +14.5 and +0.5 clearly guides PPO/GRPO toward producing the full correct behavior.</li>\n</ul>\n<h5 id=\"how-asymmetry-stabilizes-ppogrpo\">How Asymmetry Stabilizes PPO/GRPO</h5>\n<ul>\n  <li>Advantages are computed via:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-64-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-761\" style=\"width: 7.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1006.15em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-762\"><span class=\"msubsup\" id=\"MathJax-Span-763\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-764\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-765\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-766\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-767\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-768\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-769\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-770\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-771\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-772\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-773\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-774\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-775\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-776\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><mo>−</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div>\n<ul>\n  <li>\n    <p>With asymmetric rewards:</p>\n\n    <ul>\n      <li>Failed trajectories receive slightly negative or slightly positive returns.</li>\n      <li>Successful trajectories receive large positive returns.</li>\n      <li>Advantage variance stays manageable.</li>\n      <li>Exploration does not collapse into “never call tools.”</li>\n      <li>The policy improves steadily across “when / which / how” dimensions.</li>\n    </ul>\n  </li>\n  <li>\n    <p>If rewards were symmetric (e.g., +10 vs. −10), then most exploratory episodes would produce extreme negative advantages, instantly pushing the model toward refusing all tool calls. Asymmetry prevents this collapse.</p>\n  </li>\n</ul>\n<p>With asymmetric rewards:</p>\n<ul>\n      <li>Failed trajectories receive slightly negative or slightly positive returns.</li>\n      <li>Successful trajectories receive large positive returns.</li>\n      <li>Advantage variance stays manageable.</li>\n      <li>Exploration does not collapse into “never call tools.”</li>\n      <li>The policy improves steadily across “when / which / how” dimensions.</li>\n    </ul>\n<p>If rewards were symmetric (e.g., +10 vs. −10), then most exploratory episodes would produce extreme negative advantages, instantly pushing the model toward refusing all tool calls. Asymmetry prevents this collapse.</p>\n<h5 id=\"takeaways\">Takeaways</h5>\n<ul>\n  <li>\n    <p>Asymmetric rewards are essential for training LLM tool-calling policies because they:</p>\n\n    <ul>\n      <li>Preserve exploration.</li>\n      <li>Deliver stable gradients for PPO/GRPO.</li>\n      <li>Avoid trivial degenerate strategies.</li>\n      <li>Properly balance shaping rewards (for “when / which / how”) with outcome-level rewards.</li>\n      <li>Distinguish partial correctness from catastrophic failure.</li>\n      <li>Encourage correct final answers without over-penalizing small mistakes.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The reward table and examples above provide a practical blueprint for implementing and tuning asymmetric rewards in your own RL tool-calling system.</p>\n  </li>\n</ul>\n<p>Asymmetric rewards are essential for training LLM tool-calling policies because they:</p>\n<ul>\n      <li>Preserve exploration.</li>\n      <li>Deliver stable gradients for PPO/GRPO.</li>\n      <li>Avoid trivial degenerate strategies.</li>\n      <li>Properly balance shaping rewards (for “when / which / how”) with outcome-level rewards.</li>\n      <li>Distinguish partial correctness from catastrophic failure.</li>\n      <li>Encourage correct final answers without over-penalizing small mistakes.</li>\n    </ul>\n<p>The reward table and examples above provide a practical blueprint for implementing and tuning asymmetric rewards in your own RL tool-calling system.</p>",
    "contentMarkdown": "*   This section explains how to generate supervision signals for _all_ reward components in the RL system, reflecting the decomposition of tool-use behavior into:\n    \n    *   **When** →→\\\\rightarrow deciding _if and when_ a tool should be used\n    *   **Which** →→\\\\rightarrow selecting _which_ tool to call\n    *   **How** →→\\\\rightarrow constructing _how_ to call it via correctly formed arguments\n*   To support this, the reward is decomposed into the following components:\n    \n    1.  **Call (when-to-call)**: whether a tool should be called.\n    2.  **Tool-selection**: whether the correct tool was chosen (which).\n    3.  **Tool-syntax correctness**: whether the tool call was formatted properly.\n    4.  **Tool-execution correctness**: whether the tool executed successfully.\n    5.  **Argument quality**: whether the arguments were appropriate (how).\n    6.  **Final task success**: whether the entire episode produced the right answer.\n    7.  **Preference-based / generative evaluation**: higher-level judgment (LLM-as-a-Judge).\n*   Each reward dimension can be supervised using a mixture of:\n    \n    *   Rule-based heuristics\n    *   Discriminative reward models trained on human data\n    *   Generative reward models (LLM-as-a-Judge as in [DeepSeek-R1](https://arxiv.org/abs/2501.12948) by Guo et al. (2025)).\n\nThis section explains how to generate supervision signals for _all_ reward components in the RL system, reflecting the decomposition of tool-use behavior into:\n\n*   **When** →→\\\\rightarrow deciding _if and when_ a tool should be used\n*   **Which** →→\\\\rightarrow selecting _which_ tool to call\n*   **How** →→\\\\rightarrow constructing _how_ to call it via correctly formed arguments\n\nTo support this, the reward is decomposed into the following components:\n\n1.  **Call (when-to-call)**: whether a tool should be called.\n2.  **Tool-selection**: whether the correct tool was chosen (which).\n3.  **Tool-syntax correctness**: whether the tool call was formatted properly.\n4.  **Tool-execution correctness**: whether the tool executed successfully.\n5.  **Argument quality**: whether the arguments were appropriate (how).\n6.  **Final task success**: whether the entire episode produced the right answer.\n7.  **Preference-based / generative evaluation**: higher-level judgment (LLM-as-a-Judge).\n\nEach reward dimension can be supervised using a mixture of:\n\n*   Rule-based heuristics\n*   Discriminative reward models trained on human data\n*   Generative reward models (LLM-as-a-Judge as in [DeepSeek-R1](https://arxiv.org/abs/2501.12948) by Guo et al. (2025)).\n\n#### Reward Component: Tool Call (Deciding “When” a Tool Should be Invoked)\n\n*   This component supports the **when** dimension: Is a tool call appropriate/necessary at this point in the reasoning process?\n\n##### Rule-based Supervision\n\n*   Use deterministic rules and intent detectors inspired by works like [Toolformer](https://arxiv.org/abs/2302.04761) by Schick et al. (2023):\n    \n    *   Weather questions →→\\\\rightarrow require weather API\n    *   Math expressions →→\\\\rightarrow require calculator\n    *   “Define X / explain Y” →→\\\\rightarrow no tool\n    *   Factual queries →→\\\\rightarrow search tool\n    *   Actionable tasks (e.g., booking) →→\\\\rightarrow appropriate domain tool\n*   This produces binary or graded labels ycall∈0,1ycall∈0,1y\\_{\\\\text{call}} \\\\in {0,1}.\n    \n\nUse deterministic rules and intent detectors inspired by works like [Toolformer](https://arxiv.org/abs/2302.04761) by Schick et al. (2023):\n\n*   Weather questions →→\\\\rightarrow require weather API\n*   Math expressions →→\\\\rightarrow require calculator\n*   “Define X / explain Y” →→\\\\rightarrow no tool\n*   Factual queries →→\\\\rightarrow search tool\n*   Actionable tasks (e.g., booking) →→\\\\rightarrow appropriate domain tool\n\nThis produces binary or graded labels ycall∈0,1ycall∈0,1y\\_{\\\\text{call}} \\\\in {0,1}.\n\n##### Discriminative Reward Model\n\n*   Train a classifier fϕ(x)fϕ(x)f\\_{\\\\phi}(x) predicting P(ycall\\=1∣x)P(ycall\\=1∣x)P(y\\_{\\\\text{call}} = 1 \\\\mid x) using human-labeled examples indicating if/how strongly the query requires tool use.\n*   This mirrors methodology from RLHF as in [InstructGPT](https://arxiv.org/abs/2203.02155) by Ouyang et al. (2022).\n\n##### Generative Reward Model (LLM-as-a-Judge)\n\n*   Use a judge model (e.g., DeepSeek-V3 per [DeepSeek-R1](https://arxiv.org/abs/2501.12948)):\n    \n*   Prompt: “Given this user query and available tools, should the agent call a tool at this stage? Provide yes/no and reasoning.”\n    \n*   Extract a scalar reward from the generative verdict.\n    \n*   This can capture nuanced timing requirements over multiple steps.\n    \n\nUse a judge model (e.g., DeepSeek-V3 per [DeepSeek-R1](https://arxiv.org/abs/2501.12948)):\n\nPrompt: “Given this user query and available tools, should the agent call a tool at this stage? Provide yes/no and reasoning.”\n\nExtract a scalar reward from the generative verdict.\n\nThis can capture nuanced timing requirements over multiple steps.\n\n#### Reward Component: Tool Selection (Choosing “Which” Tool)\n\n*   This component supports the **which** dimension: Given that a tool is to be called, was the _correct_ tool chosen?\n\n##### Rule-based Supervision\n\n*   If rules map tasks to a specific tool or tool category, then:\n    \n    *   If the predicted tool matches the rule →→\\\\rightarrow +reward\n    *   Otherwise →→\\\\rightarrow −reward\n*   This is similar to mapping tool types in [ReAct](https://arxiv.org/abs/2210.03629) by Yao et al. (2022).\n    \n\nIf rules map tasks to a specific tool or tool category, then:\n\n*   If the predicted tool matches the rule →→\\\\rightarrow +reward\n*   Otherwise →→\\\\rightarrow −reward\n\nThis is similar to mapping tool types in [ReAct](https://arxiv.org/abs/2210.03629) by Yao et al. (2022).\n\n##### Discriminative Reward Model\n\n*   Train a classifier fψ(st,at)fψ(st,at)f\\_{\\\\psi}(s\\_t, a\\_t) that judges whether the selected tool matches human expectations for that state.\n\n##### Generative Reward Model\n\n*   Ask a judge LLM: “Was TOOL\\_X the best tool choice for this request at this step?”\n    \n*   Score the answer and normalize.\n    \n\nAsk a judge LLM: “Was TOOL\\_X the best tool choice for this request at this step?”\n\nScore the answer and normalize.\n\n#### Reward Component: **Tool-Syntax Correctness**\n\n*   Supports the **how** dimension partially, focusing on _format_:\n    \n    *   JSON validity\n    *   Required argument fields\n    *   Correct schema shape\n\nSupports the **how** dimension partially, focusing on _format_:\n\n*   JSON validity\n*   Required argument fields\n*   Correct schema shape\n\n##### Rule-based\n\n*   JSON parse success\n*   Schema validation\n*   Argument-type validation\n    \n*   **Reward:**\n    \n    rsyntaxt\\={+1if JSON + schema valid −1otherwisertsyntax\\={+1if JSON + schema valid −1otherwise\n    \n    r\\_t^{\\\\text{syntax}} = \\\\begin{cases} +1 & \\\\text{if JSON + schema valid} \\\\ -1 & \\\\text{otherwise} \\\\end{cases}\n*   This echoes structured action enforcement in [ReAct](https://arxiv.org/abs/2210.03629).\n\nArgument-type validation\n\n**Reward:**\n\n##### Discriminative Reward Model\n\n*   Classify correct vs. incorrect tool-call formats.\n\n##### Generative Reward Model\n\n*   Ask an LLM judge whether the formatting is correct (1–10), normalize to reward.\n\n#### Reward Component: **Tool-Execution Correctness**\n\n*   Did the tool run without error?\n\n##### Rule-based\n\n*   HTTP 200 or success flag →→\\\\rightarrow +reward\n*   Errors / exceptions →→\\\\rightarrow −reward\n\n##### Discriminative Reward Model\n\n*   Trained to predict execution feasibility or correctness.\n\n##### Generative Reward Model\n\n*   Judge evaluates based on logs and outputs.\n\n#### Reward Component: Argument Quality (Deciding “How” to Call a Tool)\n\n*   This is the core of the **how** dimension: constructing appropriate arguments.\n\n##### Rule-based\n\n*   For numeric or structured problems:\n\nrargst\\=−|apred−agold|rtargs\\=−|apred−agold|\n\n*   For strings, use embedding similarity or fuzzy match.\n\n##### Discriminative Reward Model\n\n*   Trained to identify argument errors (bad city name, missing date, etc.).\n\n##### Generative Reward Model\n\n*   LLM-as-a-Judge evaluates argument plausibility/fit to the query.\n\n#### Reward Component: **Final Task Success**\n\n*   Whether the overall trajectory produced a correct answer.\n\n##### Rule-based\n\n*   Unit test pass\n*   Exact match\n*   Tolerance-based numeric match\n\n##### Discriminative Reward Model\n\n*   Using preference modeling as in [Deep RL from Human Preferences](https://arxiv.org/abs/1706.03741) by Christiano et al. (2017), train:\n\nLRM\\=−logerϕ(τA)erϕ(τA)+erϕ(τB).LRM\\=−log⁡erϕ(τA)erϕ(τA)+erϕ(τB).\n\n##### Generative Reward Model\n\n*   Judge LLM compares model prediction with ground truth (as in [DeepSeek-R1](https://arxiv.org/abs/2501.12948)).\n\n#### Merged Preference-Based Rewards (For `CALL`, “Which”, and “How”)\n\n*   You can construct pairs of trajectories differing in:\n    \n    *   timing of tool calls (call),\n    *   choice of tool (which), and\n    *   argument construction (how)\n*   Let the judge or human annotator choose the better one.\n    \n*   Train a preference RM to provide combined signals.\n    \n\nYou can construct pairs of trajectories differing in:\n\n*   timing of tool calls (call),\n*   choice of tool (which), and\n*   argument construction (how)\n\nLet the judge or human annotator choose the better one.\n\nTrain a preference RM to provide combined signals.\n\n#### Unified Reward Formulation\n\n*   All reward signals—process and outcome—are merged into one scalar:\n    \n    R\\=wcallrcallwhen+(wtoolrtool)which+(wsyntaxrsyntax+wexecrexec+wargsrargs)how+(wtaskrtask+wprefrpref)outcome-levelR\\=wcallrcall⏟when+(wtoolrtool)⏟which+(wsyntaxrsyntax+wexecrexec+wargsrargs)⏟how+(wtaskrtask+wprefrpref)⏟outcome-level\n    \n    \\\\boxed{ R = \\\\underbrace{ w\\_{\\\\text{call}} r^{\\\\text{call}} }\\_{\\\\text{when}} + \\\\underbrace{ \\\\left( w\\_{\\\\text{tool}} r^{\\\\text{tool}} \\\\right) }\\_{\\\\text{which}} + \\\\underbrace{ \\\\left( w\\_{\\\\text{syntax}} r^{\\\\text{syntax}} + w\\_{\\\\text{exec}} r^{\\\\text{exec}} + w\\_{\\\\text{args}} r^{\\\\text{args}} \\\\right) }\\_{\\\\text{how}} + \\\\underbrace{ \\\\left( w\\_{\\\\text{task}} r^{\\\\text{task}} + w\\_{\\\\text{pref}} r^{\\\\text{pref}} \\\\right) }\\_{\\\\text{outcome-level}} }\n    *   where:\n        \n        *   The **when** group controls _whether_ a tool is invoked.\n        *   The **which + how** group supervises _tool choice_ and _argument construction_.\n        *   The **outcome-level** group ensures the final result is correct and aligns with human/judge preferences.\n*   This single scalar reward RRR is what enters the RL optimizer (e.g., PPO or GRPO).\n    \n*   Weights www are tuned to balance shaping vs. final correctness.\n    \n\nAll reward signals—process and outcome—are merged into one scalar:\n\n*   where:\n    \n    *   The **when** group controls _whether_ a tool is invoked.\n    *   The **which + how** group supervises _tool choice_ and _argument construction_.\n    *   The **outcome-level** group ensures the final result is correct and aligns with human/judge preferences.\n\nwhere:\n\n*   The **when** group controls _whether_ a tool is invoked.\n*   The **which + how** group supervises _tool choice_ and _argument construction_.\n*   The **outcome-level** group ensures the final result is correct and aligns with human/judge preferences.\n\nThis single scalar reward RRR is what enters the RL optimizer (e.g., PPO or GRPO).\n\nWeights www are tuned to balance shaping vs. final correctness.\n\n#### Asymmetric Rewards in Tool-Calling RL\n\n*   This section explains why tool-calling RL systems use **asymmetric rewards** (positive rewards much larger than negative rewards), how this stabilizes PPO/GRPO, and how asymmetry applies across the **when / which / how** components. A full worked example and a comprehensive reward table are included.\n    \n*   Asymmetric reward schedules are used in practical tool-use RL systems such as ReTool, ToolRL, DeepSeek-R1, and RLHF pipelines. They ensure that:\n    \n    *   Success is highly rewarded.\n    *   Failure incurs penalties but not catastrophic ones.\n    *   Exploration does not collapse into inert policies (e.g., “never call tools”).\n    *   The hierarchy — deciding **when** to call tools, **which** tool to call, and **how** to construct correct arguments — all receive stable and interpretable feedback.\n\nThis section explains why tool-calling RL systems use **asymmetric rewards** (positive rewards much larger than negative rewards), how this stabilizes PPO/GRPO, and how asymmetry applies across the **when / which / how** components. A full worked example and a comprehensive reward table are included.\n\nAsymmetric reward schedules are used in practical tool-use RL systems such as ReTool, ToolRL, DeepSeek-R1, and RLHF pipelines. They ensure that:\n\n*   Success is highly rewarded.\n*   Failure incurs penalties but not catastrophic ones.\n*   Exploration does not collapse into inert policies (e.g., “never call tools”).\n*   The hierarchy — deciding **when** to call tools, **which** tool to call, and **how** to construct correct arguments — all receive stable and interpretable feedback.\n\n##### Why Asymmetry is Required\n\n*   Because tool-calling introduces many potential failure points (incorrect timing, wrong tool, malformed arguments, bad final answer), symmetric rewards would cause massive early negative returns. The policy would quickly learn the degenerate strategy: “Never call any tool; always respond directly.”\n    \n*   Asymmetric rewards avoid this by:\n    \n    *   Using **large positive** rewards for correct full trajectories.\n    *   Using **mild or moderate negative** rewards for mistakes.\n    *   Ensuring that exploratory attempts are only _slightly_ penalized.\n    *   Allowing the policy to differentiate between “bad idea but learning” vs. “excellent behavior.”\n*   This encourages exploration in the factored action space and prevents PPO/GRPO from collapsing into trivial policies.\n    \n\nBecause tool-calling introduces many potential failure points (incorrect timing, wrong tool, malformed arguments, bad final answer), symmetric rewards would cause massive early negative returns. The policy would quickly learn the degenerate strategy: “Never call any tool; always respond directly.”\n\nAsymmetric rewards avoid this by:\n\n*   Using **large positive** rewards for correct full trajectories.\n*   Using **mild or moderate negative** rewards for mistakes.\n*   Ensuring that exploratory attempts are only _slightly_ penalized.\n*   Allowing the policy to differentiate between “bad idea but learning” vs. “excellent behavior.”\n\nThis encourages exploration in the factored action space and prevents PPO/GRPO from collapsing into trivial policies.\n\n##### Reward Table: Positive and Negative Rewards by Category\n\n*   Below is a consolidated table representing **typical** asymmetric reward magnitudes for each component. These values are illustrative and are often tuned per domain.\n\n###### Reward Values for “When / Which / How” and Outcome-Level Components\n\n**Reward Component**\n\n**Description**\n\n**Positive Reward Range**\n\n**Negative Reward Range**\n\n**When** (call decision)\n\nCorrectly calling a tool when needed\n\n+0.5 to +1.5\n\n−0.2 (tool required but not called)\n\nCorrectly not calling a tool\n\n+0.3 to +1\n\n−0.2 (tool called when unnecessary)\n\n**Which** (tool selection)\n\nSelecting correct tool\n\n+0.5 to +2.0\n\n−0.3 to −0.7 (wrong tool)\n\n**How: Syntax**\n\nJSON validity and schema correctness\n\n+0.3 to +1.0\n\n−1.0 (malformed JSON or wrong schema)\n\n**How: Execution**\n\nTool executes successfully (HTTP 200, etc.)\n\n+0.5 to +1.0\n\n−1.0 to −2.0 (execution error)\n\n**How: Argument Quality**\n\nHigh-quality arguments (correct fields, values)\n\n+0.5 to +2.0\n\n−0.5 to −1.5 (missing/incorrect/poor arguments)\n\n**Outcome: Final Task Success**\n\nProducing correct final answer using tool output\n\n+8.0 to +15.0\n\n−0.3 to −1.0 (incorrect final answer)\n\n**Outcome: Preference/Judge Score**\n\nJudge or LLM-as-a-critic evaluation of final output\n\n+1.0 to +5.0\n\n−0.1 to −1.0\n\n**Reward Component**\n\n**Description**\n\n**Positive Reward Range**\n\n**Negative Reward Range**\n\n**When** (call decision)\n\nCorrectly calling a tool when needed\n\n+0.5 to +1.5\n\n−0.2 (tool required but not called)\n\nCorrectly not calling a tool\n\n+0.3 to +1\n\n−0.2 (tool called when unnecessary)\n\n**Which** (tool selection)\n\nSelecting correct tool\n\n+0.5 to +2.0\n\n−0.3 to −0.7 (wrong tool)\n\n**How: Syntax**\n\nJSON validity and schema correctness\n\n+0.3 to +1.0\n\n−1.0 (malformed JSON or wrong schema)\n\n**How: Execution**\n\nTool executes successfully (HTTP 200, etc.)\n\n+0.5 to +1.0\n\n−1.0 to −2.0 (execution error)\n\n**How: Argument Quality**\n\nHigh-quality arguments (correct fields, values)\n\n+0.5 to +2.0\n\n−0.5 to −1.5 (missing/incorrect/poor arguments)\n\n**Outcome: Final Task Success**\n\nProducing correct final answer using tool output\n\n+8.0 to +15.0\n\n−0.3 to −1.0 (incorrect final answer)\n\n**Outcome: Preference/Judge Score**\n\nJudge or LLM-as-a-critic evaluation of final output\n\n+1.0 to +5.0\n\n−0.1 to −1.0\n\n*   This table reflects the following structural principles:\n    \n    *   The **largest rewards** are reserved for correct _end-to-end_ solution quality.\n    *   The **largest penalties** correspond only to errors that break execution (syntax, runtime failure).\n    *   Small errors in timing, selection, or argument quality incur **light penalties**.\n    *   Rewards across “when / which / how” are significantly **lower** than final-task success, ensuring shaping rewards guide early learning but final correctness dominates late learning.\n\nThis table reflects the following structural principles:\n\n*   The **largest rewards** are reserved for correct _end-to-end_ solution quality.\n*   The **largest penalties** correspond only to errors that break execution (syntax, runtime failure).\n*   Small errors in timing, selection, or argument quality incur **light penalties**.\n*   Rewards across “when / which / how” are significantly **lower** than final-task success, ensuring shaping rewards guide early learning but final correctness dominates late learning.\n\n##### Worked Example with Asymmetric Rewards\n\n*   Consider the user query: “What’s the weather in Paris tomorrow?”\n    \n*   Correct behavior requires:\n    \n    1.  Deciding a tool is required (**when**).\n    2.  Selecting the weather API (**which**).\n    3.  Providing correct arguments in JSON (**how**).\n    4.  Producing the correct final answer using the tool output.\n*   Below are two trajectories demonstrating asymmetry.\n    \n\nConsider the user query: “What’s the weather in Paris tomorrow?”\n\nCorrect behavior requires:\n\n1.  Deciding a tool is required (**when**).\n2.  Selecting the weather API (**which**).\n3.  Providing correct arguments in JSON (**how**).\n4.  Producing the correct final answer using the tool output.\n\nBelow are two trajectories demonstrating asymmetry.\n\n###### Trajectory A: Imperfect but Reasonable Exploration\n\n1.  **When** decision correct →→\\\\rightarrow +1.0\n2.  **Which** tool wrong →→\\\\rightarrow −0.5\n3.  JSON syntax valid →→\\\\rightarrow +0.5\n4.  Tool executes (but irrelevant) →→\\\\rightarrow 0\n5.  Final answer wrong →→\\\\rightarrow −0.5\n\n*   Total reward:\n\nRA\\=1.0−0.5+0.5+0−0.5\\=0.5RA\\=1.0−0.5+0.5+0−0.5\\=0.5\n\n*   Even though the overall answer is wrong, the trajectory gets a _small positive_ reward because several subcomponents were correct. This prevents the model from concluding that tool use is too risky.\n\n###### Trajectory B: Full Correct Behavior\n\n1.  Correct **when** →→\\\\rightarrow +1.0\n2.  Correct **which** →→\\\\rightarrow +1.5\n3.  Correct JSON arguments →→\\\\rightarrow +1.0\n4.  Successful tool execution →→\\\\rightarrow +1.0\n5.  Correct final answer →→\\\\rightarrow +10.0\n\n*   Total reward:\n\nRB\\=1.0+1.5+1.0+1.0+10.0\\=14.5RB\\=1.0+1.5+1.0+1.0+10.0\\=14.5\n\n*   The tremendous difference between +14.5 and +0.5 clearly guides PPO/GRPO toward producing the full correct behavior.\n\n##### How Asymmetry Stabilizes PPO/GRPO\n\n*   Advantages are computed via:\n\nAt\\=Rt−V(st)At\\=Rt−V(st)\n\n*   With asymmetric rewards:\n    \n    *   Failed trajectories receive slightly negative or slightly positive returns.\n    *   Successful trajectories receive large positive returns.\n    *   Advantage variance stays manageable.\n    *   Exploration does not collapse into “never call tools.”\n    *   The policy improves steadily across “when / which / how” dimensions.\n*   If rewards were symmetric (e.g., +10 vs. −10), then most exploratory episodes would produce extreme negative advantages, instantly pushing the model toward refusing all tool calls. Asymmetry prevents this collapse.\n    \n\nWith asymmetric rewards:\n\n*   Failed trajectories receive slightly negative or slightly positive returns.\n*   Successful trajectories receive large positive returns.\n*   Advantage variance stays manageable.\n*   Exploration does not collapse into “never call tools.”\n*   The policy improves steadily across “when / which / how” dimensions.\n\nIf rewards were symmetric (e.g., +10 vs. −10), then most exploratory episodes would produce extreme negative advantages, instantly pushing the model toward refusing all tool calls. Asymmetry prevents this collapse.\n\n##### Takeaways\n\n*   Asymmetric rewards are essential for training LLM tool-calling policies because they:\n    \n    *   Preserve exploration.\n    *   Deliver stable gradients for PPO/GRPO.\n    *   Avoid trivial degenerate strategies.\n    *   Properly balance shaping rewards (for “when / which / how”) with outcome-level rewards.\n    *   Distinguish partial correctness from catastrophic failure.\n    *   Encourage correct final answers without over-penalizing small mistakes.\n*   The reward table and examples above provide a practical blueprint for implementing and tuning asymmetric rewards in your own RL tool-calling system.\n    \n\nAsymmetric rewards are essential for training LLM tool-calling policies because they:\n\n*   Preserve exploration.\n*   Deliver stable gradients for PPO/GRPO.\n*   Avoid trivial degenerate strategies.\n*   Properly balance shaping rewards (for “when / which / how”) with outcome-level rewards.\n*   Distinguish partial correctness from catastrophic failure.\n*   Encourage correct final answers without over-penalizing small mistakes.\n\nThe reward table and examples above provide a practical blueprint for implementing and tuning asymmetric rewards in your own RL tool-calling system.",
    "order": 5,
    "orderInChapter": 4,
    "difficulty": 3,
    "estimatedMinutes": 15,
    "tags": [
      "algorithmsarchitecture",
      "embedding",
      "gpt",
      "llm"
    ],
    "metadata": {
      "hasCode": true,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 2925,
      "contentLength": 161707
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#annotation-sources-for-reward-components-(“when”,-“which”,-and-“how”)",
    "scrapedAt": "2025-12-28T11:47:36.150Z"
  },
  {
    "id": "ai-agentic-RL-rl-optimization-pipeline-ppo-vs-dpo-vs-grpo-6",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Background: Teaching Agents Tool-Calling with RL",
    "title": "RL Optimization Pipeline: PPO vs. DPO vs. GRPO",
    "subtitle": "Background: Teaching Agents Tool-Calling with RL",
    "contentHtml": "<ul>\n  <li>This section describes how to take the unified reward from the <a href=\"https://aman.ai/primers/ai/RL-for-agents/#unified-reward-formulation\">Unified Reward Formulation</a> section and plug it into a full RL pipeline—including both Proximal Policy Optimization (PPO) by <a href=\"https://arxiv.org/abs/1707.06347\">Schulman et al., 2017</a> and Group Relative Policy Optimization (GRPO) by <a href=\"https://arxiv.org/abs/2402.03300\">Shao et al., 2024</a>. We present first the shared components, then algorithm‐specific losses and update rules.</li>\n  <li>A detailed discourse of preference optimization algorithms is available in the <a href=\"../preference-optimization\">Preference Optimization</a> primer.</li>\n</ul>\n<h4 id=\"shared-rl-training-flow\">Shared RL Training Flow</h4>\n<ol>\n  <li>\n    <p><strong>Rollout Generation</strong>:</p>\n\n    <ul>\n      <li>Use a parameterized decision rule <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-65-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-777\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-778\"><span class=\"msubsup\" id=\"MathJax-Span-779\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-780\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-781\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-65\">\\pi_\\theta</script> (e.g., instantiated by an LLM) to interact with the tool-calling environment defined in the <a href=\"#environment-mdp-formulation-and-action-space\">Environment, MDP Formulation, and Action Space</a> section.</li>\n      <li>At each step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-66-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-782\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-783\"><span class=\"mi\" id=\"MathJax-Span-784\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-66\">t</script>, given state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-67-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-785\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-786\"><span class=\"msubsup\" id=\"MathJax-Span-787\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-788\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-789\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-67\">s_t</script>, select an action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-68-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-790\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-791\"><span class=\"msubsup\" id=\"MathJax-Span-792\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-793\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-794\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-68\">a_t</script> (such as <code class=\"language-plaintext highlighter-rouge\">CALL</code> or <code class=\"language-plaintext highlighter-rouge\">ANSWER</code>), observe the next state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-69-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-795\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.51em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-796\"><span class=\"msubsup\" id=\"MathJax-Span-797\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-798\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-799\"><span class=\"mrow\" id=\"MathJax-Span-800\"><span class=\"mi\" id=\"MathJax-Span-801\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-802\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-803\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-69\">s_{t+1}</script>, and receive a scalar reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-70-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-804\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-805\"><span class=\"msubsup\" id=\"MathJax-Span-806\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-807\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-808\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-70\">r_t</script> from the unified reward signal.</li>\n      <li>Continue interaction until a terminal action (<code class=\"language-plaintext highlighter-rouge\">ANSWER</code>) is produced or a maximum horizon <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-71-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-809\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-810\"><span class=\"mi\" id=\"MathJax-Span-811\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>T</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-71\">T</script> is reached.</li>\n      <li>Collect trajectories of the form: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-72-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C4;</mi><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mn>0</mn></msub><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>,</mo><msub><mi>r</mi><mn>0</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>T</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-812\" style=\"width: 20.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 17.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1017.03em, 2.607em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-813\"><span class=\"mi\" id=\"MathJax-Span-814\" style=\"font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-815\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-816\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-817\"><span class=\"mo\" id=\"MathJax-Span-818\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-819\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-820\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-821\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-822\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-823\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-824\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-825\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-826\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-827\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-828\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-829\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-830\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-831\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-832\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">…</span><span class=\"mo\" id=\"MathJax-Span-833\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"mo\" id=\"MathJax-Span-834\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-835\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-836\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-837\"><span class=\"mrow\" id=\"MathJax-Span-838\"><span class=\"mi\" id=\"MathJax-Span-839\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-840\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-841\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-842\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-843\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-844\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-845\"><span class=\"mrow\" id=\"MathJax-Span-846\"><span class=\"mi\" id=\"MathJax-Span-847\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-848\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-849\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-850\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-851\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-852\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-853\"><span class=\"mrow\" id=\"MathJax-Span-854\"><span class=\"mi\" id=\"MathJax-Span-855\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-856\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-857\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-858\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-859\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-860\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-861\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-862\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-863\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-864\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>τ</mi><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>,</mo><msub><mi>r</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mo>…</mo><mo>,</mo><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>T</mi></msub><mo stretchy=\"false\">)</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-72\">\\tau = {(s_0,a_0,r_0),\\dots,(s_{T-1},a_{T-1},r_{T-1}), (s_T)}</script>.</li>\n      <li>Depending on the policy optimization method, this step may change substantially: PPO and GRPO rely on explicit on-policy rollouts from the environment, whereas DPO bypasses environment interaction entirely and instead constructs preference pairs from sampled candidate actions or completions under a fixed state.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Return and Advantage Estimation</strong>:</p>\n\n    <ul>\n      <li>\n        <p>Compute the discounted return from each timestep:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-73-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-865\" style=\"width: 7.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.263em, 1005.99em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-866\"><span class=\"msubsup\" id=\"MathJax-Span-867\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-868\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-869\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-870\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-871\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-872\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.159em;\"><span class=\"texatom\" id=\"MathJax-Span-873\"><span class=\"mrow\" id=\"MathJax-Span-874\"><span class=\"mi\" id=\"MathJax-Span-875\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-876\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mi\" id=\"MathJax-Span-877\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-878\"><span class=\"mrow\" id=\"MathJax-Span-879\"><span class=\"mi\" id=\"MathJax-Span-880\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-881\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-882\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-883\"><span class=\"mrow\" id=\"MathJax-Span-884\"><span class=\"mi\" id=\"MathJax-Span-885\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-886\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mi\" id=\"MathJax-Span-887\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-888\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-889\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-890\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi></mrow></munderover><msup><mi>γ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>−</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-73\">R_t = \\sum_{k=t}^{T} \\gamma^{k-t} r_k</script>\n      </li>\n      <li>\n        <p>Use a learned value model (critic) <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-74-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-891\" style=\"width: 3.023em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.503em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.45em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-892\"><span class=\"msubsup\" id=\"MathJax-Span-893\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-894\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-895\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-896\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-897\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-898\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-899\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-900\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-74\">V_\\psi(s_t)</script> to approximate the expected return from state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-75-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-901\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-902\"><span class=\"msubsup\" id=\"MathJax-Span-903\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-904\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-905\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-75\">s_t</script>, serving as a baseline for variance reduction. In alternative setups, statistics may be computed relative to other trajectories collected under the same conditions.</p>\n      </li>\n      <li>\n        <p>For PPO, explicit return and advantage estimates are required; for GRPO, advantages are derived from relative statistics within groups of actions; for DPO, this entire step is omitted, as no returns, advantages, or value estimates are computed.</p>\n\n        <ul>\n          <li>\n            <p>A generic advantage signal can be formed as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-76-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-906\" style=\"width: 7.919em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.565em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1006.51em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-907\"><span class=\"msubsup\" id=\"MathJax-Span-908\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-909\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-910\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-911\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-912\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-913\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-914\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-915\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-916\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-917\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-918\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-919\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-920\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-921\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-922\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-923\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><mo>−</mo><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-76\">A_t = R_t - V_\\psi(s_t)</script>\n          </li>\n          <li>\n            <p>If multi-step or exponentially weighted estimates are desired, advantages can be computed using temporal-difference residuals derived from the critic:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-77-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>A</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03BB;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B3;</mi><mi>&amp;#x03BB;</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mi>l</mi></msup><msub><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>l</mi></mrow></msub><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-924\" style=\"width: 24.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.159em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.419em, 1020.11em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-925\"><span class=\"msubsup\" id=\"MathJax-Span-926\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-927\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-928\"><span class=\"mrow\" id=\"MathJax-Span-929\"><span class=\"mo\" id=\"MathJax-Span-930\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-931\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">λ</span><span class=\"mo\" id=\"MathJax-Span-932\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-933\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-934\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-935\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-936\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-937\"><span class=\"mrow\" id=\"MathJax-Span-938\"><span class=\"mi\" id=\"MathJax-Span-939\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-940\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-941\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-942\"><span class=\"mrow\" id=\"MathJax-Span-943\"><span class=\"mi\" id=\"MathJax-Span-944\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∞</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-945\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-946\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-947\" style=\"font-family: STIXGeneral-Italic;\">λ</span><span class=\"msubsup\" id=\"MathJax-Span-948\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-949\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-950\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-951\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-952\" style=\"font-family: STIXGeneral-Italic;\">δ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-953\"><span class=\"mrow\" id=\"MathJax-Span-954\"><span class=\"mi\" id=\"MathJax-Span-955\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-956\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-957\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-958\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-959\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-960\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-961\" style=\"font-family: STIXGeneral-Italic;\">δ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-962\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-963\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-964\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-965\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-966\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-967\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-968\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-969\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-970\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-971\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-972\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-973\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-974\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-975\"><span class=\"mrow\" id=\"MathJax-Span-976\"><span class=\"mi\" id=\"MathJax-Span-977\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-978\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-979\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-980\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-981\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-982\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-983\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-984\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-985\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-986\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-987\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-988\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-989\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>A</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>λ</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">∞</mi></mrow></munderover><mo stretchy=\"false\">(</mo><mi>γ</mi><mi>λ</mi><msup><mo stretchy=\"false\">)</mo><mi>l</mi></msup><msub><mi>δ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>l</mi></mrow></msub><mo>,</mo><mspace width=\"1em\"></mspace><msub><mi>δ</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>γ</mi><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-77\">A_t^{(\\lambda)} = \\sum_{l=0}^{\\infty} (\\gamma\\lambda)^l \\delta_{t+l},\n\\quad \\delta_t = r_t + \\gamma V_\\psi(s_{t+1}) - V_\\psi(s_t)</script>\n          </li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Policy Update</strong>:</p>\n\n    <ul>\n      <li>Update the parameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-78-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-990\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-991\"><span class=\"mi\" id=\"MathJax-Span-992\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>θ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-78\">\\theta</script> using a surrogate objective constructed from collected advantages and action likelihoods.</li>\n      <li>Update the value model parameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-79-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-993\" style=\"width: 1.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.84em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-994\"><span class=\"mi\" id=\"MathJax-Span-995\" style=\"font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.107em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>ψ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-79\">\\psi</script> to better fit observed returns or temporal-difference targets when a critic is present.</li>\n      <li>Optionally apply regularization terms, trust-region constraints, or divergence penalties to encourage stable updates.</li>\n      <li>The specific loss used here depends on the optimization method: PPO applies a clipped surrogate with an explicit value loss, DPO optimizes a preference-based classification objective against a reference policy, and GRPO uses group-normalized advantages without a learned value model.</li>\n      <li>In practice, updates are performed in batches by aggregating multiple trajectories or timesteps into a training batch, optionally shuffling them, and applying one or more optimization steps per batch. For large models, this commonly involves mini-batching, gradient accumulation, and synchronizing updates across parallel workers.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Repeat</strong>:</p>\n\n    <ul>\n      <li>Iterate between rollout collection and parameter updates when applicable.</li>\n      <li>Periodically evaluate performance, tracking metrics such as tool-use timing (“when”), tool choice (“which”), argument correctness (“how”), and overall task success.</li>\n    </ul>\n  </li>\n</ol>\n<p><strong>Rollout Generation</strong>:</p>\n<ul>\n      <li>Use a parameterized decision rule <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-65-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-777\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-778\"><span class=\"msubsup\" id=\"MathJax-Span-779\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-780\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-781\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-65\">\\pi_\\theta</script> (e.g., instantiated by an LLM) to interact with the tool-calling environment defined in the <a href=\"#environment-mdp-formulation-and-action-space\">Environment, MDP Formulation, and Action Space</a> section.</li>\n      <li>At each step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-66-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-782\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-783\"><span class=\"mi\" id=\"MathJax-Span-784\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-66\">t</script>, given state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-67-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-785\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-786\"><span class=\"msubsup\" id=\"MathJax-Span-787\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-788\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-789\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-67\">s_t</script>, select an action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-68-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-790\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-791\"><span class=\"msubsup\" id=\"MathJax-Span-792\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-793\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-794\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-68\">a_t</script> (such as <code class=\"language-plaintext highlighter-rouge\">CALL</code> or <code class=\"language-plaintext highlighter-rouge\">ANSWER</code>), observe the next state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-69-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-795\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.51em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-796\"><span class=\"msubsup\" id=\"MathJax-Span-797\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-798\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-799\"><span class=\"mrow\" id=\"MathJax-Span-800\"><span class=\"mi\" id=\"MathJax-Span-801\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-802\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-803\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-69\">s_{t+1}</script>, and receive a scalar reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-70-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-804\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-805\"><span class=\"msubsup\" id=\"MathJax-Span-806\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-807\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-808\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-70\">r_t</script> from the unified reward signal.</li>\n      <li>Continue interaction until a terminal action (<code class=\"language-plaintext highlighter-rouge\">ANSWER</code>) is produced or a maximum horizon <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-71-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-809\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-810\"><span class=\"mi\" id=\"MathJax-Span-811\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>T</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-71\">T</script> is reached.</li>\n      <li>Collect trajectories of the form: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-72-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C4;</mi><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mn>0</mn></msub><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>,</mo><msub><mi>r</mi><mn>0</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>T</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-812\" style=\"width: 20.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 17.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1017.03em, 2.607em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-813\"><span class=\"mi\" id=\"MathJax-Span-814\" style=\"font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-815\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-816\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-817\"><span class=\"mo\" id=\"MathJax-Span-818\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-819\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-820\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-821\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-822\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-823\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-824\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-825\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-826\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-827\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-828\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-829\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-830\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-831\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-832\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">…</span><span class=\"mo\" id=\"MathJax-Span-833\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"mo\" id=\"MathJax-Span-834\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-835\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-836\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-837\"><span class=\"mrow\" id=\"MathJax-Span-838\"><span class=\"mi\" id=\"MathJax-Span-839\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-840\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-841\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-842\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-843\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-844\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-845\"><span class=\"mrow\" id=\"MathJax-Span-846\"><span class=\"mi\" id=\"MathJax-Span-847\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-848\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-849\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-850\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-851\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-852\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-853\"><span class=\"mrow\" id=\"MathJax-Span-854\"><span class=\"mi\" id=\"MathJax-Span-855\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-856\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-857\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-858\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-859\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-860\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-861\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-862\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-863\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-864\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>τ</mi><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>,</mo><msub><mi>r</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mo>…</mo><mo>,</mo><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>T</mi></msub><mo stretchy=\"false\">)</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-72\">\\tau = {(s_0,a_0,r_0),\\dots,(s_{T-1},a_{T-1},r_{T-1}), (s_T)}</script>.</li>\n      <li>Depending on the policy optimization method, this step may change substantially: PPO and GRPO rely on explicit on-policy rollouts from the environment, whereas DPO bypasses environment interaction entirely and instead constructs preference pairs from sampled candidate actions or completions under a fixed state.</li>\n    </ul>\n<p><strong>Return and Advantage Estimation</strong>:</p>\n<ul>\n      <li>\n        <p>Compute the discounted return from each timestep:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-73-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-865\" style=\"width: 7.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.263em, 1005.99em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-866\"><span class=\"msubsup\" id=\"MathJax-Span-867\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-868\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-869\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-870\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-871\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-872\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.159em;\"><span class=\"texatom\" id=\"MathJax-Span-873\"><span class=\"mrow\" id=\"MathJax-Span-874\"><span class=\"mi\" id=\"MathJax-Span-875\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-876\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mi\" id=\"MathJax-Span-877\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-878\"><span class=\"mrow\" id=\"MathJax-Span-879\"><span class=\"mi\" id=\"MathJax-Span-880\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-881\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-882\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-883\"><span class=\"mrow\" id=\"MathJax-Span-884\"><span class=\"mi\" id=\"MathJax-Span-885\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-886\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mi\" id=\"MathJax-Span-887\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-888\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-889\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-890\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi></mrow></munderover><msup><mi>γ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>−</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-73\">R_t = \\sum_{k=t}^{T} \\gamma^{k-t} r_k</script>\n      </li>\n      <li>\n        <p>Use a learned value model (critic) <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-74-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-891\" style=\"width: 3.023em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.503em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.45em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-892\"><span class=\"msubsup\" id=\"MathJax-Span-893\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-894\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-895\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-896\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-897\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-898\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-899\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-900\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-74\">V_\\psi(s_t)</script> to approximate the expected return from state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-75-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-901\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-902\"><span class=\"msubsup\" id=\"MathJax-Span-903\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-904\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-905\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-75\">s_t</script>, serving as a baseline for variance reduction. In alternative setups, statistics may be computed relative to other trajectories collected under the same conditions.</p>\n      </li>\n      <li>\n        <p>For PPO, explicit return and advantage estimates are required; for GRPO, advantages are derived from relative statistics within groups of actions; for DPO, this entire step is omitted, as no returns, advantages, or value estimates are computed.</p>\n\n        <ul>\n          <li>\n            <p>A generic advantage signal can be formed as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-76-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-906\" style=\"width: 7.919em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.565em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1006.51em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-907\"><span class=\"msubsup\" id=\"MathJax-Span-908\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-909\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-910\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-911\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-912\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-913\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-914\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-915\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-916\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-917\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-918\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-919\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-920\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-921\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-922\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-923\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><mo>−</mo><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-76\">A_t = R_t - V_\\psi(s_t)</script>\n          </li>\n          <li>\n            <p>If multi-step or exponentially weighted estimates are desired, advantages can be computed using temporal-difference residuals derived from the critic:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-77-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>A</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03BB;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B3;</mi><mi>&amp;#x03BB;</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mi>l</mi></msup><msub><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>l</mi></mrow></msub><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-924\" style=\"width: 24.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.159em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.419em, 1020.11em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-925\"><span class=\"msubsup\" id=\"MathJax-Span-926\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-927\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-928\"><span class=\"mrow\" id=\"MathJax-Span-929\"><span class=\"mo\" id=\"MathJax-Span-930\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-931\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">λ</span><span class=\"mo\" id=\"MathJax-Span-932\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-933\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-934\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-935\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-936\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-937\"><span class=\"mrow\" id=\"MathJax-Span-938\"><span class=\"mi\" id=\"MathJax-Span-939\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-940\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-941\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-942\"><span class=\"mrow\" id=\"MathJax-Span-943\"><span class=\"mi\" id=\"MathJax-Span-944\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∞</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-945\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-946\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-947\" style=\"font-family: STIXGeneral-Italic;\">λ</span><span class=\"msubsup\" id=\"MathJax-Span-948\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-949\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-950\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-951\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-952\" style=\"font-family: STIXGeneral-Italic;\">δ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-953\"><span class=\"mrow\" id=\"MathJax-Span-954\"><span class=\"mi\" id=\"MathJax-Span-955\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-956\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-957\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-958\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-959\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-960\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-961\" style=\"font-family: STIXGeneral-Italic;\">δ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-962\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-963\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-964\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-965\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-966\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-967\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-968\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-969\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-970\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-971\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-972\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-973\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-974\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-975\"><span class=\"mrow\" id=\"MathJax-Span-976\"><span class=\"mi\" id=\"MathJax-Span-977\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-978\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-979\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-980\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-981\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-982\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-983\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-984\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-985\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-986\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-987\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-988\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-989\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>A</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>λ</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">∞</mi></mrow></munderover><mo stretchy=\"false\">(</mo><mi>γ</mi><mi>λ</mi><msup><mo stretchy=\"false\">)</mo><mi>l</mi></msup><msub><mi>δ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>l</mi></mrow></msub><mo>,</mo><mspace width=\"1em\"></mspace><msub><mi>δ</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>γ</mi><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-77\">A_t^{(\\lambda)} = \\sum_{l=0}^{\\infty} (\\gamma\\lambda)^l \\delta_{t+l},\n\\quad \\delta_t = r_t + \\gamma V_\\psi(s_{t+1}) - V_\\psi(s_t)</script>\n          </li>\n        </ul>\n      </li>\n    </ul>\n<p>Compute the discounted return from each timestep:</p>\n<p>Use a learned value model (critic) <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-74-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-891\" style=\"width: 3.023em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.503em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.45em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-892\"><span class=\"msubsup\" id=\"MathJax-Span-893\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-894\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-895\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-896\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-897\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-898\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-899\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-900\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-74\">V_\\psi(s_t)</script> to approximate the expected return from state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-75-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-901\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-902\"><span class=\"msubsup\" id=\"MathJax-Span-903\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-904\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-905\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-75\">s_t</script>, serving as a baseline for variance reduction. In alternative setups, statistics may be computed relative to other trajectories collected under the same conditions.</p>\n<p>For PPO, explicit return and advantage estimates are required; for GRPO, advantages are derived from relative statistics within groups of actions; for DPO, this entire step is omitted, as no returns, advantages, or value estimates are computed.</p>\n<ul>\n          <li>\n            <p>A generic advantage signal can be formed as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-76-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-906\" style=\"width: 7.919em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.565em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1006.51em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-907\"><span class=\"msubsup\" id=\"MathJax-Span-908\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-909\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-910\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-911\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-912\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-913\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-914\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-915\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-916\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-917\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-918\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-919\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-920\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-921\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-922\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-923\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><mo>−</mo><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-76\">A_t = R_t - V_\\psi(s_t)</script>\n          </li>\n          <li>\n            <p>If multi-step or exponentially weighted estimates are desired, advantages can be computed using temporal-difference residuals derived from the critic:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-77-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>A</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03BB;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B3;</mi><mi>&amp;#x03BB;</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mi>l</mi></msup><msub><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>l</mi></mrow></msub><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-924\" style=\"width: 24.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.159em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.419em, 1020.11em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-925\"><span class=\"msubsup\" id=\"MathJax-Span-926\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-927\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-928\"><span class=\"mrow\" id=\"MathJax-Span-929\"><span class=\"mo\" id=\"MathJax-Span-930\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-931\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">λ</span><span class=\"mo\" id=\"MathJax-Span-932\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-933\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-934\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-935\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-936\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-937\"><span class=\"mrow\" id=\"MathJax-Span-938\"><span class=\"mi\" id=\"MathJax-Span-939\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-940\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-941\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-942\"><span class=\"mrow\" id=\"MathJax-Span-943\"><span class=\"mi\" id=\"MathJax-Span-944\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∞</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-945\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-946\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-947\" style=\"font-family: STIXGeneral-Italic;\">λ</span><span class=\"msubsup\" id=\"MathJax-Span-948\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-949\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-950\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-951\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-952\" style=\"font-family: STIXGeneral-Italic;\">δ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-953\"><span class=\"mrow\" id=\"MathJax-Span-954\"><span class=\"mi\" id=\"MathJax-Span-955\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-956\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-957\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-958\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-959\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-960\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-961\" style=\"font-family: STIXGeneral-Italic;\">δ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-962\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-963\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-964\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-965\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-966\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-967\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-968\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-969\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-970\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-971\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-972\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-973\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-974\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-975\"><span class=\"mrow\" id=\"MathJax-Span-976\"><span class=\"mi\" id=\"MathJax-Span-977\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-978\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-979\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-980\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-981\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-982\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-983\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-984\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-985\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-986\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-987\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-988\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-989\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>A</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>λ</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">∞</mi></mrow></munderover><mo stretchy=\"false\">(</mo><mi>γ</mi><mi>λ</mi><msup><mo stretchy=\"false\">)</mo><mi>l</mi></msup><msub><mi>δ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>l</mi></mrow></msub><mo>,</mo><mspace width=\"1em\"></mspace><msub><mi>δ</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>γ</mi><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-77\">A_t^{(\\lambda)} = \\sum_{l=0}^{\\infty} (\\gamma\\lambda)^l \\delta_{t+l},\n\\quad \\delta_t = r_t + \\gamma V_\\psi(s_{t+1}) - V_\\psi(s_t)</script>\n          </li>\n        </ul>\n<p>A generic advantage signal can be formed as:</p>\n<p>If multi-step or exponentially weighted estimates are desired, advantages can be computed using temporal-difference residuals derived from the critic:</p>\n<p><strong>Policy Update</strong>:</p>\n<ul>\n      <li>Update the parameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-78-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-990\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-991\"><span class=\"mi\" id=\"MathJax-Span-992\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>θ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-78\">\\theta</script> using a surrogate objective constructed from collected advantages and action likelihoods.</li>\n      <li>Update the value model parameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-79-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-993\" style=\"width: 1.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.84em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-994\"><span class=\"mi\" id=\"MathJax-Span-995\" style=\"font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.107em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>ψ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-79\">\\psi</script> to better fit observed returns or temporal-difference targets when a critic is present.</li>\n      <li>Optionally apply regularization terms, trust-region constraints, or divergence penalties to encourage stable updates.</li>\n      <li>The specific loss used here depends on the optimization method: PPO applies a clipped surrogate with an explicit value loss, DPO optimizes a preference-based classification objective against a reference policy, and GRPO uses group-normalized advantages without a learned value model.</li>\n      <li>In practice, updates are performed in batches by aggregating multiple trajectories or timesteps into a training batch, optionally shuffling them, and applying one or more optimization steps per batch. For large models, this commonly involves mini-batching, gradient accumulation, and synchronizing updates across parallel workers.</li>\n    </ul>\n<p><strong>Repeat</strong>:</p>\n<ul>\n      <li>Iterate between rollout collection and parameter updates when applicable.</li>\n      <li>Periodically evaluate performance, tracking metrics such as tool-use timing (“when”), tool choice (“which”), argument correctness (“how”), and overall task success.</li>\n    </ul>\n<h4 id=\"common-policy-optimization-choices\">Common Policy Optimization Choices</h4>\n<ul>\n  <li>A widely used class of approaches builds on proximal policy updates that constrain each optimization step to remain close to the previous policy, improving stability when training large language models as agents. A canonical example is Proximal Policy Optimization (PPO), introduced in <a href=\"https://arxiv.org/abs/1707.06347\">Proximal Policy Optimization Algorithms</a> by Schulman et al. (2017), which combines advantage-weighted updates with explicit mechanisms to limit destructive policy shifts.</li>\n  <li>Subsequently, preference-based formulations such as Direct Preference Optimization (DPO), proposed in <a href=\"https://arxiv.org/abs/2305.18290\">Direct Preference Optimization: Your Language Model is Secretly a Reward Model</a> by Rafailov et al. (2023), replaced explicit reward modeling with relative comparisons, a pattern that has proven especially effective for aligning agent behaviors with human judgments.</li>\n  <li>More recent agentic RL systems increasingly rely on group-relative objectives that normalize rewards or advantages across sets of trajectories, reducing sensitivity to reward scale and long-horizon variance. Group Relative Policy Optimization (GRPO), introduced in <a href=\"https://arxiv.org/abs/2402.03300\">DeepSeekMath: Pushing the Limits of Mathematical Reasoning in Open Language Models\n</a> by Shao et al. (2024), has been adopted as a strong baseline for tool-using and reasoning agents. Follow-up variants, for instance DAPO proposed in <a href=\"https://arxiv.org/abs/2503.14476\">DAPO: An Open-Source LLM Reinforcement Learning System at Scale</a> by Yu et al. (2025) and <a href=\"https://pretty-radio-b75.notion.site/DeepCoder-A-Fully-Open-Source-14B-Coder-at-O3-mini-Level-1cf81902c14680b3bee5eb349a512a51\">GRPO+</a> extend group-relative normalization with improved baselines, dynamic grouping, or more stable update rules, as explored in works such  and subsequent technical reports and open-source implementations. These methods are increasingly favored in agentic RL because they better handle sparse rewards, heterogeneous trajectories, and multi-step tool use without relying on brittle reward shaping.</li>\n</ul>\n<h4 id=\"ppo-losses-and-update-rules\">PPO: Losses and Update Rules</h4>\n<h5 id=\"surrogate-objective\">Surrogate Objective</h5>\n<ul>\n  <li>Proximal Policy Optimization (PPO), introduced in <a href=\"https://arxiv.org/abs/1707.06347\">Proximal Policy Optimization Algorithms</a> by Schulman et al. (2017), optimizes a clipped surrogate objective that constrains policy updates to remain close to the previous policy. The most commonly used objective is the clipped surrogate:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-80-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>C</mi><mi mathvariant=&quot;normal&quot;>L</mi><mi mathvariant=&quot;normal&quot;>I</mi><mi mathvariant=&quot;normal&quot;>P</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>d</mi></mrow></msub></mrow></msub></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>[</mo></mrow><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi>A</mi><mi>t</mi></msub><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>p</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03F5;</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>&amp;#x03F5;</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi>A</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-996\" style=\"width: 30.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 25.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.138em, 1025.21em, 4.326em, -999.997em); top: -3.487em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-997\"><span class=\"msubsup\" id=\"MathJax-Span-998\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-999\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1000\"><span class=\"mrow\" id=\"MathJax-Span-1001\"><span class=\"mi\" id=\"MathJax-Span-1002\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">C</span><span class=\"mi\" id=\"MathJax-Span-1003\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span><span class=\"mi\" id=\"MathJax-Span-1004\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">I</span><span class=\"mi\" id=\"MathJax-Span-1005\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1006\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1007\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1008\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1009\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-1010\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.701em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-1011\"><span class=\"mrow\" id=\"MathJax-Span-1012\"><span class=\"mi\" id=\"MathJax-Span-1013\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1014\"><span class=\"mrow\" id=\"MathJax-Span-1015\"><span class=\"msubsup\" id=\"MathJax-Span-1016\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1017\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-1018\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1019\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1020\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1021\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1022\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1023\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"msubsup\" id=\"MathJax-Span-1024\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1025\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1026\"><span class=\"mrow\" id=\"MathJax-Span-1027\"><span class=\"msubsup\" id=\"MathJax-Span-1028\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1029\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-1030\"><span class=\"mrow\" id=\"MathJax-Span-1031\"><span class=\"mi\" id=\"MathJax-Span-1032\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-1033\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-1034\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">d</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1035\"><span class=\"mrow\" id=\"MathJax-Span-1036\"><span class=\"mo\" id=\"MathJax-Span-1037\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">[</span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1038\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">min</span><span class=\"texatom\" id=\"MathJax-Span-1039\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-1040\"><span class=\"mo\" id=\"MathJax-Span-1041\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1042\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1043\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1044\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1045\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1046\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1047\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-1048\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1049\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1050\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1051\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-1052\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-1053\"><span class=\"mi\" id=\"MathJax-Span-1054\" style=\"font-family: STIXGeneral-Regular;\">c</span><span class=\"mi\" id=\"MathJax-Span-1055\" style=\"font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-1056\" style=\"font-family: STIXGeneral-Regular;\">i</span><span class=\"mi\" id=\"MathJax-Span-1057\" style=\"font-family: STIXGeneral-Regular;\">p</span></span></span><span class=\"mo\" id=\"MathJax-Span-1058\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1059\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1060\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1061\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1062\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1063\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1064\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1065\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-1066\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-1067\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-1068\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">ϵ</span><span class=\"mo\" id=\"MathJax-Span-1069\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-1070\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-1071\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1072\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">ϵ</span><span class=\"mo\" id=\"MathJax-Span-1073\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-1074\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1075\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1076\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1077\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-1078\"><span class=\"mo\" id=\"MathJax-Span-1079\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1080\"><span class=\"mrow\" id=\"MathJax-Span-1081\"><span class=\"mo\" id=\"MathJax-Span-1082\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">]</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.492em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">C</mi><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">I</mi><mi mathvariant=\"normal\">P</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>∼</mo><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">d</mi></mrow></msub></mrow></msub></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">[</mo></mrow><mo movablelimits=\"true\" form=\"prefix\">min</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><msub><mi>A</mi><mi>t</mi></msub><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">c</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">p</mi></mrow><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mn>1</mn><mo>−</mo><mi>ϵ</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>ϵ</mi><mo stretchy=\"false\">)</mo><msub><mi>A</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">]</mo></mrow></math></span></span></div>\n<ul>\n  <li>… where the importance sampling ratio is:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-81-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>d</mi></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1083\" style=\"width: 9.69em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.076em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.68em, 1008.08em, 3.284em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1084\"><span class=\"msubsup\" id=\"MathJax-Span-1085\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1086\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1087\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1088\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1089\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1090\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1091\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-1092\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.742em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.91em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.977em;\"><span class=\"mrow\" id=\"MathJax-Span-1093\"><span class=\"msubsup\" id=\"MathJax-Span-1094\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1095\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1096\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1097\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1098\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1099\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1100\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1101\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"msubsup\" id=\"MathJax-Span-1102\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1103\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1104\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1105\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1004.59em, 4.43em, -999.997em); top: -3.331em; left: 50%; margin-left: -2.289em;\"><span class=\"mrow\" id=\"MathJax-Span-1106\"><span class=\"msubsup\" id=\"MathJax-Span-1107\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1108\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1109\"><span class=\"mrow\" id=\"MathJax-Span-1110\"><span class=\"msubsup\" id=\"MathJax-Span-1111\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1112\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1113\"><span class=\"mrow\" id=\"MathJax-Span-1114\"><span class=\"mi\" id=\"MathJax-Span-1115\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-1116\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-1117\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">d</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1118\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1119\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1120\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1121\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1122\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"msubsup\" id=\"MathJax-Span-1123\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1124\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1125\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1126\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.74em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.742em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.184em; border-left: 0px solid; width: 0px; height: 2.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">d</mi></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span></div>\n<ul>\n  <li>… and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-82-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi><mo>&amp;#x2248;</mo><mn>0.1</mn><mtext>&amp;#x2013;</mtext><mn>0.3</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1127\" style=\"width: 5.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.586em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.53em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1128\"><span class=\"mi\" id=\"MathJax-Span-1129\" style=\"font-family: STIXGeneral-Italic;\">ϵ</span><span class=\"mo\" id=\"MathJax-Span-1130\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">≈</span><span class=\"mn\" id=\"MathJax-Span-1131\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0.1</span><span class=\"mtext\" id=\"MathJax-Span-1132\" style=\"font-family: STIXGeneral-Regular;\">–</span><span class=\"mn\" id=\"MathJax-Span-1133\" style=\"font-family: STIXGeneral-Regular;\">0.3</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>ϵ</mi><mo>≈</mo><mn>0.1</mn><mtext>–</mtext><mn>0.3</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-82\">\\epsilon \\approx 0.1\\text{–}0.3</script> controls the trust region implicitly.</li>\n</ul>\n<h5 id=\"value-loss\">Value Loss</h5>\n<ul>\n  <li>PPO is typically implemented in an actor–critic setting, where a learned value model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-83-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1134\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1135\"><span class=\"msubsup\" id=\"MathJax-Span-1136\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1137\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1138\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>ψ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-83\">V_\\psi</script> is trained jointly with the policy:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-84-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>v</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>e</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mi>t</mi></msub><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>d</mi></mrow></msub></mrow></msub></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>R</mi><mi>t</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1139\" style=\"width: 17.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.273em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1014.07em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1140\"><span class=\"msubsup\" id=\"MathJax-Span-1141\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1142\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-1143\"><span class=\"mrow\" id=\"MathJax-Span-1144\"><span class=\"mi\" id=\"MathJax-Span-1145\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">v</span><span class=\"mi\" id=\"MathJax-Span-1146\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">a</span><span class=\"mi\" id=\"MathJax-Span-1147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-1148\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">u</span><span class=\"mi\" id=\"MathJax-Span-1149\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1150\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1151\" style=\"font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.107em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1152\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1153\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-1154\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-1155\"><span class=\"mrow\" id=\"MathJax-Span-1156\"><span class=\"mi\" id=\"MathJax-Span-1157\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1158\"><span class=\"mrow\" id=\"MathJax-Span-1159\"><span class=\"msubsup\" id=\"MathJax-Span-1160\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1161\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-1162\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1163\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"msubsup\" id=\"MathJax-Span-1164\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1165\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1166\"><span class=\"mrow\" id=\"MathJax-Span-1167\"><span class=\"msubsup\" id=\"MathJax-Span-1168\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1169\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-1170\"><span class=\"mrow\" id=\"MathJax-Span-1171\"><span class=\"mi\" id=\"MathJax-Span-1172\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-1173\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-1174\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">d</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1175\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-1176\"><span class=\"mo\" id=\"MathJax-Span-1177\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1178\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1179\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1180\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1181\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1182\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1183\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1184\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1185\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1186\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1187\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-1188\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1189\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1190\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1191\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1192\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.315em;\"><span class=\"mn\" id=\"MathJax-Span-1193\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1194\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-1195\"><span class=\"mo\" id=\"MathJax-Span-1196\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">v</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">u</mi><mi mathvariant=\"normal\">e</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>ψ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>s</mi><mi>t</mi></msub><mo>∼</mo><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">d</mi></mrow></msub></mrow></msub></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mo stretchy=\"false\">(</mo><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>R</mi><mi>t</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span></div>\n<h5 id=\"kl-regularization-in-practice\">KL Regularization in Practice</h5>\n<ul>\n  <li>\n    <p>In the original PPO formulation proposed in <a href=\"https://arxiv.org/abs/1707.06347\">Proximal Policy Optimization Algorithms</a> by Schulman et al. (2017), the KL divergence is <strong>not</strong> added directly to the clipped objective. Instead:</p>\n\n    <ul>\n      <li>The clipped objective <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-85-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>C</mi><mi mathvariant=&quot;normal&quot;>L</mi><mi mathvariant=&quot;normal&quot;>I</mi><mi mathvariant=&quot;normal&quot;>P</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1197\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1002.24em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1198\"><span class=\"msubsup\" id=\"MathJax-Span-1199\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1200\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1201\"><span class=\"mrow\" id=\"MathJax-Span-1202\"><span class=\"mi\" id=\"MathJax-Span-1203\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">C</span><span class=\"mi\" id=\"MathJax-Span-1204\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span><span class=\"mi\" id=\"MathJax-Span-1205\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">I</span><span class=\"mi\" id=\"MathJax-Span-1206\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">C</mi><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">I</mi><mi mathvariant=\"normal\">P</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-85\">L^{\\rm CLIP}</script> serves as the primary mechanism for constraining policy updates, and</li>\n      <li>The KL divergence is monitored as a diagnostic, optionally triggering early stopping.</li>\n    </ul>\n  </li>\n  <li>\n    <p><a href=\"https://arxiv.org/abs/1707.06347\">Proximal Policy Optimization Algorithms</a> also proposes an alternative objective, often referred to as the KL-penalized form:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-86-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi><mi mathvariant=&quot;normal&quot;>P</mi><mi mathvariant=&quot;normal&quot;>E</mi><mi mathvariant=&quot;normal&quot;>N</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi>A</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><mi>&amp;#x03B2;</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>d</mi></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1207\" style=\"width: 27.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 22.555em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1022.35em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1208\"><span class=\"msubsup\" id=\"MathJax-Span-1209\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1210\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1211\"><span class=\"mrow\" id=\"MathJax-Span-1212\"><span class=\"mi\" id=\"MathJax-Span-1213\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1214\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span><span class=\"mi\" id=\"MathJax-Span-1215\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span><span class=\"mi\" id=\"MathJax-Span-1216\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">E</span><span class=\"mi\" id=\"MathJax-Span-1217\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">N</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1218\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1219\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1220\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1221\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-1222\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-1223\"><span class=\"mrow\" id=\"MathJax-Span-1224\"><span class=\"mi\" id=\"MathJax-Span-1225\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1226\"><span class=\"mrow\" id=\"MathJax-Span-1227\"><span class=\"msubsup\" id=\"MathJax-Span-1228\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1229\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-1230\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1231\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1232\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1233\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1234\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1235\"><span class=\"mrow\" id=\"MathJax-Span-1236\"><span class=\"mo\" id=\"MathJax-Span-1237\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1238\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1239\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1240\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1241\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1242\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1243\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-1244\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1245\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1246\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1247\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-1248\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1249\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-1250\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-1251\"><span class=\"mi\" id=\"MathJax-Span-1252\" style=\"font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1253\" style=\"font-family: STIXGeneral-Regular;\">L</span></span></span><span class=\"texatom\" id=\"MathJax-Span-1254\"><span class=\"mrow\" id=\"MathJax-Span-1255\"><span class=\"mo\" id=\"MathJax-Span-1256\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1257\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1258\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1259\"><span class=\"mrow\" id=\"MathJax-Span-1260\"><span class=\"msubsup\" id=\"MathJax-Span-1261\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1262\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1263\"><span class=\"mrow\" id=\"MathJax-Span-1264\"><span class=\"mi\" id=\"MathJax-Span-1265\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-1266\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-1267\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">d</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1268\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-1269\" style=\"font-family: STIXGeneral-Regular;\">⋅</span><span class=\"texatom\" id=\"MathJax-Span-1270\"><span class=\"mrow\" id=\"MathJax-Span-1271\"><span class=\"mo\" id=\"MathJax-Span-1272\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1273\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1274\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1275\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1276\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-1277\"><span class=\"mrow\" id=\"MathJax-Span-1278\"><span class=\"mo\" id=\"MathJax-Span-1279\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1280\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1281\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1282\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1283\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-1284\" style=\"font-family: STIXGeneral-Regular;\">⋅</span><span class=\"texatom\" id=\"MathJax-Span-1285\"><span class=\"mrow\" id=\"MathJax-Span-1286\"><span class=\"mo\" id=\"MathJax-Span-1287\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1288\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1289\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1290\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1291\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-1292\"><span class=\"mrow\" id=\"MathJax-Span-1293\"><span class=\"mo\" id=\"MathJax-Span-1294\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1295\"><span class=\"mrow\" id=\"MathJax-Span-1296\"><span class=\"mo\" id=\"MathJax-Span-1297\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">E</mi><mi mathvariant=\"normal\">N</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><msub><mi>A</mi><mi>t</mi></msub><mo>−</mo><mi>β</mi><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">d</mi></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><mo>⋅</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mo>⋅</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-86\">L^{\\rm KLPEN}(\\theta)\n=\\mathbb{E}_{s_t,a_t}\n\\big[\nr_t(\\theta)A_t - \\beta,\\mathrm{KL}\\big(\\pi_{\\theta_{\\rm old}}(\\cdot|s_t) | \\pi_\\theta(\\cdot|s_t)\\big)\n\\big]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-87-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1298\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1299\"><span class=\"mi\" id=\"MathJax-Span-1300\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-87\">\\beta</script> is adaptively tuned. In practice, most modern implementations favor the clipped objective for its robustness.</li>\n    </ul>\n  </li>\n</ul>\n<p>In the original PPO formulation proposed in <a href=\"https://arxiv.org/abs/1707.06347\">Proximal Policy Optimization Algorithms</a> by Schulman et al. (2017), the KL divergence is <strong>not</strong> added directly to the clipped objective. Instead:</p>\n<ul>\n      <li>The clipped objective <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-85-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>C</mi><mi mathvariant=&quot;normal&quot;>L</mi><mi mathvariant=&quot;normal&quot;>I</mi><mi mathvariant=&quot;normal&quot;>P</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1197\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1002.24em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1198\"><span class=\"msubsup\" id=\"MathJax-Span-1199\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1200\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1201\"><span class=\"mrow\" id=\"MathJax-Span-1202\"><span class=\"mi\" id=\"MathJax-Span-1203\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">C</span><span class=\"mi\" id=\"MathJax-Span-1204\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span><span class=\"mi\" id=\"MathJax-Span-1205\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">I</span><span class=\"mi\" id=\"MathJax-Span-1206\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">C</mi><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">I</mi><mi mathvariant=\"normal\">P</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-85\">L^{\\rm CLIP}</script> serves as the primary mechanism for constraining policy updates, and</li>\n      <li>The KL divergence is monitored as a diagnostic, optionally triggering early stopping.</li>\n    </ul>\n<p><a href=\"https://arxiv.org/abs/1707.06347\">Proximal Policy Optimization Algorithms</a> also proposes an alternative objective, often referred to as the KL-penalized form:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-87-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1298\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1299\"><span class=\"mi\" id=\"MathJax-Span-1300\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-87\">\\beta</script> is adaptively tuned. In practice, most modern implementations favor the clipped objective for its robustness.</li>\n    </ul>\n<h5 id=\"kl-regularization-in-rlhf--llm-settings\">KL Regularization in RLHF / LLM Settings</h5>\n<ul>\n  <li>\n    <p>In RLHF-style training for language models, such as <a href=\"https://arxiv.org/abs/2203.02155\">Training Language Models to Follow Instructions with Human Feedback</a> by Ouyang et al. (2022), KL regularization is applied <strong>at the reward level</strong>, not directly in the PPO loss.</p>\n  </li>\n  <li>\n    <p>Specifically, the per-step reward is modified as:</p>\n  </li>\n</ul>\n<p>In RLHF-style training for language models, such as <a href=\"https://arxiv.org/abs/2203.02155\">Training Language Models to Follow Instructions with Human Feedback</a> by Ouyang et al. (2022), KL regularization is applied <strong>at the reward level</strong>, not directly in the PPO loss.</p>\n<p>Specifically, the per-step reward is modified as:</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-88-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>r</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>n</mi><mi mathvariant=&quot;normal&quot;>v</mi></mrow></msubsup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>&amp;#x03B2;</mi><mi>log</mi><mo>&amp;#x2061;</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1301\" style=\"width: 16.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.117em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.68em, 1014.12em, 3.232em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1302\"><span class=\"msubsup\" id=\"MathJax-Span-1303\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-1304\"><span class=\"mrow\" id=\"MathJax-Span-1305\"><span class=\"munderover\" id=\"MathJax-Span-1306\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1307\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1308\" style=\"font-family: STIXGeneral-Regular;\">̃&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-1309\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1310\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-1311\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1312\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1001.1em, 4.169em, -999.997em); top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-1313\"><span class=\"mrow\" id=\"MathJax-Span-1314\"><span class=\"mi\" id=\"MathJax-Span-1315\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-1316\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">n</span><span class=\"mi\" id=\"MathJax-Span-1317\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">v</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1318\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1319\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1320\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1321\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1322\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1323\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1324\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1325\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1326\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1327\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1328\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-1329\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1330\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-1331\"></span><span class=\"mfrac\" id=\"MathJax-Span-1332\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 4.534em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.91em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.977em;\"><span class=\"mrow\" id=\"MathJax-Span-1333\"><span class=\"msubsup\" id=\"MathJax-Span-1334\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1335\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1336\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1337\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1338\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1339\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1340\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1341\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"msubsup\" id=\"MathJax-Span-1342\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1343\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1344\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1345\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1004.38em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -2.185em;\"><span class=\"mrow\" id=\"MathJax-Span-1346\"><span class=\"msubsup\" id=\"MathJax-Span-1347\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1348\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1349\"><span class=\"mrow\" id=\"MathJax-Span-1350\"><span class=\"mi\" id=\"MathJax-Span-1351\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1352\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-1353\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1354\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1355\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1356\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1357\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1358\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"msubsup\" id=\"MathJax-Span-1359\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1360\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1361\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1362\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.53em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.534em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>r</mi><mo stretchy=\"false\">~</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">n</mi><mi mathvariant=\"normal\">v</mi></mrow></msubsup><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>β</mi><mi>log</mi><mo>⁡</mo><mfrac><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span></div>\n<ul>\n  <li>PPO is then run using <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-89-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>r</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1363\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1364\"><span class=\"msubsup\" id=\"MathJax-Span-1365\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-1366\"><span class=\"mrow\" id=\"MathJax-Span-1367\"><span class=\"munderover\" id=\"MathJax-Span-1368\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1369\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1370\" style=\"font-family: STIXGeneral-Regular;\">̃&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-1371\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>r</mi><mo stretchy=\"false\">~</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-89\">\\tilde r_t</script> to compute returns and advantages, while the policy loss remains the standard clipped surrogate <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-90-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>C</mi><mi mathvariant=&quot;normal&quot;>L</mi><mi mathvariant=&quot;normal&quot;>I</mi><mi mathvariant=&quot;normal&quot;>P</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1372\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1002.24em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1373\"><span class=\"msubsup\" id=\"MathJax-Span-1374\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1375\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1376\"><span class=\"mrow\" id=\"MathJax-Span-1377\"><span class=\"mi\" id=\"MathJax-Span-1378\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">C</span><span class=\"mi\" id=\"MathJax-Span-1379\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span><span class=\"mi\" id=\"MathJax-Span-1380\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">I</span><span class=\"mi\" id=\"MathJax-Span-1381\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">C</mi><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">I</mi><mi mathvariant=\"normal\">P</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-90\">L^{\\rm CLIP}</script>. This approach preserves PPO’s structure while explicitly anchoring the policy to a reference (typically an SFT model).</li>\n</ul>\n<h5 id=\"full-ppo-objective-typical-actorcritic-form\">Full PPO Objective (Typical Actor–Critic Form)</h5>\n<ul>\n  <li>\n    <p>With reward-level KL regularization, the overall optimization minimizes:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-91-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>P</mi><mi mathvariant=&quot;normal&quot;>P</mi><mi mathvariant=&quot;normal&quot;>O</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>l</mi></mrow></msubsup><mo>=</mo><mo>&amp;#x2212;</mo><msup><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>C</mi><mi mathvariant=&quot;normal&quot;>L</mi><mi mathvariant=&quot;normal&quot;>I</mi><mi mathvariant=&quot;normal&quot;>P</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msub><mi>c</mi><mi>v</mi></msub><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>v</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>e</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1382\" style=\"width: 15.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1012.71em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1383\"><span class=\"msubsup\" id=\"MathJax-Span-1384\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1385\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.36em, 4.169em, -999.997em); top: -4.372em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1386\"><span class=\"mrow\" id=\"MathJax-Span-1387\"><span class=\"mi\" id=\"MathJax-Span-1388\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1389\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-1390\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1391\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">a</span><span class=\"mi\" id=\"MathJax-Span-1392\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">l</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.36em, 4.169em, -999.997em); top: -3.695em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-1393\"><span class=\"mrow\" id=\"MathJax-Span-1394\"><span class=\"mi\" id=\"MathJax-Span-1395\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span><span class=\"mi\" id=\"MathJax-Span-1396\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span><span class=\"mi\" id=\"MathJax-Span-1397\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">O</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1398\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-1399\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-1400\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1401\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1402\"><span class=\"mrow\" id=\"MathJax-Span-1403\"><span class=\"mi\" id=\"MathJax-Span-1404\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">C</span><span class=\"mi\" id=\"MathJax-Span-1405\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span><span class=\"mi\" id=\"MathJax-Span-1406\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">I</span><span class=\"mi\" id=\"MathJax-Span-1407\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1408\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1409\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1410\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1411\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-1412\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1413\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-1414\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">v</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1415\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1416\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-1417\"><span class=\"mrow\" id=\"MathJax-Span-1418\"><span class=\"mi\" id=\"MathJax-Span-1419\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">v</span><span class=\"mi\" id=\"MathJax-Span-1420\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">a</span><span class=\"mi\" id=\"MathJax-Span-1421\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-1422\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">u</span><span class=\"mi\" id=\"MathJax-Span-1423\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1424\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1425\" style=\"font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.107em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1426\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">O</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">l</mi></mrow></msubsup><mo>=</mo><mo>−</mo><msup><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">C</mi><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">I</mi><mi mathvariant=\"normal\">P</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>+</mo><msub><mi>c</mi><mi>v</mi></msub><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">v</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">u</mi><mi mathvariant=\"normal\">e</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>ψ</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-91\">L^{\\rm total}_{\\rm PPO}\n=\n- L^{\\rm CLIP}(\\theta)\n+ c_v L_{\\rm value}(\\psi)</script>\n\n    <ul>\n      <li>where the KL penalty influences learning implicitly through the shaped rewards rather than appearing as a separate loss term.</li>\n    </ul>\n  </li>\n</ul>\n<p>With reward-level KL regularization, the overall optimization minimizes:</p>\n<ul>\n      <li>where the KL penalty influences learning implicitly through the shaped rewards rather than appearing as a separate loss term.</li>\n    </ul>\n<h5 id=\"implementation-notes\">Implementation Notes</h5>\n<ul>\n  <li>Use mini-batches and multiple epochs per rollout.</li>\n  <li>Shuffle trajectories and apply Adam or AdamW optimizers.</li>\n  <li>Clip gradients and monitor KL divergence, entropy, and task-specific metrics such as tool-calling accuracy and argument correctness.</li>\n</ul>\n<h4 id=\"dpo-losses-and-update-rules\">DPO: Losses and Update Rules</h4>\n<h5 id=\"preference-data-construction\">Preference Data Construction</h5>\n<ul>\n  <li>Direct Preference Optimization (DPO), proposed in <a href=\"https://arxiv.org/abs/2305.18290\">Direct Preference Optimization: Your Language Model is Secretly a Reward Model</a> by Rafailov et al. (2023), reframes alignment as maximizing the probability that the fine-tuned model ranks preferred outputs higher than non-preferred ones, bypassing the explicit RL loop.</li>\n  <li>Direct Preference Optimization operates on paired preferences rather than full trajectories. From the unified reward formulation, pairs of candidate actions or completions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-92-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msup><mi>a</mi><mo>+</mo></msup><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2212;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1427\" style=\"width: 3.909em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.232em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1003.18em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1428\"><span class=\"mo\" id=\"MathJax-Span-1429\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1430\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1431\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-1432\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1433\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1434\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1435\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-1436\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1437\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msup><mi>a</mi><mo>+</mo></msup><mo>,</mo><msup><mi>a</mi><mo>−</mo></msup><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-92\">(a^+, a^-)</script> are generated under the same state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-93-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1438\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1439\"><span class=\"mi\" id=\"MathJax-Span-1440\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-93\">s</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-94-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>a</mi><mo>+</mo></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1441\" style=\"width: 1.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1001.04em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1442\"><span class=\"msubsup\" id=\"MathJax-Span-1443\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1444\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-1445\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>a</mi><mo>+</mo></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-94\">a^+</script> is preferred over <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-95-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>a</mi><mo>&amp;#x2212;</mo></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1446\" style=\"width: 1.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1001.04em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1447\"><span class=\"msubsup\" id=\"MathJax-Span-1448\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1449\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-1450\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>a</mi><mo>−</mo></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-95\">a^-</script> according to higher reward:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-96-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><msup><mi>a</mi><mo>+</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;gt;</mo><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2212;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1451\" style=\"width: 8.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.982em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1006.93em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1452\"><span class=\"mi\" id=\"MathJax-Span-1453\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1454\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1455\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1456\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1457\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1458\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-1459\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1460\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1461\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">&gt;</span><span class=\"mi\" id=\"MathJax-Span-1462\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1463\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1464\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1465\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1466\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1467\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-1468\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1469\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><msup><mi>a</mi><mo>+</mo></msup><mo stretchy=\"false\">)</mo><mo>&gt;</mo><mi>r</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><msup><mi>a</mi><mo>−</mo></msup><mo stretchy=\"false\">)</mo></math></span></span></div>\n<ul>\n  <li>In agentic RL settings, such pairs are typically obtained by sampling multiple tool-use or answer candidates for the same state and ranking them using the unified reward, human feedback, or AI-based evaluators.</li>\n</ul>\n<h5 id=\"dpo-objective\">DPO Objective</h5>\n<ul>\n  <li>DPO directly optimizes the policy without an explicit reward model or value critic by exploiting a closed-form relationship between rewards and optimal policies under a KL-regularized RL objective. As shown in <a href=\"https://arxiv.org/abs/2305.18290\">Direct Preference Optimization: Your Language Model is Secretly a Reward Model</a> by Rafailov et al. (2023), the KL-constrained RL objective admits an optimal policy of the form:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-97-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>&amp;#x03C0;</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x221D;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mi>exp</mi><mo>&amp;#x2061;</mo><mrow><mo>(</mo><mrow><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;><mfrac><mn>1</mn><mi>&amp;#x03B2;</mi></mfrac></mstyle><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>)</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1470\" style=\"width: 17.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.221em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.138em, 1014.12em, 4.326em, -999.997em); top: -3.487em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1471\"><span class=\"msubsup\" id=\"MathJax-Span-1472\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1473\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.576em;\"><span class=\"mo\" id=\"MathJax-Span-1474\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∗</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1475\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1476\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-1477\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-1478\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1479\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1480\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∝</span><span class=\"msubsup\" id=\"MathJax-Span-1481\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1482\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1483\"><span class=\"mrow\" id=\"MathJax-Span-1484\"><span class=\"mi\" id=\"MathJax-Span-1485\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1486\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-1487\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1488\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1489\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-1490\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-1491\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1492\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mi\" id=\"MathJax-Span-1493\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">exp</span><span class=\"mo\" id=\"MathJax-Span-1494\"></span><span class=\"mrow\" id=\"MathJax-Span-1495\"><span class=\"mo\" id=\"MathJax-Span-1496\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-1497\"><span class=\"mstyle\" id=\"MathJax-Span-1498\"><span class=\"mrow\" id=\"MathJax-Span-1499\"><span class=\"mfrac\" id=\"MathJax-Span-1500\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -4.424em; left: 50%; margin-left: -0.154em;\"><span class=\"mn\" id=\"MathJax-Span-1501\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.326em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.154em;\"><span class=\"mi\" id=\"MathJax-Span-1502\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.47em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.471em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-1503\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1504\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1505\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1506\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1507\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1508\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-1509\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.492em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>π</mi><mo>∗</mo></msup><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>∝</mo><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mi>exp</mi><mo>⁡</mo><mrow><mo>(</mo><mrow><mstyle displaystyle=\"false\" scriptlevel=\"0\"><mfrac><mn>1</mn><mi>β</mi></mfrac></mstyle><mi>r</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><mo>)</mo></mrow></math></span></span></div>\n<ul>\n  <li>Reparameterizing the reward in terms of the policy yields an implicit reward:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-98-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>r</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>&amp;#x03B2;</mi><mi>log</mi><mo>&amp;#x2061;</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1510\" style=\"width: 12.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.68em, 1010.42em, 3.232em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1511\"><span class=\"msubsup\" id=\"MathJax-Span-1512\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.128em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-1513\"><span class=\"mrow\" id=\"MathJax-Span-1514\"><span class=\"munderover\" id=\"MathJax-Span-1515\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1516\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1517\" style=\"font-family: STIXGeneral-Regular;\">̂&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-1518\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1519\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1520\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1521\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1522\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1523\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1524\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1525\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1526\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-1527\"></span><span class=\"mfrac\" id=\"MathJax-Span-1528\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.34em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.664em;\"><span class=\"mrow\" id=\"MathJax-Span-1529\"><span class=\"msubsup\" id=\"MathJax-Span-1530\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1531\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1532\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1533\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1534\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-1535\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-1536\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1537\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.8em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -1.924em;\"><span class=\"mrow\" id=\"MathJax-Span-1538\"><span class=\"msubsup\" id=\"MathJax-Span-1539\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1540\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1541\"><span class=\"mrow\" id=\"MathJax-Span-1542\"><span class=\"mi\" id=\"MathJax-Span-1543\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1544\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-1545\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1546\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1547\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-1548\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-1549\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1550\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.96em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.961em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>r</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>β</mi><mi>log</mi><mo>⁡</mo><mfrac><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span></div>\n<ul>\n  <li>\n    <p>Substituting this form into a Bradley–Terry preference model leads to the DPO loss:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-99-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>D</mi><mi mathvariant=&quot;normal&quot;>P</mi><mi mathvariant=&quot;normal&quot;>O</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><msup><mi>a</mi><mo>+</mo></msup><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2212;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mrow><mo>[</mo><mrow><mi>log</mi><mo>&amp;#x2061;</mo><mi>&amp;#x03C3;</mi><mrow><mo>(</mo><mrow><mi>&amp;#x03B2;</mi><mrow><mo>(</mo><mrow><mi>log</mi><mo>&amp;#x2061;</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msup><mi>a</mi><mo>+</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msup><mi>a</mi><mo>+</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>&amp;#x2212;</mo><mi>log</mi><mo>&amp;#x2061;</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msup><mi>a</mi><mo>&amp;#x2212;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msup><mi>a</mi><mo>&amp;#x2212;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1551\" style=\"width: 35.107em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 29.221em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.503em, 1029.01em, 5.263em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1552\"><span class=\"msubsup\" id=\"MathJax-Span-1553\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1554\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1555\"><span class=\"mrow\" id=\"MathJax-Span-1556\"><span class=\"mi\" id=\"MathJax-Span-1557\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">D</span><span class=\"mi\" id=\"MathJax-Span-1558\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span><span class=\"mi\" id=\"MathJax-Span-1559\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">O</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1560\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1561\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1562\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1563\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-1564\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-1565\"><span style=\"display: inline-block; position: relative; width: 3.284em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-1566\"><span class=\"mrow\" id=\"MathJax-Span-1567\"><span class=\"mi\" id=\"MathJax-Span-1568\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1569\"><span class=\"mrow\" id=\"MathJax-Span-1570\"><span class=\"mo\" id=\"MathJax-Span-1571\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1572\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1573\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1574\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1575\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.216em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1576\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">+</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1577\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1578\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1579\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.216em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1580\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">−</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1581\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-1582\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-1583\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-1584\"><span class=\"mi\" id=\"MathJax-Span-1585\" style=\"font-family: STIXGeneral-Regular;\">log</span><span class=\"mo\" id=\"MathJax-Span-1586\"></span><span class=\"mi\" id=\"MathJax-Span-1587\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mrow\" id=\"MathJax-Span-1588\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-1589\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-1590\"><span class=\"mi\" id=\"MathJax-Span-1591\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mrow\" id=\"MathJax-Span-1592\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-1593\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-1594\"><span class=\"mi\" id=\"MathJax-Span-1595\" style=\"font-family: STIXGeneral-Regular;\">log</span><span class=\"mo\" id=\"MathJax-Span-1596\"></span><span class=\"mfrac\" id=\"MathJax-Span-1597\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 4.534em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.128em, 1003.91em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.977em;\"><span class=\"mrow\" id=\"MathJax-Span-1598\"><span class=\"msubsup\" id=\"MathJax-Span-1599\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1600\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1601\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1602\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1603\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1604\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-1605\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1606\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-1607\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1608\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1004.38em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -2.185em;\"><span class=\"mrow\" id=\"MathJax-Span-1609\"><span class=\"msubsup\" id=\"MathJax-Span-1610\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1611\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1612\"><span class=\"mrow\" id=\"MathJax-Span-1613\"><span class=\"mi\" id=\"MathJax-Span-1614\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1615\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-1616\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1617\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1618\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1619\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-1620\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1621\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-1622\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1623\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.53em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.534em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1624\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-1625\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">log</span><span class=\"mo\" id=\"MathJax-Span-1626\"></span><span class=\"mfrac\" id=\"MathJax-Span-1627\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 4.534em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.128em, 1003.91em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.977em;\"><span class=\"mrow\" id=\"MathJax-Span-1628\"><span class=\"msubsup\" id=\"MathJax-Span-1629\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1630\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1631\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1632\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1633\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1634\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-1635\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1636\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-1637\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1638\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1004.38em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -2.185em;\"><span class=\"mrow\" id=\"MathJax-Span-1639\"><span class=\"msubsup\" id=\"MathJax-Span-1640\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1641\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1642\"><span class=\"mrow\" id=\"MathJax-Span-1643\"><span class=\"mi\" id=\"MathJax-Span-1644\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1645\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-1646\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1647\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1648\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1649\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-1650\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1651\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-1652\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1653\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.53em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.534em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1654\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">)</span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1655\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">)</span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1656\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">D</mi><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">O</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><msup><mi>a</mi><mo>+</mo></msup><mo>,</mo><msup><mi>a</mi><mo>−</mo></msup><mo stretchy=\"false\">)</mo></mrow></msub><mrow><mo>[</mo><mrow><mi>log</mi><mo>⁡</mo><mi>σ</mi><mrow><mo>(</mo><mrow><mi>β</mi><mrow><mo>(</mo><mrow><mi>log</mi><mo>⁡</mo><mfrac><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msup><mi>a</mi><mo>+</mo></msup><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub><mo stretchy=\"false\">(</mo><msup><mi>a</mi><mo>+</mo></msup><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>−</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msup><mi>a</mi><mo>−</mo></msup><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub><mo stretchy=\"false\">(</mo><msup><mi>a</mi><mo>−</mo></msup><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-99\">L^{\\rm DPO}(\\theta) =\n- \\mathbb{E}_{(s,a^+,a^-)}\n\\left[\n\\log \\sigma \\left(\n\\beta \\left(\n\\log \\frac{\\pi_\\theta(a^+ \\mid s)}{\\pi_{\\rm ref}(a^+ \\mid s)}\n- \\log \\frac{\\pi_\\theta(a^- \\mid s)}{\\pi_{\\rm ref}(a^- \\mid s)}\n\\right)\n\\right)\n\\right]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-100-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1657\" style=\"width: 1.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.41em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1658\"><span class=\"msubsup\" id=\"MathJax-Span-1659\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1660\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1661\"><span class=\"mrow\" id=\"MathJax-Span-1662\"><span class=\"mi\" id=\"MathJax-Span-1663\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1664\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-1665\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-100\">\\pi_{\\rm ref}</script> is a fixed reference policy (typically the SFT model), <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-101-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1666\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1667\"><span class=\"mi\" id=\"MathJax-Span-1668\" style=\"font-family: STIXGeneral-Italic;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>σ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-101\">\\sigma</script> denotes the logistic sigmoid, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-102-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1669\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1670\"><span class=\"mi\" id=\"MathJax-Span-1671\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-102\">\\beta</script> controls the strength of the KL regularization.</li>\n    </ul>\n  </li>\n</ul>\n<p>Substituting this form into a Bradley–Terry preference model leads to the DPO loss:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-100-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1657\" style=\"width: 1.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.41em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1658\"><span class=\"msubsup\" id=\"MathJax-Span-1659\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1660\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1661\"><span class=\"mrow\" id=\"MathJax-Span-1662\"><span class=\"mi\" id=\"MathJax-Span-1663\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1664\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-1665\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-100\">\\pi_{\\rm ref}</script> is a fixed reference policy (typically the SFT model), <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-101-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1666\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1667\"><span class=\"mi\" id=\"MathJax-Span-1668\" style=\"font-family: STIXGeneral-Italic;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>σ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-101\">\\sigma</script> denotes the logistic sigmoid, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-102-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1669\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1670\"><span class=\"mi\" id=\"MathJax-Span-1671\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-102\">\\beta</script> controls the strength of the KL regularization.</li>\n    </ul>\n<h5 id=\"relation-to-rl-objectives\">Relation to RL Objectives</h5>\n<ul>\n  <li>\n    <p>DPO can be interpreted as exactly optimizing the same KL-regularized expected reward objective used in PPO-based RLHF, but without:</p>\n\n    <ul>\n      <li>explicit rollouts,</li>\n      <li>Monte Carlo return estimation,</li>\n      <li>or a learned value function.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The preference loss implicitly enforces both reward maximization and proximity to the reference policy, recovering the optimal policy in closed form under the assumed preference model .</p>\n  </li>\n</ul>\n<p>DPO can be interpreted as exactly optimizing the same KL-regularized expected reward objective used in PPO-based RLHF, but without:</p>\n<ul>\n      <li>explicit rollouts,</li>\n      <li>Monte Carlo return estimation,</li>\n      <li>or a learned value function.</li>\n    </ul>\n<p>The preference loss implicitly enforces both reward maximization and proximity to the reference policy, recovering the optimal policy in closed form under the assumed preference model .</p>\n<h5 id=\"value-loss-1\">Value Loss</h5>\n<ul>\n  <li>DPO does not train a parametric value model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-103-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1672\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1673\"><span class=\"msubsup\" id=\"MathJax-Span-1674\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1675\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1676\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>ψ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-103\">V_\\psi</script>.</li>\n  <li>Baselines and normalization arise implicitly from the policy–reference ratio, eliminating the need for critic learning or advantage estimation.</li>\n</ul>\n<h5 id=\"kl--regularization\">KL / Regularization</h5>\n<ul>\n  <li>The KL constraint is baked directly into the objective via the policy ratio against <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-104-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1677\" style=\"width: 1.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.41em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1678\"><span class=\"msubsup\" id=\"MathJax-Span-1679\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1680\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1681\"><span class=\"mrow\" id=\"MathJax-Span-1682\"><span class=\"mi\" id=\"MathJax-Span-1683\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1684\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-1685\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-104\">\\pi_{\\rm ref}</script>.</li>\n  <li>The coefficient <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-105-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1686\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1687\"><span class=\"mi\" id=\"MathJax-Span-1688\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-105\">\\beta</script> plays an analogous role to the KL penalty weight in PPO, controlling the reward–conservativeness tradeoff.</li>\n</ul>\n<h5 id=\"full-dpo-loss\">Full DPO Loss</h5>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-106-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>D</mi><mi mathvariant=&quot;normal&quot;>P</mi><mi mathvariant=&quot;normal&quot;>O</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>l</mi></mrow></msubsup><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>D</mi><mi mathvariant=&quot;normal&quot;>P</mi><mi mathvariant=&quot;normal&quot;>O</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1689\" style=\"width: 9.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1007.71em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1690\"><span class=\"msubsup\" id=\"MathJax-Span-1691\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1692\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.36em, 4.169em, -999.997em); top: -4.372em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1693\"><span class=\"mrow\" id=\"MathJax-Span-1694\"><span class=\"mi\" id=\"MathJax-Span-1695\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1696\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-1697\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1698\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">a</span><span class=\"mi\" id=\"MathJax-Span-1699\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">l</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.51em, 4.169em, -999.997em); top: -3.695em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-1700\"><span class=\"mrow\" id=\"MathJax-Span-1701\"><span class=\"mi\" id=\"MathJax-Span-1702\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">D</span><span class=\"mi\" id=\"MathJax-Span-1703\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span><span class=\"mi\" id=\"MathJax-Span-1704\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">O</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1705\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1706\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1707\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1708\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-1709\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1710\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1711\"><span class=\"mrow\" id=\"MathJax-Span-1712\"><span class=\"mi\" id=\"MathJax-Span-1713\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">D</span><span class=\"mi\" id=\"MathJax-Span-1714\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span><span class=\"mi\" id=\"MathJax-Span-1715\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">O</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1716\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1717\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1718\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">D</mi><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">O</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">l</mi></mrow></msubsup><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">D</mi><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">O</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo></math></span></span></div>\n<ul>\n  <li>No auxiliary losses are required.</li>\n</ul>\n<h5 id=\"implementation-notes-1\">Implementation Notes</h5>\n<ul>\n  <li>Training is fully offline and supervised over preference pairs.</li>\n  <li>No environment interaction or on-policy rollouts are required during optimization.</li>\n  <li>Particularly attractive for agentic RL settings with reliable reward-based ranking but expensive or unstable long-horizon rollouts.</li>\n  <li>Often used as a simpler alternative or complement to PPO, and as a conceptual bridge between PPO-style RL and group-relative methods such as GRPO.</li>\n</ul>\n<h4 id=\"grpo-losses-and-update-rules\">GRPO: Losses and Update Rules</h4>\n<h5 id=\"group-sampling--relative-advantage\">Group Sampling &amp; Relative Advantage</h5>\n<ul>\n  <li>In Group Relative Policy Optimization (GRPO), introduced in <a href=\"https://arxiv.org/abs/2402.03300\">Group Relative Policy Optimization</a> by Shao et al. (2024), a group of <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-107-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1719\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1720\"><span class=\"mi\" id=\"MathJax-Span-1721\" style=\"font-family: STIXGeneral-Italic;\">G</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>G</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-107\">G</script> candidate actions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-108-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>a</mi><mi>G</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1722\" style=\"width: 5.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.846em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.79em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1723\"><span class=\"mo\" id=\"MathJax-Span-1724\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1725\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1726\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-1727\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1728\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-1729\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">…</span><span class=\"mo\" id=\"MathJax-Span-1730\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1731\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1732\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1733\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1734\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>G</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-108\">(a_1,\\dots,a_G)</script> is sampled under the same state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-109-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1735\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1736\"><span class=\"mi\" id=\"MathJax-Span-1737\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-109\">s</script> using the current or previous policy.</li>\n  <li>Each candidate action is evaluated with the unified reward to obtain <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-110-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1738\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.61em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1739\"><span class=\"mi\" id=\"MathJax-Span-1740\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1741\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1742\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1743\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1744\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1745\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1746\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1747\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-110\">r(s,a_j)</script>. Group-level statistics are then computed:\n    <ul>\n      <li>mean reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-111-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BC;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1748\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1749\"><span class=\"mi\" id=\"MathJax-Span-1750\" style=\"font-family: STIXGeneral-Italic;\">μ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>μ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-111\">\\mu</script>,</li>\n      <li>standard deviation <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-112-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1751\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1752\"><span class=\"mi\" id=\"MathJax-Span-1753\" style=\"font-family: STIXGeneral-Italic;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>σ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-112\">\\sigma</script>.</li>\n    </ul>\n  </li>\n  <li>A normalized, group-relative advantage is assigned to each action:</li>\n</ul>\n<ul>\n      <li>mean reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-111-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BC;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1748\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1749\"><span class=\"mi\" id=\"MathJax-Span-1750\" style=\"font-family: STIXGeneral-Italic;\">μ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>μ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-111\">\\mu</script>,</li>\n      <li>standard deviation <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-112-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1751\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1752\"><span class=\"mi\" id=\"MathJax-Span-1753\" style=\"font-family: STIXGeneral-Italic;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>σ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-112\">\\sigma</script>.</li>\n    </ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-113-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>G</mi><mi mathvariant=&quot;normal&quot;>R</mi><mi mathvariant=&quot;normal&quot;>P</mi><mi mathvariant=&quot;normal&quot;>O</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>&amp;#x03BC;</mi></mrow><mi>&amp;#x03C3;</mi></mfrac></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1754\" style=\"width: 13.023em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.576em, 1010.84em, 3.023em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1755\"><span class=\"msubsup\" id=\"MathJax-Span-1756\"><span style=\"display: inline-block; position: relative; width: 2.555em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1757\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1758\"><span class=\"mrow\" id=\"MathJax-Span-1759\"><span class=\"mi\" id=\"MathJax-Span-1760\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">G</span><span class=\"mi\" id=\"MathJax-Span-1761\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">R</span><span class=\"mi\" id=\"MathJax-Span-1762\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span><span class=\"mi\" id=\"MathJax-Span-1763\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">O</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1764\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1765\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1766\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1767\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1768\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1769\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1770\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1771\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-1772\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.586em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1004.38em, 4.482em, -999.997em); top: -4.789em; left: 50%; margin-left: -2.237em;\"><span class=\"mrow\" id=\"MathJax-Span-1773\"><span class=\"mi\" id=\"MathJax-Span-1774\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1775\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1776\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1777\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1778\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1779\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1780\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1781\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1782\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-1783\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">μ</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;\"><span class=\"mi\" id=\"MathJax-Span-1784\" style=\"font-family: STIXGeneral-Italic;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.59em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.586em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">G</mi><mi mathvariant=\"normal\">R</mi><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">O</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>r</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>μ</mi></mrow><mi>σ</mi></mfrac></math></span></span></div>\n<ul>\n  <li>This construction removes dependence on an explicit value function and normalizes rewards across heterogeneous candidates.</li>\n</ul>\n<h5 id=\"grpo-surrogate-objective\">GRPO Surrogate Objective</h5>\n<ul>\n  <li>GRPO uses a PPO-style clipped surrogate objective, but replaces standard advantages with group-relative advantages:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-114-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>G</mi><mi mathvariant=&quot;normal&quot;>R</mi><mi mathvariant=&quot;normal&quot;>P</mi><mi mathvariant=&quot;normal&quot;>O</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mn>1</mn><mi>G</mi></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mo>,</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>G</mi></mrow></msub><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>d</mi></mrow></msub></mrow></msub></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>[</mo></mrow><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msub><mi>r</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>G</mi><mi mathvariant=&quot;normal&quot;>R</mi><mi mathvariant=&quot;normal&quot;>P</mi><mi mathvariant=&quot;normal&quot;>O</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>p</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03F5;</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>&amp;#x03F5;</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>G</mi><mi mathvariant=&quot;normal&quot;>R</mi><mi mathvariant=&quot;normal&quot;>P</mi><mi mathvariant=&quot;normal&quot;>O</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1785\" style=\"width: 44.273em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 36.878em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1036.67em, 5.055em, -999.997em); top: -3.487em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1786\"><span class=\"msubsup\" id=\"MathJax-Span-1787\"><span style=\"display: inline-block; position: relative; width: 2.555em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1788\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1789\"><span class=\"mrow\" id=\"MathJax-Span-1790\"><span class=\"mi\" id=\"MathJax-Span-1791\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">G</span><span class=\"mi\" id=\"MathJax-Span-1792\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">R</span><span class=\"mi\" id=\"MathJax-Span-1793\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span><span class=\"mi\" id=\"MathJax-Span-1794\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">O</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1795\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1796\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1797\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1798\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-1799\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-1800\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.362em;\"><span class=\"mi\" id=\"MathJax-Span-1801\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.84em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.836em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-1802\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1803\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.94em, 4.43em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-1804\"><span class=\"mrow\" id=\"MathJax-Span-1805\"><span class=\"mi\" id=\"MathJax-Span-1806\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1807\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-1808\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.52em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-1809\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1810\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 4.117em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-1811\"><span class=\"mrow\" id=\"MathJax-Span-1812\"><span class=\"mi\" id=\"MathJax-Span-1813\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1814\"><span class=\"mrow\" id=\"MathJax-Span-1815\"><span class=\"mi\" id=\"MathJax-Span-1816\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1817\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1818\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1819\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1820\"><span class=\"mrow\" id=\"MathJax-Span-1821\"><span class=\"mn\" id=\"MathJax-Span-1822\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1823\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1824\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">G</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1825\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"msubsup\" id=\"MathJax-Span-1826\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1827\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1828\"><span class=\"mrow\" id=\"MathJax-Span-1829\"><span class=\"msubsup\" id=\"MathJax-Span-1830\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1831\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-1832\"><span class=\"mrow\" id=\"MathJax-Span-1833\"><span class=\"mi\" id=\"MathJax-Span-1834\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-1835\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-1836\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">d</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1837\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-1838\"><span class=\"mo\" id=\"MathJax-Span-1839\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">[</span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1840\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">min</span><span class=\"texatom\" id=\"MathJax-Span-1841\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-1842\"><span class=\"mo\" id=\"MathJax-Span-1843\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1844\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1845\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1846\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1847\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1848\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1849\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-1850\"><span style=\"display: inline-block; position: relative; width: 2.555em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1851\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1852\"><span class=\"mrow\" id=\"MathJax-Span-1853\"><span class=\"mi\" id=\"MathJax-Span-1854\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">G</span><span class=\"mi\" id=\"MathJax-Span-1855\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">R</span><span class=\"mi\" id=\"MathJax-Span-1856\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span><span class=\"mi\" id=\"MathJax-Span-1857\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">O</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1858\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1859\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1860\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1861\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1862\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1863\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1864\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1865\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-1866\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-1867\"><span class=\"mi\" id=\"MathJax-Span-1868\" style=\"font-family: STIXGeneral-Regular;\">c</span><span class=\"mi\" id=\"MathJax-Span-1869\" style=\"font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-1870\" style=\"font-family: STIXGeneral-Regular;\">i</span><span class=\"mi\" id=\"MathJax-Span-1871\" style=\"font-family: STIXGeneral-Regular;\">p</span></span></span><span class=\"mo\" id=\"MathJax-Span-1872\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1873\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1874\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1875\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1876\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1877\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1878\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1879\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-1880\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-1881\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-1882\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">ϵ</span><span class=\"mo\" id=\"MathJax-Span-1883\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-1884\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-1885\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1886\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">ϵ</span><span class=\"mo\" id=\"MathJax-Span-1887\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-1888\"><span style=\"display: inline-block; position: relative; width: 2.555em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1889\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1890\"><span class=\"mrow\" id=\"MathJax-Span-1891\"><span class=\"mi\" id=\"MathJax-Span-1892\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">G</span><span class=\"mi\" id=\"MathJax-Span-1893\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">R</span><span class=\"mi\" id=\"MathJax-Span-1894\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span><span class=\"mi\" id=\"MathJax-Span-1895\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">O</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1896\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1897\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1898\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1899\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1900\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1901\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1902\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-1903\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-1904\"><span class=\"mo\" id=\"MathJax-Span-1905\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1906\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-1907\"><span class=\"mo\" id=\"MathJax-Span-1908\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">]</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.492em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.747em; border-left: 0px solid; width: 0px; height: 3.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">G</mi><mi mathvariant=\"normal\">R</mi><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">O</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>G</mi></mfrac><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>s</mi><mo>,</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>G</mi></mrow></msub><mo>∼</mo><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">d</mi></mrow></msub></mrow></msub></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">[</mo></mrow><mo movablelimits=\"true\" form=\"prefix\">min</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msub><mi>r</mi><mi>j</mi></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><msup><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">G</mi><mi mathvariant=\"normal\">R</mi><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">O</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">c</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">p</mi></mrow><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>j</mi></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mn>1</mn><mo>−</mo><mi>ϵ</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>ϵ</mi><mo stretchy=\"false\">)</mo><msup><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">G</mi><mi mathvariant=\"normal\">R</mi><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">O</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">]</mo></mrow></math></span></span></div>\n<ul>\n  <li>… where the probability ratio is defined as:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-115-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>r</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>d</mi></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1909\" style=\"width: 9.378em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.815em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.576em, 1007.82em, 3.336em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1910\"><span class=\"msubsup\" id=\"MathJax-Span-1911\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1912\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1913\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1914\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1915\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1916\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1917\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-1918\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.482em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.6em, 4.482em, -999.997em); top: -4.789em; left: 50%; margin-left: -1.82em;\"><span class=\"mrow\" id=\"MathJax-Span-1919\"><span class=\"msubsup\" id=\"MathJax-Span-1920\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1921\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1922\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1923\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1924\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1925\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1926\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1927\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-1928\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1929\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1004.27em, 4.482em, -999.997em); top: -3.331em; left: 50%; margin-left: -2.185em;\"><span class=\"mrow\" id=\"MathJax-Span-1930\"><span class=\"msubsup\" id=\"MathJax-Span-1931\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1932\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1933\"><span class=\"mrow\" id=\"MathJax-Span-1934\"><span class=\"msubsup\" id=\"MathJax-Span-1935\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1936\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1937\"><span class=\"mrow\" id=\"MathJax-Span-1938\"><span class=\"mi\" id=\"MathJax-Span-1939\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-1940\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-1941\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">d</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1942\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1943\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1944\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1945\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1946\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-1947\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1948\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.48em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.482em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>r</mi><mi>j</mi></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">d</mi></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span></div>\n<ul>\n  <li>As in PPO, the clipping parameter <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-116-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1949\" style=\"width: 0.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.42em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1950\"><span class=\"mi\" id=\"MathJax-Span-1951\" style=\"font-family: STIXGeneral-Italic;\">ϵ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>ϵ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-116\">\\epsilon</script> constrains the size of policy updates for stability.</li>\n</ul>\n<h5 id=\"value-loss-2\">Value Loss</h5>\n<ul>\n  <li>GRPO typically omits a parametric value estimator <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-117-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1952\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1953\"><span class=\"msubsup\" id=\"MathJax-Span-1954\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1955\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1956\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>ψ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-117\">V_\\psi</script>.</li>\n  <li>Baselines are derived implicitly from group statistics, eliminating the need for critic training and avoiding value-function instability in long-horizon or sparse-reward agentic tasks.</li>\n</ul>\n<h5 id=\"kl--entropy-regularization\">KL / Entropy Regularization</h5>\n<ul>\n  <li>Unlike PPO-style RLHF pipelines where KL penalties are often folded directly into the reward, GRPO incorporates KL regularization at the optimization stage using an unbiased estimator of the KL divergence proposed in <a href=\"https://arxiv.org/abs/2009.10897\">A Surrogate Loss for Reinforcement Learning</a> by Schulman (2020). Per the paper, the per-token KL divergence between the current policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-118-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1957\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1958\"><span class=\"msubsup\" id=\"MathJax-Span-1959\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1960\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1961\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-118\">\\pi_\\theta</script> and a reference policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-119-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1962\" style=\"width: 1.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.41em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1963\"><span class=\"msubsup\" id=\"MathJax-Span-1964\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1965\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1966\"><span class=\"mrow\" id=\"MathJax-Span-1967\"><span class=\"mi\" id=\"MathJax-Span-1968\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1969\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-1970\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-119\">\\pi_{\\rm ref}</script> can be estimated as:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-120-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>&amp;#x2212;</mo><mi>log</mi><mo>&amp;#x2061;</mo><mrow><mo>(</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>)</mo></mrow><mo>&amp;#x2212;</mo><mn>1</mn></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1971\" style=\"width: 25.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 21.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.294em, 1021.1em, 4.846em, -999.997em); top: -3.799em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1972\"><span class=\"msubsup\" id=\"MathJax-Span-1973\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1974\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-1975\"><span class=\"mrow\" id=\"MathJax-Span-1976\"><span class=\"mi\" id=\"MathJax-Span-1977\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1978\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1979\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-1980\"><span class=\"mo\" id=\"MathJax-Span-1981\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1982\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1983\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1984\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1985\"><span class=\"mrow\" id=\"MathJax-Span-1986\"><span class=\"mo\" id=\"MathJax-Span-1987\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1988\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1989\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1990\"><span class=\"mrow\" id=\"MathJax-Span-1991\"><span class=\"mi\" id=\"MathJax-Span-1992\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1993\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-1994\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1995\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-1996\"><span class=\"mo\" id=\"MathJax-Span-1997\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1998\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-1999\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.534em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1004.38em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -2.185em;\"><span class=\"mrow\" id=\"MathJax-Span-2000\"><span class=\"msubsup\" id=\"MathJax-Span-2001\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2002\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2003\"><span class=\"mrow\" id=\"MathJax-Span-2004\"><span class=\"mi\" id=\"MathJax-Span-2005\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2006\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-2007\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2008\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2009\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2010\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2011\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2012\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"msubsup\" id=\"MathJax-Span-2013\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2014\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2015\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2016\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.91em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -1.977em;\"><span class=\"mrow\" id=\"MathJax-Span-2017\"><span class=\"msubsup\" id=\"MathJax-Span-2018\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2019\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2020\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2021\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2022\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2023\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2024\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2025\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"msubsup\" id=\"MathJax-Span-2026\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2027\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2028\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2029\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.53em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.534em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2030\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-2031\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">log</span><span class=\"mo\" id=\"MathJax-Span-2032\"></span><span class=\"mrow\" id=\"MathJax-Span-2033\"><span class=\"mo\" id=\"MathJax-Span-2034\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">(</span></span></span><span class=\"mfrac\" id=\"MathJax-Span-2035\"><span style=\"display: inline-block; position: relative; width: 4.534em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1004.38em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -2.185em;\"><span class=\"mrow\" id=\"MathJax-Span-2036\"><span class=\"msubsup\" id=\"MathJax-Span-2037\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2038\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2039\"><span class=\"mrow\" id=\"MathJax-Span-2040\"><span class=\"mi\" id=\"MathJax-Span-2041\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2042\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-2043\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2044\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2045\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2046\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2047\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2048\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"msubsup\" id=\"MathJax-Span-2049\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2050\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2051\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2052\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.91em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -1.977em;\"><span class=\"mrow\" id=\"MathJax-Span-2053\"><span class=\"msubsup\" id=\"MathJax-Span-2054\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2055\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2056\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2057\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2058\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2059\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2060\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2061\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"msubsup\" id=\"MathJax-Span-2062\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2063\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2064\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2065\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.53em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.534em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2066\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">)</span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2067\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mn\" id=\"MathJax-Span-2068\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 3.805em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><msub><mi>π</mi><mi>θ</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>−</mo><mi>log</mi><mo>⁡</mo><mrow><mo>(</mo><mfrac><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>)</mo></mrow><mo>−</mo><mn>1</mn></math></span></span></div>\n<ul>\n  <li>This estimator is unbiased and can be added directly to the loss without modifying the reward signal.</li>\n  <li>In practice, this term acts as a trust-region constraint, discouraging excessive deviation from the reference policy while preserving the relative structure of group-normalized advantages.</li>\n</ul>\n<h5 id=\"full-grpo-loss\">Full GRPO Loss</h5>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-121-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>G</mi><mi mathvariant=&quot;normal&quot;>R</mi><mi mathvariant=&quot;normal&quot;>P</mi><mi mathvariant=&quot;normal&quot;>O</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>l</mi></mrow></msubsup><mo>=</mo><mo>&amp;#x2212;</mo><msup><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>G</mi><mi mathvariant=&quot;normal&quot;>R</mi><mi mathvariant=&quot;normal&quot;>P</mi><mi mathvariant=&quot;normal&quot;>O</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow></msub><mo>,</mo><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2069\" style=\"width: 19.586em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1016.1em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2070\"><span class=\"msubsup\" id=\"MathJax-Span-2071\"><span style=\"display: inline-block; position: relative; width: 2.503em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2072\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.36em, 4.169em, -999.997em); top: -4.372em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2073\"><span class=\"mrow\" id=\"MathJax-Span-2074\"><span class=\"mi\" id=\"MathJax-Span-2075\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2076\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-2077\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2078\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">a</span><span class=\"mi\" id=\"MathJax-Span-2079\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">l</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.98em, 4.169em, -999.997em); top: -3.695em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-2080\"><span class=\"mrow\" id=\"MathJax-Span-2081\"><span class=\"mi\" id=\"MathJax-Span-2082\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">G</span><span class=\"mi\" id=\"MathJax-Span-2083\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">R</span><span class=\"mi\" id=\"MathJax-Span-2084\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span><span class=\"mi\" id=\"MathJax-Span-2085\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">O</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2086\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-2087\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-2088\"><span style=\"display: inline-block; position: relative; width: 2.555em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2089\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2090\"><span class=\"mrow\" id=\"MathJax-Span-2091\"><span class=\"mi\" id=\"MathJax-Span-2092\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">G</span><span class=\"mi\" id=\"MathJax-Span-2093\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">R</span><span class=\"mi\" id=\"MathJax-Span-2094\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span><span class=\"mi\" id=\"MathJax-Span-2095\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">O</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2096\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2097\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2098\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2099\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-2100\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2101\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-2102\"><span class=\"mrow\" id=\"MathJax-Span-2103\"><span class=\"mi\" id=\"MathJax-Span-2104\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2105\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2106\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2107\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2108\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-2109\"><span class=\"mrow\" id=\"MathJax-Span-2110\"><span class=\"mi\" id=\"MathJax-Span-2111\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2112\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2113\"><span class=\"mrow\" id=\"MathJax-Span-2114\"><span class=\"mo\" id=\"MathJax-Span-2115\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2116\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2117\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2118\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2119\"><span class=\"mrow\" id=\"MathJax-Span-2120\"><span class=\"mo\" id=\"MathJax-Span-2121\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2122\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2123\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2124\"><span class=\"mrow\" id=\"MathJax-Span-2125\"><span class=\"mi\" id=\"MathJax-Span-2126\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2127\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-2128\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2129\"><span class=\"mrow\" id=\"MathJax-Span-2130\"><span class=\"mo\" id=\"MathJax-Span-2131\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">G</mi><mi mathvariant=\"normal\">R</mi><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">O</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">l</mi></mrow></msubsup><mo>=</mo><mo>−</mo><msup><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">G</mi><mi mathvariant=\"normal\">R</mi><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">O</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>+</mo><msub><mi>c</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow></msub><mo>,</mo><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><msub><mi>π</mi><mi>θ</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span></div>\n<ul>\n  <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-122-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2132\" style=\"width: 1.773em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.46em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2133\"><span class=\"msubsup\" id=\"MathJax-Span-2134\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2135\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-2136\"><span class=\"mrow\" id=\"MathJax-Span-2137\"><span class=\"mi\" id=\"MathJax-Span-2138\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2139\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>c</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-122\">c_{\\rm KL}</script> controls the strength of regularization.</li>\n</ul>\n<h5 id=\"implementation-notes-2\">Implementation Notes</h5>\n<ul>\n  <li>For each decision point, multiple candidate tool calls or answers are sampled in parallel and evaluated.</li>\n  <li>GRPO is particularly well-suited for LLM-based tool-calling agents, where generating multiple alternative completions per state is cheap and informative.</li>\n  <li>By removing the value network and relying on group-relative normalization, GRPO improves stability in settings with sparse rewards, long horizons, and heterogeneous action quality.</li>\n  <li>GRPO serves as a strong baseline and foundation for follow-up methods such as GRPO++, DAPO, and other group- or ranking-based policy optimization variants.</li>\n</ul>\n<h4 id=\"integrating-the-unified-reward\">Integrating the Unified Reward</h4>\n<ul>\n  <li>Given the unified reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-123-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2140\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2141\"><span class=\"mi\" id=\"MathJax-Span-2142\" style=\"font-family: STIXGeneral-Italic;\">R</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-123\">R</script> from the prior step, each step’s <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-124-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2143\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2144\"><span class=\"msubsup\" id=\"MathJax-Span-2145\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2146\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-124\">r_t</script> is used in return and advantage estimation. The policy thus simultaneously learns “when/which/how” tool calling by maximizing return:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-125-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C4;</mi><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2148\" style=\"width: 11.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.534em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1009.22em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2149\"><span class=\"mi\" id=\"MathJax-Span-2150\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2151\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2152\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2153\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2154\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2155\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2156\"><span class=\"mrow\" id=\"MathJax-Span-2157\"><span class=\"mi\" id=\"MathJax-Span-2158\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2159\"><span class=\"mrow\" id=\"MathJax-Span-2160\"><span class=\"mi\" id=\"MathJax-Span-2161\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2162\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"msubsup\" id=\"MathJax-Span-2163\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2164\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2165\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-2166\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2167\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-2168\"><span class=\"munderover\" id=\"MathJax-Span-2169\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2170\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-2171\"><span class=\"mrow\" id=\"MathJax-Span-2172\"><span class=\"mi\" id=\"MathJax-Span-2173\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2174\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-2175\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-2176\"><span class=\"mrow\" id=\"MathJax-Span-2177\"><span class=\"mi\" id=\"MathJax-Span-2178\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2179\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2180\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2181\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2182\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2183\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2184\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2185\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi></mrow></munderover><msup><mi>γ</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>Both PPO and GRPO approximate gradient ascent on <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-126-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2186\" style=\"width: 2.034em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.62em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2187\"><span class=\"mi\" id=\"MathJax-Span-2188\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2189\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2190\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2191\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-126\">J(\\theta)</script> under stability constraints.</li>\n</ul>",
    "contentMarkdown": "*   This section describes how to take the unified reward from the [Unified Reward Formulation](https://aman.ai/primers/ai/RL-for-agents/#unified-reward-formulation) section and plug it into a full RL pipeline—including both Proximal Policy Optimization (PPO) by [Schulman et al., 2017](https://arxiv.org/abs/1707.06347) and Group Relative Policy Optimization (GRPO) by [Shao et al., 2024](https://arxiv.org/abs/2402.03300). We present first the shared components, then algorithm‐specific losses and update rules.\n*   A detailed discourse of preference optimization algorithms is available in the [Preference Optimization](../preference-optimization) primer.\n\n#### Shared RL Training Flow\n\n1.  **Rollout Generation**:\n    \n    *   Use a parameterized decision rule πθπθ\\\\pi\\_\\\\theta (e.g., instantiated by an LLM) to interact with the tool-calling environment defined in the [Environment, MDP Formulation, and Action Space](#environment-mdp-formulation-and-action-space) section.\n    *   At each step ttt, given state ststs\\_t, select an action atata\\_t (such as `CALL` or `ANSWER`), observe the next state st+1st+1s\\_{t+1}, and receive a scalar reward rtrtr\\_t from the unified reward signal.\n    *   Continue interaction until a terminal action (`ANSWER`) is produced or a maximum horizon TTT is reached.\n    *   Collect trajectories of the form: τ\\=(s0,a0,r0),…,(sT−1,aT−1,rT−1),(sT)τ\\=(s0,a0,r0),…,(sT−1,aT−1,rT−1),(sT)\\\\tau = {(s\\_0,a\\_0,r\\_0),\\\\dots,(s\\_{T-1},a\\_{T-1},r\\_{T-1}), (s\\_T)}.\n    *   Depending on the policy optimization method, this step may change substantially: PPO and GRPO rely on explicit on-policy rollouts from the environment, whereas DPO bypasses environment interaction entirely and instead constructs preference pairs from sampled candidate actions or completions under a fixed state.\n2.  **Return and Advantage Estimation**:\n    \n    *   Compute the discounted return from each timestep:\n        \n        Rt\\=∑k\\=tTγk−trkRt\\=∑k\\=tTγk−trk\n        \n        R\\_t = \\\\sum\\_{k=t}^{T} \\\\gamma^{k-t} r\\_k\n    *   Use a learned value model (critic) Vψ(st)Vψ(st)V\\_\\\\psi(s\\_t) to approximate the expected return from state ststs\\_t, serving as a baseline for variance reduction. In alternative setups, statistics may be computed relative to other trajectories collected under the same conditions.\n        \n    *   For PPO, explicit return and advantage estimates are required; for GRPO, advantages are derived from relative statistics within groups of actions; for DPO, this entire step is omitted, as no returns, advantages, or value estimates are computed.\n        \n        *   A generic advantage signal can be formed as:\n            \n            At\\=Rt−Vψ(st)At\\=Rt−Vψ(st)\n            \n            A\\_t = R\\_t - V\\_\\\\psi(s\\_t)\n        *   If multi-step or exponentially weighted estimates are desired, advantages can be computed using temporal-difference residuals derived from the critic:\n            \n            A(λ)t\\=∑l\\=0∞(γλ)lδt+l,δt\\=rt+γVψ(st+1)−Vψ(st)At(λ)\\=∑l\\=0∞(γλ)lδt+l,δt\\=rt+γVψ(st+1)−Vψ(st)\n            \n            A\\_t^{(\\\\lambda)} = \\\\sum\\_{l=0}^{\\\\infty} (\\\\gamma\\\\lambda)^l \\\\delta\\_{t+l}, \\\\quad \\\\delta\\_t = r\\_t + \\\\gamma V\\_\\\\psi(s\\_{t+1}) - V\\_\\\\psi(s\\_t)\n3.  **Policy Update**:\n    \n    *   Update the parameters θθ\\\\theta using a surrogate objective constructed from collected advantages and action likelihoods.\n    *   Update the value model parameters ψψ\\\\psi to better fit observed returns or temporal-difference targets when a critic is present.\n    *   Optionally apply regularization terms, trust-region constraints, or divergence penalties to encourage stable updates.\n    *   The specific loss used here depends on the optimization method: PPO applies a clipped surrogate with an explicit value loss, DPO optimizes a preference-based classification objective against a reference policy, and GRPO uses group-normalized advantages without a learned value model.\n    *   In practice, updates are performed in batches by aggregating multiple trajectories or timesteps into a training batch, optionally shuffling them, and applying one or more optimization steps per batch. For large models, this commonly involves mini-batching, gradient accumulation, and synchronizing updates across parallel workers.\n4.  **Repeat**:\n    \n    *   Iterate between rollout collection and parameter updates when applicable.\n    *   Periodically evaluate performance, tracking metrics such as tool-use timing (“when”), tool choice (“which”), argument correctness (“how”), and overall task success.\n\n**Rollout Generation**:\n\n*   Use a parameterized decision rule πθπθ\\\\pi\\_\\\\theta (e.g., instantiated by an LLM) to interact with the tool-calling environment defined in the [Environment, MDP Formulation, and Action Space](#environment-mdp-formulation-and-action-space) section.\n*   At each step ttt, given state ststs\\_t, select an action atata\\_t (such as `CALL` or `ANSWER`), observe the next state st+1st+1s\\_{t+1}, and receive a scalar reward rtrtr\\_t from the unified reward signal.\n*   Continue interaction until a terminal action (`ANSWER`) is produced or a maximum horizon TTT is reached.\n*   Collect trajectories of the form: τ\\=(s0,a0,r0),…,(sT−1,aT−1,rT−1),(sT)τ\\=(s0,a0,r0),…,(sT−1,aT−1,rT−1),(sT)\\\\tau = {(s\\_0,a\\_0,r\\_0),\\\\dots,(s\\_{T-1},a\\_{T-1},r\\_{T-1}), (s\\_T)}.\n*   Depending on the policy optimization method, this step may change substantially: PPO and GRPO rely on explicit on-policy rollouts from the environment, whereas DPO bypasses environment interaction entirely and instead constructs preference pairs from sampled candidate actions or completions under a fixed state.\n\n**Return and Advantage Estimation**:\n\n*   Compute the discounted return from each timestep:\n    \n    Rt\\=∑k\\=tTγk−trkRt\\=∑k\\=tTγk−trk\n    \n    R\\_t = \\\\sum\\_{k=t}^{T} \\\\gamma^{k-t} r\\_k\n*   Use a learned value model (critic) Vψ(st)Vψ(st)V\\_\\\\psi(s\\_t) to approximate the expected return from state ststs\\_t, serving as a baseline for variance reduction. In alternative setups, statistics may be computed relative to other trajectories collected under the same conditions.\n    \n*   For PPO, explicit return and advantage estimates are required; for GRPO, advantages are derived from relative statistics within groups of actions; for DPO, this entire step is omitted, as no returns, advantages, or value estimates are computed.\n    \n    *   A generic advantage signal can be formed as:\n        \n        At\\=Rt−Vψ(st)At\\=Rt−Vψ(st)\n        \n        A\\_t = R\\_t - V\\_\\\\psi(s\\_t)\n    *   If multi-step or exponentially weighted estimates are desired, advantages can be computed using temporal-difference residuals derived from the critic:\n        \n        A(λ)t\\=∑l\\=0∞(γλ)lδt+l,δt\\=rt+γVψ(st+1)−Vψ(st)At(λ)\\=∑l\\=0∞(γλ)lδt+l,δt\\=rt+γVψ(st+1)−Vψ(st)\n        \n        A\\_t^{(\\\\lambda)} = \\\\sum\\_{l=0}^{\\\\infty} (\\\\gamma\\\\lambda)^l \\\\delta\\_{t+l}, \\\\quad \\\\delta\\_t = r\\_t + \\\\gamma V\\_\\\\psi(s\\_{t+1}) - V\\_\\\\psi(s\\_t)\n\nCompute the discounted return from each timestep:\n\nUse a learned value model (critic) Vψ(st)Vψ(st)V\\_\\\\psi(s\\_t) to approximate the expected return from state ststs\\_t, serving as a baseline for variance reduction. In alternative setups, statistics may be computed relative to other trajectories collected under the same conditions.\n\nFor PPO, explicit return and advantage estimates are required; for GRPO, advantages are derived from relative statistics within groups of actions; for DPO, this entire step is omitted, as no returns, advantages, or value estimates are computed.\n\n*   A generic advantage signal can be formed as:\n    \n    At\\=Rt−Vψ(st)At\\=Rt−Vψ(st)\n    \n    A\\_t = R\\_t - V\\_\\\\psi(s\\_t)\n*   If multi-step or exponentially weighted estimates are desired, advantages can be computed using temporal-difference residuals derived from the critic:\n    \n    A(λ)t\\=∑l\\=0∞(γλ)lδt+l,δt\\=rt+γVψ(st+1)−Vψ(st)At(λ)\\=∑l\\=0∞(γλ)lδt+l,δt\\=rt+γVψ(st+1)−Vψ(st)\n    \n    A\\_t^{(\\\\lambda)} = \\\\sum\\_{l=0}^{\\\\infty} (\\\\gamma\\\\lambda)^l \\\\delta\\_{t+l}, \\\\quad \\\\delta\\_t = r\\_t + \\\\gamma V\\_\\\\psi(s\\_{t+1}) - V\\_\\\\psi(s\\_t)\n\nA generic advantage signal can be formed as:\n\nIf multi-step or exponentially weighted estimates are desired, advantages can be computed using temporal-difference residuals derived from the critic:\n\n**Policy Update**:\n\n*   Update the parameters θθ\\\\theta using a surrogate objective constructed from collected advantages and action likelihoods.\n*   Update the value model parameters ψψ\\\\psi to better fit observed returns or temporal-difference targets when a critic is present.\n*   Optionally apply regularization terms, trust-region constraints, or divergence penalties to encourage stable updates.\n*   The specific loss used here depends on the optimization method: PPO applies a clipped surrogate with an explicit value loss, DPO optimizes a preference-based classification objective against a reference policy, and GRPO uses group-normalized advantages without a learned value model.\n*   In practice, updates are performed in batches by aggregating multiple trajectories or timesteps into a training batch, optionally shuffling them, and applying one or more optimization steps per batch. For large models, this commonly involves mini-batching, gradient accumulation, and synchronizing updates across parallel workers.\n\n**Repeat**:\n\n*   Iterate between rollout collection and parameter updates when applicable.\n*   Periodically evaluate performance, tracking metrics such as tool-use timing (“when”), tool choice (“which”), argument correctness (“how”), and overall task success.\n\n#### Common Policy Optimization Choices\n\n*   A widely used class of approaches builds on proximal policy updates that constrain each optimization step to remain close to the previous policy, improving stability when training large language models as agents. A canonical example is Proximal Policy Optimization (PPO), introduced in [Proximal Policy Optimization Algorithms](https://arxiv.org/abs/1707.06347) by Schulman et al. (2017), which combines advantage-weighted updates with explicit mechanisms to limit destructive policy shifts.\n*   Subsequently, preference-based formulations such as Direct Preference Optimization (DPO), proposed in [Direct Preference Optimization: Your Language Model is Secretly a Reward Model](https://arxiv.org/abs/2305.18290) by Rafailov et al. (2023), replaced explicit reward modeling with relative comparisons, a pattern that has proven especially effective for aligning agent behaviors with human judgments.\n*   More recent agentic RL systems increasingly rely on group-relative objectives that normalize rewards or advantages across sets of trajectories, reducing sensitivity to reward scale and long-horizon variance. Group Relative Policy Optimization (GRPO), introduced in [DeepSeekMath: Pushing the Limits of Mathematical Reasoning in Open Language Models](https://arxiv.org/abs/2402.03300) by Shao et al. (2024), has been adopted as a strong baseline for tool-using and reasoning agents. Follow-up variants, for instance DAPO proposed in [DAPO: An Open-Source LLM Reinforcement Learning System at Scale](https://arxiv.org/abs/2503.14476) by Yu et al. (2025) and [GRPO+](https://pretty-radio-b75.notion.site/DeepCoder-A-Fully-Open-Source-14B-Coder-at-O3-mini-Level-1cf81902c14680b3bee5eb349a512a51) extend group-relative normalization with improved baselines, dynamic grouping, or more stable update rules, as explored in works such and subsequent technical reports and open-source implementations. These methods are increasingly favored in agentic RL because they better handle sparse rewards, heterogeneous trajectories, and multi-step tool use without relying on brittle reward shaping.\n\n#### PPO: Losses and Update Rules\n\n##### Surrogate Objective\n\n*   Proximal Policy Optimization (PPO), introduced in [Proximal Policy Optimization Algorithms](https://arxiv.org/abs/1707.06347) by Schulman et al. (2017), optimizes a clipped surrogate objective that constrains policy updates to remain close to the previous policy. The most commonly used objective is the clipped surrogate:\n\nLCLIP(θ)\\=𝔼st,at∼πθold\\[min(rt(θ)At,clip(rt(θ),1−ϵ,1+ϵ)At)\\]LCLIP(θ)\\=Est,at∼πθold\\[min(rt(θ)At,clip(rt(θ),1−ϵ,1+ϵ)At)\\]\n\n*   … where the importance sampling ratio is:\n\nrt(θ)\\=πθ(at∣st)πθold(at∣st)rt(θ)\\=πθ(at∣st)πθold(at∣st)\n\n*   … and ϵ≈0.1–0.3ϵ≈0.1–0.3\\\\epsilon \\\\approx 0.1\\\\text{–}0.3 controls the trust region implicitly.\n\n##### Value Loss\n\n*   PPO is typically implemented in an actor–critic setting, where a learned value model VψVψV\\_\\\\psi is trained jointly with the policy:\n\nLvalue(ψ)\\=𝔼st∼πθold\\[(Vψ(st)−Rt)2\\]Lvalue(ψ)\\=Est∼πθold\\[(Vψ(st)−Rt)2\\]\n\n##### KL Regularization in Practice\n\n*   In the original PPO formulation proposed in [Proximal Policy Optimization Algorithms](https://arxiv.org/abs/1707.06347) by Schulman et al. (2017), the KL divergence is **not** added directly to the clipped objective. Instead:\n    \n    *   The clipped objective LCLIPLCLIPL^{\\\\rm CLIP} serves as the primary mechanism for constraining policy updates, and\n    *   The KL divergence is monitored as a diagnostic, optionally triggering early stopping.\n*   [Proximal Policy Optimization Algorithms](https://arxiv.org/abs/1707.06347) also proposes an alternative objective, often referred to as the KL-penalized form:\n    \n    LKLPEN(θ)\\=𝔼st,at\\[rt(θ)At−β,KL(πθold(⋅|st)|πθ(⋅|st))\\]LKLPEN(θ)\\=Est,at\\[rt(θ)At−β,KL(πθold(⋅|st)|πθ(⋅|st))\\]\n    \n    L^{\\\\rm KLPEN}(\\\\theta) =\\\\mathbb{E}\\_{s\\_t,a\\_t} \\\\big\\[ r\\_t(\\\\theta)A\\_t - \\\\beta,\\\\mathrm{KL}\\\\big(\\\\pi\\_{\\\\theta\\_{\\\\rm old}}(\\\\cdot|s\\_t) | \\\\pi\\_\\\\theta(\\\\cdot|s\\_t)\\\\big) \\\\big\\]\n    *   where ββ\\\\beta is adaptively tuned. In practice, most modern implementations favor the clipped objective for its robustness.\n\nIn the original PPO formulation proposed in [Proximal Policy Optimization Algorithms](https://arxiv.org/abs/1707.06347) by Schulman et al. (2017), the KL divergence is **not** added directly to the clipped objective. Instead:\n\n*   The clipped objective LCLIPLCLIPL^{\\\\rm CLIP} serves as the primary mechanism for constraining policy updates, and\n*   The KL divergence is monitored as a diagnostic, optionally triggering early stopping.\n\n[Proximal Policy Optimization Algorithms](https://arxiv.org/abs/1707.06347) also proposes an alternative objective, often referred to as the KL-penalized form:\n\n*   where ββ\\\\beta is adaptively tuned. In practice, most modern implementations favor the clipped objective for its robustness.\n\n##### KL Regularization in RLHF / LLM Settings\n\n*   In RLHF-style training for language models, such as [Training Language Models to Follow Instructions with Human Feedback](https://arxiv.org/abs/2203.02155) by Ouyang et al. (2022), KL regularization is applied **at the reward level**, not directly in the PPO loss.\n    \n*   Specifically, the per-step reward is modified as:\n    \n\nIn RLHF-style training for language models, such as [Training Language Models to Follow Instructions with Human Feedback](https://arxiv.org/abs/2203.02155) by Ouyang et al. (2022), KL regularization is applied **at the reward level**, not directly in the PPO loss.\n\nSpecifically, the per-step reward is modified as:\n\nr̃ t\\=renvt(st,at)−βlogπθ(at∣st)πref(at∣st)r~t\\=rtenv(st,at)−βlog⁡πθ(at∣st)πref(at∣st)\n\n*   PPO is then run using r̃ tr~t\\\\tilde r\\_t to compute returns and advantages, while the policy loss remains the standard clipped surrogate LCLIPLCLIPL^{\\\\rm CLIP}. This approach preserves PPO’s structure while explicitly anchoring the policy to a reference (typically an SFT model).\n\n##### Full PPO Objective (Typical Actor–Critic Form)\n\n*   With reward-level KL regularization, the overall optimization minimizes:\n    \n    LtotalPPO\\=−LCLIP(θ)+cvLvalue(ψ)LPPOtotal\\=−LCLIP(θ)+cvLvalue(ψ)\n    \n    L^{\\\\rm total}\\_{\\\\rm PPO} = - L^{\\\\rm CLIP}(\\\\theta) + c\\_v L\\_{\\\\rm value}(\\\\psi)\n    *   where the KL penalty influences learning implicitly through the shaped rewards rather than appearing as a separate loss term.\n\nWith reward-level KL regularization, the overall optimization minimizes:\n\n*   where the KL penalty influences learning implicitly through the shaped rewards rather than appearing as a separate loss term.\n\n##### Implementation Notes\n\n*   Use mini-batches and multiple epochs per rollout.\n*   Shuffle trajectories and apply Adam or AdamW optimizers.\n*   Clip gradients and monitor KL divergence, entropy, and task-specific metrics such as tool-calling accuracy and argument correctness.\n\n#### DPO: Losses and Update Rules\n\n##### Preference Data Construction\n\n*   Direct Preference Optimization (DPO), proposed in [Direct Preference Optimization: Your Language Model is Secretly a Reward Model](https://arxiv.org/abs/2305.18290) by Rafailov et al. (2023), reframes alignment as maximizing the probability that the fine-tuned model ranks preferred outputs higher than non-preferred ones, bypassing the explicit RL loop.\n*   Direct Preference Optimization operates on paired preferences rather than full trajectories. From the unified reward formulation, pairs of candidate actions or completions (a+,a−)(a+,a−)(a^+, a^-) are generated under the same state sss, where a+a+a^+ is preferred over a−a−a^- according to higher reward:\n\nr(s,a+)\\>r(s,a−)r(s,a+)\\>r(s,a−)\n\n*   In agentic RL settings, such pairs are typically obtained by sampling multiple tool-use or answer candidates for the same state and ranking them using the unified reward, human feedback, or AI-based evaluators.\n\n##### DPO Objective\n\n*   DPO directly optimizes the policy without an explicit reward model or value critic by exploiting a closed-form relationship between rewards and optimal policies under a KL-regularized RL objective. As shown in [Direct Preference Optimization: Your Language Model is Secretly a Reward Model](https://arxiv.org/abs/2305.18290) by Rafailov et al. (2023), the KL-constrained RL objective admits an optimal policy of the form:\n\nπ∗(a∣s)∝πref(a∣s)exp(1βr(s,a))π∗(a∣s)∝πref(a∣s)exp⁡(1βr(s,a))\n\n*   Reparameterizing the reward in terms of the policy yields an implicit reward:\n\nr̂ θ(s,a)\\=βlogπθ(a∣s)πref(a∣s)r^θ(s,a)\\=βlog⁡πθ(a∣s)πref(a∣s)\n\n*   Substituting this form into a Bradley–Terry preference model leads to the DPO loss:\n    \n    LDPO(θ)\\=−𝔼(s,a+,a−)\\[logσ(β(logπθ(a+∣s)πref(a+∣s)−logπθ(a−∣s)πref(a−∣s)))\\]LDPO(θ)\\=−E(s,a+,a−)\\[log⁡σ(β(log⁡πθ(a+∣s)πref(a+∣s)−log⁡πθ(a−∣s)πref(a−∣s)))\\]\n    \n    L^{\\\\rm DPO}(\\\\theta) = - \\\\mathbb{E}\\_{(s,a^+,a^-)} \\\\left\\[ \\\\log \\\\sigma \\\\left( \\\\beta \\\\left( \\\\log \\\\frac{\\\\pi\\_\\\\theta(a^+ \\\\mid s)}{\\\\pi\\_{\\\\rm ref}(a^+ \\\\mid s)} - \\\\log \\\\frac{\\\\pi\\_\\\\theta(a^- \\\\mid s)}{\\\\pi\\_{\\\\rm ref}(a^- \\\\mid s)} \\\\right) \\\\right) \\\\right\\]\n    *   where πrefπref\\\\pi\\_{\\\\rm ref} is a fixed reference policy (typically the SFT model), σσ\\\\sigma denotes the logistic sigmoid, and ββ\\\\beta controls the strength of the KL regularization.\n\nSubstituting this form into a Bradley–Terry preference model leads to the DPO loss:\n\n*   where πrefπref\\\\pi\\_{\\\\rm ref} is a fixed reference policy (typically the SFT model), σσ\\\\sigma denotes the logistic sigmoid, and ββ\\\\beta controls the strength of the KL regularization.\n\n##### Relation to RL Objectives\n\n*   DPO can be interpreted as exactly optimizing the same KL-regularized expected reward objective used in PPO-based RLHF, but without:\n    \n    *   explicit rollouts,\n    *   Monte Carlo return estimation,\n    *   or a learned value function.\n*   The preference loss implicitly enforces both reward maximization and proximity to the reference policy, recovering the optimal policy in closed form under the assumed preference model .\n    \n\nDPO can be interpreted as exactly optimizing the same KL-regularized expected reward objective used in PPO-based RLHF, but without:\n\n*   explicit rollouts,\n*   Monte Carlo return estimation,\n*   or a learned value function.\n\nThe preference loss implicitly enforces both reward maximization and proximity to the reference policy, recovering the optimal policy in closed form under the assumed preference model .\n\n##### Value Loss\n\n*   DPO does not train a parametric value model VψVψV\\_\\\\psi.\n*   Baselines and normalization arise implicitly from the policy–reference ratio, eliminating the need for critic learning or advantage estimation.\n\n##### KL / Regularization\n\n*   The KL constraint is baked directly into the objective via the policy ratio against πrefπref\\\\pi\\_{\\\\rm ref}.\n*   The coefficient ββ\\\\beta plays an analogous role to the KL penalty weight in PPO, controlling the reward–conservativeness tradeoff.\n\n##### Full DPO Loss\n\nLtotalDPO(θ)\\=LDPO(θ)LDPOtotal(θ)\\=LDPO(θ)\n\n*   No auxiliary losses are required.\n\n##### Implementation Notes\n\n*   Training is fully offline and supervised over preference pairs.\n*   No environment interaction or on-policy rollouts are required during optimization.\n*   Particularly attractive for agentic RL settings with reliable reward-based ranking but expensive or unstable long-horizon rollouts.\n*   Often used as a simpler alternative or complement to PPO, and as a conceptual bridge between PPO-style RL and group-relative methods such as GRPO.\n\n#### GRPO: Losses and Update Rules\n\n##### Group Sampling & Relative Advantage\n\n*   In Group Relative Policy Optimization (GRPO), introduced in [Group Relative Policy Optimization](https://arxiv.org/abs/2402.03300) by Shao et al. (2024), a group of GGG candidate actions (a1,…,aG)(a1,…,aG)(a\\_1,\\\\dots,a\\_G) is sampled under the same state sss using the current or previous policy.\n*   Each candidate action is evaluated with the unified reward to obtain r(s,aj)r(s,aj)r(s,a\\_j). Group-level statistics are then computed:\n    *   mean reward μμ\\\\mu,\n    *   standard deviation σσ\\\\sigma.\n*   A normalized, group-relative advantage is assigned to each action:\n\n*   mean reward μμ\\\\mu,\n*   standard deviation σσ\\\\sigma.\n\nAGRPO(s,aj)\\=r(s,aj)−μσAGRPO(s,aj)\\=r(s,aj)−μσ\n\n*   This construction removes dependence on an explicit value function and normalizes rewards across heterogeneous candidates.\n\n##### GRPO Surrogate Objective\n\n*   GRPO uses a PPO-style clipped surrogate objective, but replaces standard advantages with group-relative advantages:\n\nLGRPO(θ)\\=1G∑j\\=1G𝔼s,a1:G∼πθold\\[min(rj(θ)AGRPO(s,aj),clip(rj(θ),1−ϵ,1+ϵ)AGRPO(s,aj))\\]LGRPO(θ)\\=1G∑j\\=1GEs,a1:G∼πθold\\[min(rj(θ)AGRPO(s,aj),clip(rj(θ),1−ϵ,1+ϵ)AGRPO(s,aj))\\]\n\n*   … where the probability ratio is defined as:\n\nrj(θ)\\=πθ(aj∣s)πθold(aj∣s)rj(θ)\\=πθ(aj∣s)πθold(aj∣s)\n\n*   As in PPO, the clipping parameter ϵϵ\\\\epsilon constrains the size of policy updates for stability.\n\n##### Value Loss\n\n*   GRPO typically omits a parametric value estimator VψVψV\\_\\\\psi.\n*   Baselines are derived implicitly from group statistics, eliminating the need for critic training and avoiding value-function instability in long-horizon or sparse-reward agentic tasks.\n\n##### KL / Entropy Regularization\n\n*   Unlike PPO-style RLHF pipelines where KL penalties are often folded directly into the reward, GRPO incorporates KL regularization at the optimization stage using an unbiased estimator of the KL divergence proposed in [A Surrogate Loss for Reinforcement Learning](https://arxiv.org/abs/2009.10897) by Schulman (2020). Per the paper, the per-token KL divergence between the current policy πθπθ\\\\pi\\_\\\\theta and a reference policy πrefπref\\\\pi\\_{\\\\rm ref} can be estimated as:\n\nDKL\\[πθ|πref\\]\\=πref(at∣st)πθ(at∣st)−log(πref(at∣st)πθ(at∣st))−1DKL\\[πθ|πref\\]\\=πref(at∣st)πθ(at∣st)−log⁡(πref(at∣st)πθ(at∣st))−1\n\n*   This estimator is unbiased and can be added directly to the loss without modifying the reward signal.\n*   In practice, this term acts as a trust-region constraint, discouraging excessive deviation from the reference policy while preserving the relative structure of group-normalized advantages.\n\n##### Full GRPO Loss\n\nLtotalGRPO\\=−LGRPO(θ)+cKL,DKL\\[πθ|πref\\]LGRPOtotal\\=−LGRPO(θ)+cKL,DKL\\[πθ|πref\\]\n\n*   where cKLcKLc\\_{\\\\rm KL} controls the strength of regularization.\n\n##### Implementation Notes\n\n*   For each decision point, multiple candidate tool calls or answers are sampled in parallel and evaluated.\n*   GRPO is particularly well-suited for LLM-based tool-calling agents, where generating multiple alternative completions per state is cheap and informative.\n*   By removing the value network and relying on group-relative normalization, GRPO improves stability in settings with sparse rewards, long horizons, and heterogeneous action quality.\n*   GRPO serves as a strong baseline and foundation for follow-up methods such as GRPO++, DAPO, and other group- or ranking-based policy optimization variants.\n\n#### Integrating the Unified Reward\n\n*   Given the unified reward RRR from the prior step, each step’s rtrtr\\_t is used in return and advantage estimation. The policy thus simultaneously learns “when/which/how” tool calling by maximizing return:\n\nJ(θ)\\=𝔼τ∼πθ\\[∑t\\=0Tγtrt\\]J(θ)\\=Eτ∼πθ\\[∑t\\=0Tγtrt\\]\n\n*   Both PPO and GRPO approximate gradient ascent on J(θ)J(θ)J(\\\\theta) under stability constraints.",
    "order": 6,
    "orderInChapter": 5,
    "difficulty": 4,
    "estimatedMinutes": 15,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "reinforcement learning",
      "optimization",
      "regularization"
    ],
    "metadata": {
      "hasCode": true,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 2999,
      "contentLength": 462962
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#rl-optimization-pipeline:-ppo-vs.-dpo-vs.-grpo",
    "scrapedAt": "2025-12-28T11:47:36.151Z"
  },
  {
    "id": "ai-agentic-RL-curriculum-design-7",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Background: Teaching Agents Tool-Calling with RL",
    "title": "Curriculum Design",
    "subtitle": "Background: Teaching Agents Tool-Calling with RL",
    "contentHtml": "<ul>\n  <li>This section describes how to structure training so the model reliably learns <strong>when</strong>, <strong>which</strong>, and <strong>how</strong> to call tools, and how to evaluate progress during RL. Curriculum design is crucial because tool-calling is a hierarchical skill; introducing complexity too early destabilizes learning, and introducing it too late yields underfitting.</li>\n  <li>\n    <p>Curriculum design gradually increases difficulty along three axes:</p>\n\n    <ol>\n      <li><strong>When</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-127-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2192\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2193\"><span class=\"mo\" id=\"MathJax-Span-2194\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-127\">\\rightarrow</script> recognizing tool necessity vs. non-necessity</li>\n      <li><strong>Which</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-128-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2195\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2196\"><span class=\"mo\" id=\"MathJax-Span-2197\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-128\">\\rightarrow</script> selecting the correct tool</li>\n      <li><strong>How</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-129-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2198\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2199\"><span class=\"mo\" id=\"MathJax-Span-2200\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-129\">\\rightarrow</script> providing high-quality arguments</li>\n    </ol>\n  </li>\n  <li>\n    <p>Each axis has its own progression. The curriculum alternates between breadth (many domains/tools) and depth (multi-step workflows).</p>\n  </li>\n  <li>\n    <p>This staged approach mirrors the structured curricula seen in code-generation RL (e.g., unit-tests <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-130-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2201\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2202\"><span class=\"mo\" id=\"MathJax-Span-2203\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-130\">\\rightarrow</script> multi-step tasks) in works like <a href=\"https://arxiv.org/abs/2303.17651\">Self-Refine</a> by Madaan et al. (2023).</p>\n  </li>\n  <li>A well-designed curriculum ensures the policy does not simply memorize tool-call structures but truly internalizes <strong>when</strong> tool use is warranted, <strong>which</strong> tool to call, <strong>how</strong> to call it correctly, and how to combine tools into <strong>multi-step workflows</strong> to solve real tasks.</li>\n</ul>\n<p>Curriculum design gradually increases difficulty along three axes:</p>\n<ol>\n      <li><strong>When</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-127-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2192\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2193\"><span class=\"mo\" id=\"MathJax-Span-2194\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-127\">\\rightarrow</script> recognizing tool necessity vs. non-necessity</li>\n      <li><strong>Which</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-128-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2195\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2196\"><span class=\"mo\" id=\"MathJax-Span-2197\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-128\">\\rightarrow</script> selecting the correct tool</li>\n      <li><strong>How</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-129-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2198\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2199\"><span class=\"mo\" id=\"MathJax-Span-2200\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-129\">\\rightarrow</script> providing high-quality arguments</li>\n    </ol>\n<p>Each axis has its own progression. The curriculum alternates between breadth (many domains/tools) and depth (multi-step workflows).</p>\n<p>This staged approach mirrors the structured curricula seen in code-generation RL (e.g., unit-tests <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-130-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2201\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2202\"><span class=\"mo\" id=\"MathJax-Span-2203\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-130\">\\rightarrow</script> multi-step tasks) in works like <a href=\"https://arxiv.org/abs/2303.17651\">Self-Refine</a> by Madaan et al. (2023).</p>\n<h4 id=\"stage-0-pure-supervised-bootstrapping-sft\">Stage 0: Pure Supervised Bootstrapping (SFT)</h4>\n<ul>\n  <li>\n    <p>Before RL begins, do supervised fine-tuning on a dataset that explicitly includes:</p>\n\n    <ul>\n      <li>Examples requiring a tool,</li>\n      <li>Examples that must <em>not</em> use a tool,</li>\n      <li>Examples mapping queries to correct tool types,</li>\n      <li>Examples showing valid argument formats.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The SFT initializes:</p>\n\n    <ul>\n      <li>An approximately correct “when <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-131-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2204\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2205\"><span class=\"mo\" id=\"MathJax-Span-2206\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-131\">\\rightarrow</script> which <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-132-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2207\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2208\"><span class=\"mo\" id=\"MathJax-Span-2209\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-132\">\\rightarrow</script> how” policy,</li>\n      <li>JSON formatting reliability,</li>\n      <li>Stable tool-calling syntax.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This prevents “flailing” during early RL where the model might emit random tool calls.</p>\n  </li>\n</ul>\n<p>Before RL begins, do supervised fine-tuning on a dataset that explicitly includes:</p>\n<ul>\n      <li>Examples requiring a tool,</li>\n      <li>Examples that must <em>not</em> use a tool,</li>\n      <li>Examples mapping queries to correct tool types,</li>\n      <li>Examples showing valid argument formats.</li>\n    </ul>\n<p>The SFT initializes:</p>\n<ul>\n      <li>An approximately correct “when <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-131-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2204\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2205\"><span class=\"mo\" id=\"MathJax-Span-2206\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-131\">\\rightarrow</script> which <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-132-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2207\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2208\"><span class=\"mo\" id=\"MathJax-Span-2209\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-132\">\\rightarrow</script> how” policy,</li>\n      <li>JSON formatting reliability,</li>\n      <li>Stable tool-calling syntax.</li>\n    </ul>\n<p>This prevents “flailing” during early RL where the model might emit random tool calls.</p>\n<h4 id=\"stage-1-binary-decision-curriculum-learning-when\">Stage 1: Binary Decision Curriculum (Learning <strong>When</strong>)</h4>\n<ul>\n  <li>\n    <p><strong>Focus:</strong> detect whether a tool is required.</p>\n  </li>\n  <li>\n    <p><strong>Task mix:</strong></p>\n\n    <ul>\n      <li>50% queries that require a specific tool (weather/math/search)</li>\n      <li>50% queries that must be answered without tools</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Goal:</strong> learn the call/no-call boundary.</p>\n  </li>\n  <li>\n    <p><strong>Metrics:</strong></p>\n\n    <ul>\n      <li>Call precision</li>\n      <li>Call recall</li>\n      <li>False-positive rate (unnecessary calls)</li>\n      <li>False-negative rate (missed calls)</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Reward emphasis:</strong></p>\n\n    <ul>\n      <li>Increase <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-133-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>call</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2210\" style=\"width: 2.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.77em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2211\"><span class=\"msubsup\" id=\"MathJax-Span-2212\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2213\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-2214\"><span class=\"mrow\" id=\"MathJax-Span-2215\"><span class=\"mtext\" id=\"MathJax-Span-2216\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">call</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>call</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-133\">w_{\\text{call}}</script></li>\n      <li>Reduce penalties for syntax/execution errors early on</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Focus:</strong> detect whether a tool is required.</p>\n<p><strong>Task mix:</strong></p>\n<ul>\n      <li>50% queries that require a specific tool (weather/math/search)</li>\n      <li>50% queries that must be answered without tools</li>\n    </ul>\n<p><strong>Goal:</strong> learn the call/no-call boundary.</p>\n<p><strong>Metrics:</strong></p>\n<ul>\n      <li>Call precision</li>\n      <li>Call recall</li>\n      <li>False-positive rate (unnecessary calls)</li>\n      <li>False-negative rate (missed calls)</li>\n    </ul>\n<p><strong>Reward emphasis:</strong></p>\n<ul>\n      <li>Increase <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-133-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>call</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2210\" style=\"width: 2.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.77em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2211\"><span class=\"msubsup\" id=\"MathJax-Span-2212\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2213\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-2214\"><span class=\"mrow\" id=\"MathJax-Span-2215\"><span class=\"mtext\" id=\"MathJax-Span-2216\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">call</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>call</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-133\">w_{\\text{call}}</script></li>\n      <li>Reduce penalties for syntax/execution errors early on</li>\n    </ul>\n<h4 id=\"stage-2-tool-selection-curriculum-learning-which\">Stage 2: Tool-Selection Curriculum (Learning <strong>Which</strong>)</h4>\n<ul>\n  <li>\n    <p>Add tasks that require choosing <em>between</em> tools:</p>\n  </li>\n  <li>\n    <p><strong>Task examples:</strong></p>\n\n    <ul>\n      <li>Weather vs. news</li>\n      <li>Search vs. calculator</li>\n      <li>Translation vs. summarization (if tools exist)</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Goal:</strong> learn discriminative mapping from task intent <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-134-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2217\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2218\"><span class=\"mo\" id=\"MathJax-Span-2219\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-134\">\\rightarrow</script> tool identity.</p>\n  </li>\n  <li>\n    <p><strong>Curriculum trick:</strong></p>\n\n    <ul>\n      <li>For ambiguous queries, include diverse examples so the RL agent learns to think (internal chain-of-thought) before issuing tool calls.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Metrics:</strong></p>\n\n    <ul>\n      <li>Tool-selection accuracy</li>\n      <li>Confusion matrix across tool categories</li>\n      <li>Average number of tool attempts per query</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Reward emphasis:</strong></p>\n\n    <ul>\n      <li>Shift weight from <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-135-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>call</mtext></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2220\" style=\"width: 2.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.03em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2221\"><span class=\"msubsup\" id=\"MathJax-Span-2222\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2223\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-2224\"><span class=\"mrow\" id=\"MathJax-Span-2225\"><span class=\"mtext\" id=\"MathJax-Span-2226\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">call</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2227\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>call</mtext></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-135\">w_{\\text{call}})</script>\\rightarrow<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-136-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>which</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2228\" style=\"width: 3.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.76em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2229\"><span class=\"mo\" id=\"MathJax-Span-2230\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2231\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2232\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-2233\"><span class=\"mrow\" id=\"MathJax-Span-2234\"><span class=\"mtext\" id=\"MathJax-Span-2235\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">which</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>which</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-136\">(w_{\\text{which}}</script></li>\n      <li>Introduce penalties for repeated incorrect tool choices</li>\n    </ul>\n  </li>\n</ul>\n<p>Add tasks that require choosing <em>between</em> tools:</p>\n<p><strong>Task examples:</strong></p>\n<ul>\n      <li>Weather vs. news</li>\n      <li>Search vs. calculator</li>\n      <li>Translation vs. summarization (if tools exist)</li>\n    </ul>\n<p><strong>Goal:</strong> learn discriminative mapping from task intent <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-134-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2217\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2218\"><span class=\"mo\" id=\"MathJax-Span-2219\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-134\">\\rightarrow</script> tool identity.</p>\n<p><strong>Curriculum trick:</strong></p>\n<ul>\n      <li>For ambiguous queries, include diverse examples so the RL agent learns to think (internal chain-of-thought) before issuing tool calls.</li>\n    </ul>\n<p><strong>Metrics:</strong></p>\n<ul>\n      <li>Tool-selection accuracy</li>\n      <li>Confusion matrix across tool categories</li>\n      <li>Average number of tool attempts per query</li>\n    </ul>\n<p><strong>Reward emphasis:</strong></p>\n<ul>\n      <li>Shift weight from <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-135-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>call</mtext></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2220\" style=\"width: 2.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.03em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2221\"><span class=\"msubsup\" id=\"MathJax-Span-2222\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2223\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-2224\"><span class=\"mrow\" id=\"MathJax-Span-2225\"><span class=\"mtext\" id=\"MathJax-Span-2226\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">call</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2227\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>call</mtext></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-135\">w_{\\text{call}})</script>\\rightarrow<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-136-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>which</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2228\" style=\"width: 3.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.76em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2229\"><span class=\"mo\" id=\"MathJax-Span-2230\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2231\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2232\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-2233\"><span class=\"mrow\" id=\"MathJax-Span-2234\"><span class=\"mtext\" id=\"MathJax-Span-2235\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">which</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>which</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-136\">(w_{\\text{which}}</script></li>\n      <li>Introduce penalties for repeated incorrect tool choices</li>\n    </ul>\n<h4 id=\"stage-3-argument-construction-curriculum-learning-how\">Stage 3: Argument-Construction Curriculum (Learning <strong>How</strong>)</h4>\n<ul>\n  <li>\n    <p>Introduce tasks with argument complexity:</p>\n\n    <ul>\n      <li>\n        <p><strong>Task examples:</strong></p>\n\n        <ul>\n          <li>Weather(city, date)</li>\n          <li>Maps(location, radius)</li>\n          <li>Calculation(expressions with multiple steps)</li>\n          <li>API requiring nested JSON fields</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Training strategy:</strong></p>\n\n        <ul>\n          <li>Start with minimal arguments (one field)</li>\n          <li>Add multi-argument calls</li>\n          <li>Introduce noisy contexts (typos, ambiguity)</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Metrics:</strong></p>\n\n        <ul>\n          <li>Argument correctness (string similarity or numeric error)</li>\n          <li>Schema completeness</li>\n          <li>Tool execution success rate</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Reward emphasis:</strong></p>\n\n        <ul>\n          <li>Increase <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-137-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>args</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2236\" style=\"width: 2.346em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.93em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2237\"><span class=\"msubsup\" id=\"MathJax-Span-2238\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2239\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-2240\"><span class=\"mrow\" id=\"MathJax-Span-2241\"><span class=\"mtext\" id=\"MathJax-Span-2242\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">args</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>args</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-137\">w_{\\text{args}}</script></li>\n          <li>Tighten penalty for malformed JSON or missing fields</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n</ul>\n<p>Introduce tasks with argument complexity:</p>\n<ul>\n      <li>\n        <p><strong>Task examples:</strong></p>\n\n        <ul>\n          <li>Weather(city, date)</li>\n          <li>Maps(location, radius)</li>\n          <li>Calculation(expressions with multiple steps)</li>\n          <li>API requiring nested JSON fields</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Training strategy:</strong></p>\n\n        <ul>\n          <li>Start with minimal arguments (one field)</li>\n          <li>Add multi-argument calls</li>\n          <li>Introduce noisy contexts (typos, ambiguity)</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Metrics:</strong></p>\n\n        <ul>\n          <li>Argument correctness (string similarity or numeric error)</li>\n          <li>Schema completeness</li>\n          <li>Tool execution success rate</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Reward emphasis:</strong></p>\n\n        <ul>\n          <li>Increase <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-137-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>args</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2236\" style=\"width: 2.346em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.93em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2237\"><span class=\"msubsup\" id=\"MathJax-Span-2238\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2239\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-2240\"><span class=\"mrow\" id=\"MathJax-Span-2241\"><span class=\"mtext\" id=\"MathJax-Span-2242\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">args</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>args</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-137\">w_{\\text{args}}</script></li>\n          <li>Tighten penalty for malformed JSON or missing fields</li>\n        </ul>\n      </li>\n    </ul>\n<p><strong>Task examples:</strong></p>\n<ul>\n          <li>Weather(city, date)</li>\n          <li>Maps(location, radius)</li>\n          <li>Calculation(expressions with multiple steps)</li>\n          <li>API requiring nested JSON fields</li>\n        </ul>\n<p><strong>Training strategy:</strong></p>\n<ul>\n          <li>Start with minimal arguments (one field)</li>\n          <li>Add multi-argument calls</li>\n          <li>Introduce noisy contexts (typos, ambiguity)</li>\n        </ul>\n<p><strong>Metrics:</strong></p>\n<ul>\n          <li>Argument correctness (string similarity or numeric error)</li>\n          <li>Schema completeness</li>\n          <li>Tool execution success rate</li>\n        </ul>\n<p><strong>Reward emphasis:</strong></p>\n<ul>\n          <li>Increase <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-137-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>args</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2236\" style=\"width: 2.346em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.93em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2237\"><span class=\"msubsup\" id=\"MathJax-Span-2238\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2239\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-2240\"><span class=\"mrow\" id=\"MathJax-Span-2241\"><span class=\"mtext\" id=\"MathJax-Span-2242\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">args</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>args</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-137\">w_{\\text{args}}</script></li>\n          <li>Tighten penalty for malformed JSON or missing fields</li>\n        </ul>\n<h4 id=\"stage-4-multi-step-tool-use-pipelines\">Stage 4: Multi-Step Tool Use (Pipelines)</h4>\n<ul>\n  <li>\n    <p>Introduce tasks requiring <strong>multiple sequential tool calls</strong>, e.g.:</p>\n\n    <ol>\n      <li>Search for restaurants</li>\n      <li>Get the address</li>\n      <li>Query weather at that address</li>\n      <li>Produce a combined answer</li>\n    </ol>\n  </li>\n  <li>\n    <p>Here the agent must plan sequences and must choose when to stop calling tools.</p>\n  </li>\n  <li>\n    <p><strong>Metrics:</strong></p>\n\n    <ul>\n      <li>Number of steps per episode</li>\n      <li>Optimality of tool sequence</li>\n      <li>Rate of premature or redundant tool calls</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Reward emphasis:</strong></p>\n\n    <ul>\n      <li>Add step penalties</li>\n      <li>Strengthen outcome reward since multi-step tasks dominate final task success</li>\n    </ul>\n  </li>\n</ul>\n<p>Introduce tasks requiring <strong>multiple sequential tool calls</strong>, e.g.:</p>\n<ol>\n      <li>Search for restaurants</li>\n      <li>Get the address</li>\n      <li>Query weather at that address</li>\n      <li>Produce a combined answer</li>\n    </ol>\n<p>Here the agent must plan sequences and must choose when to stop calling tools.</p>\n<p><strong>Metrics:</strong></p>\n<ul>\n      <li>Number of steps per episode</li>\n      <li>Optimality of tool sequence</li>\n      <li>Rate of premature or redundant tool calls</li>\n    </ul>\n<p><strong>Reward emphasis:</strong></p>\n<ul>\n      <li>Add step penalties</li>\n      <li>Strengthen outcome reward since multi-step tasks dominate final task success</li>\n    </ul>\n<h4 id=\"stage-5-open-domain-free-form-tasks\">Stage 5: Open-Domain Free-Form Tasks</h4>\n<ul>\n  <li>\n    <p>Finally, mix in diverse real-world questions with unconstrained natural-language variety.</p>\n  </li>\n  <li>\n    <p><strong>Goal:</strong> produce a robust “universal” tool-use agent.</p>\n  </li>\n  <li>\n    <p><strong>Metrics:</strong></p>\n\n    <ul>\n      <li>Overall episodic return</li>\n      <li>Win-rate vs. evaluator models (LLM-as-a-Judge)</li>\n      <li>Human preference win-rate</li>\n      <li>Task success accuracy in open benchmarks</li>\n    </ul>\n  </li>\n</ul>\n<p>Finally, mix in diverse real-world questions with unconstrained natural-language variety.</p>\n<p><strong>Goal:</strong> produce a robust “universal” tool-use agent.</p>\n<p><strong>Metrics:</strong></p>\n<ul>\n      <li>Overall episodic return</li>\n      <li>Win-rate vs. evaluator models (LLM-as-a-Judge)</li>\n      <li>Human preference win-rate</li>\n      <li>Task success accuracy in open benchmarks</li>\n    </ul>\n<h4 id=\"curriculum-scheduling-putting-it-all-together\">Curriculum Scheduling: Putting It All Together</h4>\n<ul>\n  <li>\n    <p>A typical recipe incorporating curriculum learning:</p>\n\n    <ol>\n      <li><strong>Stage 0 (SFT):</strong> 30k–200k examples</li>\n      <li><strong>Stage 1 (When):</strong> 1–5 RL epochs</li>\n      <li><strong>Stage 2 (Which):</strong> 3–10 RL epochs</li>\n      <li><strong>Stage 3 (How):</strong> 5–20 RL epochs</li>\n      <li><strong>Stage 4 (Pipelines):</strong> 10–30 RL epochs</li>\n      <li><strong>Stage 5 (Open-domain):</strong> continuous RL/adaptation</li>\n    </ol>\n  </li>\n  <li>\n    <p><strong>Dynamic curriculum:</strong> shift task sampling probabilities based on evaluation metrics—for example, increase argument-focused tasks if argument correctness stagnates.</p>\n  </li>\n</ul>\n<p>A typical recipe incorporating curriculum learning:</p>\n<ol>\n      <li><strong>Stage 0 (SFT):</strong> 30k–200k examples</li>\n      <li><strong>Stage 1 (When):</strong> 1–5 RL epochs</li>\n      <li><strong>Stage 2 (Which):</strong> 3–10 RL epochs</li>\n      <li><strong>Stage 3 (How):</strong> 5–20 RL epochs</li>\n      <li><strong>Stage 4 (Pipelines):</strong> 10–30 RL epochs</li>\n      <li><strong>Stage 5 (Open-domain):</strong> continuous RL/adaptation</li>\n    </ol>\n<p><strong>Dynamic curriculum:</strong> shift task sampling probabilities based on evaluation metrics—for example, increase argument-focused tasks if argument correctness stagnates.</p>",
    "contentMarkdown": "*   This section describes how to structure training so the model reliably learns **when**, **which**, and **how** to call tools, and how to evaluate progress during RL. Curriculum design is crucial because tool-calling is a hierarchical skill; introducing complexity too early destabilizes learning, and introducing it too late yields underfitting.\n*   Curriculum design gradually increases difficulty along three axes:\n    \n    1.  **When** →→\\\\rightarrow recognizing tool necessity vs. non-necessity\n    2.  **Which** →→\\\\rightarrow selecting the correct tool\n    3.  **How** →→\\\\rightarrow providing high-quality arguments\n*   Each axis has its own progression. The curriculum alternates between breadth (many domains/tools) and depth (multi-step workflows).\n    \n*   This staged approach mirrors the structured curricula seen in code-generation RL (e.g., unit-tests →→\\\\rightarrow multi-step tasks) in works like [Self-Refine](https://arxiv.org/abs/2303.17651) by Madaan et al. (2023).\n    \n*   A well-designed curriculum ensures the policy does not simply memorize tool-call structures but truly internalizes **when** tool use is warranted, **which** tool to call, **how** to call it correctly, and how to combine tools into **multi-step workflows** to solve real tasks.\n\nCurriculum design gradually increases difficulty along three axes:\n\n1.  **When** →→\\\\rightarrow recognizing tool necessity vs. non-necessity\n2.  **Which** →→\\\\rightarrow selecting the correct tool\n3.  **How** →→\\\\rightarrow providing high-quality arguments\n\nEach axis has its own progression. The curriculum alternates between breadth (many domains/tools) and depth (multi-step workflows).\n\nThis staged approach mirrors the structured curricula seen in code-generation RL (e.g., unit-tests →→\\\\rightarrow multi-step tasks) in works like [Self-Refine](https://arxiv.org/abs/2303.17651) by Madaan et al. (2023).\n\n#### Stage 0: Pure Supervised Bootstrapping (SFT)\n\n*   Before RL begins, do supervised fine-tuning on a dataset that explicitly includes:\n    \n    *   Examples requiring a tool,\n    *   Examples that must _not_ use a tool,\n    *   Examples mapping queries to correct tool types,\n    *   Examples showing valid argument formats.\n*   The SFT initializes:\n    \n    *   An approximately correct “when →→\\\\rightarrow which →→\\\\rightarrow how” policy,\n    *   JSON formatting reliability,\n    *   Stable tool-calling syntax.\n*   This prevents “flailing” during early RL where the model might emit random tool calls.\n    \n\nBefore RL begins, do supervised fine-tuning on a dataset that explicitly includes:\n\n*   Examples requiring a tool,\n*   Examples that must _not_ use a tool,\n*   Examples mapping queries to correct tool types,\n*   Examples showing valid argument formats.\n\nThe SFT initializes:\n\n*   An approximately correct “when →→\\\\rightarrow which →→\\\\rightarrow how” policy,\n*   JSON formatting reliability,\n*   Stable tool-calling syntax.\n\nThis prevents “flailing” during early RL where the model might emit random tool calls.\n\n#### Stage 1: Binary Decision Curriculum (Learning **When**)\n\n*   **Focus:** detect whether a tool is required.\n    \n*   **Task mix:**\n    \n    *   50% queries that require a specific tool (weather/math/search)\n    *   50% queries that must be answered without tools\n*   **Goal:** learn the call/no-call boundary.\n    \n*   **Metrics:**\n    \n    *   Call precision\n    *   Call recall\n    *   False-positive rate (unnecessary calls)\n    *   False-negative rate (missed calls)\n*   **Reward emphasis:**\n    \n    *   Increase wcallwcallw\\_{\\\\text{call}}\n    *   Reduce penalties for syntax/execution errors early on\n\n**Focus:** detect whether a tool is required.\n\n**Task mix:**\n\n*   50% queries that require a specific tool (weather/math/search)\n*   50% queries that must be answered without tools\n\n**Goal:** learn the call/no-call boundary.\n\n**Metrics:**\n\n*   Call precision\n*   Call recall\n*   False-positive rate (unnecessary calls)\n*   False-negative rate (missed calls)\n\n**Reward emphasis:**\n\n*   Increase wcallwcallw\\_{\\\\text{call}}\n*   Reduce penalties for syntax/execution errors early on\n\n#### Stage 2: Tool-Selection Curriculum (Learning **Which**)\n\n*   Add tasks that require choosing _between_ tools:\n    \n*   **Task examples:**\n    \n    *   Weather vs. news\n    *   Search vs. calculator\n    *   Translation vs. summarization (if tools exist)\n*   **Goal:** learn discriminative mapping from task intent →→\\\\rightarrow tool identity.\n    \n*   **Curriculum trick:**\n    \n    *   For ambiguous queries, include diverse examples so the RL agent learns to think (internal chain-of-thought) before issuing tool calls.\n*   **Metrics:**\n    \n    *   Tool-selection accuracy\n    *   Confusion matrix across tool categories\n    *   Average number of tool attempts per query\n*   **Reward emphasis:**\n    \n    *   Shift weight from wcall)wcall)w\\_{\\\\text{call}})\\\\rightarrow(wwhich(wwhich(w\\_{\\\\text{which}}\n    *   Introduce penalties for repeated incorrect tool choices\n\nAdd tasks that require choosing _between_ tools:\n\n**Task examples:**\n\n*   Weather vs. news\n*   Search vs. calculator\n*   Translation vs. summarization (if tools exist)\n\n**Goal:** learn discriminative mapping from task intent →→\\\\rightarrow tool identity.\n\n**Curriculum trick:**\n\n*   For ambiguous queries, include diverse examples so the RL agent learns to think (internal chain-of-thought) before issuing tool calls.\n\n**Metrics:**\n\n*   Tool-selection accuracy\n*   Confusion matrix across tool categories\n*   Average number of tool attempts per query\n\n**Reward emphasis:**\n\n*   Shift weight from wcall)wcall)w\\_{\\\\text{call}})\\\\rightarrow(wwhich(wwhich(w\\_{\\\\text{which}}\n*   Introduce penalties for repeated incorrect tool choices\n\n#### Stage 3: Argument-Construction Curriculum (Learning **How**)\n\n*   Introduce tasks with argument complexity:\n    \n    *   **Task examples:**\n        \n        *   Weather(city, date)\n        *   Maps(location, radius)\n        *   Calculation(expressions with multiple steps)\n        *   API requiring nested JSON fields\n    *   **Training strategy:**\n        \n        *   Start with minimal arguments (one field)\n        *   Add multi-argument calls\n        *   Introduce noisy contexts (typos, ambiguity)\n    *   **Metrics:**\n        \n        *   Argument correctness (string similarity or numeric error)\n        *   Schema completeness\n        *   Tool execution success rate\n    *   **Reward emphasis:**\n        \n        *   Increase wargswargsw\\_{\\\\text{args}}\n        *   Tighten penalty for malformed JSON or missing fields\n\nIntroduce tasks with argument complexity:\n\n*   **Task examples:**\n    \n    *   Weather(city, date)\n    *   Maps(location, radius)\n    *   Calculation(expressions with multiple steps)\n    *   API requiring nested JSON fields\n*   **Training strategy:**\n    \n    *   Start with minimal arguments (one field)\n    *   Add multi-argument calls\n    *   Introduce noisy contexts (typos, ambiguity)\n*   **Metrics:**\n    \n    *   Argument correctness (string similarity or numeric error)\n    *   Schema completeness\n    *   Tool execution success rate\n*   **Reward emphasis:**\n    \n    *   Increase wargswargsw\\_{\\\\text{args}}\n    *   Tighten penalty for malformed JSON or missing fields\n\n**Task examples:**\n\n*   Weather(city, date)\n*   Maps(location, radius)\n*   Calculation(expressions with multiple steps)\n*   API requiring nested JSON fields\n\n**Training strategy:**\n\n*   Start with minimal arguments (one field)\n*   Add multi-argument calls\n*   Introduce noisy contexts (typos, ambiguity)\n\n**Metrics:**\n\n*   Argument correctness (string similarity or numeric error)\n*   Schema completeness\n*   Tool execution success rate\n\n**Reward emphasis:**\n\n*   Increase wargswargsw\\_{\\\\text{args}}\n*   Tighten penalty for malformed JSON or missing fields\n\n#### Stage 4: Multi-Step Tool Use (Pipelines)\n\n*   Introduce tasks requiring **multiple sequential tool calls**, e.g.:\n    \n    1.  Search for restaurants\n    2.  Get the address\n    3.  Query weather at that address\n    4.  Produce a combined answer\n*   Here the agent must plan sequences and must choose when to stop calling tools.\n    \n*   **Metrics:**\n    \n    *   Number of steps per episode\n    *   Optimality of tool sequence\n    *   Rate of premature or redundant tool calls\n*   **Reward emphasis:**\n    \n    *   Add step penalties\n    *   Strengthen outcome reward since multi-step tasks dominate final task success\n\nIntroduce tasks requiring **multiple sequential tool calls**, e.g.:\n\n1.  Search for restaurants\n2.  Get the address\n3.  Query weather at that address\n4.  Produce a combined answer\n\nHere the agent must plan sequences and must choose when to stop calling tools.\n\n**Metrics:**\n\n*   Number of steps per episode\n*   Optimality of tool sequence\n*   Rate of premature or redundant tool calls\n\n**Reward emphasis:**\n\n*   Add step penalties\n*   Strengthen outcome reward since multi-step tasks dominate final task success\n\n#### Stage 5: Open-Domain Free-Form Tasks\n\n*   Finally, mix in diverse real-world questions with unconstrained natural-language variety.\n    \n*   **Goal:** produce a robust “universal” tool-use agent.\n    \n*   **Metrics:**\n    \n    *   Overall episodic return\n    *   Win-rate vs. evaluator models (LLM-as-a-Judge)\n    *   Human preference win-rate\n    *   Task success accuracy in open benchmarks\n\nFinally, mix in diverse real-world questions with unconstrained natural-language variety.\n\n**Goal:** produce a robust “universal” tool-use agent.\n\n**Metrics:**\n\n*   Overall episodic return\n*   Win-rate vs. evaluator models (LLM-as-a-Judge)\n*   Human preference win-rate\n*   Task success accuracy in open benchmarks\n\n#### Curriculum Scheduling: Putting It All Together\n\n*   A typical recipe incorporating curriculum learning:\n    \n    1.  **Stage 0 (SFT):** 30k–200k examples\n    2.  **Stage 1 (When):** 1–5 RL epochs\n    3.  **Stage 2 (Which):** 3–10 RL epochs\n    4.  **Stage 3 (How):** 5–20 RL epochs\n    5.  **Stage 4 (Pipelines):** 10–30 RL epochs\n    6.  **Stage 5 (Open-domain):** continuous RL/adaptation\n*   **Dynamic curriculum:** shift task sampling probabilities based on evaluation metrics—for example, increase argument-focused tasks if argument correctness stagnates.\n    \n\nA typical recipe incorporating curriculum learning:\n\n1.  **Stage 0 (SFT):** 30k–200k examples\n2.  **Stage 1 (When):** 1–5 RL epochs\n3.  **Stage 2 (Which):** 3–10 RL epochs\n4.  **Stage 3 (How):** 5–20 RL epochs\n5.  **Stage 4 (Pipelines):** 10–30 RL epochs\n6.  **Stage 5 (Open-domain):** continuous RL/adaptation\n\n**Dynamic curriculum:** shift task sampling probabilities based on evaluation metrics—for example, increase argument-focused tasks if argument correctness stagnates.",
    "order": 7,
    "orderInChapter": 6,
    "difficulty": 3,
    "estimatedMinutes": 7,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 1347,
      "contentLength": 51080
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#curriculum-design",
    "scrapedAt": "2025-12-28T11:47:36.151Z"
  },
  {
    "id": "ai-agentic-RL-diagnostics-and-monitoring-8",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Background: Teaching Agents Tool-Calling with RL",
    "title": "Diagnostics and Monitoring",
    "subtitle": "Background: Teaching Agents Tool-Calling with RL",
    "contentHtml": "<h5 id=\"process-level-metrics\">Process-Level Metrics</h5>\n<ul>\n  <li>\n    <p>Aligned with the <strong>when <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-138-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2243\" style=\"width: 1.191em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.552em, 1000.93em, 2.275em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2244\"><span class=\"mo\" id=\"MathJax-Span-2245\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-138\">\\rightarrow</script> which <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-139-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2246\" style=\"width: 1.191em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.552em, 1000.93em, 2.275em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2247\"><span class=\"mo\" id=\"MathJax-Span-2248\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-139\">\\rightarrow</script> how</strong> decomposition:</p>\n\n    <ul>\n      <li>\n        <p><strong>When:</strong></p>\n\n        <ul>\n          <li>Call precision/recall</li>\n          <li>Unnecessary call rate</li>\n          <li>Missed call rate</li>\n          <li>Call timing consistency</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Which:</strong></p>\n\n        <ul>\n          <li>Tool selection accuracy</li>\n          <li>Error matrix across tools</li>\n          <li>Repeated incorrect tool selection episodes</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>How:</strong></p>\n\n        <ul>\n          <li>Argument correctness scores</li>\n          <li>JSON validity rate</li>\n          <li>Execution success rate</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n</ul>\n<p>Aligned with the <strong>when <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-138-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2243\" style=\"width: 1.191em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.552em, 1000.93em, 2.275em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2244\"><span class=\"mo\" id=\"MathJax-Span-2245\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-138\">\\rightarrow</script> which <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-139-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2246\" style=\"width: 1.191em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.552em, 1000.93em, 2.275em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2247\"><span class=\"mo\" id=\"MathJax-Span-2248\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-139\">\\rightarrow</script> how</strong> decomposition:</p>\n<ul>\n      <li>\n        <p><strong>When:</strong></p>\n\n        <ul>\n          <li>Call precision/recall</li>\n          <li>Unnecessary call rate</li>\n          <li>Missed call rate</li>\n          <li>Call timing consistency</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Which:</strong></p>\n\n        <ul>\n          <li>Tool selection accuracy</li>\n          <li>Error matrix across tools</li>\n          <li>Repeated incorrect tool selection episodes</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>How:</strong></p>\n\n        <ul>\n          <li>Argument correctness scores</li>\n          <li>JSON validity rate</li>\n          <li>Execution success rate</li>\n        </ul>\n      </li>\n    </ul>\n<p><strong>When:</strong></p>\n<ul>\n          <li>Call precision/recall</li>\n          <li>Unnecessary call rate</li>\n          <li>Missed call rate</li>\n          <li>Call timing consistency</li>\n        </ul>\n<p><strong>Which:</strong></p>\n<ul>\n          <li>Tool selection accuracy</li>\n          <li>Error matrix across tools</li>\n          <li>Repeated incorrect tool selection episodes</li>\n        </ul>\n<p><strong>How:</strong></p>\n<ul>\n          <li>Argument correctness scores</li>\n          <li>JSON validity rate</li>\n          <li>Execution success rate</li>\n        </ul>\n<h5 id=\"outcome-level-metrics\">Outcome-Level Metrics</h5>\n<ul>\n  <li>\n    <p><strong>Final answer accuracy:</strong></p>\n\n    <ul>\n      <li>Exact match</li>\n      <li>Tolerance-based match</li>\n      <li>Semantic similarity</li>\n      <li>Pass rate vs. LLM-judge (DeepSeek-V3, GPT-4, etc.)</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Task efficiency:</strong></p>\n\n    <ul>\n      <li>Number of steps per solved task</li>\n      <li>Number of tool calls per successful episode</li>\n      <li>Reward per timestep</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>User-facing metrics:</strong></p>\n\n    <ul>\n      <li>Latency per episode</li>\n      <li>Number of external API calls</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Final answer accuracy:</strong></p>\n<ul>\n      <li>Exact match</li>\n      <li>Tolerance-based match</li>\n      <li>Semantic similarity</li>\n      <li>Pass rate vs. LLM-judge (DeepSeek-V3, GPT-4, etc.)</li>\n    </ul>\n<p><strong>Task efficiency:</strong></p>\n<ul>\n      <li>Number of steps per solved task</li>\n      <li>Number of tool calls per successful episode</li>\n      <li>Reward per timestep</li>\n    </ul>\n<p><strong>User-facing metrics:</strong></p>\n<ul>\n      <li>Latency per episode</li>\n      <li>Number of external API calls</li>\n    </ul>\n<h4 id=\"detecting-skill-collapse\">Detecting Skill Collapse</h4>\n<ul>\n  <li>\n    <p><strong>Red flags include:</strong></p>\n\n    <ul>\n      <li>Spike in JSON errors <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-140-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2249\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2250\"><span class=\"mo\" id=\"MathJax-Span-2251\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-140\">\\rightarrow</script> syntax collapse</li>\n      <li>Rising unnecessary tool use <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-141-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2252\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2253\"><span class=\"mo\" id=\"MathJax-Span-2254\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-141\">\\rightarrow</script> call collapse</li>\n      <li>Tool-selection deterioration <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-142-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2255\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2256\"><span class=\"mo\" id=\"MathJax-Span-2257\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-142\">\\rightarrow</script> “which” collapse</li>\n      <li>Rising tool execution failures <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-143-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2258\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2259\"><span class=\"mo\" id=\"MathJax-Span-2260\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-143\">\\rightarrow</script> argument collapse</li>\n      <li>Flat final-task accuracy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-144-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2261\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2262\"><span class=\"mo\" id=\"MathJax-Span-2263\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-144\">\\rightarrow</script> plateau due to overfitting on shaping rewards</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Solutions:</strong></p>\n\n    <ul>\n      <li>Adjust reward weights <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-145-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x22C5;</mo></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2264\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2265\"><span class=\"msubsup\" id=\"MathJax-Span-2266\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2267\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-2268\"><span class=\"mrow\" id=\"MathJax-Span-2269\"><span class=\"mo\" id=\"MathJax-Span-2270\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">⋅</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>⋅</mo></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-145\">w_{\\cdot}</script></li>\n      <li>Reintroduce supervised examples</li>\n      <li>Increase entropy regularization</li>\n      <li>Add KL penalties to keep model close to reference</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Red flags include:</strong></p>\n<ul>\n      <li>Spike in JSON errors <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-140-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2249\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2250\"><span class=\"mo\" id=\"MathJax-Span-2251\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-140\">\\rightarrow</script> syntax collapse</li>\n      <li>Rising unnecessary tool use <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-141-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2252\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2253\"><span class=\"mo\" id=\"MathJax-Span-2254\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-141\">\\rightarrow</script> call collapse</li>\n      <li>Tool-selection deterioration <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-142-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2255\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2256\"><span class=\"mo\" id=\"MathJax-Span-2257\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-142\">\\rightarrow</script> “which” collapse</li>\n      <li>Rising tool execution failures <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-143-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2258\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2259\"><span class=\"mo\" id=\"MathJax-Span-2260\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-143\">\\rightarrow</script> argument collapse</li>\n      <li>Flat final-task accuracy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-144-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2261\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2262\"><span class=\"mo\" id=\"MathJax-Span-2263\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-144\">\\rightarrow</script> plateau due to overfitting on shaping rewards</li>\n    </ul>\n<p><strong>Solutions:</strong></p>\n<ul>\n      <li>Adjust reward weights <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-145-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x22C5;</mo></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2264\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2265\"><span class=\"msubsup\" id=\"MathJax-Span-2266\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2267\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-2268\"><span class=\"mrow\" id=\"MathJax-Span-2269\"><span class=\"mo\" id=\"MathJax-Span-2270\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">⋅</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>⋅</mo></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-145\">w_{\\cdot}</script></li>\n      <li>Reintroduce supervised examples</li>\n      <li>Increase entropy regularization</li>\n      <li>Add KL penalties to keep model close to reference</li>\n    </ul>",
    "contentMarkdown": "##### Process-Level Metrics\n\n*   Aligned with the **when →→\\\\rightarrow which →→\\\\rightarrow how** decomposition:\n    \n    *   **When:**\n        \n        *   Call precision/recall\n        *   Unnecessary call rate\n        *   Missed call rate\n        *   Call timing consistency\n    *   **Which:**\n        \n        *   Tool selection accuracy\n        *   Error matrix across tools\n        *   Repeated incorrect tool selection episodes\n    *   **How:**\n        \n        *   Argument correctness scores\n        *   JSON validity rate\n        *   Execution success rate\n\nAligned with the **when →→\\\\rightarrow which →→\\\\rightarrow how** decomposition:\n\n*   **When:**\n    \n    *   Call precision/recall\n    *   Unnecessary call rate\n    *   Missed call rate\n    *   Call timing consistency\n*   **Which:**\n    \n    *   Tool selection accuracy\n    *   Error matrix across tools\n    *   Repeated incorrect tool selection episodes\n*   **How:**\n    \n    *   Argument correctness scores\n    *   JSON validity rate\n    *   Execution success rate\n\n**When:**\n\n*   Call precision/recall\n*   Unnecessary call rate\n*   Missed call rate\n*   Call timing consistency\n\n**Which:**\n\n*   Tool selection accuracy\n*   Error matrix across tools\n*   Repeated incorrect tool selection episodes\n\n**How:**\n\n*   Argument correctness scores\n*   JSON validity rate\n*   Execution success rate\n\n##### Outcome-Level Metrics\n\n*   **Final answer accuracy:**\n    \n    *   Exact match\n    *   Tolerance-based match\n    *   Semantic similarity\n    *   Pass rate vs. LLM-judge (DeepSeek-V3, GPT-4, etc.)\n*   **Task efficiency:**\n    \n    *   Number of steps per solved task\n    *   Number of tool calls per successful episode\n    *   Reward per timestep\n*   **User-facing metrics:**\n    \n    *   Latency per episode\n    *   Number of external API calls\n\n**Final answer accuracy:**\n\n*   Exact match\n*   Tolerance-based match\n*   Semantic similarity\n*   Pass rate vs. LLM-judge (DeepSeek-V3, GPT-4, etc.)\n\n**Task efficiency:**\n\n*   Number of steps per solved task\n*   Number of tool calls per successful episode\n*   Reward per timestep\n\n**User-facing metrics:**\n\n*   Latency per episode\n*   Number of external API calls\n\n#### Detecting Skill Collapse\n\n*   **Red flags include:**\n    \n    *   Spike in JSON errors →→\\\\rightarrow syntax collapse\n    *   Rising unnecessary tool use →→\\\\rightarrow call collapse\n    *   Tool-selection deterioration →→\\\\rightarrow “which” collapse\n    *   Rising tool execution failures →→\\\\rightarrow argument collapse\n    *   Flat final-task accuracy →→\\\\rightarrow plateau due to overfitting on shaping rewards\n*   **Solutions:**\n    \n    *   Adjust reward weights w⋅w⋅w\\_{\\\\cdot}\n    *   Reintroduce supervised examples\n    *   Increase entropy regularization\n    *   Add KL penalties to keep model close to reference\n\n**Red flags include:**\n\n*   Spike in JSON errors →→\\\\rightarrow syntax collapse\n*   Rising unnecessary tool use →→\\\\rightarrow call collapse\n*   Tool-selection deterioration →→\\\\rightarrow “which” collapse\n*   Rising tool execution failures →→\\\\rightarrow argument collapse\n*   Flat final-task accuracy →→\\\\rightarrow plateau due to overfitting on shaping rewards\n\n**Solutions:**\n\n*   Adjust reward weights w⋅w⋅w\\_{\\\\cdot}\n*   Reintroduce supervised examples\n*   Increase entropy regularization\n*   Add KL penalties to keep model close to reference",
    "order": 8,
    "orderInChapter": 7,
    "difficulty": 3,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture",
      "gpt",
      "llm",
      "regularization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 419,
      "contentLength": 26445
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#diagnostics-and-monitoring",
    "scrapedAt": "2025-12-28T11:47:36.151Z"
  },
  {
    "id": "ai-agentic-RL-the-role-of-rl-in-self-improving-agents-9",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Seminal Work in Agentic RL",
    "title": "The Role of RL in Self-Improving Agents",
    "subtitle": "Seminal Work in Agentic RL",
    "contentHtml": "<ul>\n  <li>\n    <p>RL serves as the foundation of <em>self-improving</em> artificial agents. These agents do not depend solely on human-provided supervision; instead, they learn continuously from their own experiences.</p>\n  </li>\n  <li>\n    <p>A representative example of this approach is <a href=\"https://arxiv.org/abs/2405.20309\">Large Language Models Can Self-improve at Web Agent Tasks</a> by Patel et al. (2024), which introduced a looped learning process where an agent repeatedly performs tasks, evaluates its own performance, and fine-tunes itself on the best results. In their experiments, agents improved their web-navigation success rates by over 30% without any additional human data, demonstrating that RL can bootstrap the agent’s progress over time.</p>\n  </li>\n  <li>\n    <p>The following figure shows (<a href=\"https://arxiv.org/abs/2405.20309\">source</a>) the <em>self-improvement loop</em> used in Patel et al. (2024), illustrating how the agent collects trajectories, filters low-quality outputs, fine-tunes itself, and iterates for continual improvement.</p>\n  </li>\n</ul>\n<p>RL serves as the foundation of <em>self-improving</em> artificial agents. These agents do not depend solely on human-provided supervision; instead, they learn continuously from their own experiences.</p>\n<p>A representative example of this approach is <a href=\"https://arxiv.org/abs/2405.20309\">Large Language Models Can Self-improve at Web Agent Tasks</a> by Patel et al. (2024), which introduced a looped learning process where an agent repeatedly performs tasks, evaluates its own performance, and fine-tunes itself on the best results. In their experiments, agents improved their web-navigation success rates by over 30% without any additional human data, demonstrating that RL can bootstrap the agent’s progress over time.</p>\n<p>The following figure shows (<a href=\"https://arxiv.org/abs/2405.20309\">source</a>) the <em>self-improvement loop</em> used in Patel et al. (2024), illustrating how the agent collects trajectories, filters low-quality outputs, fine-tunes itself, and iterates for continual improvement.</p>\n<p><img src=\"/primers/ai/assets/RL-for-agents/WebArena.jpg\" alt=\"\"></p>\n<ul>\n  <li>\n    <p>Synthetic-experience RL closes the loop for self-improving agents by letting a reasoning experience model synthesize adaptive rollouts and curricula matched to the current policy, yielding consistent gains in both synthetic and sim-to-real settings; theory further bounds the sim-to-real gap by reward-accuracy and domain-consistency errors, rather than strict pixel/state fidelity metrics (cf. <a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025)).</p>\n  </li>\n  <li>\n    <p>This iterative process typically follows these stages:</p>\n\n    <ol>\n      <li><strong>Data Collection:</strong> The agent generates task trajectories by interacting with the environment.</li>\n      <li><strong>Filtering and Evaluation:</strong> The system automatically assesses each trajectory, discarding low-quality samples.</li>\n      <li><strong>Fine-Tuning:</strong> The agent is retrained using successful examples, effectively reinforcing good behavior.</li>\n      <li><strong>Re-evaluation:</strong> The improved agent is tested, and the cycle repeats.</li>\n    </ol>\n  </li>\n  <li>\n    <p>This form of continual self-improvement makes RL a key enabler for developing general-purpose, autonomous web and software agents.</p>\n  </li>\n</ul>\n<p>Synthetic-experience RL closes the loop for self-improving agents by letting a reasoning experience model synthesize adaptive rollouts and curricula matched to the current policy, yielding consistent gains in both synthetic and sim-to-real settings; theory further bounds the sim-to-real gap by reward-accuracy and domain-consistency errors, rather than strict pixel/state fidelity metrics (cf. <a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025)).</p>\n<p>This iterative process typically follows these stages:</p>\n<ol>\n      <li><strong>Data Collection:</strong> The agent generates task trajectories by interacting with the environment.</li>\n      <li><strong>Filtering and Evaluation:</strong> The system automatically assesses each trajectory, discarding low-quality samples.</li>\n      <li><strong>Fine-Tuning:</strong> The agent is retrained using successful examples, effectively reinforcing good behavior.</li>\n      <li><strong>Re-evaluation:</strong> The improved agent is tested, and the cycle repeats.</li>\n    </ol>\n<p>This form of continual self-improvement makes RL a key enabler for developing general-purpose, autonomous web and software agents.</p>",
    "contentMarkdown": "*   RL serves as the foundation of _self-improving_ artificial agents. These agents do not depend solely on human-provided supervision; instead, they learn continuously from their own experiences.\n    \n*   A representative example of this approach is [Large Language Models Can Self-improve at Web Agent Tasks](https://arxiv.org/abs/2405.20309) by Patel et al. (2024), which introduced a looped learning process where an agent repeatedly performs tasks, evaluates its own performance, and fine-tunes itself on the best results. In their experiments, agents improved their web-navigation success rates by over 30% without any additional human data, demonstrating that RL can bootstrap the agent’s progress over time.\n    \n*   The following figure shows ([source](https://arxiv.org/abs/2405.20309)) the _self-improvement loop_ used in Patel et al. (2024), illustrating how the agent collects trajectories, filters low-quality outputs, fine-tunes itself, and iterates for continual improvement.\n    \n\nRL serves as the foundation of _self-improving_ artificial agents. These agents do not depend solely on human-provided supervision; instead, they learn continuously from their own experiences.\n\nA representative example of this approach is [Large Language Models Can Self-improve at Web Agent Tasks](https://arxiv.org/abs/2405.20309) by Patel et al. (2024), which introduced a looped learning process where an agent repeatedly performs tasks, evaluates its own performance, and fine-tunes itself on the best results. In their experiments, agents improved their web-navigation success rates by over 30% without any additional human data, demonstrating that RL can bootstrap the agent’s progress over time.\n\nThe following figure shows ([source](https://arxiv.org/abs/2405.20309)) the _self-improvement loop_ used in Patel et al. (2024), illustrating how the agent collects trajectories, filters low-quality outputs, fine-tunes itself, and iterates for continual improvement.\n\n![](/primers/ai/assets/RL-for-agents/WebArena.jpg)\n\n*   Synthetic-experience RL closes the loop for self-improving agents by letting a reasoning experience model synthesize adaptive rollouts and curricula matched to the current policy, yielding consistent gains in both synthetic and sim-to-real settings; theory further bounds the sim-to-real gap by reward-accuracy and domain-consistency errors, rather than strict pixel/state fidelity metrics (cf. [Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025)).\n    \n*   This iterative process typically follows these stages:\n    \n    1.  **Data Collection:** The agent generates task trajectories by interacting with the environment.\n    2.  **Filtering and Evaluation:** The system automatically assesses each trajectory, discarding low-quality samples.\n    3.  **Fine-Tuning:** The agent is retrained using successful examples, effectively reinforcing good behavior.\n    4.  **Re-evaluation:** The improved agent is tested, and the cycle repeats.\n*   This form of continual self-improvement makes RL a key enabler for developing general-purpose, autonomous web and software agents.\n    \n\nSynthetic-experience RL closes the loop for self-improving agents by letting a reasoning experience model synthesize adaptive rollouts and curricula matched to the current policy, yielding consistent gains in both synthetic and sim-to-real settings; theory further bounds the sim-to-real gap by reward-accuracy and domain-consistency errors, rather than strict pixel/state fidelity metrics (cf. [Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025)).\n\nThis iterative process typically follows these stages:\n\n1.  **Data Collection:** The agent generates task trajectories by interacting with the environment.\n2.  **Filtering and Evaluation:** The system automatically assesses each trajectory, discarding low-quality samples.\n3.  **Fine-Tuning:** The agent is retrained using successful examples, effectively reinforcing good behavior.\n4.  **Re-evaluation:** The improved agent is tested, and the cycle repeats.\n\nThis form of continual self-improvement makes RL a key enabler for developing general-purpose, autonomous web and software agents.",
    "order": 9,
    "orderInChapter": 1,
    "difficulty": 2,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": true,
      "wordCount": 535,
      "contentLength": 4736
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#the-role-of-rl-in-self-improving-agents",
    "scrapedAt": "2025-12-28T11:47:36.151Z"
  },
  {
    "id": "ai-agentic-RL-environments-for-rl-in-modern-agents-10",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Seminal Work in Agentic RL",
    "title": "Environments for RL in Modern Agents",
    "subtitle": "Seminal Work in Agentic RL",
    "contentHtml": "<ul>\n  <li>\n    <p>To support these learning processes, researchers have developed structured environments that simulate the complexity and variety of real-world digital interactions. One comprehensive framework is <a href=\"https://arxiv.org/abs/2406.04151\">AgentGym</a> by Xi et al. (2024), which defines a unified interface for training and evaluating LLM-based agents across 14 environment types—ranging from academic reasoning and games to embodied navigation and web interaction.</p>\n  </li>\n  <li>\n    <p>The following figure (<a href=\"https://arxiv.org/abs/2406.04151\">source</a>) shows the <em>AgentGym framework</em>, illustrating the standardized environment interface, modular design, and integration of various environment types for LLM-driven agent training.</p>\n  </li>\n</ul>\n<p>To support these learning processes, researchers have developed structured environments that simulate the complexity and variety of real-world digital interactions. One comprehensive framework is <a href=\"https://arxiv.org/abs/2406.04151\">AgentGym</a> by Xi et al. (2024), which defines a unified interface for training and evaluating LLM-based agents across 14 environment types—ranging from academic reasoning and games to embodied navigation and web interaction.</p>\n<p>The following figure (<a href=\"https://arxiv.org/abs/2406.04151\">source</a>) shows the <em>AgentGym framework</em>, illustrating the standardized environment interface, modular design, and integration of various environment types for LLM-driven agent training.</p>\n<p><img src=\"/primers/ai/assets/RL-for-agents/AgentGym.jpg\" alt=\"\"></p>\n<ul>\n  <li>\n    <p>In AgentGym, an agent’s experience is modeled as a trajectory consisting of repeated <em>thought–action–observation</em> cycles:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-147-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>&amp;#x03C4;</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>h</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>h</mi><mi>T</mi></msub><mo>,</mo><msub><mi>a</mi><mi>T</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>e</mi><mo>,</mo><mi>u</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2341\" style=\"width: 19.065em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 15.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1015.84em, 2.867em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2342\"><span class=\"mi\" id=\"MathJax-Span-2343\" style=\"font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2344\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-2345\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2346\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2347\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-2348\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2349\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2350\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2351\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-2352\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2353\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2354\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2355\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-2356\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2357\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-2358\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">.</span><span class=\"mo\" id=\"MathJax-Span-2359\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">.</span><span class=\"mo\" id=\"MathJax-Span-2360\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">.</span><span class=\"mo\" id=\"MathJax-Span-2361\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2362\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2363\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2364\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2365\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2366\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2367\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2368\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2369\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2370\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∼</span><span class=\"msubsup\" id=\"MathJax-Span-2371\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2372\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2373\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2374\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2375\" style=\"font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"texatom\" id=\"MathJax-Span-2376\"><span class=\"mrow\" id=\"MathJax-Span-2377\"><span class=\"mo\" id=\"MathJax-Span-2378\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-2379\" style=\"font-family: STIXGeneral-Italic;\">e</span><span class=\"mo\" id=\"MathJax-Span-2380\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2381\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">u</span><span class=\"mo\" id=\"MathJax-Span-2382\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>τ</mi><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>h</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>h</mi><mi>T</mi></msub><mo>,</mo><msub><mi>a</mi><mi>T</mi></msub><mo stretchy=\"false\">)</mo><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>τ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>e</mi><mo>,</mo><mi>u</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-147\">\\tau = (h_1, a_1, o_1, ..., h_T, a_T) \\sim \\pi_\\theta(\\tau | e, u)</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-148-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2383\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2384\"><span class=\"msubsup\" id=\"MathJax-Span-2385\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2386\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2387\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>h</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-148\">h_t</script> represents the agent’s internal reasoning (its “thought”), <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-149-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2388\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2389\"><span class=\"msubsup\" id=\"MathJax-Span-2390\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2391\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2392\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-149\">a_t</script> the action it takes, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-150-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2393\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2394\"><span class=\"msubsup\" id=\"MathJax-Span-2395\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2396\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2397\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-150\">o_t</script> the resulting observation, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-151-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>e</mi><mo>,</mo><mi>u</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2398\" style=\"width: 1.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1001.41em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2399\"><span class=\"mi\" id=\"MathJax-Span-2400\" style=\"font-family: STIXGeneral-Italic;\">e</span><span class=\"mo\" id=\"MathJax-Span-2401\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2402\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">u</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>e</mi><mo>,</mo><mi>u</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-151\">e, u</script> the environment and user prompt respectively.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This approach bridges the symbolic reasoning capabilities of LLMs with the sequential decision-making framework of RL, forming the basis for modern interactive agents.</p>\n  </li>\n</ul>\n<p>In AgentGym, an agent’s experience is modeled as a trajectory consisting of repeated <em>thought–action–observation</em> cycles:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-148-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2383\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2384\"><span class=\"msubsup\" id=\"MathJax-Span-2385\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2386\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2387\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>h</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-148\">h_t</script> represents the agent’s internal reasoning (its “thought”), <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-149-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2388\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2389\"><span class=\"msubsup\" id=\"MathJax-Span-2390\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2391\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2392\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-149\">a_t</script> the action it takes, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-150-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2393\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2394\"><span class=\"msubsup\" id=\"MathJax-Span-2395\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2396\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2397\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-150\">o_t</script> the resulting observation, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-151-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>e</mi><mo>,</mo><mi>u</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2398\" style=\"width: 1.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1001.41em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2399\"><span class=\"mi\" id=\"MathJax-Span-2400\" style=\"font-family: STIXGeneral-Italic;\">e</span><span class=\"mo\" id=\"MathJax-Span-2401\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2402\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">u</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>e</mi><mo>,</mo><mi>u</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-151\">e, u</script> the environment and user prompt respectively.</li>\n    </ul>\n<p>This approach bridges the symbolic reasoning capabilities of LLMs with the sequential decision-making framework of RL, forming the basis for modern interactive agents.</p>",
    "contentMarkdown": "*   To support these learning processes, researchers have developed structured environments that simulate the complexity and variety of real-world digital interactions. One comprehensive framework is [AgentGym](https://arxiv.org/abs/2406.04151) by Xi et al. (2024), which defines a unified interface for training and evaluating LLM-based agents across 14 environment types—ranging from academic reasoning and games to embodied navigation and web interaction.\n    \n*   The following figure ([source](https://arxiv.org/abs/2406.04151)) shows the _AgentGym framework_, illustrating the standardized environment interface, modular design, and integration of various environment types for LLM-driven agent training.\n    \n\nTo support these learning processes, researchers have developed structured environments that simulate the complexity and variety of real-world digital interactions. One comprehensive framework is [AgentGym](https://arxiv.org/abs/2406.04151) by Xi et al. (2024), which defines a unified interface for training and evaluating LLM-based agents across 14 environment types—ranging from academic reasoning and games to embodied navigation and web interaction.\n\nThe following figure ([source](https://arxiv.org/abs/2406.04151)) shows the _AgentGym framework_, illustrating the standardized environment interface, modular design, and integration of various environment types for LLM-driven agent training.\n\n![](/primers/ai/assets/RL-for-agents/AgentGym.jpg)\n\n*   In AgentGym, an agent’s experience is modeled as a trajectory consisting of repeated _thought–action–observation_ cycles:\n    \n    τ\\=(h1,a1,o1,...,hT,aT)∼πθ(τ|e,u)τ\\=(h1,a1,o1,...,hT,aT)∼πθ(τ|e,u)\n    \n    \\\\tau = (h\\_1, a\\_1, o\\_1, ..., h\\_T, a\\_T) \\\\sim \\\\pi\\_\\\\theta(\\\\tau | e, u)\n    *   where hthth\\_t represents the agent’s internal reasoning (its “thought”), atata\\_t the action it takes, ototo\\_t the resulting observation, and e,ue,ue, u the environment and user prompt respectively.\n*   This approach bridges the symbolic reasoning capabilities of LLMs with the sequential decision-making framework of RL, forming the basis for modern interactive agents.\n    \n\nIn AgentGym, an agent’s experience is modeled as a trajectory consisting of repeated _thought–action–observation_ cycles:\n\n*   where hthth\\_t represents the agent’s internal reasoning (its “thought”), atata\\_t the action it takes, ototo\\_t the resulting observation, and e,ue,ue, u the environment and user prompt respectively.\n\nThis approach bridges the symbolic reasoning capabilities of LLMs with the sequential decision-making framework of RL, forming the basis for modern interactive agents.",
    "order": 10,
    "orderInChapter": 2,
    "difficulty": 3,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 313,
      "contentLength": 26298
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#environments-for-rl-in-modern-agents",
    "scrapedAt": "2025-12-28T11:47:36.151Z"
  },
  {
    "id": "ai-agentic-RL-single-turn-environments-11",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Types of RL Environments",
    "title": "Single-Turn Environments",
    "subtitle": "Types of RL Environments",
    "contentHtml": "<ul>\n  <li>\n    <p>These environments are designed for tasks that require only a single input–output interaction, where the agent must produce one decisive response and then the environment resets. Examples include answering a question, solving a programming challenge, or completing a math problem.</p>\n  </li>\n  <li>\n    <p>In this setting, the reward signal directly evaluates the quality of the single output. Training methods usually combine supervised fine-tuning with RL from human or synthetic feedback (RLHF). For instance, in coding problems or reasoning benchmarks, the agent’s response can be automatically graded using execution correctness or symbolic validation. Such setups are ideal for optimizing precision and factual correctness in domains where each query is independent of the previous one.</p>\n  </li>\n  <li>\n    <p>Single-Turn environments tasks are computationally efficient to train because there is no need to maintain long-term memory or context. They are commonly used to bootstrap an agent’s basic competencies before moving to more complex, multi-step environments.</p>\n  </li>\n</ul>\n<p>These environments are designed for tasks that require only a single input–output interaction, where the agent must produce one decisive response and then the environment resets. Examples include answering a question, solving a programming challenge, or completing a math problem.</p>\n<p>In this setting, the reward signal directly evaluates the quality of the single output. Training methods usually combine supervised fine-tuning with RL from human or synthetic feedback (RLHF). For instance, in coding problems or reasoning benchmarks, the agent’s response can be automatically graded using execution correctness or symbolic validation. Such setups are ideal for optimizing precision and factual correctness in domains where each query is independent of the previous one.</p>\n<p>Single-Turn environments tasks are computationally efficient to train because there is no need to maintain long-term memory or context. They are commonly used to bootstrap an agent’s basic competencies before moving to more complex, multi-step environments.</p>",
    "contentMarkdown": "*   These environments are designed for tasks that require only a single input–output interaction, where the agent must produce one decisive response and then the environment resets. Examples include answering a question, solving a programming challenge, or completing a math problem.\n    \n*   In this setting, the reward signal directly evaluates the quality of the single output. Training methods usually combine supervised fine-tuning with RL from human or synthetic feedback (RLHF). For instance, in coding problems or reasoning benchmarks, the agent’s response can be automatically graded using execution correctness or symbolic validation. Such setups are ideal for optimizing precision and factual correctness in domains where each query is independent of the previous one.\n    \n*   Single-Turn environments tasks are computationally efficient to train because there is no need to maintain long-term memory or context. They are commonly used to bootstrap an agent’s basic competencies before moving to more complex, multi-step environments.\n    \n\nThese environments are designed for tasks that require only a single input–output interaction, where the agent must produce one decisive response and then the environment resets. Examples include answering a question, solving a programming challenge, or completing a math problem.\n\nIn this setting, the reward signal directly evaluates the quality of the single output. Training methods usually combine supervised fine-tuning with RL from human or synthetic feedback (RLHF). For instance, in coding problems or reasoning benchmarks, the agent’s response can be automatically graded using execution correctness or symbolic validation. Such setups are ideal for optimizing precision and factual correctness in domains where each query is independent of the previous one.\n\nSingle-Turn environments tasks are computationally efficient to train because there is no need to maintain long-term memory or context. They are commonly used to bootstrap an agent’s basic competencies before moving to more complex, multi-step environments.",
    "order": 11,
    "orderInChapter": 1,
    "difficulty": 2,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 295,
      "contentLength": 2161
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#single-turn-environments",
    "scrapedAt": "2025-12-28T11:47:36.151Z"
  },
  {
    "id": "ai-agentic-RL-tool-use-environments-12",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Types of RL Environments",
    "title": "Tool-Use Environments",
    "subtitle": "Types of RL Environments",
    "contentHtml": "<ul>\n  <li>\n    <p>Tool-use environments focus on enabling agents to perform reasoning and decision-making that involve invoking external tools—such as APIs, search engines, calculators, code interpreters, or databases—to complete a task. These environments simulate the agent’s ability to extend its cognitive boundaries by interacting with external systems.</p>\n  </li>\n  <li>\n    <p>In <a href=\"https://doi.org/10.1145/3704435\">Tool Learning with Foundation Models</a> by Qin et al. (2024), the authors surveyed a wide range of approaches where foundation models learn to select, call, and integrate the outputs of external tools into their reasoning processes. This kind of training allows the model to perform symbolic computation, factual verification, and data retrieval in ways that pure text-based reasoning cannot.</p>\n  </li>\n  <li>\n    <p>The following figure shows (<a href=\"https://doi.org/10.1145/3704435\">source</a>) the <em>conceptual overview of tool learning with foundation models</em>, where models dynamically decide when and how to invoke tools such as web search and other APIs to solve complex problems.</p>\n  </li>\n</ul>\n<p>Tool-use environments focus on enabling agents to perform reasoning and decision-making that involve invoking external tools—such as APIs, search engines, calculators, code interpreters, or databases—to complete a task. These environments simulate the agent’s ability to extend its cognitive boundaries by interacting with external systems.</p>\n<p>In <a href=\"https://doi.org/10.1145/3704435\">Tool Learning with Foundation Models</a> by Qin et al. (2024), the authors surveyed a wide range of approaches where foundation models learn to select, call, and integrate the outputs of external tools into their reasoning processes. This kind of training allows the model to perform symbolic computation, factual verification, and data retrieval in ways that pure text-based reasoning cannot.</p>\n<p>The following figure shows (<a href=\"https://doi.org/10.1145/3704435\">source</a>) the <em>conceptual overview of tool learning with foundation models</em>, where models dynamically decide when and how to invoke tools such as web search and other APIs to solve complex problems.</p>\n<p><img src=\"/primers/ai/assets/RL-for-agents/ToolLearningOverview.jpg\" alt=\"\"></p>\n<ul>\n  <li>\n    <p>A related innovation is <a href=\"https://arxiv.org/abs/2310.01045\">Tool-Augmented Reward Modeling</a> by Li et al. (2024), which enhanced RL reward models by giving them access to external APIs such as search engines or translation systems. This modification made reward models not only more accurate but also more interpretable, as each decision could be traced through explicit tool calls.</p>\n  </li>\n  <li>\n    <p>The following figure (<a href=\"https://arxiv.org/abs/2310.01045\">source</a>) shows illustrates the pipeline of (a) Vanilla reward models (RMs); (b) Tool-augmented RMs, namely Themis; (c) RL via proximal policy optimization (PPO) on above RMs; (d) Examples of single or multiple tool use process in the proposed approach.</p>\n  </li>\n</ul>\n<p>A related innovation is <a href=\"https://arxiv.org/abs/2310.01045\">Tool-Augmented Reward Modeling</a> by Li et al. (2024), which enhanced RL reward models by giving them access to external APIs such as search engines or translation systems. This modification made reward models not only more accurate but also more interpretable, as each decision could be traced through explicit tool calls.</p>\n<p>The following figure (<a href=\"https://arxiv.org/abs/2310.01045\">source</a>) shows illustrates the pipeline of (a) Vanilla reward models (RMs); (b) Tool-augmented RMs, namely Themis; (c) RL via proximal policy optimization (PPO) on above RMs; (d) Examples of single or multiple tool use process in the proposed approach.</p>\n<p><img src=\"/primers/ai/assets/RL-for-agents/Themis.jpg\" alt=\"\"></p>\n<ul>\n  <li>Tool-use environments test the agent’s ability to decide <em>when</em> and <em>how</em> to use a tool, what input arguments to provide, and how to interpret the returned results. This capability is crucial for building practical software assistants and web agents that interact with real systems.</li>\n</ul>",
    "contentMarkdown": "*   Tool-use environments focus on enabling agents to perform reasoning and decision-making that involve invoking external tools—such as APIs, search engines, calculators, code interpreters, or databases—to complete a task. These environments simulate the agent’s ability to extend its cognitive boundaries by interacting with external systems.\n    \n*   In [Tool Learning with Foundation Models](https://doi.org/10.1145/3704435) by Qin et al. (2024), the authors surveyed a wide range of approaches where foundation models learn to select, call, and integrate the outputs of external tools into their reasoning processes. This kind of training allows the model to perform symbolic computation, factual verification, and data retrieval in ways that pure text-based reasoning cannot.\n    \n*   The following figure shows ([source](https://doi.org/10.1145/3704435)) the _conceptual overview of tool learning with foundation models_, where models dynamically decide when and how to invoke tools such as web search and other APIs to solve complex problems.\n    \n\nTool-use environments focus on enabling agents to perform reasoning and decision-making that involve invoking external tools—such as APIs, search engines, calculators, code interpreters, or databases—to complete a task. These environments simulate the agent’s ability to extend its cognitive boundaries by interacting with external systems.\n\nIn [Tool Learning with Foundation Models](https://doi.org/10.1145/3704435) by Qin et al. (2024), the authors surveyed a wide range of approaches where foundation models learn to select, call, and integrate the outputs of external tools into their reasoning processes. This kind of training allows the model to perform symbolic computation, factual verification, and data retrieval in ways that pure text-based reasoning cannot.\n\nThe following figure shows ([source](https://doi.org/10.1145/3704435)) the _conceptual overview of tool learning with foundation models_, where models dynamically decide when and how to invoke tools such as web search and other APIs to solve complex problems.\n\n![](/primers/ai/assets/RL-for-agents/ToolLearningOverview.jpg)\n\n*   A related innovation is [Tool-Augmented Reward Modeling](https://arxiv.org/abs/2310.01045) by Li et al. (2024), which enhanced RL reward models by giving them access to external APIs such as search engines or translation systems. This modification made reward models not only more accurate but also more interpretable, as each decision could be traced through explicit tool calls.\n    \n*   The following figure ([source](https://arxiv.org/abs/2310.01045)) shows illustrates the pipeline of (a) Vanilla reward models (RMs); (b) Tool-augmented RMs, namely Themis; (c) RL via proximal policy optimization (PPO) on above RMs; (d) Examples of single or multiple tool use process in the proposed approach.\n    \n\nA related innovation is [Tool-Augmented Reward Modeling](https://arxiv.org/abs/2310.01045) by Li et al. (2024), which enhanced RL reward models by giving them access to external APIs such as search engines or translation systems. This modification made reward models not only more accurate but also more interpretable, as each decision could be traced through explicit tool calls.\n\nThe following figure ([source](https://arxiv.org/abs/2310.01045)) shows illustrates the pipeline of (a) Vanilla reward models (RMs); (b) Tool-augmented RMs, namely Themis; (c) RL via proximal policy optimization (PPO) on above RMs; (d) Examples of single or multiple tool use process in the proposed approach.\n\n![](/primers/ai/assets/RL-for-agents/Themis.jpg)\n\n*   Tool-use environments test the agent’s ability to decide _when_ and _how_ to use a tool, what input arguments to provide, and how to interpret the returned results. This capability is crucial for building practical software assistants and web agents that interact with real systems.",
    "order": 12,
    "orderInChapter": 2,
    "difficulty": 2,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": true,
      "wordCount": 522,
      "contentLength": 4201
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#tool-use-environments",
    "scrapedAt": "2025-12-28T11:47:36.151Z"
  },
  {
    "id": "ai-agentic-RL-multi-turn-environments-13",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Types of RL Environments",
    "title": "Multi-Turn Environments",
    "subtitle": "Types of RL Environments",
    "contentHtml": "<ul>\n  <li>\n    <p>Multi-turn environments represent the most complex and realistic category of RL settings. In these environments, an agent engages in extended, multi-step interactions where each decision depends on the evolving context and memory of previous steps. Examples include navigating a website, writing and revising code iteratively, managing files on a computer, or executing multi-phase workflows such as online booking or document editing.</p>\n  </li>\n  <li>\n    <p>Agents operating in these environments must reason about long-term goals, plan multiple actions in sequence, and interpret feedback dynamically. Systems such as WebArena, WebShop, <a href=\"https://arxiv.org/abs/2408.07199\">Agent Q</a> by Putta et al. (2024), and <a href=\"https://arxiv.org/abs/2410.19609\">OpenWebVoyager</a> by He et al. (2024) exemplify this paradigm. They train agents through multi-step RL using trajectory-based feedback, where each complete sequence of actions and observations contributes to the learning signal.</p>\n  </li>\n  <li>\n    <p>These environments are optimized for developing autonomy and adaptability. The agent must not only predict the next best action but also understand how that action contributes to the overall task objective. Multi-turn environments scenarios are thus the closest analogs to real-world usage, making them essential for training general-purpose digital agents.</p>\n  </li>\n</ul>\n<p>Multi-turn environments represent the most complex and realistic category of RL settings. In these environments, an agent engages in extended, multi-step interactions where each decision depends on the evolving context and memory of previous steps. Examples include navigating a website, writing and revising code iteratively, managing files on a computer, or executing multi-phase workflows such as online booking or document editing.</p>\n<p>Agents operating in these environments must reason about long-term goals, plan multiple actions in sequence, and interpret feedback dynamically. Systems such as WebArena, WebShop, <a href=\"https://arxiv.org/abs/2408.07199\">Agent Q</a> by Putta et al. (2024), and <a href=\"https://arxiv.org/abs/2410.19609\">OpenWebVoyager</a> by He et al. (2024) exemplify this paradigm. They train agents through multi-step RL using trajectory-based feedback, where each complete sequence of actions and observations contributes to the learning signal.</p>\n<p>These environments are optimized for developing autonomy and adaptability. The agent must not only predict the next best action but also understand how that action contributes to the overall task objective. Multi-turn environments scenarios are thus the closest analogs to real-world usage, making them essential for training general-purpose digital agents.</p>",
    "contentMarkdown": "*   Multi-turn environments represent the most complex and realistic category of RL settings. In these environments, an agent engages in extended, multi-step interactions where each decision depends on the evolving context and memory of previous steps. Examples include navigating a website, writing and revising code iteratively, managing files on a computer, or executing multi-phase workflows such as online booking or document editing.\n    \n*   Agents operating in these environments must reason about long-term goals, plan multiple actions in sequence, and interpret feedback dynamically. Systems such as WebArena, WebShop, [Agent Q](https://arxiv.org/abs/2408.07199) by Putta et al. (2024), and [OpenWebVoyager](https://arxiv.org/abs/2410.19609) by He et al. (2024) exemplify this paradigm. They train agents through multi-step RL using trajectory-based feedback, where each complete sequence of actions and observations contributes to the learning signal.\n    \n*   These environments are optimized for developing autonomy and adaptability. The agent must not only predict the next best action but also understand how that action contributes to the overall task objective. Multi-turn environments scenarios are thus the closest analogs to real-world usage, making them essential for training general-purpose digital agents.\n    \n\nMulti-turn environments represent the most complex and realistic category of RL settings. In these environments, an agent engages in extended, multi-step interactions where each decision depends on the evolving context and memory of previous steps. Examples include navigating a website, writing and revising code iteratively, managing files on a computer, or executing multi-phase workflows such as online booking or document editing.\n\nAgents operating in these environments must reason about long-term goals, plan multiple actions in sequence, and interpret feedback dynamically. Systems such as WebArena, WebShop, [Agent Q](https://arxiv.org/abs/2408.07199) by Putta et al. (2024), and [OpenWebVoyager](https://arxiv.org/abs/2410.19609) by He et al. (2024) exemplify this paradigm. They train agents through multi-step RL using trajectory-based feedback, where each complete sequence of actions and observations contributes to the learning signal.\n\nThese environments are optimized for developing autonomy and adaptability. The agent must not only predict the next best action but also understand how that action contributes to the overall task objective. Multi-turn environments scenarios are thus the closest analogs to real-world usage, making them essential for training general-purpose digital agents.",
    "order": 13,
    "orderInChapter": 3,
    "difficulty": 2,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 351,
      "contentLength": 2769
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#multi-turn-environments",
    "scrapedAt": "2025-12-28T11:47:36.151Z"
  },
  {
    "id": "ai-agentic-RL-implications-14",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Types of RL Environments",
    "title": "Implications",
    "subtitle": "Types of RL Environments",
    "contentHtml": "<ul>\n  <li>\n    <p>Agentic RL, which is the evolution of RL for agents—from single-turn tasks to tool-augmented reasoning and complex multi-turn workflows—reflects a progressive layering of capabilities. Each environment type plays a distinct role:</p>\n\n    <ul>\n      <li>Single-turn environments emphasize <em>accuracy and efficiency</em>, teaching agents to produce correct, concise responses.</li>\n      <li>Tool-use environments focus on <em>functional reasoning and integration</em>, giving agents the ability to extend their knowledge through computation and external APIs.</li>\n      <li>Multi-turn environments train <em>autonomy and planning</em>, enabling agents to navigate, adapt, and make decisions across extended sequences of interactions.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Together, these environments form the backbone of modern RL for LLM-based and multimodal agents. They provide a structured pathway for training models that can perceive, reason, and act—bringing us closer to general-purpose artificial intelligence capable of performing diverse tasks in real-world digital environments.</p>\n  </li>\n</ul>\n<p>Agentic RL, which is the evolution of RL for agents—from single-turn tasks to tool-augmented reasoning and complex multi-turn workflows—reflects a progressive layering of capabilities. Each environment type plays a distinct role:</p>\n<ul>\n      <li>Single-turn environments emphasize <em>accuracy and efficiency</em>, teaching agents to produce correct, concise responses.</li>\n      <li>Tool-use environments focus on <em>functional reasoning and integration</em>, giving agents the ability to extend their knowledge through computation and external APIs.</li>\n      <li>Multi-turn environments train <em>autonomy and planning</em>, enabling agents to navigate, adapt, and make decisions across extended sequences of interactions.</li>\n    </ul>\n<p>Together, these environments form the backbone of modern RL for LLM-based and multimodal agents. They provide a structured pathway for training models that can perceive, reason, and act—bringing us closer to general-purpose artificial intelligence capable of performing diverse tasks in real-world digital environments.</p>",
    "contentMarkdown": "*   Agentic RL, which is the evolution of RL for agents—from single-turn tasks to tool-augmented reasoning and complex multi-turn workflows—reflects a progressive layering of capabilities. Each environment type plays a distinct role:\n    \n    *   Single-turn environments emphasize _accuracy and efficiency_, teaching agents to produce correct, concise responses.\n    *   Tool-use environments focus on _functional reasoning and integration_, giving agents the ability to extend their knowledge through computation and external APIs.\n    *   Multi-turn environments train _autonomy and planning_, enabling agents to navigate, adapt, and make decisions across extended sequences of interactions.\n*   Together, these environments form the backbone of modern RL for LLM-based and multimodal agents. They provide a structured pathway for training models that can perceive, reason, and act—bringing us closer to general-purpose artificial intelligence capable of performing diverse tasks in real-world digital environments.\n    \n\nAgentic RL, which is the evolution of RL for agents—from single-turn tasks to tool-augmented reasoning and complex multi-turn workflows—reflects a progressive layering of capabilities. Each environment type plays a distinct role:\n\n*   Single-turn environments emphasize _accuracy and efficiency_, teaching agents to produce correct, concise responses.\n*   Tool-use environments focus on _functional reasoning and integration_, giving agents the ability to extend their knowledge through computation and external APIs.\n*   Multi-turn environments train _autonomy and planning_, enabling agents to navigate, adapt, and make decisions across extended sequences of interactions.\n\nTogether, these environments form the backbone of modern RL for LLM-based and multimodal agents. They provide a structured pathway for training models that can perceive, reason, and act—bringing us closer to general-purpose artificial intelligence capable of performing diverse tasks in real-world digital environments.",
    "order": 14,
    "orderInChapter": 4,
    "difficulty": 2,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 262,
      "contentLength": 2207
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#implications",
    "scrapedAt": "2025-12-28T11:47:36.151Z"
  },
  {
    "id": "ai-agentic-RL-background-policy-based-vs-value-based-methods-15",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Reinforcement Learning for Web and Computer-Use Agents",
    "title": "Background: Policy-Based vs. Value-Based Methods",
    "subtitle": "Reinforcement Learning for Web and Computer-Use Agents",
    "contentHtml": "<ul>\n  <li>\n    <p>At its core, RL employs two broad families of algorithmic approaches:</p>\n\n    <ul>\n      <li>Value-based methods, which learn a value function (e.g., <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-152-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2403\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2404\"><span class=\"mi\" id=\"MathJax-Span-2405\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2406\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2407\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2408\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2409\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2410\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-152\">Q(s,a)</script> or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-153-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2411\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2412\"><span class=\"mi\" id=\"MathJax-Span-2413\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2414\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2415\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2416\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-153\">V(s)</script>) that estimates the expected return of taking action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-154-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2417\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2418\"><span class=\"mi\" id=\"MathJax-Span-2419\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-154\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-155-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2420\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2421\"><span class=\"mi\" id=\"MathJax-Span-2422\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-155\">s</script> (or being in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-156-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2423\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2424\"><span class=\"mi\" id=\"MathJax-Span-2425\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-156\">s</script>).</li>\n      <li>\n        <p>Policy-based (or actor-critic) methods, which directly parameterize a policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-157-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2426\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2427\"><span class=\"msubsup\" id=\"MathJax-Span-2428\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2429\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2430\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2431\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2432\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2433\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-2434\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-2435\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-157\">\\pi_\\theta(a \\mid s)</script> and optimize its parameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-158-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2436\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2437\"><span class=\"mi\" id=\"MathJax-Span-2438\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>θ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-158\">\\theta</script> to maximize expected return</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-159-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C4;</mi><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2439\" style=\"width: 15.003em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.503em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1012.19em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2440\"><span class=\"mi\" id=\"MathJax-Span-2441\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2442\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2443\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2444\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2445\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2446\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2447\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2448\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2449\"><span class=\"mrow\" id=\"MathJax-Span-2450\"><span class=\"mi\" id=\"MathJax-Span-2451\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2452\"><span class=\"mrow\" id=\"MathJax-Span-2453\"><span class=\"mi\" id=\"MathJax-Span-2454\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2455\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"msubsup\" id=\"MathJax-Span-2456\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2457\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2458\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-2459\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2460\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-2461\"><span class=\"munderover\" id=\"MathJax-Span-2462\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2463\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-2464\"><span class=\"mrow\" id=\"MathJax-Span-2465\"><span class=\"mi\" id=\"MathJax-Span-2466\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2467\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-2468\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-2469\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2470\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2471\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2472\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2473\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2474\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2475\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2476\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2477\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2478\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2479\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2480\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2481\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2482\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-2483\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><msup><mi>γ</mi><mi>t</mi></msup><mi>R</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-159\">J(\\pi_\\theta) = \\mathbb{E}_{\\tau\\sim\\pi_\\theta}\\left[\\sum_{t=0}^T \\gamma^t R(s_t,a_t)\\right]</script>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>In modern agentic applications (web agents, computer-use agents), policy‐based methods tend to dominate because the action space is large, discrete (e.g., “click link”, “invoke API”, “enter code”), and policies must be expressive.</p>\n  </li>\n  <li>\n    <p>One widely used algorithm is Proximal Policy Optimization (PPO) <a href=\"https://arxiv.org/abs/1707.06347\">Schulman et al. (2017)</a>, which introduces a clipped surrogate objective to ensure stable updates and avoid large shifts in policy space.</p>\n  </li>\n  <li>\n    <p>The surrogate objective can be expressed as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-160-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>C</mi><mi mathvariant=&quot;normal&quot;>L</mi><mi mathvariant=&quot;normal&quot;>I</mi><mi mathvariant=&quot;normal&quot;>P</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mo>,</mo><mi>a</mi><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>d</mi></mrow></msub></mrow></msub></mrow></msub><mrow><mo>[</mo><mrow><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mrow><mo>(</mo><mrow><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi>A</mi><mi>t</mi></msub><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>p</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03F5;</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>&amp;#x03F5;</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi>A</mi><mi>t</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2484\" style=\"width: 29.482em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 24.534em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1024.38em, 3.492em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2485\"><span class=\"msubsup\" id=\"MathJax-Span-2486\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2487\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2488\"><span class=\"mrow\" id=\"MathJax-Span-2489\"><span class=\"mi\" id=\"MathJax-Span-2490\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">C</span><span class=\"mi\" id=\"MathJax-Span-2491\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span><span class=\"mi\" id=\"MathJax-Span-2492\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">I</span><span class=\"mi\" id=\"MathJax-Span-2493\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2494\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2495\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2496\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2497\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2498\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2499\"><span class=\"mrow\" id=\"MathJax-Span-2500\"><span class=\"mi\" id=\"MathJax-Span-2501\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2502\"><span class=\"mrow\" id=\"MathJax-Span-2503\"><span class=\"mi\" id=\"MathJax-Span-2504\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2505\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2506\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2507\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"msubsup\" id=\"MathJax-Span-2508\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2509\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2510\"><span class=\"mrow\" id=\"MathJax-Span-2511\"><span class=\"msubsup\" id=\"MathJax-Span-2512\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2513\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-2514\"><span class=\"mrow\" id=\"MathJax-Span-2515\"><span class=\"mi\" id=\"MathJax-Span-2516\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-2517\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-2518\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">d</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-2519\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2520\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-2521\"><span class=\"mo\" id=\"MathJax-Span-2522\" style=\"font-family: STIXGeneral-Regular;\">min</span><span class=\"mrow\" id=\"MathJax-Span-2523\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2524\" style=\"vertical-align: 0em;\"><span style=\"font-family: STIXGeneral-Regular;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-2525\"><span class=\"msubsup\" id=\"MathJax-Span-2526\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2527\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2528\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2529\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2530\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2531\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-2532\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2533\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2534\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2535\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-2536\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-2537\"><span class=\"mi\" id=\"MathJax-Span-2538\" style=\"font-family: STIXGeneral-Regular;\">c</span><span class=\"mi\" id=\"MathJax-Span-2539\" style=\"font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-2540\" style=\"font-family: STIXGeneral-Regular;\">i</span><span class=\"mi\" id=\"MathJax-Span-2541\" style=\"font-family: STIXGeneral-Regular;\">p</span></span></span><span class=\"mo\" id=\"MathJax-Span-2542\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2543\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2544\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2545\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2546\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2547\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2548\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2549\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-2550\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-2551\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-2552\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">ϵ</span><span class=\"mo\" id=\"MathJax-Span-2553\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-2554\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-2555\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2556\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">ϵ</span><span class=\"mo\" id=\"MathJax-Span-2557\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-2558\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2559\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2560\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2561\" style=\"vertical-align: 0em;\"><span style=\"font-family: STIXGeneral-Regular;\">)</span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2562\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">C</mi><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">I</mi><mi mathvariant=\"normal\">P</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>s</mi><mo>,</mo><mi>a</mi><mo>∼</mo><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">d</mi></mrow></msub></mrow></msub></mrow></msub><mrow><mo>[</mo><mrow><mo movablelimits=\"true\" form=\"prefix\">min</mo><mrow><mo>(</mo><mrow><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><msub><mi>A</mi><mi>t</mi></msub><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">c</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">p</mi></mrow><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mn>1</mn><mo>−</mo><mi>ϵ</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>ϵ</mi><mo stretchy=\"false\">)</mo><msub><mi>A</mi><mi>t</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-160\">L^{\\rm CLIP}(\\theta) = \\mathbb{E}_{s,a\\sim\\pi_{\\theta_{\\rm old}}}\\left[ \\min\\left( r_t(\\theta) A_t, \\mathrm{clip}(r_t(\\theta),1-\\epsilon,1+\\epsilon) A_t \\right) \\right]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-161-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>d</mi></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2563\" style=\"width: 7.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.992em, 1006.46em, 3.023em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2564\"><span class=\"msubsup\" id=\"MathJax-Span-2565\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2566\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2567\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2568\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2569\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2570\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2571\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-2572\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.29em, 4.326em, -999.997em); top: -4.529em; left: 50%; margin-left: -1.195em;\"><span class=\"mrow\" id=\"MathJax-Span-2573\"><span class=\"msubsup\" id=\"MathJax-Span-2574\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2575\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2576\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2577\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2578\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2579\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2580\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2581\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∣</span><span class=\"msubsup\" id=\"MathJax-Span-2582\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2583\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2584\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2585\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.97em, 4.43em, -999.997em); top: -3.591em; left: 50%; margin-left: -1.508em;\"><span class=\"mrow\" id=\"MathJax-Span-2586\"><span class=\"msubsup\" id=\"MathJax-Span-2587\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2588\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2589\"><span class=\"mrow\" id=\"MathJax-Span-2590\"><span class=\"msubsup\" id=\"MathJax-Span-2591\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2592\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-2593\"><span class=\"mrow\" id=\"MathJax-Span-2594\"><span class=\"mi\" id=\"MathJax-Span-2595\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-2596\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-2597\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">d</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2598\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2599\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2600\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2601\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2602\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∣</span><span class=\"msubsup\" id=\"MathJax-Span-2603\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2604\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2605\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2606\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.13em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.128em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">d</mi></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-161\">r_t(\\theta)=\\frac{\\pi_\\theta(a_t \\mid s_t)}{\\pi_{\\theta_{\\rm old}}(a_t \\mid s_t)}</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-162-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2607\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2608\"><span class=\"msubsup\" id=\"MathJax-Span-2609\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2610\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2611\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-162\">A_t</script> is the advantage estimate at time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-163-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2612\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2613\"><span class=\"mi\" id=\"MathJax-Span-2614\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-163\">t</script>.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This ensures that the policy update does not diverge too far from the previous one while still improving expected return.</p>\n  </li>\n</ul>\n<p>At its core, RL employs two broad families of algorithmic approaches:</p>\n<ul>\n      <li>Value-based methods, which learn a value function (e.g., <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-152-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2403\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2404\"><span class=\"mi\" id=\"MathJax-Span-2405\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2406\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2407\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2408\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2409\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2410\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-152\">Q(s,a)</script> or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-153-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2411\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2412\"><span class=\"mi\" id=\"MathJax-Span-2413\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2414\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2415\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2416\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-153\">V(s)</script>) that estimates the expected return of taking action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-154-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2417\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2418\"><span class=\"mi\" id=\"MathJax-Span-2419\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-154\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-155-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2420\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2421\"><span class=\"mi\" id=\"MathJax-Span-2422\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-155\">s</script> (or being in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-156-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2423\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2424\"><span class=\"mi\" id=\"MathJax-Span-2425\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-156\">s</script>).</li>\n      <li>\n        <p>Policy-based (or actor-critic) methods, which directly parameterize a policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-157-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2426\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2427\"><span class=\"msubsup\" id=\"MathJax-Span-2428\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2429\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2430\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2431\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2432\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2433\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-2434\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-2435\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-157\">\\pi_\\theta(a \\mid s)</script> and optimize its parameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-158-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2436\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2437\"><span class=\"mi\" id=\"MathJax-Span-2438\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>θ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-158\">\\theta</script> to maximize expected return</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-159-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C4;</mi><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2439\" style=\"width: 15.003em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.503em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1012.19em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2440\"><span class=\"mi\" id=\"MathJax-Span-2441\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2442\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2443\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2444\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2445\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2446\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2447\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2448\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2449\"><span class=\"mrow\" id=\"MathJax-Span-2450\"><span class=\"mi\" id=\"MathJax-Span-2451\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2452\"><span class=\"mrow\" id=\"MathJax-Span-2453\"><span class=\"mi\" id=\"MathJax-Span-2454\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2455\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"msubsup\" id=\"MathJax-Span-2456\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2457\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2458\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-2459\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2460\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-2461\"><span class=\"munderover\" id=\"MathJax-Span-2462\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2463\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-2464\"><span class=\"mrow\" id=\"MathJax-Span-2465\"><span class=\"mi\" id=\"MathJax-Span-2466\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2467\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-2468\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-2469\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2470\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2471\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2472\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2473\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2474\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2475\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2476\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2477\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2478\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2479\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2480\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2481\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2482\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-2483\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><msup><mi>γ</mi><mi>t</mi></msup><mi>R</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-159\">J(\\pi_\\theta) = \\mathbb{E}_{\\tau\\sim\\pi_\\theta}\\left[\\sum_{t=0}^T \\gamma^t R(s_t,a_t)\\right]</script>\n      </li>\n    </ul>\n<p>Policy-based (or actor-critic) methods, which directly parameterize a policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-157-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2426\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2427\"><span class=\"msubsup\" id=\"MathJax-Span-2428\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2429\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2430\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2431\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2432\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2433\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-2434\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-2435\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-157\">\\pi_\\theta(a \\mid s)</script> and optimize its parameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-158-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2436\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2437\"><span class=\"mi\" id=\"MathJax-Span-2438\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>θ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-158\">\\theta</script> to maximize expected return</p>\n<p>In modern agentic applications (web agents, computer-use agents), policy‐based methods tend to dominate because the action space is large, discrete (e.g., “click link”, “invoke API”, “enter code”), and policies must be expressive.</p>\n<p>One widely used algorithm is Proximal Policy Optimization (PPO) <a href=\"https://arxiv.org/abs/1707.06347\">Schulman et al. (2017)</a>, which introduces a clipped surrogate objective to ensure stable updates and avoid large shifts in policy space.</p>\n<p>The surrogate objective can be expressed as:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-161-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>d</mi></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2563\" style=\"width: 7.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.992em, 1006.46em, 3.023em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2564\"><span class=\"msubsup\" id=\"MathJax-Span-2565\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2566\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2567\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2568\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2569\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2570\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2571\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-2572\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.29em, 4.326em, -999.997em); top: -4.529em; left: 50%; margin-left: -1.195em;\"><span class=\"mrow\" id=\"MathJax-Span-2573\"><span class=\"msubsup\" id=\"MathJax-Span-2574\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2575\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2576\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2577\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2578\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2579\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2580\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2581\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∣</span><span class=\"msubsup\" id=\"MathJax-Span-2582\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2583\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2584\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2585\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.97em, 4.43em, -999.997em); top: -3.591em; left: 50%; margin-left: -1.508em;\"><span class=\"mrow\" id=\"MathJax-Span-2586\"><span class=\"msubsup\" id=\"MathJax-Span-2587\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2588\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2589\"><span class=\"mrow\" id=\"MathJax-Span-2590\"><span class=\"msubsup\" id=\"MathJax-Span-2591\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2592\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-2593\"><span class=\"mrow\" id=\"MathJax-Span-2594\"><span class=\"mi\" id=\"MathJax-Span-2595\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-2596\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-2597\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">d</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2598\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2599\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2600\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2601\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2602\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∣</span><span class=\"msubsup\" id=\"MathJax-Span-2603\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2604\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2605\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2606\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.13em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.128em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>θ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">d</mi></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-161\">r_t(\\theta)=\\frac{\\pi_\\theta(a_t \\mid s_t)}{\\pi_{\\theta_{\\rm old}}(a_t \\mid s_t)}</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-162-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2607\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2608\"><span class=\"msubsup\" id=\"MathJax-Span-2609\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2610\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2611\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-162\">A_t</script> is the advantage estimate at time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-163-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2612\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2613\"><span class=\"mi\" id=\"MathJax-Span-2614\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-163\">t</script>.</li>\n    </ul>\n<p>This ensures that the policy update does not diverge too far from the previous one while still improving expected return.</p>",
    "contentMarkdown": "*   At its core, RL employs two broad families of algorithmic approaches:\n    \n    *   Value-based methods, which learn a value function (e.g., Q(s,a)Q(s,a)Q(s,a) or V(s)V(s)V(s)) that estimates the expected return of taking action aaa in state sss (or being in state sss).\n    *   Policy-based (or actor-critic) methods, which directly parameterize a policy πθ(a∣s)πθ(a∣s)\\\\pi\\_\\\\theta(a \\\\mid s) and optimize its parameters θθ\\\\theta to maximize expected return\n        \n        J(πθ)\\=𝔼τ∼πθ\\[∑t\\=0TγtR(st,at)\\]J(πθ)\\=Eτ∼πθ\\[∑t\\=0TγtR(st,at)\\]\n        \n        J(\\\\pi\\_\\\\theta) = \\\\mathbb{E}\\_{\\\\tau\\\\sim\\\\pi\\_\\\\theta}\\\\left\\[\\\\sum\\_{t=0}^T \\\\gamma^t R(s\\_t,a\\_t)\\\\right\\]\n*   In modern agentic applications (web agents, computer-use agents), policy‐based methods tend to dominate because the action space is large, discrete (e.g., “click link”, “invoke API”, “enter code”), and policies must be expressive.\n    \n*   One widely used algorithm is Proximal Policy Optimization (PPO) [Schulman et al. (2017)](https://arxiv.org/abs/1707.06347), which introduces a clipped surrogate objective to ensure stable updates and avoid large shifts in policy space.\n    \n*   The surrogate objective can be expressed as:\n    \n    LCLIP(θ)\\=𝔼s,a∼πθold\\[min(rt(θ)At,clip(rt(θ),1−ϵ,1+ϵ)At)\\]LCLIP(θ)\\=Es,a∼πθold\\[min(rt(θ)At,clip(rt(θ),1−ϵ,1+ϵ)At)\\]\n    \n    L^{\\\\rm CLIP}(\\\\theta) = \\\\mathbb{E}\\_{s,a\\\\sim\\\\pi\\_{\\\\theta\\_{\\\\rm old}}}\\\\left\\[ \\\\min\\\\left( r\\_t(\\\\theta) A\\_t, \\\\mathrm{clip}(r\\_t(\\\\theta),1-\\\\epsilon,1+\\\\epsilon) A\\_t \\\\right) \\\\right\\]\n    *   where rt(θ)\\=πθ(at∣st)πθold(at∣st)rt(θ)\\=πθ(at∣st)πθold(at∣st)r\\_t(\\\\theta)=\\\\frac{\\\\pi\\_\\\\theta(a\\_t \\\\mid s\\_t)}{\\\\pi\\_{\\\\theta\\_{\\\\rm old}}(a\\_t \\\\mid s\\_t)} and AtAtA\\_t is the advantage estimate at time ttt.\n*   This ensures that the policy update does not diverge too far from the previous one while still improving expected return.\n    \n\nAt its core, RL employs two broad families of algorithmic approaches:\n\n*   Value-based methods, which learn a value function (e.g., Q(s,a)Q(s,a)Q(s,a) or V(s)V(s)V(s)) that estimates the expected return of taking action aaa in state sss (or being in state sss).\n*   Policy-based (or actor-critic) methods, which directly parameterize a policy πθ(a∣s)πθ(a∣s)\\\\pi\\_\\\\theta(a \\\\mid s) and optimize its parameters θθ\\\\theta to maximize expected return\n    \n    J(πθ)\\=𝔼τ∼πθ\\[∑t\\=0TγtR(st,at)\\]J(πθ)\\=Eτ∼πθ\\[∑t\\=0TγtR(st,at)\\]\n    \n    J(\\\\pi\\_\\\\theta) = \\\\mathbb{E}\\_{\\\\tau\\\\sim\\\\pi\\_\\\\theta}\\\\left\\[\\\\sum\\_{t=0}^T \\\\gamma^t R(s\\_t,a\\_t)\\\\right\\]\n\nPolicy-based (or actor-critic) methods, which directly parameterize a policy πθ(a∣s)πθ(a∣s)\\\\pi\\_\\\\theta(a \\\\mid s) and optimize its parameters θθ\\\\theta to maximize expected return\n\nIn modern agentic applications (web agents, computer-use agents), policy‐based methods tend to dominate because the action space is large, discrete (e.g., “click link”, “invoke API”, “enter code”), and policies must be expressive.\n\nOne widely used algorithm is Proximal Policy Optimization (PPO) [Schulman et al. (2017)](https://arxiv.org/abs/1707.06347), which introduces a clipped surrogate objective to ensure stable updates and avoid large shifts in policy space.\n\nThe surrogate objective can be expressed as:\n\n*   where rt(θ)\\=πθ(at∣st)πθold(at∣st)rt(θ)\\=πθ(at∣st)πθold(at∣st)r\\_t(\\\\theta)=\\\\frac{\\\\pi\\_\\\\theta(a\\_t \\\\mid s\\_t)}{\\\\pi\\_{\\\\theta\\_{\\\\rm old}}(a\\_t \\\\mid s\\_t)} and AtAtA\\_t is the advantage estimate at time ttt.\n\nThis ensures that the policy update does not diverge too far from the previous one while still improving expected return.",
    "order": 15,
    "orderInChapter": 1,
    "difficulty": 3,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 387,
      "contentLength": 95811
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#background:-policy-based-vs.-value-based-methods",
    "scrapedAt": "2025-12-28T11:47:36.151Z"
  },
  {
    "id": "ai-agentic-RL-background-process-wise-rewards-vs-outcome-based-r-16",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Reinforcement Learning for Web and Computer-Use Agents",
    "title": "Background: Process-Wise Rewards vs. Outcome-Based Rewards",
    "subtitle": "Reinforcement Learning for Web and Computer-Use Agents",
    "contentHtml": "<ul>\n  <li>\n    <p>When designing RL systems for digital agents, one of the most consequential design choices lies in <em>how</em> rewards are provided to the model.</p>\n  </li>\n  <li>\n    <p><strong>Outcome-based rewards</strong> give feedback only at the end of a task—for instance, a success/failure score after the agent completes a booking or answers a question. This is common in <em>single-turn environments</em> tasks and short workflows, where each interaction produces a single measurable outcome.</p>\n\n    <ul>\n      <li>While simple, outcome-based rewards are <em>sparse</em>, often forcing the agent to explore many possibilities before discovering actions that yield high return.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Process-wise (step-wise) rewards</strong>, in contrast, provide incremental feedback during the task. In a web-navigation scenario, for example, the agent might receive positive reward for successfully clicking the correct link, partially filling a form, or retrieving relevant information—even before the final goal is achieved.</p>\n\n    <ul>\n      <li>This approach is critical in <em>multi-turn environments</em> or <em>tool-use environments</em> setups where tasks span many steps. By assigning intermediate rewards, process-wise systems promote <em>shaped learning</em>—accelerating convergence and improving interpretability of the agent’s learning process.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Formally, if an episode runs for <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-164-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2615\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2616\"><span class=\"mi\" id=\"MathJax-Span-2617\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>T</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-164\">T</script> steps, the total return under step-wise rewards is:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-165-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2618\" style=\"width: 7.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.263em, 1005.99em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2619\"><span class=\"msubsup\" id=\"MathJax-Span-2620\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2621\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2622\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2623\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-2624\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2625\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.159em;\"><span class=\"texatom\" id=\"MathJax-Span-2626\"><span class=\"mrow\" id=\"MathJax-Span-2627\"><span class=\"mi\" id=\"MathJax-Span-2628\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2629\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mi\" id=\"MathJax-Span-2630\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-2631\"><span class=\"mrow\" id=\"MathJax-Span-2632\"><span class=\"mi\" id=\"MathJax-Span-2633\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2634\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2635\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2636\"><span class=\"mrow\" id=\"MathJax-Span-2637\"><span class=\"mi\" id=\"MathJax-Span-2638\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2639\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mi\" id=\"MathJax-Span-2640\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2641\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2642\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2643\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi></mrow></munderover><msup><mi>γ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>−</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-165\">R_t = \\sum_{k=t}^{T} \\gamma^{k-t}r_k</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-166-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2644\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2645\"><span class=\"msubsup\" id=\"MathJax-Span-2646\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2647\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2648\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-166\">r_k</script> are per-step rewards. In outcome-based schemes, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-167-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>k</mi></msub><mo>=</mo><mn>0</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2649\" style=\"width: 3.023em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.503em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.5em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2650\"><span class=\"msubsup\" id=\"MathJax-Span-2651\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2652\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2653\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2654\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-2655\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>k</mi></msub><mo>=</mo><mn>0</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-167\">r_k = 0</script> for all <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-168-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;lt;</mo><mi>T</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2656\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.35em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2657\"><span class=\"mi\" id=\"MathJax-Span-2658\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2659\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-2660\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi><mo>&lt;</mo><mi>T</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-168\">k<T</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-169-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>T</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2661\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2662\"><span class=\"msubsup\" id=\"MathJax-Span-2663\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2664\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2665\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>T</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-169\">r_T</script> encodes task success. Choosing between these schemes depends on the environment’s complexity and availability of fine-grained performance metrics.</li>\n    </ul>\n  </li>\n  <li>\n    <p>For web agents, hybrid strategies are often used: process-wise signals derived from <em>browser state</em> (e.g., correct navigation, reduced error rate) combined with final outcome rewards (task completion). This hybridization reduces the high variance of pure outcome-based rewards while preserving the integrity of long-horizon objectives.</p>\n  </li>\n</ul>\n<p>When designing RL systems for digital agents, one of the most consequential design choices lies in <em>how</em> rewards are provided to the model.</p>\n<p><strong>Outcome-based rewards</strong> give feedback only at the end of a task—for instance, a success/failure score after the agent completes a booking or answers a question. This is common in <em>single-turn environments</em> tasks and short workflows, where each interaction produces a single measurable outcome.</p>\n<ul>\n      <li>While simple, outcome-based rewards are <em>sparse</em>, often forcing the agent to explore many possibilities before discovering actions that yield high return.</li>\n    </ul>\n<p><strong>Process-wise (step-wise) rewards</strong>, in contrast, provide incremental feedback during the task. In a web-navigation scenario, for example, the agent might receive positive reward for successfully clicking the correct link, partially filling a form, or retrieving relevant information—even before the final goal is achieved.</p>\n<ul>\n      <li>This approach is critical in <em>multi-turn environments</em> or <em>tool-use environments</em> setups where tasks span many steps. By assigning intermediate rewards, process-wise systems promote <em>shaped learning</em>—accelerating convergence and improving interpretability of the agent’s learning process.</li>\n    </ul>\n<p>Formally, if an episode runs for <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-164-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2615\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2616\"><span class=\"mi\" id=\"MathJax-Span-2617\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>T</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-164\">T</script> steps, the total return under step-wise rewards is:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-166-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2644\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2645\"><span class=\"msubsup\" id=\"MathJax-Span-2646\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2647\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2648\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-166\">r_k</script> are per-step rewards. In outcome-based schemes, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-167-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>k</mi></msub><mo>=</mo><mn>0</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2649\" style=\"width: 3.023em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.503em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.5em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2650\"><span class=\"msubsup\" id=\"MathJax-Span-2651\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2652\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2653\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2654\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-2655\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>k</mi></msub><mo>=</mo><mn>0</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-167\">r_k = 0</script> for all <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-168-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;lt;</mo><mi>T</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2656\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.35em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2657\"><span class=\"mi\" id=\"MathJax-Span-2658\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2659\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-2660\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi><mo>&lt;</mo><mi>T</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-168\">k<T</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-169-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>T</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2661\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2662\"><span class=\"msubsup\" id=\"MathJax-Span-2663\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2664\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2665\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>T</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-169\">r_T</script> encodes task success. Choosing between these schemes depends on the environment’s complexity and availability of fine-grained performance metrics.</li>\n    </ul>\n<p>For web agents, hybrid strategies are often used: process-wise signals derived from <em>browser state</em> (e.g., correct navigation, reduced error rate) combined with final outcome rewards (task completion). This hybridization reduces the high variance of pure outcome-based rewards while preserving the integrity of long-horizon objectives.</p>",
    "contentMarkdown": "*   When designing RL systems for digital agents, one of the most consequential design choices lies in _how_ rewards are provided to the model.\n    \n*   **Outcome-based rewards** give feedback only at the end of a task—for instance, a success/failure score after the agent completes a booking or answers a question. This is common in _single-turn environments_ tasks and short workflows, where each interaction produces a single measurable outcome.\n    \n    *   While simple, outcome-based rewards are _sparse_, often forcing the agent to explore many possibilities before discovering actions that yield high return.\n*   **Process-wise (step-wise) rewards**, in contrast, provide incremental feedback during the task. In a web-navigation scenario, for example, the agent might receive positive reward for successfully clicking the correct link, partially filling a form, or retrieving relevant information—even before the final goal is achieved.\n    \n    *   This approach is critical in _multi-turn environments_ or _tool-use environments_ setups where tasks span many steps. By assigning intermediate rewards, process-wise systems promote _shaped learning_—accelerating convergence and improving interpretability of the agent’s learning process.\n*   Formally, if an episode runs for TTT steps, the total return under step-wise rewards is:\n    \n    Rt\\=∑k\\=tTγk−trkRt\\=∑k\\=tTγk−trk\n    \n    R\\_t = \\\\sum\\_{k=t}^{T} \\\\gamma^{k-t}r\\_k\n    *   where rkrkr\\_k are per-step rewards. In outcome-based schemes, rk\\=0rk\\=0r\\_k = 0 for all k<Tk<Tk<T, and rTrTr\\_T encodes task success. Choosing between these schemes depends on the environment’s complexity and availability of fine-grained performance metrics.\n*   For web agents, hybrid strategies are often used: process-wise signals derived from _browser state_ (e.g., correct navigation, reduced error rate) combined with final outcome rewards (task completion). This hybridization reduces the high variance of pure outcome-based rewards while preserving the integrity of long-horizon objectives.\n    \n\nWhen designing RL systems for digital agents, one of the most consequential design choices lies in _how_ rewards are provided to the model.\n\n**Outcome-based rewards** give feedback only at the end of a task—for instance, a success/failure score after the agent completes a booking or answers a question. This is common in _single-turn environments_ tasks and short workflows, where each interaction produces a single measurable outcome.\n\n*   While simple, outcome-based rewards are _sparse_, often forcing the agent to explore many possibilities before discovering actions that yield high return.\n\n**Process-wise (step-wise) rewards**, in contrast, provide incremental feedback during the task. In a web-navigation scenario, for example, the agent might receive positive reward for successfully clicking the correct link, partially filling a form, or retrieving relevant information—even before the final goal is achieved.\n\n*   This approach is critical in _multi-turn environments_ or _tool-use environments_ setups where tasks span many steps. By assigning intermediate rewards, process-wise systems promote _shaped learning_—accelerating convergence and improving interpretability of the agent’s learning process.\n\nFormally, if an episode runs for TTT steps, the total return under step-wise rewards is:\n\n*   where rkrkr\\_k are per-step rewards. In outcome-based schemes, rk\\=0rk\\=0r\\_k = 0 for all k<Tk<Tk<T, and rTrTr\\_T encodes task success. Choosing between these schemes depends on the environment’s complexity and availability of fine-grained performance metrics.\n\nFor web agents, hybrid strategies are often used: process-wise signals derived from _browser state_ (e.g., correct navigation, reduced error rate) combined with final outcome rewards (task completion). This hybridization reduces the high variance of pure outcome-based rewards while preserving the integrity of long-horizon objectives.",
    "order": 16,
    "orderInChapter": 2,
    "difficulty": 4,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 530,
      "contentLength": 29385
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#background:-process-wise-rewards-vs.-outcome-based-rewards",
    "scrapedAt": "2025-12-28T11:47:36.151Z"
  },
  {
    "id": "ai-agentic-RL-reinforcement-learning-from-human-feedback-rlhf-an-17",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Reinforcement Learning for Web and Computer-Use Agents",
    "title": "Reinforcement Learning from Human Feedback (RLHF) and Direct Preference Optimization (DPO)",
    "subtitle": "Reinforcement Learning for Web and Computer-Use Agents",
    "contentHtml": "<ul>\n  <li>\n    <p>For web/computer-use agents built on LLMs or similar, one key method is RL from Human Feedback (RLHF). The standard RLHF pipeline is:</p>\n\n    <ol>\n      <li>Supervised fine-tune a base language model on prompt–response pairs.</li>\n      <li>Collect human preference data: for each prompt, have humans rank multiple model responses (or choose preferred vs. non-preferred).</li>\n      <li>Train a reward model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-170-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2666\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2667\"><span class=\"msubsup\" id=\"MathJax-Span-2668\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2669\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2670\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2671\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2672\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2673\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2674\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-2675\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-170\">r_\\phi(x,y)</script> to predict human preferences.</li>\n      <li>Use an RL algorithm (often PPO) to optimize the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-171-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2676\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2677\"><span class=\"msubsup\" id=\"MathJax-Span-2678\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2679\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2680\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-171\">\\pi_\\theta</script> to maximise expected reward under the reward model, possibly adding KL-penalty to stay close to base model.</li>\n    </ol>\n  </li>\n  <li>\n    <p>For example, the survey article <a href=\"https://arxiv.org/abs/2412.10400v1\">Reinforcement Learning Enhanced LLMs: A Survey</a> provides an overview of this field.</p>\n  </li>\n  <li>\n    <p>However, RLHF can be unstable, costly in compute, and sensitive to reward-model errors. Enter Direct Preference Optimization (DPO) <a href=\"https://arxiv.org/abs/2305.18290\">Rafailov et al. (2023)</a>, which posits that one can skip the explicit reward model + RL loop and simply fine-tune the model directly to optimize human preference pairwise comparisons.</p>\n  </li>\n  <li>\n    <p>The DPO loss in the pairwise case (winner <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-172-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>w</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2681\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.99em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2682\"><span class=\"msubsup\" id=\"MathJax-Span-2683\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2684\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2685\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>w</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-172\">y_w</script>, loser <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-173-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>l</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2686\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2687\"><span class=\"msubsup\" id=\"MathJax-Span-2688\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2689\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2690\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>l</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-173\">y_l</script>) is approximately:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-174-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>D</mi><mi mathvariant=&quot;normal&quot;>P</mi><mi mathvariant=&quot;normal&quot;>O</mi></mrow></msub><mo>=</mo><mo>&amp;#x2212;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mrow><mo>[</mo><mrow><mi>ln</mi><mo>&amp;#x2061;</mo><mi>&amp;#x03C3;</mi><mrow><mo>(</mo><mrow><mi>&amp;#x03B2;</mi><mi>ln</mi><mo>&amp;#x2061;</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>w</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>w</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>&amp;#x2212;</mo><mi>&amp;#x03B2;</mi><mi>ln</mi><mo>&amp;#x2061;</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>l</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>l</mi></msub><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2691\" style=\"width: 29.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 24.43em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.294em, 1024.22em, 4.846em, -999.997em); top: -3.799em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2692\"><span class=\"msubsup\" id=\"MathJax-Span-2693\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2694\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-2695\"><span class=\"mrow\" id=\"MathJax-Span-2696\"><span class=\"mi\" id=\"MathJax-Span-2697\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">D</span><span class=\"mi\" id=\"MathJax-Span-2698\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">P</span><span class=\"mi\" id=\"MathJax-Span-2699\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">O</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2700\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-2701\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-2702\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2703\"><span class=\"mrow\" id=\"MathJax-Span-2704\"><span class=\"mi\" id=\"MathJax-Span-2705\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2706\"><span class=\"mrow\" id=\"MathJax-Span-2707\"><span class=\"mo\" id=\"MathJax-Span-2708\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2709\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2710\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2711\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2712\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-2713\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2714\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2715\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2716\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-2717\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2718\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-2719\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2720\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">[</span></span></span><span class=\"mrow\" id=\"MathJax-Span-2721\"><span class=\"mi\" id=\"MathJax-Span-2722\" style=\"font-family: STIXGeneral-Regular;\">ln</span><span class=\"mo\" id=\"MathJax-Span-2723\"></span><span class=\"mi\" id=\"MathJax-Span-2724\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mrow\" id=\"MathJax-Span-2725\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2726\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">(</span></span></span><span class=\"mrow\" id=\"MathJax-Span-2727\"><span class=\"mi\" id=\"MathJax-Span-2728\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2729\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">ln</span><span class=\"mo\" id=\"MathJax-Span-2730\"></span><span class=\"mfrac\" id=\"MathJax-Span-2731\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.28em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.664em;\"><span class=\"mrow\" id=\"MathJax-Span-2732\"><span class=\"msubsup\" id=\"MathJax-Span-2733\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2734\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2735\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2736\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2737\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2738\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2739\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2740\"><span class=\"mrow\" id=\"MathJax-Span-2741\"><span class=\"mo\" id=\"MathJax-Span-2742\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-2743\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2744\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.8em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -1.924em;\"><span class=\"mrow\" id=\"MathJax-Span-2745\"><span class=\"msubsup\" id=\"MathJax-Span-2746\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2747\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2748\"><span class=\"mrow\" id=\"MathJax-Span-2749\"><span class=\"mi\" id=\"MathJax-Span-2750\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2751\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-2752\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2753\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2754\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2755\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2756\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2757\"><span class=\"mrow\" id=\"MathJax-Span-2758\"><span class=\"mo\" id=\"MathJax-Span-2759\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-2760\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2761\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.96em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.961em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2762\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-2763\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2764\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">ln</span><span class=\"mo\" id=\"MathJax-Span-2765\"></span><span class=\"mfrac\" id=\"MathJax-Span-2766\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 4.273em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.02em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.56em;\"><span class=\"mrow\" id=\"MathJax-Span-2767\"><span class=\"msubsup\" id=\"MathJax-Span-2768\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2769\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2770\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2771\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2772\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2773\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2774\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2775\"><span class=\"mrow\" id=\"MathJax-Span-2776\"><span class=\"mo\" id=\"MathJax-Span-2777\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-2778\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2779\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1004.07em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -2.081em;\"><span class=\"mrow\" id=\"MathJax-Span-2780\"><span class=\"msubsup\" id=\"MathJax-Span-2781\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2782\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2783\"><span class=\"mrow\" id=\"MathJax-Span-2784\"><span class=\"mi\" id=\"MathJax-Span-2785\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2786\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-2787\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2788\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2789\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2790\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2791\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2792\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-2793\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2794\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.27em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.273em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2795\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">)</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2796\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">]</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.805em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">D</mi><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">O</mi></mrow></msub><mo>=</mo><mo>−</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=\"false\">)</mo></mrow></msub><mrow><mo>[</mo><mrow><mi>ln</mi><mo>⁡</mo><mi>σ</mi><mrow><mo>(</mo><mrow><mi>β</mi><mi>ln</mi><mo>⁡</mo><mfrac><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>w</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>w</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>−</mo><mi>β</mi><mi>ln</mi><mo>⁡</mo><mfrac><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>l</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>l</mi></msub><mo>∣</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-174\">L_{\\rm DPO} = -\\mathbb{E}_{(x,y_w,y_l)}\\left[ \\ln \\sigma\\left(\\beta \\ln\\frac{\\pi_\\theta(y_w|x)}{\\pi_{\\rm ref}(y_w|x)} - \\beta \\ln\\frac{\\pi_\\theta(y_l|x)}{\\pi_{\\rm ref}(y_l \\mid x)}\\right) \\right]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-175-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2797\" style=\"width: 1.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.41em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2798\"><span class=\"msubsup\" id=\"MathJax-Span-2799\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2800\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2801\"><span class=\"mrow\" id=\"MathJax-Span-2802\"><span class=\"mi\" id=\"MathJax-Span-2803\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2804\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-2805\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-175\">\\pi_{\\rm ref}</script> is the reference model (often the supervised fine-tuned model), and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-176-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2806\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2807\"><span class=\"mi\" id=\"MathJax-Span-2808\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-176\">\\beta</script> is a temperature-like constant.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Some practical analyses (e.g., <a href=\"https://arxiv.org/abs/2404.10719\">Is DPO Superior to PPO for LLM Alignment?</a>) compare PPO vs. DPO in alignment tasks.</p>\n  </li>\n</ul>\n<p>For web/computer-use agents built on LLMs or similar, one key method is RL from Human Feedback (RLHF). The standard RLHF pipeline is:</p>\n<ol>\n      <li>Supervised fine-tune a base language model on prompt–response pairs.</li>\n      <li>Collect human preference data: for each prompt, have humans rank multiple model responses (or choose preferred vs. non-preferred).</li>\n      <li>Train a reward model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-170-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2666\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2667\"><span class=\"msubsup\" id=\"MathJax-Span-2668\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2669\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2670\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2671\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2672\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2673\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2674\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-2675\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-170\">r_\\phi(x,y)</script> to predict human preferences.</li>\n      <li>Use an RL algorithm (often PPO) to optimize the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-171-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2676\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2677\"><span class=\"msubsup\" id=\"MathJax-Span-2678\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2679\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2680\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-171\">\\pi_\\theta</script> to maximise expected reward under the reward model, possibly adding KL-penalty to stay close to base model.</li>\n    </ol>\n<p>For example, the survey article <a href=\"https://arxiv.org/abs/2412.10400v1\">Reinforcement Learning Enhanced LLMs: A Survey</a> provides an overview of this field.</p>\n<p>However, RLHF can be unstable, costly in compute, and sensitive to reward-model errors. Enter Direct Preference Optimization (DPO) <a href=\"https://arxiv.org/abs/2305.18290\">Rafailov et al. (2023)</a>, which posits that one can skip the explicit reward model + RL loop and simply fine-tune the model directly to optimize human preference pairwise comparisons.</p>\n<p>The DPO loss in the pairwise case (winner <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-172-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>w</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2681\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.99em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2682\"><span class=\"msubsup\" id=\"MathJax-Span-2683\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2684\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2685\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>w</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-172\">y_w</script>, loser <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-173-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>l</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2686\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2687\"><span class=\"msubsup\" id=\"MathJax-Span-2688\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2689\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2690\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>l</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-173\">y_l</script>) is approximately:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-175-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2797\" style=\"width: 1.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.41em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2798\"><span class=\"msubsup\" id=\"MathJax-Span-2799\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2800\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2801\"><span class=\"mrow\" id=\"MathJax-Span-2802\"><span class=\"mi\" id=\"MathJax-Span-2803\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2804\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-2805\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-175\">\\pi_{\\rm ref}</script> is the reference model (often the supervised fine-tuned model), and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-176-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2806\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2807\"><span class=\"mi\" id=\"MathJax-Span-2808\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-176\">\\beta</script> is a temperature-like constant.</li>\n    </ul>\n<p>Some practical analyses (e.g., <a href=\"https://arxiv.org/abs/2404.10719\">Is DPO Superior to PPO for LLM Alignment?</a>) compare PPO vs. DPO in alignment tasks.</p>",
    "contentMarkdown": "*   For web/computer-use agents built on LLMs or similar, one key method is RL from Human Feedback (RLHF). The standard RLHF pipeline is:\n    \n    1.  Supervised fine-tune a base language model on prompt–response pairs.\n    2.  Collect human preference data: for each prompt, have humans rank multiple model responses (or choose preferred vs. non-preferred).\n    3.  Train a reward model rϕ(x,y)rϕ(x,y)r\\_\\\\phi(x,y) to predict human preferences.\n    4.  Use an RL algorithm (often PPO) to optimize the policy πθπθ\\\\pi\\_\\\\theta to maximise expected reward under the reward model, possibly adding KL-penalty to stay close to base model.\n*   For example, the survey article [Reinforcement Learning Enhanced LLMs: A Survey](https://arxiv.org/abs/2412.10400v1) provides an overview of this field.\n    \n*   However, RLHF can be unstable, costly in compute, and sensitive to reward-model errors. Enter Direct Preference Optimization (DPO) [Rafailov et al. (2023)](https://arxiv.org/abs/2305.18290), which posits that one can skip the explicit reward model + RL loop and simply fine-tune the model directly to optimize human preference pairwise comparisons.\n    \n*   The DPO loss in the pairwise case (winner ywywy\\_w, loser ylyly\\_l) is approximately:\n    \n    LDPO\\=−𝔼(x,yw,yl)\\[lnσ(βlnπθ(yw|x)πref(yw|x)−βlnπθ(yl|x)πref(yl∣x))\\]LDPO\\=−E(x,yw,yl)\\[ln⁡σ(βln⁡πθ(yw|x)πref(yw|x)−βln⁡πθ(yl|x)πref(yl∣x))\\]\n    \n    L\\_{\\\\rm DPO} = -\\\\mathbb{E}\\_{(x,y\\_w,y\\_l)}\\\\left\\[ \\\\ln \\\\sigma\\\\left(\\\\beta \\\\ln\\\\frac{\\\\pi\\_\\\\theta(y\\_w|x)}{\\\\pi\\_{\\\\rm ref}(y\\_w|x)} - \\\\beta \\\\ln\\\\frac{\\\\pi\\_\\\\theta(y\\_l|x)}{\\\\pi\\_{\\\\rm ref}(y\\_l \\\\mid x)}\\\\right) \\\\right\\]\n    *   where πrefπref\\\\pi\\_{\\\\rm ref} is the reference model (often the supervised fine-tuned model), and ββ\\\\beta is a temperature-like constant.\n*   Some practical analyses (e.g., [Is DPO Superior to PPO for LLM Alignment?](https://arxiv.org/abs/2404.10719)) compare PPO vs. DPO in alignment tasks.\n    \n\nFor web/computer-use agents built on LLMs or similar, one key method is RL from Human Feedback (RLHF). The standard RLHF pipeline is:\n\n1.  Supervised fine-tune a base language model on prompt–response pairs.\n2.  Collect human preference data: for each prompt, have humans rank multiple model responses (or choose preferred vs. non-preferred).\n3.  Train a reward model rϕ(x,y)rϕ(x,y)r\\_\\\\phi(x,y) to predict human preferences.\n4.  Use an RL algorithm (often PPO) to optimize the policy πθπθ\\\\pi\\_\\\\theta to maximise expected reward under the reward model, possibly adding KL-penalty to stay close to base model.\n\nFor example, the survey article [Reinforcement Learning Enhanced LLMs: A Survey](https://arxiv.org/abs/2412.10400v1) provides an overview of this field.\n\nHowever, RLHF can be unstable, costly in compute, and sensitive to reward-model errors. Enter Direct Preference Optimization (DPO) [Rafailov et al. (2023)](https://arxiv.org/abs/2305.18290), which posits that one can skip the explicit reward model + RL loop and simply fine-tune the model directly to optimize human preference pairwise comparisons.\n\nThe DPO loss in the pairwise case (winner ywywy\\_w, loser ylyly\\_l) is approximately:\n\n*   where πrefπref\\\\pi\\_{\\\\rm ref} is the reference model (often the supervised fine-tuned model), and ββ\\\\beta is a temperature-like constant.\n\nSome practical analyses (e.g., [Is DPO Superior to PPO for LLM Alignment?](https://arxiv.org/abs/2404.10719)) compare PPO vs. DPO in alignment tasks.",
    "order": 17,
    "orderInChapter": 3,
    "difficulty": 4,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "reinforcement learning",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 431,
      "contentLength": 51078
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#reinforcement-learning-from-human-feedback-(rlhf)-and-direct-preference-optimization-(dpo)",
    "scrapedAt": "2025-12-28T11:47:36.152Z"
  },
  {
    "id": "ai-agentic-RL-why-policy-optimization-for-web-and-computer-use-a-18",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Reinforcement Learning for Web and Computer-Use Agents",
    "title": "Why Policy Optimization for Web and Computer-Use Agents",
    "subtitle": "Reinforcement Learning for Web and Computer-Use Agents",
    "contentHtml": "<ul>\n  <li>\n    <p>When training agents that interact with the web or software systems (for example, clicking links, filling forms, issuing API calls), several factors make the choice of algorithm especially important:</p>\n\n    <ul>\n      <li>Action spaces are large and heterogeneous (e.g., browser UI actions, tool function calls).</li>\n      <li>The reward signals may be sparse (e.g., task success only after many steps) or come from human annotation (in RLHF).</li>\n      <li>Policies must remain stable and avoid drift (especially when built on pretrained LLMs).</li>\n      <li>Computation cost is high (LLM inference, environment simulation), so sample efficiency matters.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Thus:</p>\n\n    <ul>\n      <li>Algorithms like PPO are well-suited because of their stability and simplicity (compared to e.g. TRPO) in high-dimensional policy spaces.</li>\n      <li>RLHF/DPO are relevant because many web-agents and computer-agents are aligned to human goals (helpfulness, correctness, safety) rather than just raw reward.</li>\n      <li>There is an increasing trend toward hybrid methods that combine search, planning (e.g., MCTS) plus RL fine-tuning for complex workflows.</li>\n    </ul>\n  </li>\n</ul>\n<p>When training agents that interact with the web or software systems (for example, clicking links, filling forms, issuing API calls), several factors make the choice of algorithm especially important:</p>\n<ul>\n      <li>Action spaces are large and heterogeneous (e.g., browser UI actions, tool function calls).</li>\n      <li>The reward signals may be sparse (e.g., task success only after many steps) or come from human annotation (in RLHF).</li>\n      <li>Policies must remain stable and avoid drift (especially when built on pretrained LLMs).</li>\n      <li>Computation cost is high (LLM inference, environment simulation), so sample efficiency matters.</li>\n    </ul>\n<p>Thus:</p>\n<ul>\n      <li>Algorithms like PPO are well-suited because of their stability and simplicity (compared to e.g. TRPO) in high-dimensional policy spaces.</li>\n      <li>RLHF/DPO are relevant because many web-agents and computer-agents are aligned to human goals (helpfulness, correctness, safety) rather than just raw reward.</li>\n      <li>There is an increasing trend toward hybrid methods that combine search, planning (e.g., MCTS) plus RL fine-tuning for complex workflows.</li>\n    </ul>",
    "contentMarkdown": "*   When training agents that interact with the web or software systems (for example, clicking links, filling forms, issuing API calls), several factors make the choice of algorithm especially important:\n    \n    *   Action spaces are large and heterogeneous (e.g., browser UI actions, tool function calls).\n    *   The reward signals may be sparse (e.g., task success only after many steps) or come from human annotation (in RLHF).\n    *   Policies must remain stable and avoid drift (especially when built on pretrained LLMs).\n    *   Computation cost is high (LLM inference, environment simulation), so sample efficiency matters.\n*   Thus:\n    \n    *   Algorithms like PPO are well-suited because of their stability and simplicity (compared to e.g. TRPO) in high-dimensional policy spaces.\n    *   RLHF/DPO are relevant because many web-agents and computer-agents are aligned to human goals (helpfulness, correctness, safety) rather than just raw reward.\n    *   There is an increasing trend toward hybrid methods that combine search, planning (e.g., MCTS) plus RL fine-tuning for complex workflows.\n\nWhen training agents that interact with the web or software systems (for example, clicking links, filling forms, issuing API calls), several factors make the choice of algorithm especially important:\n\n*   Action spaces are large and heterogeneous (e.g., browser UI actions, tool function calls).\n*   The reward signals may be sparse (e.g., task success only after many steps) or come from human annotation (in RLHF).\n*   Policies must remain stable and avoid drift (especially when built on pretrained LLMs).\n*   Computation cost is high (LLM inference, environment simulation), so sample efficiency matters.\n\nThus:\n\n*   Algorithms like PPO are well-suited because of their stability and simplicity (compared to e.g. TRPO) in high-dimensional policy spaces.\n*   RLHF/DPO are relevant because many web-agents and computer-agents are aligned to human goals (helpfulness, correctness, safety) rather than just raw reward.\n*   There is an increasing trend toward hybrid methods that combine search, planning (e.g., MCTS) plus RL fine-tuning for complex workflows.",
    "order": 18,
    "orderInChapter": 4,
    "difficulty": 3,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 312,
      "contentLength": 2414
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#why-policy-optimization-for-web-and-computer-use-agents",
    "scrapedAt": "2025-12-28T11:47:36.152Z"
  },
  {
    "id": "ai-agentic-RL-key-equations-19",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Reinforcement Learning for Web and Computer-Use Agents",
    "title": "Key Equations",
    "subtitle": "Reinforcement Learning for Web and Computer-Use Agents",
    "contentHtml": "<h4 id=\"advantage-estimation--value-networks\">Advantage Estimation &amp; Value Networks</h4>\n<ul>\n  <li>\n    <p>In actor–critic variants (including PPO), we often learn a value function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-177-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2809\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.14em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2810\"><span class=\"msubsup\" id=\"MathJax-Span-2811\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2812\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2813\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2814\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2815\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2816\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-177\">V_\\psi(s)</script> to reduce variance:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-178-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mspace width=&quot;1em&quot; /><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>k</mi></msup><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2817\" style=\"width: 16.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.648em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.419em, 1013.65em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2818\"><span class=\"msubsup\" id=\"MathJax-Span-2819\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2820\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2821\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2822\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2823\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2824\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2825\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2826\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-2827\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2828\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2829\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2830\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2831\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2832\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2833\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2834\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mspace\" id=\"MathJax-Span-2835\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-2836\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2837\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2838\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2839\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-2840\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2841\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.15em, 4.273em, -999.997em); top: -2.862em; left: 0.055em;\"><span class=\"texatom\" id=\"MathJax-Span-2842\"><span class=\"mrow\" id=\"MathJax-Span-2843\"><span class=\"mi\" id=\"MathJax-Span-2844\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2845\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-2846\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-2847\"><span class=\"mrow\" id=\"MathJax-Span-2848\"><span class=\"mi\" id=\"MathJax-Span-2849\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∞</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2850\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2851\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2852\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2853\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2854\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2855\"><span class=\"mrow\" id=\"MathJax-Span-2856\"><span class=\"mi\" id=\"MathJax-Span-2857\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2858\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-2859\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><mo>−</mo><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mspace width=\"1em\"></mspace><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">∞</mi></mrow></munderover><msup><mi>γ</mi><mi>k</mi></msup><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-178\">A_t = R_t - V_\\psi(s_t) \\quad R_t = \\sum_{k=0}^{\\infty} \\gamma^k r_{t+k}</script>\n\n    <ul>\n      <li>\n        <p><strong>where:</strong></p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-179-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2860\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2861\"><span class=\"msubsup\" id=\"MathJax-Span-2862\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2863\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2864\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-179\">A_t</script>: the <strong>advantage estimate</strong> at timestep <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-180-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2865\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2866\"><span class=\"mi\" id=\"MathJax-Span-2867\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-180\">t</script>, measuring how much better an action performed compared to the policy’s expected performance.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-181-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2868\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2869\"><span class=\"msubsup\" id=\"MathJax-Span-2870\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2871\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2872\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-181\">R_t</script>: the <strong>discounted return</strong>, or the total expected future reward from time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-182-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2873\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2874\"><span class=\"mi\" id=\"MathJax-Span-2875\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-182\">t</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-183-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2876\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2877\"><span class=\"mi\" id=\"MathJax-Span-2878\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>γ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-183\">\\gamma</script>: the <strong>discount factor</strong> (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-184-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn><mo>&amp;lt;</mo><mi>&amp;#x03B3;</mi><mo>&amp;#x2264;</mo><mn>1</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2879\" style=\"width: 4.69em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.909em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.8em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2880\"><span class=\"mn\" id=\"MathJax-Span-2881\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-2882\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-2883\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2884\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-2885\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>0</mn><mo>&lt;</mo><mi>γ</mi><mo>≤</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-184\">0 < \\gamma \\le 1</script>), controlling how much future rewards are valued compared to immediate ones.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-185-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2886\" style=\"width: 1.773em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.46em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2887\"><span class=\"msubsup\" id=\"MathJax-Span-2888\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2889\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2890\"><span class=\"mrow\" id=\"MathJax-Span-2891\"><span class=\"mi\" id=\"MathJax-Span-2892\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2893\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-2894\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-185\">r_{t+k}</script>: the <strong>immediate reward</strong> received at step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-186-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mo>+</mo><mi>k</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2895\" style=\"width: 2.294em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.88em, 2.398em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2896\"><span class=\"mi\" id=\"MathJax-Span-2897\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2898\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2899\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi><mo>+</mo><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-186\">t+k</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-187-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2900\" style=\"width: 3.023em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.503em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.45em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2901\"><span class=\"msubsup\" id=\"MathJax-Span-2902\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2903\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2904\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2905\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2906\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2907\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2908\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2909\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-187\">V_\\psi(s_t)</script>: the <strong>critic’s value estimate</strong> for state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-188-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2910\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2911\"><span class=\"msubsup\" id=\"MathJax-Span-2912\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2913\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2914\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-188\">s_t</script>, parameterized by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-189-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2915\" style=\"width: 1.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.84em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2916\"><span class=\"mi\" id=\"MathJax-Span-2917\" style=\"font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.107em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>ψ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-189\">\\psi</script>, representing the expected return from that state under the current policy.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>The update for the critic aims to minimize:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-190-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>v</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>e</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mi>t</mi></msub><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>R</mi><mi>t</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2918\" style=\"width: 16.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1013.13em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2919\"><span class=\"msubsup\" id=\"MathJax-Span-2920\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2921\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-2922\"><span class=\"mrow\" id=\"MathJax-Span-2923\"><span class=\"mi\" id=\"MathJax-Span-2924\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">v</span><span class=\"mi\" id=\"MathJax-Span-2925\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">a</span><span class=\"mi\" id=\"MathJax-Span-2926\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-2927\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">u</span><span class=\"mi\" id=\"MathJax-Span-2928\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2929\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2930\" style=\"font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.107em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2931\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2932\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2933\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2934\"><span class=\"mrow\" id=\"MathJax-Span-2935\"><span class=\"mi\" id=\"MathJax-Span-2936\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2937\"><span class=\"mrow\" id=\"MathJax-Span-2938\"><span class=\"msubsup\" id=\"MathJax-Span-2939\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2940\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2941\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2942\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"mi\" id=\"MathJax-Span-2943\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2944\"><span class=\"mrow\" id=\"MathJax-Span-2945\"><span class=\"mo\" id=\"MathJax-Span-2946\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2947\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2948\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2949\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2950\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2951\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2952\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2953\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2954\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2955\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2956\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-2957\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2958\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2959\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2960\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2961\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.315em;\"><span class=\"mn\" id=\"MathJax-Span-2962\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2963\"><span class=\"mrow\" id=\"MathJax-Span-2964\"><span class=\"mo\" id=\"MathJax-Span-2965\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">v</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">u</mi><mi mathvariant=\"normal\">e</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>ψ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>s</mi><mi>t</mi></msub><mo>∼</mo><mi>π</mi></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mo stretchy=\"false\">(</mo><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>R</mi><mi>t</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-190\">L_{\\rm value}(\\psi) = \\mathbb{E}_{s_t\\sim\\pi}\\big[(V_\\psi(s_t) - R_t)^2 \\big]</script>\n\n    <ul>\n      <li>\n        <p><strong>where:</strong></p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-191-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>v</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>e</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2966\" style=\"width: 4.482em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.701em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.65em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2967\"><span class=\"msubsup\" id=\"MathJax-Span-2968\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2969\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-2970\"><span class=\"mrow\" id=\"MathJax-Span-2971\"><span class=\"mi\" id=\"MathJax-Span-2972\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">v</span><span class=\"mi\" id=\"MathJax-Span-2973\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">a</span><span class=\"mi\" id=\"MathJax-Span-2974\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-2975\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">u</span><span class=\"mi\" id=\"MathJax-Span-2976\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2977\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2978\" style=\"font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.107em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2979\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">v</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">u</mi><mi mathvariant=\"normal\">e</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>ψ</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-191\">L_{\\rm value}(\\psi)</script>: the <strong>value loss</strong>, quantifying how far the critic’s predictions are from the actual returns.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-192-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mi>t</mi></msub><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2980\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.02em, 2.659em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2981\"><span class=\"msubsup\" id=\"MathJax-Span-2982\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2983\"><span class=\"mrow\" id=\"MathJax-Span-2984\"><span class=\"mi\" id=\"MathJax-Span-2985\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2986\"><span class=\"mrow\" id=\"MathJax-Span-2987\"><span class=\"msubsup\" id=\"MathJax-Span-2988\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2989\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2990\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2991\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"mi\" id=\"MathJax-Span-2992\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2993\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mo\" id=\"MathJax-Span-2994\" style=\"font-family: STIXGeneral-Regular;\">⋅</span><span class=\"mo\" id=\"MathJax-Span-2995\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>s</mi><mi>t</mi></msub><mo>∼</mo><mi>π</mi></mrow></msub><mo stretchy=\"false\">[</mo><mo>⋅</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-192\">\\mathbb{E}_{s_t\\sim\\pi}[\\cdot]</script>: the <strong>expectation</strong> over states <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-193-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2996\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2997\"><span class=\"msubsup\" id=\"MathJax-Span-2998\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2999\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3000\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-193\">s_t</script> sampled from the current policy (\\pi).</li>\n          <li>The squared term <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-194-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>R</mi><mi>t</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3001\" style=\"width: 6.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1005.58em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3002\"><span class=\"mo\" id=\"MathJax-Span-3003\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3004\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3005\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3006\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3007\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3008\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3009\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3010\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3011\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3012\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-3013\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3014\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3015\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3016\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3017\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.315em;\"><span class=\"mn\" id=\"MathJax-Span-3018\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>R</mi><mi>t</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-194\">(V_\\psi(s_t) - R_t)^2</script>: penalizes inaccurate value predictions, guiding the critic to estimate returns more accurately.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n</ul>\n<p>In actor–critic variants (including PPO), we often learn a value function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-177-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2809\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.14em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2810\"><span class=\"msubsup\" id=\"MathJax-Span-2811\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2812\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2813\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2814\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2815\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2816\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-177\">V_\\psi(s)</script> to reduce variance:</p>\n<ul>\n      <li>\n        <p><strong>where:</strong></p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-179-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2860\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2861\"><span class=\"msubsup\" id=\"MathJax-Span-2862\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2863\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2864\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-179\">A_t</script>: the <strong>advantage estimate</strong> at timestep <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-180-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2865\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2866\"><span class=\"mi\" id=\"MathJax-Span-2867\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-180\">t</script>, measuring how much better an action performed compared to the policy’s expected performance.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-181-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2868\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2869\"><span class=\"msubsup\" id=\"MathJax-Span-2870\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2871\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2872\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-181\">R_t</script>: the <strong>discounted return</strong>, or the total expected future reward from time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-182-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2873\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2874\"><span class=\"mi\" id=\"MathJax-Span-2875\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-182\">t</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-183-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2876\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2877\"><span class=\"mi\" id=\"MathJax-Span-2878\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>γ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-183\">\\gamma</script>: the <strong>discount factor</strong> (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-184-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn><mo>&amp;lt;</mo><mi>&amp;#x03B3;</mi><mo>&amp;#x2264;</mo><mn>1</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2879\" style=\"width: 4.69em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.909em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.8em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2880\"><span class=\"mn\" id=\"MathJax-Span-2881\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-2882\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-2883\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2884\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-2885\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>0</mn><mo>&lt;</mo><mi>γ</mi><mo>≤</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-184\">0 < \\gamma \\le 1</script>), controlling how much future rewards are valued compared to immediate ones.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-185-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2886\" style=\"width: 1.773em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.46em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2887\"><span class=\"msubsup\" id=\"MathJax-Span-2888\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2889\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2890\"><span class=\"mrow\" id=\"MathJax-Span-2891\"><span class=\"mi\" id=\"MathJax-Span-2892\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2893\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-2894\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-185\">r_{t+k}</script>: the <strong>immediate reward</strong> received at step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-186-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mo>+</mo><mi>k</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2895\" style=\"width: 2.294em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.88em, 2.398em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2896\"><span class=\"mi\" id=\"MathJax-Span-2897\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2898\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2899\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi><mo>+</mo><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-186\">t+k</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-187-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2900\" style=\"width: 3.023em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.503em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.45em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2901\"><span class=\"msubsup\" id=\"MathJax-Span-2902\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2903\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2904\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2905\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2906\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2907\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2908\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2909\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-187\">V_\\psi(s_t)</script>: the <strong>critic’s value estimate</strong> for state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-188-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2910\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2911\"><span class=\"msubsup\" id=\"MathJax-Span-2912\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2913\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2914\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-188\">s_t</script>, parameterized by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-189-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2915\" style=\"width: 1.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.84em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2916\"><span class=\"mi\" id=\"MathJax-Span-2917\" style=\"font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.107em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>ψ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-189\">\\psi</script>, representing the expected return from that state under the current policy.</li>\n        </ul>\n      </li>\n    </ul>\n<p><strong>where:</strong></p>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-179-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2860\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2861\"><span class=\"msubsup\" id=\"MathJax-Span-2862\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2863\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2864\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-179\">A_t</script>: the <strong>advantage estimate</strong> at timestep <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-180-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2865\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2866\"><span class=\"mi\" id=\"MathJax-Span-2867\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-180\">t</script>, measuring how much better an action performed compared to the policy’s expected performance.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-181-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2868\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2869\"><span class=\"msubsup\" id=\"MathJax-Span-2870\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2871\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2872\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-181\">R_t</script>: the <strong>discounted return</strong>, or the total expected future reward from time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-182-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2873\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2874\"><span class=\"mi\" id=\"MathJax-Span-2875\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-182\">t</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-183-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2876\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2877\"><span class=\"mi\" id=\"MathJax-Span-2878\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>γ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-183\">\\gamma</script>: the <strong>discount factor</strong> (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-184-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn><mo>&amp;lt;</mo><mi>&amp;#x03B3;</mi><mo>&amp;#x2264;</mo><mn>1</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2879\" style=\"width: 4.69em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.909em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.8em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2880\"><span class=\"mn\" id=\"MathJax-Span-2881\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-2882\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-2883\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2884\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-2885\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>0</mn><mo>&lt;</mo><mi>γ</mi><mo>≤</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-184\">0 < \\gamma \\le 1</script>), controlling how much future rewards are valued compared to immediate ones.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-185-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2886\" style=\"width: 1.773em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.46em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2887\"><span class=\"msubsup\" id=\"MathJax-Span-2888\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2889\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2890\"><span class=\"mrow\" id=\"MathJax-Span-2891\"><span class=\"mi\" id=\"MathJax-Span-2892\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2893\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-2894\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-185\">r_{t+k}</script>: the <strong>immediate reward</strong> received at step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-186-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mo>+</mo><mi>k</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2895\" style=\"width: 2.294em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.88em, 2.398em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2896\"><span class=\"mi\" id=\"MathJax-Span-2897\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2898\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2899\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi><mo>+</mo><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-186\">t+k</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-187-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2900\" style=\"width: 3.023em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.503em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.45em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2901\"><span class=\"msubsup\" id=\"MathJax-Span-2902\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2903\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2904\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2905\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2906\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2907\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2908\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2909\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-187\">V_\\psi(s_t)</script>: the <strong>critic’s value estimate</strong> for state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-188-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2910\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2911\"><span class=\"msubsup\" id=\"MathJax-Span-2912\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2913\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2914\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-188\">s_t</script>, parameterized by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-189-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2915\" style=\"width: 1.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.84em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2916\"><span class=\"mi\" id=\"MathJax-Span-2917\" style=\"font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.107em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>ψ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-189\">\\psi</script>, representing the expected return from that state under the current policy.</li>\n        </ul>\n<p>The update for the critic aims to minimize:</p>\n<ul>\n      <li>\n        <p><strong>where:</strong></p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-191-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>v</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>e</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2966\" style=\"width: 4.482em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.701em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.65em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2967\"><span class=\"msubsup\" id=\"MathJax-Span-2968\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2969\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-2970\"><span class=\"mrow\" id=\"MathJax-Span-2971\"><span class=\"mi\" id=\"MathJax-Span-2972\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">v</span><span class=\"mi\" id=\"MathJax-Span-2973\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">a</span><span class=\"mi\" id=\"MathJax-Span-2974\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-2975\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">u</span><span class=\"mi\" id=\"MathJax-Span-2976\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2977\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2978\" style=\"font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.107em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2979\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">v</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">u</mi><mi mathvariant=\"normal\">e</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>ψ</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-191\">L_{\\rm value}(\\psi)</script>: the <strong>value loss</strong>, quantifying how far the critic’s predictions are from the actual returns.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-192-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mi>t</mi></msub><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2980\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.02em, 2.659em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2981\"><span class=\"msubsup\" id=\"MathJax-Span-2982\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2983\"><span class=\"mrow\" id=\"MathJax-Span-2984\"><span class=\"mi\" id=\"MathJax-Span-2985\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2986\"><span class=\"mrow\" id=\"MathJax-Span-2987\"><span class=\"msubsup\" id=\"MathJax-Span-2988\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2989\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2990\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2991\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"mi\" id=\"MathJax-Span-2992\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2993\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mo\" id=\"MathJax-Span-2994\" style=\"font-family: STIXGeneral-Regular;\">⋅</span><span class=\"mo\" id=\"MathJax-Span-2995\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>s</mi><mi>t</mi></msub><mo>∼</mo><mi>π</mi></mrow></msub><mo stretchy=\"false\">[</mo><mo>⋅</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-192\">\\mathbb{E}_{s_t\\sim\\pi}[\\cdot]</script>: the <strong>expectation</strong> over states <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-193-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2996\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2997\"><span class=\"msubsup\" id=\"MathJax-Span-2998\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2999\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3000\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-193\">s_t</script> sampled from the current policy (\\pi).</li>\n          <li>The squared term <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-194-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>R</mi><mi>t</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3001\" style=\"width: 6.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1005.58em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3002\"><span class=\"mo\" id=\"MathJax-Span-3003\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3004\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3005\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3006\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3007\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3008\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3009\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3010\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3011\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3012\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-3013\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3014\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3015\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3016\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3017\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.315em;\"><span class=\"mn\" id=\"MathJax-Span-3018\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>R</mi><mi>t</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-194\">(V_\\psi(s_t) - R_t)^2</script>: penalizes inaccurate value predictions, guiding the critic to estimate returns more accurately.</li>\n        </ul>\n      </li>\n    </ul>\n<p><strong>where:</strong></p>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-191-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>v</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>e</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2966\" style=\"width: 4.482em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.701em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.65em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2967\"><span class=\"msubsup\" id=\"MathJax-Span-2968\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2969\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-2970\"><span class=\"mrow\" id=\"MathJax-Span-2971\"><span class=\"mi\" id=\"MathJax-Span-2972\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">v</span><span class=\"mi\" id=\"MathJax-Span-2973\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">a</span><span class=\"mi\" id=\"MathJax-Span-2974\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-2975\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">u</span><span class=\"mi\" id=\"MathJax-Span-2976\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2977\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2978\" style=\"font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.107em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2979\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">v</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">u</mi><mi mathvariant=\"normal\">e</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>ψ</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-191\">L_{\\rm value}(\\psi)</script>: the <strong>value loss</strong>, quantifying how far the critic’s predictions are from the actual returns.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-192-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mi>t</mi></msub><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2980\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.02em, 2.659em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2981\"><span class=\"msubsup\" id=\"MathJax-Span-2982\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2983\"><span class=\"mrow\" id=\"MathJax-Span-2984\"><span class=\"mi\" id=\"MathJax-Span-2985\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2986\"><span class=\"mrow\" id=\"MathJax-Span-2987\"><span class=\"msubsup\" id=\"MathJax-Span-2988\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2989\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2990\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2991\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"mi\" id=\"MathJax-Span-2992\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2993\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mo\" id=\"MathJax-Span-2994\" style=\"font-family: STIXGeneral-Regular;\">⋅</span><span class=\"mo\" id=\"MathJax-Span-2995\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>s</mi><mi>t</mi></msub><mo>∼</mo><mi>π</mi></mrow></msub><mo stretchy=\"false\">[</mo><mo>⋅</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-192\">\\mathbb{E}_{s_t\\sim\\pi}[\\cdot]</script>: the <strong>expectation</strong> over states <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-193-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2996\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2997\"><span class=\"msubsup\" id=\"MathJax-Span-2998\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2999\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3000\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-193\">s_t</script> sampled from the current policy (\\pi).</li>\n          <li>The squared term <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-194-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>R</mi><mi>t</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3001\" style=\"width: 6.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1005.58em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3002\"><span class=\"mo\" id=\"MathJax-Span-3003\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3004\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3005\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3006\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3007\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3008\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3009\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3010\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3011\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3012\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-3013\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3014\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3015\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3016\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3017\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.315em;\"><span class=\"mn\" id=\"MathJax-Span-3018\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mi>V</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>R</mi><mi>t</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-194\">(V_\\psi(s_t) - R_t)^2</script>: penalizes inaccurate value predictions, guiding the critic to estimate returns more accurately.</li>\n        </ul>\n<h4 id=\"kl-penalty--trust-region\">KL-penalty / Trust Region</h4>\n<ul>\n  <li>\n    <p>Some RLHF implementations add a penalty to keep the new policy close to the supervised model:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-195-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>&amp;#x03B2;</mi><mo>&amp;#x22C5;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>,</mo><mi>y</mi><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi></mrow></msub><mrow><mo>[</mo><mrow><mi>log</mi><mo>&amp;#x2061;</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>S</mi><mi mathvariant=&quot;normal&quot;>F</mi><mi mathvariant=&quot;normal&quot;>T</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3019\" style=\"width: 17.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.586em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.294em, 1014.38em, 4.846em, -999.997em); top: -3.799em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3020\"><span class=\"msubsup\" id=\"MathJax-Span-3021\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3022\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3023\"><span class=\"mrow\" id=\"MathJax-Span-3024\"><span class=\"mi\" id=\"MathJax-Span-3025\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3026\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3027\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3028\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3029\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3030\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3031\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3032\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">⋅</span><span class=\"msubsup\" id=\"MathJax-Span-3033\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3034\"><span class=\"mrow\" id=\"MathJax-Span-3035\"><span class=\"mi\" id=\"MathJax-Span-3036\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3037\"><span class=\"mrow\" id=\"MathJax-Span-3038\"><span class=\"mi\" id=\"MathJax-Span-3039\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3040\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3041\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-3042\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"mi\" id=\"MathJax-Span-3043\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-3044\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-3045\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">[</span></span></span><span class=\"mrow\" id=\"MathJax-Span-3046\"><span class=\"mi\" id=\"MathJax-Span-3047\" style=\"font-family: STIXGeneral-Regular;\">log</span><span class=\"mo\" id=\"MathJax-Span-3048\"></span><span class=\"mfrac\" id=\"MathJax-Span-3049\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1002.76em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.404em;\"><span class=\"mrow\" id=\"MathJax-Span-3050\"><span class=\"msubsup\" id=\"MathJax-Span-3051\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3052\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3053\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3054\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3055\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"texatom\" id=\"MathJax-Span-3056\"><span class=\"mrow\" id=\"MathJax-Span-3057\"><span class=\"mo\" id=\"MathJax-Span-3058\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-3059\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3060\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.65em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -1.82em;\"><span class=\"mrow\" id=\"MathJax-Span-3061\"><span class=\"msubsup\" id=\"MathJax-Span-3062\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3063\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3064\"><span class=\"mrow\" id=\"MathJax-Span-3065\"><span class=\"mi\" id=\"MathJax-Span-3066\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">S</span><span class=\"mi\" id=\"MathJax-Span-3067\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">F</span><span class=\"mi\" id=\"MathJax-Span-3068\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">T</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3069\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3070\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"texatom\" id=\"MathJax-Span-3071\"><span class=\"mrow\" id=\"MathJax-Span-3072\"><span class=\"mo\" id=\"MathJax-Span-3073\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-3074\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3075\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.8em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.805em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3076\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">]</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.805em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>β</mi><mo>⋅</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>,</mo><mi>y</mi><mo>∼</mo><mi>π</mi></mrow></msub><mrow><mo>[</mo><mrow><mi>log</mi><mo>⁡</mo><mfrac><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">S</mi><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">T</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-195\">L_{\\rm KL}(\\theta) = \\beta \\cdot \\mathbb{E}_{x,y\\sim\\pi}\\left[ \\log\\frac{\\pi_\\theta(y|x)}{\\pi_{\\rm SFT}(y|x)} \\right]</script>\n\n    <ul>\n      <li>\n        <p><strong>where:</strong></p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-196-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3077\" style=\"width: 3.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.815em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.76em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3078\"><span class=\"msubsup\" id=\"MathJax-Span-3079\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3080\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3081\"><span class=\"mrow\" id=\"MathJax-Span-3082\"><span class=\"mi\" id=\"MathJax-Span-3083\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3084\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3085\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3086\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3087\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-196\">L_{\\rm KL}(\\theta)</script>: the <strong>KL-divergence loss</strong>, which penalizes the new policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-197-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3088\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3089\"><span class=\"msubsup\" id=\"MathJax-Span-3090\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3091\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3092\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-197\">\\pi_\\theta</script> if it deviates too far from the supervised fine-tuned (SFT) reference policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-198-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>S</mi><mi mathvariant=&quot;normal&quot;>F</mi><mi mathvariant=&quot;normal&quot;>T</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3093\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.83em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3094\"><span class=\"msubsup\" id=\"MathJax-Span-3095\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3096\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3097\"><span class=\"mrow\" id=\"MathJax-Span-3098\"><span class=\"mi\" id=\"MathJax-Span-3099\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">S</span><span class=\"mi\" id=\"MathJax-Span-3100\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">F</span><span class=\"mi\" id=\"MathJax-Span-3101\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">T</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">S</mi><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">T</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-198\">\\pi_{\\rm SFT}</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-199-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3102\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3103\"><span class=\"mi\" id=\"MathJax-Span-3104\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-199\">\\beta</script>: a <strong>scaling coefficient</strong> controlling the strength of this regularization; larger <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-200-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3105\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3106\"><span class=\"mi\" id=\"MathJax-Span-3107\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-200\">\\beta</script> enforces tighter adherence to the reference model.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-201-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>,</mo><mi>y</mi><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3108\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.44em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.34em, 2.711em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3109\"><span class=\"msubsup\" id=\"MathJax-Span-3110\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3111\"><span class=\"mrow\" id=\"MathJax-Span-3112\"><span class=\"mi\" id=\"MathJax-Span-3113\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3114\"><span class=\"mrow\" id=\"MathJax-Span-3115\"><span class=\"mi\" id=\"MathJax-Span-3116\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3117\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3118\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-3119\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"mi\" id=\"MathJax-Span-3120\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3121\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mo\" id=\"MathJax-Span-3122\" style=\"font-family: STIXGeneral-Regular;\">⋅</span><span class=\"mo\" id=\"MathJax-Span-3123\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>,</mo><mi>y</mi><mo>∼</mo><mi>π</mi></mrow></msub><mo stretchy=\"false\">[</mo><mo>⋅</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-201\">\\mathbb{E}_{x,y\\sim\\pi}[\\cdot]</script>: the <strong>expectation</strong> over sampled input–output pairs from the current policy’s distribution.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-202-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3124\" style=\"width: 4.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.492em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.44em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3125\"><span class=\"msubsup\" id=\"MathJax-Span-3126\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3127\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3128\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3129\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3130\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-3131\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-3132\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3133\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>∣</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-202\">\\pi_\\theta(y \\mid x)</script>: the <strong>current policy’s probability</strong> of generating output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-203-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3134\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3135\"><span class=\"mi\" id=\"MathJax-Span-3136\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-203\">y</script> given input <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-204-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3137\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3138\"><span class=\"mi\" id=\"MathJax-Span-3139\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-204\">x</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-205-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>S</mi><mi mathvariant=&quot;normal&quot;>F</mi><mi mathvariant=&quot;normal&quot;>T</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3140\" style=\"width: 5.263em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.378em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1004.33em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3141\"><span class=\"msubsup\" id=\"MathJax-Span-3142\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3143\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3144\"><span class=\"mrow\" id=\"MathJax-Span-3145\"><span class=\"mi\" id=\"MathJax-Span-3146\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">S</span><span class=\"mi\" id=\"MathJax-Span-3147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">F</span><span class=\"mi\" id=\"MathJax-Span-3148\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">T</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3149\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3150\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-3151\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-3152\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3153\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">S</mi><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">T</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>∣</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-205\">\\pi_{\\rm SFT}(y \\mid x)</script>: the <strong>reference policy’s probability</strong>, often from the supervised model used before RL fine-tuning.</li>\n        </ul>\n      </li>\n      <li>\n        <p>… so the total objective may combine PPO’s surrogate loss with this KL penalty (and possibly an entropy bonus) to balance exploration, stability, and fidelity to the base model.*</p>\n      </li>\n    </ul>\n  </li>\n</ul>\n<p>Some RLHF implementations add a penalty to keep the new policy close to the supervised model:</p>\n<ul>\n      <li>\n        <p><strong>where:</strong></p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-196-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3077\" style=\"width: 3.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.815em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.76em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3078\"><span class=\"msubsup\" id=\"MathJax-Span-3079\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3080\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3081\"><span class=\"mrow\" id=\"MathJax-Span-3082\"><span class=\"mi\" id=\"MathJax-Span-3083\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3084\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3085\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3086\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3087\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-196\">L_{\\rm KL}(\\theta)</script>: the <strong>KL-divergence loss</strong>, which penalizes the new policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-197-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3088\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3089\"><span class=\"msubsup\" id=\"MathJax-Span-3090\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3091\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3092\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-197\">\\pi_\\theta</script> if it deviates too far from the supervised fine-tuned (SFT) reference policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-198-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>S</mi><mi mathvariant=&quot;normal&quot;>F</mi><mi mathvariant=&quot;normal&quot;>T</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3093\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.83em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3094\"><span class=\"msubsup\" id=\"MathJax-Span-3095\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3096\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3097\"><span class=\"mrow\" id=\"MathJax-Span-3098\"><span class=\"mi\" id=\"MathJax-Span-3099\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">S</span><span class=\"mi\" id=\"MathJax-Span-3100\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">F</span><span class=\"mi\" id=\"MathJax-Span-3101\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">T</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">S</mi><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">T</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-198\">\\pi_{\\rm SFT}</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-199-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3102\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3103\"><span class=\"mi\" id=\"MathJax-Span-3104\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-199\">\\beta</script>: a <strong>scaling coefficient</strong> controlling the strength of this regularization; larger <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-200-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3105\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3106\"><span class=\"mi\" id=\"MathJax-Span-3107\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-200\">\\beta</script> enforces tighter adherence to the reference model.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-201-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>,</mo><mi>y</mi><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3108\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.44em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.34em, 2.711em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3109\"><span class=\"msubsup\" id=\"MathJax-Span-3110\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3111\"><span class=\"mrow\" id=\"MathJax-Span-3112\"><span class=\"mi\" id=\"MathJax-Span-3113\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3114\"><span class=\"mrow\" id=\"MathJax-Span-3115\"><span class=\"mi\" id=\"MathJax-Span-3116\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3117\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3118\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-3119\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"mi\" id=\"MathJax-Span-3120\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3121\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mo\" id=\"MathJax-Span-3122\" style=\"font-family: STIXGeneral-Regular;\">⋅</span><span class=\"mo\" id=\"MathJax-Span-3123\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>,</mo><mi>y</mi><mo>∼</mo><mi>π</mi></mrow></msub><mo stretchy=\"false\">[</mo><mo>⋅</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-201\">\\mathbb{E}_{x,y\\sim\\pi}[\\cdot]</script>: the <strong>expectation</strong> over sampled input–output pairs from the current policy’s distribution.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-202-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3124\" style=\"width: 4.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.492em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.44em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3125\"><span class=\"msubsup\" id=\"MathJax-Span-3126\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3127\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3128\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3129\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3130\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-3131\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-3132\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3133\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>∣</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-202\">\\pi_\\theta(y \\mid x)</script>: the <strong>current policy’s probability</strong> of generating output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-203-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3134\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3135\"><span class=\"mi\" id=\"MathJax-Span-3136\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-203\">y</script> given input <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-204-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3137\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3138\"><span class=\"mi\" id=\"MathJax-Span-3139\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-204\">x</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-205-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>S</mi><mi mathvariant=&quot;normal&quot;>F</mi><mi mathvariant=&quot;normal&quot;>T</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3140\" style=\"width: 5.263em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.378em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1004.33em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3141\"><span class=\"msubsup\" id=\"MathJax-Span-3142\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3143\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3144\"><span class=\"mrow\" id=\"MathJax-Span-3145\"><span class=\"mi\" id=\"MathJax-Span-3146\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">S</span><span class=\"mi\" id=\"MathJax-Span-3147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">F</span><span class=\"mi\" id=\"MathJax-Span-3148\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">T</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3149\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3150\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-3151\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-3152\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3153\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">S</mi><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">T</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>∣</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-205\">\\pi_{\\rm SFT}(y \\mid x)</script>: the <strong>reference policy’s probability</strong>, often from the supervised model used before RL fine-tuning.</li>\n        </ul>\n      </li>\n      <li>\n        <p>… so the total objective may combine PPO’s surrogate loss with this KL penalty (and possibly an entropy bonus) to balance exploration, stability, and fidelity to the base model.*</p>\n      </li>\n    </ul>\n<p><strong>where:</strong></p>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-196-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3077\" style=\"width: 3.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.815em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.76em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3078\"><span class=\"msubsup\" id=\"MathJax-Span-3079\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3080\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3081\"><span class=\"mrow\" id=\"MathJax-Span-3082\"><span class=\"mi\" id=\"MathJax-Span-3083\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3084\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3085\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3086\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3087\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-196\">L_{\\rm KL}(\\theta)</script>: the <strong>KL-divergence loss</strong>, which penalizes the new policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-197-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3088\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3089\"><span class=\"msubsup\" id=\"MathJax-Span-3090\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3091\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3092\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-197\">\\pi_\\theta</script> if it deviates too far from the supervised fine-tuned (SFT) reference policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-198-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>S</mi><mi mathvariant=&quot;normal&quot;>F</mi><mi mathvariant=&quot;normal&quot;>T</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3093\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.83em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3094\"><span class=\"msubsup\" id=\"MathJax-Span-3095\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3096\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3097\"><span class=\"mrow\" id=\"MathJax-Span-3098\"><span class=\"mi\" id=\"MathJax-Span-3099\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">S</span><span class=\"mi\" id=\"MathJax-Span-3100\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">F</span><span class=\"mi\" id=\"MathJax-Span-3101\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">T</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">S</mi><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">T</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-198\">\\pi_{\\rm SFT}</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-199-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3102\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3103\"><span class=\"mi\" id=\"MathJax-Span-3104\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-199\">\\beta</script>: a <strong>scaling coefficient</strong> controlling the strength of this regularization; larger <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-200-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3105\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3106\"><span class=\"mi\" id=\"MathJax-Span-3107\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-200\">\\beta</script> enforces tighter adherence to the reference model.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-201-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>,</mo><mi>y</mi><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3108\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.44em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.34em, 2.711em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3109\"><span class=\"msubsup\" id=\"MathJax-Span-3110\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3111\"><span class=\"mrow\" id=\"MathJax-Span-3112\"><span class=\"mi\" id=\"MathJax-Span-3113\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3114\"><span class=\"mrow\" id=\"MathJax-Span-3115\"><span class=\"mi\" id=\"MathJax-Span-3116\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3117\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3118\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-3119\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"mi\" id=\"MathJax-Span-3120\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3121\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mo\" id=\"MathJax-Span-3122\" style=\"font-family: STIXGeneral-Regular;\">⋅</span><span class=\"mo\" id=\"MathJax-Span-3123\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>,</mo><mi>y</mi><mo>∼</mo><mi>π</mi></mrow></msub><mo stretchy=\"false\">[</mo><mo>⋅</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-201\">\\mathbb{E}_{x,y\\sim\\pi}[\\cdot]</script>: the <strong>expectation</strong> over sampled input–output pairs from the current policy’s distribution.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-202-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3124\" style=\"width: 4.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.492em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.44em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3125\"><span class=\"msubsup\" id=\"MathJax-Span-3126\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3127\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3128\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3129\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3130\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-3131\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-3132\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3133\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>∣</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-202\">\\pi_\\theta(y \\mid x)</script>: the <strong>current policy’s probability</strong> of generating output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-203-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3134\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3135\"><span class=\"mi\" id=\"MathJax-Span-3136\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-203\">y</script> given input <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-204-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3137\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3138\"><span class=\"mi\" id=\"MathJax-Span-3139\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-204\">x</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-205-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>S</mi><mi mathvariant=&quot;normal&quot;>F</mi><mi mathvariant=&quot;normal&quot;>T</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3140\" style=\"width: 5.263em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.378em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1004.33em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3141\"><span class=\"msubsup\" id=\"MathJax-Span-3142\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3143\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3144\"><span class=\"mrow\" id=\"MathJax-Span-3145\"><span class=\"mi\" id=\"MathJax-Span-3146\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">S</span><span class=\"mi\" id=\"MathJax-Span-3147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">F</span><span class=\"mi\" id=\"MathJax-Span-3148\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">T</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3149\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3150\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-3151\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-3152\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3153\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">S</mi><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">T</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>∣</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-205\">\\pi_{\\rm SFT}(y \\mid x)</script>: the <strong>reference policy’s probability</strong>, often from the supervised model used before RL fine-tuning.</li>\n        </ul>\n<p>… so the total objective may combine PPO’s surrogate loss with this KL penalty (and possibly an entropy bonus) to balance exploration, stability, and fidelity to the base model.*</p>\n<h4 id=\"sample-efficiency--off-policy-corrections\">Sample Efficiency &amp; Off-policy Corrections</h4>\n<ul>\n  <li>For agents interacting with web or tools where running many episodes is costly, sample efficiency matters. Off-policy methods (e.g., experience replay) or offline RL variants (e.g., <a href=\"https://arxiv.org/abs/2203.01387\">A Survey on Offline Reinforcement Learning</a> by Kumar et al. (2022)) may become relevant.</li>\n</ul>",
    "contentMarkdown": "#### Advantage Estimation & Value Networks\n\n*   In actor–critic variants (including PPO), we often learn a value function Vψ(s)Vψ(s)V\\_\\\\psi(s) to reduce variance:\n    \n    At\\=Rt−Vψ(st)Rt\\=∑k\\=0∞γkrt+kAt\\=Rt−Vψ(st)Rt\\=∑k\\=0∞γkrt+k\n    \n    A\\_t = R\\_t - V\\_\\\\psi(s\\_t) \\\\quad R\\_t = \\\\sum\\_{k=0}^{\\\\infty} \\\\gamma^k r\\_{t+k}\n    *   **where:**\n        \n        *   AtAtA\\_t: the **advantage estimate** at timestep ttt, measuring how much better an action performed compared to the policy’s expected performance.\n        *   RtRtR\\_t: the **discounted return**, or the total expected future reward from time ttt.\n        *   γγ\\\\gamma: the **discount factor** (0<γ≤10<γ≤10 < \\\\gamma \\\\le 1), controlling how much future rewards are valued compared to immediate ones.\n        *   rt+krt+kr\\_{t+k}: the **immediate reward** received at step t+kt+kt+k.\n        *   Vψ(st)Vψ(st)V\\_\\\\psi(s\\_t): the **critic’s value estimate** for state ststs\\_t, parameterized by ψψ\\\\psi, representing the expected return from that state under the current policy.\n*   The update for the critic aims to minimize:\n    \n    Lvalue(ψ)\\=𝔼st∼π\\[(Vψ(st)−Rt)2\\]Lvalue(ψ)\\=Est∼π\\[(Vψ(st)−Rt)2\\]\n    \n    L\\_{\\\\rm value}(\\\\psi) = \\\\mathbb{E}\\_{s\\_t\\\\sim\\\\pi}\\\\big\\[(V\\_\\\\psi(s\\_t) - R\\_t)^2 \\\\big\\]\n    *   **where:**\n        \n        *   Lvalue(ψ)Lvalue(ψ)L\\_{\\\\rm value}(\\\\psi): the **value loss**, quantifying how far the critic’s predictions are from the actual returns.\n        *   𝔼st∼π\\[⋅\\]Est∼π\\[⋅\\]\\\\mathbb{E}\\_{s\\_t\\\\sim\\\\pi}\\[\\\\cdot\\]: the **expectation** over states ststs\\_t sampled from the current policy (\\\\pi).\n        *   The squared term (Vψ(st)−Rt)2(Vψ(st)−Rt)2(V\\_\\\\psi(s\\_t) - R\\_t)^2: penalizes inaccurate value predictions, guiding the critic to estimate returns more accurately.\n\nIn actor–critic variants (including PPO), we often learn a value function Vψ(s)Vψ(s)V\\_\\\\psi(s) to reduce variance:\n\n*   **where:**\n    \n    *   AtAtA\\_t: the **advantage estimate** at timestep ttt, measuring how much better an action performed compared to the policy’s expected performance.\n    *   RtRtR\\_t: the **discounted return**, or the total expected future reward from time ttt.\n    *   γγ\\\\gamma: the **discount factor** (0<γ≤10<γ≤10 < \\\\gamma \\\\le 1), controlling how much future rewards are valued compared to immediate ones.\n    *   rt+krt+kr\\_{t+k}: the **immediate reward** received at step t+kt+kt+k.\n    *   Vψ(st)Vψ(st)V\\_\\\\psi(s\\_t): the **critic’s value estimate** for state ststs\\_t, parameterized by ψψ\\\\psi, representing the expected return from that state under the current policy.\n\n**where:**\n\n*   AtAtA\\_t: the **advantage estimate** at timestep ttt, measuring how much better an action performed compared to the policy’s expected performance.\n*   RtRtR\\_t: the **discounted return**, or the total expected future reward from time ttt.\n*   γγ\\\\gamma: the **discount factor** (0<γ≤10<γ≤10 < \\\\gamma \\\\le 1), controlling how much future rewards are valued compared to immediate ones.\n*   rt+krt+kr\\_{t+k}: the **immediate reward** received at step t+kt+kt+k.\n*   Vψ(st)Vψ(st)V\\_\\\\psi(s\\_t): the **critic’s value estimate** for state ststs\\_t, parameterized by ψψ\\\\psi, representing the expected return from that state under the current policy.\n\nThe update for the critic aims to minimize:\n\n*   **where:**\n    \n    *   Lvalue(ψ)Lvalue(ψ)L\\_{\\\\rm value}(\\\\psi): the **value loss**, quantifying how far the critic’s predictions are from the actual returns.\n    *   𝔼st∼π\\[⋅\\]Est∼π\\[⋅\\]\\\\mathbb{E}\\_{s\\_t\\\\sim\\\\pi}\\[\\\\cdot\\]: the **expectation** over states ststs\\_t sampled from the current policy (\\\\pi).\n    *   The squared term (Vψ(st)−Rt)2(Vψ(st)−Rt)2(V\\_\\\\psi(s\\_t) - R\\_t)^2: penalizes inaccurate value predictions, guiding the critic to estimate returns more accurately.\n\n**where:**\n\n*   Lvalue(ψ)Lvalue(ψ)L\\_{\\\\rm value}(\\\\psi): the **value loss**, quantifying how far the critic’s predictions are from the actual returns.\n*   𝔼st∼π\\[⋅\\]Est∼π\\[⋅\\]\\\\mathbb{E}\\_{s\\_t\\\\sim\\\\pi}\\[\\\\cdot\\]: the **expectation** over states ststs\\_t sampled from the current policy (\\\\pi).\n*   The squared term (Vψ(st)−Rt)2(Vψ(st)−Rt)2(V\\_\\\\psi(s\\_t) - R\\_t)^2: penalizes inaccurate value predictions, guiding the critic to estimate returns more accurately.\n\n#### KL-penalty / Trust Region\n\n*   Some RLHF implementations add a penalty to keep the new policy close to the supervised model:\n    \n    LKL(θ)\\=β⋅𝔼x,y∼π\\[logπθ(y|x)πSFT(y|x)\\]LKL(θ)\\=β⋅Ex,y∼π\\[log⁡πθ(y|x)πSFT(y|x)\\]\n    \n    L\\_{\\\\rm KL}(\\\\theta) = \\\\beta \\\\cdot \\\\mathbb{E}\\_{x,y\\\\sim\\\\pi}\\\\left\\[ \\\\log\\\\frac{\\\\pi\\_\\\\theta(y|x)}{\\\\pi\\_{\\\\rm SFT}(y|x)} \\\\right\\]\n    *   **where:**\n        \n        *   LKL(θ)LKL(θ)L\\_{\\\\rm KL}(\\\\theta): the **KL-divergence loss**, which penalizes the new policy πθπθ\\\\pi\\_\\\\theta if it deviates too far from the supervised fine-tuned (SFT) reference policy πSFTπSFT\\\\pi\\_{\\\\rm SFT}.\n        *   ββ\\\\beta: a **scaling coefficient** controlling the strength of this regularization; larger ββ\\\\beta enforces tighter adherence to the reference model.\n        *   𝔼x,y∼π\\[⋅\\]Ex,y∼π\\[⋅\\]\\\\mathbb{E}\\_{x,y\\\\sim\\\\pi}\\[\\\\cdot\\]: the **expectation** over sampled input–output pairs from the current policy’s distribution.\n        *   πθ(y∣x)πθ(y∣x)\\\\pi\\_\\\\theta(y \\\\mid x): the **current policy’s probability** of generating output yyy given input xxx.\n        *   πSFT(y∣x)πSFT(y∣x)\\\\pi\\_{\\\\rm SFT}(y \\\\mid x): the **reference policy’s probability**, often from the supervised model used before RL fine-tuning.\n    *   … so the total objective may combine PPO’s surrogate loss with this KL penalty (and possibly an entropy bonus) to balance exploration, stability, and fidelity to the base model.\\*\n        \n\nSome RLHF implementations add a penalty to keep the new policy close to the supervised model:\n\n*   **where:**\n    \n    *   LKL(θ)LKL(θ)L\\_{\\\\rm KL}(\\\\theta): the **KL-divergence loss**, which penalizes the new policy πθπθ\\\\pi\\_\\\\theta if it deviates too far from the supervised fine-tuned (SFT) reference policy πSFTπSFT\\\\pi\\_{\\\\rm SFT}.\n    *   ββ\\\\beta: a **scaling coefficient** controlling the strength of this regularization; larger ββ\\\\beta enforces tighter adherence to the reference model.\n    *   𝔼x,y∼π\\[⋅\\]Ex,y∼π\\[⋅\\]\\\\mathbb{E}\\_{x,y\\\\sim\\\\pi}\\[\\\\cdot\\]: the **expectation** over sampled input–output pairs from the current policy’s distribution.\n    *   πθ(y∣x)πθ(y∣x)\\\\pi\\_\\\\theta(y \\\\mid x): the **current policy’s probability** of generating output yyy given input xxx.\n    *   πSFT(y∣x)πSFT(y∣x)\\\\pi\\_{\\\\rm SFT}(y \\\\mid x): the **reference policy’s probability**, often from the supervised model used before RL fine-tuning.\n*   … so the total objective may combine PPO’s surrogate loss with this KL penalty (and possibly an entropy bonus) to balance exploration, stability, and fidelity to the base model.\\*\n    \n\n**where:**\n\n*   LKL(θ)LKL(θ)L\\_{\\\\rm KL}(\\\\theta): the **KL-divergence loss**, which penalizes the new policy πθπθ\\\\pi\\_\\\\theta if it deviates too far from the supervised fine-tuned (SFT) reference policy πSFTπSFT\\\\pi\\_{\\\\rm SFT}.\n*   ββ\\\\beta: a **scaling coefficient** controlling the strength of this regularization; larger ββ\\\\beta enforces tighter adherence to the reference model.\n*   𝔼x,y∼π\\[⋅\\]Ex,y∼π\\[⋅\\]\\\\mathbb{E}\\_{x,y\\\\sim\\\\pi}\\[\\\\cdot\\]: the **expectation** over sampled input–output pairs from the current policy’s distribution.\n*   πθ(y∣x)πθ(y∣x)\\\\pi\\_\\\\theta(y \\\\mid x): the **current policy’s probability** of generating output yyy given input xxx.\n*   πSFT(y∣x)πSFT(y∣x)\\\\pi\\_{\\\\rm SFT}(y \\\\mid x): the **reference policy’s probability**, often from the supervised model used before RL fine-tuning.\n\n… so the total objective may combine PPO’s surrogate loss with this KL penalty (and possibly an entropy bonus) to balance exploration, stability, and fidelity to the base model.\\*\n\n#### Sample Efficiency & Off-policy Corrections\n\n*   For agents interacting with web or tools where running many episodes is costly, sample efficiency matters. Off-policy methods (e.g., experience replay) or offline RL variants (e.g., [A Survey on Offline Reinforcement Learning](https://arxiv.org/abs/2203.01387) by Kumar et al. (2022)) may become relevant.",
    "order": 19,
    "orderInChapter": 5,
    "difficulty": 4,
    "estimatedMinutes": 5,
    "tags": [
      "algorithmsarchitecture",
      "reinforcement learning",
      "regularization",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 960,
      "contentLength": 215807
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#key-equations",
    "scrapedAt": "2025-12-28T11:47:36.152Z"
  },
  {
    "id": "ai-agentic-RL-agentic-reinforcement-learning-via-policy-optimiza-20",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Reinforcement Learning for Web and Computer-Use Agents",
    "title": "Agentic Reinforcement Learning Via Policy Optimization",
    "subtitle": "Reinforcement Learning for Web and Computer-Use Agents",
    "contentHtml": "<ul>\n  <li>\n    <p>In <strong>policy optimization</strong>, the agent learns from a unified reward function that draws its signal from <strong>one or more available sources</strong>—such as <strong>rule-based rewards</strong>, a scalar reward output from a <strong>learned reward model</strong>, or another model that is proficient at grading the task (such as an <strong>LLM-as-a-Judge</strong>). Each policy update seeks to maximize the expected cumulative return:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-206-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munder><mo>&amp;#x2211;</mo><mi>t</mi></munder><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3154\" style=\"width: 10.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.753em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1008.44em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3155\"><span class=\"mi\" id=\"MathJax-Span-3156\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3157\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3158\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3159\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3160\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3161\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3162\"><span class=\"mrow\" id=\"MathJax-Span-3163\"><span class=\"mi\" id=\"MathJax-Span-3164\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3165\"><span class=\"mrow\" id=\"MathJax-Span-3166\"><span class=\"msubsup\" id=\"MathJax-Span-3167\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3168\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3169\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-3170\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-3171\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-3172\"><span class=\"munderover\" id=\"MathJax-Span-3173\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3174\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3175\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3176\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3177\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3178\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3179\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3180\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3181\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3182\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munder><mo>∑</mo><mi>t</mi></munder><msup><mi>γ</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-206\">J(\\theta) = \\mathbb{E}_{\\pi_\\theta}\\left[\\sum_t \\gamma^t r_t\\right]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-207-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3183\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3184\"><span class=\"msubsup\" id=\"MathJax-Span-3185\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3186\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3187\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-207\">r_t</script> represents whichever reward signal is active for the current environment or training regime. In some settings, this may be a purely rule-based signal derived from measurable events (like navigation completions, form submissions, or file creations). In others, the reward may come from a trained model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-208-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3188\" style=\"width: 7.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.89em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3189\"><span class=\"msubsup\" id=\"MathJax-Span-3190\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3191\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3192\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3193\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3194\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3195\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3196\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3197\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3198\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3199\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3200\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3201\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3202\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3203\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3204\"><span class=\"mrow\" id=\"MathJax-Span-3205\"><span class=\"mi\" id=\"MathJax-Span-3206\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3207\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-3208\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3209\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-208\">R_\\phi(o_t, a_t, o_{t+1})</script> that generalizes human preference data, or from an external proficient verifier (typically a larger model) such as an LLM-as-a-Judge.</li>\n    </ul>\n  </li>\n  <li>\n    <p>These components are <strong>modular and optional</strong>—only one or several may be active at any time. The optimization loop remains identical regardless of source: the policy simply maximizes whichever scalar feedback <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-209-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3210\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3211\"><span class=\"msubsup\" id=\"MathJax-Span-3212\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3213\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3214\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-209\">r_t</script> it receives. This flexible design allows the same framework to operate with deterministic, model-based, or semantic reward supervision, depending on task complexity, available annotations, and desired interpretability.</p>\n  </li>\n  <li>\n    <p><strong>Rule-based rewards</strong> form the foundation of this framework, providing deterministic, auditable feedback grounded in <strong>explicit environment transitions and observable state changes</strong>. As demonstrated in <a href=\"https://arxiv.org/abs/2501.12948\">DeepSeek-R1: Incentivizing Reasoning Capability in Large Language Models</a> by Gao et al. (2025), rule-based rewards yield transparent and stable optimization signals that are resistant to reward hacking and reduce reliance on noisy human annotation.\nIn the context of computer-use agents, rule-based mechanisms correspond directly to <strong>verifiable milestones</strong> in user interaction sequences—for example:</p>\n\n    <ul>\n      <li>In <strong>web navigation</strong>, detecting a URL transition, page load completion, or DOM state change (<code class=\"language-plaintext highlighter-rouge\">NavigationCompleted</code>, <code class=\"language-plaintext highlighter-rouge\">DOMContentLoaded</code>).</li>\n      <li>In <strong>form interaction</strong>, observing DOM model deltas that indicate fields were populated, validation succeeded, or a “Submit” action triggered a confirmation dialog.</li>\n      <li>In <strong>file handling/artifact generation</strong>, confirming the creation or modification of a file within the sandbox (e.g., registering successful exports such as <code class=\"language-plaintext highlighter-rouge\">.csv</code>, <code class=\"language-plaintext highlighter-rouge\">.pdf</code>, or <code class=\"language-plaintext highlighter-rouge\">.png</code> outputs following specific actions).</li>\n      <li>In <strong>application state transitions</strong>, monitoring focus changes, dialog closures, or process launches via OS accessibility APIs.</li>\n      <li>In <strong>UI interaction success</strong>, verifying that a button, link, or menu item was activated and that the resulting accessibility tree or visual layout changed accordingly.</li>\n      <li>These measurable indicators serve as the <strong>atomic verification layer</strong> of the reward system, ensuring that each environment step corresponds to reproducible, auditable progress signals without requiring human intervention.</li>\n    </ul>\n  </li>\n  <li>\n    <p>To generalize beyond fixed rules, a <strong>trainable reward model</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-210-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3215\" style=\"width: 7.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.89em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3216\"><span class=\"msubsup\" id=\"MathJax-Span-3217\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3218\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3219\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3220\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3221\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3222\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3223\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3224\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3225\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3226\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3227\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3228\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3229\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3230\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3231\"><span class=\"mrow\" id=\"MathJax-Span-3232\"><span class=\"mi\" id=\"MathJax-Span-3233\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3234\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-3235\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3236\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-210\">R_\\phi(o_t, a_t, o_{t+1})</script> can be introduced. This model is trained on <strong>human-labeled or preference-ranked trajectories</strong>, similar to the reward modeling stage in PPO-based RLHF pipelines. Once trained, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-211-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3237\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3238\"><span class=\"msubsup\" id=\"MathJax-Span-3239\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3240\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3241\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-211\">R_\\phi</script> predicts scalar reward signals that approximate human preferences for unseen tasks or ambiguous states. It operates faster and more consistently than a generative LLM-as-a-Judge (which can be implemented as a Verifier Agent), while maintaining semantic fidelity to human supervision.</p>\n  </li>\n  <li>\n    <p>The <strong>three-tier reward hierarchy</strong> thus becomes:</p>\n\n    <ol>\n      <li><strong>Rule-based rewards (preferred default):</strong> deterministic, event-driven, and auditable (no reward hacking).</li>\n      <li><strong>Learned, discriminative reward model (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-212-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3242\" style=\"width: 1.397em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.139em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.294em, 1001.14em, 2.585em, -999.997em); top: -2.115em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3243\"><span class=\"msubsup\" id=\"MathJax-Span-3244\"><span style=\"display: inline-block; position: relative; width: 1.139em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.153em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3245\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span><span style=\"position: absolute; top: -3.82em; left: 0.622em;\"><span class=\"mi\" id=\"MathJax-Span-3246\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.12em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-212\">R_\\phi</script>):</strong> generalizes human feedback for subtle, unstructured, or context-dependent goals where rules are insufficient.</li>\n      <li><strong>Generative reward model (e.g., LLM-as-a-Judge):</strong> invoked only when both rule-based detectors and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-213-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3247\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3248\"><span class=\"msubsup\" id=\"MathJax-Span-3249\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3250\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3251\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-213\">R_\\phi</script> cannot confidently score outcomes (e.g., for semantic reasoning, style alignment, or multimodal understanding). This is similar to how <a href=\"../deepseek-R1\">DeepSeek-R1</a> uses a generative reward model by feeding the ground-truth and model predictions into DeepSeek-V3 for judgment during the rejection sampling stage for reasoning data.</li>\n    </ol>\n  </li>\n  <li>\n    <p>This architecture ensures that the <strong>primary training flow remains rule-grounded and verifiable</strong>, while allowing smooth fallback to preference-aligned modeling when necessary. The hybrid setup—selectively combining rule-based rewards, learned reward estimation, and verifier agent intervention—balances <strong>scalability, auditability, and semantic depth</strong> across diverse computer-use tasks.</p>\n  </li>\n  <li>\n    <p>During training, the <strong>reward selection and routing process</strong> is adaptive. When deterministic milestone detectors emit valid scores, they take precedence as the most reliable supervision. If the environment lacks such instrumentation, the learned model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-214-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3252\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3253\"><span class=\"msubsup\" id=\"MathJax-Span-3254\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3255\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3256\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-214\">R_\\phi</script> dynamically provides substitute scalar feedback inferred from trajectory context. In the rare case that both mechanisms yield low confidence, the system escalates to the Verifier Agent for semantic adjudication. This cascading reward flow ensures the agent always receives a stable optimization signal—grounded when possible, inferred when necessary, and judged when ambiguity demands interpretive reasoning.</p>\n  </li>\n</ul>\n<p>In <strong>policy optimization</strong>, the agent learns from a unified reward function that draws its signal from <strong>one or more available sources</strong>—such as <strong>rule-based rewards</strong>, a scalar reward output from a <strong>learned reward model</strong>, or another model that is proficient at grading the task (such as an <strong>LLM-as-a-Judge</strong>). Each policy update seeks to maximize the expected cumulative return:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-207-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3183\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3184\"><span class=\"msubsup\" id=\"MathJax-Span-3185\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3186\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3187\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-207\">r_t</script> represents whichever reward signal is active for the current environment or training regime. In some settings, this may be a purely rule-based signal derived from measurable events (like navigation completions, form submissions, or file creations). In others, the reward may come from a trained model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-208-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3188\" style=\"width: 7.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.89em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3189\"><span class=\"msubsup\" id=\"MathJax-Span-3190\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3191\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3192\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3193\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3194\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3195\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3196\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3197\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3198\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3199\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3200\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3201\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3202\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3203\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3204\"><span class=\"mrow\" id=\"MathJax-Span-3205\"><span class=\"mi\" id=\"MathJax-Span-3206\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3207\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-3208\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3209\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-208\">R_\\phi(o_t, a_t, o_{t+1})</script> that generalizes human preference data, or from an external proficient verifier (typically a larger model) such as an LLM-as-a-Judge.</li>\n    </ul>\n<p>These components are <strong>modular and optional</strong>—only one or several may be active at any time. The optimization loop remains identical regardless of source: the policy simply maximizes whichever scalar feedback <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-209-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3210\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3211\"><span class=\"msubsup\" id=\"MathJax-Span-3212\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3213\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3214\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-209\">r_t</script> it receives. This flexible design allows the same framework to operate with deterministic, model-based, or semantic reward supervision, depending on task complexity, available annotations, and desired interpretability.</p>\n<p><strong>Rule-based rewards</strong> form the foundation of this framework, providing deterministic, auditable feedback grounded in <strong>explicit environment transitions and observable state changes</strong>. As demonstrated in <a href=\"https://arxiv.org/abs/2501.12948\">DeepSeek-R1: Incentivizing Reasoning Capability in Large Language Models</a> by Gao et al. (2025), rule-based rewards yield transparent and stable optimization signals that are resistant to reward hacking and reduce reliance on noisy human annotation.\nIn the context of computer-use agents, rule-based mechanisms correspond directly to <strong>verifiable milestones</strong> in user interaction sequences—for example:</p>\n<ul>\n      <li>In <strong>web navigation</strong>, detecting a URL transition, page load completion, or DOM state change (<code class=\"language-plaintext highlighter-rouge\">NavigationCompleted</code>, <code class=\"language-plaintext highlighter-rouge\">DOMContentLoaded</code>).</li>\n      <li>In <strong>form interaction</strong>, observing DOM model deltas that indicate fields were populated, validation succeeded, or a “Submit” action triggered a confirmation dialog.</li>\n      <li>In <strong>file handling/artifact generation</strong>, confirming the creation or modification of a file within the sandbox (e.g., registering successful exports such as <code class=\"language-plaintext highlighter-rouge\">.csv</code>, <code class=\"language-plaintext highlighter-rouge\">.pdf</code>, or <code class=\"language-plaintext highlighter-rouge\">.png</code> outputs following specific actions).</li>\n      <li>In <strong>application state transitions</strong>, monitoring focus changes, dialog closures, or process launches via OS accessibility APIs.</li>\n      <li>In <strong>UI interaction success</strong>, verifying that a button, link, or menu item was activated and that the resulting accessibility tree or visual layout changed accordingly.</li>\n      <li>These measurable indicators serve as the <strong>atomic verification layer</strong> of the reward system, ensuring that each environment step corresponds to reproducible, auditable progress signals without requiring human intervention.</li>\n    </ul>\n<p>To generalize beyond fixed rules, a <strong>trainable reward model</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-210-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3215\" style=\"width: 7.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.89em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3216\"><span class=\"msubsup\" id=\"MathJax-Span-3217\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3218\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3219\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3220\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3221\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3222\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3223\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3224\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3225\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3226\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3227\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3228\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3229\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3230\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3231\"><span class=\"mrow\" id=\"MathJax-Span-3232\"><span class=\"mi\" id=\"MathJax-Span-3233\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3234\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-3235\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3236\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-210\">R_\\phi(o_t, a_t, o_{t+1})</script> can be introduced. This model is trained on <strong>human-labeled or preference-ranked trajectories</strong>, similar to the reward modeling stage in PPO-based RLHF pipelines. Once trained, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-211-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3237\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3238\"><span class=\"msubsup\" id=\"MathJax-Span-3239\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3240\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3241\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-211\">R_\\phi</script> predicts scalar reward signals that approximate human preferences for unseen tasks or ambiguous states. It operates faster and more consistently than a generative LLM-as-a-Judge (which can be implemented as a Verifier Agent), while maintaining semantic fidelity to human supervision.</p>\n<p>The <strong>three-tier reward hierarchy</strong> thus becomes:</p>\n<ol>\n      <li><strong>Rule-based rewards (preferred default):</strong> deterministic, event-driven, and auditable (no reward hacking).</li>\n      <li><strong>Learned, discriminative reward model (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-212-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3242\" style=\"width: 1.397em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.139em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.294em, 1001.14em, 2.585em, -999.997em); top: -2.115em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3243\"><span class=\"msubsup\" id=\"MathJax-Span-3244\"><span style=\"display: inline-block; position: relative; width: 1.139em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.153em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3245\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span><span style=\"position: absolute; top: -3.82em; left: 0.622em;\"><span class=\"mi\" id=\"MathJax-Span-3246\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.12em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-212\">R_\\phi</script>):</strong> generalizes human feedback for subtle, unstructured, or context-dependent goals where rules are insufficient.</li>\n      <li><strong>Generative reward model (e.g., LLM-as-a-Judge):</strong> invoked only when both rule-based detectors and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-213-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3247\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3248\"><span class=\"msubsup\" id=\"MathJax-Span-3249\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3250\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3251\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-213\">R_\\phi</script> cannot confidently score outcomes (e.g., for semantic reasoning, style alignment, or multimodal understanding). This is similar to how <a href=\"../deepseek-R1\">DeepSeek-R1</a> uses a generative reward model by feeding the ground-truth and model predictions into DeepSeek-V3 for judgment during the rejection sampling stage for reasoning data.</li>\n    </ol>\n<p>This architecture ensures that the <strong>primary training flow remains rule-grounded and verifiable</strong>, while allowing smooth fallback to preference-aligned modeling when necessary. The hybrid setup—selectively combining rule-based rewards, learned reward estimation, and verifier agent intervention—balances <strong>scalability, auditability, and semantic depth</strong> across diverse computer-use tasks.</p>\n<p>During training, the <strong>reward selection and routing process</strong> is adaptive. When deterministic milestone detectors emit valid scores, they take precedence as the most reliable supervision. If the environment lacks such instrumentation, the learned model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-214-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3252\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3253\"><span class=\"msubsup\" id=\"MathJax-Span-3254\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3255\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3256\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-214\">R_\\phi</script> dynamically provides substitute scalar feedback inferred from trajectory context. In the rare case that both mechanisms yield low confidence, the system escalates to the Verifier Agent for semantic adjudication. This cascading reward flow ensures the agent always receives a stable optimization signal—grounded when possible, inferred when necessary, and judged when ambiguity demands interpretive reasoning.</p>\n<h4 id=\"milestone-based-reward-system\">Milestone-Based Reward System</h4>\n<ul>\n  <li>\n    <p>Any <strong>reward formulation</strong>—whether deterministic, learned, or model-evaluated—can be decomposed into a sequence of <strong>milestones or checkpoints</strong> that represent measurable progress toward the task goal. Each milestone corresponds to a verifiable state transition, UI event, or observable change in the environment, providing interpretable signals even within complex or hierarchical workflows. In practice, a reward function can therefore be a <strong>composite of multiple sources</strong>: <strong>rule-based rewards</strong>, scalar predictions from a <strong>learned, discriminative reward model</strong>, or a <strong>generative model</strong> that is  proficient at grading the task, such as an <strong>LLM-as-a-Judge</strong>.</p>\n  </li>\n  <li>\n    <p>In general, <strong>rule-based rewards</strong> are preferred because they are <strong>deterministic, easy to verify, and resistant to reward hacking</strong>, consistent with the design principles demonstrated in the <a href=\"https://arxiv.org/abs/2501.12948\">DeepSeek-R1</a> framework by Gao et al. (2025). These rewards are derived from <strong>concrete, environment-observable events</strong>—such as file creation, DOM or AX tree changes, navigation completions, or dialog confirmations—and can be validated directly through structured logs and system hooks. Their reproducibility and transparency make them ideal for large-scale, self-contained policy optimization loops, where interpretability and auditability are crucial.</p>\n  </li>\n  <li>\n    <p>In this system, the <strong>rule-based layer</strong> serves as the foundational signal generator for all common computer-use tasks. It captures events such as:</p>\n\n    <ul>\n      <li>File downloads or artifact creation</li>\n      <li>Successful form submissions or dialog confirmations</li>\n      <li>UI transitions, window focus changes, or navigation completions</li>\n      <li>Text field population or data transfer between applications</li>\n      <li>\n        <p>Screenshot or state deltas indicating successful subgoal completion</p>\n      </li>\n      <li>These reward components directly populate the tuple <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-215-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>r</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3257\" style=\"width: 7.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.89em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3258\"><span class=\"mo\" id=\"MathJax-Span-3259\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3260\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3261\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3262\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3263\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3264\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3265\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3266\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3267\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3268\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3269\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3270\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3271\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3272\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3273\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3274\"><span class=\"mrow\" id=\"MathJax-Span-3275\"><span class=\"mi\" id=\"MathJax-Span-3276\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3277\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-3278\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3279\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>r</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-215\">(o_t, a_t, r_t, o_{t+1})</script> used by the policy optimizer for learning stable, interpretable control policies. Each milestone event contributes either a discrete tick or a weighted scalar toward cumulative progress.</li>\n    </ul>\n  </li>\n  <li>\n    <p>However, not all task goals can be described exhaustively through deterministic rules. To extend coverage, the architecture includes a <strong>learned reward model</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-216-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3280\" style=\"width: 7.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.89em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3281\"><span class=\"msubsup\" id=\"MathJax-Span-3282\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3283\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3284\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3285\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3286\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3287\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3288\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3289\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3290\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3291\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3292\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3293\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3294\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3295\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3296\"><span class=\"mrow\" id=\"MathJax-Span-3297\"><span class=\"mi\" id=\"MathJax-Span-3298\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3299\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-3300\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3301\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-216\">R_\\phi(o_t, a_t, o_{t+1})</script> trained specifically on <strong>human preferences or ranked trajectories</strong>.</p>\n\n    <ul>\n      <li>This model generalizes beyond hand-engineered events to score <strong>semantic correctness, contextual relevance, and user-aligned outcomes</strong>.</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-217-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3302\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3303\"><span class=\"msubsup\" id=\"MathJax-Span-3304\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3305\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3306\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-217\">R_\\phi</script> can be continuously fine-tuned as new preference data accumulates, adapting reward shaping dynamically to novel workflows or unseen UIs.</li>\n      <li>\n        <p>During training, the optimizer consumes a blended reward signal that can combine multiple sources:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-218-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>r</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><mi>&amp;#x03B1;</mi><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>rule</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>+</mo><mi>&amp;#x03B2;</mi><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B3;</mi><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>judge</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3307\" style=\"width: 19.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1016.46em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3308\"><span class=\"msubsup\" id=\"MathJax-Span-3309\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3310\"><span class=\"mrow\" id=\"MathJax-Span-3311\"><span class=\"munderover\" id=\"MathJax-Span-3312\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3313\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3314\" style=\"font-family: STIXGeneral-Regular;\">̃&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-3315\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3316\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3317\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">α</span><span class=\"msubsup\" id=\"MathJax-Span-3318\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3319\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.67em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3320\"><span class=\"mrow\" id=\"MathJax-Span-3321\"><span class=\"mo\" id=\"MathJax-Span-3322\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3323\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">rule</span><span class=\"mo\" id=\"MathJax-Span-3324\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3325\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3326\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3327\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-3328\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3329\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3330\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3331\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3332\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3333\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3334\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3335\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3336\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3337\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3338\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3339\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3340\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3341\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3342\"><span class=\"mrow\" id=\"MathJax-Span-3343\"><span class=\"mi\" id=\"MathJax-Span-3344\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3345\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-3346\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3347\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3348\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3349\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-3350\"><span style=\"display: inline-block; position: relative; width: 2.607em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3351\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.14em, 4.326em, -999.997em); top: -4.529em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3352\"><span class=\"mrow\" id=\"MathJax-Span-3353\"><span class=\"mo\" id=\"MathJax-Span-3354\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3355\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">judge</span><span class=\"mo\" id=\"MathJax-Span-3356\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3357\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>r</mi><mo stretchy=\"false\">~</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><mi>α</mi><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>rule</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>+</mo><mi>β</mi><msub><mi>R</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mi>γ</mi><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>judge</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-218\">\\tilde{r}_t = \\alpha r_t^{(\\text{rule})} + \\beta R_\\phi(o_t, a_t, o_{t+1}) + \\gamma r_t^{(\\text{judge})}</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-219-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo>,</mo><mi>&amp;#x03B2;</mi><mo>,</mo><mi>&amp;#x03B3;</mi><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3358\" style=\"width: 7.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1005.89em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3359\"><span class=\"mi\" id=\"MathJax-Span-3360\" style=\"font-family: STIXGeneral-Italic;\">α</span><span class=\"mo\" id=\"MathJax-Span-3361\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3362\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3363\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3364\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3365\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"mo\" id=\"MathJax-Span-3366\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">[</span><span class=\"mn\" id=\"MathJax-Span-3367\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3368\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3369\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3370\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-219\">\\alpha, \\beta, \\gamma \\in [0,1]</script> represent trust weights for deterministic, learned, and model-evaluated components respectively, with <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-220-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo>+</mo><mi>&amp;#x03B2;</mi><mo>+</mo><mi>&amp;#x03B3;</mi><mo>=</mo><mn>1</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3371\" style=\"width: 6.773em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3372\"><span class=\"mi\" id=\"MathJax-Span-3373\" style=\"font-family: STIXGeneral-Italic;\">α</span><span class=\"mo\" id=\"MathJax-Span-3374\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3375\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3376\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3377\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3378\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-3379\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>α</mi><mo>+</mo><mi>β</mi><mo>+</mo><mi>γ</mi><mo>=</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-220\">\\alpha + \\beta + \\gamma = 1</script>.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>In cases where both rule-based detectors and the learned reward model fail to provide a confident or interpretable score, a <strong>generative model (such as an LLM-as-a-Judge)</strong> may be selectively invoked. This verifier acts as a high-capacity, <em>LLM-as-a-Judge</em> module that semantically evaluates whether the observed trajectory satisfies implicit or fuzzy success criteria. Its role parallels that of a preference model but operates at runtime for difficult or open-ended cases.</p>\n  </li>\n  <li>\n    <p>Scenarios where rule-based and model-based scoring may be insufficient—and thus require a Verifier Agent—include:</p>\n\n    <ul>\n      <li><strong>Subjective or semantic correctness:</strong> determining if a written summary or chart interpretation matches the instruction intent.</li>\n      <li><strong>Cross-context validation:</strong> verifying that data copied from a spreadsheet was correctly inserted into a report or email draft.</li>\n      <li><strong>Goal inference under ambiguity:</strong> tasks like “open the latest invoice,” where the target must be inferred dynamically.</li>\n      <li><strong>Complex recovery handling:</strong> identifying whether the system has correctly recovered from an unintended dialog or misclick.</li>\n      <li><strong>Language or multimodal alignment:</strong> verifying tone, structure, or layout across applications.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The <strong>reward system hierarchy</strong> therefore consists of three complementary and optionally composable layers:</p>\n\n    <ol>\n      <li>\n        <p><strong>Rule-based rewards</strong>: deterministic, verifiable, and fully auditable signals derived from concrete milestones (default and preferred).</p>\n      </li>\n      <li>\n        <p><strong>Learned, discriminative reward model (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-221-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3380\" style=\"width: 1.397em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.139em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.294em, 1001.14em, 2.585em, -999.997em); top: -2.115em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3381\"><span class=\"msubsup\" id=\"MathJax-Span-3382\"><span style=\"display: inline-block; position: relative; width: 1.139em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.153em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3383\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span><span style=\"position: absolute; top: -3.82em; left: 0.622em;\"><span class=\"mi\" id=\"MathJax-Span-3384\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.12em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-221\">R_\\phi</script>)</strong>: trained on human preferences to generalize beyond explicit rules and produce scalar feedback for unstructured tasks.</p>\n      </li>\n      <li>\n        <p><strong>Generative reward model (e.g., LLM-as-a-Judge)</strong>: semantic fallback for nuanced, subjective, or multimodal evaluation where neither rules nor learned models suffice. This is similar to how <a href=\"../deepseek-R1\">DeepSeek-R1</a> uses a generative reward model by feeding the ground-truth and model predictions into DeepSeek-V3 for judgment during the rejection sampling stage for reasoning data.</p>\n      </li>\n    </ol>\n  </li>\n  <li>\n    <p>Together, these layers enable <strong>robust, explainable, and modular reward shaping</strong>. Any reward function within the system can thus be expressed as a <strong>milestone-weighted combination</strong> of deterministic, learned, and interpretive components—ensuring scalability, transparency, and semantic alignment across all computer-use reinforcement learning setups.</p>\n  </li>\n</ul>\n<p>Any <strong>reward formulation</strong>—whether deterministic, learned, or model-evaluated—can be decomposed into a sequence of <strong>milestones or checkpoints</strong> that represent measurable progress toward the task goal. Each milestone corresponds to a verifiable state transition, UI event, or observable change in the environment, providing interpretable signals even within complex or hierarchical workflows. In practice, a reward function can therefore be a <strong>composite of multiple sources</strong>: <strong>rule-based rewards</strong>, scalar predictions from a <strong>learned, discriminative reward model</strong>, or a <strong>generative model</strong> that is  proficient at grading the task, such as an <strong>LLM-as-a-Judge</strong>.</p>\n<p>In general, <strong>rule-based rewards</strong> are preferred because they are <strong>deterministic, easy to verify, and resistant to reward hacking</strong>, consistent with the design principles demonstrated in the <a href=\"https://arxiv.org/abs/2501.12948\">DeepSeek-R1</a> framework by Gao et al. (2025). These rewards are derived from <strong>concrete, environment-observable events</strong>—such as file creation, DOM or AX tree changes, navigation completions, or dialog confirmations—and can be validated directly through structured logs and system hooks. Their reproducibility and transparency make them ideal for large-scale, self-contained policy optimization loops, where interpretability and auditability are crucial.</p>\n<p>In this system, the <strong>rule-based layer</strong> serves as the foundational signal generator for all common computer-use tasks. It captures events such as:</p>\n<ul>\n      <li>File downloads or artifact creation</li>\n      <li>Successful form submissions or dialog confirmations</li>\n      <li>UI transitions, window focus changes, or navigation completions</li>\n      <li>Text field population or data transfer between applications</li>\n      <li>\n        <p>Screenshot or state deltas indicating successful subgoal completion</p>\n      </li>\n      <li>These reward components directly populate the tuple <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-215-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>r</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3257\" style=\"width: 7.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.89em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3258\"><span class=\"mo\" id=\"MathJax-Span-3259\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3260\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3261\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3262\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3263\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3264\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3265\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3266\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3267\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3268\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3269\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3270\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3271\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3272\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3273\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3274\"><span class=\"mrow\" id=\"MathJax-Span-3275\"><span class=\"mi\" id=\"MathJax-Span-3276\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3277\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-3278\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3279\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>r</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-215\">(o_t, a_t, r_t, o_{t+1})</script> used by the policy optimizer for learning stable, interpretable control policies. Each milestone event contributes either a discrete tick or a weighted scalar toward cumulative progress.</li>\n    </ul>\n<p>Screenshot or state deltas indicating successful subgoal completion</p>\n<p>However, not all task goals can be described exhaustively through deterministic rules. To extend coverage, the architecture includes a <strong>learned reward model</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-216-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3280\" style=\"width: 7.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.89em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3281\"><span class=\"msubsup\" id=\"MathJax-Span-3282\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3283\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3284\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3285\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3286\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3287\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3288\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3289\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3290\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3291\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3292\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3293\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3294\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3295\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3296\"><span class=\"mrow\" id=\"MathJax-Span-3297\"><span class=\"mi\" id=\"MathJax-Span-3298\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3299\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-3300\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3301\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-216\">R_\\phi(o_t, a_t, o_{t+1})</script> trained specifically on <strong>human preferences or ranked trajectories</strong>.</p>\n<ul>\n      <li>This model generalizes beyond hand-engineered events to score <strong>semantic correctness, contextual relevance, and user-aligned outcomes</strong>.</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-217-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3302\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3303\"><span class=\"msubsup\" id=\"MathJax-Span-3304\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3305\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3306\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-217\">R_\\phi</script> can be continuously fine-tuned as new preference data accumulates, adapting reward shaping dynamically to novel workflows or unseen UIs.</li>\n      <li>\n        <p>During training, the optimizer consumes a blended reward signal that can combine multiple sources:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-218-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>r</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><mi>&amp;#x03B1;</mi><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>rule</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>+</mo><mi>&amp;#x03B2;</mi><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B3;</mi><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>judge</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3307\" style=\"width: 19.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1016.46em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3308\"><span class=\"msubsup\" id=\"MathJax-Span-3309\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3310\"><span class=\"mrow\" id=\"MathJax-Span-3311\"><span class=\"munderover\" id=\"MathJax-Span-3312\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3313\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3314\" style=\"font-family: STIXGeneral-Regular;\">̃&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-3315\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3316\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3317\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">α</span><span class=\"msubsup\" id=\"MathJax-Span-3318\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3319\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.67em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3320\"><span class=\"mrow\" id=\"MathJax-Span-3321\"><span class=\"mo\" id=\"MathJax-Span-3322\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3323\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">rule</span><span class=\"mo\" id=\"MathJax-Span-3324\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3325\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3326\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3327\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-3328\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3329\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3330\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3331\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3332\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3333\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3334\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3335\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3336\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3337\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3338\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3339\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3340\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3341\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3342\"><span class=\"mrow\" id=\"MathJax-Span-3343\"><span class=\"mi\" id=\"MathJax-Span-3344\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3345\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-3346\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3347\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3348\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3349\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-3350\"><span style=\"display: inline-block; position: relative; width: 2.607em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3351\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.14em, 4.326em, -999.997em); top: -4.529em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3352\"><span class=\"mrow\" id=\"MathJax-Span-3353\"><span class=\"mo\" id=\"MathJax-Span-3354\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3355\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">judge</span><span class=\"mo\" id=\"MathJax-Span-3356\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3357\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>r</mi><mo stretchy=\"false\">~</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><mi>α</mi><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>rule</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>+</mo><mi>β</mi><msub><mi>R</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mi>γ</mi><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>judge</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-218\">\\tilde{r}_t = \\alpha r_t^{(\\text{rule})} + \\beta R_\\phi(o_t, a_t, o_{t+1}) + \\gamma r_t^{(\\text{judge})}</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-219-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo>,</mo><mi>&amp;#x03B2;</mi><mo>,</mo><mi>&amp;#x03B3;</mi><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3358\" style=\"width: 7.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1005.89em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3359\"><span class=\"mi\" id=\"MathJax-Span-3360\" style=\"font-family: STIXGeneral-Italic;\">α</span><span class=\"mo\" id=\"MathJax-Span-3361\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3362\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3363\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3364\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3365\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"mo\" id=\"MathJax-Span-3366\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">[</span><span class=\"mn\" id=\"MathJax-Span-3367\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3368\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3369\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3370\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-219\">\\alpha, \\beta, \\gamma \\in [0,1]</script> represent trust weights for deterministic, learned, and model-evaluated components respectively, with <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-220-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo>+</mo><mi>&amp;#x03B2;</mi><mo>+</mo><mi>&amp;#x03B3;</mi><mo>=</mo><mn>1</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3371\" style=\"width: 6.773em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3372\"><span class=\"mi\" id=\"MathJax-Span-3373\" style=\"font-family: STIXGeneral-Italic;\">α</span><span class=\"mo\" id=\"MathJax-Span-3374\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3375\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3376\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3377\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3378\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-3379\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>α</mi><mo>+</mo><mi>β</mi><mo>+</mo><mi>γ</mi><mo>=</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-220\">\\alpha + \\beta + \\gamma = 1</script>.</li>\n        </ul>\n      </li>\n    </ul>\n<p>During training, the optimizer consumes a blended reward signal that can combine multiple sources:</p>\n<ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-219-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo>,</mo><mi>&amp;#x03B2;</mi><mo>,</mo><mi>&amp;#x03B3;</mi><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3358\" style=\"width: 7.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1005.89em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3359\"><span class=\"mi\" id=\"MathJax-Span-3360\" style=\"font-family: STIXGeneral-Italic;\">α</span><span class=\"mo\" id=\"MathJax-Span-3361\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3362\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3363\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3364\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3365\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"mo\" id=\"MathJax-Span-3366\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">[</span><span class=\"mn\" id=\"MathJax-Span-3367\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3368\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3369\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3370\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-219\">\\alpha, \\beta, \\gamma \\in [0,1]</script> represent trust weights for deterministic, learned, and model-evaluated components respectively, with <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-220-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo>+</mo><mi>&amp;#x03B2;</mi><mo>+</mo><mi>&amp;#x03B3;</mi><mo>=</mo><mn>1</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3371\" style=\"width: 6.773em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3372\"><span class=\"mi\" id=\"MathJax-Span-3373\" style=\"font-family: STIXGeneral-Italic;\">α</span><span class=\"mo\" id=\"MathJax-Span-3374\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3375\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3376\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3377\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3378\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-3379\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>α</mi><mo>+</mo><mi>β</mi><mo>+</mo><mi>γ</mi><mo>=</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-220\">\\alpha + \\beta + \\gamma = 1</script>.</li>\n        </ul>\n<p>In cases where both rule-based detectors and the learned reward model fail to provide a confident or interpretable score, a <strong>generative model (such as an LLM-as-a-Judge)</strong> may be selectively invoked. This verifier acts as a high-capacity, <em>LLM-as-a-Judge</em> module that semantically evaluates whether the observed trajectory satisfies implicit or fuzzy success criteria. Its role parallels that of a preference model but operates at runtime for difficult or open-ended cases.</p>\n<p>Scenarios where rule-based and model-based scoring may be insufficient—and thus require a Verifier Agent—include:</p>\n<ul>\n      <li><strong>Subjective or semantic correctness:</strong> determining if a written summary or chart interpretation matches the instruction intent.</li>\n      <li><strong>Cross-context validation:</strong> verifying that data copied from a spreadsheet was correctly inserted into a report or email draft.</li>\n      <li><strong>Goal inference under ambiguity:</strong> tasks like “open the latest invoice,” where the target must be inferred dynamically.</li>\n      <li><strong>Complex recovery handling:</strong> identifying whether the system has correctly recovered from an unintended dialog or misclick.</li>\n      <li><strong>Language or multimodal alignment:</strong> verifying tone, structure, or layout across applications.</li>\n    </ul>\n<p>The <strong>reward system hierarchy</strong> therefore consists of three complementary and optionally composable layers:</p>\n<ol>\n      <li>\n        <p><strong>Rule-based rewards</strong>: deterministic, verifiable, and fully auditable signals derived from concrete milestones (default and preferred).</p>\n      </li>\n      <li>\n        <p><strong>Learned, discriminative reward model (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-221-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3380\" style=\"width: 1.397em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.139em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.294em, 1001.14em, 2.585em, -999.997em); top: -2.115em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3381\"><span class=\"msubsup\" id=\"MathJax-Span-3382\"><span style=\"display: inline-block; position: relative; width: 1.139em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.153em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3383\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span><span style=\"position: absolute; top: -3.82em; left: 0.622em;\"><span class=\"mi\" id=\"MathJax-Span-3384\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.12em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-221\">R_\\phi</script>)</strong>: trained on human preferences to generalize beyond explicit rules and produce scalar feedback for unstructured tasks.</p>\n      </li>\n      <li>\n        <p><strong>Generative reward model (e.g., LLM-as-a-Judge)</strong>: semantic fallback for nuanced, subjective, or multimodal evaluation where neither rules nor learned models suffice. This is similar to how <a href=\"../deepseek-R1\">DeepSeek-R1</a> uses a generative reward model by feeding the ground-truth and model predictions into DeepSeek-V3 for judgment during the rejection sampling stage for reasoning data.</p>\n      </li>\n    </ol>\n<p><strong>Rule-based rewards</strong>: deterministic, verifiable, and fully auditable signals derived from concrete milestones (default and preferred).</p>\n<p><strong>Learned, discriminative reward model (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-221-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3380\" style=\"width: 1.397em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.139em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.294em, 1001.14em, 2.585em, -999.997em); top: -2.115em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3381\"><span class=\"msubsup\" id=\"MathJax-Span-3382\"><span style=\"display: inline-block; position: relative; width: 1.139em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.153em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3383\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span><span style=\"position: absolute; top: -3.82em; left: 0.622em;\"><span class=\"mi\" id=\"MathJax-Span-3384\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.12em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-221\">R_\\phi</script>)</strong>: trained on human preferences to generalize beyond explicit rules and produce scalar feedback for unstructured tasks.</p>\n<p><strong>Generative reward model (e.g., LLM-as-a-Judge)</strong>: semantic fallback for nuanced, subjective, or multimodal evaluation where neither rules nor learned models suffice. This is similar to how <a href=\"../deepseek-R1\">DeepSeek-R1</a> uses a generative reward model by feeding the ground-truth and model predictions into DeepSeek-V3 for judgment during the rejection sampling stage for reasoning data.</p>\n<p>Together, these layers enable <strong>robust, explainable, and modular reward shaping</strong>. Any reward function within the system can thus be expressed as a <strong>milestone-weighted combination</strong> of deterministic, learned, and interpretive components—ensuring scalability, transparency, and semantic alignment across all computer-use reinforcement learning setups.</p>\n<h5 id=\"example-milestones-by-task-category\">Example Milestones by Task Category</h5>\n<ol>\n  <li>\n    <p><strong>Web Navigation and Data Extraction</strong></p>\n\n    <ul>\n      <li><strong>Milestone:</strong> Target URL loaded successfully (<code class=\"language-plaintext highlighter-rouge\">NavigationCompleted</code> event).\n<em>Reward:</em> +0.25</li>\n      <li><strong>Milestone:</strong> Element with specific role/name detected (e.g., “Reports Table” or “Dashboard Summary”).\n<em>Reward:</em> +0.25</li>\n      <li><strong>Milestone:</strong> Successful data scrape or DOM text retrieval logged.\n<em>Reward:</em> +0.5</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Form Interaction</strong></p>\n\n    <ul>\n      <li><strong>Milestone:</strong> Input field focused and filled (text pattern matched).\n<em>Reward:</em> +0.2</li>\n      <li><strong>Milestone:</strong> Submit button clicked and confirmation dialog appears.\n<em>Reward:</em> +0.3</li>\n      <li><strong>Milestone:</strong> Success banner or confirmation element detected.\n<em>Reward:</em> +0.5</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>File Handling and Downloads</strong></p>\n\n    <ul>\n      <li><strong>Milestone:</strong> File creation event observed in <code class=\"language-plaintext highlighter-rouge\">/Downloads</code>.\n<em>Reward:</em> +1.0</li>\n      <li><strong>Milestone:</strong> File hash or extension matches expectation (e.g., <code class=\"language-plaintext highlighter-rouge\">.csv</code>, <code class=\"language-plaintext highlighter-rouge\">.pdf</code>).\n<em>Reward:</em> +0.5</li>\n      <li><strong>Milestone:</strong> Directory updated without error.\n<em>Reward:</em> +0.25</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Email or Document Workflows</strong></p>\n\n    <ul>\n      <li><strong>Milestone:</strong> Email editor loaded and populated with recipient and subject.\n<em>Reward:</em> +0.25</li>\n      <li><strong>Milestone:</strong> Attachment successfully added.\n<em>Reward:</em> +0.5</li>\n      <li><strong>Milestone:</strong> Message successfully sent (UI confirmation or state change).\n<em>Reward:</em> +1.0</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>System Configuration and Settings</strong></p>\n\n    <ul>\n      <li><strong>Milestone:</strong> Settings panel opened (window title match).\n<em>Reward:</em> +0.25</li>\n      <li><strong>Milestone:</strong> Checkbox or toggle successfully modified (UIA/AX event).\n<em>Reward:</em> +0.25</li>\n      <li><strong>Milestone:</strong> “Changes Saved” notification observed.\n<em>Reward:</em> +0.5</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Search and Information Retrieval</strong></p>\n\n    <ul>\n      <li><strong>Milestone:</strong> Query field populated with correct term.\n<em>Reward:</em> +0.25</li>\n      <li><strong>Milestone:</strong> Search executed and result list rendered.\n<em>Reward:</em> +0.5</li>\n      <li><strong>Milestone:</strong> Target entry clicked or opened.\n<em>Reward:</em> +0.5</li>\n    </ul>\n  </li>\n</ol>\n<p><strong>Web Navigation and Data Extraction</strong></p>\n<ul>\n      <li><strong>Milestone:</strong> Target URL loaded successfully (<code class=\"language-plaintext highlighter-rouge\">NavigationCompleted</code> event).\n<em>Reward:</em> +0.25</li>\n      <li><strong>Milestone:</strong> Element with specific role/name detected (e.g., “Reports Table” or “Dashboard Summary”).\n<em>Reward:</em> +0.25</li>\n      <li><strong>Milestone:</strong> Successful data scrape or DOM text retrieval logged.\n<em>Reward:</em> +0.5</li>\n    </ul>\n<p><strong>Form Interaction</strong></p>\n<ul>\n      <li><strong>Milestone:</strong> Input field focused and filled (text pattern matched).\n<em>Reward:</em> +0.2</li>\n      <li><strong>Milestone:</strong> Submit button clicked and confirmation dialog appears.\n<em>Reward:</em> +0.3</li>\n      <li><strong>Milestone:</strong> Success banner or confirmation element detected.\n<em>Reward:</em> +0.5</li>\n    </ul>\n<p><strong>File Handling and Downloads</strong></p>\n<ul>\n      <li><strong>Milestone:</strong> File creation event observed in <code class=\"language-plaintext highlighter-rouge\">/Downloads</code>.\n<em>Reward:</em> +1.0</li>\n      <li><strong>Milestone:</strong> File hash or extension matches expectation (e.g., <code class=\"language-plaintext highlighter-rouge\">.csv</code>, <code class=\"language-plaintext highlighter-rouge\">.pdf</code>).\n<em>Reward:</em> +0.5</li>\n      <li><strong>Milestone:</strong> Directory updated without error.\n<em>Reward:</em> +0.25</li>\n    </ul>\n<p><strong>Email or Document Workflows</strong></p>\n<ul>\n      <li><strong>Milestone:</strong> Email editor loaded and populated with recipient and subject.\n<em>Reward:</em> +0.25</li>\n      <li><strong>Milestone:</strong> Attachment successfully added.\n<em>Reward:</em> +0.5</li>\n      <li><strong>Milestone:</strong> Message successfully sent (UI confirmation or state change).\n<em>Reward:</em> +1.0</li>\n    </ul>\n<p><strong>System Configuration and Settings</strong></p>\n<ul>\n      <li><strong>Milestone:</strong> Settings panel opened (window title match).\n<em>Reward:</em> +0.25</li>\n      <li><strong>Milestone:</strong> Checkbox or toggle successfully modified (UIA/AX event).\n<em>Reward:</em> +0.25</li>\n      <li><strong>Milestone:</strong> “Changes Saved” notification observed.\n<em>Reward:</em> +0.5</li>\n    </ul>\n<p><strong>Search and Information Retrieval</strong></p>\n<ul>\n      <li><strong>Milestone:</strong> Query field populated with correct term.\n<em>Reward:</em> +0.25</li>\n      <li><strong>Milestone:</strong> Search executed and result list rendered.\n<em>Reward:</em> +0.5</li>\n      <li><strong>Milestone:</strong> Target entry clicked or opened.\n<em>Reward:</em> +0.5</li>\n    </ul>\n<h4 id=\"example-reward-function\">Example Reward Function</h4>\n<ul>\n  <li>\n    <p>Each environment step returns a shaped reward based on concrete, verifiable milestones. Instead of relying on subjective evaluators, the reward function is composed of measurable subcomponents derived from observable state transitions, UI changes, and artifact events.</p>\n  </li>\n  <li>\n    <p>At step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-222-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3385\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3386\"><span class=\"mi\" id=\"MathJax-Span-3387\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-222\">t</script>, the total reward is given by:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-223-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>nav</mtext></mrow></msub><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>nav</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>+</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>UI</mtext></mrow></msub><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>UI</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>+</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>form</mtext></mrow></msub><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>form</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>+</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>file</mtext></mrow></msub><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>file</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>+</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>goal</mtext></mrow></msub><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>goal</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3388\" style=\"width: 30.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 25.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1025.73em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3389\"><span class=\"msubsup\" id=\"MathJax-Span-3390\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3391\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3392\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3393\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3394\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3395\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3396\"><span class=\"mrow\" id=\"MathJax-Span-3397\"><span class=\"mtext\" id=\"MathJax-Span-3398\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">nav</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3399\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3400\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.57em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3401\"><span class=\"mrow\" id=\"MathJax-Span-3402\"><span class=\"mo\" id=\"MathJax-Span-3403\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3404\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">nav</span><span class=\"mo\" id=\"MathJax-Span-3405\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3406\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3407\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-3408\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3409\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3410\"><span class=\"mrow\" id=\"MathJax-Span-3411\"><span class=\"mtext\" id=\"MathJax-Span-3412\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">UI</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3413\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3414\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.3em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3415\"><span class=\"mrow\" id=\"MathJax-Span-3416\"><span class=\"mo\" id=\"MathJax-Span-3417\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3418\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">UI</span><span class=\"mo\" id=\"MathJax-Span-3419\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3420\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3421\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-3422\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3423\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3424\"><span class=\"mrow\" id=\"MathJax-Span-3425\"><span class=\"mtext\" id=\"MathJax-Span-3426\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">form</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3427\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3428\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.93em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3429\"><span class=\"mrow\" id=\"MathJax-Span-3430\"><span class=\"mo\" id=\"MathJax-Span-3431\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3432\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">form</span><span class=\"mo\" id=\"MathJax-Span-3433\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3434\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3435\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-3436\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3437\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3438\"><span class=\"mrow\" id=\"MathJax-Span-3439\"><span class=\"mtext\" id=\"MathJax-Span-3440\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">file</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3441\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3442\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.51em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3443\"><span class=\"mrow\" id=\"MathJax-Span-3444\"><span class=\"mo\" id=\"MathJax-Span-3445\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3446\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">file</span><span class=\"mo\" id=\"MathJax-Span-3447\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3448\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3449\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-3450\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3451\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3452\"><span class=\"mrow\" id=\"MathJax-Span-3453\"><span class=\"mtext\" id=\"MathJax-Span-3454\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">goal</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3455\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3456\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.77em, 4.326em, -999.997em); top: -4.529em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3457\"><span class=\"mrow\" id=\"MathJax-Span-3458\"><span class=\"mo\" id=\"MathJax-Span-3459\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3460\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">goal</span><span class=\"mo\" id=\"MathJax-Span-3461\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3462\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>nav</mtext></mrow></msub><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>nav</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>+</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>UI</mtext></mrow></msub><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>UI</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>+</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>form</mtext></mrow></msub><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>form</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>+</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>file</mtext></mrow></msub><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>file</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>+</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>goal</mtext></mrow></msub><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>goal</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-223\">r_t = w_{\\text{nav}} r_t^{(\\text{nav})} + w_{\\text{UI}} r_t^{(\\text{UI})} + w_{\\text{form}} r_t^{(\\text{form})} + w_{\\text{file}} r_t^{(\\text{file})} + w_{\\text{goal}} r_t^{(\\text{goal})}</script>\n\n    <ul>\n      <li>where each component represents a verifiable milestone type:</li>\n    </ul>\n  </li>\n  <li>\n    <p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-224-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>nav</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3463\" style=\"width: 2.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1002.03em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3464\"><span class=\"msubsup\" id=\"MathJax-Span-3465\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3466\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.57em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3467\"><span class=\"mrow\" id=\"MathJax-Span-3468\"><span class=\"mo\" id=\"MathJax-Span-3469\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3470\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">nav</span><span class=\"mo\" id=\"MathJax-Span-3471\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3472\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>nav</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-224\">r_t^{(\\text{nav})}</script>: Navigation progress reward — triggered by measurable page transitions such as <code class=\"language-plaintext highlighter-rouge\">NavigationCompleted</code> events, URL match, or window title change.</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-225-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>nav</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;double-struck&quot;>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><msub><mtext>url</mtext><mi>t</mi></msub><mo>&amp;#x2260;</mo><msub><mtext>url</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3473\" style=\"width: 11.357em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.43em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1009.33em, 2.763em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3474\"><span class=\"msubsup\" id=\"MathJax-Span-3475\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3476\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.57em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3477\"><span class=\"mrow\" id=\"MathJax-Span-3478\"><span class=\"mo\" id=\"MathJax-Span-3479\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3480\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">nav</span><span class=\"mo\" id=\"MathJax-Span-3481\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3482\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3483\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-3484\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-3485\"><span class=\"mn\" id=\"MathJax-Span-3486\" style=\"font-family: STIXGeneral-Regular;\">𝟙</span></span></span><span class=\"texatom\" id=\"MathJax-Span-3487\"><span class=\"mrow\" id=\"MathJax-Span-3488\"><span class=\"mo\" id=\"MathJax-Span-3489\" style=\"font-family: STIXGeneral-Regular;\">{</span><span class=\"msubsup\" id=\"MathJax-Span-3490\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1001.1em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-3491\" style=\"font-family: STIXGeneral-Regular;\">url</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.096em;\"><span class=\"mi\" id=\"MathJax-Span-3492\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3493\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">≠</span><span class=\"msubsup\" id=\"MathJax-Span-3494\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1001.1em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-3495\" style=\"font-family: STIXGeneral-Regular;\">url</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.096em;\"><span class=\"texatom\" id=\"MathJax-Span-3496\"><span class=\"mrow\" id=\"MathJax-Span-3497\"><span class=\"mi\" id=\"MathJax-Span-3498\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3499\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-3500\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3501\" style=\"font-family: STIXGeneral-Regular;\">}</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>nav</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mn mathvariant=\"double-struck\">1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo fence=\"false\" stretchy=\"false\">{</mo><msub><mtext>url</mtext><mi>t</mi></msub><mo>≠</mo><msub><mtext>url</mtext><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo fence=\"false\" stretchy=\"false\">}</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-225\">r_t^{(\\text{nav})} = \\mathbb{1}{\\{\\text{url}_t \\neq \\text{url}_{t-1}\\}}</script>\n  </li>\n  <li>\n    <p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-226-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>UI</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3502\" style=\"width: 2.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.77em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3503\"><span class=\"msubsup\" id=\"MathJax-Span-3504\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3505\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.3em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3506\"><span class=\"mrow\" id=\"MathJax-Span-3507\"><span class=\"mo\" id=\"MathJax-Span-3508\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3509\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">UI</span><span class=\"mo\" id=\"MathJax-Span-3510\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3511\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>UI</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-226\">r_t^{(\\text{UI})}</script>: UI element interaction reward — triggered when a UI control with a matching role or label is successfully targeted (e.g., a button click or field focus event).</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-227-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>UI</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;double-struck&quot;>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mtext>clicked(role,name)</mtext><mo>=</mo><mtext>expected(role,name)</mtext></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3512\" style=\"width: 24.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1020.73em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3513\"><span class=\"msubsup\" id=\"MathJax-Span-3514\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3515\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.3em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3516\"><span class=\"mrow\" id=\"MathJax-Span-3517\"><span class=\"mo\" id=\"MathJax-Span-3518\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3519\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">UI</span><span class=\"mo\" id=\"MathJax-Span-3520\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3521\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3522\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-3523\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-3524\"><span class=\"mn\" id=\"MathJax-Span-3525\" style=\"font-family: STIXGeneral-Regular;\">𝟙</span></span></span><span class=\"texatom\" id=\"MathJax-Span-3526\"><span class=\"mrow\" id=\"MathJax-Span-3527\"><span class=\"mo\" id=\"MathJax-Span-3528\" style=\"font-family: STIXGeneral-Regular;\">{</span><span class=\"mtext\" id=\"MathJax-Span-3529\" style=\"font-family: STIXGeneral-Regular;\">clicked(role,name)</span><span class=\"mo\" id=\"MathJax-Span-3530\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mtext\" id=\"MathJax-Span-3531\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">expected(role,name)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>UI</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mn mathvariant=\"double-struck\">1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo fence=\"false\" stretchy=\"false\">{</mo><mtext>clicked(role,name)</mtext><mo>=</mo><mtext>expected(role,name)</mtext></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-227\">r_t^{(\\text{UI})} = \\mathbb{1}{\\{\\text{clicked(role,name)} = \\text{expected(role,name)}}</script>\n  </li>\n  <li>\n    <p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-228-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>form</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3532\" style=\"width: 2.919em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1002.4em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3533\"><span class=\"msubsup\" id=\"MathJax-Span-3534\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3535\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.93em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3536\"><span class=\"mrow\" id=\"MathJax-Span-3537\"><span class=\"mo\" id=\"MathJax-Span-3538\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3539\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">form</span><span class=\"mo\" id=\"MathJax-Span-3540\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3541\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>form</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-228\">r_t^{(\\text{form})}</script>: Form completion reward — triggered when an editable control is filled and validated (value non-empty, regex match, or field count).</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-229-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>form</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>=</mo><mfrac><msub><mi>N</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>filled</mtext></mrow></msub><msub><mi>N</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>expected</mtext></mrow></msub></mfrac></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3542\" style=\"width: 8.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.68em, 1007.19em, 3.336em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3543\"><span class=\"msubsup\" id=\"MathJax-Span-3544\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3545\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.93em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3546\"><span class=\"mrow\" id=\"MathJax-Span-3547\"><span class=\"mo\" id=\"MathJax-Span-3548\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3549\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">form</span><span class=\"mo\" id=\"MathJax-Span-3550\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3551\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3552\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-3553\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.388em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1002.24em, 4.326em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.091em;\"><span class=\"msubsup\" id=\"MathJax-Span-3554\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3555\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3556\"><span class=\"mrow\" id=\"MathJax-Span-3557\"><span class=\"mtext\" id=\"MathJax-Span-3558\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">filled</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.23em, 4.482em, -999.997em); top: -3.331em; left: 50%; margin-left: -1.612em;\"><span class=\"msubsup\" id=\"MathJax-Span-3559\"><span style=\"display: inline-block; position: relative; width: 3.232em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3560\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3561\"><span class=\"mrow\" id=\"MathJax-Span-3562\"><span class=\"mtext\" id=\"MathJax-Span-3563\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">expected</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.39em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.388em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 2.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>form</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><mfrac><msub><mi>N</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>filled</mtext></mrow></msub><msub><mi>N</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>expected</mtext></mrow></msub></mfrac></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-229\">r_t^{(\\text{form})} = \\frac{N_{\\text{filled}}}{N_{\\text{expected}}}</script>\n  </li>\n  <li>\n    <p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-230-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>file</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3564\" style=\"width: 2.398em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.98em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3565\"><span class=\"msubsup\" id=\"MathJax-Span-3566\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3567\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.51em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3568\"><span class=\"mrow\" id=\"MathJax-Span-3569\"><span class=\"mo\" id=\"MathJax-Span-3570\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3571\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">file</span><span class=\"mo\" id=\"MathJax-Span-3572\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3573\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>file</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-230\">r_t^{(\\text{file})}</script>: File-handling reward — derived from filesystem or artifact deltas (e.g., a new <code class=\"language-plaintext highlighter-rouge\">.csv</code>, <code class=\"language-plaintext highlighter-rouge\">.pdf</code>, or <code class=\"language-plaintext highlighter-rouge\">.json</code> created).</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-231-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>file</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;double-struck&quot;>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mi mathvariant=&quot;normal&quot;>&amp;#x2203;</mi><mi>f</mi><mo>&amp;#x2208;</mo><msub><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo>:</mo><mi>f</mi><mo>.</mo><mtext>event</mtext><mo>=</mo><mtext>''created&amp;quot;</mtext><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3574\" style=\"width: 19.846em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1016.41em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3575\"><span class=\"msubsup\" id=\"MathJax-Span-3576\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3577\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.51em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3578\"><span class=\"mrow\" id=\"MathJax-Span-3579\"><span class=\"mo\" id=\"MathJax-Span-3580\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3581\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">file</span><span class=\"mo\" id=\"MathJax-Span-3582\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3583\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3584\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-3585\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-3586\"><span class=\"mn\" id=\"MathJax-Span-3587\" style=\"font-family: STIXGeneral-Regular;\">𝟙</span></span></span><span class=\"texatom\" id=\"MathJax-Span-3588\"><span class=\"mrow\" id=\"MathJax-Span-3589\"><span class=\"mo\" id=\"MathJax-Span-3590\" style=\"font-family: STIXGeneral-Regular;\">{</span><span class=\"mi\" id=\"MathJax-Span-3591\" style=\"font-family: STIXGeneral-Regular;\">∃</span><span class=\"mi\" id=\"MathJax-Span-3592\" style=\"font-family: STIXGeneral-Italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3593\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"msubsup\" id=\"MathJax-Span-3594\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3595\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3596\"><span class=\"mrow\" id=\"MathJax-Span-3597\"><span class=\"mi\" id=\"MathJax-Span-3598\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3599\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">:</span><span class=\"mi\" id=\"MathJax-Span-3600\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3601\" style=\"font-family: STIXGeneral-Regular;\">.</span><span class=\"mtext\" id=\"MathJax-Span-3602\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">event</span><span class=\"mo\" id=\"MathJax-Span-3603\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mtext\" id=\"MathJax-Span-3604\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">''created\"</span><span class=\"mo\" id=\"MathJax-Span-3605\" style=\"font-family: STIXGeneral-Regular;\">}</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>file</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mn mathvariant=\"double-struck\">1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo fence=\"false\" stretchy=\"false\">{</mo><mi mathvariant=\"normal\">∃</mi><mi>f</mi><mo>∈</mo><msub><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi></mrow></msub><mo>:</mo><mi>f</mi><mo>.</mo><mtext>event</mtext><mo>=</mo><mtext>''created\"</mtext><mo fence=\"false\" stretchy=\"false\">}</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-231\">r_t^{(\\text{file})} = \\mathbb{1}{\\{\\exists f \\in A_{t}: f.\\text{event} = \\text{''created\"}\\}}</script>\n  </li>\n  <li>\n    <p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-232-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>goal</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3606\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.992em, 1002.24em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3607\"><span class=\"msubsup\" id=\"MathJax-Span-3608\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3609\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.77em, 4.326em, -999.997em); top: -4.529em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3610\"><span class=\"mrow\" id=\"MathJax-Span-3611\"><span class=\"mo\" id=\"MathJax-Span-3612\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3613\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">goal</span><span class=\"mo\" id=\"MathJax-Span-3614\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3615\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>goal</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-232\">r_t^{(\\text{goal})}</script>: Task completion reward — triggered by a high-level terminal condition, such as detection of success text, matched hash, or closed loop condition.</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-233-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>goal</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;double-struck&quot;>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mtext>goal_verified</mtext><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3616\" style=\"width: 13.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1011.41em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3617\"><span class=\"msubsup\" id=\"MathJax-Span-3618\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3619\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.77em, 4.326em, -999.997em); top: -4.529em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3620\"><span class=\"mrow\" id=\"MathJax-Span-3621\"><span class=\"mo\" id=\"MathJax-Span-3622\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3623\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">goal</span><span class=\"mo\" id=\"MathJax-Span-3624\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3625\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3626\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-3627\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-3628\"><span class=\"mn\" id=\"MathJax-Span-3629\" style=\"font-family: STIXGeneral-Regular;\">𝟙</span></span></span><span class=\"texatom\" id=\"MathJax-Span-3630\"><span class=\"mrow\" id=\"MathJax-Span-3631\"><span class=\"mo\" id=\"MathJax-Span-3632\" style=\"font-family: STIXGeneral-Regular;\">{</span><span class=\"mtext\" id=\"MathJax-Span-3633\" style=\"font-family: STIXGeneral-Regular;\">goal_verified</span><span class=\"mo\" id=\"MathJax-Span-3634\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3635\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3636\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3637\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3638\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3639\" style=\"font-family: STIXGeneral-Regular;\">}</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>goal</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mn mathvariant=\"double-struck\">1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo fence=\"false\" stretchy=\"false\">{</mo><mtext>goal_verified</mtext><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo fence=\"false\" stretchy=\"false\">}</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-233\">r_t^{(\\text{goal})} = \\mathbb{1}{\\{\\text{goal_verified}(o_t)\\}}</script>\n  </li>\n  <li>\n    <p>The weights <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-234-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>nav</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>UI</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>form</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>file</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>goal</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3640\" style=\"width: 13.128em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1010.94em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3641\"><span class=\"msubsup\" id=\"MathJax-Span-3642\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3643\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3644\"><span class=\"mrow\" id=\"MathJax-Span-3645\"><span class=\"mtext\" id=\"MathJax-Span-3646\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">nav</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3647\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3648\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3649\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3650\"><span class=\"mrow\" id=\"MathJax-Span-3651\"><span class=\"mtext\" id=\"MathJax-Span-3652\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">UI</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3653\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3654\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3655\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3656\"><span class=\"mrow\" id=\"MathJax-Span-3657\"><span class=\"mtext\" id=\"MathJax-Span-3658\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">form</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3659\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3660\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3661\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3662\"><span class=\"mrow\" id=\"MathJax-Span-3663\"><span class=\"mtext\" id=\"MathJax-Span-3664\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">file</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3665\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3666\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3667\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3668\"><span class=\"mrow\" id=\"MathJax-Span-3669\"><span class=\"mtext\" id=\"MathJax-Span-3670\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">goal</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>nav</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>UI</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>form</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>file</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>goal</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-234\">w_{\\text{nav}}, w_{\\text{UI}}, w_{\\text{form}}, w_{\\text{file}}, w_{\\text{goal}}</script> balance short-term shaping with terminal rewards, typically normalized so that:</p>\n  </li>\n</ul>\n<p>Each environment step returns a shaped reward based on concrete, verifiable milestones. Instead of relying on subjective evaluators, the reward function is composed of measurable subcomponents derived from observable state transitions, UI changes, and artifact events.</p>\n<p>At step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-222-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3385\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3386\"><span class=\"mi\" id=\"MathJax-Span-3387\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-222\">t</script>, the total reward is given by:</p>\n<ul>\n      <li>where each component represents a verifiable milestone type:</li>\n    </ul>\n<p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-224-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>nav</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3463\" style=\"width: 2.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1002.03em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3464\"><span class=\"msubsup\" id=\"MathJax-Span-3465\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3466\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.57em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3467\"><span class=\"mrow\" id=\"MathJax-Span-3468\"><span class=\"mo\" id=\"MathJax-Span-3469\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3470\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">nav</span><span class=\"mo\" id=\"MathJax-Span-3471\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3472\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>nav</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-224\">r_t^{(\\text{nav})}</script>: Navigation progress reward — triggered by measurable page transitions such as <code class=\"language-plaintext highlighter-rouge\">NavigationCompleted</code> events, URL match, or window title change.</p>\n<p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-226-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>UI</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3502\" style=\"width: 2.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.77em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3503\"><span class=\"msubsup\" id=\"MathJax-Span-3504\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3505\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.3em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3506\"><span class=\"mrow\" id=\"MathJax-Span-3507\"><span class=\"mo\" id=\"MathJax-Span-3508\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3509\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">UI</span><span class=\"mo\" id=\"MathJax-Span-3510\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3511\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>UI</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-226\">r_t^{(\\text{UI})}</script>: UI element interaction reward — triggered when a UI control with a matching role or label is successfully targeted (e.g., a button click or field focus event).</p>\n<p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-228-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>form</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3532\" style=\"width: 2.919em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1002.4em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3533\"><span class=\"msubsup\" id=\"MathJax-Span-3534\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3535\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.93em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3536\"><span class=\"mrow\" id=\"MathJax-Span-3537\"><span class=\"mo\" id=\"MathJax-Span-3538\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3539\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">form</span><span class=\"mo\" id=\"MathJax-Span-3540\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3541\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>form</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-228\">r_t^{(\\text{form})}</script>: Form completion reward — triggered when an editable control is filled and validated (value non-empty, regex match, or field count).</p>\n<p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-230-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>file</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3564\" style=\"width: 2.398em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.98em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3565\"><span class=\"msubsup\" id=\"MathJax-Span-3566\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3567\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.51em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3568\"><span class=\"mrow\" id=\"MathJax-Span-3569\"><span class=\"mo\" id=\"MathJax-Span-3570\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3571\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">file</span><span class=\"mo\" id=\"MathJax-Span-3572\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3573\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>file</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-230\">r_t^{(\\text{file})}</script>: File-handling reward — derived from filesystem or artifact deltas (e.g., a new <code class=\"language-plaintext highlighter-rouge\">.csv</code>, <code class=\"language-plaintext highlighter-rouge\">.pdf</code>, or <code class=\"language-plaintext highlighter-rouge\">.json</code> created).</p>\n<p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-232-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>goal</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3606\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.992em, 1002.24em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3607\"><span class=\"msubsup\" id=\"MathJax-Span-3608\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3609\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.77em, 4.326em, -999.997em); top: -4.529em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3610\"><span class=\"mrow\" id=\"MathJax-Span-3611\"><span class=\"mo\" id=\"MathJax-Span-3612\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3613\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">goal</span><span class=\"mo\" id=\"MathJax-Span-3614\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3615\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>goal</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-232\">r_t^{(\\text{goal})}</script>: Task completion reward — triggered by a high-level terminal condition, such as detection of success text, matched hash, or closed loop condition.</p>\n<p>The weights <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-234-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>nav</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>UI</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>form</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>file</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>goal</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3640\" style=\"width: 13.128em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1010.94em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3641\"><span class=\"msubsup\" id=\"MathJax-Span-3642\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3643\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3644\"><span class=\"mrow\" id=\"MathJax-Span-3645\"><span class=\"mtext\" id=\"MathJax-Span-3646\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">nav</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3647\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3648\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3649\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3650\"><span class=\"mrow\" id=\"MathJax-Span-3651\"><span class=\"mtext\" id=\"MathJax-Span-3652\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">UI</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3653\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3654\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3655\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3656\"><span class=\"mrow\" id=\"MathJax-Span-3657\"><span class=\"mtext\" id=\"MathJax-Span-3658\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">form</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3659\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3660\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3661\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3662\"><span class=\"mrow\" id=\"MathJax-Span-3663\"><span class=\"mtext\" id=\"MathJax-Span-3664\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">file</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3665\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3666\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3667\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3668\"><span class=\"mrow\" id=\"MathJax-Span-3669\"><span class=\"mtext\" id=\"MathJax-Span-3670\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">goal</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>nav</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>UI</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>form</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>file</mtext></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>goal</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-234\">w_{\\text{nav}}, w_{\\text{UI}}, w_{\\text{form}}, w_{\\text{file}}, w_{\\text{goal}}</script> balance short-term shaping with terminal rewards, typically normalized so that:</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-235-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><munder><mo>&amp;#x2211;</mo><mi>i</mi></munder><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>goal</mtext></mrow></msub><mo>&amp;#x2265;</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>file</mtext></mrow></msub><mo>&amp;#x2265;</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>UI</mtext></mrow></msub><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3671\" style=\"width: 15.211em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1012.55em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3672\"><span class=\"munderover\" id=\"MathJax-Span-3673\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3674\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.576em;\"><span class=\"mi\" id=\"MathJax-Span-3675\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3676\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3677\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-3678\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3679\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-3680\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3681\" style=\"font-family: STIXGeneral-Regular;\">{</span><span class=\"msubsup\" id=\"MathJax-Span-3682\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3683\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3684\"><span class=\"mrow\" id=\"MathJax-Span-3685\"><span class=\"mtext\" id=\"MathJax-Span-3686\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">goal</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3687\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">≥</span><span class=\"msubsup\" id=\"MathJax-Span-3688\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3689\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3690\"><span class=\"mrow\" id=\"MathJax-Span-3691\"><span class=\"mtext\" id=\"MathJax-Span-3692\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">file</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3693\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">≥</span><span class=\"msubsup\" id=\"MathJax-Span-3694\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3695\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3696\"><span class=\"mrow\" id=\"MathJax-Span-3697\"><span class=\"mtext\" id=\"MathJax-Span-3698\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">UI</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3699\" style=\"font-family: STIXGeneral-Regular;\">}</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo fence=\"false\" stretchy=\"false\">{</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>goal</mtext></mrow></msub><mo>≥</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>file</mtext></mrow></msub><mo>≥</mo><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>UI</mtext></mrow></msub><mo fence=\"false\" stretchy=\"false\">}</mo></math></span></span></div>\n<h4 id=\"example-instantiation\">Example Instantiation</h4>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Component</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Description</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Weight</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Range</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-236-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>nav</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3700\" style=\"width: 2.443em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.027em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.074em, 1002.03em, 2.622em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3701\"><span class=\"msubsup\" id=\"MathJax-Span-3702\"><span style=\"display: inline-block; position: relative; width: 2.027em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3703\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1001.55em, 4.289em, -999.997em); top: -4.461em; left: 0.479em;\"><span class=\"texatom\" id=\"MathJax-Span-3704\"><span class=\"mrow\" id=\"MathJax-Span-3705\"><span class=\"mo\" id=\"MathJax-Span-3706\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3707\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">nav</span><span class=\"mo\" id=\"MathJax-Span-3708\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.455em, 1000.3em, 4.17em, -999.997em); top: -3.747em; left: 0.42em;\"><span class=\"mi\" id=\"MathJax-Span-3709\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.575em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>nav</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-236\">r_t^{(\\text{nav})}</script></td>\n<td class=\"tg-tleft-valign-first\">Successful navigation</td>\n<td class=\"tg-tleft-valign-first\">0.1</td>\n<td class=\"tg-tleft-valign-second\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-237-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3710\" style=\"width: 1.729em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.432em, 1001.31em, 2.562em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3711\"><span class=\"texatom\" id=\"MathJax-Span-3712\"><span class=\"mrow\" id=\"MathJax-Span-3713\"><span class=\"mn\" id=\"MathJax-Span-3714\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3715\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3716\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.182em;\">1</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-237\">{0, 1}</script></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-238-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>UI</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3717\" style=\"width: 2.146em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.789em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.074em, 1001.79em, 2.622em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3718\"><span class=\"msubsup\" id=\"MathJax-Span-3719\"><span style=\"display: inline-block; position: relative; width: 1.789em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3720\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1001.31em, 4.289em, -999.997em); top: -4.461em; left: 0.479em;\"><span class=\"texatom\" id=\"MathJax-Span-3721\"><span class=\"mrow\" id=\"MathJax-Span-3722\"><span class=\"mo\" id=\"MathJax-Span-3723\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3724\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">UI</span><span class=\"mo\" id=\"MathJax-Span-3725\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.455em, 1000.3em, 4.17em, -999.997em); top: -3.747em; left: 0.42em;\"><span class=\"mi\" id=\"MathJax-Span-3726\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.575em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>UI</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-238\">r_t^{(\\text{UI})}</script></td>\n<td class=\"tg-tleft-valign-first\">Correct element interaction</td>\n<td class=\"tg-tleft-valign-first\">0.2</td>\n<td class=\"tg-tleft-valign-second\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-239-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3727\" style=\"width: 1.729em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.432em, 1001.31em, 2.562em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3728\"><span class=\"texatom\" id=\"MathJax-Span-3729\"><span class=\"mrow\" id=\"MathJax-Span-3730\"><span class=\"mn\" id=\"MathJax-Span-3731\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3732\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3733\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.182em;\">1</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-239\">{0, 1}</script></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-240-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>form</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3734\" style=\"width: 2.86em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.384em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.074em, 1002.38em, 2.622em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3735\"><span class=\"msubsup\" id=\"MathJax-Span-3736\"><span style=\"display: inline-block; position: relative; width: 2.384em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3737\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1001.91em, 4.289em, -999.997em); top: -4.461em; left: 0.479em;\"><span class=\"texatom\" id=\"MathJax-Span-3738\"><span class=\"mrow\" id=\"MathJax-Span-3739\"><span class=\"mo\" id=\"MathJax-Span-3740\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3741\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">form</span><span class=\"mo\" id=\"MathJax-Span-3742\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.455em, 1000.3em, 4.17em, -999.997em); top: -3.747em; left: 0.42em;\"><span class=\"mi\" id=\"MathJax-Span-3743\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.575em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>form</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-240\">r_t^{(\\text{form})}</script></td>\n<td class=\"tg-tleft-valign-first\">Partial form completion</td>\n<td class=\"tg-tleft-valign-first\">0.2</td>\n<td class=\"tg-tleft-valign-second\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-241-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3744\" style=\"width: 2.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.432em, 1002.03em, 2.622em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3745\"><span class=\"mo\" id=\"MathJax-Span-3746\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mn\" id=\"MathJax-Span-3747\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3748\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3749\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.182em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3750\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-241\">[0, 1]</script></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-242-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>file</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3751\" style=\"width: 2.384em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.967em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.074em, 1001.97em, 2.622em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3752\"><span class=\"msubsup\" id=\"MathJax-Span-3753\"><span style=\"display: inline-block; position: relative; width: 1.967em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3754\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1001.49em, 4.289em, -999.997em); top: -4.461em; left: 0.479em;\"><span class=\"texatom\" id=\"MathJax-Span-3755\"><span class=\"mrow\" id=\"MathJax-Span-3756\"><span class=\"mo\" id=\"MathJax-Span-3757\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3758\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">file</span><span class=\"mo\" id=\"MathJax-Span-3759\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.455em, 1000.3em, 4.17em, -999.997em); top: -3.747em; left: 0.42em;\"><span class=\"mi\" id=\"MathJax-Span-3760\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.575em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>file</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-242\">r_t^{(\\text{file})}</script></td>\n<td class=\"tg-tleft-valign-first\">Artifact creation (e.g., download)</td>\n<td class=\"tg-tleft-valign-first\">0.3</td>\n<td class=\"tg-tleft-valign-second\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-243-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3761\" style=\"width: 1.729em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.432em, 1001.31em, 2.562em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3762\"><span class=\"texatom\" id=\"MathJax-Span-3763\"><span class=\"mrow\" id=\"MathJax-Span-3764\"><span class=\"mn\" id=\"MathJax-Span-3765\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3766\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3767\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.182em;\">1</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-243\">{0, 1}</script></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-244-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>goal</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3768\" style=\"width: 2.741em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.265em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.074em, 1002.26em, 2.622em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3769\"><span class=\"msubsup\" id=\"MathJax-Span-3770\"><span style=\"display: inline-block; position: relative; width: 2.265em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3771\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1001.79em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;\"><span class=\"texatom\" id=\"MathJax-Span-3772\"><span class=\"mrow\" id=\"MathJax-Span-3773\"><span class=\"mo\" id=\"MathJax-Span-3774\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3775\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">goal</span><span class=\"mo\" id=\"MathJax-Span-3776\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.455em, 1000.3em, 4.17em, -999.997em); top: -3.747em; left: 0.42em;\"><span class=\"mi\" id=\"MathJax-Span-3777\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.575em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>goal</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-244\">r_t^{(\\text{goal})}</script></td>\n<td class=\"tg-tleft-valign-first\">Verified task completion</td>\n<td class=\"tg-tleft-valign-first\">0.2</td>\n<td class=\"tg-tleft-valign-second\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-245-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3778\" style=\"width: 1.729em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.432em, 1001.31em, 2.562em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3779\"><span class=\"texatom\" id=\"MathJax-Span-3780\"><span class=\"mrow\" id=\"MathJax-Span-3781\"><span class=\"mn\" id=\"MathJax-Span-3782\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3783\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3784\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.182em;\">1</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-245\">{0, 1}</script></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Component</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Description</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Weight</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Range</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-236-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>nav</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3700\" style=\"width: 2.443em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.027em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.074em, 1002.03em, 2.622em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3701\"><span class=\"msubsup\" id=\"MathJax-Span-3702\"><span style=\"display: inline-block; position: relative; width: 2.027em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3703\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1001.55em, 4.289em, -999.997em); top: -4.461em; left: 0.479em;\"><span class=\"texatom\" id=\"MathJax-Span-3704\"><span class=\"mrow\" id=\"MathJax-Span-3705\"><span class=\"mo\" id=\"MathJax-Span-3706\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3707\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">nav</span><span class=\"mo\" id=\"MathJax-Span-3708\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.455em, 1000.3em, 4.17em, -999.997em); top: -3.747em; left: 0.42em;\"><span class=\"mi\" id=\"MathJax-Span-3709\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.575em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>nav</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-236\">r_t^{(\\text{nav})}</script></td>\n<td class=\"tg-tleft-valign-first\">Successful navigation</td>\n<td class=\"tg-tleft-valign-first\">0.1</td>\n<td class=\"tg-tleft-valign-second\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-237-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3710\" style=\"width: 1.729em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.432em, 1001.31em, 2.562em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3711\"><span class=\"texatom\" id=\"MathJax-Span-3712\"><span class=\"mrow\" id=\"MathJax-Span-3713\"><span class=\"mn\" id=\"MathJax-Span-3714\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3715\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3716\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.182em;\">1</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-237\">{0, 1}</script></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-238-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>UI</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3717\" style=\"width: 2.146em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.789em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.074em, 1001.79em, 2.622em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3718\"><span class=\"msubsup\" id=\"MathJax-Span-3719\"><span style=\"display: inline-block; position: relative; width: 1.789em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3720\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1001.31em, 4.289em, -999.997em); top: -4.461em; left: 0.479em;\"><span class=\"texatom\" id=\"MathJax-Span-3721\"><span class=\"mrow\" id=\"MathJax-Span-3722\"><span class=\"mo\" id=\"MathJax-Span-3723\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3724\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">UI</span><span class=\"mo\" id=\"MathJax-Span-3725\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.455em, 1000.3em, 4.17em, -999.997em); top: -3.747em; left: 0.42em;\"><span class=\"mi\" id=\"MathJax-Span-3726\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.575em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>UI</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-238\">r_t^{(\\text{UI})}</script></td>\n<td class=\"tg-tleft-valign-first\">Correct element interaction</td>\n<td class=\"tg-tleft-valign-first\">0.2</td>\n<td class=\"tg-tleft-valign-second\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-239-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3727\" style=\"width: 1.729em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.432em, 1001.31em, 2.562em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3728\"><span class=\"texatom\" id=\"MathJax-Span-3729\"><span class=\"mrow\" id=\"MathJax-Span-3730\"><span class=\"mn\" id=\"MathJax-Span-3731\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3732\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3733\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.182em;\">1</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-239\">{0, 1}</script></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-240-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>form</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3734\" style=\"width: 2.86em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.384em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.074em, 1002.38em, 2.622em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3735\"><span class=\"msubsup\" id=\"MathJax-Span-3736\"><span style=\"display: inline-block; position: relative; width: 2.384em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3737\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1001.91em, 4.289em, -999.997em); top: -4.461em; left: 0.479em;\"><span class=\"texatom\" id=\"MathJax-Span-3738\"><span class=\"mrow\" id=\"MathJax-Span-3739\"><span class=\"mo\" id=\"MathJax-Span-3740\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3741\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">form</span><span class=\"mo\" id=\"MathJax-Span-3742\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.455em, 1000.3em, 4.17em, -999.997em); top: -3.747em; left: 0.42em;\"><span class=\"mi\" id=\"MathJax-Span-3743\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.575em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>form</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-240\">r_t^{(\\text{form})}</script></td>\n<td class=\"tg-tleft-valign-first\">Partial form completion</td>\n<td class=\"tg-tleft-valign-first\">0.2</td>\n<td class=\"tg-tleft-valign-second\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-241-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3744\" style=\"width: 2.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.432em, 1002.03em, 2.622em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3745\"><span class=\"mo\" id=\"MathJax-Span-3746\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mn\" id=\"MathJax-Span-3747\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3748\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3749\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.182em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3750\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-241\">[0, 1]</script></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-242-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>file</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3751\" style=\"width: 2.384em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.967em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.074em, 1001.97em, 2.622em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3752\"><span class=\"msubsup\" id=\"MathJax-Span-3753\"><span style=\"display: inline-block; position: relative; width: 1.967em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3754\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1001.49em, 4.289em, -999.997em); top: -4.461em; left: 0.479em;\"><span class=\"texatom\" id=\"MathJax-Span-3755\"><span class=\"mrow\" id=\"MathJax-Span-3756\"><span class=\"mo\" id=\"MathJax-Span-3757\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3758\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">file</span><span class=\"mo\" id=\"MathJax-Span-3759\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.455em, 1000.3em, 4.17em, -999.997em); top: -3.747em; left: 0.42em;\"><span class=\"mi\" id=\"MathJax-Span-3760\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.575em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>file</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-242\">r_t^{(\\text{file})}</script></td>\n<td class=\"tg-tleft-valign-first\">Artifact creation (e.g., download)</td>\n<td class=\"tg-tleft-valign-first\">0.3</td>\n<td class=\"tg-tleft-valign-second\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-243-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3761\" style=\"width: 1.729em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.432em, 1001.31em, 2.562em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3762\"><span class=\"texatom\" id=\"MathJax-Span-3763\"><span class=\"mrow\" id=\"MathJax-Span-3764\"><span class=\"mn\" id=\"MathJax-Span-3765\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3766\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3767\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.182em;\">1</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-243\">{0, 1}</script></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-244-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>goal</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3768\" style=\"width: 2.741em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.265em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.074em, 1002.26em, 2.622em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3769\"><span class=\"msubsup\" id=\"MathJax-Span-3770\"><span style=\"display: inline-block; position: relative; width: 2.265em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3771\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1001.79em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;\"><span class=\"texatom\" id=\"MathJax-Span-3772\"><span class=\"mrow\" id=\"MathJax-Span-3773\"><span class=\"mo\" id=\"MathJax-Span-3774\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-3775\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">goal</span><span class=\"mo\" id=\"MathJax-Span-3776\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.455em, 1000.3em, 4.17em, -999.997em); top: -3.747em; left: 0.42em;\"><span class=\"mi\" id=\"MathJax-Span-3777\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.575em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mtext>goal</mtext><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-244\">r_t^{(\\text{goal})}</script></td>\n<td class=\"tg-tleft-valign-first\">Verified task completion</td>\n<td class=\"tg-tleft-valign-first\">0.2</td>\n<td class=\"tg-tleft-valign-second\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-245-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3778\" style=\"width: 1.729em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.432em, 1001.31em, 2.562em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3779\"><span class=\"texatom\" id=\"MathJax-Span-3780\"><span class=\"mrow\" id=\"MathJax-Span-3781\"><span class=\"mn\" id=\"MathJax-Span-3782\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3783\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3784\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.182em;\">1</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mn>0</mn><mo>,</mo><mn>1</mn></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-245\">{0, 1}</script></td>\n</tr>\n</tbody>\n</table>\n<ul>\n  <li>This formulation ensures <strong>all reward components are physically measurable</strong>—no human labels are required. Each event corresponds to structured data observable through CDP logs, accessibility APIs, or filesystem monitors, making it reproducible and auditable across training runs.</li>\n</ul>",
    "contentMarkdown": "*   In **policy optimization**, the agent learns from a unified reward function that draws its signal from **one or more available sources**—such as **rule-based rewards**, a scalar reward output from a **learned reward model**, or another model that is proficient at grading the task (such as an **LLM-as-a-Judge**). Each policy update seeks to maximize the expected cumulative return:\n    \n    J(θ)\\=𝔼πθ\\[∑tγtrt\\]J(θ)\\=Eπθ\\[∑tγtrt\\]\n    \n    J(\\\\theta) = \\\\mathbb{E}\\_{\\\\pi\\_\\\\theta}\\\\left\\[\\\\sum\\_t \\\\gamma^t r\\_t\\\\right\\]\n    *   where rtrtr\\_t represents whichever reward signal is active for the current environment or training regime. In some settings, this may be a purely rule-based signal derived from measurable events (like navigation completions, form submissions, or file creations). In others, the reward may come from a trained model Rϕ(ot,at,ot+1)Rϕ(ot,at,ot+1)R\\_\\\\phi(o\\_t, a\\_t, o\\_{t+1}) that generalizes human preference data, or from an external proficient verifier (typically a larger model) such as an LLM-as-a-Judge.\n*   These components are **modular and optional**—only one or several may be active at any time. The optimization loop remains identical regardless of source: the policy simply maximizes whichever scalar feedback rtrtr\\_t it receives. This flexible design allows the same framework to operate with deterministic, model-based, or semantic reward supervision, depending on task complexity, available annotations, and desired interpretability.\n    \n*   **Rule-based rewards** form the foundation of this framework, providing deterministic, auditable feedback grounded in **explicit environment transitions and observable state changes**. As demonstrated in [DeepSeek-R1: Incentivizing Reasoning Capability in Large Language Models](https://arxiv.org/abs/2501.12948) by Gao et al. (2025), rule-based rewards yield transparent and stable optimization signals that are resistant to reward hacking and reduce reliance on noisy human annotation. In the context of computer-use agents, rule-based mechanisms correspond directly to **verifiable milestones** in user interaction sequences—for example:\n    \n    *   In **web navigation**, detecting a URL transition, page load completion, or DOM state change (`NavigationCompleted`, `DOMContentLoaded`).\n    *   In **form interaction**, observing DOM model deltas that indicate fields were populated, validation succeeded, or a “Submit” action triggered a confirmation dialog.\n    *   In **file handling/artifact generation**, confirming the creation or modification of a file within the sandbox (e.g., registering successful exports such as `.csv`, `.pdf`, or `.png` outputs following specific actions).\n    *   In **application state transitions**, monitoring focus changes, dialog closures, or process launches via OS accessibility APIs.\n    *   In **UI interaction success**, verifying that a button, link, or menu item was activated and that the resulting accessibility tree or visual layout changed accordingly.\n    *   These measurable indicators serve as the **atomic verification layer** of the reward system, ensuring that each environment step corresponds to reproducible, auditable progress signals without requiring human intervention.\n*   To generalize beyond fixed rules, a **trainable reward model** Rϕ(ot,at,ot+1)Rϕ(ot,at,ot+1)R\\_\\\\phi(o\\_t, a\\_t, o\\_{t+1}) can be introduced. This model is trained on **human-labeled or preference-ranked trajectories**, similar to the reward modeling stage in PPO-based RLHF pipelines. Once trained, RϕRϕR\\_\\\\phi predicts scalar reward signals that approximate human preferences for unseen tasks or ambiguous states. It operates faster and more consistently than a generative LLM-as-a-Judge (which can be implemented as a Verifier Agent), while maintaining semantic fidelity to human supervision.\n    \n*   The **three-tier reward hierarchy** thus becomes:\n    \n    1.  **Rule-based rewards (preferred default):** deterministic, event-driven, and auditable (no reward hacking).\n    2.  **Learned, discriminative reward model (RϕRϕR\\_\\\\phi):** generalizes human feedback for subtle, unstructured, or context-dependent goals where rules are insufficient.\n    3.  **Generative reward model (e.g., LLM-as-a-Judge):** invoked only when both rule-based detectors and RϕRϕR\\_\\\\phi cannot confidently score outcomes (e.g., for semantic reasoning, style alignment, or multimodal understanding). This is similar to how [DeepSeek-R1](../deepseek-R1) uses a generative reward model by feeding the ground-truth and model predictions into DeepSeek-V3 for judgment during the rejection sampling stage for reasoning data.\n*   This architecture ensures that the **primary training flow remains rule-grounded and verifiable**, while allowing smooth fallback to preference-aligned modeling when necessary. The hybrid setup—selectively combining rule-based rewards, learned reward estimation, and verifier agent intervention—balances **scalability, auditability, and semantic depth** across diverse computer-use tasks.\n    \n*   During training, the **reward selection and routing process** is adaptive. When deterministic milestone detectors emit valid scores, they take precedence as the most reliable supervision. If the environment lacks such instrumentation, the learned model RϕRϕR\\_\\\\phi dynamically provides substitute scalar feedback inferred from trajectory context. In the rare case that both mechanisms yield low confidence, the system escalates to the Verifier Agent for semantic adjudication. This cascading reward flow ensures the agent always receives a stable optimization signal—grounded when possible, inferred when necessary, and judged when ambiguity demands interpretive reasoning.\n    \n\nIn **policy optimization**, the agent learns from a unified reward function that draws its signal from **one or more available sources**—such as **rule-based rewards**, a scalar reward output from a **learned reward model**, or another model that is proficient at grading the task (such as an **LLM-as-a-Judge**). Each policy update seeks to maximize the expected cumulative return:\n\n*   where rtrtr\\_t represents whichever reward signal is active for the current environment or training regime. In some settings, this may be a purely rule-based signal derived from measurable events (like navigation completions, form submissions, or file creations). In others, the reward may come from a trained model Rϕ(ot,at,ot+1)Rϕ(ot,at,ot+1)R\\_\\\\phi(o\\_t, a\\_t, o\\_{t+1}) that generalizes human preference data, or from an external proficient verifier (typically a larger model) such as an LLM-as-a-Judge.\n\nThese components are **modular and optional**—only one or several may be active at any time. The optimization loop remains identical regardless of source: the policy simply maximizes whichever scalar feedback rtrtr\\_t it receives. This flexible design allows the same framework to operate with deterministic, model-based, or semantic reward supervision, depending on task complexity, available annotations, and desired interpretability.\n\n**Rule-based rewards** form the foundation of this framework, providing deterministic, auditable feedback grounded in **explicit environment transitions and observable state changes**. As demonstrated in [DeepSeek-R1: Incentivizing Reasoning Capability in Large Language Models](https://arxiv.org/abs/2501.12948) by Gao et al. (2025), rule-based rewards yield transparent and stable optimization signals that are resistant to reward hacking and reduce reliance on noisy human annotation. In the context of computer-use agents, rule-based mechanisms correspond directly to **verifiable milestones** in user interaction sequences—for example:\n\n*   In **web navigation**, detecting a URL transition, page load completion, or DOM state change (`NavigationCompleted`, `DOMContentLoaded`).\n*   In **form interaction**, observing DOM model deltas that indicate fields were populated, validation succeeded, or a “Submit” action triggered a confirmation dialog.\n*   In **file handling/artifact generation**, confirming the creation or modification of a file within the sandbox (e.g., registering successful exports such as `.csv`, `.pdf`, or `.png` outputs following specific actions).\n*   In **application state transitions**, monitoring focus changes, dialog closures, or process launches via OS accessibility APIs.\n*   In **UI interaction success**, verifying that a button, link, or menu item was activated and that the resulting accessibility tree or visual layout changed accordingly.\n*   These measurable indicators serve as the **atomic verification layer** of the reward system, ensuring that each environment step corresponds to reproducible, auditable progress signals without requiring human intervention.\n\nTo generalize beyond fixed rules, a **trainable reward model** Rϕ(ot,at,ot+1)Rϕ(ot,at,ot+1)R\\_\\\\phi(o\\_t, a\\_t, o\\_{t+1}) can be introduced. This model is trained on **human-labeled or preference-ranked trajectories**, similar to the reward modeling stage in PPO-based RLHF pipelines. Once trained, RϕRϕR\\_\\\\phi predicts scalar reward signals that approximate human preferences for unseen tasks or ambiguous states. It operates faster and more consistently than a generative LLM-as-a-Judge (which can be implemented as a Verifier Agent), while maintaining semantic fidelity to human supervision.\n\nThe **three-tier reward hierarchy** thus becomes:\n\n1.  **Rule-based rewards (preferred default):** deterministic, event-driven, and auditable (no reward hacking).\n2.  **Learned, discriminative reward model (RϕRϕR\\_\\\\phi):** generalizes human feedback for subtle, unstructured, or context-dependent goals where rules are insufficient.\n3.  **Generative reward model (e.g., LLM-as-a-Judge):** invoked only when both rule-based detectors and RϕRϕR\\_\\\\phi cannot confidently score outcomes (e.g., for semantic reasoning, style alignment, or multimodal understanding). This is similar to how [DeepSeek-R1](../deepseek-R1) uses a generative reward model by feeding the ground-truth and model predictions into DeepSeek-V3 for judgment during the rejection sampling stage for reasoning data.\n\nThis architecture ensures that the **primary training flow remains rule-grounded and verifiable**, while allowing smooth fallback to preference-aligned modeling when necessary. The hybrid setup—selectively combining rule-based rewards, learned reward estimation, and verifier agent intervention—balances **scalability, auditability, and semantic depth** across diverse computer-use tasks.\n\nDuring training, the **reward selection and routing process** is adaptive. When deterministic milestone detectors emit valid scores, they take precedence as the most reliable supervision. If the environment lacks such instrumentation, the learned model RϕRϕR\\_\\\\phi dynamically provides substitute scalar feedback inferred from trajectory context. In the rare case that both mechanisms yield low confidence, the system escalates to the Verifier Agent for semantic adjudication. This cascading reward flow ensures the agent always receives a stable optimization signal—grounded when possible, inferred when necessary, and judged when ambiguity demands interpretive reasoning.\n\n#### Milestone-Based Reward System\n\n*   Any **reward formulation**—whether deterministic, learned, or model-evaluated—can be decomposed into a sequence of **milestones or checkpoints** that represent measurable progress toward the task goal. Each milestone corresponds to a verifiable state transition, UI event, or observable change in the environment, providing interpretable signals even within complex or hierarchical workflows. In practice, a reward function can therefore be a **composite of multiple sources**: **rule-based rewards**, scalar predictions from a **learned, discriminative reward model**, or a **generative model** that is proficient at grading the task, such as an **LLM-as-a-Judge**.\n    \n*   In general, **rule-based rewards** are preferred because they are **deterministic, easy to verify, and resistant to reward hacking**, consistent with the design principles demonstrated in the [DeepSeek-R1](https://arxiv.org/abs/2501.12948) framework by Gao et al. (2025). These rewards are derived from **concrete, environment-observable events**—such as file creation, DOM or AX tree changes, navigation completions, or dialog confirmations—and can be validated directly through structured logs and system hooks. Their reproducibility and transparency make them ideal for large-scale, self-contained policy optimization loops, where interpretability and auditability are crucial.\n    \n*   In this system, the **rule-based layer** serves as the foundational signal generator for all common computer-use tasks. It captures events such as:\n    \n    *   File downloads or artifact creation\n    *   Successful form submissions or dialog confirmations\n    *   UI transitions, window focus changes, or navigation completions\n    *   Text field population or data transfer between applications\n    *   Screenshot or state deltas indicating successful subgoal completion\n        \n    *   These reward components directly populate the tuple (ot,at,rt,ot+1)(ot,at,rt,ot+1)(o\\_t, a\\_t, r\\_t, o\\_{t+1}) used by the policy optimizer for learning stable, interpretable control policies. Each milestone event contributes either a discrete tick or a weighted scalar toward cumulative progress.\n*   However, not all task goals can be described exhaustively through deterministic rules. To extend coverage, the architecture includes a **learned reward model** Rϕ(ot,at,ot+1)Rϕ(ot,at,ot+1)R\\_\\\\phi(o\\_t, a\\_t, o\\_{t+1}) trained specifically on **human preferences or ranked trajectories**.\n    \n    *   This model generalizes beyond hand-engineered events to score **semantic correctness, contextual relevance, and user-aligned outcomes**.\n    *   RϕRϕR\\_\\\\phi can be continuously fine-tuned as new preference data accumulates, adapting reward shaping dynamically to novel workflows or unseen UIs.\n    *   During training, the optimizer consumes a blended reward signal that can combine multiple sources:\n        \n        r̃ t\\=αr(rule)t+βRϕ(ot,at,ot+1)+γr(judge)tr~t\\=αrt(rule)+βRϕ(ot,at,ot+1)+γrt(judge)\n        \n        \\\\tilde{r}\\_t = \\\\alpha r\\_t^{(\\\\text{rule})} + \\\\beta R\\_\\\\phi(o\\_t, a\\_t, o\\_{t+1}) + \\\\gamma r\\_t^{(\\\\text{judge})}\n        *   where α,β,γ∈\\[0,1\\]α,β,γ∈\\[0,1\\]\\\\alpha, \\\\beta, \\\\gamma \\\\in \\[0,1\\] represent trust weights for deterministic, learned, and model-evaluated components respectively, with α+β+γ\\=1α+β+γ\\=1\\\\alpha + \\\\beta + \\\\gamma = 1.\n*   In cases where both rule-based detectors and the learned reward model fail to provide a confident or interpretable score, a **generative model (such as an LLM-as-a-Judge)** may be selectively invoked. This verifier acts as a high-capacity, _LLM-as-a-Judge_ module that semantically evaluates whether the observed trajectory satisfies implicit or fuzzy success criteria. Its role parallels that of a preference model but operates at runtime for difficult or open-ended cases.\n    \n*   Scenarios where rule-based and model-based scoring may be insufficient—and thus require a Verifier Agent—include:\n    \n    *   **Subjective or semantic correctness:** determining if a written summary or chart interpretation matches the instruction intent.\n    *   **Cross-context validation:** verifying that data copied from a spreadsheet was correctly inserted into a report or email draft.\n    *   **Goal inference under ambiguity:** tasks like “open the latest invoice,” where the target must be inferred dynamically.\n    *   **Complex recovery handling:** identifying whether the system has correctly recovered from an unintended dialog or misclick.\n    *   **Language or multimodal alignment:** verifying tone, structure, or layout across applications.\n*   The **reward system hierarchy** therefore consists of three complementary and optionally composable layers:\n    \n    1.  **Rule-based rewards**: deterministic, verifiable, and fully auditable signals derived from concrete milestones (default and preferred).\n        \n    2.  **Learned, discriminative reward model (RϕRϕR\\_\\\\phi)**: trained on human preferences to generalize beyond explicit rules and produce scalar feedback for unstructured tasks.\n        \n    3.  **Generative reward model (e.g., LLM-as-a-Judge)**: semantic fallback for nuanced, subjective, or multimodal evaluation where neither rules nor learned models suffice. This is similar to how [DeepSeek-R1](../deepseek-R1) uses a generative reward model by feeding the ground-truth and model predictions into DeepSeek-V3 for judgment during the rejection sampling stage for reasoning data.\n        \n*   Together, these layers enable **robust, explainable, and modular reward shaping**. Any reward function within the system can thus be expressed as a **milestone-weighted combination** of deterministic, learned, and interpretive components—ensuring scalability, transparency, and semantic alignment across all computer-use reinforcement learning setups.\n    \n\nAny **reward formulation**—whether deterministic, learned, or model-evaluated—can be decomposed into a sequence of **milestones or checkpoints** that represent measurable progress toward the task goal. Each milestone corresponds to a verifiable state transition, UI event, or observable change in the environment, providing interpretable signals even within complex or hierarchical workflows. In practice, a reward function can therefore be a **composite of multiple sources**: **rule-based rewards**, scalar predictions from a **learned, discriminative reward model**, or a **generative model** that is proficient at grading the task, such as an **LLM-as-a-Judge**.\n\nIn general, **rule-based rewards** are preferred because they are **deterministic, easy to verify, and resistant to reward hacking**, consistent with the design principles demonstrated in the [DeepSeek-R1](https://arxiv.org/abs/2501.12948) framework by Gao et al. (2025). These rewards are derived from **concrete, environment-observable events**—such as file creation, DOM or AX tree changes, navigation completions, or dialog confirmations—and can be validated directly through structured logs and system hooks. Their reproducibility and transparency make them ideal for large-scale, self-contained policy optimization loops, where interpretability and auditability are crucial.\n\nIn this system, the **rule-based layer** serves as the foundational signal generator for all common computer-use tasks. It captures events such as:\n\n*   File downloads or artifact creation\n*   Successful form submissions or dialog confirmations\n*   UI transitions, window focus changes, or navigation completions\n*   Text field population or data transfer between applications\n*   Screenshot or state deltas indicating successful subgoal completion\n    \n*   These reward components directly populate the tuple (ot,at,rt,ot+1)(ot,at,rt,ot+1)(o\\_t, a\\_t, r\\_t, o\\_{t+1}) used by the policy optimizer for learning stable, interpretable control policies. Each milestone event contributes either a discrete tick or a weighted scalar toward cumulative progress.\n\nScreenshot or state deltas indicating successful subgoal completion\n\nHowever, not all task goals can be described exhaustively through deterministic rules. To extend coverage, the architecture includes a **learned reward model** Rϕ(ot,at,ot+1)Rϕ(ot,at,ot+1)R\\_\\\\phi(o\\_t, a\\_t, o\\_{t+1}) trained specifically on **human preferences or ranked trajectories**.\n\n*   This model generalizes beyond hand-engineered events to score **semantic correctness, contextual relevance, and user-aligned outcomes**.\n*   RϕRϕR\\_\\\\phi can be continuously fine-tuned as new preference data accumulates, adapting reward shaping dynamically to novel workflows or unseen UIs.\n*   During training, the optimizer consumes a blended reward signal that can combine multiple sources:\n    \n    r̃ t\\=αr(rule)t+βRϕ(ot,at,ot+1)+γr(judge)tr~t\\=αrt(rule)+βRϕ(ot,at,ot+1)+γrt(judge)\n    \n    \\\\tilde{r}\\_t = \\\\alpha r\\_t^{(\\\\text{rule})} + \\\\beta R\\_\\\\phi(o\\_t, a\\_t, o\\_{t+1}) + \\\\gamma r\\_t^{(\\\\text{judge})}\n    *   where α,β,γ∈\\[0,1\\]α,β,γ∈\\[0,1\\]\\\\alpha, \\\\beta, \\\\gamma \\\\in \\[0,1\\] represent trust weights for deterministic, learned, and model-evaluated components respectively, with α+β+γ\\=1α+β+γ\\=1\\\\alpha + \\\\beta + \\\\gamma = 1.\n\nDuring training, the optimizer consumes a blended reward signal that can combine multiple sources:\n\n*   where α,β,γ∈\\[0,1\\]α,β,γ∈\\[0,1\\]\\\\alpha, \\\\beta, \\\\gamma \\\\in \\[0,1\\] represent trust weights for deterministic, learned, and model-evaluated components respectively, with α+β+γ\\=1α+β+γ\\=1\\\\alpha + \\\\beta + \\\\gamma = 1.\n\nIn cases where both rule-based detectors and the learned reward model fail to provide a confident or interpretable score, a **generative model (such as an LLM-as-a-Judge)** may be selectively invoked. This verifier acts as a high-capacity, _LLM-as-a-Judge_ module that semantically evaluates whether the observed trajectory satisfies implicit or fuzzy success criteria. Its role parallels that of a preference model but operates at runtime for difficult or open-ended cases.\n\nScenarios where rule-based and model-based scoring may be insufficient—and thus require a Verifier Agent—include:\n\n*   **Subjective or semantic correctness:** determining if a written summary or chart interpretation matches the instruction intent.\n*   **Cross-context validation:** verifying that data copied from a spreadsheet was correctly inserted into a report or email draft.\n*   **Goal inference under ambiguity:** tasks like “open the latest invoice,” where the target must be inferred dynamically.\n*   **Complex recovery handling:** identifying whether the system has correctly recovered from an unintended dialog or misclick.\n*   **Language or multimodal alignment:** verifying tone, structure, or layout across applications.\n\nThe **reward system hierarchy** therefore consists of three complementary and optionally composable layers:\n\n1.  **Rule-based rewards**: deterministic, verifiable, and fully auditable signals derived from concrete milestones (default and preferred).\n    \n2.  **Learned, discriminative reward model (RϕRϕR\\_\\\\phi)**: trained on human preferences to generalize beyond explicit rules and produce scalar feedback for unstructured tasks.\n    \n3.  **Generative reward model (e.g., LLM-as-a-Judge)**: semantic fallback for nuanced, subjective, or multimodal evaluation where neither rules nor learned models suffice. This is similar to how [DeepSeek-R1](../deepseek-R1) uses a generative reward model by feeding the ground-truth and model predictions into DeepSeek-V3 for judgment during the rejection sampling stage for reasoning data.\n    \n\n**Rule-based rewards**: deterministic, verifiable, and fully auditable signals derived from concrete milestones (default and preferred).\n\n**Learned, discriminative reward model (RϕRϕR\\_\\\\phi)**: trained on human preferences to generalize beyond explicit rules and produce scalar feedback for unstructured tasks.\n\n**Generative reward model (e.g., LLM-as-a-Judge)**: semantic fallback for nuanced, subjective, or multimodal evaluation where neither rules nor learned models suffice. This is similar to how [DeepSeek-R1](../deepseek-R1) uses a generative reward model by feeding the ground-truth and model predictions into DeepSeek-V3 for judgment during the rejection sampling stage for reasoning data.\n\nTogether, these layers enable **robust, explainable, and modular reward shaping**. Any reward function within the system can thus be expressed as a **milestone-weighted combination** of deterministic, learned, and interpretive components—ensuring scalability, transparency, and semantic alignment across all computer-use reinforcement learning setups.\n\n##### Example Milestones by Task Category\n\n1.  **Web Navigation and Data Extraction**\n    \n    *   **Milestone:** Target URL loaded successfully (`NavigationCompleted` event). _Reward:_ +0.25\n    *   **Milestone:** Element with specific role/name detected (e.g., “Reports Table” or “Dashboard Summary”). _Reward:_ +0.25\n    *   **Milestone:** Successful data scrape or DOM text retrieval logged. _Reward:_ +0.5\n2.  **Form Interaction**\n    \n    *   **Milestone:** Input field focused and filled (text pattern matched). _Reward:_ +0.2\n    *   **Milestone:** Submit button clicked and confirmation dialog appears. _Reward:_ +0.3\n    *   **Milestone:** Success banner or confirmation element detected. _Reward:_ +0.5\n3.  **File Handling and Downloads**\n    \n    *   **Milestone:** File creation event observed in `/Downloads`. _Reward:_ +1.0\n    *   **Milestone:** File hash or extension matches expectation (e.g., `.csv`, `.pdf`). _Reward:_ +0.5\n    *   **Milestone:** Directory updated without error. _Reward:_ +0.25\n4.  **Email or Document Workflows**\n    \n    *   **Milestone:** Email editor loaded and populated with recipient and subject. _Reward:_ +0.25\n    *   **Milestone:** Attachment successfully added. _Reward:_ +0.5\n    *   **Milestone:** Message successfully sent (UI confirmation or state change). _Reward:_ +1.0\n5.  **System Configuration and Settings**\n    \n    *   **Milestone:** Settings panel opened (window title match). _Reward:_ +0.25\n    *   **Milestone:** Checkbox or toggle successfully modified (UIA/AX event). _Reward:_ +0.25\n    *   **Milestone:** “Changes Saved” notification observed. _Reward:_ +0.5\n6.  **Search and Information Retrieval**\n    \n    *   **Milestone:** Query field populated with correct term. _Reward:_ +0.25\n    *   **Milestone:** Search executed and result list rendered. _Reward:_ +0.5\n    *   **Milestone:** Target entry clicked or opened. _Reward:_ +0.5\n\n**Web Navigation and Data Extraction**\n\n*   **Milestone:** Target URL loaded successfully (`NavigationCompleted` event). _Reward:_ +0.25\n*   **Milestone:** Element with specific role/name detected (e.g., “Reports Table” or “Dashboard Summary”). _Reward:_ +0.25\n*   **Milestone:** Successful data scrape or DOM text retrieval logged. _Reward:_ +0.5\n\n**Form Interaction**\n\n*   **Milestone:** Input field focused and filled (text pattern matched). _Reward:_ +0.2\n*   **Milestone:** Submit button clicked and confirmation dialog appears. _Reward:_ +0.3\n*   **Milestone:** Success banner or confirmation element detected. _Reward:_ +0.5\n\n**File Handling and Downloads**\n\n*   **Milestone:** File creation event observed in `/Downloads`. _Reward:_ +1.0\n*   **Milestone:** File hash or extension matches expectation (e.g., `.csv`, `.pdf`). _Reward:_ +0.5\n*   **Milestone:** Directory updated without error. _Reward:_ +0.25\n\n**Email or Document Workflows**\n\n*   **Milestone:** Email editor loaded and populated with recipient and subject. _Reward:_ +0.25\n*   **Milestone:** Attachment successfully added. _Reward:_ +0.5\n*   **Milestone:** Message successfully sent (UI confirmation or state change). _Reward:_ +1.0\n\n**System Configuration and Settings**\n\n*   **Milestone:** Settings panel opened (window title match). _Reward:_ +0.25\n*   **Milestone:** Checkbox or toggle successfully modified (UIA/AX event). _Reward:_ +0.25\n*   **Milestone:** “Changes Saved” notification observed. _Reward:_ +0.5\n\n**Search and Information Retrieval**\n\n*   **Milestone:** Query field populated with correct term. _Reward:_ +0.25\n*   **Milestone:** Search executed and result list rendered. _Reward:_ +0.5\n*   **Milestone:** Target entry clicked or opened. _Reward:_ +0.5\n\n#### Example Reward Function\n\n*   Each environment step returns a shaped reward based on concrete, verifiable milestones. Instead of relying on subjective evaluators, the reward function is composed of measurable subcomponents derived from observable state transitions, UI changes, and artifact events.\n    \n*   At step ttt, the total reward is given by:\n    \n    rt\\=wnavr(nav)t+wUIr(UI)t+wformr(form)t+wfiler(file)t+wgoalr(goal)trt\\=wnavrt(nav)+wUIrt(UI)+wformrt(form)+wfilert(file)+wgoalrt(goal)\n    \n    r\\_t = w\\_{\\\\text{nav}} r\\_t^{(\\\\text{nav})} + w\\_{\\\\text{UI}} r\\_t^{(\\\\text{UI})} + w\\_{\\\\text{form}} r\\_t^{(\\\\text{form})} + w\\_{\\\\text{file}} r\\_t^{(\\\\text{file})} + w\\_{\\\\text{goal}} r\\_t^{(\\\\text{goal})}\n    *   where each component represents a verifiable milestone type:\n*   r(nav)trt(nav)r\\_t^{(\\\\text{nav})}: Navigation progress reward — triggered by measurable page transitions such as `NavigationCompleted` events, URL match, or window title change.\n    \n    r(nav)t\\=𝟙{urlt≠urlt−1}rt(nav)\\=1{urlt≠urlt−1}\n    \n    r\\_t^{(\\\\text{nav})} = \\\\mathbb{1}{\\\\{\\\\text{url}\\_t \\\\neq \\\\text{url}\\_{t-1}\\\\}}\n*   r(UI)trt(UI)r\\_t^{(\\\\text{UI})}: UI element interaction reward — triggered when a UI control with a matching role or label is successfully targeted (e.g., a button click or field focus event).\n    \n    r(UI)t\\=𝟙{clicked(role,name)\\=expected(role,name)rt(UI)\\=1{clicked(role,name)\\=expected(role,name)\n    \n    r\\_t^{(\\\\text{UI})} = \\\\mathbb{1}{\\\\{\\\\text{clicked(role,name)} = \\\\text{expected(role,name)}}\n*   r(form)trt(form)r\\_t^{(\\\\text{form})}: Form completion reward — triggered when an editable control is filled and validated (value non-empty, regex match, or field count).\n    \n    r(form)t\\=NfilledNexpectedrt(form)\\=NfilledNexpected\n    \n    r\\_t^{(\\\\text{form})} = \\\\frac{N\\_{\\\\text{filled}}}{N\\_{\\\\text{expected}}}\n*   r(file)trt(file)r\\_t^{(\\\\text{file})}: File-handling reward — derived from filesystem or artifact deltas (e.g., a new `.csv`, `.pdf`, or `.json` created).\n    \n    r(file)t\\=𝟙{∃f∈At:f.event\\=''created\"}rt(file)\\=1{∃f∈At:f.event\\=''created\"}\n    \n    r\\_t^{(\\\\text{file})} = \\\\mathbb{1}{\\\\{\\\\exists f \\\\in A\\_{t}: f.\\\\text{event} = \\\\text{''created\"}\\\\}}\n*   r(goal)trt(goal)r\\_t^{(\\\\text{goal})}: Task completion reward — triggered by a high-level terminal condition, such as detection of success text, matched hash, or closed loop condition.\n    \n    r(goal)t\\=𝟙{goal\\_verified(ot)}rt(goal)\\=1{goal\\_verified(ot)}\n    \n    r\\_t^{(\\\\text{goal})} = \\\\mathbb{1}{\\\\{\\\\text{goal\\_verified}(o\\_t)\\\\}}\n*   The weights wnav,wUI,wform,wfile,wgoalwnav,wUI,wform,wfile,wgoalw\\_{\\\\text{nav}}, w\\_{\\\\text{UI}}, w\\_{\\\\text{form}}, w\\_{\\\\text{file}}, w\\_{\\\\text{goal}} balance short-term shaping with terminal rewards, typically normalized so that:\n    \n\nEach environment step returns a shaped reward based on concrete, verifiable milestones. Instead of relying on subjective evaluators, the reward function is composed of measurable subcomponents derived from observable state transitions, UI changes, and artifact events.\n\nAt step ttt, the total reward is given by:\n\n*   where each component represents a verifiable milestone type:\n\nr(nav)trt(nav)r\\_t^{(\\\\text{nav})}: Navigation progress reward — triggered by measurable page transitions such as `NavigationCompleted` events, URL match, or window title change.\n\nr(UI)trt(UI)r\\_t^{(\\\\text{UI})}: UI element interaction reward — triggered when a UI control with a matching role or label is successfully targeted (e.g., a button click or field focus event).\n\nr(form)trt(form)r\\_t^{(\\\\text{form})}: Form completion reward — triggered when an editable control is filled and validated (value non-empty, regex match, or field count).\n\nr(file)trt(file)r\\_t^{(\\\\text{file})}: File-handling reward — derived from filesystem or artifact deltas (e.g., a new `.csv`, `.pdf`, or `.json` created).\n\nr(goal)trt(goal)r\\_t^{(\\\\text{goal})}: Task completion reward — triggered by a high-level terminal condition, such as detection of success text, matched hash, or closed loop condition.\n\nThe weights wnav,wUI,wform,wfile,wgoalwnav,wUI,wform,wfile,wgoalw\\_{\\\\text{nav}}, w\\_{\\\\text{UI}}, w\\_{\\\\text{form}}, w\\_{\\\\text{file}}, w\\_{\\\\text{goal}} balance short-term shaping with terminal rewards, typically normalized so that:\n\n∑iwi\\=1{wgoal≥wfile≥wUI}∑iwi\\=1{wgoal≥wfile≥wUI}\n\n#### Example Instantiation\n\n**Component**\n\n**Description**\n\n**Weight**\n\n**Range**\n\nr(nav)trt(nav)r\\_t^{(\\\\text{nav})}\n\nSuccessful navigation\n\n0.1\n\n0,10,1{0, 1}\n\nr(UI)trt(UI)r\\_t^{(\\\\text{UI})}\n\nCorrect element interaction\n\n0.2\n\n0,10,1{0, 1}\n\nr(form)trt(form)r\\_t^{(\\\\text{form})}\n\nPartial form completion\n\n0.2\n\n\\[0,1\\]\\[0,1\\]\\[0, 1\\]\n\nr(file)trt(file)r\\_t^{(\\\\text{file})}\n\nArtifact creation (e.g., download)\n\n0.3\n\n0,10,1{0, 1}\n\nr(goal)trt(goal)r\\_t^{(\\\\text{goal})}\n\nVerified task completion\n\n0.2\n\n0,10,1{0, 1}\n\n**Component**\n\n**Description**\n\n**Weight**\n\n**Range**\n\nr(nav)trt(nav)r\\_t^{(\\\\text{nav})}\n\nSuccessful navigation\n\n0.1\n\n0,10,1{0, 1}\n\nr(UI)trt(UI)r\\_t^{(\\\\text{UI})}\n\nCorrect element interaction\n\n0.2\n\n0,10,1{0, 1}\n\nr(form)trt(form)r\\_t^{(\\\\text{form})}\n\nPartial form completion\n\n0.2\n\n\\[0,1\\]\\[0,1\\]\\[0, 1\\]\n\nr(file)trt(file)r\\_t^{(\\\\text{file})}\n\nArtifact creation (e.g., download)\n\n0.3\n\n0,10,1{0, 1}\n\nr(goal)trt(goal)r\\_t^{(\\\\text{goal})}\n\nVerified task completion\n\n0.2\n\n0,10,1{0, 1}\n\n*   This formulation ensures **all reward components are physically measurable**—no human labels are required. Each event corresponds to structured data observable through CDP logs, accessibility APIs, or filesystem monitors, making it reproducible and auditable across training runs.",
    "order": 20,
    "orderInChapter": 6,
    "difficulty": 4,
    "estimatedMinutes": 20,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "reinforcement learning",
      "optimization"
    ],
    "metadata": {
      "hasCode": true,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 3952,
      "contentLength": 305439
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#agentic-reinforcement-learning-via-policy-optimization",
    "scrapedAt": "2025-12-28T11:47:36.152Z"
  },
  {
    "id": "ai-agentic-RL-agent-training-pipeline-21",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Reinforcement Learning for Web and Computer-Use Agents",
    "title": "Agent Training Pipeline",
    "subtitle": "Reinforcement Learning for Web and Computer-Use Agents",
    "contentHtml": "<ul>\n  <li>\n    <p>A typical pipeline to train a web or computer-use agent might follow:</p>\n\n    <ol>\n      <li>Pre-train the model (e.g., a large language model) via supervised learning.</li>\n      <li>Optionally fine-tune on domain-specific prompts (supervised fine-tuning, SFT).</li>\n      <li>Collect human preference data (rankings of model responses).</li>\n      <li>Choose alignment method:\n        <ul>\n          <li><strong>RLHF:</strong> train reward model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-246-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3785\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3786\"><span class=\"mo\" id=\"MathJax-Span-3787\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-246\">\\rightarrow</script> use PPO (or other RL algorithm) to optimise policy.</li>\n          <li><strong>DPO:</strong> directly fine-tune model on preference data (skipping RL loop).</li>\n        </ul>\n      </li>\n      <li>Launch agent into simulated environment (single-turn environments, tool-use environments, or multi-turn environments).</li>\n      <li>Run RL policy optimisation in the environment: sample trajectories, estimate advantages/returns, update policy using PPO or variants.</li>\n      <li>Periodically evaluate and filter trajectories, adjust reward shaping, fine-tune further for tool-use or long-horizon behaviours.</li>\n    </ol>\n  </li>\n  <li>\n    <p>By selecting algorithms appropriate for the interaction type (single turn vs. tool vs. multi-turn), one can tailor the training for efficiency, stability, and scalability.</p>\n  </li>\n</ul>\n<p>A typical pipeline to train a web or computer-use agent might follow:</p>\n<ol>\n      <li>Pre-train the model (e.g., a large language model) via supervised learning.</li>\n      <li>Optionally fine-tune on domain-specific prompts (supervised fine-tuning, SFT).</li>\n      <li>Collect human preference data (rankings of model responses).</li>\n      <li>Choose alignment method:\n        <ul>\n          <li><strong>RLHF:</strong> train reward model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-246-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3785\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3786\"><span class=\"mo\" id=\"MathJax-Span-3787\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-246\">\\rightarrow</script> use PPO (or other RL algorithm) to optimise policy.</li>\n          <li><strong>DPO:</strong> directly fine-tune model on preference data (skipping RL loop).</li>\n        </ul>\n      </li>\n      <li>Launch agent into simulated environment (single-turn environments, tool-use environments, or multi-turn environments).</li>\n      <li>Run RL policy optimisation in the environment: sample trajectories, estimate advantages/returns, update policy using PPO or variants.</li>\n      <li>Periodically evaluate and filter trajectories, adjust reward shaping, fine-tune further for tool-use or long-horizon behaviours.</li>\n    </ol>\n<ul>\n          <li><strong>RLHF:</strong> train reward model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-246-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3785\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3786\"><span class=\"mo\" id=\"MathJax-Span-3787\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-246\">\\rightarrow</script> use PPO (or other RL algorithm) to optimise policy.</li>\n          <li><strong>DPO:</strong> directly fine-tune model on preference data (skipping RL loop).</li>\n        </ul>\n<p>By selecting algorithms appropriate for the interaction type (single turn vs. tool vs. multi-turn), one can tailor the training for efficiency, stability, and scalability.</p>",
    "contentMarkdown": "*   A typical pipeline to train a web or computer-use agent might follow:\n    \n    1.  Pre-train the model (e.g., a large language model) via supervised learning.\n    2.  Optionally fine-tune on domain-specific prompts (supervised fine-tuning, SFT).\n    3.  Collect human preference data (rankings of model responses).\n    4.  Choose alignment method:\n        *   **RLHF:** train reward model →→\\\\rightarrow use PPO (or other RL algorithm) to optimise policy.\n        *   **DPO:** directly fine-tune model on preference data (skipping RL loop).\n    5.  Launch agent into simulated environment (single-turn environments, tool-use environments, or multi-turn environments).\n    6.  Run RL policy optimisation in the environment: sample trajectories, estimate advantages/returns, update policy using PPO or variants.\n    7.  Periodically evaluate and filter trajectories, adjust reward shaping, fine-tune further for tool-use or long-horizon behaviours.\n*   By selecting algorithms appropriate for the interaction type (single turn vs. tool vs. multi-turn), one can tailor the training for efficiency, stability, and scalability.\n    \n\nA typical pipeline to train a web or computer-use agent might follow:\n\n1.  Pre-train the model (e.g., a large language model) via supervised learning.\n2.  Optionally fine-tune on domain-specific prompts (supervised fine-tuning, SFT).\n3.  Collect human preference data (rankings of model responses).\n4.  Choose alignment method:\n    *   **RLHF:** train reward model →→\\\\rightarrow use PPO (or other RL algorithm) to optimise policy.\n    *   **DPO:** directly fine-tune model on preference data (skipping RL loop).\n5.  Launch agent into simulated environment (single-turn environments, tool-use environments, or multi-turn environments).\n6.  Run RL policy optimisation in the environment: sample trajectories, estimate advantages/returns, update policy using PPO or variants.\n7.  Periodically evaluate and filter trajectories, adjust reward shaping, fine-tune further for tool-use or long-horizon behaviours.\n\n*   **RLHF:** train reward model →→\\\\rightarrow use PPO (or other RL algorithm) to optimise policy.\n*   **DPO:** directly fine-tune model on preference data (skipping RL loop).\n\nBy selecting algorithms appropriate for the interaction type (single turn vs. tool vs. multi-turn), one can tailor the training for efficiency, stability, and scalability.",
    "order": 21,
    "orderInChapter": 7,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "supervised learning",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 314,
      "contentLength": 6542
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#agent-training-pipeline",
    "scrapedAt": "2025-12-28T11:47:36.152Z"
  },
  {
    "id": "ai-agentic-RL-environment-design-22",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Environment Interaction Patterns for Agent Design",
    "title": "Environment Design",
    "subtitle": "Environment Interaction Patterns for Agent Design",
    "contentHtml": "<ul>\n  <li>\n    <p>Modern RL environments for web and computer-use agents are designed to capture the diversity and complexity of real-world interactions while maintaining enough structure for stable learning. Unlike classical RL benchmarks (e.g., Atari or MuJoCo), these environments involve language, symbolic reasoning, tool use, and visual perception.</p>\n  </li>\n  <li>\n    <p>They are not simply “games” or “control systems” but <strong>interactive ecosystems</strong> that test an agent’s ability to perceive context, reason over multi-step processes, and execute goal-directed actions.</p>\n  </li>\n  <li>\n    <p>To support the training of increasingly capable language-based and multimodal agents, recent frameworks such as <a href=\"https://arxiv.org/abs/2406.04151\">AgentGym</a> by Xi et al. (2024) have introduced a unified taxonomy of environments, each corresponding to a particular <em>interaction modality</em>.</p>\n  </li>\n  <li>\n    <p>At the highest level, these can be grouped into three archetypes:</p>\n\n    <ol>\n      <li><strong>Single-Turn Environments</strong>, designed for one-shot problem solving and precision reasoning.</li>\n      <li><strong>Tool-Use Environments</strong>, optimized for integrating external functions, APIs, or computation tools.</li>\n      <li><strong>Multi-Turn Sequential Environments</strong>, which simulate complex, long-horizon workflows requiring memory, planning, and context adaptation.</li>\n    </ol>\n  </li>\n  <li>\n    <p>Each environment type not only changes how agents act but also how <em>rewards, policies, and credit assignment mechanisms</em> must be designed to drive meaningful learning.</p>\n  </li>\n</ul>\n<p>Modern RL environments for web and computer-use agents are designed to capture the diversity and complexity of real-world interactions while maintaining enough structure for stable learning. Unlike classical RL benchmarks (e.g., Atari or MuJoCo), these environments involve language, symbolic reasoning, tool use, and visual perception.</p>\n<p>They are not simply “games” or “control systems” but <strong>interactive ecosystems</strong> that test an agent’s ability to perceive context, reason over multi-step processes, and execute goal-directed actions.</p>\n<p>To support the training of increasingly capable language-based and multimodal agents, recent frameworks such as <a href=\"https://arxiv.org/abs/2406.04151\">AgentGym</a> by Xi et al. (2024) have introduced a unified taxonomy of environments, each corresponding to a particular <em>interaction modality</em>.</p>\n<p>At the highest level, these can be grouped into three archetypes:</p>\n<ol>\n      <li><strong>Single-Turn Environments</strong>, designed for one-shot problem solving and precision reasoning.</li>\n      <li><strong>Tool-Use Environments</strong>, optimized for integrating external functions, APIs, or computation tools.</li>\n      <li><strong>Multi-Turn Sequential Environments</strong>, which simulate complex, long-horizon workflows requiring memory, planning, and context adaptation.</li>\n    </ol>\n<p>Each environment type not only changes how agents act but also how <em>rewards, policies, and credit assignment mechanisms</em> must be designed to drive meaningful learning.</p>",
    "contentMarkdown": "*   Modern RL environments for web and computer-use agents are designed to capture the diversity and complexity of real-world interactions while maintaining enough structure for stable learning. Unlike classical RL benchmarks (e.g., Atari or MuJoCo), these environments involve language, symbolic reasoning, tool use, and visual perception.\n    \n*   They are not simply “games” or “control systems” but **interactive ecosystems** that test an agent’s ability to perceive context, reason over multi-step processes, and execute goal-directed actions.\n    \n*   To support the training of increasingly capable language-based and multimodal agents, recent frameworks such as [AgentGym](https://arxiv.org/abs/2406.04151) by Xi et al. (2024) have introduced a unified taxonomy of environments, each corresponding to a particular _interaction modality_.\n    \n*   At the highest level, these can be grouped into three archetypes:\n    \n    1.  **Single-Turn Environments**, designed for one-shot problem solving and precision reasoning.\n    2.  **Tool-Use Environments**, optimized for integrating external functions, APIs, or computation tools.\n    3.  **Multi-Turn Sequential Environments**, which simulate complex, long-horizon workflows requiring memory, planning, and context adaptation.\n*   Each environment type not only changes how agents act but also how _rewards, policies, and credit assignment mechanisms_ must be designed to drive meaningful learning.\n    \n\nModern RL environments for web and computer-use agents are designed to capture the diversity and complexity of real-world interactions while maintaining enough structure for stable learning. Unlike classical RL benchmarks (e.g., Atari or MuJoCo), these environments involve language, symbolic reasoning, tool use, and visual perception.\n\nThey are not simply “games” or “control systems” but **interactive ecosystems** that test an agent’s ability to perceive context, reason over multi-step processes, and execute goal-directed actions.\n\nTo support the training of increasingly capable language-based and multimodal agents, recent frameworks such as [AgentGym](https://arxiv.org/abs/2406.04151) by Xi et al. (2024) have introduced a unified taxonomy of environments, each corresponding to a particular _interaction modality_.\n\nAt the highest level, these can be grouped into three archetypes:\n\n1.  **Single-Turn Environments**, designed for one-shot problem solving and precision reasoning.\n2.  **Tool-Use Environments**, optimized for integrating external functions, APIs, or computation tools.\n3.  **Multi-Turn Sequential Environments**, which simulate complex, long-horizon workflows requiring memory, planning, and context adaptation.\n\nEach environment type not only changes how agents act but also how _rewards, policies, and credit assignment mechanisms_ must be designed to drive meaningful learning.",
    "order": 22,
    "orderInChapter": 1,
    "difficulty": 3,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 367,
      "contentLength": 3236
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#environment-design",
    "scrapedAt": "2025-12-28T11:47:36.152Z"
  },
  {
    "id": "ai-agentic-RL-single-turn-environments-23",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Environment Interaction Patterns for Agent Design",
    "title": "Single-Turn Environments",
    "subtitle": "Environment Interaction Patterns for Agent Design",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Single-turn environments</strong> represent the simplest and most direct form of RL training. In this setup, each episode consists of a single interaction: the agent receives an input (prompt, question, or task description), produces one output (answer, code snippet, or solution), and immediately receives feedback.</p>\n  </li>\n  <li>\n    <p>These environments are ideal for optimizing agents that must produce highly accurate outputs in one step—such as coding assistants, math solvers, or document completion systems.</p>\n  </li>\n  <li><strong>Examples:</strong>\n    <ul>\n      <li>Code completion and debugging tasks in <em>CodeRL</em> (<a href=\"https://arxiv.org/abs/2207.01780\">CodeRL: Mastering Code Generation through RL</a> by Le et al., 2022).</li>\n      <li>Question-answering benchmarks like WebGPT (<a href=\"https://arxiv.org/abs/2112.09332\">WebGPT</a> by Nakano et al., 2022)), where the agent’s final response is scored based on correctness and citation quality.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Reward Structure:</strong> Single-turn environments typically use <em>outcome-based rewards</em> rather than step-wise feedback because there is only one output to evaluate. For example:</p>\n\n    <ul>\n      <li>In a coding task, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-247-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo>=</mo><mo>+</mo><mn>1</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3788\" style=\"width: 3.128em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.607em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.5em, 2.398em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3789\"><span class=\"mi\" id=\"MathJax-Span-3790\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3791\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-3792\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">+</span><span class=\"mn\" id=\"MathJax-Span-3793\" style=\"font-family: STIXGeneral-Regular;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo>=</mo><mo>+</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-247\">r = +1</script> if the code executes successfully, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-248-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo>=</mo><mn>0</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3794\" style=\"width: 2.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.03em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3795\"><span class=\"mi\" id=\"MathJax-Span-3796\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3797\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-3798\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo>=</mo><mn>0</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-248\">r = 0</script> otherwise.</li>\n      <li>In a factual QA task, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-249-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3799\" style=\"width: 0.419em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.315em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.32em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3800\"><span class=\"mi\" id=\"MathJax-Span-3801\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-249\">r</script> may represent an F1 score or BLEU score.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Formally, the optimization objective reduces to:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-250-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>&amp;#x223C;</mo><mi>D</mi><mo>,</mo><mi>y</mi><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3802\" style=\"width: 13.128em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1010.84em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3803\"><span class=\"mi\" id=\"MathJax-Span-3804\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3805\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3806\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3807\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3808\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3809\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.586em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3810\"><span class=\"mrow\" id=\"MathJax-Span-3811\"><span class=\"mi\" id=\"MathJax-Span-3812\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3813\"><span class=\"mrow\" id=\"MathJax-Span-3814\"><span class=\"mi\" id=\"MathJax-Span-3815\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3816\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"mi\" id=\"MathJax-Span-3817\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">D</span><span class=\"mo\" id=\"MathJax-Span-3818\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3819\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-3820\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"mi\" id=\"MathJax-Span-3821\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3822\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-3823\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">⋅</span><span class=\"texatom\" id=\"MathJax-Span-3824\"><span class=\"mrow\" id=\"MathJax-Span-3825\"><span class=\"mo\" id=\"MathJax-Span-3826\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-3827\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3828\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3829\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-3830\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-3831\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3832\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3833\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3834\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-3835\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3836\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>π</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>∼</mo><mi>D</mi><mo>,</mo><mi>y</mi><mo>∼</mo><mi>π</mi><mo stretchy=\"false\">(</mo><mo>⋅</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo stretchy=\"false\">[</mo><mi>R</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-250\">J(\\pi) = \\mathbb{E}_{x \\sim D, y \\sim \\pi(\\cdot|x)} [R(x, y)]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-251-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3837\" style=\"width: 3.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.815em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.76em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3838\"><span class=\"mi\" id=\"MathJax-Span-3839\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-3840\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3841\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3842\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3843\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-3844\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-251\">R(x, y)</script> is the final outcome reward.</li>\n    </ul>\n  </li>\n  <li>While simple, such environments serve as critical pretraining stages, allowing models to build domain accuracy before engaging in multi-step reasoning or tool-use.</li>\n</ul>\n<p><strong>Single-turn environments</strong> represent the simplest and most direct form of RL training. In this setup, each episode consists of a single interaction: the agent receives an input (prompt, question, or task description), produces one output (answer, code snippet, or solution), and immediately receives feedback.</p>\n<p>These environments are ideal for optimizing agents that must produce highly accurate outputs in one step—such as coding assistants, math solvers, or document completion systems.</p>\n<ul>\n      <li>Code completion and debugging tasks in <em>CodeRL</em> (<a href=\"https://arxiv.org/abs/2207.01780\">CodeRL: Mastering Code Generation through RL</a> by Le et al., 2022).</li>\n      <li>Question-answering benchmarks like WebGPT (<a href=\"https://arxiv.org/abs/2112.09332\">WebGPT</a> by Nakano et al., 2022)), where the agent’s final response is scored based on correctness and citation quality.</li>\n    </ul>\n<p><strong>Reward Structure:</strong> Single-turn environments typically use <em>outcome-based rewards</em> rather than step-wise feedback because there is only one output to evaluate. For example:</p>\n<ul>\n      <li>In a coding task, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-247-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo>=</mo><mo>+</mo><mn>1</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3788\" style=\"width: 3.128em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.607em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.5em, 2.398em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3789\"><span class=\"mi\" id=\"MathJax-Span-3790\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3791\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-3792\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">+</span><span class=\"mn\" id=\"MathJax-Span-3793\" style=\"font-family: STIXGeneral-Regular;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo>=</mo><mo>+</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-247\">r = +1</script> if the code executes successfully, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-248-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo>=</mo><mn>0</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3794\" style=\"width: 2.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.03em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3795\"><span class=\"mi\" id=\"MathJax-Span-3796\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3797\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-3798\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo>=</mo><mn>0</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-248\">r = 0</script> otherwise.</li>\n      <li>In a factual QA task, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-249-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3799\" style=\"width: 0.419em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.315em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.32em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3800\"><span class=\"mi\" id=\"MathJax-Span-3801\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-249\">r</script> may represent an F1 score or BLEU score.</li>\n    </ul>\n<p>Formally, the optimization objective reduces to:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-251-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3837\" style=\"width: 3.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.815em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.76em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3838\"><span class=\"mi\" id=\"MathJax-Span-3839\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-3840\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3841\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3842\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3843\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-3844\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-251\">R(x, y)</script> is the final outcome reward.</li>\n    </ul>",
    "contentMarkdown": "*   **Single-turn environments** represent the simplest and most direct form of RL training. In this setup, each episode consists of a single interaction: the agent receives an input (prompt, question, or task description), produces one output (answer, code snippet, or solution), and immediately receives feedback.\n    \n*   These environments are ideal for optimizing agents that must produce highly accurate outputs in one step—such as coding assistants, math solvers, or document completion systems.\n    \n*   **Examples:**\n    *   Code completion and debugging tasks in _CodeRL_ ([CodeRL: Mastering Code Generation through RL](https://arxiv.org/abs/2207.01780) by Le et al., 2022).\n    *   Question-answering benchmarks like WebGPT ([WebGPT](https://arxiv.org/abs/2112.09332) by Nakano et al., 2022)), where the agent’s final response is scored based on correctness and citation quality.\n*   **Reward Structure:** Single-turn environments typically use _outcome-based rewards_ rather than step-wise feedback because there is only one output to evaluate. For example:\n    \n    *   In a coding task, r\\=+1r\\=+1r = +1 if the code executes successfully, and r\\=0r\\=0r = 0 otherwise.\n    *   In a factual QA task, rrr may represent an F1 score or BLEU score.\n*   Formally, the optimization objective reduces to:\n    \n    J(π)\\=𝔼x∼D,y∼π(⋅|x)\\[R(x,y)\\]J(π)\\=Ex∼D,y∼π(⋅|x)\\[R(x,y)\\]\n    \n    J(\\\\pi) = \\\\mathbb{E}\\_{x \\\\sim D, y \\\\sim \\\\pi(\\\\cdot|x)} \\[R(x, y)\\]\n    *   where R(x,y)R(x,y)R(x, y) is the final outcome reward.\n*   While simple, such environments serve as critical pretraining stages, allowing models to build domain accuracy before engaging in multi-step reasoning or tool-use.\n\n**Single-turn environments** represent the simplest and most direct form of RL training. In this setup, each episode consists of a single interaction: the agent receives an input (prompt, question, or task description), produces one output (answer, code snippet, or solution), and immediately receives feedback.\n\nThese environments are ideal for optimizing agents that must produce highly accurate outputs in one step—such as coding assistants, math solvers, or document completion systems.\n\n*   Code completion and debugging tasks in _CodeRL_ ([CodeRL: Mastering Code Generation through RL](https://arxiv.org/abs/2207.01780) by Le et al., 2022).\n*   Question-answering benchmarks like WebGPT ([WebGPT](https://arxiv.org/abs/2112.09332) by Nakano et al., 2022)), where the agent’s final response is scored based on correctness and citation quality.\n\n**Reward Structure:** Single-turn environments typically use _outcome-based rewards_ rather than step-wise feedback because there is only one output to evaluate. For example:\n\n*   In a coding task, r\\=+1r\\=+1r = +1 if the code executes successfully, and r\\=0r\\=0r = 0 otherwise.\n*   In a factual QA task, rrr may represent an F1 score or BLEU score.\n\nFormally, the optimization objective reduces to:\n\n*   where R(x,y)R(x,y)R(x, y) is the final outcome reward.",
    "order": 23,
    "orderInChapter": 2,
    "difficulty": 4,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture",
      "gpt",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 404,
      "contentLength": 22598
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#single-turn-environments",
    "scrapedAt": "2025-12-28T11:47:36.152Z"
  },
  {
    "id": "ai-agentic-RL-tool-use-environments-24",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Environment Interaction Patterns for Agent Design",
    "title": "Tool-Use Environments",
    "subtitle": "Environment Interaction Patterns for Agent Design",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Tool-use environments</strong> introduce an additional layer of reasoning: instead of solving a task in one step, the agent must decide when and how to invoke external tools. Tools may include:</p>\n\n    <ul>\n      <li>API calls (e.g., search, translation, or computation),</li>\n      <li>external functions (e.g., symbolic calculators, Python interpreters), or</li>\n      <li>system-level commands (e.g., file access, browser manipulation).</li>\n    </ul>\n  </li>\n  <li>\n    <p>The core challenge is <em>tool orchestration</em>—learning when to rely on external computation versus internal reasoning. For instance, in a data retrieval task, the agent might issue an API query, parse results, and compose a natural-language summary.</p>\n  </li>\n  <li><strong>Reward Structure</strong>:\n    <ul>\n      <li>\n        <p>In tool-use environments, both <em>process-wise</em> and <em>outcome-based</em> rewards are valuable:</p>\n\n        <ul>\n          <li><em>Step-wise rewards</em> can score the accuracy or efficiency of each tool invocation (e.g., correct API parameters or valid JSON structure).</li>\n          <li><em>Outcome-based rewards</em> measure task completion or user satisfaction.</li>\n        </ul>\n      </li>\n      <li>\n        <p>The combined reward signal is often expressed as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-252-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><mi>&amp;#x03B1;</mi><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>process</mtext></mrow></msub><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>outcome</mtext></mrow></msub><mo>,</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3845\" style=\"width: 14.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1012.4em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3846\"><span class=\"msubsup\" id=\"MathJax-Span-3847\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3848\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3849\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3850\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3851\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">α</span><span class=\"msubsup\" id=\"MathJax-Span-3852\"><span style=\"display: inline-block; position: relative; width: 2.607em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3853\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3854\"><span class=\"mrow\" id=\"MathJax-Span-3855\"><span class=\"mtext\" id=\"MathJax-Span-3856\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">process</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3857\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mo\" id=\"MathJax-Span-3858\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">(</span><span class=\"mn\" id=\"MathJax-Span-3859\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-3860\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-3861\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">α</span><span class=\"mo\" id=\"MathJax-Span-3862\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-3863\"><span style=\"display: inline-block; position: relative; width: 2.919em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3864\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3865\"><span class=\"mrow\" id=\"MathJax-Span-3866\"><span class=\"mtext\" id=\"MathJax-Span-3867\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">outcome</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3868\" style=\"font-family: STIXGeneral-Regular;\">,</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><mi>α</mi><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>process</mtext></mrow></msub><mo>+</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy=\"false\">)</mo><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>outcome</mtext></mrow></msub><mo>,</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-252\">R_t = \\alpha r_{\\text{process}} + (1 - \\alpha) r_{\\text{outcome}},</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-253-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3869\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3870\"><span class=\"mi\" id=\"MathJax-Span-3871\" style=\"font-family: STIXGeneral-Italic;\">α</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>α</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-253\">\\alpha</script> controls the balance between short-term and final goal feedback.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Algorithmic Approaches</strong>: Because the action space now includes function arguments and results, methods like policy gradient with structured action representations, hierarchical RL, or model-based planning (e.g., MCTS as in <a href=\"https://arxiv.org/abs/2408.07199\">Agent Q</a> by Putta et al., 2024) become necessary.</p>\n  </li>\n  <li><a href=\"https://doi.org/10.1145/3704435\">Tool Learning with Foundation Models</a> by Qin et al. (2024) provides a comprehensive survey of how foundation models learn to invoke external tools to augment their reasoning capabilities.</li>\n</ul>\n<p><strong>Tool-use environments</strong> introduce an additional layer of reasoning: instead of solving a task in one step, the agent must decide when and how to invoke external tools. Tools may include:</p>\n<ul>\n      <li>API calls (e.g., search, translation, or computation),</li>\n      <li>external functions (e.g., symbolic calculators, Python interpreters), or</li>\n      <li>system-level commands (e.g., file access, browser manipulation).</li>\n    </ul>\n<p>The core challenge is <em>tool orchestration</em>—learning when to rely on external computation versus internal reasoning. For instance, in a data retrieval task, the agent might issue an API query, parse results, and compose a natural-language summary.</p>\n<ul>\n      <li>\n        <p>In tool-use environments, both <em>process-wise</em> and <em>outcome-based</em> rewards are valuable:</p>\n\n        <ul>\n          <li><em>Step-wise rewards</em> can score the accuracy or efficiency of each tool invocation (e.g., correct API parameters or valid JSON structure).</li>\n          <li><em>Outcome-based rewards</em> measure task completion or user satisfaction.</li>\n        </ul>\n      </li>\n      <li>\n        <p>The combined reward signal is often expressed as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-252-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><mi>&amp;#x03B1;</mi><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>process</mtext></mrow></msub><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>outcome</mtext></mrow></msub><mo>,</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3845\" style=\"width: 14.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1012.4em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3846\"><span class=\"msubsup\" id=\"MathJax-Span-3847\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3848\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3849\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3850\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3851\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">α</span><span class=\"msubsup\" id=\"MathJax-Span-3852\"><span style=\"display: inline-block; position: relative; width: 2.607em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3853\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3854\"><span class=\"mrow\" id=\"MathJax-Span-3855\"><span class=\"mtext\" id=\"MathJax-Span-3856\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">process</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3857\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mo\" id=\"MathJax-Span-3858\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">(</span><span class=\"mn\" id=\"MathJax-Span-3859\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-3860\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-3861\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">α</span><span class=\"mo\" id=\"MathJax-Span-3862\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-3863\"><span style=\"display: inline-block; position: relative; width: 2.919em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3864\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3865\"><span class=\"mrow\" id=\"MathJax-Span-3866\"><span class=\"mtext\" id=\"MathJax-Span-3867\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">outcome</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3868\" style=\"font-family: STIXGeneral-Regular;\">,</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><mi>α</mi><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>process</mtext></mrow></msub><mo>+</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy=\"false\">)</mo><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>outcome</mtext></mrow></msub><mo>,</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-252\">R_t = \\alpha r_{\\text{process}} + (1 - \\alpha) r_{\\text{outcome}},</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-253-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3869\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3870\"><span class=\"mi\" id=\"MathJax-Span-3871\" style=\"font-family: STIXGeneral-Italic;\">α</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>α</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-253\">\\alpha</script> controls the balance between short-term and final goal feedback.</li>\n        </ul>\n      </li>\n    </ul>\n<p>In tool-use environments, both <em>process-wise</em> and <em>outcome-based</em> rewards are valuable:</p>\n<ul>\n          <li><em>Step-wise rewards</em> can score the accuracy or efficiency of each tool invocation (e.g., correct API parameters or valid JSON structure).</li>\n          <li><em>Outcome-based rewards</em> measure task completion or user satisfaction.</li>\n        </ul>\n<p>The combined reward signal is often expressed as:</p>\n<ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-253-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3869\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3870\"><span class=\"mi\" id=\"MathJax-Span-3871\" style=\"font-family: STIXGeneral-Italic;\">α</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>α</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-253\">\\alpha</script> controls the balance between short-term and final goal feedback.</li>\n        </ul>\n<p><strong>Algorithmic Approaches</strong>: Because the action space now includes function arguments and results, methods like policy gradient with structured action representations, hierarchical RL, or model-based planning (e.g., MCTS as in <a href=\"https://arxiv.org/abs/2408.07199\">Agent Q</a> by Putta et al., 2024) become necessary.</p>",
    "contentMarkdown": "*   **Tool-use environments** introduce an additional layer of reasoning: instead of solving a task in one step, the agent must decide when and how to invoke external tools. Tools may include:\n    \n    *   API calls (e.g., search, translation, or computation),\n    *   external functions (e.g., symbolic calculators, Python interpreters), or\n    *   system-level commands (e.g., file access, browser manipulation).\n*   The core challenge is _tool orchestration_—learning when to rely on external computation versus internal reasoning. For instance, in a data retrieval task, the agent might issue an API query, parse results, and compose a natural-language summary.\n    \n*   **Reward Structure**:\n    *   In tool-use environments, both _process-wise_ and _outcome-based_ rewards are valuable:\n        \n        *   _Step-wise rewards_ can score the accuracy or efficiency of each tool invocation (e.g., correct API parameters or valid JSON structure).\n        *   _Outcome-based rewards_ measure task completion or user satisfaction.\n    *   The combined reward signal is often expressed as:\n        \n        Rt\\=αrprocess+(1−α)routcome,Rt\\=αrprocess+(1−α)routcome,\n        \n        R\\_t = \\\\alpha r\\_{\\\\text{process}} + (1 - \\\\alpha) r\\_{\\\\text{outcome}},\n        *   where αα\\\\alpha controls the balance between short-term and final goal feedback.\n*   **Algorithmic Approaches**: Because the action space now includes function arguments and results, methods like policy gradient with structured action representations, hierarchical RL, or model-based planning (e.g., MCTS as in [Agent Q](https://arxiv.org/abs/2408.07199) by Putta et al., 2024) become necessary.\n    \n*   [Tool Learning with Foundation Models](https://doi.org/10.1145/3704435) by Qin et al. (2024) provides a comprehensive survey of how foundation models learn to invoke external tools to augment their reasoning capabilities.\n\n**Tool-use environments** introduce an additional layer of reasoning: instead of solving a task in one step, the agent must decide when and how to invoke external tools. Tools may include:\n\n*   API calls (e.g., search, translation, or computation),\n*   external functions (e.g., symbolic calculators, Python interpreters), or\n*   system-level commands (e.g., file access, browser manipulation).\n\nThe core challenge is _tool orchestration_—learning when to rely on external computation versus internal reasoning. For instance, in a data retrieval task, the agent might issue an API query, parse results, and compose a natural-language summary.\n\n*   In tool-use environments, both _process-wise_ and _outcome-based_ rewards are valuable:\n    \n    *   _Step-wise rewards_ can score the accuracy or efficiency of each tool invocation (e.g., correct API parameters or valid JSON structure).\n    *   _Outcome-based rewards_ measure task completion or user satisfaction.\n*   The combined reward signal is often expressed as:\n    \n    Rt\\=αrprocess+(1−α)routcome,Rt\\=αrprocess+(1−α)routcome,\n    \n    R\\_t = \\\\alpha r\\_{\\\\text{process}} + (1 - \\\\alpha) r\\_{\\\\text{outcome}},\n    *   where αα\\\\alpha controls the balance between short-term and final goal feedback.\n\nIn tool-use environments, both _process-wise_ and _outcome-based_ rewards are valuable:\n\n*   _Step-wise rewards_ can score the accuracy or efficiency of each tool invocation (e.g., correct API parameters or valid JSON structure).\n*   _Outcome-based rewards_ measure task completion or user satisfaction.\n\nThe combined reward signal is often expressed as:\n\n*   where αα\\\\alpha controls the balance between short-term and final goal feedback.\n\n**Algorithmic Approaches**: Because the action space now includes function arguments and results, methods like policy gradient with structured action representations, hierarchical RL, or model-based planning (e.g., MCTS as in [Agent Q](https://arxiv.org/abs/2408.07199) by Putta et al., 2024) become necessary.",
    "order": 24,
    "orderInChapter": 3,
    "difficulty": 4,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 497,
      "contentLength": 18943
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#tool-use-environments",
    "scrapedAt": "2025-12-28T11:47:36.152Z"
  },
  {
    "id": "ai-agentic-RL-multi-turn-sequential-environments-25",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Environment Interaction Patterns for Agent Design",
    "title": "Multi-Turn Sequential Environments",
    "subtitle": "Environment Interaction Patterns for Agent Design",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Multi-turn environments</strong> simulate complex, multi-step workflows where each decision influences future context. These environments are designed for agents that need to plan, adapt, and maintain consistency across many turns of interaction.</p>\n  </li>\n  <li>\n    <p><strong>Examples:</strong></p>\n\n    <ul>\n      <li>Web navigation agents such as <a href=\"https://arxiv.org/abs/2410.19609\">OpenWebVoyager</a> by He et al. (2024), where the agent browses, clicks, and fills forms over multiple steps.</li>\n      <li>Software operation tasks like system configuration, spreadsheet editing, or email management.</li>\n      <li>Interactive tutoring and dialogue planning systems.</li>\n    </ul>\n  </li>\n  <li><strong>Reward Structure:</strong>\n    <ul>\n      <li>\n        <p>In multi-turn environments setups, pure outcome-based rewards (success/failure) can cause <em>credit assignment problems</em> because the agent receives feedback only after many steps. To address this, researchers combine <strong>process-wise rewards</strong>—for subgoal completion, error reduction, or partial correctness—with <strong>final outcome rewards</strong>.</p>\n      </li>\n      <li>\n        <p>Formally, the expected return in such environments can be represented as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-254-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>s</mi></mrow></mrow></msubsup><mo>+</mo><mi>&amp;#x03BB;</mi><mo>,</mo><msubsup><mi>r</mi><mi>T</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>e</mi></mrow></mrow></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3872\" style=\"width: 19.273em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.044em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1015.73em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3873\"><span class=\"mi\" id=\"MathJax-Span-3874\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3875\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3876\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3877\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3878\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-3879\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-3880\"><span class=\"mi\" id=\"MathJax-Span-3881\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span class=\"mrow\" id=\"MathJax-Span-3882\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-3883\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-3884\"><span class=\"munderover\" id=\"MathJax-Span-3885\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3886\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.99em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-3887\"><span class=\"mrow\" id=\"MathJax-Span-3888\"><span class=\"mi\" id=\"MathJax-Span-3889\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3890\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3891\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-3892\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3893\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3894\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3895\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3896\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-3897\"><span class=\"mo\" id=\"MathJax-Span-3898\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3899\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3900\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1002.19em, 4.326em, -999.997em); top: -4.529em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3901\"><span class=\"mrow\" id=\"MathJax-Span-3902\"><span class=\"texatom\" id=\"MathJax-Span-3903\"><span class=\"mrow\" id=\"MathJax-Span-3904\"><span class=\"mi\" id=\"MathJax-Span-3905\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">p</span><span class=\"mi\" id=\"MathJax-Span-3906\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3907\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-3908\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">c</span><span class=\"mi\" id=\"MathJax-Span-3909\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-3910\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">s</span><span class=\"mi\" id=\"MathJax-Span-3911\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">s</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3912\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3913\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3914\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">λ</span><span class=\"mo\" id=\"MathJax-Span-3915\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3916\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3917\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1002.5em, 4.169em, -999.997em); top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3918\"><span class=\"mrow\" id=\"MathJax-Span-3919\"><span class=\"texatom\" id=\"MathJax-Span-3920\"><span class=\"mrow\" id=\"MathJax-Span-3921\"><span class=\"mi\" id=\"MathJax-Span-3922\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-3923\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">u</span><span class=\"mi\" id=\"MathJax-Span-3924\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3925\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">c</span><span class=\"mi\" id=\"MathJax-Span-3926\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-3927\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">m</span><span class=\"mi\" id=\"MathJax-Span-3928\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -3.695em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3929\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3930\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-3931\"><span class=\"mo\" id=\"MathJax-Span-3932\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3933\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>π</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msup><mi>γ</mi><mi>t</mi></msup><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">p</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">c</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">s</mi><mi mathvariant=\"normal\">s</mi></mrow></mrow></msubsup><mo>+</mo><mi>λ</mi><mo>,</mo><msubsup><mi>r</mi><mi>T</mi><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">u</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">c</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">e</mi></mrow></mrow></msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-254\">J(\\pi) = \\mathbb{E}\\left[\\sum_{t=1}^T \\gamma^t \\big( r_t^{\\mathrm{process}} + \\lambda , r_T^{\\mathrm{outcome}} \\big)\\right]</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-255-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BB;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3934\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3935\"><span class=\"mi\" id=\"MathJax-Span-3936\" style=\"font-family: STIXGeneral-Italic;\">λ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>λ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-255\">\\lambda</script> balances intermediate and terminal objectives.</li>\n        </ul>\n      </li>\n      <li>\n        <p>In OpenWebVoyager, for example, each sub-action (like opening the correct link) contributes partial reward, guiding the agent toward long-term success while preventing divergence from optimal sequences.</p>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Learning Dynamics:</strong> Training in multi-turn environments requires:</p>\n\n    <ul>\n      <li>Long-horizon credit assignment via temporal-difference learning or advantage estimation.</li>\n      <li>Hierarchical RL for decomposing tasks into sub-policies.</li>\n      <li>Trajectory filtering and reward shaping to combat sparse or noisy signals.</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Multi-turn environments</strong> simulate complex, multi-step workflows where each decision influences future context. These environments are designed for agents that need to plan, adapt, and maintain consistency across many turns of interaction.</p>\n<p><strong>Examples:</strong></p>\n<ul>\n      <li>Web navigation agents such as <a href=\"https://arxiv.org/abs/2410.19609\">OpenWebVoyager</a> by He et al. (2024), where the agent browses, clicks, and fills forms over multiple steps.</li>\n      <li>Software operation tasks like system configuration, spreadsheet editing, or email management.</li>\n      <li>Interactive tutoring and dialogue planning systems.</li>\n    </ul>\n<ul>\n      <li>\n        <p>In multi-turn environments setups, pure outcome-based rewards (success/failure) can cause <em>credit assignment problems</em> because the agent receives feedback only after many steps. To address this, researchers combine <strong>process-wise rewards</strong>—for subgoal completion, error reduction, or partial correctness—with <strong>final outcome rewards</strong>.</p>\n      </li>\n      <li>\n        <p>Formally, the expected return in such environments can be represented as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-254-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>s</mi></mrow></mrow></msubsup><mo>+</mo><mi>&amp;#x03BB;</mi><mo>,</mo><msubsup><mi>r</mi><mi>T</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>e</mi></mrow></mrow></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3872\" style=\"width: 19.273em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.044em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1015.73em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3873\"><span class=\"mi\" id=\"MathJax-Span-3874\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3875\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3876\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3877\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3878\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-3879\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-3880\"><span class=\"mi\" id=\"MathJax-Span-3881\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span class=\"mrow\" id=\"MathJax-Span-3882\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-3883\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-3884\"><span class=\"munderover\" id=\"MathJax-Span-3885\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3886\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.99em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-3887\"><span class=\"mrow\" id=\"MathJax-Span-3888\"><span class=\"mi\" id=\"MathJax-Span-3889\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3890\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3891\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-3892\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3893\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3894\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3895\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3896\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-3897\"><span class=\"mo\" id=\"MathJax-Span-3898\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3899\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3900\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1002.19em, 4.326em, -999.997em); top: -4.529em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3901\"><span class=\"mrow\" id=\"MathJax-Span-3902\"><span class=\"texatom\" id=\"MathJax-Span-3903\"><span class=\"mrow\" id=\"MathJax-Span-3904\"><span class=\"mi\" id=\"MathJax-Span-3905\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">p</span><span class=\"mi\" id=\"MathJax-Span-3906\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3907\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-3908\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">c</span><span class=\"mi\" id=\"MathJax-Span-3909\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-3910\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">s</span><span class=\"mi\" id=\"MathJax-Span-3911\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">s</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3912\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3913\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3914\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">λ</span><span class=\"mo\" id=\"MathJax-Span-3915\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3916\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3917\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1002.5em, 4.169em, -999.997em); top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3918\"><span class=\"mrow\" id=\"MathJax-Span-3919\"><span class=\"texatom\" id=\"MathJax-Span-3920\"><span class=\"mrow\" id=\"MathJax-Span-3921\"><span class=\"mi\" id=\"MathJax-Span-3922\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-3923\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">u</span><span class=\"mi\" id=\"MathJax-Span-3924\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3925\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">c</span><span class=\"mi\" id=\"MathJax-Span-3926\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-3927\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">m</span><span class=\"mi\" id=\"MathJax-Span-3928\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -3.695em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3929\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3930\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-3931\"><span class=\"mo\" id=\"MathJax-Span-3932\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3933\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>π</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msup><mi>γ</mi><mi>t</mi></msup><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">p</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">c</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">s</mi><mi mathvariant=\"normal\">s</mi></mrow></mrow></msubsup><mo>+</mo><mi>λ</mi><mo>,</mo><msubsup><mi>r</mi><mi>T</mi><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">u</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">c</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">e</mi></mrow></mrow></msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-254\">J(\\pi) = \\mathbb{E}\\left[\\sum_{t=1}^T \\gamma^t \\big( r_t^{\\mathrm{process}} + \\lambda , r_T^{\\mathrm{outcome}} \\big)\\right]</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-255-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BB;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3934\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3935\"><span class=\"mi\" id=\"MathJax-Span-3936\" style=\"font-family: STIXGeneral-Italic;\">λ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>λ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-255\">\\lambda</script> balances intermediate and terminal objectives.</li>\n        </ul>\n      </li>\n      <li>\n        <p>In OpenWebVoyager, for example, each sub-action (like opening the correct link) contributes partial reward, guiding the agent toward long-term success while preventing divergence from optimal sequences.</p>\n      </li>\n    </ul>\n<p>In multi-turn environments setups, pure outcome-based rewards (success/failure) can cause <em>credit assignment problems</em> because the agent receives feedback only after many steps. To address this, researchers combine <strong>process-wise rewards</strong>—for subgoal completion, error reduction, or partial correctness—with <strong>final outcome rewards</strong>.</p>\n<p>Formally, the expected return in such environments can be represented as:</p>\n<ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-255-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BB;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3934\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3935\"><span class=\"mi\" id=\"MathJax-Span-3936\" style=\"font-family: STIXGeneral-Italic;\">λ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>λ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-255\">\\lambda</script> balances intermediate and terminal objectives.</li>\n        </ul>\n<p>In OpenWebVoyager, for example, each sub-action (like opening the correct link) contributes partial reward, guiding the agent toward long-term success while preventing divergence from optimal sequences.</p>\n<p><strong>Learning Dynamics:</strong> Training in multi-turn environments requires:</p>\n<ul>\n      <li>Long-horizon credit assignment via temporal-difference learning or advantage estimation.</li>\n      <li>Hierarchical RL for decomposing tasks into sub-policies.</li>\n      <li>Trajectory filtering and reward shaping to combat sparse or noisy signals.</li>\n    </ul>",
    "contentMarkdown": "*   **Multi-turn environments** simulate complex, multi-step workflows where each decision influences future context. These environments are designed for agents that need to plan, adapt, and maintain consistency across many turns of interaction.\n    \n*   **Examples:**\n    \n    *   Web navigation agents such as [OpenWebVoyager](https://arxiv.org/abs/2410.19609) by He et al. (2024), where the agent browses, clicks, and fills forms over multiple steps.\n    *   Software operation tasks like system configuration, spreadsheet editing, or email management.\n    *   Interactive tutoring and dialogue planning systems.\n*   **Reward Structure:**\n    *   In multi-turn environments setups, pure outcome-based rewards (success/failure) can cause _credit assignment problems_ because the agent receives feedback only after many steps. To address this, researchers combine **process-wise rewards**—for subgoal completion, error reduction, or partial correctness—with **final outcome rewards**.\n        \n    *   Formally, the expected return in such environments can be represented as:\n        \n        J(π)\\=𝔼\\[∑t\\=1Tγt(rprocesst+λ,routcomeT)\\]J(π)\\=E\\[∑t\\=1Tγt(rtprocess+λ,rToutcome)\\]\n        \n        J(\\\\pi) = \\\\mathbb{E}\\\\left\\[\\\\sum\\_{t=1}^T \\\\gamma^t \\\\big( r\\_t^{\\\\mathrm{process}} + \\\\lambda , r\\_T^{\\\\mathrm{outcome}} \\\\big)\\\\right\\]\n        *   where λλ\\\\lambda balances intermediate and terminal objectives.\n    *   In OpenWebVoyager, for example, each sub-action (like opening the correct link) contributes partial reward, guiding the agent toward long-term success while preventing divergence from optimal sequences.\n        \n*   **Learning Dynamics:** Training in multi-turn environments requires:\n    \n    *   Long-horizon credit assignment via temporal-difference learning or advantage estimation.\n    *   Hierarchical RL for decomposing tasks into sub-policies.\n    *   Trajectory filtering and reward shaping to combat sparse or noisy signals.\n\n**Multi-turn environments** simulate complex, multi-step workflows where each decision influences future context. These environments are designed for agents that need to plan, adapt, and maintain consistency across many turns of interaction.\n\n**Examples:**\n\n*   Web navigation agents such as [OpenWebVoyager](https://arxiv.org/abs/2410.19609) by He et al. (2024), where the agent browses, clicks, and fills forms over multiple steps.\n*   Software operation tasks like system configuration, spreadsheet editing, or email management.\n*   Interactive tutoring and dialogue planning systems.\n\n*   In multi-turn environments setups, pure outcome-based rewards (success/failure) can cause _credit assignment problems_ because the agent receives feedback only after many steps. To address this, researchers combine **process-wise rewards**—for subgoal completion, error reduction, or partial correctness—with **final outcome rewards**.\n    \n*   Formally, the expected return in such environments can be represented as:\n    \n    J(π)\\=𝔼\\[∑t\\=1Tγt(rprocesst+λ,routcomeT)\\]J(π)\\=E\\[∑t\\=1Tγt(rtprocess+λ,rToutcome)\\]\n    \n    J(\\\\pi) = \\\\mathbb{E}\\\\left\\[\\\\sum\\_{t=1}^T \\\\gamma^t \\\\big( r\\_t^{\\\\mathrm{process}} + \\\\lambda , r\\_T^{\\\\mathrm{outcome}} \\\\big)\\\\right\\]\n    *   where λλ\\\\lambda balances intermediate and terminal objectives.\n*   In OpenWebVoyager, for example, each sub-action (like opening the correct link) contributes partial reward, guiding the agent toward long-term success while preventing divergence from optimal sequences.\n    \n\nIn multi-turn environments setups, pure outcome-based rewards (success/failure) can cause _credit assignment problems_ because the agent receives feedback only after many steps. To address this, researchers combine **process-wise rewards**—for subgoal completion, error reduction, or partial correctness—with **final outcome rewards**.\n\nFormally, the expected return in such environments can be represented as:\n\n*   where λλ\\\\lambda balances intermediate and terminal objectives.\n\nIn OpenWebVoyager, for example, each sub-action (like opening the correct link) contributes partial reward, guiding the agent toward long-term success while preventing divergence from optimal sequences.\n\n**Learning Dynamics:** Training in multi-turn environments requires:\n\n*   Long-horizon credit assignment via temporal-difference learning or advantage estimation.\n*   Hierarchical RL for decomposing tasks into sub-policies.\n*   Trajectory filtering and reward shaping to combat sparse or noisy signals.",
    "order": 25,
    "orderInChapter": 4,
    "difficulty": 4,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 510,
      "contentLength": 34394
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#multi-turn-sequential-environments",
    "scrapedAt": "2025-12-28T11:47:36.153Z"
  },
  {
    "id": "ai-agentic-RL-designing-rewards-for-complex-agent-environments-26",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Environment Interaction Patterns for Agent Design",
    "title": "Designing Rewards for Complex Agent Environments",
    "subtitle": "Environment Interaction Patterns for Agent Design",
    "contentHtml": "<ul>\n  <li>Reward engineering is arguably the most critical part of environment design. Different environment types benefit from distinct reward strategies:</li>\n</ul>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Environment Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reward Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Typical Signal</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Optimization Goal</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Single-Turn Environments</td>\n<td class=\"tg-tleft-valign-first\">Outcome-based</td>\n<td class=\"tg-tleft-valign-first\">Correctness, BLEU/F1 score</td>\n<td class=\"tg-tleft-valign-second\">Precision and factual accuracy</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Tool-Use Environments</td>\n<td class=\"tg-tleft-valign-first\">Hybrid (step-wise + outcome)</td>\n<td class=\"tg-tleft-valign-first\">Tool correctness, API success</td>\n<td class=\"tg-tleft-valign-second\">Functional reasoning, tool reliability</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Multi-Turn Environments</td>\n<td class=\"tg-tleft-valign-first\">Step-wise + delayed outcome</td>\n<td class=\"tg-tleft-valign-first\">Subgoal completion, navigation success</td>\n<td class=\"tg-tleft-valign-second\">Long-horizon planning, autonomy</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Environment Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reward Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Typical Signal</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Optimization Goal</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Single-Turn Environments</td>\n<td class=\"tg-tleft-valign-first\">Outcome-based</td>\n<td class=\"tg-tleft-valign-first\">Correctness, BLEU/F1 score</td>\n<td class=\"tg-tleft-valign-second\">Precision and factual accuracy</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Tool-Use Environments</td>\n<td class=\"tg-tleft-valign-first\">Hybrid (step-wise + outcome)</td>\n<td class=\"tg-tleft-valign-first\">Tool correctness, API success</td>\n<td class=\"tg-tleft-valign-second\">Functional reasoning, tool reliability</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Multi-Turn Environments</td>\n<td class=\"tg-tleft-valign-first\">Step-wise + delayed outcome</td>\n<td class=\"tg-tleft-valign-first\">Subgoal completion, navigation success</td>\n<td class=\"tg-tleft-valign-second\">Long-horizon planning, autonomy</td>\n</tr>\n</tbody>\n</table>\n<ul>\n  <li>Balancing process-wise and outcome-based rewards ensures that agents receive <em>dense feedback for learning efficiency</em> while still optimizing toward <em>global objectives</em> like success rate or user satisfaction.</li>\n</ul>",
    "contentMarkdown": "*   Reward engineering is arguably the most critical part of environment design. Different environment types benefit from distinct reward strategies:\n\n**Environment Type**\n\n**Reward Type**\n\n**Typical Signal**\n\n**Optimization Goal**\n\nSingle-Turn Environments\n\nOutcome-based\n\nCorrectness, BLEU/F1 score\n\nPrecision and factual accuracy\n\nTool-Use Environments\n\nHybrid (step-wise + outcome)\n\nTool correctness, API success\n\nFunctional reasoning, tool reliability\n\nMulti-Turn Environments\n\nStep-wise + delayed outcome\n\nSubgoal completion, navigation success\n\nLong-horizon planning, autonomy\n\n**Environment Type**\n\n**Reward Type**\n\n**Typical Signal**\n\n**Optimization Goal**\n\nSingle-Turn Environments\n\nOutcome-based\n\nCorrectness, BLEU/F1 score\n\nPrecision and factual accuracy\n\nTool-Use Environments\n\nHybrid (step-wise + outcome)\n\nTool correctness, API success\n\nFunctional reasoning, tool reliability\n\nMulti-Turn Environments\n\nStep-wise + delayed outcome\n\nSubgoal completion, navigation success\n\nLong-horizon planning, autonomy\n\n*   Balancing process-wise and outcome-based rewards ensures that agents receive _dense feedback for learning efficiency_ while still optimizing toward _global objectives_ like success rate or user satisfaction.",
    "order": 26,
    "orderInChapter": 5,
    "difficulty": 3,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 137,
      "contentLength": 2863
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#designing-rewards-for-complex-agent-environments",
    "scrapedAt": "2025-12-28T11:47:36.153Z"
  },
  {
    "id": "ai-agentic-RL-implications-for-agent-design-and-evaluation-27",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Environment Interaction Patterns for Agent Design",
    "title": "Implications for Agent Design and Evaluation",
    "subtitle": "Environment Interaction Patterns for Agent Design",
    "contentHtml": "<ul>\n  <li>\n    <p>Each environment type imposes unique requirements on model architecture, reward shaping, and evaluation metrics.</p>\n\n    <ol>\n      <li><strong>Single-turn environments</strong> favors compact policies and fast evaluation loops, suitable for smaller RL batches or DPO-based optimization.</li>\n      <li><strong>Tool-use environments</strong> requires compositional reasoning and structured memory to maintain tool-call histories and argument dependencies.</li>\n      <li><strong>Multi-turn environments</strong> demands long-context modeling, world-state tracking, and temporal credit assignment across potentially hundreds of steps.</li>\n    </ol>\n  </li>\n  <li>\n    <p>Evaluation metrics vary accordingly:</p>\n\n    <ul>\n      <li><em>Single-turn</em>: Accuracy, F1, pass rate.</li>\n      <li><em>Tool-use</em>: Tool-call correctness, latency, success ratio.</li>\n      <li><em>Multi-turn</em>: Task completion rate, cumulative reward, consistency, and planning efficiency.</li>\n    </ul>\n  </li>\n  <li>\n    <p>When integrated properly, these environment classes form a <strong>curriculum</strong> for RL-based agent development: agents begin with static, outcome-driven reasoning (single-turn environments), progress to dynamic, tool-integrated reasoning (tool-use environments), and culminate in fully autonomous multi-turn reasoning (multi-turn environments).</p>\n  </li>\n</ul>\n<p>Each environment type imposes unique requirements on model architecture, reward shaping, and evaluation metrics.</p>\n<ol>\n      <li><strong>Single-turn environments</strong> favors compact policies and fast evaluation loops, suitable for smaller RL batches or DPO-based optimization.</li>\n      <li><strong>Tool-use environments</strong> requires compositional reasoning and structured memory to maintain tool-call histories and argument dependencies.</li>\n      <li><strong>Multi-turn environments</strong> demands long-context modeling, world-state tracking, and temporal credit assignment across potentially hundreds of steps.</li>\n    </ol>\n<p>Evaluation metrics vary accordingly:</p>\n<ul>\n      <li><em>Single-turn</em>: Accuracy, F1, pass rate.</li>\n      <li><em>Tool-use</em>: Tool-call correctness, latency, success ratio.</li>\n      <li><em>Multi-turn</em>: Task completion rate, cumulative reward, consistency, and planning efficiency.</li>\n    </ul>\n<p>When integrated properly, these environment classes form a <strong>curriculum</strong> for RL-based agent development: agents begin with static, outcome-driven reasoning (single-turn environments), progress to dynamic, tool-integrated reasoning (tool-use environments), and culminate in fully autonomous multi-turn reasoning (multi-turn environments).</p>",
    "contentMarkdown": "*   Each environment type imposes unique requirements on model architecture, reward shaping, and evaluation metrics.\n    \n    1.  **Single-turn environments** favors compact policies and fast evaluation loops, suitable for smaller RL batches or DPO-based optimization.\n    2.  **Tool-use environments** requires compositional reasoning and structured memory to maintain tool-call histories and argument dependencies.\n    3.  **Multi-turn environments** demands long-context modeling, world-state tracking, and temporal credit assignment across potentially hundreds of steps.\n*   Evaluation metrics vary accordingly:\n    \n    *   _Single-turn_: Accuracy, F1, pass rate.\n    *   _Tool-use_: Tool-call correctness, latency, success ratio.\n    *   _Multi-turn_: Task completion rate, cumulative reward, consistency, and planning efficiency.\n*   When integrated properly, these environment classes form a **curriculum** for RL-based agent development: agents begin with static, outcome-driven reasoning (single-turn environments), progress to dynamic, tool-integrated reasoning (tool-use environments), and culminate in fully autonomous multi-turn reasoning (multi-turn environments).\n    \n\nEach environment type imposes unique requirements on model architecture, reward shaping, and evaluation metrics.\n\n1.  **Single-turn environments** favors compact policies and fast evaluation loops, suitable for smaller RL batches or DPO-based optimization.\n2.  **Tool-use environments** requires compositional reasoning and structured memory to maintain tool-call histories and argument dependencies.\n3.  **Multi-turn environments** demands long-context modeling, world-state tracking, and temporal credit assignment across potentially hundreds of steps.\n\nEvaluation metrics vary accordingly:\n\n*   _Single-turn_: Accuracy, F1, pass rate.\n*   _Tool-use_: Tool-call correctness, latency, success ratio.\n*   _Multi-turn_: Task completion rate, cumulative reward, consistency, and planning efficiency.\n\nWhen integrated properly, these environment classes form a **curriculum** for RL-based agent development: agents begin with static, outcome-driven reasoning (single-turn environments), progress to dynamic, tool-integrated reasoning (tool-use environments), and culminate in fully autonomous multi-turn reasoning (multi-turn environments).",
    "order": 27,
    "orderInChapter": 6,
    "difficulty": 3,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 263,
      "contentLength": 2725
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#implications-for-agent-design-and-evaluation",
    "scrapedAt": "2025-12-28T11:47:36.153Z"
  },
  {
    "id": "ai-agentic-RL-comparative-analysis-28",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Environment Interaction Patterns for Agent Design",
    "title": "Comparative Analysis",
    "subtitle": "Environment Interaction Patterns for Agent Design",
    "contentHtml": "<ul>\n  <li>\n    <p>Environment design is the foundation on which modern RL agents learn to generalize and act. The interplay between <strong>interaction modality</strong>, <strong>reward granularity</strong>, and <strong>algorithmic strategy</strong> determines not only how fast an agent learns but also what kinds of intelligence it develops.</p>\n\n    <ul>\n      <li>Single-turn environments teach <em>accuracy</em>.</li>\n      <li>Tool-use environments teach <em>functional reasoning</em>.</li>\n      <li>Multi-turn environments teach <em>autonomy and adaptability</em>.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Together, they form a progression of increasing sophistication—mirroring the cognitive layers of reasoning, planning, and execution. RL algorithms like PPO and DPO serve as the connective tissue between these layers, transforming static pretrained models into active, evolving agents capable of navigating and operating within real digital ecosystems.</p>\n  </li>\n</ul>\n<p>Environment design is the foundation on which modern RL agents learn to generalize and act. The interplay between <strong>interaction modality</strong>, <strong>reward granularity</strong>, and <strong>algorithmic strategy</strong> determines not only how fast an agent learns but also what kinds of intelligence it develops.</p>\n<ul>\n      <li>Single-turn environments teach <em>accuracy</em>.</li>\n      <li>Tool-use environments teach <em>functional reasoning</em>.</li>\n      <li>Multi-turn environments teach <em>autonomy and adaptability</em>.</li>\n    </ul>\n<p>Together, they form a progression of increasing sophistication—mirroring the cognitive layers of reasoning, planning, and execution. RL algorithms like PPO and DPO serve as the connective tissue between these layers, transforming static pretrained models into active, evolving agents capable of navigating and operating within real digital ecosystems.</p>",
    "contentMarkdown": "*   Environment design is the foundation on which modern RL agents learn to generalize and act. The interplay between **interaction modality**, **reward granularity**, and **algorithmic strategy** determines not only how fast an agent learns but also what kinds of intelligence it develops.\n    \n    *   Single-turn environments teach _accuracy_.\n    *   Tool-use environments teach _functional reasoning_.\n    *   Multi-turn environments teach _autonomy and adaptability_.\n*   Together, they form a progression of increasing sophistication—mirroring the cognitive layers of reasoning, planning, and execution. RL algorithms like PPO and DPO serve as the connective tissue between these layers, transforming static pretrained models into active, evolving agents capable of navigating and operating within real digital ecosystems.\n    \n\nEnvironment design is the foundation on which modern RL agents learn to generalize and act. The interplay between **interaction modality**, **reward granularity**, and **algorithmic strategy** determines not only how fast an agent learns but also what kinds of intelligence it develops.\n\n*   Single-turn environments teach _accuracy_.\n*   Tool-use environments teach _functional reasoning_.\n*   Multi-turn environments teach _autonomy and adaptability_.\n\nTogether, they form a progression of increasing sophistication—mirroring the cognitive layers of reasoning, planning, and execution. RL algorithms like PPO and DPO serve as the connective tissue between these layers, transforming static pretrained models into active, evolving agents capable of navigating and operating within real digital ecosystems.",
    "order": 28,
    "orderInChapter": 7,
    "difficulty": 3,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 214,
      "contentLength": 1907
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#comparative-analysis",
    "scrapedAt": "2025-12-28T11:47:36.153Z"
  },
  {
    "id": "ai-agentic-RL-the-role-of-reward-modeling-29",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Reward Modeling",
    "title": "The Role of Reward Modeling",
    "subtitle": "Reward Modeling",
    "contentHtml": "<ul>\n  <li>\n    <p>Reward modeling lies at the heart of RL systems for language, web, and computer-use agents. In traditional RL, the reward function is hand-crafted to quantify success—for example, the score in a game or the distance to a goal. In contrast, modern LLM-based agents operate in open-ended environments where the notion of “correctness” or “helpfulness” is inherently subjective and context-dependent.</p>\n  </li>\n  <li>\n    <p>To handle this, reward models (RMs) are trained to approximate human judgment. Instead of manually defining numerical rewards, the system learns a function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-256-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3937\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3938\"><span class=\"msubsup\" id=\"MathJax-Span-3939\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3940\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3941\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3942\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3943\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3944\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3945\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-3946\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-256\">r_\\phi(x, y)</script> that predicts the quality of an agent’s output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-257-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3947\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3948\"><span class=\"mi\" id=\"MathJax-Span-3949\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-257\">y</script> for a given input <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-258-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3950\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3951\"><span class=\"mi\" id=\"MathJax-Span-3952\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-258\">x</script>. These RMs are usually fine-tuned on preference datasets where human annotators rank outputs from best to worst.</p>\n  </li>\n  <li>\n    <p>Formally, given a dataset of comparisons <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-259-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>y</mi><mi>i</mi><mo>+</mo></msubsup><mo>,</mo><msubsup><mi>y</mi><mi>i</mi><mo>&amp;#x2212;</mo></msubsup><mo stretchy=&quot;false&quot;>)</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3953\" style=\"width: 7.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1006.15em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3954\"><span class=\"mi\" id=\"MathJax-Span-3955\" style=\"font-family: STIXGeneral-Italic;\">D</span><span class=\"mo\" id=\"MathJax-Span-3956\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-3957\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-3958\"><span class=\"mo\" id=\"MathJax-Span-3959\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3960\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3961\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3962\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3963\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3964\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3965\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.58em, 4.221em, -999.997em); top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-3966\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3967\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3968\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3969\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3970\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.58em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-3971\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3972\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3973\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>D</mi><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>y</mi><mi>i</mi><mo>+</mo></msubsup><mo>,</mo><msubsup><mi>y</mi><mi>i</mi><mo>−</mo></msubsup><mo stretchy=\"false\">)</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-259\">D = {(x_i, y_i^+, y_i^-)}</script>, the reward model is trained to maximize:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-260-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>RM</mtext></mrow></msub><mo>=</mo><mo>&amp;#x2212;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msup><mi>y</mi><mo>+</mo></msup><mo>,</mo><msup><mi>y</mi><mo>&amp;#x2212;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><mi>D</mi></mrow></msub><mrow><mo>[</mo><mrow><mi>log</mi><mo>&amp;#x2061;</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msup><mi>y</mi><mo>+</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msup><mi>y</mi><mo>&amp;#x2212;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3974\" style=\"width: 23.544em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 19.586em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1019.43em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3975\"><span class=\"msubsup\" id=\"MathJax-Span-3976\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3977\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3978\"><span class=\"mrow\" id=\"MathJax-Span-3979\"><span class=\"mtext\" id=\"MathJax-Span-3980\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">RM</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3981\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-3982\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-3983\"><span style=\"display: inline-block; position: relative; width: 4.273em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3984\"><span class=\"mrow\" id=\"MathJax-Span-3985\"><span class=\"mi\" id=\"MathJax-Span-3986\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3987\"><span class=\"mrow\" id=\"MathJax-Span-3988\"><span class=\"mo\" id=\"MathJax-Span-3989\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3990\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3991\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3992\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3993\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.216em; left: 0.315em;\"><span class=\"mo\" id=\"MathJax-Span-3994\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">+</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3995\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3996\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3997\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.216em; left: 0.315em;\"><span class=\"mo\" id=\"MathJax-Span-3998\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">−</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3999\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4000\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"mi\" id=\"MathJax-Span-4001\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">D</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-4002\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-4003\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-4004\"><span class=\"mi\" id=\"MathJax-Span-4005\" style=\"font-family: STIXGeneral-Regular;\">log</span><span class=\"mo\" id=\"MathJax-Span-4006\"></span><span class=\"mi\" id=\"MathJax-Span-4007\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4008\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4009\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4010\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4011\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4012\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4013\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4014\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4015\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4016\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4017\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4018\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4019\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-4020\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4021\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4022\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4023\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4024\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4025\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4026\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4027\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4028\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4029\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4030\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-4031\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>RM</mtext></mrow></msub><mo>=</mo><mo>−</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msup><mi>y</mi><mo>+</mo></msup><mo>,</mo><msup><mi>y</mi><mo>−</mo></msup><mo stretchy=\"false\">)</mo><mo>∼</mo><mi>D</mi></mrow></msub><mrow><mo>[</mo><mrow><mi>log</mi><mo>⁡</mo><mi>σ</mi><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msup><mi>y</mi><mo>+</mo></msup><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>r</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msup><mi>y</mi><mo>−</mo></msup><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-260\">L_{\\text{RM}} = -\\mathbb{E}_{(x, y^+, y^-)\\sim D}\\left[\\log \\sigma(r_\\phi(x, y^+) - r_\\phi(x, y^-))\\right]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-261-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4032\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4033\"><span class=\"mi\" id=\"MathJax-Span-4034\" style=\"font-family: STIXGeneral-Italic;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>σ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-261\">\\sigma</script> is the logistic function, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-262-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4035\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.89em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4036\"><span class=\"msubsup\" id=\"MathJax-Span-4037\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4038\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4039\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-262\">r_\\phi</script> outputs a scalar reward. The resulting model can then guide PPO updates, Direct Preference Optimization (DPO), or other RL pipelines.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Reward modeling thus replaces explicit rule-based objectives with <em>learned evaluators</em>—a fundamental shift that enables agents to align with nuanced human preferences across web, reasoning, and tool-use tasks.</p>\n  </li>\n  <li>\n    <p><a href=\"https://arxiv.org/abs/2510.08558\">Agent Learning via Early Experience</a> by Zhang et al. (2025)) states that in practice, reward signals can be complemented by reward-free, language-native supervision gathered before RL—so the policy starts “aligned to the environment” even without verifiable rewards. Two pre-RL objectives from early, agent-generated interaction data are especially useful: an implicit world-modeling loss that predicts next states given state–action pairs, and a self-reflection loss that learns to compare expert vs. non-expert actions in natural language. Concretely:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\"><span class=\"MathJax MathJax_FullWidth\" id=\"MathJax-Element-263-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>I</mi><mi mathvariant=&quot;normal&quot;>W</mi><mi mathvariant=&quot;normal&quot;>M</mi></mrow></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>a</mi><mi>i</mi><mi>j</mi></msubsup><mo>,</mo><msubsup><mi>s</mi><mi>i</mi><mi>j</mi></msubsup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2208;</mo><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>rollout</mtext></mrow></msub></mrow></munder><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mrow><mo>(</mo><mrow><msubsup><mi>s</mi><mi>i</mi><mi>j</mi></msubsup><mo>,</mo><mrow class=&quot;MJX-TeXAtom-CLOSE&quot;></mrow><mo>|</mo><mrow class=&quot;MJX-TeXAtom-OPEN&quot;></mrow><mo>,</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>a</mi><mi>i</mi><mi>j</mi></msubsup></mrow><mo>)</mo></mrow><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>S</mi><mi mathvariant=&quot;normal&quot;>R</mi></mrow></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></munder><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mrow><mo>(</mo><mrow><msubsup><mi>c</mi><mi>i</mi><mi>j</mi></msubsup><mo>,</mo><mrow class=&quot;MJX-TeXAtom-CLOSE&quot;></mrow><mo>|</mo><mrow class=&quot;MJX-TeXAtom-OPEN&quot;></mrow><mo>,</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>a</mi><mi>i</mi><mi>j</mi></msubsup><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>s</mi><mi>i</mi><mi>j</mi></msubsup></mrow><mo>)</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4040\" style=\"width: 100%; display: inline-block; min-width: 25.211em;\"><span style=\"display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(6.148em, 1020.84em, 12.763em, -999.997em); top: -7.289em; left: 0em; width: 100%;\"><span class=\"mrow\" id=\"MathJax-Span-4041\"><span style=\"display: inline-block; position: relative; width: 100%; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1018.23em, 5.836em, -999.997em); top: -4.008em; left: 50%; margin-left: -9.164em;\"><span class=\"msubsup\" id=\"MathJax-Span-4042\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4043\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4044\"><span class=\"mrow\" id=\"MathJax-Span-4045\"><span class=\"texatom\" id=\"MathJax-Span-4046\"><span class=\"mrow\" id=\"MathJax-Span-4047\"><span class=\"mi\" id=\"MathJax-Span-4048\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">I</span><span class=\"mi\" id=\"MathJax-Span-4049\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">W</span><span class=\"mi\" id=\"MathJax-Span-4050\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">M</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4051\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4052\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4053\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4054\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-4055\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">−</span><span class=\"munderover\" id=\"MathJax-Span-4056\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 4.69em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 1.721em;\"><span class=\"mo\" id=\"MathJax-Span-4057\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1004.69em, 4.482em, -999.997em); top: -2.654em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4058\"><span class=\"mrow\" id=\"MathJax-Span-4059\"><span class=\"mo\" id=\"MathJax-Span-4060\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4061\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4062\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-4063\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4064\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4065\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4066\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.21em, 4.273em, -999.997em); top: -4.372em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4067\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.21em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4068\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4069\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4070\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4071\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.21em, 4.273em, -999.997em); top: -4.372em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-4072\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.21em, 4.169em, -999.997em); top: -3.799em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-4073\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4074\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4075\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∈</span><span class=\"msubsup\" id=\"MathJax-Span-4076\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4077\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4078\"><span class=\"mrow\" id=\"MathJax-Span-4079\"><span class=\"mtext\" id=\"MathJax-Span-4080\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">rollout</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-4081\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-4082\"></span><span class=\"msubsup\" id=\"MathJax-Span-4083\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4084\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4085\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-4086\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-4087\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span><span class=\"mrow\" id=\"MathJax-Span-4088\"><span class=\"msubsup\" id=\"MathJax-Span-4089\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4090\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.326em, -999.997em); top: -4.477em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4091\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4092\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4093\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-4094\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4095\"></span></span><span class=\"mo\" id=\"MathJax-Span-4096\" style=\"vertical-align: 0.94em;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -3.331em; left: 0em;\">∣<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -2.81em; left: 0em;\">∣<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4097\"><span class=\"mrow\" id=\"MathJax-Span-4098\"></span></span><span class=\"mo\" id=\"MathJax-Span-4099\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4100\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4101\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4102\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4103\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4104\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4105\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.326em, -999.997em); top: -4.477em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4106\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4107\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4108\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4109\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(2.242em, 1020.84em, 5.732em, -999.997em); top: -0.258em; left: 50%; margin-left: -10.466em;\"><span class=\"mspace\" id=\"MathJax-Span-4110\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-4111\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4112\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4113\"><span class=\"mrow\" id=\"MathJax-Span-4114\"><span class=\"texatom\" id=\"MathJax-Span-4115\"><span class=\"mrow\" id=\"MathJax-Span-4116\"><span class=\"mi\" id=\"MathJax-Span-4117\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">S</span><span class=\"mi\" id=\"MathJax-Span-4118\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">R</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4119\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4120\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4121\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4122\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-4123\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">−</span><span class=\"munderover\" id=\"MathJax-Span-4124\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4125\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4126\"><span class=\"mrow\" id=\"MathJax-Span-4127\"><span class=\"mi\" id=\"MathJax-Span-4128\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-4129\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4130\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.94em, 4.43em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-4131\"><span class=\"mrow\" id=\"MathJax-Span-4132\"><span class=\"mi\" id=\"MathJax-Span-4133\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4134\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-4135\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.52em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-4136\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-4137\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-4138\"></span><span class=\"msubsup\" id=\"MathJax-Span-4139\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4140\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4141\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-4142\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-4143\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span><span class=\"mrow\" id=\"MathJax-Span-4144\"><span class=\"msubsup\" id=\"MathJax-Span-4145\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4146\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.326em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4148\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4149\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-4150\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4151\"></span></span><span class=\"mo\" id=\"MathJax-Span-4152\" style=\"vertical-align: 0.94em;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -3.331em; left: 0em;\">∣<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -2.81em; left: 0em;\">∣<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4153\"><span class=\"mrow\" id=\"MathJax-Span-4154\"></span></span><span class=\"mo\" id=\"MathJax-Span-4155\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4156\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4157\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4158\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4159\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4160\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4161\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.326em, -999.997em); top: -4.477em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4162\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4163\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4164\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4165\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4166\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4167\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4168\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4169\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4170\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-4171\"><span class=\"mrow\" id=\"MathJax-Span-4172\"><span class=\"mi\" id=\"MathJax-Span-4173\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-4174\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-4175\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4176\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4177\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4178\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.326em, -999.997em); top: -4.477em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4179\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4180\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4181\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.169em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 7.294em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -6.434em; border-left: 0px solid; width: 0px; height: 7.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">I</mi><mi mathvariant=\"normal\">W</mi><mi mathvariant=\"normal\">M</mi></mrow></mrow></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>a</mi><mi>i</mi><mi>j</mi></msubsup><mo>,</mo><msubsup><mi>s</mi><mi>i</mi><mi>j</mi></msubsup><mo stretchy=\"false\">)</mo><mo>∈</mo><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>rollout</mtext></mrow></msub></mrow></munder><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mrow><mo>(</mo><mrow><msubsup><mi>s</mi><mi>i</mi><mi>j</mi></msubsup><mo>,</mo><mrow class=\"MJX-TeXAtom-CLOSE\"></mrow><mo>|</mo><mrow class=\"MJX-TeXAtom-OPEN\"></mrow><mo>,</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>a</mi><mi>i</mi><mi>j</mi></msubsup></mrow><mo>)</mo></mrow><mo>,</mo><mspace width=\"1em\"></mspace><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">S</mi><mi mathvariant=\"normal\">R</mi></mrow></mrow></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi></mrow></munder><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mrow><mo>(</mo><mrow><msubsup><mi>c</mi><mi>i</mi><mi>j</mi></msubsup><mo>,</mo><mrow class=\"MJX-TeXAtom-CLOSE\"></mrow><mo>|</mo><mrow class=\"MJX-TeXAtom-OPEN\"></mrow><mo>,</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>a</mi><mi>i</mi><mi>j</mi></msubsup><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>s</mi><mi>i</mi><mi>j</mi></msubsup></mrow><mo>)</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-263\">L_{\\mathrm{IWM}}(\\theta) = - \\sum_{(s_i,a_i^j,s_i^j)\\in D_{\\text{rollout}}}\\log p_\\theta\\left(s_i^j ,\\middle|, s_i, a_i^j\\right),\\quad\n  L_{\\mathrm{SR}}(\\theta)=-\\sum_{i}\\sum_{j=1}^K \\log p_\\theta\\left(c_i^j ,\\middle|, s_i, a_i^j, a_i, s_{i+1}, s_i^j\\right)</script>\n\n    <ul>\n      <li>\n        <p>which warm-start policies and reduce distribution shift ahead of PPO/GRPO or DPO, improving sample efficiency in web and tool-use settings.</p>\n      </li>\n      <li>\n        <p>The following figure shows an overview of the two early experience approaches. Implicit world modeling (left) augments expert trajectories with alternative actions and predicted next states, training the policy to internalize transition dynamics before deployment. Self-reflection (right) augments expert actions with self-generated explanations c1, training the policy to reason about and revise its own decisions. Both methods use alternative actions proposed by the initial policy (LLM). The number of alternatives <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-264-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4182\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4183\"><span class=\"mi\" id=\"MathJax-Span-4184\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-264\">K</script> is a hyperparameter; for brevity, only one is illustrated.</p>\n      </li>\n    </ul>\n\n    <p><img src=\"/primers/ai/assets/RL-for-agents/EarlyExperience2.jpg\" alt=\"\"></p>\n  </li>\n</ul>\n<p>Reward modeling lies at the heart of RL systems for language, web, and computer-use agents. In traditional RL, the reward function is hand-crafted to quantify success—for example, the score in a game or the distance to a goal. In contrast, modern LLM-based agents operate in open-ended environments where the notion of “correctness” or “helpfulness” is inherently subjective and context-dependent.</p>\n<p>To handle this, reward models (RMs) are trained to approximate human judgment. Instead of manually defining numerical rewards, the system learns a function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-256-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3937\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3938\"><span class=\"msubsup\" id=\"MathJax-Span-3939\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3940\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3941\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3942\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3943\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3944\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3945\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-3946\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-256\">r_\\phi(x, y)</script> that predicts the quality of an agent’s output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-257-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3947\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3948\"><span class=\"mi\" id=\"MathJax-Span-3949\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-257\">y</script> for a given input <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-258-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3950\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3951\"><span class=\"mi\" id=\"MathJax-Span-3952\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-258\">x</script>. These RMs are usually fine-tuned on preference datasets where human annotators rank outputs from best to worst.</p>\n<p>Formally, given a dataset of comparisons <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-259-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>y</mi><mi>i</mi><mo>+</mo></msubsup><mo>,</mo><msubsup><mi>y</mi><mi>i</mi><mo>&amp;#x2212;</mo></msubsup><mo stretchy=&quot;false&quot;>)</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3953\" style=\"width: 7.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1006.15em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3954\"><span class=\"mi\" id=\"MathJax-Span-3955\" style=\"font-family: STIXGeneral-Italic;\">D</span><span class=\"mo\" id=\"MathJax-Span-3956\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-3957\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-3958\"><span class=\"mo\" id=\"MathJax-Span-3959\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3960\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3961\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3962\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3963\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3964\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3965\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.58em, 4.221em, -999.997em); top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-3966\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3967\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3968\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3969\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3970\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.58em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-3971\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3972\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3973\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>D</mi><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>y</mi><mi>i</mi><mo>+</mo></msubsup><mo>,</mo><msubsup><mi>y</mi><mi>i</mi><mo>−</mo></msubsup><mo stretchy=\"false\">)</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-259\">D = {(x_i, y_i^+, y_i^-)}</script>, the reward model is trained to maximize:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-261-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4032\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4033\"><span class=\"mi\" id=\"MathJax-Span-4034\" style=\"font-family: STIXGeneral-Italic;\">σ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>σ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-261\">\\sigma</script> is the logistic function, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-262-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4035\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.89em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4036\"><span class=\"msubsup\" id=\"MathJax-Span-4037\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4038\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4039\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-262\">r_\\phi</script> outputs a scalar reward. The resulting model can then guide PPO updates, Direct Preference Optimization (DPO), or other RL pipelines.</li>\n    </ul>\n<p>Reward modeling thus replaces explicit rule-based objectives with <em>learned evaluators</em>—a fundamental shift that enables agents to align with nuanced human preferences across web, reasoning, and tool-use tasks.</p>\n<p><a href=\"https://arxiv.org/abs/2510.08558\">Agent Learning via Early Experience</a> by Zhang et al. (2025)) states that in practice, reward signals can be complemented by reward-free, language-native supervision gathered before RL—so the policy starts “aligned to the environment” even without verifiable rewards. Two pre-RL objectives from early, agent-generated interaction data are especially useful: an implicit world-modeling loss that predicts next states given state–action pairs, and a self-reflection loss that learns to compare expert vs. non-expert actions in natural language. Concretely:</p>\n<ul>\n      <li>\n        <p>which warm-start policies and reduce distribution shift ahead of PPO/GRPO or DPO, improving sample efficiency in web and tool-use settings.</p>\n      </li>\n      <li>\n        <p>The following figure shows an overview of the two early experience approaches. Implicit world modeling (left) augments expert trajectories with alternative actions and predicted next states, training the policy to internalize transition dynamics before deployment. Self-reflection (right) augments expert actions with self-generated explanations c1, training the policy to reason about and revise its own decisions. Both methods use alternative actions proposed by the initial policy (LLM). The number of alternatives <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-264-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4182\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4183\"><span class=\"mi\" id=\"MathJax-Span-4184\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-264\">K</script> is a hyperparameter; for brevity, only one is illustrated.</p>\n      </li>\n    </ul>\n<p>which warm-start policies and reduce distribution shift ahead of PPO/GRPO or DPO, improving sample efficiency in web and tool-use settings.</p>\n<p>The following figure shows an overview of the two early experience approaches. Implicit world modeling (left) augments expert trajectories with alternative actions and predicted next states, training the policy to internalize transition dynamics before deployment. Self-reflection (right) augments expert actions with self-generated explanations c1, training the policy to reason about and revise its own decisions. Both methods use alternative actions proposed by the initial policy (LLM). The number of alternatives <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-264-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4182\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4183\"><span class=\"mi\" id=\"MathJax-Span-4184\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-264\">K</script> is a hyperparameter; for brevity, only one is illustrated.</p>\n<p><img src=\"/primers/ai/assets/RL-for-agents/EarlyExperience2.jpg\" alt=\"\"></p>",
    "contentMarkdown": "*   Reward modeling lies at the heart of RL systems for language, web, and computer-use agents. In traditional RL, the reward function is hand-crafted to quantify success—for example, the score in a game or the distance to a goal. In contrast, modern LLM-based agents operate in open-ended environments where the notion of “correctness” or “helpfulness” is inherently subjective and context-dependent.\n    \n*   To handle this, reward models (RMs) are trained to approximate human judgment. Instead of manually defining numerical rewards, the system learns a function rϕ(x,y)rϕ(x,y)r\\_\\\\phi(x, y) that predicts the quality of an agent’s output yyy for a given input xxx. These RMs are usually fine-tuned on preference datasets where human annotators rank outputs from best to worst.\n    \n*   Formally, given a dataset of comparisons D\\=(xi,y+i,y−i)D\\=(xi,yi+,yi−)D = {(x\\_i, y\\_i^+, y\\_i^-)}, the reward model is trained to maximize:\n    \n    LRM\\=−𝔼(x,y+,y−)∼D\\[logσ(rϕ(x,y+)−rϕ(x,y−))\\]LRM\\=−E(x,y+,y−)∼D\\[log⁡σ(rϕ(x,y+)−rϕ(x,y−))\\]\n    \n    L\\_{\\\\text{RM}} = -\\\\mathbb{E}\\_{(x, y^+, y^-)\\\\sim D}\\\\left\\[\\\\log \\\\sigma(r\\_\\\\phi(x, y^+) - r\\_\\\\phi(x, y^-))\\\\right\\]\n    *   where σσ\\\\sigma is the logistic function, and rϕrϕr\\_\\\\phi outputs a scalar reward. The resulting model can then guide PPO updates, Direct Preference Optimization (DPO), or other RL pipelines.\n*   Reward modeling thus replaces explicit rule-based objectives with _learned evaluators_—a fundamental shift that enables agents to align with nuanced human preferences across web, reasoning, and tool-use tasks.\n    \n*   [Agent Learning via Early Experience](https://arxiv.org/abs/2510.08558) by Zhang et al. (2025)) states that in practice, reward signals can be complemented by reward-free, language-native supervision gathered before RL—so the policy starts “aligned to the environment” even without verifiable rewards. Two pre-RL objectives from early, agent-generated interaction data are especially useful: an implicit world-modeling loss that predicts next states given state–action pairs, and a self-reflection loss that learns to compare expert vs. non-expert actions in natural language. Concretely:\n    \n    LIWM(θ)\\=−∑(si,aji,sji)∈Drolloutlogpθ(sji,∣∣,si,aji),LSR(θ)\\=−∑i∑j\\=1Klogpθ(cji,∣∣,si,aji,ai,si+1,sji)LIWM(θ)\\=−∑(si,aij,sij)∈Drolloutlog⁡pθ(sij,|,si,aij),LSR(θ)\\=−∑i∑j\\=1Klog⁡pθ(cij,|,si,aij,ai,si+1,sij)\n    \n    L\\_{\\\\mathrm{IWM}}(\\\\theta) = - \\\\sum\\_{(s\\_i,a\\_i^j,s\\_i^j)\\\\in D\\_{\\\\text{rollout}}}\\\\log p\\_\\\\theta\\\\left(s\\_i^j ,\\\\middle|, s\\_i, a\\_i^j\\\\right),\\\\quad L\\_{\\\\mathrm{SR}}(\\\\theta)=-\\\\sum\\_{i}\\\\sum\\_{j=1}^K \\\\log p\\_\\\\theta\\\\left(c\\_i^j ,\\\\middle|, s\\_i, a\\_i^j, a\\_i, s\\_{i+1}, s\\_i^j\\\\right)\n    \n    *   which warm-start policies and reduce distribution shift ahead of PPO/GRPO or DPO, improving sample efficiency in web and tool-use settings.\n        \n    *   The following figure shows an overview of the two early experience approaches. Implicit world modeling (left) augments expert trajectories with alternative actions and predicted next states, training the policy to internalize transition dynamics before deployment. Self-reflection (right) augments expert actions with self-generated explanations c1, training the policy to reason about and revise its own decisions. Both methods use alternative actions proposed by the initial policy (LLM). The number of alternatives KKK is a hyperparameter; for brevity, only one is illustrated.\n        \n    \n    ![](/primers/ai/assets/RL-for-agents/EarlyExperience2.jpg)\n    \n\nReward modeling lies at the heart of RL systems for language, web, and computer-use agents. In traditional RL, the reward function is hand-crafted to quantify success—for example, the score in a game or the distance to a goal. In contrast, modern LLM-based agents operate in open-ended environments where the notion of “correctness” or “helpfulness” is inherently subjective and context-dependent.\n\nTo handle this, reward models (RMs) are trained to approximate human judgment. Instead of manually defining numerical rewards, the system learns a function rϕ(x,y)rϕ(x,y)r\\_\\\\phi(x, y) that predicts the quality of an agent’s output yyy for a given input xxx. These RMs are usually fine-tuned on preference datasets where human annotators rank outputs from best to worst.\n\nFormally, given a dataset of comparisons D\\=(xi,y+i,y−i)D\\=(xi,yi+,yi−)D = {(x\\_i, y\\_i^+, y\\_i^-)}, the reward model is trained to maximize:\n\n*   where σσ\\\\sigma is the logistic function, and rϕrϕr\\_\\\\phi outputs a scalar reward. The resulting model can then guide PPO updates, Direct Preference Optimization (DPO), or other RL pipelines.\n\nReward modeling thus replaces explicit rule-based objectives with _learned evaluators_—a fundamental shift that enables agents to align with nuanced human preferences across web, reasoning, and tool-use tasks.\n\n[Agent Learning via Early Experience](https://arxiv.org/abs/2510.08558) by Zhang et al. (2025)) states that in practice, reward signals can be complemented by reward-free, language-native supervision gathered before RL—so the policy starts “aligned to the environment” even without verifiable rewards. Two pre-RL objectives from early, agent-generated interaction data are especially useful: an implicit world-modeling loss that predicts next states given state–action pairs, and a self-reflection loss that learns to compare expert vs. non-expert actions in natural language. Concretely:\n\n*   which warm-start policies and reduce distribution shift ahead of PPO/GRPO or DPO, improving sample efficiency in web and tool-use settings.\n    \n*   The following figure shows an overview of the two early experience approaches. Implicit world modeling (left) augments expert trajectories with alternative actions and predicted next states, training the policy to internalize transition dynamics before deployment. Self-reflection (right) augments expert actions with self-generated explanations c1, training the policy to reason about and revise its own decisions. Both methods use alternative actions proposed by the initial policy (LLM). The number of alternatives KKK is a hyperparameter; for brevity, only one is illustrated.\n    \n\nwhich warm-start policies and reduce distribution shift ahead of PPO/GRPO or DPO, improving sample efficiency in web and tool-use settings.\n\nThe following figure shows an overview of the two early experience approaches. Implicit world modeling (left) augments expert trajectories with alternative actions and predicted next states, training the policy to internalize transition dynamics before deployment. Self-reflection (right) augments expert actions with self-generated explanations c1, training the policy to reason about and revise its own decisions. Both methods use alternative actions proposed by the initial policy (LLM). The number of alternatives KKK is a hyperparameter; for brevity, only one is illustrated.\n\n![](/primers/ai/assets/RL-for-agents/EarlyExperience2.jpg)",
    "order": 29,
    "orderInChapter": 1,
    "difficulty": 4,
    "estimatedMinutes": 5,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 870,
      "contentLength": 81352
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#the-role-of-reward-modeling",
    "scrapedAt": "2025-12-28T11:47:36.153Z"
  },
  {
    "id": "ai-agentic-RL-process-wise-and-outcome-based-reward-integration-30",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Reward Modeling",
    "title": "Process-Wise and Outcome-Based Reward Integration",
    "subtitle": "Reward Modeling",
    "contentHtml": "<ul>\n  <li>\n    <p>When training agents in realistic, multi-step environments, reward signals can be categorized as <strong>process-wise (step-wise)</strong> or <strong>outcome-based</strong>. Both serve complementary roles:</p>\n\n    <ol>\n      <li><strong>Outcome-Based Rewards:</strong>\n        <ul>\n          <li>These are terminal signals received once the task is complete—such as a success flag, accuracy score, or human satisfaction rating.</li>\n          <li>For instance, in a booking agent, a positive reward may be given only when the reservation is successfully completed.</li>\n        </ul>\n      </li>\n      <li><strong>Process-Wise (Step-Wise) Rewards:</strong>\n        <ul>\n          <li>These provide intermediate feedback after each step or subgoal, rewarding partial correctness, progress, or efficiency.</li>\n          <li>In web navigation, an agent might receive a small positive reward for clicking the correct button or locating relevant text, even before reaching the final goal.</li>\n        </ul>\n      </li>\n    </ol>\n  </li>\n  <li>\n    <p>The challenge is balancing the two. Purely outcome-based training can lead to <em>sparse reward problems</em>, while purely process-based training risks <em>overfitting local heuristics</em> that do not generalize.</p>\n  </li>\n  <li>\n    <p>A common hybrid formulation is:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-265-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><mi>&amp;#x03B1;</mi><mo>,</mo><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>process</mtext></mrow></msubsup><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mi>T</mi></mrow></msub><mo>,</mo><msubsup><mi>r</mi><mi>T</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>outcome</mtext></mrow></msubsup></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4185\" style=\"width: 18.128em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 15.107em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1015.11em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4186\"><span class=\"msubsup\" id=\"MathJax-Span-4187\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4188\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4189\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4190\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4191\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">α</span><span class=\"mo\" id=\"MathJax-Span-4192\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4193\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4194\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1002.19em, 4.326em, -999.997em); top: -4.529em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4195\"><span class=\"mrow\" id=\"MathJax-Span-4196\"><span class=\"mtext\" id=\"MathJax-Span-4197\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">process</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4198\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4199\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mo\" id=\"MathJax-Span-4200\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">(</span><span class=\"mn\" id=\"MathJax-Span-4201\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-4202\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-4203\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">α</span><span class=\"mo\" id=\"MathJax-Span-4204\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4205\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4206\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4207\" style=\"font-family: STIXGeneral-Italic;\">δ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4208\"><span class=\"mrow\" id=\"MathJax-Span-4209\"><span class=\"mi\" id=\"MathJax-Span-4210\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4211\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mi\" id=\"MathJax-Span-4212\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4213\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4214\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4215\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1002.5em, 4.169em, -999.997em); top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4216\"><span class=\"mrow\" id=\"MathJax-Span-4217\"><span class=\"mtext\" id=\"MathJax-Span-4218\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">outcome</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -3.695em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4219\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><mi>α</mi><mo>,</mo><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>process</mtext></mrow></msubsup><mo>+</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy=\"false\">)</mo><mo>,</mo><msub><mi>δ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mi>T</mi></mrow></msub><mo>,</mo><msubsup><mi>r</mi><mi>T</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>outcome</mtext></mrow></msubsup></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-265\">r_t = \\alpha , r_t^{\\text{process}} + (1 - \\alpha) , \\delta_{t=T} , r_T^{\\text{outcome}}</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-266-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4220\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.86em, 2.555em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4221\"><span class=\"mi\" id=\"MathJax-Span-4222\" style=\"font-family: STIXGeneral-Italic;\">α</span><span class=\"mo\" id=\"MathJax-Span-4223\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"mo\" id=\"MathJax-Span-4224\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">[</span><span class=\"mn\" id=\"MathJax-Span-4225\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-4226\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-4227\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-4228\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>α</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-266\">\\alpha \\in [0, 1]</script> controls the tradeoff between intermediate shaping and final goal alignment.</li>\n    </ul>\n  </li>\n  <li>\n    <p>In practical web-agent training, hybrid reward models may leverage both:</p>\n\n    <ul>\n      <li><strong>Synthetic process feedback</strong> (automated evaluators for substeps),</li>\n      <li><strong>Human outcome feedback</strong> (ranking complete trajectories).</li>\n    </ul>\n  </li>\n  <li>\n    <p>A scalable way to create dense, shaped feedback is to synthesize experience with a reasoning-based experience model that produces consistent next states and vectorized, unified feedback signals in a textual state space. This enables closed-loop RL without expensive real-environment rollouts and supports curriculum generation that targets the current policy’s weaknesses; empirically it yields &gt;30% gains on non-RL-ready tasks like WebArena and can match PPO/GRPO using only synthetic interactions (<a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025)).</p>\n  </li>\n</ul>\n<p>When training agents in realistic, multi-step environments, reward signals can be categorized as <strong>process-wise (step-wise)</strong> or <strong>outcome-based</strong>. Both serve complementary roles:</p>\n<ol>\n      <li><strong>Outcome-Based Rewards:</strong>\n        <ul>\n          <li>These are terminal signals received once the task is complete—such as a success flag, accuracy score, or human satisfaction rating.</li>\n          <li>For instance, in a booking agent, a positive reward may be given only when the reservation is successfully completed.</li>\n        </ul>\n      </li>\n      <li><strong>Process-Wise (Step-Wise) Rewards:</strong>\n        <ul>\n          <li>These provide intermediate feedback after each step or subgoal, rewarding partial correctness, progress, or efficiency.</li>\n          <li>In web navigation, an agent might receive a small positive reward for clicking the correct button or locating relevant text, even before reaching the final goal.</li>\n        </ul>\n      </li>\n    </ol>\n<ul>\n          <li>These are terminal signals received once the task is complete—such as a success flag, accuracy score, or human satisfaction rating.</li>\n          <li>For instance, in a booking agent, a positive reward may be given only when the reservation is successfully completed.</li>\n        </ul>\n<ul>\n          <li>These provide intermediate feedback after each step or subgoal, rewarding partial correctness, progress, or efficiency.</li>\n          <li>In web navigation, an agent might receive a small positive reward for clicking the correct button or locating relevant text, even before reaching the final goal.</li>\n        </ul>\n<p>The challenge is balancing the two. Purely outcome-based training can lead to <em>sparse reward problems</em>, while purely process-based training risks <em>overfitting local heuristics</em> that do not generalize.</p>\n<p>A common hybrid formulation is:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-266-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4220\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.86em, 2.555em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4221\"><span class=\"mi\" id=\"MathJax-Span-4222\" style=\"font-family: STIXGeneral-Italic;\">α</span><span class=\"mo\" id=\"MathJax-Span-4223\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∈</span><span class=\"mo\" id=\"MathJax-Span-4224\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">[</span><span class=\"mn\" id=\"MathJax-Span-4225\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-4226\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-4227\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-4228\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>α</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-266\">\\alpha \\in [0, 1]</script> controls the tradeoff between intermediate shaping and final goal alignment.</li>\n    </ul>\n<p>In practical web-agent training, hybrid reward models may leverage both:</p>\n<ul>\n      <li><strong>Synthetic process feedback</strong> (automated evaluators for substeps),</li>\n      <li><strong>Human outcome feedback</strong> (ranking complete trajectories).</li>\n    </ul>\n<p>A scalable way to create dense, shaped feedback is to synthesize experience with a reasoning-based experience model that produces consistent next states and vectorized, unified feedback signals in a textual state space. This enables closed-loop RL without expensive real-environment rollouts and supports curriculum generation that targets the current policy’s weaknesses; empirically it yields &gt;30% gains on non-RL-ready tasks like WebArena and can match PPO/GRPO using only synthetic interactions (<a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025)).</p>",
    "contentMarkdown": "*   When training agents in realistic, multi-step environments, reward signals can be categorized as **process-wise (step-wise)** or **outcome-based**. Both serve complementary roles:\n    \n    1.  **Outcome-Based Rewards:**\n        *   These are terminal signals received once the task is complete—such as a success flag, accuracy score, or human satisfaction rating.\n        *   For instance, in a booking agent, a positive reward may be given only when the reservation is successfully completed.\n    2.  **Process-Wise (Step-Wise) Rewards:**\n        *   These provide intermediate feedback after each step or subgoal, rewarding partial correctness, progress, or efficiency.\n        *   In web navigation, an agent might receive a small positive reward for clicking the correct button or locating relevant text, even before reaching the final goal.\n*   The challenge is balancing the two. Purely outcome-based training can lead to _sparse reward problems_, while purely process-based training risks _overfitting local heuristics_ that do not generalize.\n    \n*   A common hybrid formulation is:\n    \n    rt\\=α,rprocesst+(1−α),δt\\=T,routcomeTrt\\=α,rtprocess+(1−α),δt\\=T,rToutcome\n    \n    r\\_t = \\\\alpha , r\\_t^{\\\\text{process}} + (1 - \\\\alpha) , \\\\delta\\_{t=T} , r\\_T^{\\\\text{outcome}}\n    *   where α∈\\[0,1\\]α∈\\[0,1\\]\\\\alpha \\\\in \\[0, 1\\] controls the tradeoff between intermediate shaping and final goal alignment.\n*   In practical web-agent training, hybrid reward models may leverage both:\n    \n    *   **Synthetic process feedback** (automated evaluators for substeps),\n    *   **Human outcome feedback** (ranking complete trajectories).\n*   A scalable way to create dense, shaped feedback is to synthesize experience with a reasoning-based experience model that produces consistent next states and vectorized, unified feedback signals in a textual state space. This enables closed-loop RL without expensive real-environment rollouts and supports curriculum generation that targets the current policy’s weaknesses; empirically it yields >30% gains on non-RL-ready tasks like WebArena and can match PPO/GRPO using only synthetic interactions ([Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025)).\n    \n\nWhen training agents in realistic, multi-step environments, reward signals can be categorized as **process-wise (step-wise)** or **outcome-based**. Both serve complementary roles:\n\n1.  **Outcome-Based Rewards:**\n    *   These are terminal signals received once the task is complete—such as a success flag, accuracy score, or human satisfaction rating.\n    *   For instance, in a booking agent, a positive reward may be given only when the reservation is successfully completed.\n2.  **Process-Wise (Step-Wise) Rewards:**\n    *   These provide intermediate feedback after each step or subgoal, rewarding partial correctness, progress, or efficiency.\n    *   In web navigation, an agent might receive a small positive reward for clicking the correct button or locating relevant text, even before reaching the final goal.\n\n*   These are terminal signals received once the task is complete—such as a success flag, accuracy score, or human satisfaction rating.\n*   For instance, in a booking agent, a positive reward may be given only when the reservation is successfully completed.\n\n*   These provide intermediate feedback after each step or subgoal, rewarding partial correctness, progress, or efficiency.\n*   In web navigation, an agent might receive a small positive reward for clicking the correct button or locating relevant text, even before reaching the final goal.\n\nThe challenge is balancing the two. Purely outcome-based training can lead to _sparse reward problems_, while purely process-based training risks _overfitting local heuristics_ that do not generalize.\n\nA common hybrid formulation is:\n\n*   where α∈\\[0,1\\]α∈\\[0,1\\]\\\\alpha \\\\in \\[0, 1\\] controls the tradeoff between intermediate shaping and final goal alignment.\n\nIn practical web-agent training, hybrid reward models may leverage both:\n\n*   **Synthetic process feedback** (automated evaluators for substeps),\n*   **Human outcome feedback** (ranking complete trajectories).\n\nA scalable way to create dense, shaped feedback is to synthesize experience with a reasoning-based experience model that produces consistent next states and vectorized, unified feedback signals in a textual state space. This enables closed-loop RL without expensive real-environment rollouts and supports curriculum generation that targets the current policy’s weaknesses; empirically it yields >30% gains on non-RL-ready tasks like WebArena and can match PPO/GRPO using only synthetic interactions ([Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025)).",
    "order": 30,
    "orderInChapter": 2,
    "difficulty": 4,
    "estimatedMinutes": 4,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 631,
      "contentLength": 17718
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#process-wise-and-outcome-based-reward-integration",
    "scrapedAt": "2025-12-28T11:47:36.153Z"
  },
  {
    "id": "ai-agentic-RL-tool-augmented-reward-modeling-tarm-31",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Reward Modeling",
    "title": "Tool-Augmented Reward Modeling (TARM)",
    "subtitle": "Reward Modeling",
    "contentHtml": "<ul>\n  <li>\n    <p><a href=\"https://arxiv.org/abs/2310.01045\">Tool-Augmented Reward Modeling (Themis)</a> by Li et al. (2024) proposes Tool-Augmented Reward Modeling (TARM) (also called Tool-Integrated Reward Modeling (TIRM)), which represents a significant evolution in RL for agents that operate within complex, tool-augmented environments. TARM integrates external computational and retrieval tools into the reward generation process itself. Instead of merely training language models to use tools during inference, TIRM embeds tool engagement as part of the reward model’s reasoning and supervision pipeline.</p>\n  </li>\n  <li>\n    <p>This approach extends the conventional Reinforcement Learning from Human Feedback (RLHF) paradigm—used in models such as <a href=\"https://arxiv.org/abs/2203.02155\">InstructGPT</a> by Ouyang et al. (2022)—by introducing <strong>tool-augmented reasoning traces</strong> and <strong>context-sensitive reward estimation</strong>, enabling more accurate alignment between model outputs and human evaluators’ expectations.</p>\n  </li>\n  <li>\n    <p>Put simply, tool-Integrated Reward Modeling advances RLHF by embedding reasoning transparency, external computation, and factual grounding directly into the reward modeling process. Through supervised fine-tuning on tool-augmented datasets and RL on process- and outcome-based signals, these models redefine how reward functions are constructed for intelligent agents. The resulting agents not only learn to act effectively but also to <em>evaluate</em> their own reasoning with access to external world models—laying the foundation for trustworthy, explainable, and verifiable AI systems.</p>\n  </li>\n  <li>\n    <p>Reward-free early experience, proposed in <a href=\"https://arxiv.org/abs/2510.08558\">Agent Learning via Early Experience</a> by Zhang et al. (2025), can seed TARM and RLHF alike: implicit world modeling grounds the policy in environment dynamics, while self-reflection generates rationale-style preferences that complement pairwise comparisons used by reward models—providing a bridge from imitation/preference learning to full RL.</p>\n  </li>\n</ul>\n<p><a href=\"https://arxiv.org/abs/2310.01045\">Tool-Augmented Reward Modeling (Themis)</a> by Li et al. (2024) proposes Tool-Augmented Reward Modeling (TARM) (also called Tool-Integrated Reward Modeling (TIRM)), which represents a significant evolution in RL for agents that operate within complex, tool-augmented environments. TARM integrates external computational and retrieval tools into the reward generation process itself. Instead of merely training language models to use tools during inference, TIRM embeds tool engagement as part of the reward model’s reasoning and supervision pipeline.</p>\n<p>This approach extends the conventional Reinforcement Learning from Human Feedback (RLHF) paradigm—used in models such as <a href=\"https://arxiv.org/abs/2203.02155\">InstructGPT</a> by Ouyang et al. (2022)—by introducing <strong>tool-augmented reasoning traces</strong> and <strong>context-sensitive reward estimation</strong>, enabling more accurate alignment between model outputs and human evaluators’ expectations.</p>\n<p>Put simply, tool-Integrated Reward Modeling advances RLHF by embedding reasoning transparency, external computation, and factual grounding directly into the reward modeling process. Through supervised fine-tuning on tool-augmented datasets and RL on process- and outcome-based signals, these models redefine how reward functions are constructed for intelligent agents. The resulting agents not only learn to act effectively but also to <em>evaluate</em> their own reasoning with access to external world models—laying the foundation for trustworthy, explainable, and verifiable AI systems.</p>\n<p>Reward-free early experience, proposed in <a href=\"https://arxiv.org/abs/2510.08558\">Agent Learning via Early Experience</a> by Zhang et al. (2025), can seed TARM and RLHF alike: implicit world modeling grounds the policy in environment dynamics, while self-reflection generates rationale-style preferences that complement pairwise comparisons used by reward models—providing a bridge from imitation/preference learning to full RL.</p>\n<h4 id=\"motivation-and-background\">Motivation and Background</h4>\n<ul>\n  <li>\n    <p>Traditional reward models in RLHF are trained using paired preference data, where a scalar reward is assigned based on human judgments. These models often struggle with factual reasoning, arithmetic operations, and real-world lookups due to their reliance on static, in-model knowledge representations (<a href=\"https://proceedings.neurips.cc/paper/2017/hash/d5e2c0adad503c91f91df240d0cd4e49-Abstract.html\">Christiano et al., 2017</a>). Tool-Integrated Reward Models mitigate this by allowing the reward model itself to call APIs, calculators, code interpreters, or search engines during evaluation.</p>\n  </li>\n  <li>\n    <p>Themis demonstrated that augmenting reward models with tools increased factual accuracy and truthfulness on benchmarks like TruthfulQA by 7.3% over large baselines such as Gopher 280B, while achieving a 17.7% average improvement in preference ranking accuracy across tasks.</p>\n  </li>\n</ul>\n<p>Traditional reward models in RLHF are trained using paired preference data, where a scalar reward is assigned based on human judgments. These models often struggle with factual reasoning, arithmetic operations, and real-world lookups due to their reliance on static, in-model knowledge representations (<a href=\"https://proceedings.neurips.cc/paper/2017/hash/d5e2c0adad503c91f91df240d0cd4e49-Abstract.html\">Christiano et al., 2017</a>). Tool-Integrated Reward Models mitigate this by allowing the reward model itself to call APIs, calculators, code interpreters, or search engines during evaluation.</p>\n<p>Themis demonstrated that augmenting reward models with tools increased factual accuracy and truthfulness on benchmarks like TruthfulQA by 7.3% over large baselines such as Gopher 280B, while achieving a 17.7% average improvement in preference ranking accuracy across tasks.</p>\n<h4 id=\"structure-and-workflow-of-tool-augmented-reward-models\">Structure and Workflow of Tool-Augmented Reward Models</h4>\n<ul>\n  <li>\n    <p>The tool-integrated reward modeling process can be decomposed into sequential reasoning stages—each enhancing the model’s interpretability and precision in assigning rewards:</p>\n\n    <ol>\n      <li><strong>Thought</strong>: The model assesses whether external information is required and determines which tool to invoke.</li>\n      <li><strong>Action</strong>: The model generates an API call with specified parameters.</li>\n      <li><strong>Observation</strong>: The system retrieves and processes tool outputs.</li>\n      <li><strong>Rationale</strong>: The model integrates the external information into a reasoning chain, constructing an interpretable trace of decision-making.</li>\n      <li><strong>Reward Generation</strong>: A scalar reward is computed from the aggregated reasoning trace.</li>\n    </ol>\n  </li>\n  <li>\n    <p>Formally, the total reasoning trajectory is denoted as:</p>\n  </li>\n</ul>\n<p>The tool-integrated reward modeling process can be decomposed into sequential reasoning stages—each enhancing the model’s interpretability and precision in assigning rewards:</p>\n<ol>\n      <li><strong>Thought</strong>: The model assesses whether external information is required and determines which tool to invoke.</li>\n      <li><strong>Action</strong>: The model generates an API call with specified parameters.</li>\n      <li><strong>Observation</strong>: The system retrieves and processes tool outputs.</li>\n      <li><strong>Rationale</strong>: The model integrates the external information into a reasoning chain, constructing an interpretable trace of decision-making.</li>\n      <li><strong>Reward Generation</strong>: A scalar reward is computed from the aggregated reasoning trace.</li>\n    </ol>\n<p>Formally, the total reasoning trajectory is denoted as:</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-267-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>a</mi><mi>T</mi></msub><mo>,</mo><msub><mi>o</mi><mi>T</mi></msub><mo>,</mo><msub><mi>s</mi><mi>T</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4229\" style=\"width: 14.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1011.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4230\"><span class=\"msubsup\" id=\"MathJax-Span-4231\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4232\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4233\"><span class=\"mrow\" id=\"MathJax-Span-4234\"><span class=\"mn\" id=\"MathJax-Span-4235\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-4236\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-4237\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4238\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-4239\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4240\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4241\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-4242\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4243\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4244\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4245\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-4246\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4247\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-4248\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">…</span><span class=\"mo\" id=\"MathJax-Span-4249\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4250\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4251\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4252\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4253\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4254\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4255\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4256\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4257\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4258\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4259\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4260\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4261\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>c</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>T</mi></msub><mo>,</mo><msub><mi>o</mi><mi>T</mi></msub><mo>,</mo><msub><mi>s</mi><mi>T</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div>\n<ul>\n  <li>\n    <p>… and the scalar reward is defined as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-268-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4262\" style=\"width: 5.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.951em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.9em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4263\"><span class=\"msubsup\" id=\"MathJax-Span-4264\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4265\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-4266\"><span class=\"mrow\" id=\"MathJax-Span-4267\"><span class=\"mi\" id=\"MathJax-Span-4268\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4269\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4270\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4271\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4272\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4273\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4274\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4275\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4276\"><span class=\"mrow\" id=\"MathJax-Span-4277\"><span class=\"mn\" id=\"MathJax-Span-4278\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-4279\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-4280\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4281\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>θ</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><msub><mi>c</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-268\">r_{\\theta}(x, y, c_{1:T})</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-269-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4282\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4283\"><span class=\"mi\" id=\"MathJax-Span-4284\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-269\">x</script> is the input, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-270-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4285\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4286\"><span class=\"mi\" id=\"MathJax-Span-4287\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-270\">y</script> is the model’s output, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-271-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4288\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.51em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4289\"><span class=\"msubsup\" id=\"MathJax-Span-4290\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4291\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4292\"><span class=\"mrow\" id=\"MathJax-Span-4293\"><span class=\"mn\" id=\"MathJax-Span-4294\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-4295\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-4296\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>c</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-271\">c_{1:T}</script> represents the full reasoning and observation history.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The total loss function combines pairwise ranking and autoregressive modeling losses:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-272-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>total</mtext></mrow></msub><mo>=</mo><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>RM</mtext></mrow></msub><mo>+</mo><mi>&amp;#x03B1;</mi><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></munderover><mo stretchy=&quot;false&quot;>(</mo><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>tool</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B2;</mi><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>obs</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03C9;</mi><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>rat</mtext></mrow></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4297\" style=\"width: 22.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 18.753em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.263em, 1018.75em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4298\"><span class=\"msubsup\" id=\"MathJax-Span-4299\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4300\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4301\"><span class=\"mrow\" id=\"MathJax-Span-4302\"><span class=\"mtext\" id=\"MathJax-Span-4303\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">total</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4304\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4305\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4306\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4307\"><span class=\"mrow\" id=\"MathJax-Span-4308\"><span class=\"mtext\" id=\"MathJax-Span-4309\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">RM</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4310\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-4311\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">α</span><span class=\"munderover\" id=\"MathJax-Span-4312\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4313\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.99em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-4314\"><span class=\"mrow\" id=\"MathJax-Span-4315\"><span class=\"mi\" id=\"MathJax-Span-4316\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4317\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-4318\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-4319\"><span class=\"mrow\" id=\"MathJax-Span-4320\"><span class=\"mi\" id=\"MathJax-Span-4321\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4322\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4323\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4324\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4325\"><span class=\"mrow\" id=\"MathJax-Span-4326\"><span class=\"mtext\" id=\"MathJax-Span-4327\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">tool</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4328\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4329\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4330\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4331\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-4332\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-4333\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4334\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4335\"><span class=\"mrow\" id=\"MathJax-Span-4336\"><span class=\"mtext\" id=\"MathJax-Span-4337\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">obs</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4338\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4339\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4340\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4341\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4342\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-4343\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">ω</span><span class=\"msubsup\" id=\"MathJax-Span-4344\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4345\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4346\"><span class=\"mrow\" id=\"MathJax-Span-4347\"><span class=\"mtext\" id=\"MathJax-Span-4348\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">rat</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>total</mtext></mrow></msub><mo>=</mo><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>RM</mtext></mrow></msub><mo>+</mo><mi>α</mi><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi></mrow></munderover><mo stretchy=\"false\">(</mo><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>tool</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>β</mi><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>obs</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>+</mo><mi>ω</mi><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>rat</mtext></mrow></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-272\">L_{\\text{total}} = L_{\\text{RM}} + \\alpha \\sum_{t=1}^{T} (L_{\\text{tool}}(t) + \\beta L_{\\text{obs}}(t)) + \\omega L_{\\text{rat}}</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-273-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>RM</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4349\" style=\"width: 2.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.72em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4350\"><span class=\"msubsup\" id=\"MathJax-Span-4351\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4352\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4353\"><span class=\"mrow\" id=\"MathJax-Span-4354\"><span class=\"mtext\" id=\"MathJax-Span-4355\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">RM</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>RM</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-273\">L_{\\text{RM}}</script> corresponds to the pairwise ranking loss from preference modeling, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-274-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>tool</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4356\" style=\"width: 2.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.72em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4357\"><span class=\"msubsup\" id=\"MathJax-Span-4358\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4359\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4360\"><span class=\"mrow\" id=\"MathJax-Span-4361\"><span class=\"mtext\" id=\"MathJax-Span-4362\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">tool</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>tool</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-274\">L_{\\text{tool}}</script> supervises tool invocation accuracy, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-275-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>obs</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4363\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.62em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4364\"><span class=\"msubsup\" id=\"MathJax-Span-4365\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4366\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4367\"><span class=\"mrow\" id=\"MathJax-Span-4368\"><span class=\"mtext\" id=\"MathJax-Span-4369\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">obs</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>obs</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-275\">L_{\\text{obs}}</script> captures fidelity to observed results, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-276-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>rat</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4370\" style=\"width: 1.669em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.36em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4371\"><span class=\"msubsup\" id=\"MathJax-Span-4372\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4373\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4374\"><span class=\"mrow\" id=\"MathJax-Span-4375\"><span class=\"mtext\" id=\"MathJax-Span-4376\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">rat</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>rat</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-276\">L_{\\text{rat}}</script> trains the model to generate coherent rationales.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The following figure (<a href=\"https://arxiv.org/abs/2310.01045\">source</a>) shows illustrates the pipeline of (a) Vanilla reward models (RMs); (b) Tool-augmented RMs, namely Themis; (c) RL via proximal policy optimization (PPO) on above RMs; (d) Examples of single or multiple tool use process in the proposed approach.</p>\n  </li>\n</ul>\n<p>… and the scalar reward is defined as:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-269-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4282\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4283\"><span class=\"mi\" id=\"MathJax-Span-4284\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-269\">x</script> is the input, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-270-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4285\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4286\"><span class=\"mi\" id=\"MathJax-Span-4287\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-270\">y</script> is the model’s output, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-271-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4288\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.51em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4289\"><span class=\"msubsup\" id=\"MathJax-Span-4290\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4291\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4292\"><span class=\"mrow\" id=\"MathJax-Span-4293\"><span class=\"mn\" id=\"MathJax-Span-4294\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-4295\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-4296\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>c</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-271\">c_{1:T}</script> represents the full reasoning and observation history.</li>\n    </ul>\n<p>The total loss function combines pairwise ranking and autoregressive modeling losses:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-273-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>RM</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4349\" style=\"width: 2.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.72em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4350\"><span class=\"msubsup\" id=\"MathJax-Span-4351\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4352\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4353\"><span class=\"mrow\" id=\"MathJax-Span-4354\"><span class=\"mtext\" id=\"MathJax-Span-4355\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">RM</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>RM</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-273\">L_{\\text{RM}}</script> corresponds to the pairwise ranking loss from preference modeling, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-274-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>tool</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4356\" style=\"width: 2.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.72em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4357\"><span class=\"msubsup\" id=\"MathJax-Span-4358\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4359\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4360\"><span class=\"mrow\" id=\"MathJax-Span-4361\"><span class=\"mtext\" id=\"MathJax-Span-4362\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">tool</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>tool</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-274\">L_{\\text{tool}}</script> supervises tool invocation accuracy, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-275-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>obs</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4363\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.62em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4364\"><span class=\"msubsup\" id=\"MathJax-Span-4365\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4366\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4367\"><span class=\"mrow\" id=\"MathJax-Span-4368\"><span class=\"mtext\" id=\"MathJax-Span-4369\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">obs</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>obs</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-275\">L_{\\text{obs}}</script> captures fidelity to observed results, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-276-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>rat</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4370\" style=\"width: 1.669em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.36em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4371\"><span class=\"msubsup\" id=\"MathJax-Span-4372\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4373\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4374\"><span class=\"mrow\" id=\"MathJax-Span-4375\"><span class=\"mtext\" id=\"MathJax-Span-4376\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">rat</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>rat</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-276\">L_{\\text{rat}}</script> trains the model to generate coherent rationales.</li>\n    </ul>\n<p>The following figure (<a href=\"https://arxiv.org/abs/2310.01045\">source</a>) shows illustrates the pipeline of (a) Vanilla reward models (RMs); (b) Tool-augmented RMs, namely Themis; (c) RL via proximal policy optimization (PPO) on above RMs; (d) Examples of single or multiple tool use process in the proposed approach.</p>\n<p><img src=\"/primers/ai/assets/RL-for-agents/Themis.jpg\" alt=\"\"></p>\n<ul>\n  <li>Per <a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025), when paired with synthetic experience generation, tool-augmented evaluators can operate at scale with consistent, informative feedback, while curriculum generation focuses on high-entropy tasks that maximize learning signal—closing the loop between reward modeling and data generation in RL training.</li>\n</ul>\n<h4 id=\"role-of-supervised-fine-tuning-and-reinforcement-learning\">Role of Supervised Fine-Tuning and Reinforcement Learning</h4>\n<ul>\n  <li>\n    <p>Themis—and, more broadly, TIRM—relies on a <strong>hybrid SFT + RL training approach</strong>.</p>\n\n    <ul>\n      <li>\n        <p><strong>SFT Stage</strong>: The reward model learns to imitate tool usage traces from curated datasets (e.g., the <a href=\"https://github.com/ernie-research/Tool-Augmented-Reward-Model\">TARA dataset</a>). These traces include natural-language thoughts, API calls, and tool results generated via multi-agent interactions between LLMs and simulated human labelers.</p>\n      </li>\n      <li>\n        <p><strong>RL Stage</strong>: Once pre-trained, the reward model is further optimized via RL objectives like Proximal Policy Optimization (PPO) (<a href=\"https://arxiv.org/abs/1707.06347\">Schulman et al., 2017</a>). The model refines its reward predictions using outcome-based feedback, achieving stable convergence even under high variance tool-call trajectories.</p>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>This two-stage setup enables <strong>process-based reward shaping</strong>, in which partial rewards are granted for intermediate reasoning correctness (process rewards), and <strong>outcome-based rewards</strong> for overall task success. This balance is critical when agents operate in environments requiring both reasoning depth and correct final results.</p>\n  </li>\n  <li>\n    <p>Reward-free early experience provides a natural pretraining curriculum—first fitting <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-277-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>I</mi><mi mathvariant=&quot;normal&quot;>W</mi><mi mathvariant=&quot;normal&quot;>M</mi></mrow></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4377\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1002.19em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4378\"><span class=\"msubsup\" id=\"MathJax-Span-4379\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4380\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4381\"><span class=\"mrow\" id=\"MathJax-Span-4382\"><span class=\"texatom\" id=\"MathJax-Span-4383\"><span class=\"mrow\" id=\"MathJax-Span-4384\"><span class=\"mi\" id=\"MathJax-Span-4385\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">I</span><span class=\"mi\" id=\"MathJax-Span-4386\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">W</span><span class=\"mi\" id=\"MathJax-Span-4387\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">M</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">I</mi><mi mathvariant=\"normal\">W</mi><mi mathvariant=\"normal\">M</mi></mrow></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-277\">L_{\\mathrm{IWM}}</script> to learn dynamics, then <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-278-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>S</mi><mi mathvariant=&quot;normal&quot;>R</mi></mrow></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4388\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.51em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4389\"><span class=\"msubsup\" id=\"MathJax-Span-4390\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4391\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4392\"><span class=\"mrow\" id=\"MathJax-Span-4393\"><span class=\"texatom\" id=\"MathJax-Span-4394\"><span class=\"mrow\" id=\"MathJax-Span-4395\"><span class=\"mi\" id=\"MathJax-Span-4396\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">S</span><span class=\"mi\" id=\"MathJax-Span-4397\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">R</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">S</mi><mi mathvariant=\"normal\">R</mi></mrow></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-278\">L_{\\mathrm{SR}}</script> to internalize preference signals—before introducing PPO/GRPO or DPO on either real or synthetic rollouts (cf. <a href=\"https://arxiv.org/abs/2510.08558\">Agent Learning via Early Experience</a> by Zhang et al. (2025); <a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025)).</p>\n  </li>\n</ul>\n<p>Themis—and, more broadly, TIRM—relies on a <strong>hybrid SFT + RL training approach</strong>.</p>\n<ul>\n      <li>\n        <p><strong>SFT Stage</strong>: The reward model learns to imitate tool usage traces from curated datasets (e.g., the <a href=\"https://github.com/ernie-research/Tool-Augmented-Reward-Model\">TARA dataset</a>). These traces include natural-language thoughts, API calls, and tool results generated via multi-agent interactions between LLMs and simulated human labelers.</p>\n      </li>\n      <li>\n        <p><strong>RL Stage</strong>: Once pre-trained, the reward model is further optimized via RL objectives like Proximal Policy Optimization (PPO) (<a href=\"https://arxiv.org/abs/1707.06347\">Schulman et al., 2017</a>). The model refines its reward predictions using outcome-based feedback, achieving stable convergence even under high variance tool-call trajectories.</p>\n      </li>\n    </ul>\n<p><strong>SFT Stage</strong>: The reward model learns to imitate tool usage traces from curated datasets (e.g., the <a href=\"https://github.com/ernie-research/Tool-Augmented-Reward-Model\">TARA dataset</a>). These traces include natural-language thoughts, API calls, and tool results generated via multi-agent interactions between LLMs and simulated human labelers.</p>\n<p><strong>RL Stage</strong>: Once pre-trained, the reward model is further optimized via RL objectives like Proximal Policy Optimization (PPO) (<a href=\"https://arxiv.org/abs/1707.06347\">Schulman et al., 2017</a>). The model refines its reward predictions using outcome-based feedback, achieving stable convergence even under high variance tool-call trajectories.</p>\n<p>This two-stage setup enables <strong>process-based reward shaping</strong>, in which partial rewards are granted for intermediate reasoning correctness (process rewards), and <strong>outcome-based rewards</strong> for overall task success. This balance is critical when agents operate in environments requiring both reasoning depth and correct final results.</p>\n<p>Reward-free early experience provides a natural pretraining curriculum—first fitting <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-277-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>I</mi><mi mathvariant=&quot;normal&quot;>W</mi><mi mathvariant=&quot;normal&quot;>M</mi></mrow></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4377\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1002.19em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4378\"><span class=\"msubsup\" id=\"MathJax-Span-4379\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4380\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4381\"><span class=\"mrow\" id=\"MathJax-Span-4382\"><span class=\"texatom\" id=\"MathJax-Span-4383\"><span class=\"mrow\" id=\"MathJax-Span-4384\"><span class=\"mi\" id=\"MathJax-Span-4385\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">I</span><span class=\"mi\" id=\"MathJax-Span-4386\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">W</span><span class=\"mi\" id=\"MathJax-Span-4387\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">M</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">I</mi><mi mathvariant=\"normal\">W</mi><mi mathvariant=\"normal\">M</mi></mrow></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-277\">L_{\\mathrm{IWM}}</script> to learn dynamics, then <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-278-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>S</mi><mi mathvariant=&quot;normal&quot;>R</mi></mrow></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4388\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.51em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4389\"><span class=\"msubsup\" id=\"MathJax-Span-4390\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4391\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4392\"><span class=\"mrow\" id=\"MathJax-Span-4393\"><span class=\"texatom\" id=\"MathJax-Span-4394\"><span class=\"mrow\" id=\"MathJax-Span-4395\"><span class=\"mi\" id=\"MathJax-Span-4396\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">S</span><span class=\"mi\" id=\"MathJax-Span-4397\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">R</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">S</mi><mi mathvariant=\"normal\">R</mi></mrow></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-278\">L_{\\mathrm{SR}}</script> to internalize preference signals—before introducing PPO/GRPO or DPO on either real or synthetic rollouts (cf. <a href=\"https://arxiv.org/abs/2510.08558\">Agent Learning via Early Experience</a> by Zhang et al. (2025); <a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025)).</p>\n<h4 id=\"the-tool-augmented-reward-dataset-tara\">The Tool-Augmented Reward Dataset (TARA)</h4>\n<ul>\n  <li>\n    <p>A key component of TIRM research is the creation of datasets that reflect real-world reasoning and tool usage patterns. The <a href=\"https://github.com/ernie-research/Tool-Augmented-Reward-Model\">TARA dataset</a> contains over 15,000 instances combining human preferences with explicit tool-invocation traces across seven tool categories, including search, translation, weather, calculator, and code execution.</p>\n  </li>\n  <li>\n    <p>The following figure (<a href=\"https://arxiv.org/abs/2310.01045\">source</a>) shows the data collection pipeline for TARA, depicting human-LLM interaction, tool invocation, and rationale generation. It the four-step process: (1) Question-answer collection, (2) ToolBank construction, (3) Tool invocation via multi-agent simulation, and (4) Filtering for data integrity.</p>\n  </li>\n</ul>\n<p>A key component of TIRM research is the creation of datasets that reflect real-world reasoning and tool usage patterns. The <a href=\"https://github.com/ernie-research/Tool-Augmented-Reward-Model\">TARA dataset</a> contains over 15,000 instances combining human preferences with explicit tool-invocation traces across seven tool categories, including search, translation, weather, calculator, and code execution.</p>\n<p>The following figure (<a href=\"https://arxiv.org/abs/2310.01045\">source</a>) shows the data collection pipeline for TARA, depicting human-LLM interaction, tool invocation, and rationale generation. It the four-step process: (1) Question-answer collection, (2) ToolBank construction, (3) Tool invocation via multi-agent simulation, and (4) Filtering for data integrity.</p>\n<p><img src=\"/primers/ai/assets/RL-for-agents/TARA_Pipeline.jpg\" alt=\"\"></p>\n<h4 id=\"empirical-results-and-observations\">Empirical Results and Observations</h4>\n<ul>\n  <li>\n    <p>Experiments show that Themis enhances both <strong>single-tool</strong> and <strong>multi-tool</strong> scenarios. For example:</p>\n\n    <ul>\n      <li>Accuracy improved by +19.2% in single-tool and +17.7% in mixed-tool setups.</li>\n      <li>Perfect accuracy (100%) was achieved in calendar and weather reasoning tasks.</li>\n      <li>Models learned when and whether to call tools autonomously—a form of learned tool invocation policy.</li>\n      <li>The observation and rationale components contributed significantly to reward accuracy, proving that <strong>process supervision</strong> is critical to model interpretability and consistency.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Further, when integrated into an RLHF pipeline (referred to as RLTAF: Reinforcement Learning from Tool-Augmented Feedback), Themis-trained models achieved a 32% higher human preference win rate compared to vanilla RMs, highlighting its ability to generate more trustworthy and factual responses.</p>\n  </li>\n  <li>\n    <p>Complementarily, <a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025) proposes scaling RL with synthetic rollouts generated by a reasoning experience model, which yields substantial downstream gains and lowers on-environment data needs; e.g., DreamGym reports &gt;30% improvements on WebArena and policy parity with PPO/GRPO using only synthetic interactions, after which real-environment fine-tuning brings additional gains.</p>\n  </li>\n  <li>\n    <p>The following figure illustrates an overview of the proposed DreamGym agent training framework. Given a set of seed tasks, a reasoning-based experience model interacts with the agent to generate informative, diverse tasks and trajectories for RL training. At each step, the agent takes actions based on its current state and receives next states and reward signals derived by the experience model through CoT reasoning based on both interaction history and top-k similar experiences from an active replay buffer. To expose the agent to increasingly informative scenarios, tasks with high reward entropy are proposed by the curriculum task generator for future training. With this unified design, DreamGym addresses both task and reward sparsity while enabling scalable RL with diverse and curriculum-driven environments.</p>\n  </li>\n</ul>\n<p>Experiments show that Themis enhances both <strong>single-tool</strong> and <strong>multi-tool</strong> scenarios. For example:</p>\n<ul>\n      <li>Accuracy improved by +19.2% in single-tool and +17.7% in mixed-tool setups.</li>\n      <li>Perfect accuracy (100%) was achieved in calendar and weather reasoning tasks.</li>\n      <li>Models learned when and whether to call tools autonomously—a form of learned tool invocation policy.</li>\n      <li>The observation and rationale components contributed significantly to reward accuracy, proving that <strong>process supervision</strong> is critical to model interpretability and consistency.</li>\n    </ul>\n<p>Further, when integrated into an RLHF pipeline (referred to as RLTAF: Reinforcement Learning from Tool-Augmented Feedback), Themis-trained models achieved a 32% higher human preference win rate compared to vanilla RMs, highlighting its ability to generate more trustworthy and factual responses.</p>\n<p>Complementarily, <a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025) proposes scaling RL with synthetic rollouts generated by a reasoning experience model, which yields substantial downstream gains and lowers on-environment data needs; e.g., DreamGym reports &gt;30% improvements on WebArena and policy parity with PPO/GRPO using only synthetic interactions, after which real-environment fine-tuning brings additional gains.</p>\n<p>The following figure illustrates an overview of the proposed DreamGym agent training framework. Given a set of seed tasks, a reasoning-based experience model interacts with the agent to generate informative, diverse tasks and trajectories for RL training. At each step, the agent takes actions based on its current state and receives next states and reward signals derived by the experience model through CoT reasoning based on both interaction history and top-k similar experiences from an active replay buffer. To expose the agent to increasingly informative scenarios, tasks with high reward entropy are proposed by the curriculum task generator for future training. With this unified design, DreamGym addresses both task and reward sparsity while enabling scalable RL with diverse and curriculum-driven environments.</p>\n<p><img src=\"/primers/ai/assets/RL-for-agents/DreamGym2.jpg\" alt=\"\"></p>\n<h4 id=\"connection-to-reinforcement-learning-for-agents\">Connection to Reinforcement Learning for Agents</h4>\n<ul>\n  <li>\n    <p>Tool-integrated reward modeling bridges the gap between <strong>tool-augmented reasoning</strong> and <strong>agentic RL</strong>. By enabling the reward function itself to utilize external resources, agents trained under TIRM learn a deeper mapping between reasoning actions and value estimation. This structure is directly applicable to RL-driven computer-use agents, where both <strong>process-level</strong> (step-wise) and <strong>outcome-based</strong> (goal completion) rewards must be optimized.</p>\n  </li>\n  <li>\n    <p>In this framework, process-based rewards correspond to accurate intermediate reasoning and correct tool usage, while outcome-based rewards correspond to successful task completion. The combined signal provides agents with fine-grained credit assignment, improving learning efficiency and interpretability in web-based or API-integrated environments.</p>\n  </li>\n  <li>\n    <p>Per <a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025), when training in synthetic environments, policy improvements can provably transfer to the real environment under standard trust-region updates. Writing the real MDP as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-279-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>S</mi><mo>,</mo><mi>A</mi><mo>,</mo><mi>P</mi><mo>,</mo><mi>R</mi><mo>,</mo><mi>&amp;#x03B3;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4398\" style=\"width: 9.273em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1007.66em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4399\"><span class=\"mi\" id=\"MathJax-Span-4400\" style=\"font-family: STIXGeneral-Italic;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4401\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-4402\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"mi\" id=\"MathJax-Span-4403\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4404\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4405\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">A</span><span class=\"mo\" id=\"MathJax-Span-4406\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4407\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">P</span><span class=\"mo\" id=\"MathJax-Span-4408\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4409\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">R</span><span class=\"mo\" id=\"MathJax-Span-4410\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4411\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4412\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>M</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>S</mi><mo>,</mo><mi>A</mi><mo>,</mo><mi>P</mi><mo>,</mo><mi>R</mi><mo>,</mo><mi>γ</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-279\">M=(S,A,P,R,\\gamma)</script> and the synthetic one as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-280-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>M</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>S</mi><mo>,</mo><mi>A</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo>,</mo><mi>&amp;#x03B3;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4413\" style=\"width: 9.273em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1007.66em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4414\"><span class=\"texatom\" id=\"MathJax-Span-4415\"><span class=\"mrow\" id=\"MathJax-Span-4416\"><span class=\"munderover\" id=\"MathJax-Span-4417\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4418\" style=\"font-family: STIXGeneral-Italic;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.315em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4419\" style=\"font-family: STIXGeneral-Regular;\">̃&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4420\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-4421\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"mi\" id=\"MathJax-Span-4422\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4423\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4424\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">A</span><span class=\"mo\" id=\"MathJax-Span-4425\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-4426\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4427\"><span class=\"munderover\" id=\"MathJax-Span-4428\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4429\" style=\"font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4430\" style=\"font-family: STIXGeneral-Regular;\">̃&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4431\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-4432\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4433\"><span class=\"munderover\" id=\"MathJax-Span-4434\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4435\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4436\" style=\"font-family: STIXGeneral-Regular;\">̃&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4437\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4438\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4439\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>M</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo>=</mo><mo stretchy=\"false\">(</mo><mi>S</mi><mo>,</mo><mi>A</mi><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>P</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo>,</mo><mi>γ</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-280\">\\tilde{M}=(S,A,\\tilde{P},\\tilde{R},\\gamma)</script> with bounded reward and transition errors <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-281-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B5;</mi><mi>R</mi></msub><mo>,</mo><msub><mi>&amp;#x03B5;</mi><mi>P</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4440\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1002.35em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4441\"><span class=\"msubsup\" id=\"MathJax-Span-4442\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4443\" style=\"font-family: STIXGeneral-Italic;\">ε</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4444\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4445\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4446\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4447\" style=\"font-family: STIXGeneral-Italic;\">ε</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4448\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>ε</mi><mi>R</mi></msub><mo>,</mo><msub><mi>ε</mi><mi>P</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-281\">\\varepsilon_R,\\varepsilon_P</script>, a KL-bounded update from <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-282-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msup><mi>&amp;#x03C0;</mi><mo>&amp;#x2032;</mo></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4449\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1003.13em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4450\"><span class=\"mi\" id=\"MathJax-Span-4451\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4452\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">→</span><span class=\"msup\" id=\"MathJax-Span-4453\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4454\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.576em;\"><span class=\"mo\" id=\"MathJax-Span-4455\" style=\"font-size: 70.7%; font-family: STIXVariants;\">′</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>π</mi><mo stretchy=\"false\">→</mo><msup><mi>π</mi><mo>′</mo></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-282\">\\pi\\to\\pi'</script> (as in PPO/GRPO) yields a lower bound of the form:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\"><span class=\"MathJax MathJax_FullWidth\" id=\"MathJax-Element-283-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>J</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>M</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msup><mi>&amp;#x03C0;</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>J</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>M</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2265;</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03B3;</mi></mrow></mfrac><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mo>&amp;#x223C;</mo><msubsup><mi>d</mi><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>M</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow></mrow></msubsup><mo>,</mo><mi>a</mi><mo>&amp;#x223C;</mo><msup><mi>&amp;#x03C0;</mi><mo>&amp;#x2032;</mo></msup></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><msubsup><mi>A</mi><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>M</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow></mrow></msubsup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow><mo>&amp;#x2212;</mo><munder><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><munder><mtext>KL trust-region penalty</mtext><mo>&amp;#x23DF;</mo></munder></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mstyle mathsize=&quot;0.85em&quot;><mtext>(per-state KL radius)</mtext></mstyle></mrow></munder><mo>&amp;#x2212;</mo><munder><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><munder><mrow><mn>2</mn><mrow><mo>(</mo><mrow><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;><mfrac><msub><mi>&amp;#x03B5;</mi><mi>R</mi></msub><mrow><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03B3;</mi></mrow></mfrac></mstyle><mo>+</mo><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;><mfrac><mrow><mn>2</mn><mi>&amp;#x03B3;</mi><msub><mi>R</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo></mrow></msub></mrow><mrow><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03B3;</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></mrow></mfrac></mstyle><msub><mi>&amp;#x03B5;</mi><mi>P</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>&amp;#x23DF;</mo></munder></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mstyle mathsize=&quot;0.85em&quot;><mtext>experience-model error</mtext></mstyle></mrow></munder></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4456\" style=\"width: 100%; display: inline-block; min-width: 35.315em;\"><span style=\"display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(7.034em, 1029.43em, 14.898em, -999.997em); top: -8.539em; left: 0em; width: 100%;\"><span class=\"mrow\" id=\"MathJax-Span-4457\"><span style=\"display: inline-block; position: relative; width: 100%; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1029.43em, 6.565em, -999.997em); top: -4.372em; left: 50%; margin-left: -14.685em;\"><span class=\"msubsup\" id=\"MathJax-Span-4458\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4459\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4460\"><span class=\"mrow\" id=\"MathJax-Span-4461\"><span class=\"mi\" id=\"MathJax-Span-4462\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4463\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-4464\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4465\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.576em;\"><span class=\"mo\" id=\"MathJax-Span-4466\" style=\"font-size: 70.7%; font-family: STIXVariants;\">′</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4467\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4468\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-4469\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4470\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4471\"><span class=\"mrow\" id=\"MathJax-Span-4472\"><span class=\"mi\" id=\"MathJax-Span-4473\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4474\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4475\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4476\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4477\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">≥</span><span class=\"mfrac\" id=\"MathJax-Span-4478\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-4479\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1002.14em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -1.091em;\"><span class=\"mrow\" id=\"MathJax-Span-4480\"><span class=\"mn\" id=\"MathJax-Span-4481\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-4482\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-4483\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1002.29em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.294em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4484\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4485\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 4.065em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4486\"><span class=\"mrow\" id=\"MathJax-Span-4487\"><span class=\"mi\" id=\"MathJax-Span-4488\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.539em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-4489\"><span class=\"mrow\" id=\"MathJax-Span-4490\"><span class=\"mi\" id=\"MathJax-Span-4491\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-4492\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"msubsup\" id=\"MathJax-Span-4493\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4494\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.47em, 4.169em, -999.997em); top: -4.32em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-4495\"><span class=\"mrow\" id=\"MathJax-Span-4496\"><span class=\"texatom\" id=\"MathJax-Span-4497\"><span class=\"mrow\" id=\"MathJax-Span-4498\"><span class=\"munderover\" id=\"MathJax-Span-4499\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4500\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.216em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.211em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4501\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">̃&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.102em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.648em, 1000.32em, 4.169em, -999.997em); top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4502\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4503\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4504\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-4505\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"msup\" id=\"MathJax-Span-4506\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4507\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.216em; left: 0.419em;\"><span class=\"mo\" id=\"MathJax-Span-4508\" style=\"font-size: 50%; font-family: STIXVariants;\">′</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4509\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-4510\"><span class=\"mo\" id=\"MathJax-Span-4511\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4512\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4513\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.372em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-4514\"><span class=\"mrow\" id=\"MathJax-Span-4515\"><span class=\"texatom\" id=\"MathJax-Span-4516\"><span class=\"mrow\" id=\"MathJax-Span-4517\"><span class=\"munderover\" id=\"MathJax-Span-4518\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4519\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.216em; left: 0.263em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.263em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4520\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">̃&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.154em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.47em, 4.169em, -999.997em); top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-4521\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4522\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4523\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-4524\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4525\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4526\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-4527\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-4528\"><span class=\"mo\" id=\"MathJax-Span-4529\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4530\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"munderover\" id=\"MathJax-Span-4531\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 9.482em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1009.48em, 5.315em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4532\"><span class=\"mrow\" id=\"MathJax-Span-4533\"><span class=\"munderover\" id=\"MathJax-Span-4534\"><span style=\"display: inline-block; position: relative; width: 9.482em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1009.43em, 4.378em, -999.997em); top: -4.008em; left: 0.003em;\"><span class=\"mtext\" id=\"MathJax-Span-4535\" style=\"font-family: STIXGeneral-Regular;\">KL trust-region penalty</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.701em, 1009.48em, 4.69em, -999.997em); top: -3.383em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4536\" style=\"\"><span style=\"display: inline-block; position: relative; width: 9.482em; height: 0px;\"><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 0.003em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 8.544em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 3.805em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 0.888em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 1.461em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 2.034em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 2.607em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 3.232em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 5.576em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 6.201em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 6.773em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 7.346em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 7.971em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1005.63em, 4.43em, -999.997em); top: -2.185em; left: 1.878em;\"><span class=\"texatom\" id=\"MathJax-Span-4537\"><span class=\"mrow\" id=\"MathJax-Span-4538\"><span class=\"mstyle\" id=\"MathJax-Span-4539\"><span class=\"mrow\" id=\"MathJax-Span-4540\"><span class=\"mtext\" id=\"MathJax-Span-4541\" style=\"font-size: 67.6%; font-family: STIXGeneral-Regular;\">(per-state KL radius)</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.378em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1008.91em, 7.346em, -999.997em); top: -0.987em; left: 50%; margin-left: -4.477em;\"><span class=\"mo\" id=\"MathJax-Span-4542\" style=\"font-family: STIXGeneral-Regular;\">−</span><span class=\"munderover\" id=\"MathJax-Span-4543\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 7.971em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.659em, 1007.97em, 5.732em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4544\"><span class=\"mrow\" id=\"MathJax-Span-4545\"><span class=\"munderover\" id=\"MathJax-Span-4546\"><span style=\"display: inline-block; position: relative; width: 7.971em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.659em, 1007.82em, 4.846em, -999.997em); top: -4.008em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-4547\"><span class=\"mn\" id=\"MathJax-Span-4548\" style=\"font-family: STIXGeneral-Regular;\">2</span><span class=\"mrow\" id=\"MathJax-Span-4549\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-4550\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-4551\"><span class=\"mstyle\" id=\"MathJax-Span-4552\"><span class=\"mrow\" id=\"MathJax-Span-4553\"><span class=\"mfrac\" id=\"MathJax-Span-4554\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.68em, 4.273em, -999.997em); top: -4.529em; left: 50%; margin-left: -0.31em;\"><span class=\"msubsup\" id=\"MathJax-Span-4555\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4556\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ε</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-4557\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.15em, 4.326em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.57em;\"><span class=\"mrow\" id=\"MathJax-Span-4558\"><span class=\"mn\" id=\"MathJax-Span-4559\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-4560\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mi\" id=\"MathJax-Span-4561\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1001.25em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.253em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4562\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mstyle\" id=\"MathJax-Span-4563\" style=\"padding-left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-4564\"><span class=\"mfrac\" id=\"MathJax-Span-4565\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.03em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -0.987em;\"><span class=\"mrow\" id=\"MathJax-Span-4566\"><span class=\"mn\" id=\"MathJax-Span-4567\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span class=\"mi\" id=\"MathJax-Span-4568\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-4569\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4570\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-4571\"><span class=\"mrow\" id=\"MathJax-Span-4572\"><span class=\"mo\" id=\"MathJax-Span-4573\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">max</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.232em, 1001.93em, 4.326em, -999.997em); top: -3.487em; left: 50%; margin-left: -0.935em;\"><span class=\"mrow\" id=\"MathJax-Span-4574\"><span class=\"mo\" id=\"MathJax-Span-4575\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-4576\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-4577\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mi\" id=\"MathJax-Span-4578\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-4579\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.21em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4580\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.263em;\"><span class=\"mn\" id=\"MathJax-Span-4581\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1002.14em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.138em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4582\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4583\" style=\"font-family: STIXGeneral-Italic;\">ε</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4584\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4585\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.701em, 1007.97em, 4.69em, -999.997em); top: -2.966em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4586\" style=\"\"><span style=\"display: inline-block; position: relative; width: 7.971em; height: 0px;\"><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 0.003em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 7.034em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 3.076em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 0.836em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 1.409em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 1.93em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 2.503em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 4.794em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 5.367em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 5.94em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 6.461em;\"><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1006.36em, 4.43em, -999.997em); top: -1.768em; left: 0.836em;\"><span class=\"texatom\" id=\"MathJax-Span-4587\"><span class=\"mrow\" id=\"MathJax-Span-4588\"><span class=\"mstyle\" id=\"MathJax-Span-4589\"><span class=\"mrow\" id=\"MathJax-Span-4590\"><span class=\"mtext\" id=\"MathJax-Span-4591\" style=\"font-size: 67.6%; font-family: STIXGeneral-Regular;\">experience-model error</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.69em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 8.544em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -7.497em; border-left: 0px solid; width: 0px; height: 9.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>J</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>M</mi></mrow></msub><mo stretchy=\"false\">(</mo><msup><mi>π</mi><mo>′</mo></msup><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>J</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>M</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>π</mi><mo stretchy=\"false\">)</mo><mo>≥</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>γ</mi></mrow></mfrac><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>s</mi><mo>∼</mo><msubsup><mi>d</mi><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>M</mi><mo stretchy=\"false\">~</mo></mover></mrow></mrow></msubsup><mo>,</mo><mi>a</mi><mo>∼</mo><msup><mi>π</mi><mo>′</mo></msup></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><msubsup><mi>A</mi><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>M</mi><mo stretchy=\"false\">~</mo></mover></mrow></mrow></msubsup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow><mo>−</mo><munder><mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"><munder><mtext>KL trust-region penalty</mtext><mo>⏟</mo></munder></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mstyle mathsize=\"0.85em\"><mtext>(per-state KL radius)</mtext></mstyle></mrow></munder><mo>−</mo><munder><mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"><munder><mrow><mn>2</mn><mrow><mo>(</mo><mrow><mstyle displaystyle=\"false\" scriptlevel=\"0\"><mfrac><msub><mi>ε</mi><mi>R</mi></msub><mrow><mn>1</mn><mo>−</mo><mi>γ</mi></mrow></mfrac></mstyle><mo>+</mo><mstyle displaystyle=\"false\" scriptlevel=\"0\"><mfrac><mrow><mn>2</mn><mi>γ</mi><msub><mi>R</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo movablelimits=\"true\" form=\"prefix\">max</mo></mrow></msub></mrow><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>γ</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></mfrac></mstyle><msub><mi>ε</mi><mi>P</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>⏟</mo></munder></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mstyle mathsize=\"0.85em\"><mtext>experience-model error</mtext></mstyle></mrow></munder></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-283\">J_{M}(\\pi')-J_{M}(\\pi)\\ge\\frac{1}{1-\\gamma},\\mathbb{E}_{s\\sim d_\\pi^{\\tilde{M}},a\\sim \\pi'}\\big[A_\\pi^{\\tilde{M}}(s,a)\\big]-\\underbrace{\\text{KL trust-region penalty}}_{\\small \\text{(per-state KL radius)}}-\\underbrace{2 \\left(\\tfrac{\\varepsilon_R}{1-\\gamma}+\\tfrac{2\\gamma R_{\\max}}{(1-\\gamma)^2}\\varepsilon_P\\right)}_{\\small \\text{experience-model error}}</script>\n\n    <ul>\n      <li>… so synthetic surrogate gains exceeding these penalties guarantee real-environment improvement.</li>\n    </ul>\n  </li>\n</ul>\n<p>Tool-integrated reward modeling bridges the gap between <strong>tool-augmented reasoning</strong> and <strong>agentic RL</strong>. By enabling the reward function itself to utilize external resources, agents trained under TIRM learn a deeper mapping between reasoning actions and value estimation. This structure is directly applicable to RL-driven computer-use agents, where both <strong>process-level</strong> (step-wise) and <strong>outcome-based</strong> (goal completion) rewards must be optimized.</p>\n<p>In this framework, process-based rewards correspond to accurate intermediate reasoning and correct tool usage, while outcome-based rewards correspond to successful task completion. The combined signal provides agents with fine-grained credit assignment, improving learning efficiency and interpretability in web-based or API-integrated environments.</p>\n<p>Per <a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025), when training in synthetic environments, policy improvements can provably transfer to the real environment under standard trust-region updates. Writing the real MDP as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-279-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>S</mi><mo>,</mo><mi>A</mi><mo>,</mo><mi>P</mi><mo>,</mo><mi>R</mi><mo>,</mo><mi>&amp;#x03B3;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4398\" style=\"width: 9.273em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1007.66em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4399\"><span class=\"mi\" id=\"MathJax-Span-4400\" style=\"font-family: STIXGeneral-Italic;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4401\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-4402\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"mi\" id=\"MathJax-Span-4403\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4404\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4405\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">A</span><span class=\"mo\" id=\"MathJax-Span-4406\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4407\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">P</span><span class=\"mo\" id=\"MathJax-Span-4408\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4409\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">R</span><span class=\"mo\" id=\"MathJax-Span-4410\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4411\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4412\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>M</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>S</mi><mo>,</mo><mi>A</mi><mo>,</mo><mi>P</mi><mo>,</mo><mi>R</mi><mo>,</mo><mi>γ</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-279\">M=(S,A,P,R,\\gamma)</script> and the synthetic one as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-280-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>M</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>S</mi><mo>,</mo><mi>A</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo>,</mo><mi>&amp;#x03B3;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4413\" style=\"width: 9.273em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1007.66em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4414\"><span class=\"texatom\" id=\"MathJax-Span-4415\"><span class=\"mrow\" id=\"MathJax-Span-4416\"><span class=\"munderover\" id=\"MathJax-Span-4417\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4418\" style=\"font-family: STIXGeneral-Italic;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.315em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4419\" style=\"font-family: STIXGeneral-Regular;\">̃&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4420\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-4421\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"mi\" id=\"MathJax-Span-4422\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4423\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4424\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">A</span><span class=\"mo\" id=\"MathJax-Span-4425\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-4426\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4427\"><span class=\"munderover\" id=\"MathJax-Span-4428\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4429\" style=\"font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4430\" style=\"font-family: STIXGeneral-Regular;\">̃&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4431\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-4432\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4433\"><span class=\"munderover\" id=\"MathJax-Span-4434\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4435\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4436\" style=\"font-family: STIXGeneral-Regular;\">̃&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4437\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4438\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4439\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>M</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo>=</mo><mo stretchy=\"false\">(</mo><mi>S</mi><mo>,</mo><mi>A</mi><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>P</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo>,</mo><mi>γ</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-280\">\\tilde{M}=(S,A,\\tilde{P},\\tilde{R},\\gamma)</script> with bounded reward and transition errors <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-281-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B5;</mi><mi>R</mi></msub><mo>,</mo><msub><mi>&amp;#x03B5;</mi><mi>P</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4440\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1002.35em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4441\"><span class=\"msubsup\" id=\"MathJax-Span-4442\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4443\" style=\"font-family: STIXGeneral-Italic;\">ε</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4444\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4445\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4446\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4447\" style=\"font-family: STIXGeneral-Italic;\">ε</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4448\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>ε</mi><mi>R</mi></msub><mo>,</mo><msub><mi>ε</mi><mi>P</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-281\">\\varepsilon_R,\\varepsilon_P</script>, a KL-bounded update from <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-282-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msup><mi>&amp;#x03C0;</mi><mo>&amp;#x2032;</mo></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4449\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1003.13em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4450\"><span class=\"mi\" id=\"MathJax-Span-4451\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4452\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">→</span><span class=\"msup\" id=\"MathJax-Span-4453\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4454\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.576em;\"><span class=\"mo\" id=\"MathJax-Span-4455\" style=\"font-size: 70.7%; font-family: STIXVariants;\">′</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>π</mi><mo stretchy=\"false\">→</mo><msup><mi>π</mi><mo>′</mo></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-282\">\\pi\\to\\pi'</script> (as in PPO/GRPO) yields a lower bound of the form:</p>\n<ul>\n      <li>… so synthetic surrogate gains exceeding these penalties guarantee real-environment improvement.</li>\n    </ul>",
    "contentMarkdown": "*   [Tool-Augmented Reward Modeling (Themis)](https://arxiv.org/abs/2310.01045) by Li et al. (2024) proposes Tool-Augmented Reward Modeling (TARM) (also called Tool-Integrated Reward Modeling (TIRM)), which represents a significant evolution in RL for agents that operate within complex, tool-augmented environments. TARM integrates external computational and retrieval tools into the reward generation process itself. Instead of merely training language models to use tools during inference, TIRM embeds tool engagement as part of the reward model’s reasoning and supervision pipeline.\n    \n*   This approach extends the conventional Reinforcement Learning from Human Feedback (RLHF) paradigm—used in models such as [InstructGPT](https://arxiv.org/abs/2203.02155) by Ouyang et al. (2022)—by introducing **tool-augmented reasoning traces** and **context-sensitive reward estimation**, enabling more accurate alignment between model outputs and human evaluators’ expectations.\n    \n*   Put simply, tool-Integrated Reward Modeling advances RLHF by embedding reasoning transparency, external computation, and factual grounding directly into the reward modeling process. Through supervised fine-tuning on tool-augmented datasets and RL on process- and outcome-based signals, these models redefine how reward functions are constructed for intelligent agents. The resulting agents not only learn to act effectively but also to _evaluate_ their own reasoning with access to external world models—laying the foundation for trustworthy, explainable, and verifiable AI systems.\n    \n*   Reward-free early experience, proposed in [Agent Learning via Early Experience](https://arxiv.org/abs/2510.08558) by Zhang et al. (2025), can seed TARM and RLHF alike: implicit world modeling grounds the policy in environment dynamics, while self-reflection generates rationale-style preferences that complement pairwise comparisons used by reward models—providing a bridge from imitation/preference learning to full RL.\n    \n\n[Tool-Augmented Reward Modeling (Themis)](https://arxiv.org/abs/2310.01045) by Li et al. (2024) proposes Tool-Augmented Reward Modeling (TARM) (also called Tool-Integrated Reward Modeling (TIRM)), which represents a significant evolution in RL for agents that operate within complex, tool-augmented environments. TARM integrates external computational and retrieval tools into the reward generation process itself. Instead of merely training language models to use tools during inference, TIRM embeds tool engagement as part of the reward model’s reasoning and supervision pipeline.\n\nThis approach extends the conventional Reinforcement Learning from Human Feedback (RLHF) paradigm—used in models such as [InstructGPT](https://arxiv.org/abs/2203.02155) by Ouyang et al. (2022)—by introducing **tool-augmented reasoning traces** and **context-sensitive reward estimation**, enabling more accurate alignment between model outputs and human evaluators’ expectations.\n\nPut simply, tool-Integrated Reward Modeling advances RLHF by embedding reasoning transparency, external computation, and factual grounding directly into the reward modeling process. Through supervised fine-tuning on tool-augmented datasets and RL on process- and outcome-based signals, these models redefine how reward functions are constructed for intelligent agents. The resulting agents not only learn to act effectively but also to _evaluate_ their own reasoning with access to external world models—laying the foundation for trustworthy, explainable, and verifiable AI systems.\n\nReward-free early experience, proposed in [Agent Learning via Early Experience](https://arxiv.org/abs/2510.08558) by Zhang et al. (2025), can seed TARM and RLHF alike: implicit world modeling grounds the policy in environment dynamics, while self-reflection generates rationale-style preferences that complement pairwise comparisons used by reward models—providing a bridge from imitation/preference learning to full RL.\n\n#### Motivation and Background\n\n*   Traditional reward models in RLHF are trained using paired preference data, where a scalar reward is assigned based on human judgments. These models often struggle with factual reasoning, arithmetic operations, and real-world lookups due to their reliance on static, in-model knowledge representations ([Christiano et al., 2017](https://proceedings.neurips.cc/paper/2017/hash/d5e2c0adad503c91f91df240d0cd4e49-Abstract.html)). Tool-Integrated Reward Models mitigate this by allowing the reward model itself to call APIs, calculators, code interpreters, or search engines during evaluation.\n    \n*   Themis demonstrated that augmenting reward models with tools increased factual accuracy and truthfulness on benchmarks like TruthfulQA by 7.3% over large baselines such as Gopher 280B, while achieving a 17.7% average improvement in preference ranking accuracy across tasks.\n    \n\nTraditional reward models in RLHF are trained using paired preference data, where a scalar reward is assigned based on human judgments. These models often struggle with factual reasoning, arithmetic operations, and real-world lookups due to their reliance on static, in-model knowledge representations ([Christiano et al., 2017](https://proceedings.neurips.cc/paper/2017/hash/d5e2c0adad503c91f91df240d0cd4e49-Abstract.html)). Tool-Integrated Reward Models mitigate this by allowing the reward model itself to call APIs, calculators, code interpreters, or search engines during evaluation.\n\nThemis demonstrated that augmenting reward models with tools increased factual accuracy and truthfulness on benchmarks like TruthfulQA by 7.3% over large baselines such as Gopher 280B, while achieving a 17.7% average improvement in preference ranking accuracy across tasks.\n\n#### Structure and Workflow of Tool-Augmented Reward Models\n\n*   The tool-integrated reward modeling process can be decomposed into sequential reasoning stages—each enhancing the model’s interpretability and precision in assigning rewards:\n    \n    1.  **Thought**: The model assesses whether external information is required and determines which tool to invoke.\n    2.  **Action**: The model generates an API call with specified parameters.\n    3.  **Observation**: The system retrieves and processes tool outputs.\n    4.  **Rationale**: The model integrates the external information into a reasoning chain, constructing an interpretable trace of decision-making.\n    5.  **Reward Generation**: A scalar reward is computed from the aggregated reasoning trace.\n*   Formally, the total reasoning trajectory is denoted as:\n    \n\nThe tool-integrated reward modeling process can be decomposed into sequential reasoning stages—each enhancing the model’s interpretability and precision in assigning rewards:\n\n1.  **Thought**: The model assesses whether external information is required and determines which tool to invoke.\n2.  **Action**: The model generates an API call with specified parameters.\n3.  **Observation**: The system retrieves and processes tool outputs.\n4.  **Rationale**: The model integrates the external information into a reasoning chain, constructing an interpretable trace of decision-making.\n5.  **Reward Generation**: A scalar reward is computed from the aggregated reasoning trace.\n\nFormally, the total reasoning trajectory is denoted as:\n\nc1:T\\=(a1,o1,…,aT,oT,sT)c1:T\\=(a1,o1,…,aT,oT,sT)\n\n*   … and the scalar reward is defined as:\n    \n    rθ(x,y,c1:T)rθ(x,y,c1:T)\n    \n    r\\_{\\\\theta}(x, y, c\\_{1:T})\n    *   where xxx is the input, yyy is the model’s output, and c1:Tc1:Tc\\_{1:T} represents the full reasoning and observation history.\n*   The total loss function combines pairwise ranking and autoregressive modeling losses:\n    \n    Ltotal\\=LRM+α∑t\\=1T(Ltool(t)+βLobs(t))+ωLratLtotal\\=LRM+α∑t\\=1T(Ltool(t)+βLobs(t))+ωLrat\n    \n    L\\_{\\\\text{total}} = L\\_{\\\\text{RM}} + \\\\alpha \\\\sum\\_{t=1}^{T} (L\\_{\\\\text{tool}}(t) + \\\\beta L\\_{\\\\text{obs}}(t)) + \\\\omega L\\_{\\\\text{rat}}\n    *   where LRMLRML\\_{\\\\text{RM}} corresponds to the pairwise ranking loss from preference modeling, LtoolLtoolL\\_{\\\\text{tool}} supervises tool invocation accuracy, LobsLobsL\\_{\\\\text{obs}} captures fidelity to observed results, and LratLratL\\_{\\\\text{rat}} trains the model to generate coherent rationales.\n*   The following figure ([source](https://arxiv.org/abs/2310.01045)) shows illustrates the pipeline of (a) Vanilla reward models (RMs); (b) Tool-augmented RMs, namely Themis; (c) RL via proximal policy optimization (PPO) on above RMs; (d) Examples of single or multiple tool use process in the proposed approach.\n    \n\n… and the scalar reward is defined as:\n\n*   where xxx is the input, yyy is the model’s output, and c1:Tc1:Tc\\_{1:T} represents the full reasoning and observation history.\n\nThe total loss function combines pairwise ranking and autoregressive modeling losses:\n\n*   where LRMLRML\\_{\\\\text{RM}} corresponds to the pairwise ranking loss from preference modeling, LtoolLtoolL\\_{\\\\text{tool}} supervises tool invocation accuracy, LobsLobsL\\_{\\\\text{obs}} captures fidelity to observed results, and LratLratL\\_{\\\\text{rat}} trains the model to generate coherent rationales.\n\nThe following figure ([source](https://arxiv.org/abs/2310.01045)) shows illustrates the pipeline of (a) Vanilla reward models (RMs); (b) Tool-augmented RMs, namely Themis; (c) RL via proximal policy optimization (PPO) on above RMs; (d) Examples of single or multiple tool use process in the proposed approach.\n\n![](/primers/ai/assets/RL-for-agents/Themis.jpg)\n\n*   Per [Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025), when paired with synthetic experience generation, tool-augmented evaluators can operate at scale with consistent, informative feedback, while curriculum generation focuses on high-entropy tasks that maximize learning signal—closing the loop between reward modeling and data generation in RL training.\n\n#### Role of Supervised Fine-Tuning and Reinforcement Learning\n\n*   Themis—and, more broadly, TIRM—relies on a **hybrid SFT + RL training approach**.\n    \n    *   **SFT Stage**: The reward model learns to imitate tool usage traces from curated datasets (e.g., the [TARA dataset](https://github.com/ernie-research/Tool-Augmented-Reward-Model)). These traces include natural-language thoughts, API calls, and tool results generated via multi-agent interactions between LLMs and simulated human labelers.\n        \n    *   **RL Stage**: Once pre-trained, the reward model is further optimized via RL objectives like Proximal Policy Optimization (PPO) ([Schulman et al., 2017](https://arxiv.org/abs/1707.06347)). The model refines its reward predictions using outcome-based feedback, achieving stable convergence even under high variance tool-call trajectories.\n        \n*   This two-stage setup enables **process-based reward shaping**, in which partial rewards are granted for intermediate reasoning correctness (process rewards), and **outcome-based rewards** for overall task success. This balance is critical when agents operate in environments requiring both reasoning depth and correct final results.\n    \n*   Reward-free early experience provides a natural pretraining curriculum—first fitting LIWMLIWML\\_{\\\\mathrm{IWM}} to learn dynamics, then LSRLSRL\\_{\\\\mathrm{SR}} to internalize preference signals—before introducing PPO/GRPO or DPO on either real or synthetic rollouts (cf. [Agent Learning via Early Experience](https://arxiv.org/abs/2510.08558) by Zhang et al. (2025); [Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025)).\n    \n\nThemis—and, more broadly, TIRM—relies on a **hybrid SFT + RL training approach**.\n\n*   **SFT Stage**: The reward model learns to imitate tool usage traces from curated datasets (e.g., the [TARA dataset](https://github.com/ernie-research/Tool-Augmented-Reward-Model)). These traces include natural-language thoughts, API calls, and tool results generated via multi-agent interactions between LLMs and simulated human labelers.\n    \n*   **RL Stage**: Once pre-trained, the reward model is further optimized via RL objectives like Proximal Policy Optimization (PPO) ([Schulman et al., 2017](https://arxiv.org/abs/1707.06347)). The model refines its reward predictions using outcome-based feedback, achieving stable convergence even under high variance tool-call trajectories.\n    \n\n**SFT Stage**: The reward model learns to imitate tool usage traces from curated datasets (e.g., the [TARA dataset](https://github.com/ernie-research/Tool-Augmented-Reward-Model)). These traces include natural-language thoughts, API calls, and tool results generated via multi-agent interactions between LLMs and simulated human labelers.\n\n**RL Stage**: Once pre-trained, the reward model is further optimized via RL objectives like Proximal Policy Optimization (PPO) ([Schulman et al., 2017](https://arxiv.org/abs/1707.06347)). The model refines its reward predictions using outcome-based feedback, achieving stable convergence even under high variance tool-call trajectories.\n\nThis two-stage setup enables **process-based reward shaping**, in which partial rewards are granted for intermediate reasoning correctness (process rewards), and **outcome-based rewards** for overall task success. This balance is critical when agents operate in environments requiring both reasoning depth and correct final results.\n\nReward-free early experience provides a natural pretraining curriculum—first fitting LIWMLIWML\\_{\\\\mathrm{IWM}} to learn dynamics, then LSRLSRL\\_{\\\\mathrm{SR}} to internalize preference signals—before introducing PPO/GRPO or DPO on either real or synthetic rollouts (cf. [Agent Learning via Early Experience](https://arxiv.org/abs/2510.08558) by Zhang et al. (2025); [Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025)).\n\n#### The Tool-Augmented Reward Dataset (TARA)\n\n*   A key component of TIRM research is the creation of datasets that reflect real-world reasoning and tool usage patterns. The [TARA dataset](https://github.com/ernie-research/Tool-Augmented-Reward-Model) contains over 15,000 instances combining human preferences with explicit tool-invocation traces across seven tool categories, including search, translation, weather, calculator, and code execution.\n    \n*   The following figure ([source](https://arxiv.org/abs/2310.01045)) shows the data collection pipeline for TARA, depicting human-LLM interaction, tool invocation, and rationale generation. It the four-step process: (1) Question-answer collection, (2) ToolBank construction, (3) Tool invocation via multi-agent simulation, and (4) Filtering for data integrity.\n    \n\nA key component of TIRM research is the creation of datasets that reflect real-world reasoning and tool usage patterns. The [TARA dataset](https://github.com/ernie-research/Tool-Augmented-Reward-Model) contains over 15,000 instances combining human preferences with explicit tool-invocation traces across seven tool categories, including search, translation, weather, calculator, and code execution.\n\nThe following figure ([source](https://arxiv.org/abs/2310.01045)) shows the data collection pipeline for TARA, depicting human-LLM interaction, tool invocation, and rationale generation. It the four-step process: (1) Question-answer collection, (2) ToolBank construction, (3) Tool invocation via multi-agent simulation, and (4) Filtering for data integrity.\n\n![](/primers/ai/assets/RL-for-agents/TARA_Pipeline.jpg)\n\n#### Empirical Results and Observations\n\n*   Experiments show that Themis enhances both **single-tool** and **multi-tool** scenarios. For example:\n    \n    *   Accuracy improved by +19.2% in single-tool and +17.7% in mixed-tool setups.\n    *   Perfect accuracy (100%) was achieved in calendar and weather reasoning tasks.\n    *   Models learned when and whether to call tools autonomously—a form of learned tool invocation policy.\n    *   The observation and rationale components contributed significantly to reward accuracy, proving that **process supervision** is critical to model interpretability and consistency.\n*   Further, when integrated into an RLHF pipeline (referred to as RLTAF: Reinforcement Learning from Tool-Augmented Feedback), Themis-trained models achieved a 32% higher human preference win rate compared to vanilla RMs, highlighting its ability to generate more trustworthy and factual responses.\n    \n*   Complementarily, [Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025) proposes scaling RL with synthetic rollouts generated by a reasoning experience model, which yields substantial downstream gains and lowers on-environment data needs; e.g., DreamGym reports >30% improvements on WebArena and policy parity with PPO/GRPO using only synthetic interactions, after which real-environment fine-tuning brings additional gains.\n    \n*   The following figure illustrates an overview of the proposed DreamGym agent training framework. Given a set of seed tasks, a reasoning-based experience model interacts with the agent to generate informative, diverse tasks and trajectories for RL training. At each step, the agent takes actions based on its current state and receives next states and reward signals derived by the experience model through CoT reasoning based on both interaction history and top-k similar experiences from an active replay buffer. To expose the agent to increasingly informative scenarios, tasks with high reward entropy are proposed by the curriculum task generator for future training. With this unified design, DreamGym addresses both task and reward sparsity while enabling scalable RL with diverse and curriculum-driven environments.\n    \n\nExperiments show that Themis enhances both **single-tool** and **multi-tool** scenarios. For example:\n\n*   Accuracy improved by +19.2% in single-tool and +17.7% in mixed-tool setups.\n*   Perfect accuracy (100%) was achieved in calendar and weather reasoning tasks.\n*   Models learned when and whether to call tools autonomously—a form of learned tool invocation policy.\n*   The observation and rationale components contributed significantly to reward accuracy, proving that **process supervision** is critical to model interpretability and consistency.\n\nFurther, when integrated into an RLHF pipeline (referred to as RLTAF: Reinforcement Learning from Tool-Augmented Feedback), Themis-trained models achieved a 32% higher human preference win rate compared to vanilla RMs, highlighting its ability to generate more trustworthy and factual responses.\n\nComplementarily, [Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025) proposes scaling RL with synthetic rollouts generated by a reasoning experience model, which yields substantial downstream gains and lowers on-environment data needs; e.g., DreamGym reports >30% improvements on WebArena and policy parity with PPO/GRPO using only synthetic interactions, after which real-environment fine-tuning brings additional gains.\n\nThe following figure illustrates an overview of the proposed DreamGym agent training framework. Given a set of seed tasks, a reasoning-based experience model interacts with the agent to generate informative, diverse tasks and trajectories for RL training. At each step, the agent takes actions based on its current state and receives next states and reward signals derived by the experience model through CoT reasoning based on both interaction history and top-k similar experiences from an active replay buffer. To expose the agent to increasingly informative scenarios, tasks with high reward entropy are proposed by the curriculum task generator for future training. With this unified design, DreamGym addresses both task and reward sparsity while enabling scalable RL with diverse and curriculum-driven environments.\n\n![](/primers/ai/assets/RL-for-agents/DreamGym2.jpg)\n\n#### Connection to Reinforcement Learning for Agents\n\n*   Tool-integrated reward modeling bridges the gap between **tool-augmented reasoning** and **agentic RL**. By enabling the reward function itself to utilize external resources, agents trained under TIRM learn a deeper mapping between reasoning actions and value estimation. This structure is directly applicable to RL-driven computer-use agents, where both **process-level** (step-wise) and **outcome-based** (goal completion) rewards must be optimized.\n    \n*   In this framework, process-based rewards correspond to accurate intermediate reasoning and correct tool usage, while outcome-based rewards correspond to successful task completion. The combined signal provides agents with fine-grained credit assignment, improving learning efficiency and interpretability in web-based or API-integrated environments.\n    \n*   Per [Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025), when training in synthetic environments, policy improvements can provably transfer to the real environment under standard trust-region updates. Writing the real MDP as M\\=(S,A,P,R,γ)M\\=(S,A,P,R,γ)M=(S,A,P,R,\\\\gamma) and the synthetic one as M̃ \\=(S,A,P̃ ,R̃ ,γ)M~\\=(S,A,P~,R~,γ)\\\\tilde{M}=(S,A,\\\\tilde{P},\\\\tilde{R},\\\\gamma) with bounded reward and transition errors εR,εPεR,εP\\\\varepsilon\\_R,\\\\varepsilon\\_P, a KL-bounded update from π→π′π→π′\\\\pi\\\\to\\\\pi' (as in PPO/GRPO) yields a lower bound of the form:\n    \n    JM(π′)−JM(π)≥11−γ,𝔼s∼dM̃ π,a∼π′\\[AM̃ π(s,a)\\]−KL trust-region penalty(per-state KL radius)−2(εR1−γ+2γRmax(1−γ)2εP)experience-model errorJM(π′)−JM(π)≥11−γ,Es∼dπM~,a∼π′\\[AπM~(s,a)\\]−KL trust-region penalty⏟(per-state KL radius)−2(εR1−γ+2γRmax(1−γ)2εP)⏟experience-model error\n    \n    J\\_{M}(\\\\pi')-J\\_{M}(\\\\pi)\\\\ge\\\\frac{1}{1-\\\\gamma},\\\\mathbb{E}\\_{s\\\\sim d\\_\\\\pi^{\\\\tilde{M}},a\\\\sim \\\\pi'}\\\\big\\[A\\_\\\\pi^{\\\\tilde{M}}(s,a)\\\\big\\]-\\\\underbrace{\\\\text{KL trust-region penalty}}\\_{\\\\small \\\\text{(per-state KL radius)}}-\\\\underbrace{2 \\\\left(\\\\tfrac{\\\\varepsilon\\_R}{1-\\\\gamma}+\\\\tfrac{2\\\\gamma R\\_{\\\\max}}{(1-\\\\gamma)^2}\\\\varepsilon\\_P\\\\right)}\\_{\\\\small \\\\text{experience-model error}}\n    *   … so synthetic surrogate gains exceeding these penalties guarantee real-environment improvement.\n\nTool-integrated reward modeling bridges the gap between **tool-augmented reasoning** and **agentic RL**. By enabling the reward function itself to utilize external resources, agents trained under TIRM learn a deeper mapping between reasoning actions and value estimation. This structure is directly applicable to RL-driven computer-use agents, where both **process-level** (step-wise) and **outcome-based** (goal completion) rewards must be optimized.\n\nIn this framework, process-based rewards correspond to accurate intermediate reasoning and correct tool usage, while outcome-based rewards correspond to successful task completion. The combined signal provides agents with fine-grained credit assignment, improving learning efficiency and interpretability in web-based or API-integrated environments.\n\nPer [Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025), when training in synthetic environments, policy improvements can provably transfer to the real environment under standard trust-region updates. Writing the real MDP as M\\=(S,A,P,R,γ)M\\=(S,A,P,R,γ)M=(S,A,P,R,\\\\gamma) and the synthetic one as M̃ \\=(S,A,P̃ ,R̃ ,γ)M~\\=(S,A,P~,R~,γ)\\\\tilde{M}=(S,A,\\\\tilde{P},\\\\tilde{R},\\\\gamma) with bounded reward and transition errors εR,εPεR,εP\\\\varepsilon\\_R,\\\\varepsilon\\_P, a KL-bounded update from π→π′π→π′\\\\pi\\\\to\\\\pi' (as in PPO/GRPO) yields a lower bound of the form:\n\n*   … so synthetic surrogate gains exceeding these penalties guarantee real-environment improvement.",
    "order": 31,
    "orderInChapter": 3,
    "difficulty": 5,
    "estimatedMinutes": 15,
    "tags": [
      "algorithmsarchitecture",
      "embedding",
      "gpt",
      "llm",
      "reinforcement learning",
      "optimization",
      "loss function",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 2833,
      "contentLength": 149279
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#tool-augmented-reward-modeling-(tarm)",
    "scrapedAt": "2025-12-28T11:47:36.153Z"
  },
  {
    "id": "ai-agentic-RL-feedback-alignment-and-human-preference-modeling-32",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Reward Modeling",
    "title": "Feedback Alignment and Human Preference Modeling",
    "subtitle": "Reward Modeling",
    "contentHtml": "<ul>\n  <li>\n    <p>Reward models provide scalar supervision, but alignment requires <em>structured feedback</em>. Human evaluators often give comparative, categorical, or qualitative feedback (e.g., “response A is clearer, but response B is more complete”).</p>\n  </li>\n  <li>\n    <p>To convert such structured feedback into training signals, systems employ <strong>preference aggregation</strong> methods such as:</p>\n\n    <ul>\n      <li><em>Bradley–Terry models</em> to infer pairwise preference probabilities.</li>\n      <li><em>Elo-style scoring</em> to maintain global quality rankings across responses.</li>\n      <li><em>Bayesian aggregation</em> for uncertain or noisy feedback.</li>\n    </ul>\n  </li>\n  <li>\n    <p>In advanced systems like <a href=\"https://arxiv.org/abs/2405.20309\">Large Language Models Can Self-improve at Web Agent Tasks</a> by Patel et al. (2024), self-feedback mechanisms replace human labeling. The agent critiques its own trajectories using LLM-based evaluators, ranking which paths yielded the best progress and then re-finetuning on its own top-performing examples.</p>\n  </li>\n  <li>\n    <p>This method creates a <strong>feedback alignment loop</strong>, where models not only learn from human signals but also gradually calibrate their own evaluators.</p>\n  </li>\n</ul>\n<p>Reward models provide scalar supervision, but alignment requires <em>structured feedback</em>. Human evaluators often give comparative, categorical, or qualitative feedback (e.g., “response A is clearer, but response B is more complete”).</p>\n<p>To convert such structured feedback into training signals, systems employ <strong>preference aggregation</strong> methods such as:</p>\n<ul>\n      <li><em>Bradley–Terry models</em> to infer pairwise preference probabilities.</li>\n      <li><em>Elo-style scoring</em> to maintain global quality rankings across responses.</li>\n      <li><em>Bayesian aggregation</em> for uncertain or noisy feedback.</li>\n    </ul>\n<p>In advanced systems like <a href=\"https://arxiv.org/abs/2405.20309\">Large Language Models Can Self-improve at Web Agent Tasks</a> by Patel et al. (2024), self-feedback mechanisms replace human labeling. The agent critiques its own trajectories using LLM-based evaluators, ranking which paths yielded the best progress and then re-finetuning on its own top-performing examples.</p>\n<p>This method creates a <strong>feedback alignment loop</strong>, where models not only learn from human signals but also gradually calibrate their own evaluators.</p>",
    "contentMarkdown": "*   Reward models provide scalar supervision, but alignment requires _structured feedback_. Human evaluators often give comparative, categorical, or qualitative feedback (e.g., “response A is clearer, but response B is more complete”).\n    \n*   To convert such structured feedback into training signals, systems employ **preference aggregation** methods such as:\n    \n    *   _Bradley–Terry models_ to infer pairwise preference probabilities.\n    *   _Elo-style scoring_ to maintain global quality rankings across responses.\n    *   _Bayesian aggregation_ for uncertain or noisy feedback.\n*   In advanced systems like [Large Language Models Can Self-improve at Web Agent Tasks](https://arxiv.org/abs/2405.20309) by Patel et al. (2024), self-feedback mechanisms replace human labeling. The agent critiques its own trajectories using LLM-based evaluators, ranking which paths yielded the best progress and then re-finetuning on its own top-performing examples.\n    \n*   This method creates a **feedback alignment loop**, where models not only learn from human signals but also gradually calibrate their own evaluators.\n    \n\nReward models provide scalar supervision, but alignment requires _structured feedback_. Human evaluators often give comparative, categorical, or qualitative feedback (e.g., “response A is clearer, but response B is more complete”).\n\nTo convert such structured feedback into training signals, systems employ **preference aggregation** methods such as:\n\n*   _Bradley–Terry models_ to infer pairwise preference probabilities.\n*   _Elo-style scoring_ to maintain global quality rankings across responses.\n*   _Bayesian aggregation_ for uncertain or noisy feedback.\n\nIn advanced systems like [Large Language Models Can Self-improve at Web Agent Tasks](https://arxiv.org/abs/2405.20309) by Patel et al. (2024), self-feedback mechanisms replace human labeling. The agent critiques its own trajectories using LLM-based evaluators, ranking which paths yielded the best progress and then re-finetuning on its own top-performing examples.\n\nThis method creates a **feedback alignment loop**, where models not only learn from human signals but also gradually calibrate their own evaluators.",
    "order": 32,
    "orderInChapter": 4,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 284,
      "contentLength": 2521
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#feedback-alignment-and-human-preference-modeling",
    "scrapedAt": "2025-12-28T11:47:36.153Z"
  },
  {
    "id": "ai-agentic-RL-multi-objective-reward-modeling-33",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Reward Modeling",
    "title": "Multi-Objective Reward Modeling",
    "subtitle": "Reward Modeling",
    "contentHtml": "<ul>\n  <li>As agents evolve to handle multi-modal and multi-task objectives—such as reasoning, retrieval, and tool orchestration—single scalar reward functions become insufficient.</li>\n  <li>\n    <p>Instead, <strong>multi-objective reward modeling (MORM)</strong> decomposes total reward into several components:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-284-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>w</mi><mi>k</mi></msub><mo>,</mo><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4592\" style=\"width: 7.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.263em, 1006.3em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4593\"><span class=\"msubsup\" id=\"MathJax-Span-4594\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4595\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4596\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4597\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-4598\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4599\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.273em, -999.997em); top: -2.862em; left: 0.055em;\"><span class=\"texatom\" id=\"MathJax-Span-4600\"><span class=\"mrow\" id=\"MathJax-Span-4601\"><span class=\"mi\" id=\"MathJax-Span-4602\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4603\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-4604\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.52em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-4605\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4606\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4607\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-4608\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4609\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4610\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4611\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4612\"><span class=\"mrow\" id=\"MathJax-Span-4613\"><span class=\"mo\" id=\"MathJax-Span-4614\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4615\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4616\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4617\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>w</mi><mi>k</mi></msub><mo>,</mo><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-284\">r_t = \\sum_{k=1}^K w_k , r_t^{(k)}</script>\n\n    <ul>\n      <li>where each <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-285-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4618\" style=\"width: 1.669em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.36em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4619\"><span class=\"msubsup\" id=\"MathJax-Span-4620\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4621\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4622\"><span class=\"mrow\" id=\"MathJax-Span-4623\"><span class=\"mo\" id=\"MathJax-Span-4624\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4625\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4626\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4627\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-285\">r_t^{(k)}</script> corresponds to a distinct objective (e.g., factual accuracy, efficiency, safety, fluency), and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-286-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4628\" style=\"width: 1.357em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.1em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4629\"><span class=\"msubsup\" id=\"MathJax-Span-4630\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4631\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-4632\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>w</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-286\">w_k</script> are learned or manually tuned weights.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This decomposition enables flexible tradeoffs—for example, prioritizing accuracy over verbosity or reliability over speed. In web and software agents, multi-objective RMs can encode:</p>\n\n    <ul>\n      <li>Functional correctness (execution success),</li>\n      <li>Temporal efficiency (fewer steps or tool calls),</li>\n      <li>Adherence to user goals (alignment quality),</li>\n      <li>Safety and compliance (filtered language use).</li>\n    </ul>\n  </li>\n  <li>Combining these objectives helps agents develop a balanced understanding of what constitutes “good behavior” in dynamic and human-centric environments.</li>\n</ul>\n<p>Instead, <strong>multi-objective reward modeling (MORM)</strong> decomposes total reward into several components:</p>\n<ul>\n      <li>where each <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-285-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4618\" style=\"width: 1.669em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.36em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4619\"><span class=\"msubsup\" id=\"MathJax-Span-4620\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4621\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4622\"><span class=\"mrow\" id=\"MathJax-Span-4623\"><span class=\"mo\" id=\"MathJax-Span-4624\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4625\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4626\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4627\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-285\">r_t^{(k)}</script> corresponds to a distinct objective (e.g., factual accuracy, efficiency, safety, fluency), and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-286-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4628\" style=\"width: 1.357em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.1em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4629\"><span class=\"msubsup\" id=\"MathJax-Span-4630\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4631\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-4632\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>w</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-286\">w_k</script> are learned or manually tuned weights.</li>\n    </ul>\n<p>This decomposition enables flexible tradeoffs—for example, prioritizing accuracy over verbosity or reliability over speed. In web and software agents, multi-objective RMs can encode:</p>\n<ul>\n      <li>Functional correctness (execution success),</li>\n      <li>Temporal efficiency (fewer steps or tool calls),</li>\n      <li>Adherence to user goals (alignment quality),</li>\n      <li>Safety and compliance (filtered language use).</li>\n    </ul>",
    "contentMarkdown": "*   As agents evolve to handle multi-modal and multi-task objectives—such as reasoning, retrieval, and tool orchestration—single scalar reward functions become insufficient.\n*   Instead, **multi-objective reward modeling (MORM)** decomposes total reward into several components:\n    \n    rt\\=∑k\\=1Kwk,r(k)trt\\=∑k\\=1Kwk,rt(k)\n    \n    r\\_t = \\\\sum\\_{k=1}^K w\\_k , r\\_t^{(k)}\n    *   where each r(k)trt(k)r\\_t^{(k)} corresponds to a distinct objective (e.g., factual accuracy, efficiency, safety, fluency), and wkwkw\\_k are learned or manually tuned weights.\n*   This decomposition enables flexible tradeoffs—for example, prioritizing accuracy over verbosity or reliability over speed. In web and software agents, multi-objective RMs can encode:\n    \n    *   Functional correctness (execution success),\n    *   Temporal efficiency (fewer steps or tool calls),\n    *   Adherence to user goals (alignment quality),\n    *   Safety and compliance (filtered language use).\n*   Combining these objectives helps agents develop a balanced understanding of what constitutes “good behavior” in dynamic and human-centric environments.\n\nInstead, **multi-objective reward modeling (MORM)** decomposes total reward into several components:\n\n*   where each r(k)trt(k)r\\_t^{(k)} corresponds to a distinct objective (e.g., factual accuracy, efficiency, safety, fluency), and wkwkw\\_k are learned or manually tuned weights.\n\nThis decomposition enables flexible tradeoffs—for example, prioritizing accuracy over verbosity or reliability over speed. In web and software agents, multi-objective RMs can encode:\n\n*   Functional correctness (execution success),\n*   Temporal efficiency (fewer steps or tool calls),\n*   Adherence to user goals (alignment quality),\n*   Safety and compliance (filtered language use).",
    "order": 33,
    "orderInChapter": 5,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 218,
      "contentLength": 18858
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#multi-objective-reward-modeling",
    "scrapedAt": "2025-12-28T11:47:36.153Z"
  },
  {
    "id": "ai-agentic-RL-evaluation-frameworks-for-rl-based-agents-34",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Reward Modeling",
    "title": "Evaluation Frameworks for RL-Based Agents",
    "subtitle": "Reward Modeling",
    "contentHtml": "<ul>\n  <li>Evaluating agents trained through RL requires going beyond static benchmarks. Instead of only measuring final success, modern frameworks evaluate <em>trajectory quality, interpretability, and generalization</em>.</li>\n</ul>\n<h4 id=\"key-evaluation-metrics-include\">Key Evaluation Metrics Include</h4>\n<ul>\n  <li><strong>Success Rate:</strong> Fraction of episodes where the agent achieves its goal (e.g., booking completed, question answered).</li>\n  <li><strong>Cumulative Reward:</strong> Sum of step-wise rewards, indicating the efficiency of action selection.</li>\n  <li><strong>Action Accuracy:</strong> Proportion of correct API or tool calls.</li>\n  <li><strong>Trajectory Efficiency:</strong> Number of steps or actions required to reach completion.</li>\n  <li><strong>Human Preference Score:</strong> Alignment with human judgment over multiple outputs.</li>\n  <li>\n    <p><strong>Robustness:</strong> Performance under perturbed or unseen web environments.</p>\n  </li>\n  <li>Frameworks such as WebArena, Mind2Web, and AgentBench (as catalogued in <a href=\"https://arxiv.org/abs/2406.04151\">AgentGym</a> by Xi et al., 2024) provide unified benchmarks with standardized reward metrics and simulator APIs for reproducible agent training.</li>\n</ul>\n<p><strong>Robustness:</strong> Performance under perturbed or unseen web environments.</p>",
    "contentMarkdown": "*   Evaluating agents trained through RL requires going beyond static benchmarks. Instead of only measuring final success, modern frameworks evaluate _trajectory quality, interpretability, and generalization_.\n\n#### Key Evaluation Metrics Include\n\n*   **Success Rate:** Fraction of episodes where the agent achieves its goal (e.g., booking completed, question answered).\n*   **Cumulative Reward:** Sum of step-wise rewards, indicating the efficiency of action selection.\n*   **Action Accuracy:** Proportion of correct API or tool calls.\n*   **Trajectory Efficiency:** Number of steps or actions required to reach completion.\n*   **Human Preference Score:** Alignment with human judgment over multiple outputs.\n*   **Robustness:** Performance under perturbed or unseen web environments.\n    \n*   Frameworks such as WebArena, Mind2Web, and AgentBench (as catalogued in [AgentGym](https://arxiv.org/abs/2406.04151) by Xi et al., 2024) provide unified benchmarks with standardized reward metrics and simulator APIs for reproducible agent training.\n\n**Robustness:** Performance under perturbed or unseen web environments.",
    "order": 34,
    "orderInChapter": 6,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 141,
      "contentLength": 1357
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#evaluation-frameworks-for-rl-based-agents",
    "scrapedAt": "2025-12-28T11:47:36.153Z"
  },
  {
    "id": "ai-agentic-RL-takeaways-35",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Reward Modeling",
    "title": "Takeaways",
    "subtitle": "Reward Modeling",
    "contentHtml": "<ul>\n  <li>\n    <p>Reward modeling and feedback alignment form the core of how RL agents evolve from static predictors into <em>adaptive decision-makers</em>. The design of these mechanisms determines whether agents learn to pursue shallow, short-term signals or to internalize long-term, value-aligned behavior.</p>\n\n    <ul>\n      <li><strong>Outcome-based rewards</strong> ensure goal fidelity but suffer from sparsity.</li>\n      <li><strong>Process-wise rewards</strong> provide dense guidance and interpretability.</li>\n      <li><strong>Tool-augmented reward models</strong> enhance factual grounding and transparency.</li>\n      <li><strong>Human and self-generated feedback</strong> create continuous learning loops.</li>\n      <li><strong>Multi-objective reward modeling</strong> allows flexible alignment across multiple competing priorities.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Together, these innovations define the modern ecosystem of RL-based agentic training—where the agent not only <em>acts</em> in its environment but also <em>learns how to evaluate its own progress</em>.</p>\n  </li>\n</ul>\n<p>Reward modeling and feedback alignment form the core of how RL agents evolve from static predictors into <em>adaptive decision-makers</em>. The design of these mechanisms determines whether agents learn to pursue shallow, short-term signals or to internalize long-term, value-aligned behavior.</p>\n<ul>\n      <li><strong>Outcome-based rewards</strong> ensure goal fidelity but suffer from sparsity.</li>\n      <li><strong>Process-wise rewards</strong> provide dense guidance and interpretability.</li>\n      <li><strong>Tool-augmented reward models</strong> enhance factual grounding and transparency.</li>\n      <li><strong>Human and self-generated feedback</strong> create continuous learning loops.</li>\n      <li><strong>Multi-objective reward modeling</strong> allows flexible alignment across multiple competing priorities.</li>\n    </ul>\n<p>Together, these innovations define the modern ecosystem of RL-based agentic training—where the agent not only <em>acts</em> in its environment but also <em>learns how to evaluate its own progress</em>.</p>",
    "contentMarkdown": "*   Reward modeling and feedback alignment form the core of how RL agents evolve from static predictors into _adaptive decision-makers_. The design of these mechanisms determines whether agents learn to pursue shallow, short-term signals or to internalize long-term, value-aligned behavior.\n    \n    *   **Outcome-based rewards** ensure goal fidelity but suffer from sparsity.\n    *   **Process-wise rewards** provide dense guidance and interpretability.\n    *   **Tool-augmented reward models** enhance factual grounding and transparency.\n    *   **Human and self-generated feedback** create continuous learning loops.\n    *   **Multi-objective reward modeling** allows flexible alignment across multiple competing priorities.\n*   Together, these innovations define the modern ecosystem of RL-based agentic training—where the agent not only _acts_ in its environment but also _learns how to evaluate its own progress_.\n    \n\nReward modeling and feedback alignment form the core of how RL agents evolve from static predictors into _adaptive decision-makers_. The design of these mechanisms determines whether agents learn to pursue shallow, short-term signals or to internalize long-term, value-aligned behavior.\n\n*   **Outcome-based rewards** ensure goal fidelity but suffer from sparsity.\n*   **Process-wise rewards** provide dense guidance and interpretability.\n*   **Tool-augmented reward models** enhance factual grounding and transparency.\n*   **Human and self-generated feedback** create continuous learning loops.\n*   **Multi-objective reward modeling** allows flexible alignment across multiple competing priorities.\n\nTogether, these innovations define the modern ecosystem of RL-based agentic training—where the agent not only _acts_ in its environment but also _learns how to evaluate its own progress_.",
    "order": 35,
    "orderInChapter": 7,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 230,
      "contentLength": 2167
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#takeaways",
    "scrapedAt": "2025-12-28T11:47:36.153Z"
  },
  {
    "id": "ai-agentic-RL-motivation-exploration-vs-exploitation-in-complex--36",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "title": "Motivation: Exploration vs. Exploitation in Complex Agentic Systems",
    "subtitle": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "contentHtml": "<ul>\n  <li>\n    <p>In RL, agents must navigate the fundamental trade-off between <strong>exploration</strong>—trying new actions to discover better strategies—and <strong>exploitation</strong>—using known information to maximize immediate reward.</p>\n  </li>\n  <li>\n    <p>For simple environments (like tabular Q-learning), this trade-off can be controlled by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-287-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4633\" style=\"width: 0.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.42em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4634\"><span class=\"mi\" id=\"MathJax-Span-4635\" style=\"font-family: STIXGeneral-Italic;\">ϵ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>ϵ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-287\">\\epsilon</script>-greedy or softmax policies. However, for web and computer-use agents operating in open-ended, high-dimensional spaces—such as browsing dynamic web pages, calling APIs, or managing multi-turn dialogues—naive exploration is computationally infeasible and unsafe.</p>\n  </li>\n  <li>\n    <p>Thus, modern agentic RL systems combine <em>search-based exploration</em> with <em>learned policy optimization</em>, blending symbolic planning with neural policy priors. This hybrid paradigm is exemplified by recent works like <a href=\"https://arxiv.org/abs/2408.07199\">Agent Q: Efficient Online Adaptation via Monte Carlo Tree Search</a> by Putta et al. (2024) and <a href=\"https://arxiv.org/abs/2410.19609\">OpenWebVoyager</a> by He et al. (2024), both of which adapt classic search strategies (like MCTS) for reasoning-driven web environments.</p>\n  </li>\n  <li>\n    <p>Complementary to these, <a href=\"https://arxiv.org/abs/2510.08558\">Agent Learning via Early Experience</a> by Zhang et al. (2025) shows that exploration itself can begin <em>before</em> any reward modeling, by leveraging self-reflective rollouts and implicit world modeling to pretrain a policy that already encodes structured exploration biases. Similarly, <a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025) formalizes a scalable simulation framework—<strong>DreamGym</strong>—that generates synthetic exploratory rollouts under theoretical guarantees of policy improvement transfer to real environments.</p>\n  </li>\n  <li>\n    <p>The following figure shows the <em>Agent Q architecture</em>, demonstrating how an agent integrates Monte Carlo Tree Search (MCTS) with an internal policy model to efficiently explore and adapt to dynamic environments.</p>\n  </li>\n</ul>\n<p>In RL, agents must navigate the fundamental trade-off between <strong>exploration</strong>—trying new actions to discover better strategies—and <strong>exploitation</strong>—using known information to maximize immediate reward.</p>\n<p>For simple environments (like tabular Q-learning), this trade-off can be controlled by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-287-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4633\" style=\"width: 0.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.42em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4634\"><span class=\"mi\" id=\"MathJax-Span-4635\" style=\"font-family: STIXGeneral-Italic;\">ϵ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>ϵ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-287\">\\epsilon</script>-greedy or softmax policies. However, for web and computer-use agents operating in open-ended, high-dimensional spaces—such as browsing dynamic web pages, calling APIs, or managing multi-turn dialogues—naive exploration is computationally infeasible and unsafe.</p>\n<p>Thus, modern agentic RL systems combine <em>search-based exploration</em> with <em>learned policy optimization</em>, blending symbolic planning with neural policy priors. This hybrid paradigm is exemplified by recent works like <a href=\"https://arxiv.org/abs/2408.07199\">Agent Q: Efficient Online Adaptation via Monte Carlo Tree Search</a> by Putta et al. (2024) and <a href=\"https://arxiv.org/abs/2410.19609\">OpenWebVoyager</a> by He et al. (2024), both of which adapt classic search strategies (like MCTS) for reasoning-driven web environments.</p>\n<p>Complementary to these, <a href=\"https://arxiv.org/abs/2510.08558\">Agent Learning via Early Experience</a> by Zhang et al. (2025) shows that exploration itself can begin <em>before</em> any reward modeling, by leveraging self-reflective rollouts and implicit world modeling to pretrain a policy that already encodes structured exploration biases. Similarly, <a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025) formalizes a scalable simulation framework—<strong>DreamGym</strong>—that generates synthetic exploratory rollouts under theoretical guarantees of policy improvement transfer to real environments.</p>\n<p>The following figure shows the <em>Agent Q architecture</em>, demonstrating how an agent integrates Monte Carlo Tree Search (MCTS) with an internal policy model to efficiently explore and adapt to dynamic environments.</p>\n<p><img src=\"/primers/ai/assets/RL-for-agents/AgentQ.jpg\" alt=\"\"></p>\n<ul>\n  <li>The following figure illustrates that Agent Q is provided the following input format to the Agent, consisting of the system prompt, execution history, the current observation as a DOM representation, and the user query containing the goal. We divide our Agent output format into an overall step-by-step plan, thought, a command, and a status code.</li>\n</ul>\n<p><img src=\"/primers/ai/assets/RL-for-agents/AgentQ1.jpg\" alt=\"\"></p>",
    "contentMarkdown": "*   In RL, agents must navigate the fundamental trade-off between **exploration**—trying new actions to discover better strategies—and **exploitation**—using known information to maximize immediate reward.\n    \n*   For simple environments (like tabular Q-learning), this trade-off can be controlled by ϵϵ\\\\epsilon\\-greedy or softmax policies. However, for web and computer-use agents operating in open-ended, high-dimensional spaces—such as browsing dynamic web pages, calling APIs, or managing multi-turn dialogues—naive exploration is computationally infeasible and unsafe.\n    \n*   Thus, modern agentic RL systems combine _search-based exploration_ with _learned policy optimization_, blending symbolic planning with neural policy priors. This hybrid paradigm is exemplified by recent works like [Agent Q: Efficient Online Adaptation via Monte Carlo Tree Search](https://arxiv.org/abs/2408.07199) by Putta et al. (2024) and [OpenWebVoyager](https://arxiv.org/abs/2410.19609) by He et al. (2024), both of which adapt classic search strategies (like MCTS) for reasoning-driven web environments.\n    \n*   Complementary to these, [Agent Learning via Early Experience](https://arxiv.org/abs/2510.08558) by Zhang et al. (2025) shows that exploration itself can begin _before_ any reward modeling, by leveraging self-reflective rollouts and implicit world modeling to pretrain a policy that already encodes structured exploration biases. Similarly, [Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025) formalizes a scalable simulation framework—**DreamGym**—that generates synthetic exploratory rollouts under theoretical guarantees of policy improvement transfer to real environments.\n    \n*   The following figure shows the _Agent Q architecture_, demonstrating how an agent integrates Monte Carlo Tree Search (MCTS) with an internal policy model to efficiently explore and adapt to dynamic environments.\n    \n\nIn RL, agents must navigate the fundamental trade-off between **exploration**—trying new actions to discover better strategies—and **exploitation**—using known information to maximize immediate reward.\n\nFor simple environments (like tabular Q-learning), this trade-off can be controlled by ϵϵ\\\\epsilon\\-greedy or softmax policies. However, for web and computer-use agents operating in open-ended, high-dimensional spaces—such as browsing dynamic web pages, calling APIs, or managing multi-turn dialogues—naive exploration is computationally infeasible and unsafe.\n\nThus, modern agentic RL systems combine _search-based exploration_ with _learned policy optimization_, blending symbolic planning with neural policy priors. This hybrid paradigm is exemplified by recent works like [Agent Q: Efficient Online Adaptation via Monte Carlo Tree Search](https://arxiv.org/abs/2408.07199) by Putta et al. (2024) and [OpenWebVoyager](https://arxiv.org/abs/2410.19609) by He et al. (2024), both of which adapt classic search strategies (like MCTS) for reasoning-driven web environments.\n\nComplementary to these, [Agent Learning via Early Experience](https://arxiv.org/abs/2510.08558) by Zhang et al. (2025) shows that exploration itself can begin _before_ any reward modeling, by leveraging self-reflective rollouts and implicit world modeling to pretrain a policy that already encodes structured exploration biases. Similarly, [Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025) formalizes a scalable simulation framework—**DreamGym**—that generates synthetic exploratory rollouts under theoretical guarantees of policy improvement transfer to real environments.\n\nThe following figure shows the _Agent Q architecture_, demonstrating how an agent integrates Monte Carlo Tree Search (MCTS) with an internal policy model to efficiently explore and adapt to dynamic environments.\n\n![](/primers/ai/assets/RL-for-agents/AgentQ.jpg)\n\n*   The following figure illustrates that Agent Q is provided the following input format to the Agent, consisting of the system prompt, execution history, the current observation as a DOM representation, and the user query containing the goal. We divide our Agent output format into an overall step-by-step plan, thought, a command, and a status code.\n\n![](/primers/ai/assets/RL-for-agents/AgentQ1.jpg)",
    "order": 36,
    "orderInChapter": 1,
    "difficulty": 5,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 529,
      "contentLength": 7120
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#motivation:-exploration-vs.-exploitation-in-complex-agentic-systems",
    "scrapedAt": "2025-12-28T11:47:36.153Z"
  },
  {
    "id": "ai-agentic-RL-monte-carlo-tree-search-mcts-in-rl-based-agents-37",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "title": "Monte Carlo Tree Search (MCTS) in RL-Based Agents",
    "subtitle": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Monte Carlo Tree Search (MCTS)</strong> is a planning algorithm that estimates the value of actions through simulation. Each node in the search tree represents a state, and edges represent actions. During training, the agent builds a partial search tree by simulating action sequences, updating node values using empirical rollouts.</p>\n  </li>\n  <li>\n    <p>At each decision step, MCTS performs four core operations:</p>\n\n    <ol>\n      <li>\n        <p><strong>Selection:</strong> Traverse the current tree from the root to a leaf, selecting child nodes using the <em>Upper Confidence Bound</em> (UCB) rule:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-288-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>a</mi></munder><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>c</mi><msqrt><mfrac><mrow><mi>ln</mi><mo>&amp;#x2061;</mo><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mn>1</mn><mo>+</mo><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></msqrt><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4636\" style=\"width: 20.419em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.982em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1016.77em, 4.326em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4637\"><span class=\"msubsup\" id=\"MathJax-Span-4638\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4639\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4640\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4641\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4642\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-4643\"></span><span class=\"munderover\" id=\"MathJax-Span-4644\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4645\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.273em, -999.997em); top: -3.331em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-4646\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4647\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4648\"><span class=\"mo\" id=\"MathJax-Span-4649\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-4650\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-4651\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4652\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4653\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4654\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4655\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4656\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4657\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4658\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-4659\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">c</span><span class=\"msqrt\" id=\"MathJax-Span-4660\"><span style=\"display: inline-block; position: relative; width: 6.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.503em, 1005.11em, 5.055em, -999.997em); top: -4.008em; left: 1.148em;\"><span class=\"mrow\" id=\"MathJax-Span-4661\"><span class=\"mfrac\" id=\"MathJax-Span-4662\"><span style=\"display: inline-block; position: relative; width: 4.846em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.02em, 4.326em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.508em;\"><span class=\"mrow\" id=\"MathJax-Span-4663\"><span class=\"mi\" id=\"MathJax-Span-4664\" style=\"font-family: STIXGeneral-Regular;\">ln</span><span class=\"mo\" id=\"MathJax-Span-4665\"></span><span class=\"mi\" id=\"MathJax-Span-4666\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4667\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4668\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4669\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4670\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4671\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1004.69em, 4.326em, -999.997em); top: -3.331em; left: 50%; margin-left: -2.341em;\"><span class=\"mrow\" id=\"MathJax-Span-4672\"><span class=\"mn\" id=\"MathJax-Span-4673\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-4674\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-4675\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4676\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4677\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4678\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4679\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4680\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4681\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4682\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.85em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.846em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.023em, 1005.11em, 3.388em, -999.997em); top: -4.633em; left: 1.148em;\"><span style=\"display: inline-block; position: relative; width: 5.107em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 0em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 4.638em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.419em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.836em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.253em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.669em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.086em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.503em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.919em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.336em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.805em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 4.221em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(1.826em, 1001.15em, 4.586em, -999.997em); top: -3.383em; left: 0em;\"><span style=\"font-family: STIXSizeTwoSym;\">√</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4683\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-4684\"><span class=\"mo\" id=\"MathJax-Span-4685\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>a</mi></munder><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>c</mi><msqrt><mfrac><mrow><mi>ln</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mn>1</mn><mo>+</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></msqrt><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-288\">a_t = \\arg\\max_a \\big[ Q(s_t,a) + c \\sqrt{\\frac{\\ln N(s_t)}{1 + N(s_t,a)}} \\big]</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-289-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4686\" style=\"width: 3.596em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.92em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4687\"><span class=\"mi\" id=\"MathJax-Span-4688\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-4689\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4690\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4691\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4692\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4693\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4694\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4695\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-289\">Q(s_t,a)</script> is the estimated action value, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-290-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4696\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4697\"><span class=\"mi\" id=\"MathJax-Span-4698\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4699\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4700\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4701\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4702\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4703\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4704\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4705\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>N</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-290\">N(s_t,a)</script> the visit count, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-291-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4706\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4707\"><span class=\"mi\" id=\"MathJax-Span-4708\" style=\"font-family: STIXGeneral-Italic;\">c</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>c</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-291\">c</script> a confidence constant.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Expansion:</strong> Add one or more new child nodes to the tree.</p>\n      </li>\n      <li>\n        <p><strong>Simulation:</strong> Run a rollout (either with a learned policy or random actions) to estimate the outcome.</p>\n      </li>\n      <li>\n        <p><strong>Backpropagation:</strong> Update <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-292-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4709\" style=\"width: 3.596em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.92em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4710\"><span class=\"mi\" id=\"MathJax-Span-4711\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-4712\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4713\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4714\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4715\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4716\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4717\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4718\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-292\">Q(s_t,a)</script> values along the traversed path with the observed return.</p>\n      </li>\n    </ol>\n  </li>\n  <li>\n    <p>This method balances exploration and exploitation dynamically—favoring actions with high potential but uncertain estimates.</p>\n  </li>\n  <li>\n    <p>In the context of LLM-based web agents, MCTS is adapted to explore <em>semantic</em> and <em>structural</em> decision spaces rather than numeric ones. Each node can represent:</p>\n\n    <ul>\n      <li>A browser state (DOM snapshot, active page).</li>\n      <li>A reasoning context (prompt, plan, partial output).</li>\n      <li>A tool invocation (function call, API parameterization).</li>\n    </ul>\n  </li>\n  <li>\n    <p>MCTS then simulates different reasoning or action trajectories, evaluates their predicted rewards (using a reward model or preference score), and backpropagates this information to refine the policy.</p>\n  </li>\n  <li>\n    <p>Recent approaches such as <a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025) extend this principle by introducing a <strong>reasoning-based experience model</strong> that performs analogous “tree search” operations within a learned world model—sampling synthetic trajectories that approximate MCTS rollouts without direct environment interaction, thereby dramatically improving sample efficiency.</p>\n  </li>\n</ul>\n<p><strong>Monte Carlo Tree Search (MCTS)</strong> is a planning algorithm that estimates the value of actions through simulation. Each node in the search tree represents a state, and edges represent actions. During training, the agent builds a partial search tree by simulating action sequences, updating node values using empirical rollouts.</p>\n<p>At each decision step, MCTS performs four core operations:</p>\n<ol>\n      <li>\n        <p><strong>Selection:</strong> Traverse the current tree from the root to a leaf, selecting child nodes using the <em>Upper Confidence Bound</em> (UCB) rule:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-288-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>a</mi></munder><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>c</mi><msqrt><mfrac><mrow><mi>ln</mi><mo>&amp;#x2061;</mo><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mn>1</mn><mo>+</mo><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></msqrt><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4636\" style=\"width: 20.419em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.982em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1016.77em, 4.326em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4637\"><span class=\"msubsup\" id=\"MathJax-Span-4638\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4639\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4640\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4641\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4642\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-4643\"></span><span class=\"munderover\" id=\"MathJax-Span-4644\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4645\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.273em, -999.997em); top: -3.331em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-4646\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4647\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4648\"><span class=\"mo\" id=\"MathJax-Span-4649\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-4650\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-4651\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4652\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4653\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4654\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4655\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4656\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4657\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4658\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-4659\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">c</span><span class=\"msqrt\" id=\"MathJax-Span-4660\"><span style=\"display: inline-block; position: relative; width: 6.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.503em, 1005.11em, 5.055em, -999.997em); top: -4.008em; left: 1.148em;\"><span class=\"mrow\" id=\"MathJax-Span-4661\"><span class=\"mfrac\" id=\"MathJax-Span-4662\"><span style=\"display: inline-block; position: relative; width: 4.846em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.02em, 4.326em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.508em;\"><span class=\"mrow\" id=\"MathJax-Span-4663\"><span class=\"mi\" id=\"MathJax-Span-4664\" style=\"font-family: STIXGeneral-Regular;\">ln</span><span class=\"mo\" id=\"MathJax-Span-4665\"></span><span class=\"mi\" id=\"MathJax-Span-4666\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4667\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4668\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4669\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4670\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4671\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1004.69em, 4.326em, -999.997em); top: -3.331em; left: 50%; margin-left: -2.341em;\"><span class=\"mrow\" id=\"MathJax-Span-4672\"><span class=\"mn\" id=\"MathJax-Span-4673\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-4674\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-4675\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4676\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4677\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4678\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4679\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4680\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4681\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4682\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.85em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.846em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.023em, 1005.11em, 3.388em, -999.997em); top: -4.633em; left: 1.148em;\"><span style=\"display: inline-block; position: relative; width: 5.107em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 0em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 4.638em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.419em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.836em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.253em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.669em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.086em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.503em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.919em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.336em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.805em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 4.221em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(1.826em, 1001.15em, 4.586em, -999.997em); top: -3.383em; left: 0em;\"><span style=\"font-family: STIXSizeTwoSym;\">√</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4683\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-4684\"><span class=\"mo\" id=\"MathJax-Span-4685\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>a</mi></munder><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>c</mi><msqrt><mfrac><mrow><mi>ln</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mn>1</mn><mo>+</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></msqrt><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-288\">a_t = \\arg\\max_a \\big[ Q(s_t,a) + c \\sqrt{\\frac{\\ln N(s_t)}{1 + N(s_t,a)}} \\big]</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-289-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4686\" style=\"width: 3.596em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.92em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4687\"><span class=\"mi\" id=\"MathJax-Span-4688\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-4689\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4690\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4691\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4692\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4693\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4694\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4695\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-289\">Q(s_t,a)</script> is the estimated action value, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-290-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4696\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4697\"><span class=\"mi\" id=\"MathJax-Span-4698\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4699\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4700\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4701\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4702\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4703\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4704\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4705\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>N</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-290\">N(s_t,a)</script> the visit count, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-291-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4706\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4707\"><span class=\"mi\" id=\"MathJax-Span-4708\" style=\"font-family: STIXGeneral-Italic;\">c</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>c</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-291\">c</script> a confidence constant.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Expansion:</strong> Add one or more new child nodes to the tree.</p>\n      </li>\n      <li>\n        <p><strong>Simulation:</strong> Run a rollout (either with a learned policy or random actions) to estimate the outcome.</p>\n      </li>\n      <li>\n        <p><strong>Backpropagation:</strong> Update <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-292-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4709\" style=\"width: 3.596em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.92em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4710\"><span class=\"mi\" id=\"MathJax-Span-4711\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-4712\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4713\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4714\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4715\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4716\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4717\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4718\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-292\">Q(s_t,a)</script> values along the traversed path with the observed return.</p>\n      </li>\n    </ol>\n<p><strong>Selection:</strong> Traverse the current tree from the root to a leaf, selecting child nodes using the <em>Upper Confidence Bound</em> (UCB) rule:</p>\n<ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-289-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4686\" style=\"width: 3.596em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.92em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4687\"><span class=\"mi\" id=\"MathJax-Span-4688\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-4689\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4690\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4691\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4692\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4693\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4694\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4695\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-289\">Q(s_t,a)</script> is the estimated action value, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-290-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4696\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4697\"><span class=\"mi\" id=\"MathJax-Span-4698\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4699\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4700\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4701\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4702\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4703\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4704\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4705\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>N</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-290\">N(s_t,a)</script> the visit count, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-291-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4706\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4707\"><span class=\"mi\" id=\"MathJax-Span-4708\" style=\"font-family: STIXGeneral-Italic;\">c</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>c</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-291\">c</script> a confidence constant.</li>\n        </ul>\n<p><strong>Expansion:</strong> Add one or more new child nodes to the tree.</p>\n<p><strong>Simulation:</strong> Run a rollout (either with a learned policy or random actions) to estimate the outcome.</p>\n<p><strong>Backpropagation:</strong> Update <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-292-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4709\" style=\"width: 3.596em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.92em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4710\"><span class=\"mi\" id=\"MathJax-Span-4711\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-4712\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4713\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4714\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4715\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4716\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4717\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4718\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-292\">Q(s_t,a)</script> values along the traversed path with the observed return.</p>\n<p>This method balances exploration and exploitation dynamically—favoring actions with high potential but uncertain estimates.</p>\n<p>In the context of LLM-based web agents, MCTS is adapted to explore <em>semantic</em> and <em>structural</em> decision spaces rather than numeric ones. Each node can represent:</p>\n<ul>\n      <li>A browser state (DOM snapshot, active page).</li>\n      <li>A reasoning context (prompt, plan, partial output).</li>\n      <li>A tool invocation (function call, API parameterization).</li>\n    </ul>\n<p>MCTS then simulates different reasoning or action trajectories, evaluates their predicted rewards (using a reward model or preference score), and backpropagates this information to refine the policy.</p>\n<p>Recent approaches such as <a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025) extend this principle by introducing a <strong>reasoning-based experience model</strong> that performs analogous “tree search” operations within a learned world model—sampling synthetic trajectories that approximate MCTS rollouts without direct environment interaction, thereby dramatically improving sample efficiency.</p>",
    "contentMarkdown": "*   **Monte Carlo Tree Search (MCTS)** is a planning algorithm that estimates the value of actions through simulation. Each node in the search tree represents a state, and edges represent actions. During training, the agent builds a partial search tree by simulating action sequences, updating node values using empirical rollouts.\n    \n*   At each decision step, MCTS performs four core operations:\n    \n    1.  **Selection:** Traverse the current tree from the root to a leaf, selecting child nodes using the _Upper Confidence Bound_ (UCB) rule:\n        \n        at\\=argmaxa\\[Q(st,a)+clnN(st)1+N(st,a)‾‾‾‾‾‾‾‾‾‾‾‾√\\]at\\=arg⁡maxa\\[Q(st,a)+cln⁡N(st)1+N(st,a)\\]\n        \n        a\\_t = \\\\arg\\\\max\\_a \\\\big\\[ Q(s\\_t,a) + c \\\\sqrt{\\\\frac{\\\\ln N(s\\_t)}{1 + N(s\\_t,a)}} \\\\big\\]\n        *   where Q(st,a)Q(st,a)Q(s\\_t,a) is the estimated action value, N(st,a)N(st,a)N(s\\_t,a) the visit count, and ccc a confidence constant.\n    2.  **Expansion:** Add one or more new child nodes to the tree.\n        \n    3.  **Simulation:** Run a rollout (either with a learned policy or random actions) to estimate the outcome.\n        \n    4.  **Backpropagation:** Update Q(st,a)Q(st,a)Q(s\\_t,a) values along the traversed path with the observed return.\n        \n*   This method balances exploration and exploitation dynamically—favoring actions with high potential but uncertain estimates.\n    \n*   In the context of LLM-based web agents, MCTS is adapted to explore _semantic_ and _structural_ decision spaces rather than numeric ones. Each node can represent:\n    \n    *   A browser state (DOM snapshot, active page).\n    *   A reasoning context (prompt, plan, partial output).\n    *   A tool invocation (function call, API parameterization).\n*   MCTS then simulates different reasoning or action trajectories, evaluates their predicted rewards (using a reward model or preference score), and backpropagates this information to refine the policy.\n    \n*   Recent approaches such as [Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025) extend this principle by introducing a **reasoning-based experience model** that performs analogous “tree search” operations within a learned world model—sampling synthetic trajectories that approximate MCTS rollouts without direct environment interaction, thereby dramatically improving sample efficiency.\n    \n\n**Monte Carlo Tree Search (MCTS)** is a planning algorithm that estimates the value of actions through simulation. Each node in the search tree represents a state, and edges represent actions. During training, the agent builds a partial search tree by simulating action sequences, updating node values using empirical rollouts.\n\nAt each decision step, MCTS performs four core operations:\n\n1.  **Selection:** Traverse the current tree from the root to a leaf, selecting child nodes using the _Upper Confidence Bound_ (UCB) rule:\n    \n    at\\=argmaxa\\[Q(st,a)+clnN(st)1+N(st,a)‾‾‾‾‾‾‾‾‾‾‾‾√\\]at\\=arg⁡maxa\\[Q(st,a)+cln⁡N(st)1+N(st,a)\\]\n    \n    a\\_t = \\\\arg\\\\max\\_a \\\\big\\[ Q(s\\_t,a) + c \\\\sqrt{\\\\frac{\\\\ln N(s\\_t)}{1 + N(s\\_t,a)}} \\\\big\\]\n    *   where Q(st,a)Q(st,a)Q(s\\_t,a) is the estimated action value, N(st,a)N(st,a)N(s\\_t,a) the visit count, and ccc a confidence constant.\n2.  **Expansion:** Add one or more new child nodes to the tree.\n    \n3.  **Simulation:** Run a rollout (either with a learned policy or random actions) to estimate the outcome.\n    \n4.  **Backpropagation:** Update Q(st,a)Q(st,a)Q(s\\_t,a) values along the traversed path with the observed return.\n    \n\n**Selection:** Traverse the current tree from the root to a leaf, selecting child nodes using the _Upper Confidence Bound_ (UCB) rule:\n\n*   where Q(st,a)Q(st,a)Q(s\\_t,a) is the estimated action value, N(st,a)N(st,a)N(s\\_t,a) the visit count, and ccc a confidence constant.\n\n**Expansion:** Add one or more new child nodes to the tree.\n\n**Simulation:** Run a rollout (either with a learned policy or random actions) to estimate the outcome.\n\n**Backpropagation:** Update Q(st,a)Q(st,a)Q(s\\_t,a) values along the traversed path with the observed return.\n\nThis method balances exploration and exploitation dynamically—favoring actions with high potential but uncertain estimates.\n\nIn the context of LLM-based web agents, MCTS is adapted to explore _semantic_ and _structural_ decision spaces rather than numeric ones. Each node can represent:\n\n*   A browser state (DOM snapshot, active page).\n*   A reasoning context (prompt, plan, partial output).\n*   A tool invocation (function call, API parameterization).\n\nMCTS then simulates different reasoning or action trajectories, evaluates their predicted rewards (using a reward model or preference score), and backpropagates this information to refine the policy.\n\nRecent approaches such as [Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025) extend this principle by introducing a **reasoning-based experience model** that performs analogous “tree search” operations within a learned world model—sampling synthetic trajectories that approximate MCTS rollouts without direct environment interaction, thereby dramatically improving sample efficiency.",
    "order": 37,
    "orderInChapter": 2,
    "difficulty": 5,
    "estimatedMinutes": 4,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "backpropagation"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 667,
      "contentLength": 59986
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#monte-carlo-tree-search-(mcts)-in-rl-based-agents",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-neural-guided-search-policy-priors-and-value-model-38",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "title": "Neural-Guided Search: Policy Priors and Value Models",
    "subtitle": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "contentHtml": "<ul>\n  <li>\n    <p>In environments too large for exhaustive search, modern agents employ <strong>neural-guided search</strong>—a synergy between <em>planning algorithms</em> and <em>deep models</em>. Here, the policy model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-293-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4719\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4720\"><span class=\"msubsup\" id=\"MathJax-Span-4721\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4722\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4723\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4724\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4725\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-4726\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-4727\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-4728\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-293\">\\pi_\\theta(a \\mid s)</script> provides prior probabilities for which actions to explore first, and the value model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-294-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4729\" style=\"width: 2.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.03em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4730\"><span class=\"msubsup\" id=\"MathJax-Span-4731\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4732\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-4733\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4734\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4735\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-4736\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-294\">V_\\theta(s)</script> predicts the expected return from each state. These models drastically reduce the branching factor and enable more efficient exploration.</p>\n  </li>\n  <li>\n    <p>This framework mirrors the principles that powered <strong>AlphaGo</strong> (<a href=\"https://www.nature.com/articles/nature16961\">Mastering the game of Go with deep neural networks and tree search</a> by Silver et al., 2016), but applied to <em>symbolic and text-based tasks</em> instead of games.</p>\n  </li>\n  <li>\n    <p>Formally, the modified UCB rule becomes:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-295-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>U</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>puct</mtext></mrow></msub><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mfrac><msqrt><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></msqrt><mrow><mn>1</mn><mo>+</mo><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4737\" style=\"width: 19.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.628em, 1016.62em, 3.544em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4738\"><span class=\"mi\" id=\"MathJax-Span-4739\" style=\"font-family: STIXGeneral-Italic;\">U<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4740\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4741\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-4742\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4743\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4744\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4745\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4746\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-4747\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4748\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-4749\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4750\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4751\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4752\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-4753\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4754\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4755\"><span class=\"mrow\" id=\"MathJax-Span-4756\"><span class=\"mtext\" id=\"MathJax-Span-4757\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">puct</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-4758\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-4759\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4760\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"texatom\" id=\"MathJax-Span-4761\"><span class=\"mrow\" id=\"MathJax-Span-4762\"><span class=\"mo\" id=\"MathJax-Span-4763\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-4764\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-4765\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mfrac\" id=\"MathJax-Span-4766\"><span style=\"display: inline-block; position: relative; width: 4.586em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(2.971em, 1002.76em, 4.534em, -999.997em); top: -4.841em; left: 50%; margin-left: -1.352em;\"><span class=\"msqrt\" id=\"MathJax-Span-4767\"><span style=\"display: inline-block; position: relative; width: 2.763em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1001.72em, 4.326em, -999.997em); top: -4.008em; left: 0.94em;\"><span class=\"mrow\" id=\"MathJax-Span-4768\"><span class=\"mi\" id=\"MathJax-Span-4769\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4770\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4771\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-4772\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.023em, 1001.83em, 3.388em, -999.997em); top: -4.06em; left: 0.94em;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 0em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 1.305em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.419em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.888em;\">‾<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(2.867em, 1000.94em, 4.43em, -999.997em); top: -3.904em; left: 0em;\"><span style=\"font-family: STIXGeneral-Regular;\">√</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1004.43em, 4.326em, -999.997em); top: -3.331em; left: 50%; margin-left: -2.237em;\"><span class=\"mrow\" id=\"MathJax-Span-4773\"><span class=\"mn\" id=\"MathJax-Span-4774\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-4775\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-4776\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4777\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4778\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-4779\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4780\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4781\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.59em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.586em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 3.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>U</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>+</mo><msub><mi>c</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>puct</mtext></mrow></msub><mi>P</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>s</mi><mo stretchy=\"false\">)</mo><mfrac><msqrt><mi>N</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></msqrt><mrow><mn>1</mn><mo>+</mo><mi>N</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-295\">U(s,a) = Q(s,a) + c_{\\text{puct}} P(a|s) \\frac{\\sqrt{N(s)}}{1 + N(s,a)}</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-296-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4782\" style=\"width: 3.544em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.919em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1002.87em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4783\"><span class=\"mi\" id=\"MathJax-Span-4784\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-4785\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4786\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-4787\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-4788\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-4789\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-296\">P(a \\mid s)</script> is the prior probability from the policy model. This ensures that exploration is guided by learned likelihoods, not uniform randomness.</li>\n    </ul>\n  </li>\n  <li>\n    <p>In <a href=\"https://arxiv.org/abs/2408.07199\">Agent Q</a> by Putta et al. (2024), this concept is applied to <strong>online adaptation</strong>: the agent uses MCTS for planning while simultaneously updating its local policy parameters via gradient descent, achieving a form of continual self-improvement.</p>\n  </li>\n  <li>\n    <p>Early Experience pretraining complements neural-guided search by shaping the priors <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-297-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4790\" style=\"width: 3.544em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.919em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1002.87em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4791\"><span class=\"mi\" id=\"MathJax-Span-4792\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-4793\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4794\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-4795\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-4796\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-4797\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-297\">P(a \\mid s)</script> and values <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-298-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4798\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4799\"><span class=\"mi\" id=\"MathJax-Span-4800\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4801\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4802\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-4803\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-298\">V(s)</script> before any explicit MCTS integration. By learning predictive transitions and reflective rationales (<a href=\"https://arxiv.org/abs/2510.08558\">Agent Learning via Early Experience</a> by Zhang et al., 2025), the agent begins search from a semantically meaningful latent space rather than random initialization—reducing both exploration cost and tree-depth requirements.</p>\n  </li>\n</ul>\n<p>In environments too large for exhaustive search, modern agents employ <strong>neural-guided search</strong>—a synergy between <em>planning algorithms</em> and <em>deep models</em>. Here, the policy model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-293-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4719\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4720\"><span class=\"msubsup\" id=\"MathJax-Span-4721\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4722\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4723\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4724\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4725\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-4726\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-4727\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-4728\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-293\">\\pi_\\theta(a \\mid s)</script> provides prior probabilities for which actions to explore first, and the value model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-294-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4729\" style=\"width: 2.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.03em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4730\"><span class=\"msubsup\" id=\"MathJax-Span-4731\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4732\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-4733\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4734\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4735\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-4736\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-294\">V_\\theta(s)</script> predicts the expected return from each state. These models drastically reduce the branching factor and enable more efficient exploration.</p>\n<p>This framework mirrors the principles that powered <strong>AlphaGo</strong> (<a href=\"https://www.nature.com/articles/nature16961\">Mastering the game of Go with deep neural networks and tree search</a> by Silver et al., 2016), but applied to <em>symbolic and text-based tasks</em> instead of games.</p>\n<p>Formally, the modified UCB rule becomes:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-296-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4782\" style=\"width: 3.544em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.919em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1002.87em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4783\"><span class=\"mi\" id=\"MathJax-Span-4784\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-4785\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4786\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-4787\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-4788\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-4789\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-296\">P(a \\mid s)</script> is the prior probability from the policy model. This ensures that exploration is guided by learned likelihoods, not uniform randomness.</li>\n    </ul>\n<p>In <a href=\"https://arxiv.org/abs/2408.07199\">Agent Q</a> by Putta et al. (2024), this concept is applied to <strong>online adaptation</strong>: the agent uses MCTS for planning while simultaneously updating its local policy parameters via gradient descent, achieving a form of continual self-improvement.</p>\n<p>Early Experience pretraining complements neural-guided search by shaping the priors <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-297-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4790\" style=\"width: 3.544em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.919em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1002.87em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4791\"><span class=\"mi\" id=\"MathJax-Span-4792\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-4793\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4794\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-4795\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-4796\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-4797\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-297\">P(a \\mid s)</script> and values <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-298-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4798\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4799\"><span class=\"mi\" id=\"MathJax-Span-4800\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4801\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4802\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-4803\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-298\">V(s)</script> before any explicit MCTS integration. By learning predictive transitions and reflective rationales (<a href=\"https://arxiv.org/abs/2510.08558\">Agent Learning via Early Experience</a> by Zhang et al., 2025), the agent begins search from a semantically meaningful latent space rather than random initialization—reducing both exploration cost and tree-depth requirements.</p>",
    "contentMarkdown": "*   In environments too large for exhaustive search, modern agents employ **neural-guided search**—a synergy between _planning algorithms_ and _deep models_. Here, the policy model πθ(a∣s)πθ(a∣s)\\\\pi\\_\\\\theta(a \\\\mid s) provides prior probabilities for which actions to explore first, and the value model Vθ(s)Vθ(s)V\\_\\\\theta(s) predicts the expected return from each state. These models drastically reduce the branching factor and enable more efficient exploration.\n    \n*   This framework mirrors the principles that powered **AlphaGo** ([Mastering the game of Go with deep neural networks and tree search](https://www.nature.com/articles/nature16961) by Silver et al., 2016), but applied to _symbolic and text-based tasks_ instead of games.\n    \n*   Formally, the modified UCB rule becomes:\n    \n    U(s,a)\\=Q(s,a)+cpuctP(a|s)N(s)‾‾‾‾√1+N(s,a)U(s,a)\\=Q(s,a)+cpuctP(a|s)N(s)1+N(s,a)\n    \n    U(s,a) = Q(s,a) + c\\_{\\\\text{puct}} P(a|s) \\\\frac{\\\\sqrt{N(s)}}{1 + N(s,a)}\n    *   where P(a∣s)P(a∣s)P(a \\\\mid s) is the prior probability from the policy model. This ensures that exploration is guided by learned likelihoods, not uniform randomness.\n*   In [Agent Q](https://arxiv.org/abs/2408.07199) by Putta et al. (2024), this concept is applied to **online adaptation**: the agent uses MCTS for planning while simultaneously updating its local policy parameters via gradient descent, achieving a form of continual self-improvement.\n    \n*   Early Experience pretraining complements neural-guided search by shaping the priors P(a∣s)P(a∣s)P(a \\\\mid s) and values V(s)V(s)V(s) before any explicit MCTS integration. By learning predictive transitions and reflective rationales ([Agent Learning via Early Experience](https://arxiv.org/abs/2510.08558) by Zhang et al., 2025), the agent begins search from a semantically meaningful latent space rather than random initialization—reducing both exploration cost and tree-depth requirements.\n    \n\nIn environments too large for exhaustive search, modern agents employ **neural-guided search**—a synergy between _planning algorithms_ and _deep models_. Here, the policy model πθ(a∣s)πθ(a∣s)\\\\pi\\_\\\\theta(a \\\\mid s) provides prior probabilities for which actions to explore first, and the value model Vθ(s)Vθ(s)V\\_\\\\theta(s) predicts the expected return from each state. These models drastically reduce the branching factor and enable more efficient exploration.\n\nThis framework mirrors the principles that powered **AlphaGo** ([Mastering the game of Go with deep neural networks and tree search](https://www.nature.com/articles/nature16961) by Silver et al., 2016), but applied to _symbolic and text-based tasks_ instead of games.\n\nFormally, the modified UCB rule becomes:\n\n*   where P(a∣s)P(a∣s)P(a \\\\mid s) is the prior probability from the policy model. This ensures that exploration is guided by learned likelihoods, not uniform randomness.\n\nIn [Agent Q](https://arxiv.org/abs/2408.07199) by Putta et al. (2024), this concept is applied to **online adaptation**: the agent uses MCTS for planning while simultaneously updating its local policy parameters via gradient descent, achieving a form of continual self-improvement.\n\nEarly Experience pretraining complements neural-guided search by shaping the priors P(a∣s)P(a∣s)P(a \\\\mid s) and values V(s)V(s)V(s) before any explicit MCTS integration. By learning predictive transitions and reflective rationales ([Agent Learning via Early Experience](https://arxiv.org/abs/2510.08558) by Zhang et al., 2025), the agent begins search from a semantically meaningful latent space rather than random initialization—reducing both exploration cost and tree-depth requirements.",
    "order": 38,
    "orderInChapter": 3,
    "difficulty": 5,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture",
      "neural network",
      "gradient descent"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 455,
      "contentLength": 34536
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#neural-guided-search:-policy-priors-and-value-models",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-integration-of-search-with-reinforcement-learning--39",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "title": "Integration of Search with Reinforcement Learning and Fine-Tuning",
    "subtitle": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "contentHtml": "<ul>\n  <li>\n    <p>Search algorithms such as MCTS can be integrated with RL training in three primary ways:</p>\n\n    <ol>\n      <li>\n        <p><strong>Search as Pretraining:</strong> Generate high-quality trajectories via MCTS and use them for supervised fine-tuning (similar to imitation learning).</p>\n      </li>\n      <li>\n        <p><strong>Search as Online Exploration:</strong> Use MCTS during training to propose promising action sequences; the policy learns to imitate successful trajectories while exploring uncertain branches.</p>\n      </li>\n      <li>\n        <p><strong>Search as Evaluation:</strong> Use MCTS only at inference to refine action selection, keeping policy updates purely gradient-based.</p>\n      </li>\n    </ol>\n  </li>\n  <li>\n    <p>In <a href=\"https://arxiv.org/abs/2408.07199\">Agent Q</a>, this second mode—<em>online search and adaptation</em>—proved especially effective, enabling agents to generalize across unseen tasks without explicit retraining.</p>\n  </li>\n  <li>\n    <p>DreamGym’s synthetic environment model provides a complementary fourth paradigm: <strong>Search via Experience Synthesis.</strong> Here, simulated rollouts within a learned reasoning environment substitute for explicit tree expansion, allowing policies to update from a massive, low-cost replay buffer of synthetic “search traces.” This merges the sample efficiency of model-based RL with the decision quality of tree search (<a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al., 2025).</p>\n  </li>\n</ul>\n<p>Search algorithms such as MCTS can be integrated with RL training in three primary ways:</p>\n<ol>\n      <li>\n        <p><strong>Search as Pretraining:</strong> Generate high-quality trajectories via MCTS and use them for supervised fine-tuning (similar to imitation learning).</p>\n      </li>\n      <li>\n        <p><strong>Search as Online Exploration:</strong> Use MCTS during training to propose promising action sequences; the policy learns to imitate successful trajectories while exploring uncertain branches.</p>\n      </li>\n      <li>\n        <p><strong>Search as Evaluation:</strong> Use MCTS only at inference to refine action selection, keeping policy updates purely gradient-based.</p>\n      </li>\n    </ol>\n<p><strong>Search as Pretraining:</strong> Generate high-quality trajectories via MCTS and use them for supervised fine-tuning (similar to imitation learning).</p>\n<p><strong>Search as Online Exploration:</strong> Use MCTS during training to propose promising action sequences; the policy learns to imitate successful trajectories while exploring uncertain branches.</p>\n<p><strong>Search as Evaluation:</strong> Use MCTS only at inference to refine action selection, keeping policy updates purely gradient-based.</p>\n<p>In <a href=\"https://arxiv.org/abs/2408.07199\">Agent Q</a>, this second mode—<em>online search and adaptation</em>—proved especially effective, enabling agents to generalize across unseen tasks without explicit retraining.</p>\n<p>DreamGym’s synthetic environment model provides a complementary fourth paradigm: <strong>Search via Experience Synthesis.</strong> Here, simulated rollouts within a learned reasoning environment substitute for explicit tree expansion, allowing policies to update from a massive, low-cost replay buffer of synthetic “search traces.” This merges the sample efficiency of model-based RL with the decision quality of tree search (<a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al., 2025).</p>",
    "contentMarkdown": "*   Search algorithms such as MCTS can be integrated with RL training in three primary ways:\n    \n    1.  **Search as Pretraining:** Generate high-quality trajectories via MCTS and use them for supervised fine-tuning (similar to imitation learning).\n        \n    2.  **Search as Online Exploration:** Use MCTS during training to propose promising action sequences; the policy learns to imitate successful trajectories while exploring uncertain branches.\n        \n    3.  **Search as Evaluation:** Use MCTS only at inference to refine action selection, keeping policy updates purely gradient-based.\n        \n*   In [Agent Q](https://arxiv.org/abs/2408.07199), this second mode—_online search and adaptation_—proved especially effective, enabling agents to generalize across unseen tasks without explicit retraining.\n    \n*   DreamGym’s synthetic environment model provides a complementary fourth paradigm: **Search via Experience Synthesis.** Here, simulated rollouts within a learned reasoning environment substitute for explicit tree expansion, allowing policies to update from a massive, low-cost replay buffer of synthetic “search traces.” This merges the sample efficiency of model-based RL with the decision quality of tree search ([Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al., 2025).\n    \n\nSearch algorithms such as MCTS can be integrated with RL training in three primary ways:\n\n1.  **Search as Pretraining:** Generate high-quality trajectories via MCTS and use them for supervised fine-tuning (similar to imitation learning).\n    \n2.  **Search as Online Exploration:** Use MCTS during training to propose promising action sequences; the policy learns to imitate successful trajectories while exploring uncertain branches.\n    \n3.  **Search as Evaluation:** Use MCTS only at inference to refine action selection, keeping policy updates purely gradient-based.\n    \n\n**Search as Pretraining:** Generate high-quality trajectories via MCTS and use them for supervised fine-tuning (similar to imitation learning).\n\n**Search as Online Exploration:** Use MCTS during training to propose promising action sequences; the policy learns to imitate successful trajectories while exploring uncertain branches.\n\n**Search as Evaluation:** Use MCTS only at inference to refine action selection, keeping policy updates purely gradient-based.\n\nIn [Agent Q](https://arxiv.org/abs/2408.07199), this second mode—_online search and adaptation_—proved especially effective, enabling agents to generalize across unseen tasks without explicit retraining.\n\nDreamGym’s synthetic environment model provides a complementary fourth paradigm: **Search via Experience Synthesis.** Here, simulated rollouts within a learned reasoning environment substitute for explicit tree expansion, allowing policies to update from a massive, low-cost replay buffer of synthetic “search traces.” This merges the sample efficiency of model-based RL with the decision quality of tree search ([Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al., 2025).",
    "order": 39,
    "orderInChapter": 4,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 390,
      "contentLength": 3594
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#integration-of-search-with-reinforcement-learning-and-fine-tuning",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-process-wise-reward-shaping-in-search-based-rl-40",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "title": "Process-Wise Reward Shaping in Search-Based RL",
    "subtitle": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "contentHtml": "<ul>\n  <li>\n    <p>A key enhancement in modern search-based RL pipelines is the introduction of <strong>process-wise reward shaping</strong> to complement sparse terminal rewards. In multi-turn or tool-using agents, MCTS nodes can be augmented with intermediate reward estimates derived from:</p>\n\n    <ul>\n      <li>Successful API or function calls,</li>\n      <li>Reduced error rates or failed action counts,</li>\n      <li>Improved subgoal completion,</li>\n      <li>Positive sentiment or human approval scores.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This transforms the reward signal from a binary success/failure into a smooth landscape that supports <em>credit assignment</em> across deep search trees.</p>\n  </li>\n  <li>\n    <p>The adjusted value propagation for a trajectory of length <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-299-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4804\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4805\"><span class=\"mi\" id=\"MathJax-Span-4806\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>T</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-299\">T</script> becomes:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-300-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03B7;</mi><mo stretchy=&quot;false&quot;>)</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B7;</mi><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msup><mi>&amp;#x03B3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mi>t</mi></mrow></msup><msubsup><mi>r</mi><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>process</mtext></mrow></msubsup></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4807\" style=\"width: 22.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 18.701em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.263em, 1018.7em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4808\"><span class=\"mi\" id=\"MathJax-Span-4809\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-4810\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4811\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4812\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4813\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4814\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4815\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4816\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4817\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4818\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4819\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">←</span><span class=\"mo\" id=\"MathJax-Span-4820\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"mn\" id=\"MathJax-Span-4821\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-4822\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-4823\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">η</span><span class=\"mo\" id=\"MathJax-Span-4824\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mi\" id=\"MathJax-Span-4825\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-4826\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4827\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4828\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4829\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4830\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4831\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4832\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4833\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4834\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4835\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-4836\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">η</span><span class=\"munderover\" id=\"MathJax-Span-4837\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4838\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.159em;\"><span class=\"texatom\" id=\"MathJax-Span-4839\"><span class=\"mrow\" id=\"MathJax-Span-4840\"><span class=\"mi\" id=\"MathJax-Span-4841\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4842\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mi\" id=\"MathJax-Span-4843\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-4844\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4845\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4846\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4847\"><span class=\"mrow\" id=\"MathJax-Span-4848\"><span class=\"mi\" id=\"MathJax-Span-4849\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4850\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mi\" id=\"MathJax-Span-4851\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4852\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4853\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1002.19em, 4.326em, -999.997em); top: -4.529em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4854\"><span class=\"mrow\" id=\"MathJax-Span-4855\"><span class=\"mtext\" id=\"MathJax-Span-4856\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">process</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.42em, 4.169em, -999.997em); top: -3.695em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4857\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">←</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>η</mi><mo stretchy=\"false\">)</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mi>η</mi><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msup><mi>γ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>−</mo><mi>t</mi></mrow></msup><msubsup><mi>r</mi><mi>k</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>process</mtext></mrow></msubsup></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-300\">Q(s_t, a_t) \\leftarrow (1 - \\eta) Q(s_t, a_t) + \\eta \\sum_{k=t}^T \\gamma^{k-t} r_k^{\\text{process}}</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-301-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>process</mtext></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4858\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1002.66em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4859\"><span class=\"msubsup\" id=\"MathJax-Span-4860\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4861\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1002.19em, 4.326em, -999.997em); top: -4.529em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4862\"><span class=\"mrow\" id=\"MathJax-Span-4863\"><span class=\"mtext\" id=\"MathJax-Span-4864\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">process</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.42em, 4.169em, -999.997em); top: -3.695em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4865\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>k</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>process</mtext></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-301\">r_k^{\\text{process}}</script> captures per-step quality signals. This formulation allows the agent to refine sub-policies even when full-task success has not yet been achieved—vital for real-world agents that must learn under incomplete supervision.</li>\n    </ul>\n  </li>\n</ul>\n<p>A key enhancement in modern search-based RL pipelines is the introduction of <strong>process-wise reward shaping</strong> to complement sparse terminal rewards. In multi-turn or tool-using agents, MCTS nodes can be augmented with intermediate reward estimates derived from:</p>\n<ul>\n      <li>Successful API or function calls,</li>\n      <li>Reduced error rates or failed action counts,</li>\n      <li>Improved subgoal completion,</li>\n      <li>Positive sentiment or human approval scores.</li>\n    </ul>\n<p>This transforms the reward signal from a binary success/failure into a smooth landscape that supports <em>credit assignment</em> across deep search trees.</p>\n<p>The adjusted value propagation for a trajectory of length <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-299-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4804\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4805\"><span class=\"mi\" id=\"MathJax-Span-4806\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>T</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-299\">T</script> becomes:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-301-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>process</mtext></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4858\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1002.66em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4859\"><span class=\"msubsup\" id=\"MathJax-Span-4860\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4861\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1002.19em, 4.326em, -999.997em); top: -4.529em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4862\"><span class=\"mrow\" id=\"MathJax-Span-4863\"><span class=\"mtext\" id=\"MathJax-Span-4864\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">process</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.42em, 4.169em, -999.997em); top: -3.695em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4865\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>k</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>process</mtext></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-301\">r_k^{\\text{process}}</script> captures per-step quality signals. This formulation allows the agent to refine sub-policies even when full-task success has not yet been achieved—vital for real-world agents that must learn under incomplete supervision.</li>\n    </ul>",
    "contentMarkdown": "*   A key enhancement in modern search-based RL pipelines is the introduction of **process-wise reward shaping** to complement sparse terminal rewards. In multi-turn or tool-using agents, MCTS nodes can be augmented with intermediate reward estimates derived from:\n    \n    *   Successful API or function calls,\n    *   Reduced error rates or failed action counts,\n    *   Improved subgoal completion,\n    *   Positive sentiment or human approval scores.\n*   This transforms the reward signal from a binary success/failure into a smooth landscape that supports _credit assignment_ across deep search trees.\n    \n*   The adjusted value propagation for a trajectory of length TTT becomes:\n    \n    Q(st,at)←(1−η)Q(st,at)+η∑k\\=tTγk−trprocesskQ(st,at)←(1−η)Q(st,at)+η∑k\\=tTγk−trkprocess\n    \n    Q(s\\_t, a\\_t) \\\\leftarrow (1 - \\\\eta) Q(s\\_t, a\\_t) + \\\\eta \\\\sum\\_{k=t}^T \\\\gamma^{k-t} r\\_k^{\\\\text{process}}\n    *   where rprocesskrkprocessr\\_k^{\\\\text{process}} captures per-step quality signals. This formulation allows the agent to refine sub-policies even when full-task success has not yet been achieved—vital for real-world agents that must learn under incomplete supervision.\n\nA key enhancement in modern search-based RL pipelines is the introduction of **process-wise reward shaping** to complement sparse terminal rewards. In multi-turn or tool-using agents, MCTS nodes can be augmented with intermediate reward estimates derived from:\n\n*   Successful API or function calls,\n*   Reduced error rates or failed action counts,\n*   Improved subgoal completion,\n*   Positive sentiment or human approval scores.\n\nThis transforms the reward signal from a binary success/failure into a smooth landscape that supports _credit assignment_ across deep search trees.\n\nThe adjusted value propagation for a trajectory of length TTT becomes:\n\n*   where rprocesskrkprocessr\\_k^{\\\\text{process}} captures per-step quality signals. This formulation allows the agent to refine sub-policies even when full-task success has not yet been achieved—vital for real-world agents that must learn under incomplete supervision.",
    "order": 40,
    "orderInChapter": 5,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 269,
      "contentLength": 21837
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#process-wise-reward-shaping-in-search-based-rl",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-integration-of-search-with-reinforcement-learning--41",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "title": "Integration of Search with Reinforcement Learning and Fine-Tuning",
    "subtitle": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "contentHtml": "<ul>\n  <li>\n    <p>Search algorithms such as MCTS can be integrated with RL training in three primary ways:</p>\n\n    <ol>\n      <li>\n        <p><strong>Search as Pretraining:</strong> Generate high-quality trajectories via MCTS and use them for supervised fine-tuning (similar to imitation learning).</p>\n      </li>\n      <li>\n        <p><strong>Search as Online Exploration:</strong> Use MCTS during training to propose promising action sequences; the policy learns to imitate successful trajectories while exploring uncertain branches.</p>\n      </li>\n      <li>\n        <p><strong>Search as Evaluation:</strong> Use MCTS only at inference to refine action selection, keeping policy updates purely gradient-based.</p>\n      </li>\n    </ol>\n  </li>\n  <li>\n    <p>In <a href=\"https://arxiv.org/abs/2408.07199\">Agent Q</a>, this second mode—<em>online search and adaptation</em>—proved especially effective, enabling agents to generalize across unseen tasks without explicit retraining.</p>\n  </li>\n</ul>\n<p>Search algorithms such as MCTS can be integrated with RL training in three primary ways:</p>\n<ol>\n      <li>\n        <p><strong>Search as Pretraining:</strong> Generate high-quality trajectories via MCTS and use them for supervised fine-tuning (similar to imitation learning).</p>\n      </li>\n      <li>\n        <p><strong>Search as Online Exploration:</strong> Use MCTS during training to propose promising action sequences; the policy learns to imitate successful trajectories while exploring uncertain branches.</p>\n      </li>\n      <li>\n        <p><strong>Search as Evaluation:</strong> Use MCTS only at inference to refine action selection, keeping policy updates purely gradient-based.</p>\n      </li>\n    </ol>\n<p><strong>Search as Pretraining:</strong> Generate high-quality trajectories via MCTS and use them for supervised fine-tuning (similar to imitation learning).</p>\n<p><strong>Search as Online Exploration:</strong> Use MCTS during training to propose promising action sequences; the policy learns to imitate successful trajectories while exploring uncertain branches.</p>\n<p><strong>Search as Evaluation:</strong> Use MCTS only at inference to refine action selection, keeping policy updates purely gradient-based.</p>\n<p>In <a href=\"https://arxiv.org/abs/2408.07199\">Agent Q</a>, this second mode—<em>online search and adaptation</em>—proved especially effective, enabling agents to generalize across unseen tasks without explicit retraining.</p>",
    "contentMarkdown": "*   Search algorithms such as MCTS can be integrated with RL training in three primary ways:\n    \n    1.  **Search as Pretraining:** Generate high-quality trajectories via MCTS and use them for supervised fine-tuning (similar to imitation learning).\n        \n    2.  **Search as Online Exploration:** Use MCTS during training to propose promising action sequences; the policy learns to imitate successful trajectories while exploring uncertain branches.\n        \n    3.  **Search as Evaluation:** Use MCTS only at inference to refine action selection, keeping policy updates purely gradient-based.\n        \n*   In [Agent Q](https://arxiv.org/abs/2408.07199), this second mode—_online search and adaptation_—proved especially effective, enabling agents to generalize across unseen tasks without explicit retraining.\n    \n\nSearch algorithms such as MCTS can be integrated with RL training in three primary ways:\n\n1.  **Search as Pretraining:** Generate high-quality trajectories via MCTS and use them for supervised fine-tuning (similar to imitation learning).\n    \n2.  **Search as Online Exploration:** Use MCTS during training to propose promising action sequences; the policy learns to imitate successful trajectories while exploring uncertain branches.\n    \n3.  **Search as Evaluation:** Use MCTS only at inference to refine action selection, keeping policy updates purely gradient-based.\n    \n\n**Search as Pretraining:** Generate high-quality trajectories via MCTS and use them for supervised fine-tuning (similar to imitation learning).\n\n**Search as Online Exploration:** Use MCTS during training to propose promising action sequences; the policy learns to imitate successful trajectories while exploring uncertain branches.\n\n**Search as Evaluation:** Use MCTS only at inference to refine action selection, keeping policy updates purely gradient-based.\n\nIn [Agent Q](https://arxiv.org/abs/2408.07199), this second mode—_online search and adaptation_—proved especially effective, enabling agents to generalize across unseen tasks without explicit retraining.",
    "order": 41,
    "orderInChapter": 6,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 257,
      "contentLength": 2473
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#integration-of-search-with-reinforcement-learning-and-fine-tuning",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-exploration-strategies-in-web-and-computer-use-env-42",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "title": "Exploration Strategies in Web and Computer-Use Environments",
    "subtitle": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "contentHtml": "<ul>\n  <li>\n    <p>In high-dimensional digital environments, exploration must be structured and interpretable. Several strategies are commonly used:</p>\n\n    <ul>\n      <li>\n        <p><strong>Entropy-Regularized Exploration:</strong> Adding an entropy term to the objective encourages diversity in action selection:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-302-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mrow><mo>[</mo><mrow><munder><mo>&amp;#x2211;</mo><mi>t</mi></munder><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B2;</mi><mo>,</mo><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4866\" style=\"width: 17.398em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.482em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1014.17em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4867\"><span class=\"mi\" id=\"MathJax-Span-4868\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4869\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4870\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4871\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4872\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4873\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4874\"><span class=\"mrow\" id=\"MathJax-Span-4875\"><span class=\"mi\" id=\"MathJax-Span-4876\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-4877\"><span class=\"mrow\" id=\"MathJax-Span-4878\"><span class=\"mi\" id=\"MathJax-Span-4879\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-4880\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-4881\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-4882\"><span class=\"munderover\" id=\"MathJax-Span-4883\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4884\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4885\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4886\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4887\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4888\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4889\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4890\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-4891\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4892\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4893\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">H<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4894\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4895\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4896\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-4897\" style=\"font-family: STIXGeneral-Regular;\">⋅</span><span class=\"texatom\" id=\"MathJax-Span-4898\"><span class=\"mrow\" id=\"MathJax-Span-4899\"><span class=\"mo\" id=\"MathJax-Span-4900\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4901\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4902\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4903\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4904\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4905\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4906\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-4907\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>π</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>π</mi></mrow></msub><mrow><mo>[</mo><mrow><munder><mo>∑</mo><mi>t</mi></munder><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>β</mi><mo>,</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mi>π</mi><mo stretchy=\"false\">(</mo><mo>⋅</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-302\">J(\\pi) = \\mathbb{E}_{\\pi}\\left[\\sum_t (r_t + \\beta , H(\\pi(\\cdot|s_t)))\\right]</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-303-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4908\" style=\"width: 2.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.98em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4909\"><span class=\"mi\" id=\"MathJax-Span-4910\" style=\"font-family: STIXGeneral-Italic;\">H<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4911\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4912\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4913\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>H</mi><mo stretchy=\"false\">(</mo><mi>π</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-303\">H(\\pi)</script> is policy entropy and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-304-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4914\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4915\"><span class=\"mi\" id=\"MathJax-Span-4916\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-304\">\\beta</script> controls exploration intensity.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Curiosity-Driven Exploration:</strong> Agents are rewarded for discovering novel or unpredictable states using intrinsic motivation models such as <a href=\"https://arxiv.org/abs/1810.12894\">Random Network Distillation</a> by Burda et al. (2019).</p>\n      </li>\n      <li>\n        <p><strong>Goal-Conditioned Exploration:</strong> Particularly in web tasks, exploration can be constrained by semantic or user-defined goals, ensuring the agent does not perform irrelevant actions.</p>\n      </li>\n      <li>\n        <p><strong>State Abstraction and Clustering:</strong> Complex environments can be segmented into abstract state representations (e.g., webpage templates or tool invocation graphs), allowing for hierarchical exploration.</p>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>These approaches are especially effective in <em>multi-turn environments</em> scenarios where the state space expands combinatorially with each decision.</p>\n  </li>\n</ul>\n<p>In high-dimensional digital environments, exploration must be structured and interpretable. Several strategies are commonly used:</p>\n<ul>\n      <li>\n        <p><strong>Entropy-Regularized Exploration:</strong> Adding an entropy term to the objective encourages diversity in action selection:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-302-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mrow><mo>[</mo><mrow><munder><mo>&amp;#x2211;</mo><mi>t</mi></munder><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B2;</mi><mo>,</mo><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4866\" style=\"width: 17.398em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.482em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1014.17em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4867\"><span class=\"mi\" id=\"MathJax-Span-4868\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4869\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4870\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4871\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4872\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4873\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4874\"><span class=\"mrow\" id=\"MathJax-Span-4875\"><span class=\"mi\" id=\"MathJax-Span-4876\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-4877\"><span class=\"mrow\" id=\"MathJax-Span-4878\"><span class=\"mi\" id=\"MathJax-Span-4879\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-4880\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-4881\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-4882\"><span class=\"munderover\" id=\"MathJax-Span-4883\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4884\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4885\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4886\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4887\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4888\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4889\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4890\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-4891\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4892\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4893\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">H<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4894\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4895\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4896\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-4897\" style=\"font-family: STIXGeneral-Regular;\">⋅</span><span class=\"texatom\" id=\"MathJax-Span-4898\"><span class=\"mrow\" id=\"MathJax-Span-4899\"><span class=\"mo\" id=\"MathJax-Span-4900\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4901\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4902\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4903\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4904\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4905\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4906\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-4907\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>π</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>π</mi></mrow></msub><mrow><mo>[</mo><mrow><munder><mo>∑</mo><mi>t</mi></munder><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>β</mi><mo>,</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mi>π</mi><mo stretchy=\"false\">(</mo><mo>⋅</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-302\">J(\\pi) = \\mathbb{E}_{\\pi}\\left[\\sum_t (r_t + \\beta , H(\\pi(\\cdot|s_t)))\\right]</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-303-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4908\" style=\"width: 2.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.98em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4909\"><span class=\"mi\" id=\"MathJax-Span-4910\" style=\"font-family: STIXGeneral-Italic;\">H<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4911\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4912\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4913\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>H</mi><mo stretchy=\"false\">(</mo><mi>π</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-303\">H(\\pi)</script> is policy entropy and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-304-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4914\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4915\"><span class=\"mi\" id=\"MathJax-Span-4916\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-304\">\\beta</script> controls exploration intensity.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Curiosity-Driven Exploration:</strong> Agents are rewarded for discovering novel or unpredictable states using intrinsic motivation models such as <a href=\"https://arxiv.org/abs/1810.12894\">Random Network Distillation</a> by Burda et al. (2019).</p>\n      </li>\n      <li>\n        <p><strong>Goal-Conditioned Exploration:</strong> Particularly in web tasks, exploration can be constrained by semantic or user-defined goals, ensuring the agent does not perform irrelevant actions.</p>\n      </li>\n      <li>\n        <p><strong>State Abstraction and Clustering:</strong> Complex environments can be segmented into abstract state representations (e.g., webpage templates or tool invocation graphs), allowing for hierarchical exploration.</p>\n      </li>\n    </ul>\n<p><strong>Entropy-Regularized Exploration:</strong> Adding an entropy term to the objective encourages diversity in action selection:</p>\n<ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-303-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4908\" style=\"width: 2.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.98em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4909\"><span class=\"mi\" id=\"MathJax-Span-4910\" style=\"font-family: STIXGeneral-Italic;\">H<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4911\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4912\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4913\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>H</mi><mo stretchy=\"false\">(</mo><mi>π</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-303\">H(\\pi)</script> is policy entropy and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-304-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4914\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4915\"><span class=\"mi\" id=\"MathJax-Span-4916\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-304\">\\beta</script> controls exploration intensity.</li>\n        </ul>\n<p><strong>Curiosity-Driven Exploration:</strong> Agents are rewarded for discovering novel or unpredictable states using intrinsic motivation models such as <a href=\"https://arxiv.org/abs/1810.12894\">Random Network Distillation</a> by Burda et al. (2019).</p>\n<p><strong>Goal-Conditioned Exploration:</strong> Particularly in web tasks, exploration can be constrained by semantic or user-defined goals, ensuring the agent does not perform irrelevant actions.</p>\n<p><strong>State Abstraction and Clustering:</strong> Complex environments can be segmented into abstract state representations (e.g., webpage templates or tool invocation graphs), allowing for hierarchical exploration.</p>\n<p>These approaches are especially effective in <em>multi-turn environments</em> scenarios where the state space expands combinatorially with each decision.</p>",
    "contentMarkdown": "*   In high-dimensional digital environments, exploration must be structured and interpretable. Several strategies are commonly used:\n    \n    *   **Entropy-Regularized Exploration:** Adding an entropy term to the objective encourages diversity in action selection:\n        \n        J(π)\\=𝔼π\\[∑t(rt+β,H(π(⋅|st)))\\]J(π)\\=Eπ\\[∑t(rt+β,H(π(⋅|st)))\\]\n        \n        J(\\\\pi) = \\\\mathbb{E}\\_{\\\\pi}\\\\left\\[\\\\sum\\_t (r\\_t + \\\\beta , H(\\\\pi(\\\\cdot|s\\_t)))\\\\right\\]\n        *   where H(π)H(π)H(\\\\pi) is policy entropy and ββ\\\\beta controls exploration intensity.\n    *   **Curiosity-Driven Exploration:** Agents are rewarded for discovering novel or unpredictable states using intrinsic motivation models such as [Random Network Distillation](https://arxiv.org/abs/1810.12894) by Burda et al. (2019).\n        \n    *   **Goal-Conditioned Exploration:** Particularly in web tasks, exploration can be constrained by semantic or user-defined goals, ensuring the agent does not perform irrelevant actions.\n        \n    *   **State Abstraction and Clustering:** Complex environments can be segmented into abstract state representations (e.g., webpage templates or tool invocation graphs), allowing for hierarchical exploration.\n        \n*   These approaches are especially effective in _multi-turn environments_ scenarios where the state space expands combinatorially with each decision.\n    \n\nIn high-dimensional digital environments, exploration must be structured and interpretable. Several strategies are commonly used:\n\n*   **Entropy-Regularized Exploration:** Adding an entropy term to the objective encourages diversity in action selection:\n    \n    J(π)\\=𝔼π\\[∑t(rt+β,H(π(⋅|st)))\\]J(π)\\=Eπ\\[∑t(rt+β,H(π(⋅|st)))\\]\n    \n    J(\\\\pi) = \\\\mathbb{E}\\_{\\\\pi}\\\\left\\[\\\\sum\\_t (r\\_t + \\\\beta , H(\\\\pi(\\\\cdot|s\\_t)))\\\\right\\]\n    *   where H(π)H(π)H(\\\\pi) is policy entropy and ββ\\\\beta controls exploration intensity.\n*   **Curiosity-Driven Exploration:** Agents are rewarded for discovering novel or unpredictable states using intrinsic motivation models such as [Random Network Distillation](https://arxiv.org/abs/1810.12894) by Burda et al. (2019).\n    \n*   **Goal-Conditioned Exploration:** Particularly in web tasks, exploration can be constrained by semantic or user-defined goals, ensuring the agent does not perform irrelevant actions.\n    \n*   **State Abstraction and Clustering:** Complex environments can be segmented into abstract state representations (e.g., webpage templates or tool invocation graphs), allowing for hierarchical exploration.\n    \n\n**Entropy-Regularized Exploration:** Adding an entropy term to the objective encourages diversity in action selection:\n\n*   where H(π)H(π)H(\\\\pi) is policy entropy and ββ\\\\beta controls exploration intensity.\n\n**Curiosity-Driven Exploration:** Agents are rewarded for discovering novel or unpredictable states using intrinsic motivation models such as [Random Network Distillation](https://arxiv.org/abs/1810.12894) by Burda et al. (2019).\n\n**Goal-Conditioned Exploration:** Particularly in web tasks, exploration can be constrained by semantic or user-defined goals, ensuring the agent does not perform irrelevant actions.\n\n**State Abstraction and Clustering:** Complex environments can be segmented into abstract state representations (e.g., webpage templates or tool invocation graphs), allowing for hierarchical exploration.\n\nThese approaches are especially effective in _multi-turn environments_ scenarios where the state space expands combinatorially with each decision.",
    "order": 42,
    "orderInChapter": 7,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 385,
      "contentLength": 30895
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#exploration-strategies-in-web-and-computer-use-environments",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-planning-and-value-composition-across-multiple-env-43",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "title": "Planning and Value Composition Across Multiple Environments",
    "subtitle": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "contentHtml": "<ul>\n  <li>\n    <p>The integration of search-based reasoning with learned RL policies allows agents to <em>compose behaviors across environment types</em>. For instance:</p>\n\n    <ul>\n      <li>In <strong>single-turn environments</strong>, search helps refine output reasoning (e.g., multi-step chain-of-thought validation).</li>\n      <li>In <strong>tool-use environments</strong>, it aids in selecting optimal tool invocation sequences.</li>\n      <li>In <strong>multi-turn environments</strong>, it supports long-horizon planning and dynamic replanning when goals change.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The combined expected return from multi-environment value composition can be expressed as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-305-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>J</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>global</mtext></mrow></msub><mo>=</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>e</mi><mo>&amp;#x2208;</mo><mi>E</mi></mrow></munder><msub><mi>&amp;#x03C9;</mi><mi>e</mi></msub><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03C0;</mi><mi>e</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munder><mo>&amp;#x2211;</mo><mi>t</mi></munder><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>e</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4917\" style=\"width: 15.211em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1012.35em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4918\"><span class=\"msubsup\" id=\"MathJax-Span-4919\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4920\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4921\"><span class=\"mrow\" id=\"MathJax-Span-4922\"><span class=\"mtext\" id=\"MathJax-Span-4923\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">global</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4924\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-4925\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4926\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.273em, -999.997em); top: -2.862em; left: 0.003em;\"><span class=\"texatom\" id=\"MathJax-Span-4927\"><span class=\"mrow\" id=\"MathJax-Span-4928\"><span class=\"mi\" id=\"MathJax-Span-4929\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">e</span><span class=\"mo\" id=\"MathJax-Span-4930\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∈</span><span class=\"mi\" id=\"MathJax-Span-4931\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">E<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4932\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4933\" style=\"font-family: STIXGeneral-Italic;\">ω</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-4934\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">e</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4935\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4936\"><span class=\"mrow\" id=\"MathJax-Span-4937\"><span class=\"mi\" id=\"MathJax-Span-4938\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-4939\"><span class=\"mrow\" id=\"MathJax-Span-4940\"><span class=\"msubsup\" id=\"MathJax-Span-4941\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4942\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4943\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">e</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-4944\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-4945\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-4946\"><span class=\"munderover\" id=\"MathJax-Span-4947\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4948\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4949\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4950\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4951\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4952\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4953\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4954\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4955\"><span class=\"mrow\" id=\"MathJax-Span-4956\"><span class=\"mo\" id=\"MathJax-Span-4957\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4958\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">e</span><span class=\"mo\" id=\"MathJax-Span-4959\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4960\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4961\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>J</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>global</mtext></mrow></msub><mo>=</mo><munder><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>e</mi><mo>∈</mo><mi>E</mi></mrow></munder><msub><mi>ω</mi><mi>e</mi></msub><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>π</mi><mi>e</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munder><mo>∑</mo><mi>t</mi></munder><msup><mi>γ</mi><mi>t</mi></msup><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>e</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-305\">J_{\\text{global}} = \\sum_{e \\in E} \\omega_e \\mathbb{E}_{\\pi_e}\\left[\\sum_t \\gamma^t r_t^{(e)}\\right]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-306-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4962\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4963\"><span class=\"mi\" id=\"MathJax-Span-4964\" style=\"font-family: STIXGeneral-Italic;\">E<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>E</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-306\">E</script> denotes environment types (SingleTurn, Tool, MultiTurn) and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-307-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C9;</mi><mi>e</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4965\" style=\"width: 1.357em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.1em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4966\"><span class=\"msubsup\" id=\"MathJax-Span-4967\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4968\" style=\"font-family: STIXGeneral-Italic;\">ω</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-4969\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">e</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>ω</mi><mi>e</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-307\">\\omega_e</script> are task-specific weights.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This hierarchical structure aligns exploration depth with task complexity, improving sample efficiency and stability.</p>\n  </li>\n</ul>\n<p>The integration of search-based reasoning with learned RL policies allows agents to <em>compose behaviors across environment types</em>. For instance:</p>\n<ul>\n      <li>In <strong>single-turn environments</strong>, search helps refine output reasoning (e.g., multi-step chain-of-thought validation).</li>\n      <li>In <strong>tool-use environments</strong>, it aids in selecting optimal tool invocation sequences.</li>\n      <li>In <strong>multi-turn environments</strong>, it supports long-horizon planning and dynamic replanning when goals change.</li>\n    </ul>\n<p>The combined expected return from multi-environment value composition can be expressed as:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-306-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4962\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4963\"><span class=\"mi\" id=\"MathJax-Span-4964\" style=\"font-family: STIXGeneral-Italic;\">E<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>E</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-306\">E</script> denotes environment types (SingleTurn, Tool, MultiTurn) and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-307-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C9;</mi><mi>e</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4965\" style=\"width: 1.357em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.1em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4966\"><span class=\"msubsup\" id=\"MathJax-Span-4967\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4968\" style=\"font-family: STIXGeneral-Italic;\">ω</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-4969\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">e</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>ω</mi><mi>e</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-307\">\\omega_e</script> are task-specific weights.</li>\n    </ul>\n<p>This hierarchical structure aligns exploration depth with task complexity, improving sample efficiency and stability.</p>",
    "contentMarkdown": "*   The integration of search-based reasoning with learned RL policies allows agents to _compose behaviors across environment types_. For instance:\n    \n    *   In **single-turn environments**, search helps refine output reasoning (e.g., multi-step chain-of-thought validation).\n    *   In **tool-use environments**, it aids in selecting optimal tool invocation sequences.\n    *   In **multi-turn environments**, it supports long-horizon planning and dynamic replanning when goals change.\n*   The combined expected return from multi-environment value composition can be expressed as:\n    \n    Jglobal\\=∑e∈Eωe𝔼πe\\[∑tγtr(e)t\\]Jglobal\\=∑e∈EωeEπe\\[∑tγtrt(e)\\]\n    \n    J\\_{\\\\text{global}} = \\\\sum\\_{e \\\\in E} \\\\omega\\_e \\\\mathbb{E}\\_{\\\\pi\\_e}\\\\left\\[\\\\sum\\_t \\\\gamma^t r\\_t^{(e)}\\\\right\\]\n    *   where EEE denotes environment types (SingleTurn, Tool, MultiTurn) and ωeωe\\\\omega\\_e are task-specific weights.\n*   This hierarchical structure aligns exploration depth with task complexity, improving sample efficiency and stability.\n    \n\nThe integration of search-based reasoning with learned RL policies allows agents to _compose behaviors across environment types_. For instance:\n\n*   In **single-turn environments**, search helps refine output reasoning (e.g., multi-step chain-of-thought validation).\n*   In **tool-use environments**, it aids in selecting optimal tool invocation sequences.\n*   In **multi-turn environments**, it supports long-horizon planning and dynamic replanning when goals change.\n\nThe combined expected return from multi-environment value composition can be expressed as:\n\n*   where EEE denotes environment types (SingleTurn, Tool, MultiTurn) and ωeωe\\\\omega\\_e are task-specific weights.\n\nThis hierarchical structure aligns exploration depth with task complexity, improving sample efficiency and stability.",
    "order": 43,
    "orderInChapter": 8,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 209,
      "contentLength": 18999
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#planning-and-value-composition-across-multiple-environments",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-summary-and-outlook-44",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "title": "Summary and Outlook",
    "subtitle": "Search-Based Reinforcement Learning, Monte Carlo Tree Search (MCTS), and Exploration Strategies in Multi-Step Agents",
    "contentHtml": "<ul>\n  <li>\n    <p>Search-based RL represents a crucial step in bridging <strong>symbolic planning</strong> and <strong>neural policy learning</strong> for complex, real-world agents.</p>\n\n    <ul>\n      <li><strong>Monte Carlo Tree Search (MCTS)</strong> provides structured exploration with statistical guarantees.</li>\n      <li><strong>Neural-guided search</strong> integrates learned policy and value priors for scalability.</li>\n      <li><strong>Process-wise rewards</strong> smooth sparse reward landscapes, enabling deeper credit assignment.</li>\n      <li><strong>Hybrid search–RL systems</strong> enable online adaptation and continual learning.</li>\n    </ul>\n  </li>\n  <li>\n    <p>As web and computer-use agents evolve, search-based strategies are increasingly viewed not as add-ons but as <em>core cognitive modules</em>, empowering agents to deliberate, simulate, and refine decisions—much like human reasoning.</p>\n  </li>\n</ul>\n<p>Search-based RL represents a crucial step in bridging <strong>symbolic planning</strong> and <strong>neural policy learning</strong> for complex, real-world agents.</p>\n<ul>\n      <li><strong>Monte Carlo Tree Search (MCTS)</strong> provides structured exploration with statistical guarantees.</li>\n      <li><strong>Neural-guided search</strong> integrates learned policy and value priors for scalability.</li>\n      <li><strong>Process-wise rewards</strong> smooth sparse reward landscapes, enabling deeper credit assignment.</li>\n      <li><strong>Hybrid search–RL systems</strong> enable online adaptation and continual learning.</li>\n    </ul>\n<p>As web and computer-use agents evolve, search-based strategies are increasingly viewed not as add-ons but as <em>core cognitive modules</em>, empowering agents to deliberate, simulate, and refine decisions—much like human reasoning.</p>",
    "contentMarkdown": "*   Search-based RL represents a crucial step in bridging **symbolic planning** and **neural policy learning** for complex, real-world agents.\n    \n    *   **Monte Carlo Tree Search (MCTS)** provides structured exploration with statistical guarantees.\n    *   **Neural-guided search** integrates learned policy and value priors for scalability.\n    *   **Process-wise rewards** smooth sparse reward landscapes, enabling deeper credit assignment.\n    *   **Hybrid search–RL systems** enable online adaptation and continual learning.\n*   As web and computer-use agents evolve, search-based strategies are increasingly viewed not as add-ons but as _core cognitive modules_, empowering agents to deliberate, simulate, and refine decisions—much like human reasoning.\n    \n\nSearch-based RL represents a crucial step in bridging **symbolic planning** and **neural policy learning** for complex, real-world agents.\n\n*   **Monte Carlo Tree Search (MCTS)** provides structured exploration with statistical guarantees.\n*   **Neural-guided search** integrates learned policy and value priors for scalability.\n*   **Process-wise rewards** smooth sparse reward landscapes, enabling deeper credit assignment.\n*   **Hybrid search–RL systems** enable online adaptation and continual learning.\n\nAs web and computer-use agents evolve, search-based strategies are increasingly viewed not as add-ons but as _core cognitive modules_, empowering agents to deliberate, simulate, and refine decisions—much like human reasoning.",
    "order": 44,
    "orderInChapter": 9,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 186,
      "contentLength": 1835
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#summary-and-outlook",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-the-need-for-memory-and-temporal-reasoning-45",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "title": "The Need for Memory and Temporal Reasoning",
    "subtitle": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "contentHtml": "<ul>\n  <li>\n    <p>Unlike short episodic tasks, web and computer-use agents must operate over long time horizons—completing multi-step workflows, navigating dynamic web pages, and managing context-dependent subtasks that span hundreds of actions. These tasks demand <strong>temporal coherence</strong>, <strong>state persistence</strong>, and <strong>contextual reasoning</strong>, capabilities that exceed what standard Markovian RL formulations provide.</p>\n  </li>\n  <li>\n    <p>Traditional RL assumes the <strong>Markov Decision Process (MDP)</strong> property:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-308-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4970\" style=\"width: 20.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 17.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1016.98em, 2.919em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4971\"><span class=\"mi\" id=\"MathJax-Span-4972\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-4973\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4974\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4975\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-4976\"><span class=\"mrow\" id=\"MathJax-Span-4977\"><span class=\"mi\" id=\"MathJax-Span-4978\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4979\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-4980\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4981\"><span class=\"mrow\" id=\"MathJax-Span-4982\"><span class=\"mo\" id=\"MathJax-Span-4983\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4984\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4985\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4986\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4987\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4988\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4989\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4990\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4991\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4992\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4993\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-4994\"><span class=\"mrow\" id=\"MathJax-Span-4995\"><span class=\"mi\" id=\"MathJax-Span-4996\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4997\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-4998\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4999\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5000\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5001\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5002\"><span class=\"mrow\" id=\"MathJax-Span-5003\"><span class=\"mi\" id=\"MathJax-Span-5004\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5005\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-5006\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5007\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-5008\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">.</span><span class=\"mo\" id=\"MathJax-Span-5009\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">.</span><span class=\"mo\" id=\"MathJax-Span-5010\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">.</span><span class=\"mo\" id=\"MathJax-Span-5011\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">)</span><span class=\"mo\" id=\"MathJax-Span-5012\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-5013\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">P</span><span class=\"mo\" id=\"MathJax-Span-5014\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5015\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5016\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5017\"><span class=\"mrow\" id=\"MathJax-Span-5018\"><span class=\"mi\" id=\"MathJax-Span-5019\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5020\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-5021\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-5022\"><span class=\"mrow\" id=\"MathJax-Span-5023\"><span class=\"mo\" id=\"MathJax-Span-5024\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5025\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5026\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5027\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5028\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5029\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5030\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5031\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5032\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-308\">P(s_{t+1} | s_t, a_t, s_{t-1}, a_{t-1}, ...) = P(s_{t+1} | s_t, a_t)</script>\n\n    <ul>\n      <li>which implies that the current state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-309-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5033\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5034\"><span class=\"msubsup\" id=\"MathJax-Span-5035\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5036\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5037\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-309\">s_t</script> encapsulates all relevant information for decision-making. In practice, however, agents must handle <strong>Partially Observable MDPs (POMDPs)</strong>, where the environment’s full state is not directly visible—such as hidden system states, incomplete browser information, or unobserved user intentions.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This motivates integrating <strong>memory mechanisms</strong>—either through explicit world models, neural state trackers, or structured external memories—that allow agents to reason over <em>latent histories</em>.</p>\n  </li>\n  <li>\n    <p>Recent pretraining approaches such as <strong>Early Experience</strong> (<a href=\"https://arxiv.org/abs/2510.08558\">Agent Learning via Early Experience</a> by Zhang et al., 2025) implicitly address this by building <em>internal temporal memory</em> even before explicit RL fine-tuning. Through predictive next-state modeling and reflective rationalization losses, the agent internalizes time-linked dependencies (e.g., how tool outcomes evolve or how plans fail) purely from self-supervised rollouts—forming an implicit memory backbone that later stabilizes long-horizon RL.</p>\n  </li>\n</ul>\n<p>Unlike short episodic tasks, web and computer-use agents must operate over long time horizons—completing multi-step workflows, navigating dynamic web pages, and managing context-dependent subtasks that span hundreds of actions. These tasks demand <strong>temporal coherence</strong>, <strong>state persistence</strong>, and <strong>contextual reasoning</strong>, capabilities that exceed what standard Markovian RL formulations provide.</p>\n<p>Traditional RL assumes the <strong>Markov Decision Process (MDP)</strong> property:</p>\n<ul>\n      <li>which implies that the current state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-309-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5033\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5034\"><span class=\"msubsup\" id=\"MathJax-Span-5035\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5036\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5037\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-309\">s_t</script> encapsulates all relevant information for decision-making. In practice, however, agents must handle <strong>Partially Observable MDPs (POMDPs)</strong>, where the environment’s full state is not directly visible—such as hidden system states, incomplete browser information, or unobserved user intentions.</li>\n    </ul>\n<p>This motivates integrating <strong>memory mechanisms</strong>—either through explicit world models, neural state trackers, or structured external memories—that allow agents to reason over <em>latent histories</em>.</p>\n<p>Recent pretraining approaches such as <strong>Early Experience</strong> (<a href=\"https://arxiv.org/abs/2510.08558\">Agent Learning via Early Experience</a> by Zhang et al., 2025) implicitly address this by building <em>internal temporal memory</em> even before explicit RL fine-tuning. Through predictive next-state modeling and reflective rationalization losses, the agent internalizes time-linked dependencies (e.g., how tool outcomes evolve or how plans fail) purely from self-supervised rollouts—forming an implicit memory backbone that later stabilizes long-horizon RL.</p>",
    "contentMarkdown": "*   Unlike short episodic tasks, web and computer-use agents must operate over long time horizons—completing multi-step workflows, navigating dynamic web pages, and managing context-dependent subtasks that span hundreds of actions. These tasks demand **temporal coherence**, **state persistence**, and **contextual reasoning**, capabilities that exceed what standard Markovian RL formulations provide.\n    \n*   Traditional RL assumes the **Markov Decision Process (MDP)** property:\n    \n    P(st+1|st,at,st−1,at−1,...)\\=P(st+1|st,at)P(st+1|st,at,st−1,at−1,...)\\=P(st+1|st,at)\n    \n    P(s\\_{t+1} | s\\_t, a\\_t, s\\_{t-1}, a\\_{t-1}, ...) = P(s\\_{t+1} | s\\_t, a\\_t)\n    *   which implies that the current state ststs\\_t encapsulates all relevant information for decision-making. In practice, however, agents must handle **Partially Observable MDPs (POMDPs)**, where the environment’s full state is not directly visible—such as hidden system states, incomplete browser information, or unobserved user intentions.\n*   This motivates integrating **memory mechanisms**—either through explicit world models, neural state trackers, or structured external memories—that allow agents to reason over _latent histories_.\n    \n*   Recent pretraining approaches such as **Early Experience** ([Agent Learning via Early Experience](https://arxiv.org/abs/2510.08558) by Zhang et al., 2025) implicitly address this by building _internal temporal memory_ even before explicit RL fine-tuning. Through predictive next-state modeling and reflective rationalization losses, the agent internalizes time-linked dependencies (e.g., how tool outcomes evolve or how plans fail) purely from self-supervised rollouts—forming an implicit memory backbone that later stabilizes long-horizon RL.\n    \n\nUnlike short episodic tasks, web and computer-use agents must operate over long time horizons—completing multi-step workflows, navigating dynamic web pages, and managing context-dependent subtasks that span hundreds of actions. These tasks demand **temporal coherence**, **state persistence**, and **contextual reasoning**, capabilities that exceed what standard Markovian RL formulations provide.\n\nTraditional RL assumes the **Markov Decision Process (MDP)** property:\n\n*   which implies that the current state ststs\\_t encapsulates all relevant information for decision-making. In practice, however, agents must handle **Partially Observable MDPs (POMDPs)**, where the environment’s full state is not directly visible—such as hidden system states, incomplete browser information, or unobserved user intentions.\n\nThis motivates integrating **memory mechanisms**—either through explicit world models, neural state trackers, or structured external memories—that allow agents to reason over _latent histories_.\n\nRecent pretraining approaches such as **Early Experience** ([Agent Learning via Early Experience](https://arxiv.org/abs/2510.08558) by Zhang et al., 2025) implicitly address this by building _internal temporal memory_ even before explicit RL fine-tuning. Through predictive next-state modeling and reflective rationalization losses, the agent internalizes time-linked dependencies (e.g., how tool outcomes evolve or how plans fail) purely from self-supervised rollouts—forming an implicit memory backbone that later stabilizes long-horizon RL.",
    "order": 45,
    "orderInChapter": 1,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 395,
      "contentLength": 19854
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#the-need-for-memory-and-temporal-reasoning",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-explicit-vs-implicit-memory-architectures-46",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "title": "Explicit vs. Implicit Memory Architectures",
    "subtitle": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "contentHtml": "<ul>\n  <li>\n    <p>Modern agentic systems implement memory in two major ways—<strong>explicit symbolic memory</strong> and <strong>implicit neural memory</strong>—each optimized for different environment dynamics.</p>\n\n    <ol>\n      <li>\n        <p><strong>Explicit Symbolic Memory</strong>:</p>\n\n        <ul>\n          <li>Stores structured facts and environment states (e.g., webpage structure, task progress, prior tool outputs).</li>\n          <li>Can be queried and updated through symbolic operations or APIs.</li>\n          <li>Used in systems like <a href=\"https://arxiv.org/abs/2406.04151\">AgentGym</a> by Xi et al. (2024), where a memory table tracks intermediate decisions and outcomes for reproducibility and long-term credit assignment.</li>\n          <li>Enables interpretable reasoning, making it possible to inspect or reset specific memory slots.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Implicit Neural Memory</strong>:</p>\n\n        <ul>\n          <li>Encodes temporal context within the model’s hidden states using architectures like Transformers, LSTMs, or recurrent attention mechanisms.</li>\n          <li>Particularly effective for LLMs fine-tuned via RLHF or DPO, where the hidden activations naturally preserve dialogue history and reasoning traces.</li>\n          <li>Recent innovations such as <em>recurrent Transformers</em> and <em>memory-augmented attention</em> extend this capability to tasks requiring hundreds of tokens of temporal coherence.</li>\n        </ul>\n      </li>\n    </ol>\n  </li>\n  <li>\n    <p>Formally, implicit memory can be represented as an evolving state embedding <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-310-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><msub><mi>f</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>h</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5038\" style=\"width: 8.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1007.29em, 2.607em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5039\"><span class=\"msubsup\" id=\"MathJax-Span-5040\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5041\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5042\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5043\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5044\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5045\" style=\"font-family: STIXGeneral-Italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-5046\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5047\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5048\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5049\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5050\"><span class=\"mrow\" id=\"MathJax-Span-5051\"><span class=\"mi\" id=\"MathJax-Span-5052\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5053\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-5054\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5055\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5056\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5057\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5058\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5059\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5060\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5061\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5062\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5063\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>h</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-310\">h_t = f_\\theta(h_{t-1}, s_t, a_t)</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-311-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5064\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5065\"><span class=\"msubsup\" id=\"MathJax-Span-5066\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5067\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5068\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>h</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-311\">h_t</script> serves as a <em>latent world model</em> summarizing all past experiences relevant to future predictions.</p>\n  </li>\n  <li>\n    <p>In Early Experience, the same principle emerges organically through the <strong>implicit world-modeling objective</strong>:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-312-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>I</mi><mi mathvariant=&quot;normal&quot;>W</mi><mi mathvariant=&quot;normal&quot;>M</mi></mrow></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>a</mi><mi>i</mi><mi>j</mi></msubsup><mo>,</mo><msubsup><mi>s</mi><mi>i</mi><mi>j</mi></msubsup><mo stretchy=&quot;false&quot;>)</mo></mrow></munder><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msubsup><mi>s</mi><mi>i</mi><mi>j</mi></msubsup><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>a</mi><mi>i</mi><mi>j</mi></msubsup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5069\" style=\"width: 17.398em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.482em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1014.43em, 4.065em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5070\"><span class=\"msubsup\" id=\"MathJax-Span-5071\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5072\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-5073\"><span class=\"mrow\" id=\"MathJax-Span-5074\"><span class=\"texatom\" id=\"MathJax-Span-5075\"><span class=\"mrow\" id=\"MathJax-Span-5076\"><span class=\"mi\" id=\"MathJax-Span-5077\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">I</span><span class=\"mi\" id=\"MathJax-Span-5078\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">W</span><span class=\"mi\" id=\"MathJax-Span-5079\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">M</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5080\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5081\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5082\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5083\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-5084\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">−</span><span class=\"munderover\" id=\"MathJax-Span-5085\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-5086\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1002.29em, 4.482em, -999.997em); top: -2.654em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5087\"><span class=\"mrow\" id=\"MathJax-Span-5088\"><span class=\"mo\" id=\"MathJax-Span-5089\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5090\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5091\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-5092\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5093\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5094\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5095\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.21em, 4.273em, -999.997em); top: -4.372em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5096\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.21em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5097\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5098\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5099\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5100\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.21em, 4.273em, -999.997em); top: -4.372em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-5101\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.21em, 4.169em, -999.997em); top: -3.799em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-5102\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5103\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-5104\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-5105\"></span><span class=\"msubsup\" id=\"MathJax-Span-5106\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5107\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5108\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5109\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5110\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5111\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.326em, -999.997em); top: -4.477em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5112\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5113\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5114\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"msubsup\" id=\"MathJax-Span-5115\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5116\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5117\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5118\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5119\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5120\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.326em, -999.997em); top: -4.477em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5121\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5122\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5123\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -2.059em; border-left: 0px solid; width: 0px; height: 3.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">I</mi><mi mathvariant=\"normal\">W</mi><mi mathvariant=\"normal\">M</mi></mrow></mrow></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>a</mi><mi>i</mi><mi>j</mi></msubsup><mo>,</mo><msubsup><mi>s</mi><mi>i</mi><mi>j</mi></msubsup><mo stretchy=\"false\">)</mo></mrow></munder><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msubsup><mi>s</mi><mi>i</mi><mi>j</mi></msubsup><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>a</mi><mi>i</mi><mi>j</mi></msubsup><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-312\">L_{\\mathrm{IWM}}(\\theta) = - \\sum_{(s_i,a_i^j,s_i^j)} \\log p_\\theta(s_i^j \\mid s_i, a_i^j)</script>\n\n    <ul>\n      <li>which forces the model to construct temporally predictive embeddings even without explicit memory modules—creating an “implicit long-term memory” foundation later leveraged during reinforcement learning.</li>\n    </ul>\n  </li>\n</ul>\n<p>Modern agentic systems implement memory in two major ways—<strong>explicit symbolic memory</strong> and <strong>implicit neural memory</strong>—each optimized for different environment dynamics.</p>\n<ol>\n      <li>\n        <p><strong>Explicit Symbolic Memory</strong>:</p>\n\n        <ul>\n          <li>Stores structured facts and environment states (e.g., webpage structure, task progress, prior tool outputs).</li>\n          <li>Can be queried and updated through symbolic operations or APIs.</li>\n          <li>Used in systems like <a href=\"https://arxiv.org/abs/2406.04151\">AgentGym</a> by Xi et al. (2024), where a memory table tracks intermediate decisions and outcomes for reproducibility and long-term credit assignment.</li>\n          <li>Enables interpretable reasoning, making it possible to inspect or reset specific memory slots.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Implicit Neural Memory</strong>:</p>\n\n        <ul>\n          <li>Encodes temporal context within the model’s hidden states using architectures like Transformers, LSTMs, or recurrent attention mechanisms.</li>\n          <li>Particularly effective for LLMs fine-tuned via RLHF or DPO, where the hidden activations naturally preserve dialogue history and reasoning traces.</li>\n          <li>Recent innovations such as <em>recurrent Transformers</em> and <em>memory-augmented attention</em> extend this capability to tasks requiring hundreds of tokens of temporal coherence.</li>\n        </ul>\n      </li>\n    </ol>\n<p><strong>Explicit Symbolic Memory</strong>:</p>\n<ul>\n          <li>Stores structured facts and environment states (e.g., webpage structure, task progress, prior tool outputs).</li>\n          <li>Can be queried and updated through symbolic operations or APIs.</li>\n          <li>Used in systems like <a href=\"https://arxiv.org/abs/2406.04151\">AgentGym</a> by Xi et al. (2024), where a memory table tracks intermediate decisions and outcomes for reproducibility and long-term credit assignment.</li>\n          <li>Enables interpretable reasoning, making it possible to inspect or reset specific memory slots.</li>\n        </ul>\n<p><strong>Implicit Neural Memory</strong>:</p>\n<ul>\n          <li>Encodes temporal context within the model’s hidden states using architectures like Transformers, LSTMs, or recurrent attention mechanisms.</li>\n          <li>Particularly effective for LLMs fine-tuned via RLHF or DPO, where the hidden activations naturally preserve dialogue history and reasoning traces.</li>\n          <li>Recent innovations such as <em>recurrent Transformers</em> and <em>memory-augmented attention</em> extend this capability to tasks requiring hundreds of tokens of temporal coherence.</li>\n        </ul>\n<p>Formally, implicit memory can be represented as an evolving state embedding <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-310-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><msub><mi>f</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>h</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5038\" style=\"width: 8.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1007.29em, 2.607em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5039\"><span class=\"msubsup\" id=\"MathJax-Span-5040\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5041\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5042\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5043\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5044\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5045\" style=\"font-family: STIXGeneral-Italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-5046\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5047\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5048\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5049\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5050\"><span class=\"mrow\" id=\"MathJax-Span-5051\"><span class=\"mi\" id=\"MathJax-Span-5052\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5053\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-5054\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5055\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5056\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5057\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5058\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5059\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5060\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5061\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5062\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5063\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>h</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-310\">h_t = f_\\theta(h_{t-1}, s_t, a_t)</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-311-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5064\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5065\"><span class=\"msubsup\" id=\"MathJax-Span-5066\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5067\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5068\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>h</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-311\">h_t</script> serves as a <em>latent world model</em> summarizing all past experiences relevant to future predictions.</p>\n<p>In Early Experience, the same principle emerges organically through the <strong>implicit world-modeling objective</strong>:</p>\n<ul>\n      <li>which forces the model to construct temporally predictive embeddings even without explicit memory modules—creating an “implicit long-term memory” foundation later leveraged during reinforcement learning.</li>\n    </ul>",
    "contentMarkdown": "*   Modern agentic systems implement memory in two major ways—**explicit symbolic memory** and **implicit neural memory**—each optimized for different environment dynamics.\n    \n    1.  **Explicit Symbolic Memory**:\n        \n        *   Stores structured facts and environment states (e.g., webpage structure, task progress, prior tool outputs).\n        *   Can be queried and updated through symbolic operations or APIs.\n        *   Used in systems like [AgentGym](https://arxiv.org/abs/2406.04151) by Xi et al. (2024), where a memory table tracks intermediate decisions and outcomes for reproducibility and long-term credit assignment.\n        *   Enables interpretable reasoning, making it possible to inspect or reset specific memory slots.\n    2.  **Implicit Neural Memory**:\n        \n        *   Encodes temporal context within the model’s hidden states using architectures like Transformers, LSTMs, or recurrent attention mechanisms.\n        *   Particularly effective for LLMs fine-tuned via RLHF or DPO, where the hidden activations naturally preserve dialogue history and reasoning traces.\n        *   Recent innovations such as _recurrent Transformers_ and _memory-augmented attention_ extend this capability to tasks requiring hundreds of tokens of temporal coherence.\n*   Formally, implicit memory can be represented as an evolving state embedding ht\\=fθ(ht−1,st,at)ht\\=fθ(ht−1,st,at)h\\_t = f\\_\\\\theta(h\\_{t-1}, s\\_t, a\\_t), where hthth\\_t serves as a _latent world model_ summarizing all past experiences relevant to future predictions.\n    \n*   In Early Experience, the same principle emerges organically through the **implicit world-modeling objective**:\n    \n    LIWM(θ)\\=−∑(si,aji,sji)logpθ(sji∣si,aji)LIWM(θ)\\=−∑(si,aij,sij)log⁡pθ(sij∣si,aij)\n    \n    L\\_{\\\\mathrm{IWM}}(\\\\theta) = - \\\\sum\\_{(s\\_i,a\\_i^j,s\\_i^j)} \\\\log p\\_\\\\theta(s\\_i^j \\\\mid s\\_i, a\\_i^j)\n    *   which forces the model to construct temporally predictive embeddings even without explicit memory modules—creating an “implicit long-term memory” foundation later leveraged during reinforcement learning.\n\nModern agentic systems implement memory in two major ways—**explicit symbolic memory** and **implicit neural memory**—each optimized for different environment dynamics.\n\n1.  **Explicit Symbolic Memory**:\n    \n    *   Stores structured facts and environment states (e.g., webpage structure, task progress, prior tool outputs).\n    *   Can be queried and updated through symbolic operations or APIs.\n    *   Used in systems like [AgentGym](https://arxiv.org/abs/2406.04151) by Xi et al. (2024), where a memory table tracks intermediate decisions and outcomes for reproducibility and long-term credit assignment.\n    *   Enables interpretable reasoning, making it possible to inspect or reset specific memory slots.\n2.  **Implicit Neural Memory**:\n    \n    *   Encodes temporal context within the model’s hidden states using architectures like Transformers, LSTMs, or recurrent attention mechanisms.\n    *   Particularly effective for LLMs fine-tuned via RLHF or DPO, where the hidden activations naturally preserve dialogue history and reasoning traces.\n    *   Recent innovations such as _recurrent Transformers_ and _memory-augmented attention_ extend this capability to tasks requiring hundreds of tokens of temporal coherence.\n\n**Explicit Symbolic Memory**:\n\n*   Stores structured facts and environment states (e.g., webpage structure, task progress, prior tool outputs).\n*   Can be queried and updated through symbolic operations or APIs.\n*   Used in systems like [AgentGym](https://arxiv.org/abs/2406.04151) by Xi et al. (2024), where a memory table tracks intermediate decisions and outcomes for reproducibility and long-term credit assignment.\n*   Enables interpretable reasoning, making it possible to inspect or reset specific memory slots.\n\n**Implicit Neural Memory**:\n\n*   Encodes temporal context within the model’s hidden states using architectures like Transformers, LSTMs, or recurrent attention mechanisms.\n*   Particularly effective for LLMs fine-tuned via RLHF or DPO, where the hidden activations naturally preserve dialogue history and reasoning traces.\n*   Recent innovations such as _recurrent Transformers_ and _memory-augmented attention_ extend this capability to tasks requiring hundreds of tokens of temporal coherence.\n\nFormally, implicit memory can be represented as an evolving state embedding ht\\=fθ(ht−1,st,at)ht\\=fθ(ht−1,st,at)h\\_t = f\\_\\\\theta(h\\_{t-1}, s\\_t, a\\_t), where hthth\\_t serves as a _latent world model_ summarizing all past experiences relevant to future predictions.\n\nIn Early Experience, the same principle emerges organically through the **implicit world-modeling objective**:\n\n*   which forces the model to construct temporally predictive embeddings even without explicit memory modules—creating an “implicit long-term memory” foundation later leveraged during reinforcement learning.",
    "order": 46,
    "orderInChapter": 2,
    "difficulty": 5,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture",
      "transformer",
      "attention",
      "embedding",
      "lstm",
      "llm",
      "reinforcement learning",
      "activation"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 596,
      "contentLength": 35852
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#explicit-vs.-implicit-memory-architectures",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-world-modeling-learning-predictive-environment-rep-47",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "title": "World Modeling: Learning Predictive Environment Representations",
    "subtitle": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>World models</strong> enable agents to internalize the dynamics of their environments—predicting future states and rewards without constant external interaction. Originally introduced in <a href=\"https://arxiv.org/abs/1803.10122\">World Models</a> by Ha and Schmidhuber (2018), this approach decouples environment modeling from policy learning.</p>\n  </li>\n  <li>\n    <p>A world model typically includes three components:</p>\n\n    <ol>\n      <li><strong>Encoder</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-313-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5124\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5125\"><span class=\"msubsup\" id=\"MathJax-Span-5126\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5127\" style=\"font-family: STIXGeneral-Italic;\">E<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5128\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>E</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-313\">E_\\phi</script>: maps raw observations <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-314-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5129\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5130\"><span class=\"msubsup\" id=\"MathJax-Span-5131\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5132\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5133\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-314\">o_t</script> to latent states <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-315-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mi>t</mi></msub><mo>=</mo><msub><mi>E</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5134\" style=\"width: 5.419em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.482em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.43em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5135\"><span class=\"msubsup\" id=\"MathJax-Span-5136\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5137\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5138\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5139\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5140\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5141\" style=\"font-family: STIXGeneral-Italic;\">E<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5142\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5143\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5144\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5145\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5146\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5147\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>t</mi></msub><mo>=</mo><msub><mi>E</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-315\">z_t = E_\\phi(o_t)</script>;</li>\n      <li><strong>Transition Model</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-316-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mi>&amp;#x03C8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5148\" style=\"width: 1.357em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.1em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5149\"><span class=\"msubsup\" id=\"MathJax-Span-5150\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5151\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"mi\" id=\"MathJax-Span-5152\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>T</mi><mi>ψ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-316\">T_\\psi</script>: predicts future latent states <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-317-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>T</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5153\" style=\"width: 7.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1006.36em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5154\"><span class=\"msubsup\" id=\"MathJax-Span-5155\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5156\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5157\"><span class=\"mrow\" id=\"MathJax-Span-5158\"><span class=\"mi\" id=\"MathJax-Span-5159\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5160\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-5161\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5162\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5163\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5164\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"mi\" id=\"MathJax-Span-5165\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5166\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5167\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5168\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5169\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5170\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5171\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5172\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5173\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5174\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>T</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-317\">z_{t+1} = T_\\psi(z_t, a_t)</script>;</li>\n      <li><strong>Decoder or Predictor</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-318-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>D</mi><mi>&amp;#x03C9;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5175\" style=\"width: 1.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.3em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5176\"><span class=\"msubsup\" id=\"MathJax-Span-5177\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5178\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-5179\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ω</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>D</mi><mi>ω</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-318\">D_\\omega</script>: reconstructs or evaluates outcomes from latent states, such as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-319-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><msub><mi>D</mi><mi>&amp;#x03C9;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5180\" style=\"width: 5.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.534em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.48em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5181\"><span class=\"msubsup\" id=\"MathJax-Span-5182\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5183\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5184\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5185\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5186\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5187\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-5188\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ω</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5189\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5190\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5191\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5192\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5193\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><msub><mi>D</mi><mi>ω</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-319\">r_t = D_\\omega(z_t)</script>.</li>\n    </ol>\n  </li>\n  <li>\n    <p>By learning these components, the agent builds an internal simulation of the environment. This simulation can then be used for <em>planning</em>, <em>exploration</em>, or <em>policy evaluation</em> without direct execution—dramatically improving sample efficiency.</p>\n  </li>\n  <li>\n    <p>In web or tool-use domains, such models are extended to capture symbolic events (e.g., “clicked link,” “API returned error”) instead of pixels or low-level sensory data. The learned transition model enables agents to predict the <em>consequences of actions</em> before performing them, supporting safer and more data-efficient learning.</p>\n  </li>\n  <li>\n    <p>Both <strong>Early Experience</strong> and <strong>DreamGym</strong> build upon this concept but from complementary directions:</p>\n\n    <ul>\n      <li><a href=\"https://arxiv.org/abs/2510.08558\">Agent Learning via Early Experience</a> by Zhang et al. (2025) treats predictive modeling as a <em>language-native world model</em>—learning state transitions and self-reflective rationales purely from text-based environments before RL.</li>\n      <li><a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025) extends this into a formalized, <strong>reasoning-based synthetic world model</strong> (DreamGym) that produces internally consistent environment dynamics and synthetic rollouts.\nThe experience model jointly generates next states and rewards under logical and semantic constraints, acting as a simulator for RL training with provable policy-transfer guarantees.</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>World models</strong> enable agents to internalize the dynamics of their environments—predicting future states and rewards without constant external interaction. Originally introduced in <a href=\"https://arxiv.org/abs/1803.10122\">World Models</a> by Ha and Schmidhuber (2018), this approach decouples environment modeling from policy learning.</p>\n<p>A world model typically includes three components:</p>\n<ol>\n      <li><strong>Encoder</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-313-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5124\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5125\"><span class=\"msubsup\" id=\"MathJax-Span-5126\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5127\" style=\"font-family: STIXGeneral-Italic;\">E<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5128\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>E</mi><mi>ϕ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-313\">E_\\phi</script>: maps raw observations <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-314-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5129\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5130\"><span class=\"msubsup\" id=\"MathJax-Span-5131\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5132\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5133\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-314\">o_t</script> to latent states <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-315-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mi>t</mi></msub><mo>=</mo><msub><mi>E</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5134\" style=\"width: 5.419em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.482em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.43em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5135\"><span class=\"msubsup\" id=\"MathJax-Span-5136\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5137\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5138\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5139\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5140\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5141\" style=\"font-family: STIXGeneral-Italic;\">E<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5142\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ϕ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5143\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5144\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5145\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5146\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5147\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>t</mi></msub><mo>=</mo><msub><mi>E</mi><mi>ϕ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-315\">z_t = E_\\phi(o_t)</script>;</li>\n      <li><strong>Transition Model</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-316-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mi>&amp;#x03C8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5148\" style=\"width: 1.357em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.1em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5149\"><span class=\"msubsup\" id=\"MathJax-Span-5150\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5151\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"mi\" id=\"MathJax-Span-5152\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>T</mi><mi>ψ</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-316\">T_\\psi</script>: predicts future latent states <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-317-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>T</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5153\" style=\"width: 7.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1006.36em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5154\"><span class=\"msubsup\" id=\"MathJax-Span-5155\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5156\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5157\"><span class=\"mrow\" id=\"MathJax-Span-5158\"><span class=\"mi\" id=\"MathJax-Span-5159\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5160\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-5161\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5162\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5163\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5164\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"mi\" id=\"MathJax-Span-5165\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5166\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5167\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5168\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5169\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5170\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5171\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5172\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5173\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5174\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>T</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-317\">z_{t+1} = T_\\psi(z_t, a_t)</script>;</li>\n      <li><strong>Decoder or Predictor</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-318-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>D</mi><mi>&amp;#x03C9;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5175\" style=\"width: 1.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.3em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5176\"><span class=\"msubsup\" id=\"MathJax-Span-5177\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5178\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-5179\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ω</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>D</mi><mi>ω</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-318\">D_\\omega</script>: reconstructs or evaluates outcomes from latent states, such as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-319-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><msub><mi>D</mi><mi>&amp;#x03C9;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5180\" style=\"width: 5.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.534em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.48em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5181\"><span class=\"msubsup\" id=\"MathJax-Span-5182\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5183\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5184\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5185\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5186\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5187\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-5188\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ω</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5189\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5190\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5191\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5192\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5193\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><msub><mi>D</mi><mi>ω</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-319\">r_t = D_\\omega(z_t)</script>.</li>\n    </ol>\n<p>By learning these components, the agent builds an internal simulation of the environment. This simulation can then be used for <em>planning</em>, <em>exploration</em>, or <em>policy evaluation</em> without direct execution—dramatically improving sample efficiency.</p>\n<p>In web or tool-use domains, such models are extended to capture symbolic events (e.g., “clicked link,” “API returned error”) instead of pixels or low-level sensory data. The learned transition model enables agents to predict the <em>consequences of actions</em> before performing them, supporting safer and more data-efficient learning.</p>\n<p>Both <strong>Early Experience</strong> and <strong>DreamGym</strong> build upon this concept but from complementary directions:</p>\n<ul>\n      <li><a href=\"https://arxiv.org/abs/2510.08558\">Agent Learning via Early Experience</a> by Zhang et al. (2025) treats predictive modeling as a <em>language-native world model</em>—learning state transitions and self-reflective rationales purely from text-based environments before RL.</li>\n      <li><a href=\"https://arxiv.org/abs/2511.03773\">Scaling Agent Learning via Experience Synthesis</a> by Chen et al. (2025) extends this into a formalized, <strong>reasoning-based synthetic world model</strong> (DreamGym) that produces internally consistent environment dynamics and synthetic rollouts.\nThe experience model jointly generates next states and rewards under logical and semantic constraints, acting as a simulator for RL training with provable policy-transfer guarantees.</li>\n    </ul>",
    "contentMarkdown": "*   **World models** enable agents to internalize the dynamics of their environments—predicting future states and rewards without constant external interaction. Originally introduced in [World Models](https://arxiv.org/abs/1803.10122) by Ha and Schmidhuber (2018), this approach decouples environment modeling from policy learning.\n    \n*   A world model typically includes three components:\n    \n    1.  **Encoder** EϕEϕE\\_\\\\phi: maps raw observations ototo\\_t to latent states zt\\=Eϕ(ot)zt\\=Eϕ(ot)z\\_t = E\\_\\\\phi(o\\_t);\n    2.  **Transition Model** TψTψT\\_\\\\psi: predicts future latent states zt+1\\=Tψ(zt,at)zt+1\\=Tψ(zt,at)z\\_{t+1} = T\\_\\\\psi(z\\_t, a\\_t);\n    3.  **Decoder or Predictor** DωDωD\\_\\\\omega: reconstructs or evaluates outcomes from latent states, such as rt\\=Dω(zt)rt\\=Dω(zt)r\\_t = D\\_\\\\omega(z\\_t).\n*   By learning these components, the agent builds an internal simulation of the environment. This simulation can then be used for _planning_, _exploration_, or _policy evaluation_ without direct execution—dramatically improving sample efficiency.\n    \n*   In web or tool-use domains, such models are extended to capture symbolic events (e.g., “clicked link,” “API returned error”) instead of pixels or low-level sensory data. The learned transition model enables agents to predict the _consequences of actions_ before performing them, supporting safer and more data-efficient learning.\n    \n*   Both **Early Experience** and **DreamGym** build upon this concept but from complementary directions:\n    \n    *   [Agent Learning via Early Experience](https://arxiv.org/abs/2510.08558) by Zhang et al. (2025) treats predictive modeling as a _language-native world model_—learning state transitions and self-reflective rationales purely from text-based environments before RL.\n    *   [Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025) extends this into a formalized, **reasoning-based synthetic world model** (DreamGym) that produces internally consistent environment dynamics and synthetic rollouts. The experience model jointly generates next states and rewards under logical and semantic constraints, acting as a simulator for RL training with provable policy-transfer guarantees.\n\n**World models** enable agents to internalize the dynamics of their environments—predicting future states and rewards without constant external interaction. Originally introduced in [World Models](https://arxiv.org/abs/1803.10122) by Ha and Schmidhuber (2018), this approach decouples environment modeling from policy learning.\n\nA world model typically includes three components:\n\n1.  **Encoder** EϕEϕE\\_\\\\phi: maps raw observations ototo\\_t to latent states zt\\=Eϕ(ot)zt\\=Eϕ(ot)z\\_t = E\\_\\\\phi(o\\_t);\n2.  **Transition Model** TψTψT\\_\\\\psi: predicts future latent states zt+1\\=Tψ(zt,at)zt+1\\=Tψ(zt,at)z\\_{t+1} = T\\_\\\\psi(z\\_t, a\\_t);\n3.  **Decoder or Predictor** DωDωD\\_\\\\omega: reconstructs or evaluates outcomes from latent states, such as rt\\=Dω(zt)rt\\=Dω(zt)r\\_t = D\\_\\\\omega(z\\_t).\n\nBy learning these components, the agent builds an internal simulation of the environment. This simulation can then be used for _planning_, _exploration_, or _policy evaluation_ without direct execution—dramatically improving sample efficiency.\n\nIn web or tool-use domains, such models are extended to capture symbolic events (e.g., “clicked link,” “API returned error”) instead of pixels or low-level sensory data. The learned transition model enables agents to predict the _consequences of actions_ before performing them, supporting safer and more data-efficient learning.\n\nBoth **Early Experience** and **DreamGym** build upon this concept but from complementary directions:\n\n*   [Agent Learning via Early Experience](https://arxiv.org/abs/2510.08558) by Zhang et al. (2025) treats predictive modeling as a _language-native world model_—learning state transitions and self-reflective rationales purely from text-based environments before RL.\n*   [Scaling Agent Learning via Experience Synthesis](https://arxiv.org/abs/2511.03773) by Chen et al. (2025) extends this into a formalized, **reasoning-based synthetic world model** (DreamGym) that produces internally consistent environment dynamics and synthetic rollouts. The experience model jointly generates next states and rewards under logical and semantic constraints, acting as a simulator for RL training with provable policy-transfer guarantees.",
    "order": 47,
    "orderInChapter": 3,
    "difficulty": 5,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 531,
      "contentLength": 47525
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#world-modeling:-learning-predictive-environment-representations",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-temporal-credit-assignment-and-advantage-estimatio-48",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "title": "Temporal Credit Assignment and Advantage Estimation",
    "subtitle": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "contentHtml": "<ul>\n  <li>\n    <p>For agents operating across long horizons, one of the hardest problems in RL is <strong>credit assignment</strong>—determining which past actions led to current rewards. In typical short-horizon tasks, temporal difference (TD) learning suffices, but for multi-step web agents, delayed or sparse rewards make attribution challenging.</p>\n  </li>\n  <li>\n    <p>To address this, advantage-based and eligibility-trace methods extend standard RL updates:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-320-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5194\" style=\"width: 7.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1006.15em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5195\"><span class=\"msubsup\" id=\"MathJax-Span-5196\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5197\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5198\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5199\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5200\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5201\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5202\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5203\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-5204\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5205\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5206\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5207\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5208\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5209\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><mo>−</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-320\">A_t = R_t - V(s_t)</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-321-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5210\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5211\"><span class=\"msubsup\" id=\"MathJax-Span-5212\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5213\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5214\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-321\">A_t</script> is the <em>advantage</em> of taking action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-322-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5215\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5216\"><span class=\"msubsup\" id=\"MathJax-Span-5217\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5218\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5219\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-322\">a_t</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-323-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5220\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5221\"><span class=\"msubsup\" id=\"MathJax-Span-5222\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5223\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5224\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-323\">s_t</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-324-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5225\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5226\"><span class=\"msubsup\" id=\"MathJax-Span-5227\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5228\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5229\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-324\">R_t</script> is the cumulative discounted reward:</li>\n    </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-325-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5230\" style=\"width: 7.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.263em, 1005.99em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5231\"><span class=\"msubsup\" id=\"MathJax-Span-5232\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5233\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5234\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5235\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-5236\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-5237\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.159em;\"><span class=\"texatom\" id=\"MathJax-Span-5238\"><span class=\"mrow\" id=\"MathJax-Span-5239\"><span class=\"mi\" id=\"MathJax-Span-5240\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5241\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mi\" id=\"MathJax-Span-5242\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-5243\"><span class=\"mrow\" id=\"MathJax-Span-5244\"><span class=\"mi\" id=\"MathJax-Span-5245\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5246\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5247\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5248\"><span class=\"mrow\" id=\"MathJax-Span-5249\"><span class=\"mi\" id=\"MathJax-Span-5250\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5251\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mi\" id=\"MathJax-Span-5252\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5253\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5254\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5255\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi></mrow></munderover><msup><mi>γ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>−</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-325\">R_t = \\sum_{k=t}^{T} \\gamma^{k-t} r_k</script>\n  </li>\n  <li>\n    <p>For long episodes, this estimate is refined through <em>Generalized Advantage Estimation (GAE)</em> (<a href=\"https://arxiv.org/abs/1506.02438\">High-Dimensional Continuous Control Using Generalized Advantage Estimation</a> by Schulman et al., 2016):</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-326-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>A</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03BB;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B3;</mi><mi>&amp;#x03BB;</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mi>l</mi></msup><msub><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>l</mi></mrow></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5256\" style=\"width: 8.909em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.398em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.419em, 1007.4em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5257\"><span class=\"msubsup\" id=\"MathJax-Span-5258\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5259\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-5260\"><span class=\"mrow\" id=\"MathJax-Span-5261\"><span class=\"mo\" id=\"MathJax-Span-5262\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5263\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">λ</span><span class=\"mo\" id=\"MathJax-Span-5264\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5265\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5266\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-5267\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-5268\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-5269\"><span class=\"mrow\" id=\"MathJax-Span-5270\"><span class=\"mi\" id=\"MathJax-Span-5271\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5272\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-5273\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-5274\"><span class=\"mrow\" id=\"MathJax-Span-5275\"><span class=\"mi\" id=\"MathJax-Span-5276\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∞</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5277\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5278\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-5279\" style=\"font-family: STIXGeneral-Italic;\">λ</span><span class=\"msubsup\" id=\"MathJax-Span-5280\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-5281\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-5282\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5283\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5284\" style=\"font-family: STIXGeneral-Italic;\">δ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5285\"><span class=\"mrow\" id=\"MathJax-Span-5286\"><span class=\"mi\" id=\"MathJax-Span-5287\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5288\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-5289\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>A</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>λ</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">∞</mi></mrow></munderover><mo stretchy=\"false\">(</mo><mi>γ</mi><mi>λ</mi><msup><mo stretchy=\"false\">)</mo><mi>l</mi></msup><msub><mi>δ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>l</mi></mrow></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-326\">A_t^{(\\lambda)} = \\sum_{l=0}^{\\infty} (\\gamma \\lambda)^l \\delta_{t+l}</script>\n\n    <ul>\n      <li>with temporal errors <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-327-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5290\" style=\"width: 12.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1010.37em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5291\"><span class=\"msubsup\" id=\"MathJax-Span-5292\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5293\" style=\"font-family: STIXGeneral-Italic;\">δ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5294\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5295\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5296\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5297\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5298\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5299\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-5300\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-5301\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5302\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5303\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5304\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5305\"><span class=\"mrow\" id=\"MathJax-Span-5306\"><span class=\"mi\" id=\"MathJax-Span-5307\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5308\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-5309\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5310\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5311\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-5312\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5313\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5314\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5315\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5316\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5317\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>δ</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>γ</mi><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-327\">\\delta_t = r_t + \\gamma V(s_{t+1}) - V(s_t)</script>.</li>\n    </ul>\n  </li>\n  <li>\n    <p>GAE smooths advantage estimation over time, balancing bias and variance while maintaining stability even in multi-turn settings.</p>\n  </li>\n  <li>\n    <p>When integrated with <strong>process-wise rewards</strong> from reflective or synthetic environments, as proposed in Early Experience and DreamGym, GAE can assign proportional credit to intermediate reasoning steps or synthetic subgoals—reducing reward sparsity and improving credit flow through long-horizon trajectories.</p>\n  </li>\n</ul>\n<p>For agents operating across long horizons, one of the hardest problems in RL is <strong>credit assignment</strong>—determining which past actions led to current rewards. In typical short-horizon tasks, temporal difference (TD) learning suffices, but for multi-step web agents, delayed or sparse rewards make attribution challenging.</p>\n<p>To address this, advantage-based and eligibility-trace methods extend standard RL updates:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-321-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5210\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5211\"><span class=\"msubsup\" id=\"MathJax-Span-5212\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5213\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5214\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-321\">A_t</script> is the <em>advantage</em> of taking action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-322-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5215\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5216\"><span class=\"msubsup\" id=\"MathJax-Span-5217\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5218\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5219\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-322\">a_t</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-323-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5220\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5221\"><span class=\"msubsup\" id=\"MathJax-Span-5222\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5223\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5224\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-323\">s_t</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-324-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5225\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5226\"><span class=\"msubsup\" id=\"MathJax-Span-5227\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5228\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5229\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-324\">R_t</script> is the cumulative discounted reward:</li>\n    </ul>\n<p>For long episodes, this estimate is refined through <em>Generalized Advantage Estimation (GAE)</em> (<a href=\"https://arxiv.org/abs/1506.02438\">High-Dimensional Continuous Control Using Generalized Advantage Estimation</a> by Schulman et al., 2016):</p>\n<ul>\n      <li>with temporal errors <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-327-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5290\" style=\"width: 12.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1010.37em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5291\"><span class=\"msubsup\" id=\"MathJax-Span-5292\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5293\" style=\"font-family: STIXGeneral-Italic;\">δ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5294\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5295\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5296\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5297\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5298\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5299\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-5300\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-5301\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5302\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5303\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5304\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5305\"><span class=\"mrow\" id=\"MathJax-Span-5306\"><span class=\"mi\" id=\"MathJax-Span-5307\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5308\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-5309\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5310\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5311\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-5312\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5313\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5314\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5315\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5316\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5317\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>δ</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>γ</mi><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-327\">\\delta_t = r_t + \\gamma V(s_{t+1}) - V(s_t)</script>.</li>\n    </ul>\n<p>GAE smooths advantage estimation over time, balancing bias and variance while maintaining stability even in multi-turn settings.</p>\n<p>When integrated with <strong>process-wise rewards</strong> from reflective or synthetic environments, as proposed in Early Experience and DreamGym, GAE can assign proportional credit to intermediate reasoning steps or synthetic subgoals—reducing reward sparsity and improving credit flow through long-horizon trajectories.</p>",
    "contentMarkdown": "*   For agents operating across long horizons, one of the hardest problems in RL is **credit assignment**—determining which past actions led to current rewards. In typical short-horizon tasks, temporal difference (TD) learning suffices, but for multi-step web agents, delayed or sparse rewards make attribution challenging.\n    \n*   To address this, advantage-based and eligibility-trace methods extend standard RL updates:\n    \n    At\\=Rt−V(st)At\\=Rt−V(st)\n    \n    A\\_t = R\\_t - V(s\\_t)\n    \n    *   where AtAtA\\_t is the _advantage_ of taking action atata\\_t in state ststs\\_t, and RtRtR\\_t is the cumulative discounted reward:\n    \n    Rt\\=∑k\\=tTγk−trkRt\\=∑k\\=tTγk−trk\n    \n    R\\_t = \\\\sum\\_{k=t}^{T} \\\\gamma^{k-t} r\\_k\n*   For long episodes, this estimate is refined through _Generalized Advantage Estimation (GAE)_ ([High-Dimensional Continuous Control Using Generalized Advantage Estimation](https://arxiv.org/abs/1506.02438) by Schulman et al., 2016):\n    \n    A(λ)t\\=∑l\\=0∞(γλ)lδt+lAt(λ)\\=∑l\\=0∞(γλ)lδt+l\n    \n    A\\_t^{(\\\\lambda)} = \\\\sum\\_{l=0}^{\\\\infty} (\\\\gamma \\\\lambda)^l \\\\delta\\_{t+l}\n    *   with temporal errors δt\\=rt+γV(st+1)−V(st)δt\\=rt+γV(st+1)−V(st)\\\\delta\\_t = r\\_t + \\\\gamma V(s\\_{t+1}) - V(s\\_t).\n*   GAE smooths advantage estimation over time, balancing bias and variance while maintaining stability even in multi-turn settings.\n    \n*   When integrated with **process-wise rewards** from reflective or synthetic environments, as proposed in Early Experience and DreamGym, GAE can assign proportional credit to intermediate reasoning steps or synthetic subgoals—reducing reward sparsity and improving credit flow through long-horizon trajectories.\n    \n\nFor agents operating across long horizons, one of the hardest problems in RL is **credit assignment**—determining which past actions led to current rewards. In typical short-horizon tasks, temporal difference (TD) learning suffices, but for multi-step web agents, delayed or sparse rewards make attribution challenging.\n\nTo address this, advantage-based and eligibility-trace methods extend standard RL updates:\n\n*   where AtAtA\\_t is the _advantage_ of taking action atata\\_t in state ststs\\_t, and RtRtR\\_t is the cumulative discounted reward:\n\nFor long episodes, this estimate is refined through _Generalized Advantage Estimation (GAE)_ ([High-Dimensional Continuous Control Using Generalized Advantage Estimation](https://arxiv.org/abs/1506.02438) by Schulman et al., 2016):\n\n*   with temporal errors δt\\=rt+γV(st+1)−V(st)δt\\=rt+γV(st+1)−V(st)\\\\delta\\_t = r\\_t + \\\\gamma V(s\\_{t+1}) - V(s\\_t).\n\nGAE smooths advantage estimation over time, balancing bias and variance while maintaining stability even in multi-turn settings.\n\nWhen integrated with **process-wise rewards** from reflective or synthetic environments, as proposed in Early Experience and DreamGym, GAE can assign proportional credit to intermediate reasoning steps or synthetic subgoals—reducing reward sparsity and improving credit flow through long-horizon trajectories.",
    "order": 48,
    "orderInChapter": 4,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 356,
      "contentLength": 50846
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#temporal-credit-assignment-and-advantage-estimation",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-hierarchical-reinforcement-learning-hrl-49",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "title": "Hierarchical Reinforcement Learning (HRL)",
    "subtitle": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Hierarchical RL (HRL)</strong> structures policies across multiple temporal scales—dividing tasks into subtasks, each with its own sub-policy and local reward. This approach mirrors human task decomposition (e.g., “open browser <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-328-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5318\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5319\"><span class=\"mo\" id=\"MathJax-Span-5320\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-328\">\\rightarrow</script> navigate <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-329-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5321\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5322\"><span class=\"mo\" id=\"MathJax-Span-5323\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-329\">\\rightarrow</script> extract data <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-330-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5324\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5325\"><span class=\"mo\" id=\"MathJax-Span-5326\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-330\">\\rightarrow</script> summarize results”).</p>\n  </li>\n  <li>\n    <p>Formally, HRL decomposes the policy into two levels:</p>\n\n    <ul>\n      <li><strong>High-Level (Manager) Policy</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-331-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>H</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>g</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5327\" style=\"width: 4.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.596em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.54em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5328\"><span class=\"msubsup\" id=\"MathJax-Span-5329\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5330\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5331\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">H<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5332\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5333\" style=\"font-family: STIXGeneral-Italic;\">g</span><span class=\"mo\" id=\"MathJax-Span-5334\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-5335\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-5336\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>H</mi></msub><mo stretchy=\"false\">(</mo><mi>g</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-331\">\\pi_H(g \\mid s)</script>: selects subgoals <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-332-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5337\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5338\"><span class=\"mi\" id=\"MathJax-Span-5339\" style=\"font-family: STIXGeneral-Italic;\">g</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>g</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-332\">g</script>;</li>\n      <li><strong>Low-Level (Worker) Policy</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-333-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>L</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>g</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5340\" style=\"width: 5.211em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.326em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1004.27em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5341\"><span class=\"msubsup\" id=\"MathJax-Span-5342\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5343\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5344\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5345\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5346\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-5347\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-5348\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-5349\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5350\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">g</span><span class=\"mo\" id=\"MathJax-Span-5351\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>L</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo>,</mo><mi>g</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-333\">\\pi_L(a \\mid s, g)</script>: executes primitive actions to achieve <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-334-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5352\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5353\"><span class=\"mi\" id=\"MathJax-Span-5354\" style=\"font-family: STIXGeneral-Italic;\">g</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>g</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-334\">g</script>.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The optimization objective becomes:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-335-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mi>H</mi></msub><mo>,</mo><msub><mi>&amp;#x03C0;</mi><mi>L</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow><mo>[</mo><mrow><munder><mo>&amp;#x2211;</mo><mi>t</mi></munder><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>L</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>+</mo><mi>&amp;#x03BB;</mi><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>H</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5355\" style=\"width: 17.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.951em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1014.64em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5356\"><span class=\"mi\" id=\"MathJax-Span-5357\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5358\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5359\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5360\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5361\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">H<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5362\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5363\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5364\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5365\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5366\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5367\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-5368\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-5369\"><span class=\"mi\" id=\"MathJax-Span-5370\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span class=\"mrow\" id=\"MathJax-Span-5371\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-5372\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-5373\"><span class=\"munderover\" id=\"MathJax-Span-5374\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-5375\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5376\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5377\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5378\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5379\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-5380\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-5381\"><span class=\"mo\" id=\"MathJax-Span-5382\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5383\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5384\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.94em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5385\"><span class=\"mrow\" id=\"MathJax-Span-5386\"><span class=\"mo\" id=\"MathJax-Span-5387\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5388\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5389\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5390\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5391\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-5392\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">λ</span><span class=\"msubsup\" id=\"MathJax-Span-5393\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5394\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5395\"><span class=\"mrow\" id=\"MathJax-Span-5396\"><span class=\"mo\" id=\"MathJax-Span-5397\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5398\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">H<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5399\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5400\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-5401\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-5402\"><span class=\"mo\" id=\"MathJax-Span-5403\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5404\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><msub><mi>π</mi><mi>H</mi></msub><mo>,</mo><msub><mi>π</mi><mi>L</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow><mo>[</mo><mrow><munder><mo>∑</mo><mi>t</mi></munder><msup><mi>γ</mi><mi>t</mi></msup><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>L</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>+</mo><mi>λ</mi><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>H</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-335\">J(\\pi_H, \\pi_L) = \\mathbb{E}\\left[\\sum_t \\gamma^t \\big(r_t^{(L)} + \\lambda r_t^{(H)}\\big)\\right]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-336-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>L</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5405\" style=\"width: 1.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.41em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5406\"><span class=\"msubsup\" id=\"MathJax-Span-5407\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5408\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.94em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5409\"><span class=\"mrow\" id=\"MathJax-Span-5410\"><span class=\"mo\" id=\"MathJax-Span-5411\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5412\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5413\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5414\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>L</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-336\">r_t^{(L)}</script> is the low-level reward for subgoal progress and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-337-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>H</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5415\" style=\"width: 1.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.57em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5416\"><span class=\"msubsup\" id=\"MathJax-Span-5417\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5418\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5419\"><span class=\"mrow\" id=\"MathJax-Span-5420\"><span class=\"mo\" id=\"MathJax-Span-5421\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5422\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">H<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5423\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5424\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>H</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-337\">r_t^{(H)}</script> captures high-level task achievement.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Recent frameworks like <a href=\"https://arxiv.org/abs/2406.04151\">AgentGym</a> and <a href=\"https://arxiv.org/abs/2410.19609\">OpenWebVoyager</a> employ hierarchical structures to separate reasoning and action planning layers. The high-level module reasons in natural language or symbolic goals, while the low-level policy executes API calls or UI actions. This separation improves both interpretability and modularity, enabling transfer learning across task domains.</p>\n  </li>\n  <li>\n    <p>Early Experience aligns naturally with hierarchical RL by pretraining the “low-level” policy on predictive transitions (world modeling) and the “high-level” reflection policy on action rationales. DreamGym later merges both by training high- and low-level policies concurrently in a synthetic hierarchical environment, simulating multi-stage reasoning chains.</p>\n  </li>\n</ul>\n<p><strong>Hierarchical RL (HRL)</strong> structures policies across multiple temporal scales—dividing tasks into subtasks, each with its own sub-policy and local reward. This approach mirrors human task decomposition (e.g., “open browser <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-328-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5318\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5319\"><span class=\"mo\" id=\"MathJax-Span-5320\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-328\">\\rightarrow</script> navigate <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-329-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5321\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5322\"><span class=\"mo\" id=\"MathJax-Span-5323\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-329\">\\rightarrow</script> extract data <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-330-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5324\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5325\"><span class=\"mo\" id=\"MathJax-Span-5326\" style=\"font-family: STIXGeneral-Regular;\">→</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">→</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-330\">\\rightarrow</script> summarize results”).</p>\n<p>Formally, HRL decomposes the policy into two levels:</p>\n<ul>\n      <li><strong>High-Level (Manager) Policy</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-331-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>H</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>g</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5327\" style=\"width: 4.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.596em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.54em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5328\"><span class=\"msubsup\" id=\"MathJax-Span-5329\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5330\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5331\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">H<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5332\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5333\" style=\"font-family: STIXGeneral-Italic;\">g</span><span class=\"mo\" id=\"MathJax-Span-5334\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-5335\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-5336\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>H</mi></msub><mo stretchy=\"false\">(</mo><mi>g</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-331\">\\pi_H(g \\mid s)</script>: selects subgoals <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-332-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5337\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5338\"><span class=\"mi\" id=\"MathJax-Span-5339\" style=\"font-family: STIXGeneral-Italic;\">g</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>g</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-332\">g</script>;</li>\n      <li><strong>Low-Level (Worker) Policy</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-333-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>L</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>g</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5340\" style=\"width: 5.211em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.326em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1004.27em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5341\"><span class=\"msubsup\" id=\"MathJax-Span-5342\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5343\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5344\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5345\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5346\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-5347\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∣</span><span class=\"mi\" id=\"MathJax-Span-5348\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-5349\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5350\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">g</span><span class=\"mo\" id=\"MathJax-Span-5351\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>L</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo>,</mo><mi>g</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-333\">\\pi_L(a \\mid s, g)</script>: executes primitive actions to achieve <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-334-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5352\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5353\"><span class=\"mi\" id=\"MathJax-Span-5354\" style=\"font-family: STIXGeneral-Italic;\">g</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>g</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-334\">g</script>.</li>\n    </ul>\n<p>The optimization objective becomes:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-336-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>L</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5405\" style=\"width: 1.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.41em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5406\"><span class=\"msubsup\" id=\"MathJax-Span-5407\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5408\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.94em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5409\"><span class=\"mrow\" id=\"MathJax-Span-5410\"><span class=\"mo\" id=\"MathJax-Span-5411\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5412\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5413\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5414\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>L</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-336\">r_t^{(L)}</script> is the low-level reward for subgoal progress and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-337-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>H</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5415\" style=\"width: 1.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.57em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5416\"><span class=\"msubsup\" id=\"MathJax-Span-5417\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5418\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.273em, -999.997em); top: -4.477em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5419\"><span class=\"mrow\" id=\"MathJax-Span-5420\"><span class=\"mo\" id=\"MathJax-Span-5421\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5422\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">H<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5423\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5424\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>H</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-337\">r_t^{(H)}</script> captures high-level task achievement.</li>\n    </ul>\n<p>Recent frameworks like <a href=\"https://arxiv.org/abs/2406.04151\">AgentGym</a> and <a href=\"https://arxiv.org/abs/2410.19609\">OpenWebVoyager</a> employ hierarchical structures to separate reasoning and action planning layers. The high-level module reasons in natural language or symbolic goals, while the low-level policy executes API calls or UI actions. This separation improves both interpretability and modularity, enabling transfer learning across task domains.</p>\n<p>Early Experience aligns naturally with hierarchical RL by pretraining the “low-level” policy on predictive transitions (world modeling) and the “high-level” reflection policy on action rationales. DreamGym later merges both by training high- and low-level policies concurrently in a synthetic hierarchical environment, simulating multi-stage reasoning chains.</p>",
    "contentMarkdown": "*   **Hierarchical RL (HRL)** structures policies across multiple temporal scales—dividing tasks into subtasks, each with its own sub-policy and local reward. This approach mirrors human task decomposition (e.g., “open browser →→\\\\rightarrow navigate →→\\\\rightarrow extract data →→\\\\rightarrow summarize results”).\n    \n*   Formally, HRL decomposes the policy into two levels:\n    \n    *   **High-Level (Manager) Policy** πH(g∣s)πH(g∣s)\\\\pi\\_H(g \\\\mid s): selects subgoals ggg;\n    *   **Low-Level (Worker) Policy** πL(a∣s,g)πL(a∣s,g)\\\\pi\\_L(a \\\\mid s, g): executes primitive actions to achieve ggg.\n*   The optimization objective becomes:\n    \n    J(πH,πL)\\=𝔼\\[∑tγt(r(L)t+λr(H)t)\\]J(πH,πL)\\=E\\[∑tγt(rt(L)+λrt(H))\\]\n    \n    J(\\\\pi\\_H, \\\\pi\\_L) = \\\\mathbb{E}\\\\left\\[\\\\sum\\_t \\\\gamma^t \\\\big(r\\_t^{(L)} + \\\\lambda r\\_t^{(H)}\\\\big)\\\\right\\]\n    *   where r(L)trt(L)r\\_t^{(L)} is the low-level reward for subgoal progress and r(H)trt(H)r\\_t^{(H)} captures high-level task achievement.\n*   Recent frameworks like [AgentGym](https://arxiv.org/abs/2406.04151) and [OpenWebVoyager](https://arxiv.org/abs/2410.19609) employ hierarchical structures to separate reasoning and action planning layers. The high-level module reasons in natural language or symbolic goals, while the low-level policy executes API calls or UI actions. This separation improves both interpretability and modularity, enabling transfer learning across task domains.\n    \n*   Early Experience aligns naturally with hierarchical RL by pretraining the “low-level” policy on predictive transitions (world modeling) and the “high-level” reflection policy on action rationales. DreamGym later merges both by training high- and low-level policies concurrently in a synthetic hierarchical environment, simulating multi-stage reasoning chains.\n    \n\n**Hierarchical RL (HRL)** structures policies across multiple temporal scales—dividing tasks into subtasks, each with its own sub-policy and local reward. This approach mirrors human task decomposition (e.g., “open browser →→\\\\rightarrow navigate →→\\\\rightarrow extract data →→\\\\rightarrow summarize results”).\n\nFormally, HRL decomposes the policy into two levels:\n\n*   **High-Level (Manager) Policy** πH(g∣s)πH(g∣s)\\\\pi\\_H(g \\\\mid s): selects subgoals ggg;\n*   **Low-Level (Worker) Policy** πL(a∣s,g)πL(a∣s,g)\\\\pi\\_L(a \\\\mid s, g): executes primitive actions to achieve ggg.\n\nThe optimization objective becomes:\n\n*   where r(L)trt(L)r\\_t^{(L)} is the low-level reward for subgoal progress and r(H)trt(H)r\\_t^{(H)} captures high-level task achievement.\n\nRecent frameworks like [AgentGym](https://arxiv.org/abs/2406.04151) and [OpenWebVoyager](https://arxiv.org/abs/2410.19609) employ hierarchical structures to separate reasoning and action planning layers. The high-level module reasons in natural language or symbolic goals, while the low-level policy executes API calls or UI actions. This separation improves both interpretability and modularity, enabling transfer learning across task domains.\n\nEarly Experience aligns naturally with hierarchical RL by pretraining the “low-level” policy on predictive transitions (world modeling) and the “high-level” reflection policy on action rationales. DreamGym later merges both by training high- and low-level policies concurrently in a synthetic hierarchical environment, simulating multi-stage reasoning chains.",
    "order": 49,
    "orderInChapter": 5,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "optimization",
      "transfer learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 381,
      "contentLength": 50724
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#hierarchical-reinforcement-learning-(hrl)",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-memory-augmented-reinforcement-learning-marl-50",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "title": "Memory-Augmented Reinforcement Learning (MARL)",
    "subtitle": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "contentHtml": "<ul>\n  <li>\n    <p>Memory-augmented RL integrates explicit memory buffers or retrieval mechanisms into the learning loop, enabling agents to recall past experiences dynamically. Such architectures can be viewed as hybrids between world models and traditional replay buffers.</p>\n  </li>\n  <li>\n    <p>A general MARL setup maintains:</p>\n\n    <ul>\n      <li><strong>Episodic Memory</strong> (M_e): stores sequences of (state, action, reward) tuples for reuse.</li>\n      <li><strong>Semantic Memory</strong> (M_s): aggregates long-term knowledge, such as patterns in tool success or error likelihoods.</li>\n      <li><strong>Retrieval Policy</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-338-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>M</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5425\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.2em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5426\"><span class=\"msubsup\" id=\"MathJax-Span-5427\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5428\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5429\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>M</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-338\">\\pi_M</script>: determines which memories to recall based on current context.</li>\n    </ul>\n  </li>\n  <li>\n    <p>A key application is <em>retrieval-augmented decision-making</em>, where the policy is conditioned on both current observation and retrieved experiences:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-339-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>s</mi><mo>,</mo><mi>M</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>f</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mtext>Retrieve</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>M</mi><mo>,</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5430\" style=\"width: 15.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.076em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1013.02em, 2.867em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5431\"><span class=\"mi\" id=\"MathJax-Span-5432\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5433\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5434\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"texatom\" id=\"MathJax-Span-5435\"><span class=\"mrow\" id=\"MathJax-Span-5436\"><span class=\"mo\" id=\"MathJax-Span-5437\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-5438\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5439\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5440\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5441\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5442\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5443\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5444\" style=\"font-family: STIXGeneral-Italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-5445\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5446\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5447\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5448\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-5449\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">Retrieve</span><span class=\"mo\" id=\"MathJax-Span-5450\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5451\" style=\"font-family: STIXGeneral-Italic;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5452\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5453\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">s</span><span class=\"mo\" id=\"MathJax-Span-5454\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5455\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>π</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>s</mi><mo>,</mo><mi>M</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mtext>Retrieve</mtext><mo stretchy=\"false\">(</mo><mi>M</mi><mo>,</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-339\">\\pi(a|s, M) = f_\\theta(s, \\text{Retrieve}(M, s))</script>\n  </li>\n  <li>\n    <p>This mechanism aligns conceptually with retrieval-augmented generation (RAG) but applied to RL: instead of retrieving documents, the agent retrieves <em>past trajectories</em> that resemble the current state.</p>\n  </li>\n  <li>\n    <p>DreamGym introduces an analogous process in the synthetic domain: the <strong>experience model</strong> retrieves and recombines previously generated synthetic rollouts to compose new simulated experiences that maximize policy coverage. This is effectively <em>synthetic memory replay</em>—training RL agents with a scalable, dynamically generated memory buffer of plausible state–action–reward transitions.</p>\n  </li>\n</ul>\n<p>Memory-augmented RL integrates explicit memory buffers or retrieval mechanisms into the learning loop, enabling agents to recall past experiences dynamically. Such architectures can be viewed as hybrids between world models and traditional replay buffers.</p>\n<p>A general MARL setup maintains:</p>\n<ul>\n      <li><strong>Episodic Memory</strong> (M_e): stores sequences of (state, action, reward) tuples for reuse.</li>\n      <li><strong>Semantic Memory</strong> (M_s): aggregates long-term knowledge, such as patterns in tool success or error likelihoods.</li>\n      <li><strong>Retrieval Policy</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-338-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>M</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5425\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.2em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5426\"><span class=\"msubsup\" id=\"MathJax-Span-5427\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5428\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5429\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>π</mi><mi>M</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-338\">\\pi_M</script>: determines which memories to recall based on current context.</li>\n    </ul>\n<p>A key application is <em>retrieval-augmented decision-making</em>, where the policy is conditioned on both current observation and retrieved experiences:</p>\n<p>This mechanism aligns conceptually with retrieval-augmented generation (RAG) but applied to RL: instead of retrieving documents, the agent retrieves <em>past trajectories</em> that resemble the current state.</p>\n<p>DreamGym introduces an analogous process in the synthetic domain: the <strong>experience model</strong> retrieves and recombines previously generated synthetic rollouts to compose new simulated experiences that maximize policy coverage. This is effectively <em>synthetic memory replay</em>—training RL agents with a scalable, dynamically generated memory buffer of plausible state–action–reward transitions.</p>",
    "contentMarkdown": "*   Memory-augmented RL integrates explicit memory buffers or retrieval mechanisms into the learning loop, enabling agents to recall past experiences dynamically. Such architectures can be viewed as hybrids between world models and traditional replay buffers.\n    \n*   A general MARL setup maintains:\n    \n    *   **Episodic Memory** (M\\_e): stores sequences of (state, action, reward) tuples for reuse.\n    *   **Semantic Memory** (M\\_s): aggregates long-term knowledge, such as patterns in tool success or error likelihoods.\n    *   **Retrieval Policy** πMπM\\\\pi\\_M: determines which memories to recall based on current context.\n*   A key application is _retrieval-augmented decision-making_, where the policy is conditioned on both current observation and retrieved experiences:\n    \n    π(a|s,M)\\=fθ(s,Retrieve(M,s))π(a|s,M)\\=fθ(s,Retrieve(M,s))\n    \n    \\\\pi(a|s, M) = f\\_\\\\theta(s, \\\\text{Retrieve}(M, s))\n*   This mechanism aligns conceptually with retrieval-augmented generation (RAG) but applied to RL: instead of retrieving documents, the agent retrieves _past trajectories_ that resemble the current state.\n    \n*   DreamGym introduces an analogous process in the synthetic domain: the **experience model** retrieves and recombines previously generated synthetic rollouts to compose new simulated experiences that maximize policy coverage. This is effectively _synthetic memory replay_—training RL agents with a scalable, dynamically generated memory buffer of plausible state–action–reward transitions.\n    \n\nMemory-augmented RL integrates explicit memory buffers or retrieval mechanisms into the learning loop, enabling agents to recall past experiences dynamically. Such architectures can be viewed as hybrids between world models and traditional replay buffers.\n\nA general MARL setup maintains:\n\n*   **Episodic Memory** (M\\_e): stores sequences of (state, action, reward) tuples for reuse.\n*   **Semantic Memory** (M\\_s): aggregates long-term knowledge, such as patterns in tool success or error likelihoods.\n*   **Retrieval Policy** πMπM\\\\pi\\_M: determines which memories to recall based on current context.\n\nA key application is _retrieval-augmented decision-making_, where the policy is conditioned on both current observation and retrieved experiences:\n\nThis mechanism aligns conceptually with retrieval-augmented generation (RAG) but applied to RL: instead of retrieving documents, the agent retrieves _past trajectories_ that resemble the current state.\n\nDreamGym introduces an analogous process in the synthetic domain: the **experience model** retrieves and recombines previously generated synthetic rollouts to compose new simulated experiences that maximize policy coverage. This is effectively _synthetic memory replay_—training RL agents with a scalable, dynamically generated memory buffer of plausible state–action–reward transitions.",
    "order": 50,
    "orderInChapter": 6,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 356,
      "contentLength": 12342
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#memory-augmented-reinforcement-learning-(marl)",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-long-horizon-planning-via-latent-rollouts-and-mode-51",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "title": "Long-Horizon Planning Via Latent Rollouts and Model Predictive Control",
    "subtitle": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "contentHtml": "<ul>\n  <li>\n    <p>An emerging frontier in long-horizon RL for agents is <strong>Model Predictive Control (MPC)</strong> using latent world models. Instead of sampling actual environment steps, the agent “imagines” future rollouts within its learned model before committing to an action.</p>\n  </li>\n  <li>\n    <p>Formally, for a world model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-340-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5456\" style=\"width: 4.482em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.701em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.65em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5457\"><span class=\"msubsup\" id=\"MathJax-Span-5458\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5459\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"mi\" id=\"MathJax-Span-5460\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5461\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5462\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5463\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5464\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5465\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5466\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5467\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5468\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5469\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>T</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-340\">T_\\psi(z_t, a_t)</script>, MPC selects:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-341-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>a</mi><mi>t</mi><mo>&amp;#x2217;</mo></msubsup><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>H</mi></mrow></msub></mrow></munder><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>H</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mi>t</mi></mrow></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>r</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>k</mi></msub><mo>,</mo><msub><mi>a</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5470\" style=\"width: 18.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 15.211em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1014.9em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5471\"><span class=\"msubsup\" id=\"MathJax-Span-5472\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5473\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.47em, 4.169em, -999.997em); top: -4.32em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-5474\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∗</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5475\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5476\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-5477\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-5478\"></span><span class=\"munderover\" id=\"MathJax-Span-5479\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.919em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0.576em;\"><span class=\"mo\" id=\"MathJax-Span-5480\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1002.92em, 4.378em, -999.997em); top: -3.331em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5481\"><span class=\"mrow\" id=\"MathJax-Span-5482\"><span class=\"msubsup\" id=\"MathJax-Span-5483\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5484\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5485\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5486\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-5487\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">…</span><span class=\"mo\" id=\"MathJax-Span-5488\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5489\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5490\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5491\"><span class=\"mrow\" id=\"MathJax-Span-5492\"><span class=\"mi\" id=\"MathJax-Span-5493\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5494\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-5495\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">H<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-5496\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-5497\"><span class=\"mi\" id=\"MathJax-Span-5498\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span class=\"mrow\" id=\"MathJax-Span-5499\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-5500\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-5501\"><span class=\"munderover\" id=\"MathJax-Span-5502\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-5503\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.159em;\"><span class=\"texatom\" id=\"MathJax-Span-5504\"><span class=\"mrow\" id=\"MathJax-Span-5505\"><span class=\"mi\" id=\"MathJax-Span-5506\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5507\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mi\" id=\"MathJax-Span-5508\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1001.25em, 4.221em, -999.997em); top: -5.206em; left: 0.055em;\"><span class=\"texatom\" id=\"MathJax-Span-5509\"><span class=\"mrow\" id=\"MathJax-Span-5510\"><span class=\"mi\" id=\"MathJax-Span-5511\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5512\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-5513\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">H<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5514\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5515\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5516\"><span class=\"mrow\" id=\"MathJax-Span-5517\"><span class=\"mi\" id=\"MathJax-Span-5518\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5519\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mi\" id=\"MathJax-Span-5520\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-5521\"><span class=\"mrow\" id=\"MathJax-Span-5522\"><span class=\"munderover\" id=\"MathJax-Span-5523\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5524\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5525\" style=\"font-family: STIXGeneral-Regular;\">̂&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5526\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5527\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5528\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5529\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5530\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5531\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5532\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5533\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5534\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-5535\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>a</mi><mi>t</mi><mo>∗</mo></msubsup><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>H</mi></mrow></msub></mrow></munder><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>H</mi></mrow></munderover><msup><mi>γ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>−</mo><mi>t</mi></mrow></msup><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>r</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo>,</mo><msub><mi>a</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-341\">a_t^* = \\arg\\max_{a_t, \\dots, a_{t+H}} \\mathbb{E}\\left[\\sum_{k=t}^{t+H} \\gamma^{k-t} \\hat{r}(z_k, a_k)\\right]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-342-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>r</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5536\" style=\"width: 0.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1000.42em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5537\"><span class=\"texatom\" id=\"MathJax-Span-5538\"><span class=\"mrow\" id=\"MathJax-Span-5539\"><span class=\"munderover\" id=\"MathJax-Span-5540\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5541\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5542\" style=\"font-family: STIXGeneral-Regular;\">̂&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>r</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-342\">\\hat{r}</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-343-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5543\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5544\"><span class=\"msubsup\" id=\"MathJax-Span-5545\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5546\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5547\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-343\">z_k</script> are predicted rewards and states over a planning horizon <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-344-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5548\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5549\"><span class=\"mi\" id=\"MathJax-Span-5550\" style=\"font-family: STIXGeneral-Italic;\">H<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>H</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-344\">H</script>.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This technique allows for deep <em>internal simulation</em>, enabling efficient planning without costly real-environment interaction. In digital domains, MPC-like inference supports fast adaptation to new web layouts or API responses, with each rollout grounded by the world model’s predictions.</p>\n  </li>\n  <li>\n    <p>DreamGym formalizes this concept at scale: the synthetic reasoning environment <em>is itself</em> a controllable world model, allowing agents to perform model-predictive optimization over <em>generated latent rollouts</em>. These latent simulations substitute for environment sampling, providing a unified training–planning–evaluation loop that mirrors real-world behavior while remaining computationally tractable.</p>\n  </li>\n</ul>\n<p>An emerging frontier in long-horizon RL for agents is <strong>Model Predictive Control (MPC)</strong> using latent world models. Instead of sampling actual environment steps, the agent “imagines” future rollouts within its learned model before committing to an action.</p>\n<p>Formally, for a world model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-340-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5456\" style=\"width: 4.482em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.701em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.65em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5457\"><span class=\"msubsup\" id=\"MathJax-Span-5458\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5459\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"mi\" id=\"MathJax-Span-5460\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">ψ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5461\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5462\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5463\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5464\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5465\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5466\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5467\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5468\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5469\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>T</mi><mi>ψ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-340\">T_\\psi(z_t, a_t)</script>, MPC selects:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-342-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>r</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5536\" style=\"width: 0.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1000.42em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5537\"><span class=\"texatom\" id=\"MathJax-Span-5538\"><span class=\"mrow\" id=\"MathJax-Span-5539\"><span class=\"munderover\" id=\"MathJax-Span-5540\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5541\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5542\" style=\"font-family: STIXGeneral-Regular;\">̂&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>r</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-342\">\\hat{r}</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-343-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5543\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5544\"><span class=\"msubsup\" id=\"MathJax-Span-5545\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5546\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5547\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-343\">z_k</script> are predicted rewards and states over a planning horizon <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-344-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5548\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5549\"><span class=\"mi\" id=\"MathJax-Span-5550\" style=\"font-family: STIXGeneral-Italic;\">H<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>H</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-344\">H</script>.</li>\n    </ul>\n<p>This technique allows for deep <em>internal simulation</em>, enabling efficient planning without costly real-environment interaction. In digital domains, MPC-like inference supports fast adaptation to new web layouts or API responses, with each rollout grounded by the world model’s predictions.</p>\n<p>DreamGym formalizes this concept at scale: the synthetic reasoning environment <em>is itself</em> a controllable world model, allowing agents to perform model-predictive optimization over <em>generated latent rollouts</em>. These latent simulations substitute for environment sampling, providing a unified training–planning–evaluation loop that mirrors real-world behavior while remaining computationally tractable.</p>",
    "contentMarkdown": "*   An emerging frontier in long-horizon RL for agents is **Model Predictive Control (MPC)** using latent world models. Instead of sampling actual environment steps, the agent “imagines” future rollouts within its learned model before committing to an action.\n    \n*   Formally, for a world model Tψ(zt,at)Tψ(zt,at)T\\_\\\\psi(z\\_t, a\\_t), MPC selects:\n    \n    a∗t\\=argmaxat,…,at+H𝔼\\[∑k\\=tt+Hγk−tr̂ (zk,ak)\\]at∗\\=arg⁡maxat,…,at+HE\\[∑k\\=tt+Hγk−tr^(zk,ak)\\]\n    \n    a\\_t^\\* = \\\\arg\\\\max\\_{a\\_t, \\\\dots, a\\_{t+H}} \\\\mathbb{E}\\\\left\\[\\\\sum\\_{k=t}^{t+H} \\\\gamma^{k-t} \\\\hat{r}(z\\_k, a\\_k)\\\\right\\]\n    *   where r̂ r^\\\\hat{r} and zkzkz\\_k are predicted rewards and states over a planning horizon HHH.\n*   This technique allows for deep _internal simulation_, enabling efficient planning without costly real-environment interaction. In digital domains, MPC-like inference supports fast adaptation to new web layouts or API responses, with each rollout grounded by the world model’s predictions.\n    \n*   DreamGym formalizes this concept at scale: the synthetic reasoning environment _is itself_ a controllable world model, allowing agents to perform model-predictive optimization over _generated latent rollouts_. These latent simulations substitute for environment sampling, providing a unified training–planning–evaluation loop that mirrors real-world behavior while remaining computationally tractable.\n    \n\nAn emerging frontier in long-horizon RL for agents is **Model Predictive Control (MPC)** using latent world models. Instead of sampling actual environment steps, the agent “imagines” future rollouts within its learned model before committing to an action.\n\nFormally, for a world model Tψ(zt,at)Tψ(zt,at)T\\_\\\\psi(z\\_t, a\\_t), MPC selects:\n\n*   where r̂ r^\\\\hat{r} and zkzkz\\_k are predicted rewards and states over a planning horizon HHH.\n\nThis technique allows for deep _internal simulation_, enabling efficient planning without costly real-environment interaction. In digital domains, MPC-like inference supports fast adaptation to new web layouts or API responses, with each rollout grounded by the world model’s predictions.\n\nDreamGym formalizes this concept at scale: the synthetic reasoning environment _is itself_ a controllable world model, allowing agents to perform model-predictive optimization over _generated latent rollouts_. These latent simulations substitute for environment sampling, providing a unified training–planning–evaluation loop that mirrors real-world behavior while remaining computationally tractable.",
    "order": 51,
    "orderInChapter": 7,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 307,
      "contentLength": 36736
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#long-horizon-planning-via-latent-rollouts-and-model-predictive-control",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-takeaways-52",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "title": "Takeaways",
    "subtitle": "Memory, World Modeling, and Long-Horizon Credit Assignment",
    "contentHtml": "<ul>\n  <li>\n    <p>Memory, world modeling, and long-horizon credit assignment form the temporal backbone of agentic RL. Together, they enable continuity, foresight, and adaptive reasoning—core attributes for any system expected to function autonomously across diverse and evolving environments.</p>\n\n    <ul>\n      <li><strong>Memory systems</strong> preserve context and history across decisions.</li>\n      <li><strong>World models</strong> internalize environmental dynamics, allowing for simulated reasoning.</li>\n      <li><strong>Credit assignment mechanisms</strong> trace responsibility across deep trajectories.</li>\n      <li><strong>Hierarchical policies</strong> decompose complex workflows into interpretable submodules.</li>\n      <li><strong>Model predictive control</strong> enables safe, efficient long-horizon planning.</li>\n    </ul>\n  </li>\n  <li>\n    <p>When augmented with pre-RL <strong>Early Experience</strong> and scalable synthetic environments such as <strong>DreamGym</strong>, agents gain not only temporal coherence but also <em>generative foresight</em>: the ability to imagine, rehearse, and improve actions before executing them—effectively bridging the gap between reactive learning and proactive intelligence.</p>\n  </li>\n</ul>\n<p>Memory, world modeling, and long-horizon credit assignment form the temporal backbone of agentic RL. Together, they enable continuity, foresight, and adaptive reasoning—core attributes for any system expected to function autonomously across diverse and evolving environments.</p>\n<ul>\n      <li><strong>Memory systems</strong> preserve context and history across decisions.</li>\n      <li><strong>World models</strong> internalize environmental dynamics, allowing for simulated reasoning.</li>\n      <li><strong>Credit assignment mechanisms</strong> trace responsibility across deep trajectories.</li>\n      <li><strong>Hierarchical policies</strong> decompose complex workflows into interpretable submodules.</li>\n      <li><strong>Model predictive control</strong> enables safe, efficient long-horizon planning.</li>\n    </ul>\n<p>When augmented with pre-RL <strong>Early Experience</strong> and scalable synthetic environments such as <strong>DreamGym</strong>, agents gain not only temporal coherence but also <em>generative foresight</em>: the ability to imagine, rehearse, and improve actions before executing them—effectively bridging the gap between reactive learning and proactive intelligence.</p>",
    "contentMarkdown": "*   Memory, world modeling, and long-horizon credit assignment form the temporal backbone of agentic RL. Together, they enable continuity, foresight, and adaptive reasoning—core attributes for any system expected to function autonomously across diverse and evolving environments.\n    \n    *   **Memory systems** preserve context and history across decisions.\n    *   **World models** internalize environmental dynamics, allowing for simulated reasoning.\n    *   **Credit assignment mechanisms** trace responsibility across deep trajectories.\n    *   **Hierarchical policies** decompose complex workflows into interpretable submodules.\n    *   **Model predictive control** enables safe, efficient long-horizon planning.\n*   When augmented with pre-RL **Early Experience** and scalable synthetic environments such as **DreamGym**, agents gain not only temporal coherence but also _generative foresight_: the ability to imagine, rehearse, and improve actions before executing them—effectively bridging the gap between reactive learning and proactive intelligence.\n    \n\nMemory, world modeling, and long-horizon credit assignment form the temporal backbone of agentic RL. Together, they enable continuity, foresight, and adaptive reasoning—core attributes for any system expected to function autonomously across diverse and evolving environments.\n\n*   **Memory systems** preserve context and history across decisions.\n*   **World models** internalize environmental dynamics, allowing for simulated reasoning.\n*   **Credit assignment mechanisms** trace responsibility across deep trajectories.\n*   **Hierarchical policies** decompose complex workflows into interpretable submodules.\n*   **Model predictive control** enables safe, efficient long-horizon planning.\n\nWhen augmented with pre-RL **Early Experience** and scalable synthetic environments such as **DreamGym**, agents gain not only temporal coherence but also _generative foresight_: the ability to imagine, rehearse, and improve actions before executing them—effectively bridging the gap between reactive learning and proactive intelligence.",
    "order": 52,
    "orderInChapter": 8,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 250,
      "contentLength": 2473
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#takeaways",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-why-evaluation-and-safety-matter-53",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Evaluation, Safety, and Interpretability",
    "title": "Why Evaluation and Safety Matter",
    "subtitle": "Evaluation, Safety, and Interpretability",
    "contentHtml": "<ul>\n  <li>As RL is increasingly applied to open-ended, tool-using, and web-interactive agents, questions of <em>safety</em>, <em>interpretability</em>, and <em>evaluation methodology</em> have become central.</li>\n  <li>\n    <p>Unlike static models—where evaluation can rely on accuracy or F1 scores—RL-based agents continually adapt, explore, and interact with dynamic environments. Their learned behaviors emerge from optimization, not from explicit instruction, which introduces the risk of <strong>reward hacking</strong>, <strong>unsafe exploration</strong>, or <strong>misaligned optimization</strong>.</p>\n  </li>\n  <li>\n    <p>Evaluation and safety frameworks therefore aim to:</p>\n\n    <ul>\n      <li>Quantify the <em>true capability</em> of agents across reasoning, planning, and execution dimensions.</li>\n      <li>Detect and prevent <em>unintended emergent behaviors</em> (e.g., exploiting web APIs incorrectly or entering infinite loops).</li>\n      <li>Ensure <em>alignment</em> with human norms, values, and expectations.</li>\n    </ul>\n  </li>\n  <li>Recent works such as <a href=\"https://arxiv.org/abs/2405.20309\">Large Language Models Can Self-improve at Web Agent Tasks</a> by Patel et al. (2024) and <a href=\"https://arxiv.org/abs/2310.01045\">AgentBench: Evaluating LLMs as General-Purpose Agents</a> by Liu et al. (2024) emphasize that evaluation is not just performance measurement—it is <em>behavioral verification</em> in a closed-loop context.</li>\n</ul>\n<p>Unlike static models—where evaluation can rely on accuracy or F1 scores—RL-based agents continually adapt, explore, and interact with dynamic environments. Their learned behaviors emerge from optimization, not from explicit instruction, which introduces the risk of <strong>reward hacking</strong>, <strong>unsafe exploration</strong>, or <strong>misaligned optimization</strong>.</p>\n<p>Evaluation and safety frameworks therefore aim to:</p>\n<ul>\n      <li>Quantify the <em>true capability</em> of agents across reasoning, planning, and execution dimensions.</li>\n      <li>Detect and prevent <em>unintended emergent behaviors</em> (e.g., exploiting web APIs incorrectly or entering infinite loops).</li>\n      <li>Ensure <em>alignment</em> with human norms, values, and expectations.</li>\n    </ul>",
    "contentMarkdown": "*   As RL is increasingly applied to open-ended, tool-using, and web-interactive agents, questions of _safety_, _interpretability_, and _evaluation methodology_ have become central.\n*   Unlike static models—where evaluation can rely on accuracy or F1 scores—RL-based agents continually adapt, explore, and interact with dynamic environments. Their learned behaviors emerge from optimization, not from explicit instruction, which introduces the risk of **reward hacking**, **unsafe exploration**, or **misaligned optimization**.\n    \n*   Evaluation and safety frameworks therefore aim to:\n    \n    *   Quantify the _true capability_ of agents across reasoning, planning, and execution dimensions.\n    *   Detect and prevent _unintended emergent behaviors_ (e.g., exploiting web APIs incorrectly or entering infinite loops).\n    *   Ensure _alignment_ with human norms, values, and expectations.\n*   Recent works such as [Large Language Models Can Self-improve at Web Agent Tasks](https://arxiv.org/abs/2405.20309) by Patel et al. (2024) and [AgentBench: Evaluating LLMs as General-Purpose Agents](https://arxiv.org/abs/2310.01045) by Liu et al. (2024) emphasize that evaluation is not just performance measurement—it is _behavioral verification_ in a closed-loop context.\n\nUnlike static models—where evaluation can rely on accuracy or F1 scores—RL-based agents continually adapt, explore, and interact with dynamic environments. Their learned behaviors emerge from optimization, not from explicit instruction, which introduces the risk of **reward hacking**, **unsafe exploration**, or **misaligned optimization**.\n\nEvaluation and safety frameworks therefore aim to:\n\n*   Quantify the _true capability_ of agents across reasoning, planning, and execution dimensions.\n*   Detect and prevent _unintended emergent behaviors_ (e.g., exploiting web APIs incorrectly or entering infinite loops).\n*   Ensure _alignment_ with human norms, values, and expectations.",
    "order": 53,
    "orderInChapter": 1,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 244,
      "contentLength": 2284
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#why-evaluation-and-safety-matter",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-core-dimensions-of-agent-evaluation-54",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Evaluation, Safety, and Interpretability",
    "title": "Core Dimensions of Agent Evaluation",
    "subtitle": "Evaluation, Safety, and Interpretability",
    "contentHtml": "<ul>\n  <li>Evaluation of RL-based agents extends across several orthogonal dimensions, each corresponding to a distinct capability or risk domain.</li>\n</ul>\n<h4 id=\"task-performance\">Task Performance</h4>\n<ul>\n  <li>\n    <p>Measures how effectively the agent accomplishes its intended goals.</p>\n\n    <ul>\n      <li><strong>Metrics:</strong> Success rate, accuracy, completion time, and cumulative reward.</li>\n      <li><strong>Examples:</strong> Booking a ticket, executing a spreadsheet command, answering a query.</li>\n    </ul>\n  </li>\n</ul>\n<p>Measures how effectively the agent accomplishes its intended goals.</p>\n<ul>\n      <li><strong>Metrics:</strong> Success rate, accuracy, completion time, and cumulative reward.</li>\n      <li><strong>Examples:</strong> Booking a ticket, executing a spreadsheet command, answering a query.</li>\n    </ul>\n<h4 id=\"behavioral-efficiency\">Behavioral Efficiency</h4>\n<ul>\n  <li>\n    <p>Assesses whether the agent achieves goals with minimal resource or action cost.</p>\n\n    <ul>\n      <li><strong>Metrics:</strong> Steps-to-success, energy or API call efficiency, latency.</li>\n      <li><strong>Significance:</strong> Indicates policy optimization beyond brute-force trial and error.</li>\n    </ul>\n  </li>\n</ul>\n<p>Assesses whether the agent achieves goals with minimal resource or action cost.</p>\n<ul>\n      <li><strong>Metrics:</strong> Steps-to-success, energy or API call efficiency, latency.</li>\n      <li><strong>Significance:</strong> Indicates policy optimization beyond brute-force trial and error.</li>\n    </ul>\n<h4 id=\"robustness-and-generalization\">Robustness and Generalization</h4>\n<ul>\n  <li>\n    <p>Evaluates how well the agent performs under perturbations—changes in environment layout, tool outputs, or input phrasing.</p>\n\n    <ul>\n      <li><strong>Metrics:</strong> Cross-environment transfer score, out-of-distribution success rate.</li>\n      <li><strong>Example:</strong> Agent still performs correctly when a webpage’s button labels change.</li>\n    </ul>\n  </li>\n</ul>\n<p>Evaluates how well the agent performs under perturbations—changes in environment layout, tool outputs, or input phrasing.</p>\n<ul>\n      <li><strong>Metrics:</strong> Cross-environment transfer score, out-of-distribution success rate.</li>\n      <li><strong>Example:</strong> Agent still performs correctly when a webpage’s button labels change.</li>\n    </ul>\n<h4 id=\"alignment-and-ethical-compliance\">Alignment and Ethical Compliance</h4>\n<ul>\n  <li>\n    <p>Examines whether actions remain consistent with human values, privacy norms, and safety boundaries.</p>\n\n    <ul>\n      <li><strong>Metrics:</strong> Human preference score, compliance violation rate, interpretability score.</li>\n    </ul>\n  </li>\n</ul>\n<p>Examines whether actions remain consistent with human values, privacy norms, and safety boundaries.</p>\n<ul>\n      <li><strong>Metrics:</strong> Human preference score, compliance violation rate, interpretability score.</li>\n    </ul>\n<h4 id=\"interpretability-and-transparency\">Interpretability and Transparency</h4>\n<ul>\n  <li>\n    <p>Focuses on whether the agent’s internal reasoning or decision-making process can be understood, visualized, or audited.</p>\n\n    <ul>\n      <li><strong>Metrics:</strong> Explanation fidelity, action traceability, rationale coherence.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Each dimension reflects a unique aspect of agent quality, and comprehensive evaluation must combine all to assess both <em>competence</em> and <em>trustworthiness</em>.</p>\n  </li>\n</ul>\n<p>Focuses on whether the agent’s internal reasoning or decision-making process can be understood, visualized, or audited.</p>\n<ul>\n      <li><strong>Metrics:</strong> Explanation fidelity, action traceability, rationale coherence.</li>\n    </ul>\n<p>Each dimension reflects a unique aspect of agent quality, and comprehensive evaluation must combine all to assess both <em>competence</em> and <em>trustworthiness</em>.</p>",
    "contentMarkdown": "*   Evaluation of RL-based agents extends across several orthogonal dimensions, each corresponding to a distinct capability or risk domain.\n\n#### Task Performance\n\n*   Measures how effectively the agent accomplishes its intended goals.\n    \n    *   **Metrics:** Success rate, accuracy, completion time, and cumulative reward.\n    *   **Examples:** Booking a ticket, executing a spreadsheet command, answering a query.\n\nMeasures how effectively the agent accomplishes its intended goals.\n\n*   **Metrics:** Success rate, accuracy, completion time, and cumulative reward.\n*   **Examples:** Booking a ticket, executing a spreadsheet command, answering a query.\n\n#### Behavioral Efficiency\n\n*   Assesses whether the agent achieves goals with minimal resource or action cost.\n    \n    *   **Metrics:** Steps-to-success, energy or API call efficiency, latency.\n    *   **Significance:** Indicates policy optimization beyond brute-force trial and error.\n\nAssesses whether the agent achieves goals with minimal resource or action cost.\n\n*   **Metrics:** Steps-to-success, energy or API call efficiency, latency.\n*   **Significance:** Indicates policy optimization beyond brute-force trial and error.\n\n#### Robustness and Generalization\n\n*   Evaluates how well the agent performs under perturbations—changes in environment layout, tool outputs, or input phrasing.\n    \n    *   **Metrics:** Cross-environment transfer score, out-of-distribution success rate.\n    *   **Example:** Agent still performs correctly when a webpage’s button labels change.\n\nEvaluates how well the agent performs under perturbations—changes in environment layout, tool outputs, or input phrasing.\n\n*   **Metrics:** Cross-environment transfer score, out-of-distribution success rate.\n*   **Example:** Agent still performs correctly when a webpage’s button labels change.\n\n#### Alignment and Ethical Compliance\n\n*   Examines whether actions remain consistent with human values, privacy norms, and safety boundaries.\n    \n    *   **Metrics:** Human preference score, compliance violation rate, interpretability score.\n\nExamines whether actions remain consistent with human values, privacy norms, and safety boundaries.\n\n*   **Metrics:** Human preference score, compliance violation rate, interpretability score.\n\n#### Interpretability and Transparency\n\n*   Focuses on whether the agent’s internal reasoning or decision-making process can be understood, visualized, or audited.\n    \n    *   **Metrics:** Explanation fidelity, action traceability, rationale coherence.\n*   Each dimension reflects a unique aspect of agent quality, and comprehensive evaluation must combine all to assess both _competence_ and _trustworthiness_.\n    \n\nFocuses on whether the agent’s internal reasoning or decision-making process can be understood, visualized, or audited.\n\n*   **Metrics:** Explanation fidelity, action traceability, rationale coherence.\n\nEach dimension reflects a unique aspect of agent quality, and comprehensive evaluation must combine all to assess both _competence_ and _trustworthiness_.",
    "order": 54,
    "orderInChapter": 2,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 376,
      "contentLength": 3983
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#core-dimensions-of-agent-evaluation",
    "scrapedAt": "2025-12-28T11:47:36.154Z"
  },
  {
    "id": "ai-agentic-RL-safety-challenges-55",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Evaluation, Safety, and Interpretability",
    "title": "Safety Challenges",
    "subtitle": "Evaluation, Safety, and Interpretability",
    "contentHtml": "<ul>\n  <li>\n    <p>The open-ended nature of RL training introduces specific safety risks not present in supervised learning.</p>\n\n    <ol>\n      <li>\n        <p><strong>Reward Hacking</strong>: Agents may find unintended shortcuts that maximize reward without achieving the true goal—for instance, refreshing a page repeatedly to gain partial progress points. Mathematically, this reflects <em>reward misspecification</em>: the reward function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-345-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5551\" style=\"width: 2.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.24em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5552\"><span class=\"mi\" id=\"MathJax-Span-5553\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5554\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5555\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5556\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5557\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-5558\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-345\">r(s,a)</script> does not perfectly encode human intent <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-346-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5559\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1002.19em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5560\"><span class=\"msubsup\" id=\"MathJax-Span-5561\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5562\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5563\"><span class=\"mrow\" id=\"MathJax-Span-5564\"><span class=\"mo\" id=\"MathJax-Span-5565\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∗</span><span class=\"mo\" id=\"MathJax-Span-5566\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5567\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5568\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5569\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-5570\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>∗</mo><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-346\">r^{*(s,a)}</script>.</p>\n      </li>\n      <li>\n        <p><strong>Unsafe Exploration</strong>: During training, agents may perform harmful or irreversible actions while attempting to maximize exploration-based rewards. In web or system environments, this could include deleting data or sending malformed API calls.</p>\n      </li>\n      <li>\n        <p><strong>Catastrophic Forgetting</strong>: Continual learning agents may lose previously learned safety behaviors when optimizing for new objectives, especially under non-stationary reward signals.</p>\n      </li>\n      <li>\n        <p><strong>Non-Stationary Human Feedback</strong>: In RLHF or DPO pipelines, shifting human preference distributions can cause instability if the agent overfits to transient feedback trends.</p>\n      </li>\n    </ol>\n  </li>\n  <li>\n    <p>A general safety objective adds a <em>regularization term</em> to penalize risky or uncertain behavior:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-347-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>J</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>safe</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow><mo>[</mo><mrow><munder><mo>&amp;#x2211;</mo><mi>t</mi></munder><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><msub><mi>&amp;#x03BB;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>risk</mtext></mrow></msub><msub><mi>c</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5571\" style=\"width: 16.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1013.02em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5572\"><span class=\"msubsup\" id=\"MathJax-Span-5573\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5574\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5575\"><span class=\"mrow\" id=\"MathJax-Span-5576\"><span class=\"mtext\" id=\"MathJax-Span-5577\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">safe</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5578\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5579\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5580\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5581\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-5582\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-5583\"><span class=\"mi\" id=\"MathJax-Span-5584\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span class=\"mrow\" id=\"MathJax-Span-5585\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-5586\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-5587\"><span class=\"munderover\" id=\"MathJax-Span-5588\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-5589\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5590\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5591\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5592\" style=\"font-family: STIXGeneral-Italic;\">γ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5593\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5594\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5595\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5596\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5597\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5598\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"msubsup\" id=\"MathJax-Span-5599\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5600\" style=\"font-family: STIXGeneral-Italic;\">λ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5601\"><span class=\"mrow\" id=\"MathJax-Span-5602\"><span class=\"mtext\" id=\"MathJax-Span-5603\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">risk</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5604\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5605\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5606\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5607\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-5608\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>J</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>safe</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>π</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow><mo>[</mo><mrow><munder><mo>∑</mo><mi>t</mi></munder><msup><mi>γ</mi><mi>t</mi></msup><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>t</mi></msub><mo>−</mo><msub><mi>λ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>risk</mtext></mrow></msub><msub><mi>c</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-347\">J_{\\text{safe}}(\\pi) = \\mathbb{E}\\left[\\sum_t \\gamma^t (r_t - \\lambda_{\\text{risk}} c_t)\\right]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-348-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5609\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5610\"><span class=\"msubsup\" id=\"MathJax-Span-5611\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5612\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5613\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>c</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-348\">c_t</script> quantifies risk (e.g., deviation from expected behavior) and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-349-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03BB;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>risk</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5614\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.62em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5615\"><span class=\"msubsup\" id=\"MathJax-Span-5616\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5617\" style=\"font-family: STIXGeneral-Italic;\">λ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5618\"><span class=\"mrow\" id=\"MathJax-Span-5619\"><span class=\"mtext\" id=\"MathJax-Span-5620\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">risk</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>λ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>risk</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-349\">\\lambda_{\\text{risk}}</script> controls conservatism.</li>\n    </ul>\n  </li>\n</ul>\n<p>The open-ended nature of RL training introduces specific safety risks not present in supervised learning.</p>\n<ol>\n      <li>\n        <p><strong>Reward Hacking</strong>: Agents may find unintended shortcuts that maximize reward without achieving the true goal—for instance, refreshing a page repeatedly to gain partial progress points. Mathematically, this reflects <em>reward misspecification</em>: the reward function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-345-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5551\" style=\"width: 2.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.24em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5552\"><span class=\"mi\" id=\"MathJax-Span-5553\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5554\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5555\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5556\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5557\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-5558\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-345\">r(s,a)</script> does not perfectly encode human intent <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-346-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5559\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1002.19em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5560\"><span class=\"msubsup\" id=\"MathJax-Span-5561\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5562\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5563\"><span class=\"mrow\" id=\"MathJax-Span-5564\"><span class=\"mo\" id=\"MathJax-Span-5565\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∗</span><span class=\"mo\" id=\"MathJax-Span-5566\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5567\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5568\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5569\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-5570\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>∗</mo><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-346\">r^{*(s,a)}</script>.</p>\n      </li>\n      <li>\n        <p><strong>Unsafe Exploration</strong>: During training, agents may perform harmful or irreversible actions while attempting to maximize exploration-based rewards. In web or system environments, this could include deleting data or sending malformed API calls.</p>\n      </li>\n      <li>\n        <p><strong>Catastrophic Forgetting</strong>: Continual learning agents may lose previously learned safety behaviors when optimizing for new objectives, especially under non-stationary reward signals.</p>\n      </li>\n      <li>\n        <p><strong>Non-Stationary Human Feedback</strong>: In RLHF or DPO pipelines, shifting human preference distributions can cause instability if the agent overfits to transient feedback trends.</p>\n      </li>\n    </ol>\n<p><strong>Reward Hacking</strong>: Agents may find unintended shortcuts that maximize reward without achieving the true goal—for instance, refreshing a page repeatedly to gain partial progress points. Mathematically, this reflects <em>reward misspecification</em>: the reward function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-345-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5551\" style=\"width: 2.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.24em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5552\"><span class=\"mi\" id=\"MathJax-Span-5553\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5554\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5555\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5556\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5557\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-5558\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-345\">r(s,a)</script> does not perfectly encode human intent <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-346-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5559\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1002.19em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5560\"><span class=\"msubsup\" id=\"MathJax-Span-5561\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5562\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5563\"><span class=\"mrow\" id=\"MathJax-Span-5564\"><span class=\"mo\" id=\"MathJax-Span-5565\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∗</span><span class=\"mo\" id=\"MathJax-Span-5566\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5567\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5568\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5569\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-5570\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>∗</mo><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-346\">r^{*(s,a)}</script>.</p>\n<p><strong>Unsafe Exploration</strong>: During training, agents may perform harmful or irreversible actions while attempting to maximize exploration-based rewards. In web or system environments, this could include deleting data or sending malformed API calls.</p>\n<p><strong>Catastrophic Forgetting</strong>: Continual learning agents may lose previously learned safety behaviors when optimizing for new objectives, especially under non-stationary reward signals.</p>\n<p><strong>Non-Stationary Human Feedback</strong>: In RLHF or DPO pipelines, shifting human preference distributions can cause instability if the agent overfits to transient feedback trends.</p>\n<p>A general safety objective adds a <em>regularization term</em> to penalize risky or uncertain behavior:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-348-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5609\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5610\"><span class=\"msubsup\" id=\"MathJax-Span-5611\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5612\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5613\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>c</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-348\">c_t</script> quantifies risk (e.g., deviation from expected behavior) and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-349-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03BB;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>risk</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5614\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.62em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5615\"><span class=\"msubsup\" id=\"MathJax-Span-5616\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5617\" style=\"font-family: STIXGeneral-Italic;\">λ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5618\"><span class=\"mrow\" id=\"MathJax-Span-5619\"><span class=\"mtext\" id=\"MathJax-Span-5620\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">risk</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>λ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>risk</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-349\">\\lambda_{\\text{risk}}</script> controls conservatism.</li>\n    </ul>",
    "contentMarkdown": "*   The open-ended nature of RL training introduces specific safety risks not present in supervised learning.\n    \n    1.  **Reward Hacking**: Agents may find unintended shortcuts that maximize reward without achieving the true goal—for instance, refreshing a page repeatedly to gain partial progress points. Mathematically, this reflects _reward misspecification_: the reward function r(s,a)r(s,a)r(s,a) does not perfectly encode human intent r∗(s,a)r∗(s,a)r^{\\*(s,a)}.\n        \n    2.  **Unsafe Exploration**: During training, agents may perform harmful or irreversible actions while attempting to maximize exploration-based rewards. In web or system environments, this could include deleting data or sending malformed API calls.\n        \n    3.  **Catastrophic Forgetting**: Continual learning agents may lose previously learned safety behaviors when optimizing for new objectives, especially under non-stationary reward signals.\n        \n    4.  **Non-Stationary Human Feedback**: In RLHF or DPO pipelines, shifting human preference distributions can cause instability if the agent overfits to transient feedback trends.\n        \n*   A general safety objective adds a _regularization term_ to penalize risky or uncertain behavior:\n    \n    Jsafe(π)\\=𝔼\\[∑tγt(rt−λriskct)\\]Jsafe(π)\\=E\\[∑tγt(rt−λriskct)\\]\n    \n    J\\_{\\\\text{safe}}(\\\\pi) = \\\\mathbb{E}\\\\left\\[\\\\sum\\_t \\\\gamma^t (r\\_t - \\\\lambda\\_{\\\\text{risk}} c\\_t)\\\\right\\]\n    *   where ctctc\\_t quantifies risk (e.g., deviation from expected behavior) and λriskλrisk\\\\lambda\\_{\\\\text{risk}} controls conservatism.\n\nThe open-ended nature of RL training introduces specific safety risks not present in supervised learning.\n\n1.  **Reward Hacking**: Agents may find unintended shortcuts that maximize reward without achieving the true goal—for instance, refreshing a page repeatedly to gain partial progress points. Mathematically, this reflects _reward misspecification_: the reward function r(s,a)r(s,a)r(s,a) does not perfectly encode human intent r∗(s,a)r∗(s,a)r^{\\*(s,a)}.\n    \n2.  **Unsafe Exploration**: During training, agents may perform harmful or irreversible actions while attempting to maximize exploration-based rewards. In web or system environments, this could include deleting data or sending malformed API calls.\n    \n3.  **Catastrophic Forgetting**: Continual learning agents may lose previously learned safety behaviors when optimizing for new objectives, especially under non-stationary reward signals.\n    \n4.  **Non-Stationary Human Feedback**: In RLHF or DPO pipelines, shifting human preference distributions can cause instability if the agent overfits to transient feedback trends.\n    \n\n**Reward Hacking**: Agents may find unintended shortcuts that maximize reward without achieving the true goal—for instance, refreshing a page repeatedly to gain partial progress points. Mathematically, this reflects _reward misspecification_: the reward function r(s,a)r(s,a)r(s,a) does not perfectly encode human intent r∗(s,a)r∗(s,a)r^{\\*(s,a)}.\n\n**Unsafe Exploration**: During training, agents may perform harmful or irreversible actions while attempting to maximize exploration-based rewards. In web or system environments, this could include deleting data or sending malformed API calls.\n\n**Catastrophic Forgetting**: Continual learning agents may lose previously learned safety behaviors when optimizing for new objectives, especially under non-stationary reward signals.\n\n**Non-Stationary Human Feedback**: In RLHF or DPO pipelines, shifting human preference distributions can cause instability if the agent overfits to transient feedback trends.\n\nA general safety objective adds a _regularization term_ to penalize risky or uncertain behavior:\n\n*   where ctctc\\_t quantifies risk (e.g., deviation from expected behavior) and λriskλrisk\\\\lambda\\_{\\\\text{risk}} controls conservatism.",
    "order": 55,
    "orderInChapter": 3,
    "difficulty": 5,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture",
      "supervised learning",
      "regularization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 456,
      "contentLength": 35312
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#safety-challenges",
    "scrapedAt": "2025-12-28T11:47:36.155Z"
  },
  {
    "id": "ai-agentic-RL-interpretability-and-traceability-56",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Evaluation, Safety, and Interpretability",
    "title": "Interpretability and Traceability",
    "subtitle": "Evaluation, Safety, and Interpretability",
    "contentHtml": "<ul>\n  <li>\n    <p>Interpretability in RL agents is especially challenging because learned policies are implicit, nonlinear functions that encode complex dynamics. However, several methods improve transparency and traceability:</p>\n\n    <ol>\n      <li>\n        <p><strong>Action Trace Logging</strong>\nRecord full trajectories of (state, action, reward) tuples for post-hoc analysis.\nEnables reconstruction of decision pathways, useful for debugging and ethical auditing.</p>\n      </li>\n      <li>\n        <p><strong>Causal Attribution Maps</strong>\nEstimate how much each observation influenced a given action. Techniques adapted from attention visualization or gradient saliency help identify which input elements guided the agent’s decisions.</p>\n      </li>\n      <li>\n        <p><strong>Hierarchical Explanation Models</strong>\nUsed in agents trained via hierarchical RL, these models separate high-level goal explanations (e.g., “I am gathering data”) from low-level actions (“click button,” “read table”).\nThis mirrors explainable AI (XAI) frameworks but grounded in reinforcement dynamics.</p>\n      </li>\n      <li>\n        <p><strong>Language-Based Rationales</strong>\nSome agents generate natural language explanations alongside their actions—a capability supported by recent instruction-tuned LLMs.\nThese rationales can be integrated into the reward loop as an <em>explanation-consistency bonus</em>, reinforcing self-explanatory behavior.</p>\n      </li>\n    </ol>\n  </li>\n</ul>\n<p>Interpretability in RL agents is especially challenging because learned policies are implicit, nonlinear functions that encode complex dynamics. However, several methods improve transparency and traceability:</p>\n<ol>\n      <li>\n        <p><strong>Action Trace Logging</strong>\nRecord full trajectories of (state, action, reward) tuples for post-hoc analysis.\nEnables reconstruction of decision pathways, useful for debugging and ethical auditing.</p>\n      </li>\n      <li>\n        <p><strong>Causal Attribution Maps</strong>\nEstimate how much each observation influenced a given action. Techniques adapted from attention visualization or gradient saliency help identify which input elements guided the agent’s decisions.</p>\n      </li>\n      <li>\n        <p><strong>Hierarchical Explanation Models</strong>\nUsed in agents trained via hierarchical RL, these models separate high-level goal explanations (e.g., “I am gathering data”) from low-level actions (“click button,” “read table”).\nThis mirrors explainable AI (XAI) frameworks but grounded in reinforcement dynamics.</p>\n      </li>\n      <li>\n        <p><strong>Language-Based Rationales</strong>\nSome agents generate natural language explanations alongside their actions—a capability supported by recent instruction-tuned LLMs.\nThese rationales can be integrated into the reward loop as an <em>explanation-consistency bonus</em>, reinforcing self-explanatory behavior.</p>\n      </li>\n    </ol>\n<p><strong>Action Trace Logging</strong>\nRecord full trajectories of (state, action, reward) tuples for post-hoc analysis.\nEnables reconstruction of decision pathways, useful for debugging and ethical auditing.</p>\n<p><strong>Causal Attribution Maps</strong>\nEstimate how much each observation influenced a given action. Techniques adapted from attention visualization or gradient saliency help identify which input elements guided the agent’s decisions.</p>\n<p><strong>Hierarchical Explanation Models</strong>\nUsed in agents trained via hierarchical RL, these models separate high-level goal explanations (e.g., “I am gathering data”) from low-level actions (“click button,” “read table”).\nThis mirrors explainable AI (XAI) frameworks but grounded in reinforcement dynamics.</p>\n<p><strong>Language-Based Rationales</strong>\nSome agents generate natural language explanations alongside their actions—a capability supported by recent instruction-tuned LLMs.\nThese rationales can be integrated into the reward loop as an <em>explanation-consistency bonus</em>, reinforcing self-explanatory behavior.</p>",
    "contentMarkdown": "*   Interpretability in RL agents is especially challenging because learned policies are implicit, nonlinear functions that encode complex dynamics. However, several methods improve transparency and traceability:\n    \n    1.  **Action Trace Logging** Record full trajectories of (state, action, reward) tuples for post-hoc analysis. Enables reconstruction of decision pathways, useful for debugging and ethical auditing.\n        \n    2.  **Causal Attribution Maps** Estimate how much each observation influenced a given action. Techniques adapted from attention visualization or gradient saliency help identify which input elements guided the agent’s decisions.\n        \n    3.  **Hierarchical Explanation Models** Used in agents trained via hierarchical RL, these models separate high-level goal explanations (e.g., “I am gathering data”) from low-level actions (“click button,” “read table”). This mirrors explainable AI (XAI) frameworks but grounded in reinforcement dynamics.\n        \n    4.  **Language-Based Rationales** Some agents generate natural language explanations alongside their actions—a capability supported by recent instruction-tuned LLMs. These rationales can be integrated into the reward loop as an _explanation-consistency bonus_, reinforcing self-explanatory behavior.\n        \n\nInterpretability in RL agents is especially challenging because learned policies are implicit, nonlinear functions that encode complex dynamics. However, several methods improve transparency and traceability:\n\n1.  **Action Trace Logging** Record full trajectories of (state, action, reward) tuples for post-hoc analysis. Enables reconstruction of decision pathways, useful for debugging and ethical auditing.\n    \n2.  **Causal Attribution Maps** Estimate how much each observation influenced a given action. Techniques adapted from attention visualization or gradient saliency help identify which input elements guided the agent’s decisions.\n    \n3.  **Hierarchical Explanation Models** Used in agents trained via hierarchical RL, these models separate high-level goal explanations (e.g., “I am gathering data”) from low-level actions (“click button,” “read table”). This mirrors explainable AI (XAI) frameworks but grounded in reinforcement dynamics.\n    \n4.  **Language-Based Rationales** Some agents generate natural language explanations alongside their actions—a capability supported by recent instruction-tuned LLMs. These rationales can be integrated into the reward loop as an _explanation-consistency bonus_, reinforcing self-explanatory behavior.\n    \n\n**Action Trace Logging** Record full trajectories of (state, action, reward) tuples for post-hoc analysis. Enables reconstruction of decision pathways, useful for debugging and ethical auditing.\n\n**Causal Attribution Maps** Estimate how much each observation influenced a given action. Techniques adapted from attention visualization or gradient saliency help identify which input elements guided the agent’s decisions.\n\n**Hierarchical Explanation Models** Used in agents trained via hierarchical RL, these models separate high-level goal explanations (e.g., “I am gathering data”) from low-level actions (“click button,” “read table”). This mirrors explainable AI (XAI) frameworks but grounded in reinforcement dynamics.\n\n**Language-Based Rationales** Some agents generate natural language explanations alongside their actions—a capability supported by recent instruction-tuned LLMs. These rationales can be integrated into the reward loop as an _explanation-consistency bonus_, reinforcing self-explanatory behavior.",
    "order": 56,
    "orderInChapter": 4,
    "difficulty": 4,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture",
      "attention",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 437,
      "contentLength": 4053
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#interpretability-and-traceability",
    "scrapedAt": "2025-12-28T11:47:36.155Z"
  },
  {
    "id": "ai-agentic-RL-safety-aware-rl-algorithms-57",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Evaluation, Safety, and Interpretability",
    "title": "Safety-Aware RL Algorithms",
    "subtitle": "Evaluation, Safety, and Interpretability",
    "contentHtml": "<ul>\n  <li>\n    <p>Several specialized RL formulations have been proposed to address safety-critical issues:</p>\n  </li>\n  <li>\n    <p><strong>Constrained Policy Optimization (CPO):</strong> Introduced by <a href=\"https://arxiv.org/abs/1705.10528\">Achiam et al. (2017)</a>, CPO adds hard constraints to the optimization problem to ensure policies respect safety boundaries:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-350-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>&amp;#x03C0;</mi></munder><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mspace width=&quot;1em&quot; /><mtext>s.t.</mtext><mspace width=&quot;1em&quot; /><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mi>&amp;#x03C0;</mi></msub><mo stretchy=&quot;false&quot;>[</mo><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2264;</mo><mi>&amp;#x03B4;</mi></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5621\" style=\"width: 15.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.232em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1013.23em, 3.128em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5622\"><span class=\"munderover\" id=\"MathJax-Span-5623\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-5624\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.273em, -999.997em); top: -3.331em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-5625\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-5626\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5627\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5628\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5629\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mspace\" id=\"MathJax-Span-5630\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"mtext\" id=\"MathJax-Span-5631\" style=\"font-family: STIXGeneral-Regular;\">s.t.</span><span class=\"mspace\" id=\"MathJax-Span-5632\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-5633\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5634\"><span class=\"mrow\" id=\"MathJax-Span-5635\"><span class=\"mi\" id=\"MathJax-Span-5636\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5637\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5638\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-5639\" style=\"font-family: STIXGeneral-Italic;\">C<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5640\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5641\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5642\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5643\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-5644\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5645\" style=\"font-family: STIXGeneral-Regular;\">]</span><span class=\"mo\" id=\"MathJax-Span-5646\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-5647\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">δ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.997em; border-left: 0px solid; width: 0px; height: 1.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>π</mi></munder><mi>J</mi><mo stretchy=\"false\">(</mo><mi>π</mi><mo stretchy=\"false\">)</mo><mspace width=\"1em\"></mspace><mtext>s.t.</mtext><mspace width=\"1em\"></mspace><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mi>π</mi></msub><mo stretchy=\"false\">[</mo><mi>C</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo>≤</mo><mi>δ</mi></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-350\">\\max_\\pi J(\\pi) \\quad \\text{s.t.} \\quad \\mathbb{E}_\\pi[C(s,a)] \\leq \\delta</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-351-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5648\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.61em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5649\"><span class=\"mi\" id=\"MathJax-Span-5650\" style=\"font-family: STIXGeneral-Italic;\">C<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5651\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5652\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5653\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5654\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-5655\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>C</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-351\">C(s,a)</script> is a cost function and (\\delta) the safety threshold.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Safe Exploration via Risk-Aware Value Functions:</strong> Instead of optimizing for expected reward, these methods optimize <em>conditional value-at-risk (CVaR)</em> to limit the probability of catastrophic outcomes.</p>\n  </li>\n  <li>\n    <p><strong>Shielded Reinforcement Learning:</strong> Incorporates a formal safety “shield” that intercepts actions violating constraints, replacing them with safe alternatives in real time.</p>\n  </li>\n  <li>\n    <p><strong>Process-Wise Safety Scoring:</strong> In complex environments like tool-use environments or multi-turn environments, step-wise safety checks are applied per subgoal or API call.\nFor example, in a data retrieval task, each API call is evaluated for compliance and correctness before continuation.</p>\n  </li>\n  <li>\n    <p>These algorithms formalize the notion of safety as part of the optimization loop, integrating constraint satisfaction directly into the learning process.</p>\n  </li>\n</ul>\n<p>Several specialized RL formulations have been proposed to address safety-critical issues:</p>\n<p><strong>Constrained Policy Optimization (CPO):</strong> Introduced by <a href=\"https://arxiv.org/abs/1705.10528\">Achiam et al. (2017)</a>, CPO adds hard constraints to the optimization problem to ensure policies respect safety boundaries:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-351-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5648\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.61em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5649\"><span class=\"mi\" id=\"MathJax-Span-5650\" style=\"font-family: STIXGeneral-Italic;\">C<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5651\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5652\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5653\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5654\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-5655\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>C</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-351\">C(s,a)</script> is a cost function and (\\delta) the safety threshold.</li>\n    </ul>\n<p><strong>Safe Exploration via Risk-Aware Value Functions:</strong> Instead of optimizing for expected reward, these methods optimize <em>conditional value-at-risk (CVaR)</em> to limit the probability of catastrophic outcomes.</p>\n<p><strong>Shielded Reinforcement Learning:</strong> Incorporates a formal safety “shield” that intercepts actions violating constraints, replacing them with safe alternatives in real time.</p>\n<p><strong>Process-Wise Safety Scoring:</strong> In complex environments like tool-use environments or multi-turn environments, step-wise safety checks are applied per subgoal or API call.\nFor example, in a data retrieval task, each API call is evaluated for compliance and correctness before continuation.</p>\n<p>These algorithms formalize the notion of safety as part of the optimization loop, integrating constraint satisfaction directly into the learning process.</p>",
    "contentMarkdown": "*   Several specialized RL formulations have been proposed to address safety-critical issues:\n    \n*   **Constrained Policy Optimization (CPO):** Introduced by [Achiam et al. (2017)](https://arxiv.org/abs/1705.10528), CPO adds hard constraints to the optimization problem to ensure policies respect safety boundaries:\n    \n    maxπJ(π)s.t.𝔼π\\[C(s,a)\\]≤δmaxπJ(π)s.t.Eπ\\[C(s,a)\\]≤δ\n    \n    \\\\max\\_\\\\pi J(\\\\pi) \\\\quad \\\\text{s.t.} \\\\quad \\\\mathbb{E}\\_\\\\pi\\[C(s,a)\\] \\\\leq \\\\delta\n    *   where C(s,a)C(s,a)C(s,a) is a cost function and (\\\\delta) the safety threshold.\n*   **Safe Exploration via Risk-Aware Value Functions:** Instead of optimizing for expected reward, these methods optimize _conditional value-at-risk (CVaR)_ to limit the probability of catastrophic outcomes.\n    \n*   **Shielded Reinforcement Learning:** Incorporates a formal safety “shield” that intercepts actions violating constraints, replacing them with safe alternatives in real time.\n    \n*   **Process-Wise Safety Scoring:** In complex environments like tool-use environments or multi-turn environments, step-wise safety checks are applied per subgoal or API call. For example, in a data retrieval task, each API call is evaluated for compliance and correctness before continuation.\n    \n*   These algorithms formalize the notion of safety as part of the optimization loop, integrating constraint satisfaction directly into the learning process.\n    \n\nSeveral specialized RL formulations have been proposed to address safety-critical issues:\n\n**Constrained Policy Optimization (CPO):** Introduced by [Achiam et al. (2017)](https://arxiv.org/abs/1705.10528), CPO adds hard constraints to the optimization problem to ensure policies respect safety boundaries:\n\n*   where C(s,a)C(s,a)C(s,a) is a cost function and (\\\\delta) the safety threshold.\n\n**Safe Exploration via Risk-Aware Value Functions:** Instead of optimizing for expected reward, these methods optimize _conditional value-at-risk (CVaR)_ to limit the probability of catastrophic outcomes.\n\n**Shielded Reinforcement Learning:** Incorporates a formal safety “shield” that intercepts actions violating constraints, replacing them with safe alternatives in real time.\n\n**Process-Wise Safety Scoring:** In complex environments like tool-use environments or multi-turn environments, step-wise safety checks are applied per subgoal or API call. For example, in a data retrieval task, each API call is evaluated for compliance and correctness before continuation.\n\nThese algorithms formalize the notion of safety as part of the optimization loop, integrating constraint satisfaction directly into the learning process.",
    "order": 57,
    "orderInChapter": 5,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "reinforcement learning",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 323,
      "contentLength": 12845
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#safety-aware-rl-algorithms",
    "scrapedAt": "2025-12-28T11:47:36.155Z"
  },
  {
    "id": "ai-agentic-RL-human-in-the-loop-hitl-oversight-58",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Evaluation, Safety, and Interpretability",
    "title": "Human-in-the-Loop (HITL) Oversight",
    "subtitle": "Evaluation, Safety, and Interpretability",
    "contentHtml": "<ul>\n  <li>Human oversight remains a critical element in RL agent safety and evaluation pipelines.</li>\n  <li>\n    <p>HITL systems provide:</p>\n\n    <ul>\n      <li><strong>Preference feedback</strong> for training reward models (RLHF).</li>\n      <li><strong>Trajectory curation</strong> for identifying unsafe or unproductive behaviors.</li>\n      <li><strong>Live intervention mechanisms</strong>, allowing humans to override or halt harmful action sequences.</li>\n    </ul>\n  </li>\n  <li>Emerging frameworks like <a href=\"https://arxiv.org/abs/2310.01045\">Themis</a> and <a href=\"https://arxiv.org/abs/2310.01045\">AgentBench</a> incorporate automated auditing layers that flag deviations from normal operating bounds. These can be paired with <em>real-time monitoring dashboards</em> to visualize action probabilities, risk metrics, and outcome confidence.</li>\n</ul>\n<p>HITL systems provide:</p>\n<ul>\n      <li><strong>Preference feedback</strong> for training reward models (RLHF).</li>\n      <li><strong>Trajectory curation</strong> for identifying unsafe or unproductive behaviors.</li>\n      <li><strong>Live intervention mechanisms</strong>, allowing humans to override or halt harmful action sequences.</li>\n    </ul>",
    "contentMarkdown": "*   Human oversight remains a critical element in RL agent safety and evaluation pipelines.\n*   HITL systems provide:\n    \n    *   **Preference feedback** for training reward models (RLHF).\n    *   **Trajectory curation** for identifying unsafe or unproductive behaviors.\n    *   **Live intervention mechanisms**, allowing humans to override or halt harmful action sequences.\n*   Emerging frameworks like [Themis](https://arxiv.org/abs/2310.01045) and [AgentBench](https://arxiv.org/abs/2310.01045) incorporate automated auditing layers that flag deviations from normal operating bounds. These can be paired with _real-time monitoring dashboards_ to visualize action probabilities, risk metrics, and outcome confidence.\n\nHITL systems provide:\n\n*   **Preference feedback** for training reward models (RLHF).\n*   **Trajectory curation** for identifying unsafe or unproductive behaviors.\n*   **Live intervention mechanisms**, allowing humans to override or halt harmful action sequences.",
    "order": 58,
    "orderInChapter": 6,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 116,
      "contentLength": 1227
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#human-in-the-loop-(hitl)-oversight",
    "scrapedAt": "2025-12-28T11:47:36.155Z"
  },
  {
    "id": "ai-agentic-RL-benchmarking-frameworks-for-safe-and-transparent-e-59",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Evaluation, Safety, and Interpretability",
    "title": "Benchmarking Frameworks for Safe and Transparent Evaluation",
    "subtitle": "Evaluation, Safety, and Interpretability",
    "contentHtml": "<ul>\n  <li>Comprehensive benchmarking environments now combine safety, reasoning, and tool-use tasks under unified evaluation suites.</li>\n  <li>\n    <p>Notable examples include:</p>\n\n    <ul>\n      <li><strong>AgentGym</strong> (<a href=\"https://arxiv.org/abs/2406.04151\">AgentGym</a> by Xi et al., 2024): A modular environment suite supporting SingleTurn, tool-use environments, and MultiTurn workflows, each with structured reward feedback and failure diagnostics.</li>\n      <li><strong>AgentBench</strong> (<a href=\"https://arxiv.org/abs/2310.01045\">AgentBench</a> by Liu et al., 2024): Provides web, reasoning, and software operation benchmarks with alignment-focused scoring.</li>\n      <li><strong>OpenWebVoyager</strong> (<a href=\"https://arxiv.org/abs/2410.19609\">OpenWebVoyager</a> by He et al., 2024): Realistic browser-based simulation for long-horizon web navigation tasks, used for testing contextual coherence and stability.</li>\n      <li><strong>WebArena</strong> and <strong>Mind2Web:</strong> Large-scale web environments supporting reward shaping, human preference integration, and process-level logging for transparency.</li>\n    </ul>\n  </li>\n  <li>Together, these frameworks enable <em>holistic agent evaluation</em>—capturing not only goal success but also the <em>process integrity</em> and <em>ethical soundness</em> of the learned policies.</li>\n</ul>\n<p>Notable examples include:</p>\n<ul>\n      <li><strong>AgentGym</strong> (<a href=\"https://arxiv.org/abs/2406.04151\">AgentGym</a> by Xi et al., 2024): A modular environment suite supporting SingleTurn, tool-use environments, and MultiTurn workflows, each with structured reward feedback and failure diagnostics.</li>\n      <li><strong>AgentBench</strong> (<a href=\"https://arxiv.org/abs/2310.01045\">AgentBench</a> by Liu et al., 2024): Provides web, reasoning, and software operation benchmarks with alignment-focused scoring.</li>\n      <li><strong>OpenWebVoyager</strong> (<a href=\"https://arxiv.org/abs/2410.19609\">OpenWebVoyager</a> by He et al., 2024): Realistic browser-based simulation for long-horizon web navigation tasks, used for testing contextual coherence and stability.</li>\n      <li><strong>WebArena</strong> and <strong>Mind2Web:</strong> Large-scale web environments supporting reward shaping, human preference integration, and process-level logging for transparency.</li>\n    </ul>",
    "contentMarkdown": "*   Comprehensive benchmarking environments now combine safety, reasoning, and tool-use tasks under unified evaluation suites.\n*   Notable examples include:\n    \n    *   **AgentGym** ([AgentGym](https://arxiv.org/abs/2406.04151) by Xi et al., 2024): A modular environment suite supporting SingleTurn, tool-use environments, and MultiTurn workflows, each with structured reward feedback and failure diagnostics.\n    *   **AgentBench** ([AgentBench](https://arxiv.org/abs/2310.01045) by Liu et al., 2024): Provides web, reasoning, and software operation benchmarks with alignment-focused scoring.\n    *   **OpenWebVoyager** ([OpenWebVoyager](https://arxiv.org/abs/2410.19609) by He et al., 2024): Realistic browser-based simulation for long-horizon web navigation tasks, used for testing contextual coherence and stability.\n    *   **WebArena** and **Mind2Web:** Large-scale web environments supporting reward shaping, human preference integration, and process-level logging for transparency.\n*   Together, these frameworks enable _holistic agent evaluation_—capturing not only goal success but also the _process integrity_ and _ethical soundness_ of the learned policies.\n\nNotable examples include:\n\n*   **AgentGym** ([AgentGym](https://arxiv.org/abs/2406.04151) by Xi et al., 2024): A modular environment suite supporting SingleTurn, tool-use environments, and MultiTurn workflows, each with structured reward feedback and failure diagnostics.\n*   **AgentBench** ([AgentBench](https://arxiv.org/abs/2310.01045) by Liu et al., 2024): Provides web, reasoning, and software operation benchmarks with alignment-focused scoring.\n*   **OpenWebVoyager** ([OpenWebVoyager](https://arxiv.org/abs/2410.19609) by He et al., 2024): Realistic browser-based simulation for long-horizon web navigation tasks, used for testing contextual coherence and stability.\n*   **WebArena** and **Mind2Web:** Large-scale web environments supporting reward shaping, human preference integration, and process-level logging for transparency.",
    "order": 59,
    "orderInChapter": 7,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 218,
      "contentLength": 2382
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#benchmarking-frameworks-for-safe-and-transparent-evaluation",
    "scrapedAt": "2025-12-28T11:47:36.155Z"
  },
  {
    "id": "ai-agentic-RL-toward-aligned-interpretable-and-reliable-agentic--60",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Evaluation, Safety, and Interpretability",
    "title": "Toward Aligned, Interpretable, and Reliable Agentic Systems",
    "subtitle": "Evaluation, Safety, and Interpretability",
    "contentHtml": "<ul>\n  <li>\n    <p>As agentic RL systems continue to scale, their evaluation and safety mechanisms must evolve from reactive to <em>proactive</em>.\nKey directions include:</p>\n\n    <ul>\n      <li>Embedding <strong>interpretability hooks</strong> within policy architectures.</li>\n      <li>Using <strong>multi-objective optimization</strong> to balance capability and safety rewards.</li>\n      <li>Adopting <strong>model-based simulations</strong> to test agents before deployment.</li>\n      <li>Incorporating <strong>continuous monitoring</strong> and <strong>human-AI collaboration loops</strong> for post-deployment oversight.</li>\n    </ul>\n  </li>\n  <li>\n    <p>In practice, the next generation of RL-based agents will need to demonstrate:</p>\n\n    <ul>\n      <li>Predictable behavior under uncertainty,</li>\n      <li>Transparent reasoning chains,</li>\n      <li>Explicit accountability for outcomes,</li>\n      <li>Continuous adaptability without goal drift.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This marks the transition from experimental RL toward <strong>governed, auditable intelligence</strong>—systems that can be trusted not just to perform, but to <em>behave</em> in alignment with human values and operational safety constraints.</p>\n  </li>\n</ul>\n<p>As agentic RL systems continue to scale, their evaluation and safety mechanisms must evolve from reactive to <em>proactive</em>.\nKey directions include:</p>\n<ul>\n      <li>Embedding <strong>interpretability hooks</strong> within policy architectures.</li>\n      <li>Using <strong>multi-objective optimization</strong> to balance capability and safety rewards.</li>\n      <li>Adopting <strong>model-based simulations</strong> to test agents before deployment.</li>\n      <li>Incorporating <strong>continuous monitoring</strong> and <strong>human-AI collaboration loops</strong> for post-deployment oversight.</li>\n    </ul>\n<p>In practice, the next generation of RL-based agents will need to demonstrate:</p>\n<ul>\n      <li>Predictable behavior under uncertainty,</li>\n      <li>Transparent reasoning chains,</li>\n      <li>Explicit accountability for outcomes,</li>\n      <li>Continuous adaptability without goal drift.</li>\n    </ul>\n<p>This marks the transition from experimental RL toward <strong>governed, auditable intelligence</strong>—systems that can be trusted not just to perform, but to <em>behave</em> in alignment with human values and operational safety constraints.</p>",
    "contentMarkdown": "*   As agentic RL systems continue to scale, their evaluation and safety mechanisms must evolve from reactive to _proactive_. Key directions include:\n    \n    *   Embedding **interpretability hooks** within policy architectures.\n    *   Using **multi-objective optimization** to balance capability and safety rewards.\n    *   Adopting **model-based simulations** to test agents before deployment.\n    *   Incorporating **continuous monitoring** and **human-AI collaboration loops** for post-deployment oversight.\n*   In practice, the next generation of RL-based agents will need to demonstrate:\n    \n    *   Predictable behavior under uncertainty,\n    *   Transparent reasoning chains,\n    *   Explicit accountability for outcomes,\n    *   Continuous adaptability without goal drift.\n*   This marks the transition from experimental RL toward **governed, auditable intelligence**—systems that can be trusted not just to perform, but to _behave_ in alignment with human values and operational safety constraints.\n    \n\nAs agentic RL systems continue to scale, their evaluation and safety mechanisms must evolve from reactive to _proactive_. Key directions include:\n\n*   Embedding **interpretability hooks** within policy architectures.\n*   Using **multi-objective optimization** to balance capability and safety rewards.\n*   Adopting **model-based simulations** to test agents before deployment.\n*   Incorporating **continuous monitoring** and **human-AI collaboration loops** for post-deployment oversight.\n\nIn practice, the next generation of RL-based agents will need to demonstrate:\n\n*   Predictable behavior under uncertainty,\n*   Transparent reasoning chains,\n*   Explicit accountability for outcomes,\n*   Continuous adaptability without goal drift.\n\nThis marks the transition from experimental RL toward **governed, auditable intelligence**—systems that can be trusted not just to perform, but to _behave_ in alignment with human values and operational safety constraints.",
    "order": 60,
    "orderInChapter": 8,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "embedding",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 245,
      "contentLength": 2453
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#toward-aligned,-interpretable,-and-reliable-agentic-systems",
    "scrapedAt": "2025-12-28T11:47:36.155Z"
  },
  {
    "id": "ai-agentic-RL-foundations-and-theoretical-advancements-in-tir-61",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Tool-Integrated Reasoning",
    "title": "Foundations and Theoretical Advancements in TIR",
    "subtitle": "Tool-Integrated Reasoning",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Core Idea:</strong> <a href=\"https://arxiv.org/abs/2508.19201\">Understanding Tool-Integrated Reasoning</a> by Heng Lin &amp; Zhongwen Xu (2025) formalizes the <em>tool-integrated reasoning loop</em> as a Markov Decision Process (MDP), providing a principled RL framework for training models to use tools effectively. It introduces <strong>Advantage Shaping Policy Optimization (ASPO)</strong>, a variant of PPO that adds adaptive reward shaping to balance process- and outcome-based learning.</p>\n  </li>\n  <li>\n    <p><strong>Mathematical formulation:</strong> The ASPO objective is:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-352-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ASPO</mtext></mrow></msub><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>h</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mi>A</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>h</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2212;</mo><mi>&amp;#x03B2;</mi><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>KL</mtext></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>h</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>h</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5656\" style=\"width: 25.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 21.565em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1021.46em, 2.919em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5657\"><span class=\"msubsup\" id=\"MathJax-Span-5658\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5659\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-5660\"><span class=\"mrow\" id=\"MathJax-Span-5661\"><span class=\"mtext\" id=\"MathJax-Span-5662\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ASPO</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5663\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5664\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.596em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5665\"><span class=\"mrow\" id=\"MathJax-Span-5666\"><span class=\"mi\" id=\"MathJax-Span-5667\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-5668\"><span class=\"mrow\" id=\"MathJax-Span-5669\"><span class=\"mi\" id=\"MathJax-Span-5670\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-5671\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">∼</span><span class=\"msubsup\" id=\"MathJax-Span-5672\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5673\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5674\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5675\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5676\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"texatom\" id=\"MathJax-Span-5677\"><span class=\"mrow\" id=\"MathJax-Span-5678\"><span class=\"mo\" id=\"MathJax-Span-5679\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-5680\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">h</span><span class=\"mo\" id=\"MathJax-Span-5681\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5682\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-5683\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-5684\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5685\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-5686\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5687\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">h</span><span class=\"mo\" id=\"MathJax-Span-5688\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5689\" style=\"font-family: STIXGeneral-Regular;\">]</span><span class=\"mo\" id=\"MathJax-Span-5690\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">−</span><span class=\"mi\" id=\"MathJax-Span-5691\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-5692\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5693\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-5694\"><span class=\"mrow\" id=\"MathJax-Span-5695\"><span class=\"mtext\" id=\"MathJax-Span-5696\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">KL</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5697\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-5698\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5699\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5700\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5701\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5702\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"texatom\" id=\"MathJax-Span-5703\"><span class=\"mrow\" id=\"MathJax-Span-5704\"><span class=\"mo\" id=\"MathJax-Span-5705\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-5706\" style=\"font-family: STIXGeneral-Italic;\">h</span><span class=\"mo\" id=\"MathJax-Span-5707\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-5708\"><span class=\"mrow\" id=\"MathJax-Span-5709\"><span class=\"mo\" id=\"MathJax-Span-5710\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"texatom\" id=\"MathJax-Span-5711\"><span class=\"mrow\" id=\"MathJax-Span-5712\"><span class=\"mo\" id=\"MathJax-Span-5713\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5714\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5715\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5716\"><span class=\"mrow\" id=\"MathJax-Span-5717\"><span class=\"mtext\" id=\"MathJax-Span-5718\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5719\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5720\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"texatom\" id=\"MathJax-Span-5721\"><span class=\"mrow\" id=\"MathJax-Span-5722\"><span class=\"mo\" id=\"MathJax-Span-5723\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-5724\" style=\"font-family: STIXGeneral-Italic;\">h</span><span class=\"mo\" id=\"MathJax-Span-5725\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5726\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ASPO</mtext></mrow></msub><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>a</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>h</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo stretchy=\"false\">[</mo><mi>A</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo>−</mo><mi>β</mi><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>KL</mtext></mrow></msub><mo stretchy=\"false\">[</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>h</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>h</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-352\">L_{\\text{ASPO}} = \\mathbb{E}_{a\\sim \\pi_\\theta(a|h)}[A(a,h)] - \\beta D_{\\text{KL}}[\\pi_\\theta(a|h) || \\pi_{\\text{ref}}(a|h)]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-353-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>h</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5727\" style=\"width: 3.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.815em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.76em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5728\"><span class=\"mi\" id=\"MathJax-Span-5729\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-5730\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5731\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-5732\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5733\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">h</span><span class=\"mo\" id=\"MathJax-Span-5734\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><mi>h</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-353\">A(a,h)</script> is the <em>shaped advantage</em> incorporating both immediate (stepwise) and final (outcome) signals, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-354-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5735\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5736\"><span class=\"mi\" id=\"MathJax-Span-5737\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-354\">\\beta</script> controls regularization against a reference policy.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Implementation Highlights:</strong></p>\n\n    <ul>\n      <li>Trains a 7B model on symbolic reasoning tasks.</li>\n      <li>Adds <em>step-level shaping</em> to encourage timely tool use and verification behavior.</li>\n      <li>Significantly stabilizes RL optimization, improving both training and test accuracy by &gt;6%.</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Core Idea:</strong> <a href=\"https://arxiv.org/abs/2508.19201\">Understanding Tool-Integrated Reasoning</a> by Heng Lin &amp; Zhongwen Xu (2025) formalizes the <em>tool-integrated reasoning loop</em> as a Markov Decision Process (MDP), providing a principled RL framework for training models to use tools effectively. It introduces <strong>Advantage Shaping Policy Optimization (ASPO)</strong>, a variant of PPO that adds adaptive reward shaping to balance process- and outcome-based learning.</p>\n<p><strong>Mathematical formulation:</strong> The ASPO objective is:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-353-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>h</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5727\" style=\"width: 3.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.815em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.76em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5728\"><span class=\"mi\" id=\"MathJax-Span-5729\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-5730\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5731\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-5732\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5733\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">h</span><span class=\"mo\" id=\"MathJax-Span-5734\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><mi>h</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-353\">A(a,h)</script> is the <em>shaped advantage</em> incorporating both immediate (stepwise) and final (outcome) signals, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-354-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5735\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5736\"><span class=\"mi\" id=\"MathJax-Span-5737\" style=\"font-family: STIXGeneral-Italic;\">β<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>β</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-354\">\\beta</script> controls regularization against a reference policy.</li>\n    </ul>\n<p><strong>Implementation Highlights:</strong></p>\n<ul>\n      <li>Trains a 7B model on symbolic reasoning tasks.</li>\n      <li>Adds <em>step-level shaping</em> to encourage timely tool use and verification behavior.</li>\n      <li>Significantly stabilizes RL optimization, improving both training and test accuracy by &gt;6%.</li>\n    </ul>",
    "contentMarkdown": "*   **Core Idea:** [Understanding Tool-Integrated Reasoning](https://arxiv.org/abs/2508.19201) by Heng Lin & Zhongwen Xu (2025) formalizes the _tool-integrated reasoning loop_ as a Markov Decision Process (MDP), providing a principled RL framework for training models to use tools effectively. It introduces **Advantage Shaping Policy Optimization (ASPO)**, a variant of PPO that adds adaptive reward shaping to balance process- and outcome-based learning.\n    \n*   **Mathematical formulation:** The ASPO objective is:\n    \n    LASPO\\=𝔼a∼πθ(a|h)\\[A(a,h)\\]−βDKL\\[πθ(a|h)||πref(a|h)\\]LASPO\\=Ea∼πθ(a|h)\\[A(a,h)\\]−βDKL\\[πθ(a|h)||πref(a|h)\\]\n    \n    L\\_{\\\\text{ASPO}} = \\\\mathbb{E}\\_{a\\\\sim \\\\pi\\_\\\\theta(a|h)}\\[A(a,h)\\] - \\\\beta D\\_{\\\\text{KL}}\\[\\\\pi\\_\\\\theta(a|h) || \\\\pi\\_{\\\\text{ref}}(a|h)\\]\n    *   where A(a,h)A(a,h)A(a,h) is the _shaped advantage_ incorporating both immediate (stepwise) and final (outcome) signals, and ββ\\\\beta controls regularization against a reference policy.\n*   **Implementation Highlights:**\n    \n    *   Trains a 7B model on symbolic reasoning tasks.\n    *   Adds _step-level shaping_ to encourage timely tool use and verification behavior.\n    *   Significantly stabilizes RL optimization, improving both training and test accuracy by >6%.\n\n**Core Idea:** [Understanding Tool-Integrated Reasoning](https://arxiv.org/abs/2508.19201) by Heng Lin & Zhongwen Xu (2025) formalizes the _tool-integrated reasoning loop_ as a Markov Decision Process (MDP), providing a principled RL framework for training models to use tools effectively. It introduces **Advantage Shaping Policy Optimization (ASPO)**, a variant of PPO that adds adaptive reward shaping to balance process- and outcome-based learning.\n\n**Mathematical formulation:** The ASPO objective is:\n\n*   where A(a,h)A(a,h)A(a,h) is the _shaped advantage_ incorporating both immediate (stepwise) and final (outcome) signals, and ββ\\\\beta controls regularization against a reference policy.\n\n**Implementation Highlights:**\n\n*   Trains a 7B model on symbolic reasoning tasks.\n*   Adds _step-level shaping_ to encourage timely tool use and verification behavior.\n*   Significantly stabilizes RL optimization, improving both training and test accuracy by >6%.",
    "order": 61,
    "orderInChapter": 1,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "optimization",
      "regularization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 257,
      "contentLength": 21486
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#foundations-and-theoretical-advancements-in-tir",
    "scrapedAt": "2025-12-28T11:47:36.155Z"
  },
  {
    "id": "ai-agentic-RL-practical-engineering-for-stable-multi-turn-tir-62",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Tool-Integrated Reasoning",
    "title": "Practical Engineering for Stable Multi-Turn TIR",
    "subtitle": "Tool-Integrated Reasoning",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Core Idea:</strong> <a href=\"https://arxiv.org/abs/2509.02479\">SimpleTIR: End-to-End Reinforcement Learning for Multi-Turn Tool-Integrated Reasoning</a> by Xue et al. (2025) addresses the <em>instability problem</em> of multi-turn TIR. It isolates the causes of divergence during RL fine-tuning—such as gradient explosions and unproductive tool calls—and proposes three stabilizing strategies.</p>\n  </li>\n  <li>\n    <p><strong>Key Contributions:</strong></p>\n\n    <ol>\n      <li><strong>Input-Gradient Norm Limiter</strong>: caps backpropagation magnitude when token probabilities are extremely low.</li>\n      <li><strong>Interpreter Output Masking</strong>: prevents gradients from flowing through non-learnable tool feedback.</li>\n      <li><strong>Void Turn Filtering</strong>: removes steps with empty or redundant tool responses.</li>\n    </ol>\n  </li>\n  <li>\n    <p><strong>Empirical Findings:</strong></p>\n\n    <ul>\n      <li>Using Qwen2.5-7B, SimpleTIR achieves faster convergence on AIME24.</li>\n      <li>Gradient clipping alone improved reward variance stability by 25%.</li>\n      <li>Masking and filtering yield additional 5–8% accuracy gains.</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Core Idea:</strong> <a href=\"https://arxiv.org/abs/2509.02479\">SimpleTIR: End-to-End Reinforcement Learning for Multi-Turn Tool-Integrated Reasoning</a> by Xue et al. (2025) addresses the <em>instability problem</em> of multi-turn TIR. It isolates the causes of divergence during RL fine-tuning—such as gradient explosions and unproductive tool calls—and proposes three stabilizing strategies.</p>\n<p><strong>Key Contributions:</strong></p>\n<ol>\n      <li><strong>Input-Gradient Norm Limiter</strong>: caps backpropagation magnitude when token probabilities are extremely low.</li>\n      <li><strong>Interpreter Output Masking</strong>: prevents gradients from flowing through non-learnable tool feedback.</li>\n      <li><strong>Void Turn Filtering</strong>: removes steps with empty or redundant tool responses.</li>\n    </ol>\n<p><strong>Empirical Findings:</strong></p>\n<ul>\n      <li>Using Qwen2.5-7B, SimpleTIR achieves faster convergence on AIME24.</li>\n      <li>Gradient clipping alone improved reward variance stability by 25%.</li>\n      <li>Masking and filtering yield additional 5–8% accuracy gains.</li>\n    </ul>",
    "contentMarkdown": "*   **Core Idea:** [SimpleTIR: End-to-End Reinforcement Learning for Multi-Turn Tool-Integrated Reasoning](https://arxiv.org/abs/2509.02479) by Xue et al. (2025) addresses the _instability problem_ of multi-turn TIR. It isolates the causes of divergence during RL fine-tuning—such as gradient explosions and unproductive tool calls—and proposes three stabilizing strategies.\n    \n*   **Key Contributions:**\n    \n    1.  **Input-Gradient Norm Limiter**: caps backpropagation magnitude when token probabilities are extremely low.\n    2.  **Interpreter Output Masking**: prevents gradients from flowing through non-learnable tool feedback.\n    3.  **Void Turn Filtering**: removes steps with empty or redundant tool responses.\n*   **Empirical Findings:**\n    \n    *   Using Qwen2.5-7B, SimpleTIR achieves faster convergence on AIME24.\n    *   Gradient clipping alone improved reward variance stability by 25%.\n    *   Masking and filtering yield additional 5–8% accuracy gains.\n\n**Core Idea:** [SimpleTIR: End-to-End Reinforcement Learning for Multi-Turn Tool-Integrated Reasoning](https://arxiv.org/abs/2509.02479) by Xue et al. (2025) addresses the _instability problem_ of multi-turn TIR. It isolates the causes of divergence during RL fine-tuning—such as gradient explosions and unproductive tool calls—and proposes three stabilizing strategies.\n\n**Key Contributions:**\n\n1.  **Input-Gradient Norm Limiter**: caps backpropagation magnitude when token probabilities are extremely low.\n2.  **Interpreter Output Masking**: prevents gradients from flowing through non-learnable tool feedback.\n3.  **Void Turn Filtering**: removes steps with empty or redundant tool responses.\n\n**Empirical Findings:**\n\n*   Using Qwen2.5-7B, SimpleTIR achieves faster convergence on AIME24.\n*   Gradient clipping alone improved reward variance stability by 25%.\n*   Masking and filtering yield additional 5–8% accuracy gains.",
    "order": 62,
    "orderInChapter": 2,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "reinforcement learning",
      "backpropagation",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 225,
      "contentLength": 2351
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#practical-engineering-for-stable-multi-turn-tir",
    "scrapedAt": "2025-12-28T11:47:36.155Z"
  },
  {
    "id": "ai-agentic-RL-scaling-tool-integrated-rl-from-base-models-63",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Tool-Integrated Reasoning",
    "title": "Scaling Tool-Integrated RL from Base Models",
    "subtitle": "Tool-Integrated Reasoning",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Core Idea:</strong> <a href=\"https://arxiv.org/abs/2503.23383\">ToRL: Scaling Tool-Integrated Reinforcement Learning</a> by Xuefeng Li, Haoyang Zou, &amp; Pengfei Liu (2025) demonstrates that TIR can be trained <em>directly from base models</em> without any supervised fine-tuning, relying entirely on exploration and reinforcement signals. This approach bridges <em>outcome-based</em> reward optimization with emergent <em>process behavior</em>, such as model self-verification.</p>\n  </li>\n  <li>\n    <p><strong>Training Design:</strong></p>\n\n    <ul>\n      <li>Trains Qwen2.5-based models (1.5B and 7B) on five mathematical reasoning datasets.</li>\n      <li>\n        <p>Uses a pure correctness reward:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-355-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>a</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;><mtr><mtd><mn>1</mn><mo>,</mo></mtd><mtd><mtext>if&amp;#xA0;</mtext><mi>a</mi><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>a</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></mtd></mtr><mtr><mtd><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo></mtd><mtd><mtext>otherwise</mtext></mtd></mtr></mtable><mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;></mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5738\" style=\"width: 13.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.294em, 1011.51em, 4.846em, -999.997em); top: -3.799em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5739\"><span class=\"mi\" id=\"MathJax-Span-5740\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-5741\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5742\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-5743\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-5744\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-5745\"><span class=\"munderover\" id=\"MathJax-Span-5746\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5747\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5748\" style=\"font-family: STIXGeneral-Regular;\">̂&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5749\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5750\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mrow\" id=\"MathJax-Span-5751\" style=\"padding-left: 0.315em;\"><span class=\"mo\" id=\"MathJax-Span-5752\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">{</span></span></span><span class=\"mtable\" id=\"MathJax-Span-5753\" style=\"padding-right: 0.159em; padding-left: 0.159em;\"><span style=\"display: inline-block; position: relative; width: 6.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.607em, 1001.36em, 4.951em, -999.997em); top: -4.008em; left: 0em;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.581em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-5754\"><span class=\"mrow\" id=\"MathJax-Span-5755\"><span class=\"mn\" id=\"MathJax-Span-5756\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-5757\" style=\"font-family: STIXGeneral-Regular;\">,</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1001.36em, 4.326em, -999.997em); top: -3.331em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-5768\"><span class=\"mrow\" id=\"MathJax-Span-5769\"><span class=\"mo\" id=\"MathJax-Span-5770\" style=\"font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-5771\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-5772\" style=\"font-family: STIXGeneral-Regular;\">,</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(2.555em, 1003.86em, 4.846em, -999.997em); top: -4.008em; left: 2.555em;\"><span style=\"display: inline-block; position: relative; width: 3.909em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.128em, 1003.18em, 4.169em, -999.997em); top: -4.581em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-5758\"><span class=\"mrow\" id=\"MathJax-Span-5759\"><span class=\"mtext\" id=\"MathJax-Span-5760\" style=\"font-family: STIXGeneral-Regular;\">if&nbsp;</span><span class=\"mi\" id=\"MathJax-Span-5761\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-5762\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-5763\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-5764\"><span class=\"munderover\" id=\"MathJax-Span-5765\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5766\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5767\" style=\"font-family: STIXGeneral-Regular;\">̂&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.86em, 4.169em, -999.997em); top: -3.331em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-5773\"><span class=\"mrow\" id=\"MathJax-Span-5774\"><span class=\"mtext\" id=\"MathJax-Span-5775\" style=\"font-family: STIXGeneral-Regular;\">otherwise</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5776\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.805em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>a</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign=\"left left\" rowspacing=\".2em\" columnspacing=\"1em\" displaystyle=\"false\"><mtr><mtd><mn>1</mn><mo>,</mo></mtd><mtd><mtext>if&nbsp;</mtext><mi>a</mi><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>a</mi><mo stretchy=\"false\">^</mo></mover></mrow></mtd></mtr><mtr><mtd><mo>−</mo><mn>1</mn><mo>,</mo></mtd><mtd><mtext>otherwise</mtext></mtd></mtr></mtable><mo fence=\"true\" stretchy=\"true\" symmetric=\"true\"></mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-355\">R(a, \\hat{a}) =\n\\begin{cases}\n1, & \\text{if } a = \\hat{a} \\\\\n-1, & \\text{otherwise}\n\\end{cases}</script>\n      </li>\n      <li>No explicit shaping; only final-answer feedback drives learning.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Results:</strong></p>\n\n    <ul>\n      <li><strong>ToRL-7B</strong>: 43.3% on AIME24, 62.1% across math benchmarks.</li>\n      <li><strong>Emergent behaviors:</strong> self-verification and reflection loops, despite outcome-only reward.</li>\n      <li>Uses only <strong>28.7K</strong> training problems distilled from 75K candidates.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The following figure (<a href=\"https://arxiv.org/abs/2503.23383\">source</a>) shows an example of CoT and TIR solution of the problem. TIR enables the model to write code and call an interpreter to obtain the output of the executed code, and then perform further reasoning based on the execution results.</p>\n  </li>\n</ul>\n<p><strong>Core Idea:</strong> <a href=\"https://arxiv.org/abs/2503.23383\">ToRL: Scaling Tool-Integrated Reinforcement Learning</a> by Xuefeng Li, Haoyang Zou, &amp; Pengfei Liu (2025) demonstrates that TIR can be trained <em>directly from base models</em> without any supervised fine-tuning, relying entirely on exploration and reinforcement signals. This approach bridges <em>outcome-based</em> reward optimization with emergent <em>process behavior</em>, such as model self-verification.</p>\n<p><strong>Training Design:</strong></p>\n<ul>\n      <li>Trains Qwen2.5-based models (1.5B and 7B) on five mathematical reasoning datasets.</li>\n      <li>\n        <p>Uses a pure correctness reward:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-355-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>a</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;><mtr><mtd><mn>1</mn><mo>,</mo></mtd><mtd><mtext>if&amp;#xA0;</mtext><mi>a</mi><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>a</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></mtd></mtr><mtr><mtd><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo></mtd><mtd><mtext>otherwise</mtext></mtd></mtr></mtable><mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;></mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5738\" style=\"width: 13.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.294em, 1011.51em, 4.846em, -999.997em); top: -3.799em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5739\"><span class=\"mi\" id=\"MathJax-Span-5740\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-5741\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5742\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-5743\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-5744\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-5745\"><span class=\"munderover\" id=\"MathJax-Span-5746\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5747\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5748\" style=\"font-family: STIXGeneral-Regular;\">̂&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5749\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5750\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mrow\" id=\"MathJax-Span-5751\" style=\"padding-left: 0.315em;\"><span class=\"mo\" id=\"MathJax-Span-5752\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">{</span></span></span><span class=\"mtable\" id=\"MathJax-Span-5753\" style=\"padding-right: 0.159em; padding-left: 0.159em;\"><span style=\"display: inline-block; position: relative; width: 6.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.607em, 1001.36em, 4.951em, -999.997em); top: -4.008em; left: 0em;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.581em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-5754\"><span class=\"mrow\" id=\"MathJax-Span-5755\"><span class=\"mn\" id=\"MathJax-Span-5756\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-5757\" style=\"font-family: STIXGeneral-Regular;\">,</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1001.36em, 4.326em, -999.997em); top: -3.331em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-5768\"><span class=\"mrow\" id=\"MathJax-Span-5769\"><span class=\"mo\" id=\"MathJax-Span-5770\" style=\"font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-5771\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-5772\" style=\"font-family: STIXGeneral-Regular;\">,</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(2.555em, 1003.86em, 4.846em, -999.997em); top: -4.008em; left: 2.555em;\"><span style=\"display: inline-block; position: relative; width: 3.909em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.128em, 1003.18em, 4.169em, -999.997em); top: -4.581em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-5758\"><span class=\"mrow\" id=\"MathJax-Span-5759\"><span class=\"mtext\" id=\"MathJax-Span-5760\" style=\"font-family: STIXGeneral-Regular;\">if&nbsp;</span><span class=\"mi\" id=\"MathJax-Span-5761\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-5762\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-5763\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-5764\"><span class=\"munderover\" id=\"MathJax-Span-5765\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5766\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5767\" style=\"font-family: STIXGeneral-Regular;\">̂&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.86em, 4.169em, -999.997em); top: -3.331em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-5773\"><span class=\"mrow\" id=\"MathJax-Span-5774\"><span class=\"mtext\" id=\"MathJax-Span-5775\" style=\"font-family: STIXGeneral-Regular;\">otherwise</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5776\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.805em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>a</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign=\"left left\" rowspacing=\".2em\" columnspacing=\"1em\" displaystyle=\"false\"><mtr><mtd><mn>1</mn><mo>,</mo></mtd><mtd><mtext>if&nbsp;</mtext><mi>a</mi><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>a</mi><mo stretchy=\"false\">^</mo></mover></mrow></mtd></mtr><mtr><mtd><mo>−</mo><mn>1</mn><mo>,</mo></mtd><mtd><mtext>otherwise</mtext></mtd></mtr></mtable><mo fence=\"true\" stretchy=\"true\" symmetric=\"true\"></mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-355\">R(a, \\hat{a}) =\n\\begin{cases}\n1, & \\text{if } a = \\hat{a} \\\\\n-1, & \\text{otherwise}\n\\end{cases}</script>\n      </li>\n      <li>No explicit shaping; only final-answer feedback drives learning.</li>\n    </ul>\n<p>Uses a pure correctness reward:</p>\n<p><strong>Results:</strong></p>\n<ul>\n      <li><strong>ToRL-7B</strong>: 43.3% on AIME24, 62.1% across math benchmarks.</li>\n      <li><strong>Emergent behaviors:</strong> self-verification and reflection loops, despite outcome-only reward.</li>\n      <li>Uses only <strong>28.7K</strong> training problems distilled from 75K candidates.</li>\n    </ul>\n<p>The following figure (<a href=\"https://arxiv.org/abs/2503.23383\">source</a>) shows an example of CoT and TIR solution of the problem. TIR enables the model to write code and call an interpreter to obtain the output of the executed code, and then perform further reasoning based on the execution results.</p>\n<p><img src=\"/primers/ai/assets/RL-for-agents/ToRL.jpg\" alt=\"\"></p>",
    "contentMarkdown": "*   **Core Idea:** [ToRL: Scaling Tool-Integrated Reinforcement Learning](https://arxiv.org/abs/2503.23383) by Xuefeng Li, Haoyang Zou, & Pengfei Liu (2025) demonstrates that TIR can be trained _directly from base models_ without any supervised fine-tuning, relying entirely on exploration and reinforcement signals. This approach bridges _outcome-based_ reward optimization with emergent _process behavior_, such as model self-verification.\n    \n*   **Training Design:**\n    \n    *   Trains Qwen2.5-based models (1.5B and 7B) on five mathematical reasoning datasets.\n    *   Uses a pure correctness reward:\n        \n        R(a,â )\\={1,−1,if a\\=â otherwiseR(a,a^)\\={1,if a\\=a^−1,otherwise\n        \n        R(a, \\\\hat{a}) = \\\\begin{cases} 1, & \\\\text{if } a = \\\\hat{a} \\\\\\\\ -1, & \\\\text{otherwise} \\\\end{cases}\n    *   No explicit shaping; only final-answer feedback drives learning.\n*   **Results:**\n    \n    *   **ToRL-7B**: 43.3% on AIME24, 62.1% across math benchmarks.\n    *   **Emergent behaviors:** self-verification and reflection loops, despite outcome-only reward.\n    *   Uses only **28.7K** training problems distilled from 75K candidates.\n*   The following figure ([source](https://arxiv.org/abs/2503.23383)) shows an example of CoT and TIR solution of the problem. TIR enables the model to write code and call an interpreter to obtain the output of the executed code, and then perform further reasoning based on the execution results.\n    \n\n**Core Idea:** [ToRL: Scaling Tool-Integrated Reinforcement Learning](https://arxiv.org/abs/2503.23383) by Xuefeng Li, Haoyang Zou, & Pengfei Liu (2025) demonstrates that TIR can be trained _directly from base models_ without any supervised fine-tuning, relying entirely on exploration and reinforcement signals. This approach bridges _outcome-based_ reward optimization with emergent _process behavior_, such as model self-verification.\n\n**Training Design:**\n\n*   Trains Qwen2.5-based models (1.5B and 7B) on five mathematical reasoning datasets.\n*   Uses a pure correctness reward:\n    \n    R(a,â )\\={1,−1,if a\\=â otherwiseR(a,a^)\\={1,if a\\=a^−1,otherwise\n    \n    R(a, \\\\hat{a}) = \\\\begin{cases} 1, & \\\\text{if } a = \\\\hat{a} \\\\\\\\ -1, & \\\\text{otherwise} \\\\end{cases}\n*   No explicit shaping; only final-answer feedback drives learning.\n\nUses a pure correctness reward:\n\n**Results:**\n\n*   **ToRL-7B**: 43.3% on AIME24, 62.1% across math benchmarks.\n*   **Emergent behaviors:** self-verification and reflection loops, despite outcome-only reward.\n*   Uses only **28.7K** training problems distilled from 75K candidates.\n\nThe following figure ([source](https://arxiv.org/abs/2503.23383)) shows an example of CoT and TIR solution of the problem. TIR enables the model to write code and call an interpreter to obtain the output of the executed code, and then perform further reasoning based on the execution results.\n\n![](/primers/ai/assets/RL-for-agents/ToRL.jpg)",
    "order": 63,
    "orderInChapter": 3,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "reinforcement learning",
      "optimization",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 360,
      "contentLength": 20253
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#scaling-tool-integrated-rl-from-base-models",
    "scrapedAt": "2025-12-28T11:47:36.155Z"
  },
  {
    "id": "ai-agentic-RL-code-interleaved-reinforcement-for-tool-use-64",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Tool-Integrated Reasoning",
    "title": "Code-Interleaved Reinforcement for Tool Use",
    "subtitle": "Tool-Integrated Reasoning",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Core Idea:</strong> <a href=\"https://arxiv.org/abs/2504.11536\">ReTool: Reinforcement Learning for Strategic Tool Use in LLMs</a> by Jiazhan Feng et al. (2025) establishes a robust training pipeline for tool-integrated reasoning through <em>interleaved code execution</em>. It uses real-time interpreter feedback during RL rollouts to optimize for both tool efficiency and correctness.</p>\n  </li>\n  <li>\n    <p><strong>Training Stages:</strong></p>\n\n    <ol>\n      <li><strong>Cold-Start SFT</strong> on a verified <em>code-integrated dataset</em> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-356-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>C</mi><mi mathvariant=&quot;normal&quot;>I</mi></mrow></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5777\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.51em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5778\"><span class=\"msubsup\" id=\"MathJax-Span-5779\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5780\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-5781\"><span class=\"mrow\" id=\"MathJax-Span-5782\"><span class=\"texatom\" id=\"MathJax-Span-5783\"><span class=\"mrow\" id=\"MathJax-Span-5784\"><span class=\"mi\" id=\"MathJax-Span-5785\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">C</span><span class=\"mi\" id=\"MathJax-Span-5786\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">I</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">C</mi><mi mathvariant=\"normal\">I</mi></mrow></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-356\">D_{\\mathrm{CI}}</script>.</li>\n      <li><strong>Interleaved PPO</strong> where each generated code snippet is executed mid-rollout.</li>\n    </ol>\n  </li>\n  <li>\n    <p><strong>Modified PPO Objective:</strong></p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-357-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>J</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ReTool</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>[</mo></mrow><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>(</mo></mrow><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>;</mo><mtext>CI</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>;</mo><mtext>CI</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub><mo>,</mo><mtext>clip</mtext><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>)</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5787\" style=\"width: 24.482em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.982em, 1020.16em, 4.534em, -999.997em); top: -3.487em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5788\"><span class=\"msubsup\" id=\"MathJax-Span-5789\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5790\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5791\"><span class=\"mrow\" id=\"MathJax-Span-5792\"><span class=\"mtext\" id=\"MathJax-Span-5793\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ReTool</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5794\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5795\" style=\"font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5796\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5797\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-5798\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-5799\"><span class=\"mi\" id=\"MathJax-Span-5800\" style=\"font-family: STIXGeneral-Regular;\">𝔼</span></span></span><span class=\"texatom\" id=\"MathJax-Span-5801\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-5802\"><span class=\"mo\" id=\"MathJax-Span-5803\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">[</span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5804\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">min</span><span class=\"texatom\" id=\"MathJax-Span-5805\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-5806\"><span class=\"mo\" id=\"MathJax-Span-5807\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">(</span></span></span></span><span class=\"mfrac\" id=\"MathJax-Span-5808\"><span style=\"display: inline-block; position: relative; width: 5.523em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1004.79em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -2.445em;\"><span class=\"mrow\" id=\"MathJax-Span-5809\"><span class=\"msubsup\" id=\"MathJax-Span-5810\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5811\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5812\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5813\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5814\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5815\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5816\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-5817\"><span class=\"mrow\" id=\"MathJax-Span-5818\"><span class=\"mo\" id=\"MathJax-Span-5819\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5820\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5821\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5822\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5823\" style=\"font-family: STIXGeneral-Regular;\">;</span><span class=\"mtext\" id=\"MathJax-Span-5824\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">CI</span><span class=\"mo\" id=\"MathJax-Span-5825\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1005.37em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -2.706em;\"><span class=\"mrow\" id=\"MathJax-Span-5826\"><span class=\"msubsup\" id=\"MathJax-Span-5827\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5828\" style=\"font-family: STIXGeneral-Italic;\">π<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5829\"><span class=\"mrow\" id=\"MathJax-Span-5830\"><span class=\"mtext\" id=\"MathJax-Span-5831\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5832\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5833\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5834\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5835\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-5836\"><span class=\"mrow\" id=\"MathJax-Span-5837\"><span class=\"mo\" id=\"MathJax-Span-5838\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5839\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5840\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5841\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5842\" style=\"font-family: STIXGeneral-Regular;\">;</span><span class=\"mtext\" id=\"MathJax-Span-5843\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">CI</span><span class=\"mo\" id=\"MathJax-Span-5844\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1005.52em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.523em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5845\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5846\"><span class=\"mrow\" id=\"MathJax-Span-5847\"><span class=\"munderover\" id=\"MathJax-Span-5848\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5849\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5850\" style=\"font-family: STIXGeneral-Regular;\">̂&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5851\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5852\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-5853\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">clip</span><span class=\"mo\" id=\"MathJax-Span-5854\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-5855\" style=\"font-family: STIXGeneral-Regular;\">⋅</span><span class=\"mo\" id=\"MathJax-Span-5856\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-5857\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5858\"><span class=\"mrow\" id=\"MathJax-Span-5859\"><span class=\"munderover\" id=\"MathJax-Span-5860\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5861\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5862\" style=\"font-family: STIXGeneral-Regular;\">̂&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5863\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-5864\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-5865\"><span class=\"mo\" id=\"MathJax-Span-5866\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">)</span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-5867\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-5868\"><span class=\"mo\" id=\"MathJax-Span-5869\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">]</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.492em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>J</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ReTool</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">[</mo></mrow><mo movablelimits=\"true\" form=\"prefix\">min</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">(</mo></mrow><mfrac><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>;</mo><mtext>CI</mtext><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>π</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>;</mo><mtext>CI</mtext><mo stretchy=\"false\">)</mo></mrow></mfrac><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub><mo>,</mo><mtext>clip</mtext><mo stretchy=\"false\">(</mo><mo>⋅</mo><mo stretchy=\"false\">)</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">)</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-357\">J_{\\text{ReTool}}(\\theta) =\n\\mathbb{E}\\Big[\\min\\Big(\\frac{\\pi_\\theta(o_t|s_t;\\text{CI})}{\\pi_{\\text{old}}(o_t|s_t;\\text{CI})}\\hat{A}_t,\n\\text{clip}(\\cdot)\\hat{A}_t\\Big)\\Big]</script>\n  </li>\n  <li>\n    <p><strong>Key Findings:</strong></p>\n\n    <ul>\n      <li>Yields 27% higher accuracy over text-only PPO on AIME24.</li>\n      <li>Reduces reasoning token length by 40%.</li>\n      <li>Learns <em>strategic invocation</em>—earlier, more efficient, and self-corrective tool calls.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The following figure (<a href=\"https://arxiv.org/abs/2504.11536\">source</a>) shows text-based RL training process and ReTool’s RL training process.</p>\n  </li>\n</ul>\n<p><strong>Core Idea:</strong> <a href=\"https://arxiv.org/abs/2504.11536\">ReTool: Reinforcement Learning for Strategic Tool Use in LLMs</a> by Jiazhan Feng et al. (2025) establishes a robust training pipeline for tool-integrated reasoning through <em>interleaved code execution</em>. It uses real-time interpreter feedback during RL rollouts to optimize for both tool efficiency and correctness.</p>\n<p><strong>Training Stages:</strong></p>\n<ol>\n      <li><strong>Cold-Start SFT</strong> on a verified <em>code-integrated dataset</em> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-356-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>C</mi><mi mathvariant=&quot;normal&quot;>I</mi></mrow></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5777\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.51em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5778\"><span class=\"msubsup\" id=\"MathJax-Span-5779\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5780\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-5781\"><span class=\"mrow\" id=\"MathJax-Span-5782\"><span class=\"texatom\" id=\"MathJax-Span-5783\"><span class=\"mrow\" id=\"MathJax-Span-5784\"><span class=\"mi\" id=\"MathJax-Span-5785\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">C</span><span class=\"mi\" id=\"MathJax-Span-5786\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">I</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">C</mi><mi mathvariant=\"normal\">I</mi></mrow></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-356\">D_{\\mathrm{CI}}</script>.</li>\n      <li><strong>Interleaved PPO</strong> where each generated code snippet is executed mid-rollout.</li>\n    </ol>\n<p><strong>Modified PPO Objective:</strong></p>\n<p><strong>Key Findings:</strong></p>\n<ul>\n      <li>Yields 27% higher accuracy over text-only PPO on AIME24.</li>\n      <li>Reduces reasoning token length by 40%.</li>\n      <li>Learns <em>strategic invocation</em>—earlier, more efficient, and self-corrective tool calls.</li>\n    </ul>\n<p>The following figure (<a href=\"https://arxiv.org/abs/2504.11536\">source</a>) shows text-based RL training process and ReTool’s RL training process.</p>\n<p><img src=\"/primers/ai/assets/RL-for-agents/ReTool.jpg\" alt=\"\"></p>",
    "contentMarkdown": "*   **Core Idea:** [ReTool: Reinforcement Learning for Strategic Tool Use in LLMs](https://arxiv.org/abs/2504.11536) by Jiazhan Feng et al. (2025) establishes a robust training pipeline for tool-integrated reasoning through _interleaved code execution_. It uses real-time interpreter feedback during RL rollouts to optimize for both tool efficiency and correctness.\n    \n*   **Training Stages:**\n    \n    1.  **Cold-Start SFT** on a verified _code-integrated dataset_ DCIDCID\\_{\\\\mathrm{CI}}.\n    2.  **Interleaved PPO** where each generated code snippet is executed mid-rollout.\n*   **Modified PPO Objective:**\n    \n    JReTool(θ)\\=𝔼\\[min(πθ(ot|st;CI)πold(ot|st;CI)Â t,clip(⋅)Â t)\\]JReTool(θ)\\=E\\[min(πθ(ot|st;CI)πold(ot|st;CI)A^t,clip(⋅)A^t)\\]\n    \n    J\\_{\\\\text{ReTool}}(\\\\theta) = \\\\mathbb{E}\\\\Big\\[\\\\min\\\\Big(\\\\frac{\\\\pi\\_\\\\theta(o\\_t|s\\_t;\\\\text{CI})}{\\\\pi\\_{\\\\text{old}}(o\\_t|s\\_t;\\\\text{CI})}\\\\hat{A}\\_t, \\\\text{clip}(\\\\cdot)\\\\hat{A}\\_t\\\\Big)\\\\Big\\]\n*   **Key Findings:**\n    \n    *   Yields 27% higher accuracy over text-only PPO on AIME24.\n    *   Reduces reasoning token length by 40%.\n    *   Learns _strategic invocation_—earlier, more efficient, and self-corrective tool calls.\n*   The following figure ([source](https://arxiv.org/abs/2504.11536)) shows text-based RL training process and ReTool’s RL training process.\n    \n\n**Core Idea:** [ReTool: Reinforcement Learning for Strategic Tool Use in LLMs](https://arxiv.org/abs/2504.11536) by Jiazhan Feng et al. (2025) establishes a robust training pipeline for tool-integrated reasoning through _interleaved code execution_. It uses real-time interpreter feedback during RL rollouts to optimize for both tool efficiency and correctness.\n\n**Training Stages:**\n\n1.  **Cold-Start SFT** on a verified _code-integrated dataset_ DCIDCID\\_{\\\\mathrm{CI}}.\n2.  **Interleaved PPO** where each generated code snippet is executed mid-rollout.\n\n**Modified PPO Objective:**\n\n**Key Findings:**\n\n*   Yields 27% higher accuracy over text-only PPO on AIME24.\n*   Reduces reasoning token length by 40%.\n*   Learns _strategic invocation_—earlier, more efficient, and self-corrective tool calls.\n\nThe following figure ([source](https://arxiv.org/abs/2504.11536)) shows text-based RL training process and ReTool’s RL training process.\n\n![](/primers/ai/assets/RL-for-agents/ReTool.jpg)",
    "order": 64,
    "orderInChapter": 4,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 239,
      "contentLength": 25793
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#code-interleaved-reinforcement-for-tool-use",
    "scrapedAt": "2025-12-28T11:47:36.155Z"
  },
  {
    "id": "ai-agentic-RL-tool-augmented-evaluation-agents-65",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Tool-Integrated Reasoning",
    "title": "Tool-Augmented Evaluation Agents",
    "subtitle": "Tool-Integrated Reasoning",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Core Idea:</strong> <a href=\"https://arxiv.org/abs/2510.23038\">Incentivizing Agentic Reasoning in LLM Judges via Tool-Integrated Reinforcement Learning</a> by Ran Xu et al. (2025) extends TIR to <strong>evaluation agents (judges)</strong>, which assess model outputs using executable verification tools. It integrates reinforcement learning to make LLM judges <em>agentic</em>—capable of reasoning, verifying, and scoring autonomously.</p>\n  </li>\n  <li>\n    <p><strong>Methodology:</strong></p>\n\n    <ul>\n      <li>Trains judges on three evaluation paradigms: <strong>pointwise</strong>, <strong>pairwise</strong>, and <strong>listwise</strong>.</li>\n      <li>\n        <p>Each trajectory involves both reasoning and code execution:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-358-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>k</mi></msub><mo>,</mo><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><msub><mi>J</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>&amp;#x2295;</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mi>o</mi><mi>k</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mi>s</mi><mi>k</mi></msub><mo>=</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>&amp;#x2295;</mo><msub><mi>r</mi><mi>k</mi></msub><mo>&amp;#x2295;</mo><msub><mi>c</mi><mi>k</mi></msub><mo>&amp;#x2295;</mo><msub><mi>o</mi><mi>k</mi></msub><mo>.</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5870\" style=\"width: 31.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 26.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1026.1em, 2.659em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5871\"><span class=\"mo\" id=\"MathJax-Span-5872\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5873\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5874\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5875\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5876\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5877\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5878\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5879\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5880\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5881\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∼</span><span class=\"msubsup\" id=\"MathJax-Span-5882\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5883\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5884\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5885\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5886\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5887\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">⊕</span><span class=\"msubsup\" id=\"MathJax-Span-5888\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5889\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5890\"><span class=\"mrow\" id=\"MathJax-Span-5891\"><span class=\"mi\" id=\"MathJax-Span-5892\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5893\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-5894\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5895\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5896\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-5897\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-5898\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5899\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5900\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5901\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-5902\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5903\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5904\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5905\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5906\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5907\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5908\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-5909\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-5910\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5911\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5912\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5913\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5914\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5915\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5916\"><span class=\"mrow\" id=\"MathJax-Span-5917\"><span class=\"mi\" id=\"MathJax-Span-5918\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5919\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-5920\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5921\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">⊕</span><span class=\"msubsup\" id=\"MathJax-Span-5922\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5923\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5924\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5925\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">⊕</span><span class=\"msubsup\" id=\"MathJax-Span-5926\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5927\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5928\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5929\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">⊕</span><span class=\"msubsup\" id=\"MathJax-Span-5930\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5931\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5932\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5933\" style=\"font-family: STIXGeneral-Regular;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>k</mi></msub><mo>,</mo><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo><mo>∼</mo><msub><mi>J</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>⊕</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mspace width=\"1em\"></mspace><msub><mi>o</mi><mi>k</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=\"false\">(</mo><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mspace width=\"1em\"></mspace><msub><mi>s</mi><mi>k</mi></msub><mo>=</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⊕</mo><msub><mi>r</mi><mi>k</mi></msub><mo>⊕</mo><msub><mi>c</mi><mi>k</mi></msub><mo>⊕</mo><msub><mi>o</mi><mi>k</mi></msub><mo>.</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-358\">(r_k, c_k) \\sim J_\\theta(x \\oplus s_{k-1}), \\quad o_k = I(c_k), \\quad s_k = s_{k-1} \\oplus r_k \\oplus c_k \\oplus o_k.</script></p>\n      </li>\n      <li>\n        <p>Two variants:</p>\n\n        <ul>\n          <li><strong>TIR-Judge-Distill:</strong> RL fine-tuning from distilled checkpoint.</li>\n          <li><strong>TIR-Judge-Zero:</strong> trained from scratch via self-play RL.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Results:</strong></p>\n\n    <ul>\n      <li>TIR-Judge-Zero performs comparably to distilled models.</li>\n      <li>Improves pairwise evaluation accuracy by +7.7%.</li>\n      <li>Enables <em>verifiable</em> judgment by using executable tool outputs.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The following figure (<a href=\"https://arxiv.org/abs/2510.23038\">source</a>) shows the overall framework of TIR-Judge variants. TIR-Judge natively supports tool use during judgment and is designed to handle diverse input formats.</p>\n  </li>\n</ul>\n<p><strong>Core Idea:</strong> <a href=\"https://arxiv.org/abs/2510.23038\">Incentivizing Agentic Reasoning in LLM Judges via Tool-Integrated Reinforcement Learning</a> by Ran Xu et al. (2025) extends TIR to <strong>evaluation agents (judges)</strong>, which assess model outputs using executable verification tools. It integrates reinforcement learning to make LLM judges <em>agentic</em>—capable of reasoning, verifying, and scoring autonomously.</p>\n<p><strong>Methodology:</strong></p>\n<ul>\n      <li>Trains judges on three evaluation paradigms: <strong>pointwise</strong>, <strong>pairwise</strong>, and <strong>listwise</strong>.</li>\n      <li>\n        <p>Each trajectory involves both reasoning and code execution:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-358-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>k</mi></msub><mo>,</mo><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><msub><mi>J</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>&amp;#x2295;</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mi>o</mi><mi>k</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mi>s</mi><mi>k</mi></msub><mo>=</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>&amp;#x2295;</mo><msub><mi>r</mi><mi>k</mi></msub><mo>&amp;#x2295;</mo><msub><mi>c</mi><mi>k</mi></msub><mo>&amp;#x2295;</mo><msub><mi>o</mi><mi>k</mi></msub><mo>.</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5870\" style=\"width: 31.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 26.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1026.1em, 2.659em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5871\"><span class=\"mo\" id=\"MathJax-Span-5872\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5873\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5874\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5875\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5876\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5877\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5878\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5879\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5880\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5881\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∼</span><span class=\"msubsup\" id=\"MathJax-Span-5882\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5883\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5884\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5885\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5886\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5887\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">⊕</span><span class=\"msubsup\" id=\"MathJax-Span-5888\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5889\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5890\"><span class=\"mrow\" id=\"MathJax-Span-5891\"><span class=\"mi\" id=\"MathJax-Span-5892\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5893\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-5894\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5895\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5896\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-5897\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-5898\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5899\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5900\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5901\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-5902\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5903\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5904\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5905\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5906\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5907\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5908\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-5909\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-5910\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5911\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5912\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5913\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5914\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5915\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5916\"><span class=\"mrow\" id=\"MathJax-Span-5917\"><span class=\"mi\" id=\"MathJax-Span-5918\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5919\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-5920\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5921\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">⊕</span><span class=\"msubsup\" id=\"MathJax-Span-5922\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5923\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5924\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5925\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">⊕</span><span class=\"msubsup\" id=\"MathJax-Span-5926\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5927\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5928\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5929\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">⊕</span><span class=\"msubsup\" id=\"MathJax-Span-5930\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5931\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5932\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5933\" style=\"font-family: STIXGeneral-Regular;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>k</mi></msub><mo>,</mo><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo><mo>∼</mo><msub><mi>J</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>⊕</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mspace width=\"1em\"></mspace><msub><mi>o</mi><mi>k</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=\"false\">(</mo><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mspace width=\"1em\"></mspace><msub><mi>s</mi><mi>k</mi></msub><mo>=</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⊕</mo><msub><mi>r</mi><mi>k</mi></msub><mo>⊕</mo><msub><mi>c</mi><mi>k</mi></msub><mo>⊕</mo><msub><mi>o</mi><mi>k</mi></msub><mo>.</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-358\">(r_k, c_k) \\sim J_\\theta(x \\oplus s_{k-1}), \\quad o_k = I(c_k), \\quad s_k = s_{k-1} \\oplus r_k \\oplus c_k \\oplus o_k.</script></p>\n      </li>\n      <li>\n        <p>Two variants:</p>\n\n        <ul>\n          <li><strong>TIR-Judge-Distill:</strong> RL fine-tuning from distilled checkpoint.</li>\n          <li><strong>TIR-Judge-Zero:</strong> trained from scratch via self-play RL.</li>\n        </ul>\n      </li>\n    </ul>\n<p>Each trajectory involves both reasoning and code execution:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-358-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>k</mi></msub><mo>,</mo><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><msub><mi>J</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>&amp;#x2295;</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mi>o</mi><mi>k</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mi>s</mi><mi>k</mi></msub><mo>=</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>&amp;#x2295;</mo><msub><mi>r</mi><mi>k</mi></msub><mo>&amp;#x2295;</mo><msub><mi>c</mi><mi>k</mi></msub><mo>&amp;#x2295;</mo><msub><mi>o</mi><mi>k</mi></msub><mo>.</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5870\" style=\"width: 31.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 26.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1026.1em, 2.659em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5871\"><span class=\"mo\" id=\"MathJax-Span-5872\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5873\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5874\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5875\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5876\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5877\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5878\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5879\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5880\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5881\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">∼</span><span class=\"msubsup\" id=\"MathJax-Span-5882\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5883\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5884\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">θ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5885\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5886\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5887\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">⊕</span><span class=\"msubsup\" id=\"MathJax-Span-5888\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5889\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5890\"><span class=\"mrow\" id=\"MathJax-Span-5891\"><span class=\"mi\" id=\"MathJax-Span-5892\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5893\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-5894\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5895\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5896\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-5897\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-5898\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5899\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5900\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5901\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-5902\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5903\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5904\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5905\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5906\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5907\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5908\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-5909\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-5910\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5911\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5912\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5913\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5914\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5915\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5916\"><span class=\"mrow\" id=\"MathJax-Span-5917\"><span class=\"mi\" id=\"MathJax-Span-5918\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5919\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">−</span><span class=\"mn\" id=\"MathJax-Span-5920\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5921\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">⊕</span><span class=\"msubsup\" id=\"MathJax-Span-5922\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5923\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5924\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5925\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">⊕</span><span class=\"msubsup\" id=\"MathJax-Span-5926\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5927\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5928\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5929\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">⊕</span><span class=\"msubsup\" id=\"MathJax-Span-5930\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5931\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5932\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5933\" style=\"font-family: STIXGeneral-Regular;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>k</mi></msub><mo>,</mo><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo><mo>∼</mo><msub><mi>J</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>⊕</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mspace width=\"1em\"></mspace><msub><mi>o</mi><mi>k</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=\"false\">(</mo><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mspace width=\"1em\"></mspace><msub><mi>s</mi><mi>k</mi></msub><mo>=</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⊕</mo><msub><mi>r</mi><mi>k</mi></msub><mo>⊕</mo><msub><mi>c</mi><mi>k</mi></msub><mo>⊕</mo><msub><mi>o</mi><mi>k</mi></msub><mo>.</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-358\">(r_k, c_k) \\sim J_\\theta(x \\oplus s_{k-1}), \\quad o_k = I(c_k), \\quad s_k = s_{k-1} \\oplus r_k \\oplus c_k \\oplus o_k.</script></p>\n<p>Two variants:</p>\n<ul>\n          <li><strong>TIR-Judge-Distill:</strong> RL fine-tuning from distilled checkpoint.</li>\n          <li><strong>TIR-Judge-Zero:</strong> trained from scratch via self-play RL.</li>\n        </ul>\n<p><strong>Results:</strong></p>\n<ul>\n      <li>TIR-Judge-Zero performs comparably to distilled models.</li>\n      <li>Improves pairwise evaluation accuracy by +7.7%.</li>\n      <li>Enables <em>verifiable</em> judgment by using executable tool outputs.</li>\n    </ul>\n<p>The following figure (<a href=\"https://arxiv.org/abs/2510.23038\">source</a>) shows the overall framework of TIR-Judge variants. TIR-Judge natively supports tool use during judgment and is designed to handle diverse input formats.</p>\n<p><img src=\"/primers/ai/assets/RL-for-agents/TIR-Judge.jpg\" alt=\"\"></p>",
    "contentMarkdown": "*   **Core Idea:** [Incentivizing Agentic Reasoning in LLM Judges via Tool-Integrated Reinforcement Learning](https://arxiv.org/abs/2510.23038) by Ran Xu et al. (2025) extends TIR to **evaluation agents (judges)**, which assess model outputs using executable verification tools. It integrates reinforcement learning to make LLM judges _agentic_—capable of reasoning, verifying, and scoring autonomously.\n    \n*   **Methodology:**\n    \n    *   Trains judges on three evaluation paradigms: **pointwise**, **pairwise**, and **listwise**.\n    *   Each trajectory involves both reasoning and code execution: (rk,ck)∼Jθ(x⊕sk−1),ok\\=I(ck),sk\\=sk−1⊕rk⊕ck⊕ok.(rk,ck)∼Jθ(x⊕sk−1),ok\\=I(ck),sk\\=sk−1⊕rk⊕ck⊕ok.(r\\_k, c\\_k) \\\\sim J\\_\\\\theta(x \\\\oplus s\\_{k-1}), \\\\quad o\\_k = I(c\\_k), \\\\quad s\\_k = s\\_{k-1} \\\\oplus r\\_k \\\\oplus c\\_k \\\\oplus o\\_k.\n        \n    *   Two variants:\n        \n        *   **TIR-Judge-Distill:** RL fine-tuning from distilled checkpoint.\n        *   **TIR-Judge-Zero:** trained from scratch via self-play RL.\n*   **Results:**\n    \n    *   TIR-Judge-Zero performs comparably to distilled models.\n    *   Improves pairwise evaluation accuracy by +7.7%.\n    *   Enables _verifiable_ judgment by using executable tool outputs.\n*   The following figure ([source](https://arxiv.org/abs/2510.23038)) shows the overall framework of TIR-Judge variants. TIR-Judge natively supports tool use during judgment and is designed to handle diverse input formats.\n    \n\n**Core Idea:** [Incentivizing Agentic Reasoning in LLM Judges via Tool-Integrated Reinforcement Learning](https://arxiv.org/abs/2510.23038) by Ran Xu et al. (2025) extends TIR to **evaluation agents (judges)**, which assess model outputs using executable verification tools. It integrates reinforcement learning to make LLM judges _agentic_—capable of reasoning, verifying, and scoring autonomously.\n\n**Methodology:**\n\n*   Trains judges on three evaluation paradigms: **pointwise**, **pairwise**, and **listwise**.\n*   Each trajectory involves both reasoning and code execution: (rk,ck)∼Jθ(x⊕sk−1),ok\\=I(ck),sk\\=sk−1⊕rk⊕ck⊕ok.(rk,ck)∼Jθ(x⊕sk−1),ok\\=I(ck),sk\\=sk−1⊕rk⊕ck⊕ok.(r\\_k, c\\_k) \\\\sim J\\_\\\\theta(x \\\\oplus s\\_{k-1}), \\\\quad o\\_k = I(c\\_k), \\\\quad s\\_k = s\\_{k-1} \\\\oplus r\\_k \\\\oplus c\\_k \\\\oplus o\\_k.\n    \n*   Two variants:\n    \n    *   **TIR-Judge-Distill:** RL fine-tuning from distilled checkpoint.\n    *   **TIR-Judge-Zero:** trained from scratch via self-play RL.\n\nEach trajectory involves both reasoning and code execution: (rk,ck)∼Jθ(x⊕sk−1),ok\\=I(ck),sk\\=sk−1⊕rk⊕ck⊕ok.(rk,ck)∼Jθ(x⊕sk−1),ok\\=I(ck),sk\\=sk−1⊕rk⊕ck⊕ok.(r\\_k, c\\_k) \\\\sim J\\_\\\\theta(x \\\\oplus s\\_{k-1}), \\\\quad o\\_k = I(c\\_k), \\\\quad s\\_k = s\\_{k-1} \\\\oplus r\\_k \\\\oplus c\\_k \\\\oplus o\\_k.\n\nTwo variants:\n\n*   **TIR-Judge-Distill:** RL fine-tuning from distilled checkpoint.\n*   **TIR-Judge-Zero:** trained from scratch via self-play RL.\n\n**Results:**\n\n*   TIR-Judge-Zero performs comparably to distilled models.\n*   Improves pairwise evaluation accuracy by +7.7%.\n*   Enables _verifiable_ judgment by using executable tool outputs.\n\nThe following figure ([source](https://arxiv.org/abs/2510.23038)) shows the overall framework of TIR-Judge variants. TIR-Judge natively supports tool use during judgment and is designed to handle diverse input formats.\n\n![](/primers/ai/assets/RL-for-agents/TIR-Judge.jpg)",
    "order": 65,
    "orderInChapter": 5,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "reinforcement learning",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 362,
      "contentLength": 48594
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#tool-augmented-evaluation-agents",
    "scrapedAt": "2025-12-28T11:47:36.155Z"
  },
  {
    "id": "ai-agentic-RL-synthesizing-trends-in-tir-rl-integration-66",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Tool-Integrated Reasoning",
    "title": "Synthesizing Trends in TIR + RL Integration",
    "subtitle": "Tool-Integrated Reasoning",
    "contentHtml": "<ul>\n  <li>Across these works, TIR emerges as the unifying interface between <em>language</em> and <em>computation</em>. Each study progressively strengthens one aspect of the TIR-RL ecosystem:</li>\n</ul>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Group</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Representative Paper</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Main Contribution</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reward Type</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Emergent Capability</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">1</td>\n<td class=\"tg-tleft-valign-first\"><em>Understanding TIR</em></td>\n<td class=\"tg-tleft-valign-first\">Theoretical formalization (ASPO)</td>\n<td class=\"tg-tleft-valign-first\">Stepwise + Outcome</td>\n<td class=\"tg-tleft-valign-second\">Advantage shaping &amp; stability</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">2</td>\n<td class=\"tg-tleft-valign-first\"><em>SimpleTIR</em></td>\n<td class=\"tg-tleft-valign-first\">Stabilization in multi-turn settings</td>\n<td class=\"tg-tleft-valign-first\">Stepwise</td>\n<td class=\"tg-tleft-valign-second\">Controlled gradient flow</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">3</td>\n<td class=\"tg-tleft-valign-first\"><em>ToRL</em></td>\n<td class=\"tg-tleft-valign-first\">Scaling from base models</td>\n<td class=\"tg-tleft-valign-first\">Outcome-only</td>\n<td class=\"tg-tleft-valign-second\">Emergent verification</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">4</td>\n<td class=\"tg-tleft-valign-first\"><em>ReTool</em></td>\n<td class=\"tg-tleft-valign-first\">Interleaved code execution</td>\n<td class=\"tg-tleft-valign-first\">Outcome-only</td>\n<td class=\"tg-tleft-valign-second\">Strategic tool use</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">5</td>\n<td class=\"tg-tleft-valign-first\"><em>TIR-Judge</em></td>\n<td class=\"tg-tleft-valign-first\">Tool-augmented evaluation</td>\n<td class=\"tg-tleft-valign-first\">Multi-level</td>\n<td class=\"tg-tleft-valign-second\">Self-verifying reward models</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Group</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Representative Paper</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Main Contribution</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reward Type</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Emergent Capability</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">1</td>\n<td class=\"tg-tleft-valign-first\"><em>Understanding TIR</em></td>\n<td class=\"tg-tleft-valign-first\">Theoretical formalization (ASPO)</td>\n<td class=\"tg-tleft-valign-first\">Stepwise + Outcome</td>\n<td class=\"tg-tleft-valign-second\">Advantage shaping &amp; stability</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">2</td>\n<td class=\"tg-tleft-valign-first\"><em>SimpleTIR</em></td>\n<td class=\"tg-tleft-valign-first\">Stabilization in multi-turn settings</td>\n<td class=\"tg-tleft-valign-first\">Stepwise</td>\n<td class=\"tg-tleft-valign-second\">Controlled gradient flow</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">3</td>\n<td class=\"tg-tleft-valign-first\"><em>ToRL</em></td>\n<td class=\"tg-tleft-valign-first\">Scaling from base models</td>\n<td class=\"tg-tleft-valign-first\">Outcome-only</td>\n<td class=\"tg-tleft-valign-second\">Emergent verification</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">4</td>\n<td class=\"tg-tleft-valign-first\"><em>ReTool</em></td>\n<td class=\"tg-tleft-valign-first\">Interleaved code execution</td>\n<td class=\"tg-tleft-valign-first\">Outcome-only</td>\n<td class=\"tg-tleft-valign-second\">Strategic tool use</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">5</td>\n<td class=\"tg-tleft-valign-first\"><em>TIR-Judge</em></td>\n<td class=\"tg-tleft-valign-first\">Tool-augmented evaluation</td>\n<td class=\"tg-tleft-valign-first\">Multi-level</td>\n<td class=\"tg-tleft-valign-second\">Self-verifying reward models</td>\n</tr>\n</tbody>\n</table>\n<ul>\n  <li>Together, these advances redefine RL for reasoning agents: from optimizing token probabilities to optimizing <strong>interactive decision-making with verifiable computation</strong>.</li>\n</ul>",
    "contentMarkdown": "*   Across these works, TIR emerges as the unifying interface between _language_ and _computation_. Each study progressively strengthens one aspect of the TIR-RL ecosystem:\n\n**Group**\n\n**Representative Paper**\n\n**Main Contribution**\n\n**Reward Type**\n\n**Emergent Capability**\n\n1\n\n_Understanding TIR_\n\nTheoretical formalization (ASPO)\n\nStepwise + Outcome\n\nAdvantage shaping & stability\n\n2\n\n_SimpleTIR_\n\nStabilization in multi-turn settings\n\nStepwise\n\nControlled gradient flow\n\n3\n\n_ToRL_\n\nScaling from base models\n\nOutcome-only\n\nEmergent verification\n\n4\n\n_ReTool_\n\nInterleaved code execution\n\nOutcome-only\n\nStrategic tool use\n\n5\n\n_TIR-Judge_\n\nTool-augmented evaluation\n\nMulti-level\n\nSelf-verifying reward models\n\n**Group**\n\n**Representative Paper**\n\n**Main Contribution**\n\n**Reward Type**\n\n**Emergent Capability**\n\n1\n\n_Understanding TIR_\n\nTheoretical formalization (ASPO)\n\nStepwise + Outcome\n\nAdvantage shaping & stability\n\n2\n\n_SimpleTIR_\n\nStabilization in multi-turn settings\n\nStepwise\n\nControlled gradient flow\n\n3\n\n_ToRL_\n\nScaling from base models\n\nOutcome-only\n\nEmergent verification\n\n4\n\n_ReTool_\n\nInterleaved code execution\n\nOutcome-only\n\nStrategic tool use\n\n5\n\n_TIR-Judge_\n\nTool-augmented evaluation\n\nMulti-level\n\nSelf-verifying reward models\n\n*   Together, these advances redefine RL for reasoning agents: from optimizing token probabilities to optimizing **interactive decision-making with verifiable computation**.",
    "order": 66,
    "orderInChapter": 6,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 160,
      "contentLength": 4285
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#synthesizing-trends-in-tir-+-rl-integration",
    "scrapedAt": "2025-12-28T11:47:36.155Z"
  },
  {
    "id": "ai-agentic-RL-synthesis-beyond-individual-tool-use-67",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Tool-Integrated Reasoning",
    "title": "Synthesis: Beyond Individual Tool Use",
    "subtitle": "Tool-Integrated Reasoning",
    "contentHtml": "<ul>\n  <li>Together, these works outline a continuum of Tool-Integrated RL:</li>\n</ul>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Framework</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Focus</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Environment Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Key Mechanism</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Performance Gain</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Li et al. (2025)</strong></td>\n<td class=\"tg-tleft-valign-first\">Mathematical reasoning</td>\n<td class=\"tg-tleft-valign-first\">Single-Turn Environments</td>\n<td class=\"tg-tleft-valign-first\">Code-augmented execution</td>\n<td class=\"tg-tleft-valign-second\">+13% accuracy</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Xue et al. (2025)</strong></td>\n<td class=\"tg-tleft-valign-first\">Multi-API orchestration</td>\n<td class=\"tg-tleft-valign-first\">Tool-Use Environments</td>\n<td class=\"tg-tleft-valign-first\">Composite action sequencing</td>\n<td class=\"tg-tleft-valign-second\">+35% efficiency</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Lin et al. (2025)</strong></td>\n<td class=\"tg-tleft-valign-first\">Multi-agent collaboration</td>\n<td class=\"tg-tleft-valign-first\">Multi-Turn Environments</td>\n<td class=\"tg-tleft-valign-first\">Cooperative reward sharing</td>\n<td class=\"tg-tleft-valign-second\">–42% exploration cost</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Framework</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Focus</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Environment Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Key Mechanism</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Performance Gain</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Li et al. (2025)</strong></td>\n<td class=\"tg-tleft-valign-first\">Mathematical reasoning</td>\n<td class=\"tg-tleft-valign-first\">Single-Turn Environments</td>\n<td class=\"tg-tleft-valign-first\">Code-augmented execution</td>\n<td class=\"tg-tleft-valign-second\">+13% accuracy</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Xue et al. (2025)</strong></td>\n<td class=\"tg-tleft-valign-first\">Multi-API orchestration</td>\n<td class=\"tg-tleft-valign-first\">Tool-Use Environments</td>\n<td class=\"tg-tleft-valign-first\">Composite action sequencing</td>\n<td class=\"tg-tleft-valign-second\">+35% efficiency</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Lin et al. (2025)</strong></td>\n<td class=\"tg-tleft-valign-first\">Multi-agent collaboration</td>\n<td class=\"tg-tleft-valign-first\">Multi-Turn Environments</td>\n<td class=\"tg-tleft-valign-first\">Cooperative reward sharing</td>\n<td class=\"tg-tleft-valign-second\">–42% exploration cost</td>\n</tr>\n</tbody>\n</table>\n<ul>\n  <li>\n    <p>These studies collectively show that <strong>tool use is no longer a static feature</strong>, but a <strong>learned behavior</strong>—optimized via RL to balance exploration, compositionality, and cooperation.</p>\n  </li>\n  <li>\n    <p>By embedding <strong>tool invocation</strong> into the policy space and integrating <strong>reward feedback</strong> from external computation, TIR-RL agents represent a new class of hybrid intelligence—merging the <em>symbolic precision of tools</em> with the <em>adaptive learning of reinforcement</em>.</p>\n  </li>\n</ul>\n<p>These studies collectively show that <strong>tool use is no longer a static feature</strong>, but a <strong>learned behavior</strong>—optimized via RL to balance exploration, compositionality, and cooperation.</p>\n<p>By embedding <strong>tool invocation</strong> into the policy space and integrating <strong>reward feedback</strong> from external computation, TIR-RL agents represent a new class of hybrid intelligence—merging the <em>symbolic precision of tools</em> with the <em>adaptive learning of reinforcement</em>.</p>",
    "contentMarkdown": "*   Together, these works outline a continuum of Tool-Integrated RL:\n\n**Framework**\n\n**Focus**\n\n**Environment Type**\n\n**Key Mechanism**\n\n**Performance Gain**\n\n**Li et al. (2025)**\n\nMathematical reasoning\n\nSingle-Turn Environments\n\nCode-augmented execution\n\n+13% accuracy\n\n**Xue et al. (2025)**\n\nMulti-API orchestration\n\nTool-Use Environments\n\nComposite action sequencing\n\n+35% efficiency\n\n**Lin et al. (2025)**\n\nMulti-agent collaboration\n\nMulti-Turn Environments\n\nCooperative reward sharing\n\n–42% exploration cost\n\n**Framework**\n\n**Focus**\n\n**Environment Type**\n\n**Key Mechanism**\n\n**Performance Gain**\n\n**Li et al. (2025)**\n\nMathematical reasoning\n\nSingle-Turn Environments\n\nCode-augmented execution\n\n+13% accuracy\n\n**Xue et al. (2025)**\n\nMulti-API orchestration\n\nTool-Use Environments\n\nComposite action sequencing\n\n+35% efficiency\n\n**Lin et al. (2025)**\n\nMulti-agent collaboration\n\nMulti-Turn Environments\n\nCooperative reward sharing\n\n–42% exploration cost\n\n*   These studies collectively show that **tool use is no longer a static feature**, but a **learned behavior**—optimized via RL to balance exploration, compositionality, and cooperation.\n    \n*   By embedding **tool invocation** into the policy space and integrating **reward feedback** from external computation, TIR-RL agents represent a new class of hybrid intelligence—merging the _symbolic precision of tools_ with the _adaptive learning of reinforcement_.\n    \n\nThese studies collectively show that **tool use is no longer a static feature**, but a **learned behavior**—optimized via RL to balance exploration, compositionality, and cooperation.\n\nBy embedding **tool invocation** into the policy space and integrating **reward feedback** from external computation, TIR-RL agents represent a new class of hybrid intelligence—merging the _symbolic precision of tools_ with the _adaptive learning of reinforcement_.",
    "order": 67,
    "orderInChapter": 7,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "embedding"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 226,
      "contentLength": 4081
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#synthesis:-beyond-individual-tool-use",
    "scrapedAt": "2025-12-28T11:47:36.155Z"
  },
  {
    "id": "ai-agentic-RL-unifying-rl-and-tir-process-vs-outcome-rewards-68",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Tool-Integrated Reasoning",
    "title": "Unifying RL and TIR: Process vs. Outcome Rewards",
    "subtitle": "Tool-Integrated Reasoning",
    "contentHtml": "<ul>\n  <li>\n    <p>TIR-based RL frameworks bridge <strong>process-wise</strong> and <strong>outcome-based</strong> rewards.</p>\n\n    <ul>\n      <li><strong>Process rewards</strong> measure reasoning correctness at intermediate tool-use steps (e.g., code executes without error).</li>\n      <li><strong>Outcome rewards</strong> evaluate the final correctness or verification success.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The total return function becomes:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-359-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>R</mi><mo>=</mo><munder><mo>&amp;#x2211;</mo><mi>t</mi></munder><msub><mi>&amp;#x03BB;</mi><mi>p</mi></msub><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>process</mtext></mrow></msubsup><mo>+</mo><msub><mi>&amp;#x03BB;</mi><mi>o</mi></msub><msubsup><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>outcome</mtext></mrow></msubsup></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5934\" style=\"width: 14.273em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.878em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1011.88em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5935\"><span class=\"mi\" id=\"MathJax-Span-5936\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-5937\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-5938\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-5939\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5940\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5941\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5942\" style=\"font-family: STIXGeneral-Italic;\">λ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5943\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5944\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5945\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1002.19em, 4.326em, -999.997em); top: -4.529em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5946\"><span class=\"mrow\" id=\"MathJax-Span-5947\"><span class=\"mtext\" id=\"MathJax-Span-5948\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">process</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5949\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5950\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-5951\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5952\" style=\"font-family: STIXGeneral-Italic;\">λ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5953\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5954\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5955\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1002.5em, 4.169em, -999.997em); top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-5956\"><span class=\"mrow\" id=\"MathJax-Span-5957\"><span class=\"mtext\" id=\"MathJax-Span-5958\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">outcome</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5959\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>R</mi><mo>=</mo><munder><mo>∑</mo><mi>t</mi></munder><msub><mi>λ</mi><mi>p</mi></msub><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>process</mtext></mrow></msubsup><mo>+</mo><msub><mi>λ</mi><mi>o</mi></msub><msubsup><mi>r</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>outcome</mtext></mrow></msubsup></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-359\">R = \\sum_t \\lambda_p r_t^{\\text{process}} + \\lambda_o r_t^{\\text{outcome}}</script>\n\n    <ul>\n      <li>… balancing exploration of intermediate reasoning paths and end-task accuracy.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This hybrid reward scheme is now central in environments like <strong>tool-use environments</strong> and <strong>multi-turn environments</strong>, enabling nuanced optimization of reasoning workflows.</p>\n  </li>\n</ul>\n<p>TIR-based RL frameworks bridge <strong>process-wise</strong> and <strong>outcome-based</strong> rewards.</p>\n<ul>\n      <li><strong>Process rewards</strong> measure reasoning correctness at intermediate tool-use steps (e.g., code executes without error).</li>\n      <li><strong>Outcome rewards</strong> evaluate the final correctness or verification success.</li>\n    </ul>\n<p>The total return function becomes:</p>\n<ul>\n      <li>… balancing exploration of intermediate reasoning paths and end-task accuracy.</li>\n    </ul>\n<p>This hybrid reward scheme is now central in environments like <strong>tool-use environments</strong> and <strong>multi-turn environments</strong>, enabling nuanced optimization of reasoning workflows.</p>",
    "contentMarkdown": "*   TIR-based RL frameworks bridge **process-wise** and **outcome-based** rewards.\n    \n    *   **Process rewards** measure reasoning correctness at intermediate tool-use steps (e.g., code executes without error).\n    *   **Outcome rewards** evaluate the final correctness or verification success.\n*   The total return function becomes:\n    \n    R\\=∑tλprprocesst+λoroutcometR\\=∑tλprtprocess+λortoutcome\n    \n    R = \\\\sum\\_t \\\\lambda\\_p r\\_t^{\\\\text{process}} + \\\\lambda\\_o r\\_t^{\\\\text{outcome}}\n    *   … balancing exploration of intermediate reasoning paths and end-task accuracy.\n*   This hybrid reward scheme is now central in environments like **tool-use environments** and **multi-turn environments**, enabling nuanced optimization of reasoning workflows.\n    \n\nTIR-based RL frameworks bridge **process-wise** and **outcome-based** rewards.\n\n*   **Process rewards** measure reasoning correctness at intermediate tool-use steps (e.g., code executes without error).\n*   **Outcome rewards** evaluate the final correctness or verification success.\n\nThe total return function becomes:\n\n*   … balancing exploration of intermediate reasoning paths and end-task accuracy.\n\nThis hybrid reward scheme is now central in environments like **tool-use environments** and **multi-turn environments**, enabling nuanced optimization of reasoning workflows.",
    "order": 68,
    "orderInChapter": 8,
    "difficulty": 5,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 152,
      "contentLength": 8838
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#unifying-rl-and-tir:-process-vs.-outcome-rewards",
    "scrapedAt": "2025-12-28T11:47:36.155Z"
  },
  {
    "id": "ai-agentic-RL-synthesis-and-outlook-69",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Agentic Reinforcement Learning",
    "articleSlug": "agentic-RL",
    "chapter": "Tool-Integrated Reasoning",
    "title": "Synthesis and Outlook",
    "subtitle": "Tool-Integrated Reasoning",
    "contentHtml": "<ul>\n  <li>\n    <p>Tool-Integrated Reasoning (TIR) provides the operational bridge between <em>language</em> and <em>action</em>. When fused with RL:</p>\n\n    <ul>\n      <li>It transforms reasoning into a closed-loop control process.</li>\n      <li>It grounds learning in executable feedback, reducing hallucination.</li>\n      <li>It yields agents capable of <strong>self-verification, self-correction, and self-improvement</strong>.</li>\n    </ul>\n  </li>\n  <li>\n    <p>In sum:</p>\n\n    <ul>\n      <li><a href=\"https://arxiv.org/abs/2504.11536\">ReTool</a> formalized RL for tool-based reasoning.</li>\n      <li><a href=\"https://arxiv.org/abs/2510.23038\">TIR-Judge</a> extended RL-based tool reasoning to evaluation.</li>\n      <li><a href=\"https://arxiv.org/abs/2503.23383\">Li et al. (2025)</a>, <a href=\"https://arxiv.org/abs/2508.19201\">Xue et al. (2025)</a>, and <a href=\"https://arxiv.org/abs/2509.02479\">Lin et al. (2025)</a> unified the landscape of tool-integrated reinforcement learning by demonstrating that RL-trained agents can autonomously discover, schedule, and verify tool use—laying the groundwork for scalable, self-improving reasoning systems.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Collectively, these works mark the beginning of <strong>agentic cognition</strong>—where models reason, act, and verify within the same policy loop.</p>\n  </li>\n</ul>\n<p>Tool-Integrated Reasoning (TIR) provides the operational bridge between <em>language</em> and <em>action</em>. When fused with RL:</p>\n<ul>\n      <li>It transforms reasoning into a closed-loop control process.</li>\n      <li>It grounds learning in executable feedback, reducing hallucination.</li>\n      <li>It yields agents capable of <strong>self-verification, self-correction, and self-improvement</strong>.</li>\n    </ul>\n<p>In sum:</p>\n<ul>\n      <li><a href=\"https://arxiv.org/abs/2504.11536\">ReTool</a> formalized RL for tool-based reasoning.</li>\n      <li><a href=\"https://arxiv.org/abs/2510.23038\">TIR-Judge</a> extended RL-based tool reasoning to evaluation.</li>\n      <li><a href=\"https://arxiv.org/abs/2503.23383\">Li et al. (2025)</a>, <a href=\"https://arxiv.org/abs/2508.19201\">Xue et al. (2025)</a>, and <a href=\"https://arxiv.org/abs/2509.02479\">Lin et al. (2025)</a> unified the landscape of tool-integrated reinforcement learning by demonstrating that RL-trained agents can autonomously discover, schedule, and verify tool use—laying the groundwork for scalable, self-improving reasoning systems.</li>\n    </ul>\n<p>Collectively, these works mark the beginning of <strong>agentic cognition</strong>—where models reason, act, and verify within the same policy loop.</p>",
    "contentMarkdown": "*   Tool-Integrated Reasoning (TIR) provides the operational bridge between _language_ and _action_. When fused with RL:\n    \n    *   It transforms reasoning into a closed-loop control process.\n    *   It grounds learning in executable feedback, reducing hallucination.\n    *   It yields agents capable of **self-verification, self-correction, and self-improvement**.\n*   In sum:\n    \n    *   [ReTool](https://arxiv.org/abs/2504.11536) formalized RL for tool-based reasoning.\n    *   [TIR-Judge](https://arxiv.org/abs/2510.23038) extended RL-based tool reasoning to evaluation.\n    *   [Li et al. (2025)](https://arxiv.org/abs/2503.23383), [Xue et al. (2025)](https://arxiv.org/abs/2508.19201), and [Lin et al. (2025)](https://arxiv.org/abs/2509.02479) unified the landscape of tool-integrated reinforcement learning by demonstrating that RL-trained agents can autonomously discover, schedule, and verify tool use—laying the groundwork for scalable, self-improving reasoning systems.\n*   Collectively, these works mark the beginning of **agentic cognition**—where models reason, act, and verify within the same policy loop.\n    \n\nTool-Integrated Reasoning (TIR) provides the operational bridge between _language_ and _action_. When fused with RL:\n\n*   It transforms reasoning into a closed-loop control process.\n*   It grounds learning in executable feedback, reducing hallucination.\n*   It yields agents capable of **self-verification, self-correction, and self-improvement**.\n\nIn sum:\n\n*   [ReTool](https://arxiv.org/abs/2504.11536) formalized RL for tool-based reasoning.\n*   [TIR-Judge](https://arxiv.org/abs/2510.23038) extended RL-based tool reasoning to evaluation.\n*   [Li et al. (2025)](https://arxiv.org/abs/2503.23383), [Xue et al. (2025)](https://arxiv.org/abs/2508.19201), and [Lin et al. (2025)](https://arxiv.org/abs/2509.02479) unified the landscape of tool-integrated reinforcement learning by demonstrating that RL-trained agents can autonomously discover, schedule, and verify tool use—laying the groundwork for scalable, self-improving reasoning systems.\n\nCollectively, these works mark the beginning of **agentic cognition**—where models reason, act, and verify within the same policy loop.",
    "order": 69,
    "orderInChapter": 9,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 243,
      "contentLength": 2657
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/agentic-RL/#synthesis-and-outlook",
    "scrapedAt": "2025-12-28T11:47:36.155Z"
  }
]