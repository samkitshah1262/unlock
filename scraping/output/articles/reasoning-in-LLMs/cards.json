[
  {
    "id": "ai-reasoning-in-LLMs-what-counts-as-reasoning-for-llms-1",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Overview and Definition",
    "title": "What Counts As ‚Äúreasoning‚Äù for LLMs?",
    "subtitle": "Overview and Definition",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Deductive reasoning</strong>: Deriving logically necessary conclusions from premises, e.g., symbolic algebra, formal proofs, or rule application.</p>\n  </li>\n  <li>\n    <p><strong>Inductive reasoning</strong>: Generalizing patterns from examples, e.g., few-shot extrapolation, schema induction, or pattern completion that yields testable hypotheses.</p>\n  </li>\n  <li>\n    <p><strong>Abductive reasoning</strong>: Inferring the most plausible explanation for observations (hypothesis selection under uncertainty), common in diagnosis and root-cause analysis.</p>\n  </li>\n  <li>\n    <p><strong>Procedural reasoning</strong>: Planning and multi-step control in which the model decomposes tasks, executes actions (possibly via tools), and revises plans.</p>\n  </li>\n  <li>\n    <p>These categories are not mutually exclusive; many benchmarks interleave them.</p>\n  </li>\n</ul>\n<p><strong>Deductive reasoning</strong>: Deriving logically necessary conclusions from premises, e.g., symbolic algebra, formal proofs, or rule application.</p>\n<p><strong>Inductive reasoning</strong>: Generalizing patterns from examples, e.g., few-shot extrapolation, schema induction, or pattern completion that yields testable hypotheses.</p>\n<p><strong>Abductive reasoning</strong>: Inferring the most plausible explanation for observations (hypothesis selection under uncertainty), common in diagnosis and root-cause analysis.</p>\n<p><strong>Procedural reasoning</strong>: Planning and multi-step control in which the model decomposes tasks, executes actions (possibly via tools), and revises plans.</p>\n<p>These categories are not mutually exclusive; many benchmarks interleave them.</p>",
    "contentMarkdown": "*   **Deductive reasoning**: Deriving logically necessary conclusions from premises, e.g., symbolic algebra, formal proofs, or rule application.\n    \n*   **Inductive reasoning**: Generalizing patterns from examples, e.g., few-shot extrapolation, schema induction, or pattern completion that yields testable hypotheses.\n    \n*   **Abductive reasoning**: Inferring the most plausible explanation for observations (hypothesis selection under uncertainty), common in diagnosis and root-cause analysis.\n    \n*   **Procedural reasoning**: Planning and multi-step control in which the model decomposes tasks, executes actions (possibly via tools), and revises plans.\n    \n*   These categories are not mutually exclusive; many benchmarks interleave them.\n    \n\n**Deductive reasoning**: Deriving logically necessary conclusions from premises, e.g., symbolic algebra, formal proofs, or rule application.\n\n**Inductive reasoning**: Generalizing patterns from examples, e.g., few-shot extrapolation, schema induction, or pattern completion that yields testable hypotheses.\n\n**Abductive reasoning**: Inferring the most plausible explanation for observations (hypothesis selection under uncertainty), common in diagnosis and root-cause analysis.\n\n**Procedural reasoning**: Planning and multi-step control in which the model decomposes tasks, executes actions (possibly via tools), and revises plans.\n\nThese categories are not mutually exclusive; many benchmarks interleave them.",
    "order": 1,
    "orderInChapter": 1,
    "difficulty": 2,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 171,
      "contentLength": 1693
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#what-counts-as-‚Äúreasoning‚Äù-for-llms?",
    "scrapedAt": "2025-12-28T11:54:00.653Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-interfaces-that-elicit-reasoning-2",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Overview and Definition",
    "title": "Interfaces That Elicit Reasoning",
    "subtitle": "Overview and Definition",
    "contentHtml": "<ul>\n  <li>\n    <p>Researchers have discovered prompting and decoding interfaces that expose or amplify the latent steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-100\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-101\"><span class=\"mi\" id=\"MathJax-Span-102\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-9\">z</script>.</p>\n  </li>\n  <li>\n    <p><strong>Chain-of-thought (CoT)</strong>: Providing or eliciting step-by-step rationales improves multi-step problem solving, as shown in <em>Chain-of-Thought Prompting Elicits Reasoning in Large Language Models</em> by <a href=\"https://arxiv.org/abs/2201.11903\">Wei et al. (2022)</a> and Zero-shot CoT (‚ÄúLet‚Äôs think step by step‚Äù) in <em>Large Language Models are Zero-Shot Reasoners</em> by <a href=\"https://arxiv.org/abs/2205.11916\">Kojima et al. (2022)</a>. <em>Self-Consistency Improves CoT Reasoning in Language Models</em> by <a href=\"https://arxiv.org/abs/2203.11171\">Wang et al. (2022)</a> samples multiple reasoning paths and marginalizes to a consensus.</p>\n  </li>\n  <li>\n    <p><strong>Search over thoughts</strong>: <em>Tree of Thoughts: Deliberate Problem Solving with Large Language Models</em> by <a href=\"https://arxiv.org/abs/2305.10601\">Yao et al. (2023)</a> treats intermediate steps as nodes and performs lookahead/backtracking, bridging LLM inference with classic heuristic search.</p>\n  </li>\n  <li>\n    <p><strong>Reasoning and acting</strong>: <em>ReAct: Synergizing Reasoning and Acting in Language Models</em> by <a href=\"https://arxiv.org/abs/2210.03629\">Yao et al. (2022)</a> interleaves reasoning traces with tool or environment actions, enabling information gathering and plan revision.</p>\n  </li>\n</ul>\n<p>Researchers have discovered prompting and decoding interfaces that expose or amplify the latent steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-100\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-101\"><span class=\"mi\" id=\"MathJax-Span-102\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-9\">z</script>.</p>\n<p><strong>Chain-of-thought (CoT)</strong>: Providing or eliciting step-by-step rationales improves multi-step problem solving, as shown in <em>Chain-of-Thought Prompting Elicits Reasoning in Large Language Models</em> by <a href=\"https://arxiv.org/abs/2201.11903\">Wei et al. (2022)</a> and Zero-shot CoT (‚ÄúLet‚Äôs think step by step‚Äù) in <em>Large Language Models are Zero-Shot Reasoners</em> by <a href=\"https://arxiv.org/abs/2205.11916\">Kojima et al. (2022)</a>. <em>Self-Consistency Improves CoT Reasoning in Language Models</em> by <a href=\"https://arxiv.org/abs/2203.11171\">Wang et al. (2022)</a> samples multiple reasoning paths and marginalizes to a consensus.</p>\n<p><strong>Search over thoughts</strong>: <em>Tree of Thoughts: Deliberate Problem Solving with Large Language Models</em> by <a href=\"https://arxiv.org/abs/2305.10601\">Yao et al. (2023)</a> treats intermediate steps as nodes and performs lookahead/backtracking, bridging LLM inference with classic heuristic search.</p>\n<p><strong>Reasoning and acting</strong>: <em>ReAct: Synergizing Reasoning and Acting in Language Models</em> by <a href=\"https://arxiv.org/abs/2210.03629\">Yao et al. (2022)</a> interleaves reasoning traces with tool or environment actions, enabling information gathering and plan revision.</p>",
    "contentMarkdown": "*   Researchers have discovered prompting and decoding interfaces that expose or amplify the latent steps zzz.\n    \n*   **Chain-of-thought (CoT)**: Providing or eliciting step-by-step rationales improves multi-step problem solving, as shown in _Chain-of-Thought Prompting Elicits Reasoning in Large Language Models_ by [Wei et al. (2022)](https://arxiv.org/abs/2201.11903) and Zero-shot CoT (‚ÄúLet‚Äôs think step by step‚Äù) in _Large Language Models are Zero-Shot Reasoners_ by [Kojima et al. (2022)](https://arxiv.org/abs/2205.11916). _Self-Consistency Improves CoT Reasoning in Language Models_ by [Wang et al. (2022)](https://arxiv.org/abs/2203.11171) samples multiple reasoning paths and marginalizes to a consensus.\n    \n*   **Search over thoughts**: _Tree of Thoughts: Deliberate Problem Solving with Large Language Models_ by [Yao et al. (2023)](https://arxiv.org/abs/2305.10601) treats intermediate steps as nodes and performs lookahead/backtracking, bridging LLM inference with classic heuristic search.\n    \n*   **Reasoning and acting**: _ReAct: Synergizing Reasoning and Acting in Language Models_ by [Yao et al. (2022)](https://arxiv.org/abs/2210.03629) interleaves reasoning traces with tool or environment actions, enabling information gathering and plan revision.\n    \n\nResearchers have discovered prompting and decoding interfaces that expose or amplify the latent steps zzz.\n\n**Chain-of-thought (CoT)**: Providing or eliciting step-by-step rationales improves multi-step problem solving, as shown in _Chain-of-Thought Prompting Elicits Reasoning in Large Language Models_ by [Wei et al. (2022)](https://arxiv.org/abs/2201.11903) and Zero-shot CoT (‚ÄúLet‚Äôs think step by step‚Äù) in _Large Language Models are Zero-Shot Reasoners_ by [Kojima et al. (2022)](https://arxiv.org/abs/2205.11916). _Self-Consistency Improves CoT Reasoning in Language Models_ by [Wang et al. (2022)](https://arxiv.org/abs/2203.11171) samples multiple reasoning paths and marginalizes to a consensus.\n\n**Search over thoughts**: _Tree of Thoughts: Deliberate Problem Solving with Large Language Models_ by [Yao et al. (2023)](https://arxiv.org/abs/2305.10601) treats intermediate steps as nodes and performs lookahead/backtracking, bridging LLM inference with classic heuristic search.\n\n**Reasoning and acting**: _ReAct: Synergizing Reasoning and Acting in Language Models_ by [Yao et al. (2022)](https://arxiv.org/abs/2210.03629) interleaves reasoning traces with tool or environment actions, enabling information gathering and plan revision.",
    "order": 2,
    "orderInChapter": 2,
    "difficulty": 3,
    "estimatedMinutes": 2,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 296,
      "contentLength": 5236
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#interfaces-that-elicit-reasoning",
    "scrapedAt": "2025-12-28T11:54:00.653Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-the-role-of-scaling-and-the-aha-phenomenon-3",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Overview and Definition",
    "title": "The Role of Scaling and the ‚Äúaha‚Äù Phenomenon",
    "subtitle": "Overview and Definition",
    "contentHtml": "<ul>\n  <li>\n    <p>Scaling laws predict smoother loss improvements with model/data/compute, yet qualitative ‚Äújumps‚Äù in task performance are often reported. Two perspectives coexist:</p>\n\n    <ul>\n      <li>\n        <p><strong>Emergence view</strong>: Some abilities appear only beyond certain scales or training regimes, as argued by <a href=\"https://arxiv.org/abs/2206.07682\">Wei et al. (2022)</a>.</p>\n      </li>\n      <li>\n        <p><strong>Measurement view</strong>: Apparent discontinuities arise from metric non-linearities or data scarcity, per <a href=\"https://arxiv.org/abs/2304.15004\">Schaeffer et al. (2023)</a>.</p>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>In either view, improved interfaces and training often turn tacit competence into explicit problem solving. For instance, RL specialized to reward intermediate solution quality, as in DeepSeek-R1: Incentivizing Reasoning Capability in LLMs via Reinforcement Learning by <a href=\"https://arxiv.org/abs/2501.12948\">Guo et al. (2025)</a>, reports substantial gains on math and logic without supervised rationales, highlighting how credit assignment can shape useful latent computations.</p>\n  </li>\n</ul>\n<p>Scaling laws predict smoother loss improvements with model/data/compute, yet qualitative ‚Äújumps‚Äù in task performance are often reported. Two perspectives coexist:</p>\n<ul>\n      <li>\n        <p><strong>Emergence view</strong>: Some abilities appear only beyond certain scales or training regimes, as argued by <a href=\"https://arxiv.org/abs/2206.07682\">Wei et al. (2022)</a>.</p>\n      </li>\n      <li>\n        <p><strong>Measurement view</strong>: Apparent discontinuities arise from metric non-linearities or data scarcity, per <a href=\"https://arxiv.org/abs/2304.15004\">Schaeffer et al. (2023)</a>.</p>\n      </li>\n    </ul>\n<p><strong>Emergence view</strong>: Some abilities appear only beyond certain scales or training regimes, as argued by <a href=\"https://arxiv.org/abs/2206.07682\">Wei et al. (2022)</a>.</p>\n<p><strong>Measurement view</strong>: Apparent discontinuities arise from metric non-linearities or data scarcity, per <a href=\"https://arxiv.org/abs/2304.15004\">Schaeffer et al. (2023)</a>.</p>\n<p>In either view, improved interfaces and training often turn tacit competence into explicit problem solving. For instance, RL specialized to reward intermediate solution quality, as in DeepSeek-R1: Incentivizing Reasoning Capability in LLMs via Reinforcement Learning by <a href=\"https://arxiv.org/abs/2501.12948\">Guo et al. (2025)</a>, reports substantial gains on math and logic without supervised rationales, highlighting how credit assignment can shape useful latent computations.</p>",
    "contentMarkdown": "*   Scaling laws predict smoother loss improvements with model/data/compute, yet qualitative ‚Äújumps‚Äù in task performance are often reported. Two perspectives coexist:\n    \n    *   **Emergence view**: Some abilities appear only beyond certain scales or training regimes, as argued by [Wei et al. (2022)](https://arxiv.org/abs/2206.07682).\n        \n    *   **Measurement view**: Apparent discontinuities arise from metric non-linearities or data scarcity, per [Schaeffer et al. (2023)](https://arxiv.org/abs/2304.15004).\n        \n*   In either view, improved interfaces and training often turn tacit competence into explicit problem solving. For instance, RL specialized to reward intermediate solution quality, as in DeepSeek-R1: Incentivizing Reasoning Capability in LLMs via Reinforcement Learning by [Guo et al. (2025)](https://arxiv.org/abs/2501.12948), reports substantial gains on math and logic without supervised rationales, highlighting how credit assignment can shape useful latent computations.\n    \n\nScaling laws predict smoother loss improvements with model/data/compute, yet qualitative ‚Äújumps‚Äù in task performance are often reported. Two perspectives coexist:\n\n*   **Emergence view**: Some abilities appear only beyond certain scales or training regimes, as argued by [Wei et al. (2022)](https://arxiv.org/abs/2206.07682).\n    \n*   **Measurement view**: Apparent discontinuities arise from metric non-linearities or data scarcity, per [Schaeffer et al. (2023)](https://arxiv.org/abs/2304.15004).\n    \n\n**Emergence view**: Some abilities appear only beyond certain scales or training regimes, as argued by [Wei et al. (2022)](https://arxiv.org/abs/2206.07682).\n\n**Measurement view**: Apparent discontinuities arise from metric non-linearities or data scarcity, per [Schaeffer et al. (2023)](https://arxiv.org/abs/2304.15004).\n\nIn either view, improved interfaces and training often turn tacit competence into explicit problem solving. For instance, RL specialized to reward intermediate solution quality, as in DeepSeek-R1: Incentivizing Reasoning Capability in LLMs via Reinforcement Learning by [Guo et al. (2025)](https://arxiv.org/abs/2501.12948), reports substantial gains on math and logic without supervised rationales, highlighting how credit assignment can shape useful latent computations.",
    "order": 3,
    "orderInChapter": 3,
    "difficulty": 2,
    "estimatedMinutes": 2,
    "tags": [
      "nlpllms",
      "llm",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 269,
      "contentLength": 2681
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#the-role-of-scaling-and-the-‚Äúaha‚Äù-phenomenon",
    "scrapedAt": "2025-12-28T11:54:00.653Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-a-minimal-mathematical-lens-4",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Overview and Definition",
    "title": "A Minimal Mathematical Lens",
    "subtitle": "Overview and Definition",
    "contentHtml": "<ul>\n  <li>\n    <p>Training typically minimizes the expected negative log-likelihood (cross-entropy) <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>L</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>&amp;#x223C;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>D</mi></mrow></mrow></msub><mrow><mo>[</mo><mrow><mo>&amp;#x2212;</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></munder><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-103\" style=\"width: 17.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.326em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1014.17em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-104\"><span class=\"texatom\" id=\"MathJax-Span-105\"><span class=\"mrow\" id=\"MathJax-Span-106\"><span class=\"mi\" id=\"MathJax-Span-107\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∏</span></span></span><span class=\"mo\" id=\"MathJax-Span-108\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-109\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-110\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-111\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-112\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-113\"><span class=\"mrow\" id=\"MathJax-Span-114\"><span class=\"mi\" id=\"MathJax-Span-115\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-116\"><span class=\"mrow\" id=\"MathJax-Span-117\"><span class=\"mi\" id=\"MathJax-Span-118\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-119\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"texatom\" id=\"MathJax-Span-120\"><span class=\"mrow\" id=\"MathJax-Span-121\"><span class=\"mi\" id=\"MathJax-Span-122\" style=\"font-size: 70.7%; font-family: STIXNonUnicode-Italic;\">Óà∞</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-123\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-124\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-125\"><span class=\"mo\" id=\"MathJax-Span-126\" style=\"font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"munderover\" id=\"MathJax-Span-127\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-128\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-129\"><span class=\"mrow\" id=\"MathJax-Span-130\"><span class=\"mi\" id=\"MathJax-Span-131\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-132\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-133\"></span><span class=\"msubsup\" id=\"MathJax-Span-134\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-135\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-136\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-137\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-138\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-139\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-140\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-141\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-142\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-143\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-144\"><span class=\"mrow\" id=\"MathJax-Span-145\"><span class=\"mo\" id=\"MathJax-Span-146\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-148\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-149\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">L</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>‚àº</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">D</mi></mrow></mrow></msub><mrow><mo>[</mo><mrow><mo>‚àí</mo><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi></mrow></munder><mi>log</mi><mo>‚Å°</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>x</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>&lt;</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-10\">\\mathcal{L}(\\theta)=\\mathbb{E}_{x\\sim \\mathcal{D}}\\left[-\\sum_{t}\\log p_\\theta(x_t\\mid x_{<t})\\right]</script>.</p>\n  </li>\n  <li>\n    <p>Reasoning-oriented inference augments this with structure over <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-150\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-151\"><span class=\"mi\" id=\"MathJax-Span-152\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-11\">z</script>:</p>\n\n    <ul>\n      <li>\n        <p><strong>CoT-style sampling</strong>: Sample <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>&amp;#x223C;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-153\" style=\"width: 7.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1005.84em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-154\"><span class=\"msubsup\" id=\"MathJax-Span-155\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-156\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-157\"><span class=\"mrow\" id=\"MathJax-Span-158\"><span class=\"mo\" id=\"MathJax-Span-159\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-160\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-161\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-162\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-163\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-164\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-165\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-166\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-167\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-168\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-169\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-170\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>‚àº</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-12\">z^{(k)}\\sim p_\\theta(z\\mid x)</script> and select <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-171\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1000.47em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-172\"><span class=\"texatom\" id=\"MathJax-Span-173\"><span class=\"mrow\" id=\"MathJax-Span-174\"><span class=\"munderover\" id=\"MathJax-Span-175\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-176\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-177\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-13\">\\hat{y}</script> by majority or confidence weighting <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow></munder><mi>w</mi><mrow><mo>(</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>)</mo></mrow><mo>,</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo>,</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-178\" style=\"width: 19.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 15.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1015.94em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-179\"><span class=\"texatom\" id=\"MathJax-Span-180\"><span class=\"mrow\" id=\"MathJax-Span-181\"><span class=\"munderover\" id=\"MathJax-Span-182\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-183\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-184\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-185\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-186\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-187\"></span><span class=\"munderover\" id=\"MathJax-Span-188\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-189\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"mi\" id=\"MathJax-Span-190\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-191\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-192\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-193\"><span class=\"mrow\" id=\"MathJax-Span-194\"><span class=\"mi\" id=\"MathJax-Span-195\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-196\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">w</span><span class=\"mrow\" id=\"MathJax-Span-197\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-198\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">(</span></span><span class=\"msubsup\" id=\"MathJax-Span-199\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-200\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-201\"><span class=\"mrow\" id=\"MathJax-Span-202\"><span class=\"mo\" id=\"MathJax-Span-203\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-204\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-205\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-206\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">)</span></span></span><span class=\"mo\" id=\"MathJax-Span-207\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-208\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-209\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-210\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-211\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-212\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-213\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-214\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-215\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-216\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-217\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-218\"><span class=\"mrow\" id=\"MathJax-Span-219\"><span class=\"mo\" id=\"MathJax-Span-220\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-221\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-222\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-223\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi></mrow></munder><mi>w</mi><mrow><mo>(</mo><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>)</mo></mrow><mo>,</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo>,</mo><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-14\">\\hat{y}=\\arg\\max_y \\sum_{k} w \\left(z^{(k)}\\right), p_\\theta(y\\mid x,z^{(k)})</script>.</p>\n      </li>\n      <li>\n        <p><strong>Search over thoughts</strong>: Define a scoring function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-224\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-225\"><span class=\"mi\" id=\"MathJax-Span-226\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-227\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-228\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-229\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-230\"><span class=\"mrow\" id=\"MathJax-Span-231\"><span class=\"mn\" id=\"MathJax-Span-232\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-233\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-234\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-235\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-15\">s(z_{1:t})</script> and expand nodes to maximize expected downstream reward, akin to beam/A* variants over textual states.</p>\n      </li>\n      <li>\n        <p><strong>Reinforcement Learning for reasoning</strong>: Optimize <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-236\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-237\"><span class=\"mi\" id=\"MathJax-Span-238\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">\\theta</script> against a task reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-239\" style=\"width: 3.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.71em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-240\"><span class=\"mi\" id=\"MathJax-Span-241\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-242\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-243\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-244\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-245\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-246\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-17\">R(y,z)</script>, shaping <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-247\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.44em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.39em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-248\"><span class=\"msubsup\" id=\"MathJax-Span-249\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-250\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-251\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-252\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-253\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-254\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-255\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-256\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">p_\\theta(z\\mid x)</script> toward productive step structures rather than purely imitating text.</p>\n      </li>\n    </ul>\n  </li>\n</ul>\n<p>Training typically minimizes the expected negative log-likelihood (cross-entropy) <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>L</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>&amp;#x223C;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>D</mi></mrow></mrow></msub><mrow><mo>[</mo><mrow><mo>&amp;#x2212;</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></munder><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-103\" style=\"width: 17.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.326em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1014.17em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-104\"><span class=\"texatom\" id=\"MathJax-Span-105\"><span class=\"mrow\" id=\"MathJax-Span-106\"><span class=\"mi\" id=\"MathJax-Span-107\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∏</span></span></span><span class=\"mo\" id=\"MathJax-Span-108\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-109\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-110\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-111\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-112\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-113\"><span class=\"mrow\" id=\"MathJax-Span-114\"><span class=\"mi\" id=\"MathJax-Span-115\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-116\"><span class=\"mrow\" id=\"MathJax-Span-117\"><span class=\"mi\" id=\"MathJax-Span-118\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-119\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"texatom\" id=\"MathJax-Span-120\"><span class=\"mrow\" id=\"MathJax-Span-121\"><span class=\"mi\" id=\"MathJax-Span-122\" style=\"font-size: 70.7%; font-family: STIXNonUnicode-Italic;\">Óà∞</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-123\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-124\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-125\"><span class=\"mo\" id=\"MathJax-Span-126\" style=\"font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"munderover\" id=\"MathJax-Span-127\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-128\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-129\"><span class=\"mrow\" id=\"MathJax-Span-130\"><span class=\"mi\" id=\"MathJax-Span-131\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-132\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-133\"></span><span class=\"msubsup\" id=\"MathJax-Span-134\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-135\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-136\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-137\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-138\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-139\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-140\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-141\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-142\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-143\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-144\"><span class=\"mrow\" id=\"MathJax-Span-145\"><span class=\"mo\" id=\"MathJax-Span-146\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-148\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-149\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">L</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>‚àº</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">D</mi></mrow></mrow></msub><mrow><mo>[</mo><mrow><mo>‚àí</mo><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi></mrow></munder><mi>log</mi><mo>‚Å°</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>x</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>&lt;</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-10\">\\mathcal{L}(\\theta)=\\mathbb{E}_{x\\sim \\mathcal{D}}\\left[-\\sum_{t}\\log p_\\theta(x_t\\mid x_{<t})\\right]</script>.</p>\n<p>Reasoning-oriented inference augments this with structure over <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-150\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-151\"><span class=\"mi\" id=\"MathJax-Span-152\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-11\">z</script>:</p>\n<ul>\n      <li>\n        <p><strong>CoT-style sampling</strong>: Sample <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>&amp;#x223C;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-153\" style=\"width: 7.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1005.84em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-154\"><span class=\"msubsup\" id=\"MathJax-Span-155\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-156\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-157\"><span class=\"mrow\" id=\"MathJax-Span-158\"><span class=\"mo\" id=\"MathJax-Span-159\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-160\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-161\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-162\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-163\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-164\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-165\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-166\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-167\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-168\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-169\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-170\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>‚àº</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-12\">z^{(k)}\\sim p_\\theta(z\\mid x)</script> and select <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-171\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1000.47em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-172\"><span class=\"texatom\" id=\"MathJax-Span-173\"><span class=\"mrow\" id=\"MathJax-Span-174\"><span class=\"munderover\" id=\"MathJax-Span-175\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-176\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-177\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-13\">\\hat{y}</script> by majority or confidence weighting <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow></munder><mi>w</mi><mrow><mo>(</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>)</mo></mrow><mo>,</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo>,</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-178\" style=\"width: 19.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 15.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1015.94em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-179\"><span class=\"texatom\" id=\"MathJax-Span-180\"><span class=\"mrow\" id=\"MathJax-Span-181\"><span class=\"munderover\" id=\"MathJax-Span-182\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-183\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-184\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-185\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-186\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-187\"></span><span class=\"munderover\" id=\"MathJax-Span-188\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-189\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"mi\" id=\"MathJax-Span-190\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-191\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-192\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-193\"><span class=\"mrow\" id=\"MathJax-Span-194\"><span class=\"mi\" id=\"MathJax-Span-195\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-196\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">w</span><span class=\"mrow\" id=\"MathJax-Span-197\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-198\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">(</span></span><span class=\"msubsup\" id=\"MathJax-Span-199\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-200\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-201\"><span class=\"mrow\" id=\"MathJax-Span-202\"><span class=\"mo\" id=\"MathJax-Span-203\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-204\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-205\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-206\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">)</span></span></span><span class=\"mo\" id=\"MathJax-Span-207\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-208\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-209\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-210\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-211\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-212\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-213\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-214\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-215\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-216\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-217\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-218\"><span class=\"mrow\" id=\"MathJax-Span-219\"><span class=\"mo\" id=\"MathJax-Span-220\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-221\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-222\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-223\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi></mrow></munder><mi>w</mi><mrow><mo>(</mo><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>)</mo></mrow><mo>,</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo>,</mo><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-14\">\\hat{y}=\\arg\\max_y \\sum_{k} w \\left(z^{(k)}\\right), p_\\theta(y\\mid x,z^{(k)})</script>.</p>\n      </li>\n      <li>\n        <p><strong>Search over thoughts</strong>: Define a scoring function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-224\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-225\"><span class=\"mi\" id=\"MathJax-Span-226\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-227\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-228\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-229\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-230\"><span class=\"mrow\" id=\"MathJax-Span-231\"><span class=\"mn\" id=\"MathJax-Span-232\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-233\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-234\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-235\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-15\">s(z_{1:t})</script> and expand nodes to maximize expected downstream reward, akin to beam/A* variants over textual states.</p>\n      </li>\n      <li>\n        <p><strong>Reinforcement Learning for reasoning</strong>: Optimize <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-236\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-237\"><span class=\"mi\" id=\"MathJax-Span-238\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">\\theta</script> against a task reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-239\" style=\"width: 3.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.71em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-240\"><span class=\"mi\" id=\"MathJax-Span-241\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-242\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-243\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-244\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-245\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-246\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-17\">R(y,z)</script>, shaping <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-247\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.44em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.39em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-248\"><span class=\"msubsup\" id=\"MathJax-Span-249\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-250\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-251\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-252\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-253\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-254\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-255\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-256\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">p_\\theta(z\\mid x)</script> toward productive step structures rather than purely imitating text.</p>\n      </li>\n    </ul>\n<p><strong>CoT-style sampling</strong>: Sample <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>&amp;#x223C;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-153\" style=\"width: 7.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1005.84em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-154\"><span class=\"msubsup\" id=\"MathJax-Span-155\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-156\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-157\"><span class=\"mrow\" id=\"MathJax-Span-158\"><span class=\"mo\" id=\"MathJax-Span-159\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-160\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-161\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-162\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-163\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-164\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-165\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-166\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-167\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-168\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-169\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-170\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>‚àº</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-12\">z^{(k)}\\sim p_\\theta(z\\mid x)</script> and select <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-171\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1000.47em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-172\"><span class=\"texatom\" id=\"MathJax-Span-173\"><span class=\"mrow\" id=\"MathJax-Span-174\"><span class=\"munderover\" id=\"MathJax-Span-175\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-176\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-177\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-13\">\\hat{y}</script> by majority or confidence weighting <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow></munder><mi>w</mi><mrow><mo>(</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>)</mo></mrow><mo>,</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo>,</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-178\" style=\"width: 19.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 15.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1015.94em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-179\"><span class=\"texatom\" id=\"MathJax-Span-180\"><span class=\"mrow\" id=\"MathJax-Span-181\"><span class=\"munderover\" id=\"MathJax-Span-182\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-183\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-184\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-185\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-186\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-187\"></span><span class=\"munderover\" id=\"MathJax-Span-188\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-189\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"mi\" id=\"MathJax-Span-190\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-191\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-192\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-193\"><span class=\"mrow\" id=\"MathJax-Span-194\"><span class=\"mi\" id=\"MathJax-Span-195\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-196\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">w</span><span class=\"mrow\" id=\"MathJax-Span-197\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-198\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">(</span></span><span class=\"msubsup\" id=\"MathJax-Span-199\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-200\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-201\"><span class=\"mrow\" id=\"MathJax-Span-202\"><span class=\"mo\" id=\"MathJax-Span-203\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-204\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-205\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-206\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">)</span></span></span><span class=\"mo\" id=\"MathJax-Span-207\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-208\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-209\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-210\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-211\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-212\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-213\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-214\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-215\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-216\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-217\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-218\"><span class=\"mrow\" id=\"MathJax-Span-219\"><span class=\"mo\" id=\"MathJax-Span-220\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-221\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-222\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-223\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi></mrow></munder><mi>w</mi><mrow><mo>(</mo><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>)</mo></mrow><mo>,</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo>,</mo><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-14\">\\hat{y}=\\arg\\max_y \\sum_{k} w \\left(z^{(k)}\\right), p_\\theta(y\\mid x,z^{(k)})</script>.</p>\n<p><strong>Search over thoughts</strong>: Define a scoring function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-224\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-225\"><span class=\"mi\" id=\"MathJax-Span-226\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-227\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-228\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-229\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-230\"><span class=\"mrow\" id=\"MathJax-Span-231\"><span class=\"mn\" id=\"MathJax-Span-232\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-233\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-234\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-235\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-15\">s(z_{1:t})</script> and expand nodes to maximize expected downstream reward, akin to beam/A* variants over textual states.</p>\n<p><strong>Reinforcement Learning for reasoning</strong>: Optimize <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-236\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-237\"><span class=\"mi\" id=\"MathJax-Span-238\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">\\theta</script> against a task reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-239\" style=\"width: 3.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.71em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-240\"><span class=\"mi\" id=\"MathJax-Span-241\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-242\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-243\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-244\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-245\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-246\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-17\">R(y,z)</script>, shaping <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-247\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.44em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.39em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-248\"><span class=\"msubsup\" id=\"MathJax-Span-249\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-250\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-251\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-252\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-253\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-254\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-255\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-256\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">p_\\theta(z\\mid x)</script> toward productive step structures rather than purely imitating text.</p>",
    "contentMarkdown": "*   Training typically minimizes the expected negative log-likelihood (cross-entropy) Óà∏(Œ∏)\\=ùîºx‚àºÓà∞\\[‚àí‚àëtlogpŒ∏(xt‚à£x<t)\\]L(Œ∏)\\=Ex‚àºD\\[‚àí‚àëtlog‚Å°pŒ∏(xt‚à£x<t)\\]\\\\mathcal{L}(\\\\theta)=\\\\mathbb{E}\\_{x\\\\sim \\\\mathcal{D}}\\\\left\\[-\\\\sum\\_{t}\\\\log p\\_\\\\theta(x\\_t\\\\mid x\\_{<t})\\\\right\\].\n    \n*   Reasoning-oriented inference augments this with structure over zzz:\n    \n    *   **CoT-style sampling**: Sample z(k)‚àºpŒ∏(z‚à£x)z(k)‚àºpŒ∏(z‚à£x)z^{(k)}\\\\sim p\\_\\\\theta(z\\\\mid x) and select yÃÇ¬†y^\\\\hat{y} by majority or confidence weighting yÃÇ¬†\\=argmaxy‚àëkw(z(k)),pŒ∏(y‚à£x,z(k))y^\\=arg‚Å°maxy‚àëkw(z(k)),pŒ∏(y‚à£x,z(k))\\\\hat{y}=\\\\arg\\\\max\\_y \\\\sum\\_{k} w \\\\left(z^{(k)}\\\\right), p\\_\\\\theta(y\\\\mid x,z^{(k)}).\n        \n    *   **Search over thoughts**: Define a scoring function s(z1:t)s(z1:t)s(z\\_{1:t}) and expand nodes to maximize expected downstream reward, akin to beam/A\\* variants over textual states.\n        \n    *   **Reinforcement Learning for reasoning**: Optimize Œ∏Œ∏\\\\theta against a task reward R(y,z)R(y,z)R(y,z), shaping pŒ∏(z‚à£x)pŒ∏(z‚à£x)p\\_\\\\theta(z\\\\mid x) toward productive step structures rather than purely imitating text.\n        \n\nTraining typically minimizes the expected negative log-likelihood (cross-entropy) Óà∏(Œ∏)\\=ùîºx‚àºÓà∞\\[‚àí‚àëtlogpŒ∏(xt‚à£x<t)\\]L(Œ∏)\\=Ex‚àºD\\[‚àí‚àëtlog‚Å°pŒ∏(xt‚à£x<t)\\]\\\\mathcal{L}(\\\\theta)=\\\\mathbb{E}\\_{x\\\\sim \\\\mathcal{D}}\\\\left\\[-\\\\sum\\_{t}\\\\log p\\_\\\\theta(x\\_t\\\\mid x\\_{<t})\\\\right\\].\n\nReasoning-oriented inference augments this with structure over zzz:\n\n*   **CoT-style sampling**: Sample z(k)‚àºpŒ∏(z‚à£x)z(k)‚àºpŒ∏(z‚à£x)z^{(k)}\\\\sim p\\_\\\\theta(z\\\\mid x) and select yÃÇ¬†y^\\\\hat{y} by majority or confidence weighting yÃÇ¬†\\=argmaxy‚àëkw(z(k)),pŒ∏(y‚à£x,z(k))y^\\=arg‚Å°maxy‚àëkw(z(k)),pŒ∏(y‚à£x,z(k))\\\\hat{y}=\\\\arg\\\\max\\_y \\\\sum\\_{k} w \\\\left(z^{(k)}\\\\right), p\\_\\\\theta(y\\\\mid x,z^{(k)}).\n    \n*   **Search over thoughts**: Define a scoring function s(z1:t)s(z1:t)s(z\\_{1:t}) and expand nodes to maximize expected downstream reward, akin to beam/A\\* variants over textual states.\n    \n*   **Reinforcement Learning for reasoning**: Optimize Œ∏Œ∏\\\\theta against a task reward R(y,z)R(y,z)R(y,z), shaping pŒ∏(z‚à£x)pŒ∏(z‚à£x)p\\_\\\\theta(z\\\\mid x) toward productive step structures rather than purely imitating text.\n    \n\n**CoT-style sampling**: Sample z(k)‚àºpŒ∏(z‚à£x)z(k)‚àºpŒ∏(z‚à£x)z^{(k)}\\\\sim p\\_\\\\theta(z\\\\mid x) and select yÃÇ¬†y^\\\\hat{y} by majority or confidence weighting yÃÇ¬†\\=argmaxy‚àëkw(z(k)),pŒ∏(y‚à£x,z(k))y^\\=arg‚Å°maxy‚àëkw(z(k)),pŒ∏(y‚à£x,z(k))\\\\hat{y}=\\\\arg\\\\max\\_y \\\\sum\\_{k} w \\\\left(z^{(k)}\\\\right), p\\_\\\\theta(y\\\\mid x,z^{(k)}).\n\n**Search over thoughts**: Define a scoring function s(z1:t)s(z1:t)s(z\\_{1:t}) and expand nodes to maximize expected downstream reward, akin to beam/A\\* variants over textual states.\n\n**Reinforcement Learning for reasoning**: Optimize Œ∏Œ∏\\\\theta against a task reward R(y,z)R(y,z)R(y,z), shaping pŒ∏(z‚à£x)pŒ∏(z‚à£x)p\\_\\\\theta(z\\\\mid x) toward productive step structures rather than purely imitating text.",
    "order": 4,
    "orderInChapter": 4,
    "difficulty": 3,
    "estimatedMinutes": 2,
    "tags": [
      "nlpllms",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 252,
      "contentLength": 98541
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#a-minimal-mathematical-lens",
    "scrapedAt": "2025-12-28T11:54:00.654Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-methodologies-for-invoking-reasoning-in-llms-5",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Invoking Reasoning in LLMs",
    "title": "Methodologies for Invoking Reasoning in LLMs",
    "subtitle": "Invoking Reasoning in LLMs",
    "contentHtml": "<ul>\n  <li>There are several overarching paradigms by which reasoning can be <em>invoked</em> in LLMs. Each family emphasizes a different mechanism‚Äîwhether through prompting, decoding, exploration, tool use, or learning signals. Below, the principal methodologies are organized into five broad families.</li>\n</ul>",
    "contentMarkdown": "*   There are several overarching paradigms by which reasoning can be _invoked_ in LLMs. Each family emphasizes a different mechanism‚Äîwhether through prompting, decoding, exploration, tool use, or learning signals. Below, the principal methodologies are organized into five broad families.",
    "order": 5,
    "orderInChapter": 1,
    "difficulty": 2,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 39,
      "contentLength": 314
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#methodologies-for-invoking-reasoning-in-llms",
    "scrapedAt": "2025-12-28T11:54:00.654Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-prompting-based-reasoning-6",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Invoking Reasoning in LLMs",
    "title": "Prompting-Based Reasoning",
    "subtitle": "Invoking Reasoning in LLMs",
    "contentHtml": "<ul>\n  <li>\n    <p>Prompting-based approaches induce reasoning by structuring the input context to make intermediate thinking explicit or implicitly compositional. These methods rely purely on <strong>contextual cues</strong> rather than architectural or training modifications. Examples below:</p>\n\n    <ul>\n      <li>\n        <p><strong>Chain-of-Thought (CoT) Prompting</strong>: Introduced by <a href=\"https://arxiv.org/abs/2201.11903\">Wei et al. (2022)</a>, CoT explicitly elicits step-by-step reasoning traces, guiding the model to externalize intermediate computations before giving the final answer. Formally, the model predicts</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder><munder><mo>&amp;#x2211;</mo><mi>z</mi></munder><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-310\" style=\"width: 12.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1010.37em, 3.961em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-311\"><span class=\"texatom\" id=\"MathJax-Span-312\"><span class=\"mrow\" id=\"MathJax-Span-313\"><span class=\"munderover\" id=\"MathJax-Span-314\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-315\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-316\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-317\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-318\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-319\"></span><span class=\"munderover\" id=\"MathJax-Span-320\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-321\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.43em, -999.997em); top: -3.331em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-322\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-323\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-324\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.326em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-325\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-326\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-327\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-328\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-329\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-330\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-331\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-332\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"texatom\" id=\"MathJax-Span-333\"><span class=\"mrow\" id=\"MathJax-Span-334\"><span class=\"mo\" id=\"MathJax-Span-335\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-336\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-337\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 2.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder><munder><mo>‚àë</mo><mi>z</mi></munder><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-27\">\\hat{y} = \\arg\\max_y \\sum_z p_\\theta(y, z | x)</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-338\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-339\"><span class=\"mi\" id=\"MathJax-Span-340\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">z</script> denotes latent reasoning traces approximated through explicit textual reasoning.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Zero-Shot and Few-Shot CoT</strong>: As shown by <a href=\"https://arxiv.org/abs/2205.11916\">Kojima et al. (2022)</a>, adding simple triggers like ‚ÄúLet‚Äôs think step by step‚Äù can induce reasoning behavior even without demonstrations, revealing latent reasoning priors in large models.</p>\n      </li>\n      <li>\n        <p><strong>Implicit Reasoning via In-Context Composition</strong>: From <a href=\"https://arxiv.org/abs/2005.14165\">Brown et al. (2020)</a>, LLMs can <em>implicitly</em> perform reasoning by inferring structured input‚Äìoutput mappings from few-shot examples. This process is latent, with reasoning occurring in attention dynamics rather than explicit text.</p>\n      </li>\n    </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>n</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>x</mi><mi>n</mi></msub><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>f</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mspace width=&quot;1em&quot; /><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>C</mi></mrow><mo>=</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msubsup></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-341\" style=\"width: 20.263em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.878em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1016.88em, 2.971em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-342\"><span class=\"msubsup\" id=\"MathJax-Span-343\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-344\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-345\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-346\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-347\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-348\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-349\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-350\"><span class=\"mrow\" id=\"MathJax-Span-351\"><span class=\"mo\" id=\"MathJax-Span-352\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-353\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-354\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-355\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-356\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-357\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-358\"><span class=\"mi\" id=\"MathJax-Span-359\" style=\"font-family: STIXNonUnicode-Italic;\">ÓàØ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-360\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-361\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-362\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-363\" style=\"font-family: STIXGeneral-Italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-364\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-365\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-366\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-367\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-368\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-369\" style=\"font-family: STIXGeneral-Regular;\">;</span><span class=\"texatom\" id=\"MathJax-Span-370\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-371\"><span class=\"mi\" id=\"MathJax-Span-372\" style=\"font-family: STIXNonUnicode-Italic;\">ÓàØ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-373\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-374\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-375\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"texatom\" id=\"MathJax-Span-376\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-377\"><span class=\"mi\" id=\"MathJax-Span-378\" style=\"font-family: STIXNonUnicode-Italic;\">ÓàØ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-379\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-380\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1002.5em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-381\"><span class=\"mrow\" id=\"MathJax-Span-382\"><span class=\"mo\" id=\"MathJax-Span-383\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-384\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-385\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-386\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-387\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-388\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-389\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-390\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-391\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.273em, -999.997em); top: -4.477em; left: 2.555em;\"><span class=\"texatom\" id=\"MathJax-Span-392\"><span class=\"mrow\" id=\"MathJax-Span-393\"><span class=\"mi\" id=\"MathJax-Span-394\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-395\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-396\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.169em, -999.997em); top: -3.695em; left: 2.555em;\"><span class=\"texatom\" id=\"MathJax-Span-397\"><span class=\"mrow\" id=\"MathJax-Span-398\"><span class=\"mi\" id=\"MathJax-Span-399\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-400\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-401\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>n</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>x</mi><mi>n</mi></msub><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">C</mi></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>f</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>;</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">C</mi></mrow><mo stretchy=\"false\">)</mo><mo>,</mo><mspace width=\"1em\"></mspace><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">C</mi></mrow><mo>=</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow></msubsup></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-29\">p_\\theta(y_n | x_n, \\mathcal{C}) = f_\\theta(x_n; \\mathcal{C}), \\quad \\mathcal{C} = {(x_i, y_i)}_{i=1}^{n-1}</script>\n\n    <ul>\n      <li>Implicit composition thus shows that LLMs can internalize algorithmic reasoning even without producing verbalized steps.</li>\n    </ul>\n  </li>\n</ul>\n<p>Prompting-based approaches induce reasoning by structuring the input context to make intermediate thinking explicit or implicitly compositional. These methods rely purely on <strong>contextual cues</strong> rather than architectural or training modifications. Examples below:</p>\n<ul>\n      <li>\n        <p><strong>Chain-of-Thought (CoT) Prompting</strong>: Introduced by <a href=\"https://arxiv.org/abs/2201.11903\">Wei et al. (2022)</a>, CoT explicitly elicits step-by-step reasoning traces, guiding the model to externalize intermediate computations before giving the final answer. Formally, the model predicts</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder><munder><mo>&amp;#x2211;</mo><mi>z</mi></munder><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-310\" style=\"width: 12.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1010.37em, 3.961em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-311\"><span class=\"texatom\" id=\"MathJax-Span-312\"><span class=\"mrow\" id=\"MathJax-Span-313\"><span class=\"munderover\" id=\"MathJax-Span-314\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-315\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-316\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-317\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-318\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-319\"></span><span class=\"munderover\" id=\"MathJax-Span-320\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-321\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.43em, -999.997em); top: -3.331em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-322\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-323\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-324\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.326em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-325\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-326\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-327\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-328\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-329\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-330\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-331\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-332\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"texatom\" id=\"MathJax-Span-333\"><span class=\"mrow\" id=\"MathJax-Span-334\"><span class=\"mo\" id=\"MathJax-Span-335\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-336\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-337\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 2.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder><munder><mo>‚àë</mo><mi>z</mi></munder><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-27\">\\hat{y} = \\arg\\max_y \\sum_z p_\\theta(y, z | x)</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-338\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-339\"><span class=\"mi\" id=\"MathJax-Span-340\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">z</script> denotes latent reasoning traces approximated through explicit textual reasoning.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Zero-Shot and Few-Shot CoT</strong>: As shown by <a href=\"https://arxiv.org/abs/2205.11916\">Kojima et al. (2022)</a>, adding simple triggers like ‚ÄúLet‚Äôs think step by step‚Äù can induce reasoning behavior even without demonstrations, revealing latent reasoning priors in large models.</p>\n      </li>\n      <li>\n        <p><strong>Implicit Reasoning via In-Context Composition</strong>: From <a href=\"https://arxiv.org/abs/2005.14165\">Brown et al. (2020)</a>, LLMs can <em>implicitly</em> perform reasoning by inferring structured input‚Äìoutput mappings from few-shot examples. This process is latent, with reasoning occurring in attention dynamics rather than explicit text.</p>\n      </li>\n    </ul>\n<p><strong>Chain-of-Thought (CoT) Prompting</strong>: Introduced by <a href=\"https://arxiv.org/abs/2201.11903\">Wei et al. (2022)</a>, CoT explicitly elicits step-by-step reasoning traces, guiding the model to externalize intermediate computations before giving the final answer. Formally, the model predicts</p>\n<ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-338\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-339\"><span class=\"mi\" id=\"MathJax-Span-340\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">z</script> denotes latent reasoning traces approximated through explicit textual reasoning.</li>\n        </ul>\n<p><strong>Zero-Shot and Few-Shot CoT</strong>: As shown by <a href=\"https://arxiv.org/abs/2205.11916\">Kojima et al. (2022)</a>, adding simple triggers like ‚ÄúLet‚Äôs think step by step‚Äù can induce reasoning behavior even without demonstrations, revealing latent reasoning priors in large models.</p>\n<p><strong>Implicit Reasoning via In-Context Composition</strong>: From <a href=\"https://arxiv.org/abs/2005.14165\">Brown et al. (2020)</a>, LLMs can <em>implicitly</em> perform reasoning by inferring structured input‚Äìoutput mappings from few-shot examples. This process is latent, with reasoning occurring in attention dynamics rather than explicit text.</p>\n<ul>\n      <li>Implicit composition thus shows that LLMs can internalize algorithmic reasoning even without producing verbalized steps.</li>\n    </ul>",
    "contentMarkdown": "*   Prompting-based approaches induce reasoning by structuring the input context to make intermediate thinking explicit or implicitly compositional. These methods rely purely on **contextual cues** rather than architectural or training modifications. Examples below:\n    \n    *   **Chain-of-Thought (CoT) Prompting**: Introduced by [Wei et al. (2022)](https://arxiv.org/abs/2201.11903), CoT explicitly elicits step-by-step reasoning traces, guiding the model to externalize intermediate computations before giving the final answer. Formally, the model predicts\n        \n        yÃÇ¬†\\=argmaxy‚àëzpŒ∏(y,z|x)y^\\=arg‚Å°maxy‚àëzpŒ∏(y,z|x)\n        \n        \\\\hat{y} = \\\\arg\\\\max\\_y \\\\sum\\_z p\\_\\\\theta(y, z | x)\n        *   where zzz denotes latent reasoning traces approximated through explicit textual reasoning.\n    *   **Zero-Shot and Few-Shot CoT**: As shown by [Kojima et al. (2022)](https://arxiv.org/abs/2205.11916), adding simple triggers like ‚ÄúLet‚Äôs think step by step‚Äù can induce reasoning behavior even without demonstrations, revealing latent reasoning priors in large models.\n        \n    *   **Implicit Reasoning via In-Context Composition**: From [Brown et al. (2020)](https://arxiv.org/abs/2005.14165), LLMs can _implicitly_ perform reasoning by inferring structured input‚Äìoutput mappings from few-shot examples. This process is latent, with reasoning occurring in attention dynamics rather than explicit text.\n        \n    \n    pŒ∏(yn|xn,ÓàØ)\\=fŒ∏(xn;ÓàØ),ÓàØ\\=(xi,yi)n‚àí1i\\=1pŒ∏(yn|xn,C)\\=fŒ∏(xn;C),C\\=(xi,yi)i\\=1n‚àí1\n    \n    p\\_\\\\theta(y\\_n | x\\_n, \\\\mathcal{C}) = f\\_\\\\theta(x\\_n; \\\\mathcal{C}), \\\\quad \\\\mathcal{C} = {(x\\_i, y\\_i)}\\_{i=1}^{n-1}\n    *   Implicit composition thus shows that LLMs can internalize algorithmic reasoning even without producing verbalized steps.\n\nPrompting-based approaches induce reasoning by structuring the input context to make intermediate thinking explicit or implicitly compositional. These methods rely purely on **contextual cues** rather than architectural or training modifications. Examples below:\n\n*   **Chain-of-Thought (CoT) Prompting**: Introduced by [Wei et al. (2022)](https://arxiv.org/abs/2201.11903), CoT explicitly elicits step-by-step reasoning traces, guiding the model to externalize intermediate computations before giving the final answer. Formally, the model predicts\n    \n    yÃÇ¬†\\=argmaxy‚àëzpŒ∏(y,z|x)y^\\=arg‚Å°maxy‚àëzpŒ∏(y,z|x)\n    \n    \\\\hat{y} = \\\\arg\\\\max\\_y \\\\sum\\_z p\\_\\\\theta(y, z | x)\n    *   where zzz denotes latent reasoning traces approximated through explicit textual reasoning.\n*   **Zero-Shot and Few-Shot CoT**: As shown by [Kojima et al. (2022)](https://arxiv.org/abs/2205.11916), adding simple triggers like ‚ÄúLet‚Äôs think step by step‚Äù can induce reasoning behavior even without demonstrations, revealing latent reasoning priors in large models.\n    \n*   **Implicit Reasoning via In-Context Composition**: From [Brown et al. (2020)](https://arxiv.org/abs/2005.14165), LLMs can _implicitly_ perform reasoning by inferring structured input‚Äìoutput mappings from few-shot examples. This process is latent, with reasoning occurring in attention dynamics rather than explicit text.\n    \n\n**Chain-of-Thought (CoT) Prompting**: Introduced by [Wei et al. (2022)](https://arxiv.org/abs/2201.11903), CoT explicitly elicits step-by-step reasoning traces, guiding the model to externalize intermediate computations before giving the final answer. Formally, the model predicts\n\n*   where zzz denotes latent reasoning traces approximated through explicit textual reasoning.\n\n**Zero-Shot and Few-Shot CoT**: As shown by [Kojima et al. (2022)](https://arxiv.org/abs/2205.11916), adding simple triggers like ‚ÄúLet‚Äôs think step by step‚Äù can induce reasoning behavior even without demonstrations, revealing latent reasoning priors in large models.\n\n**Implicit Reasoning via In-Context Composition**: From [Brown et al. (2020)](https://arxiv.org/abs/2005.14165), LLMs can _implicitly_ perform reasoning by inferring structured input‚Äìoutput mappings from few-shot examples. This process is latent, with reasoning occurring in attention dynamics rather than explicit text.\n\n*   Implicit composition thus shows that LLMs can internalize algorithmic reasoning even without producing verbalized steps.",
    "order": 6,
    "orderInChapter": 2,
    "difficulty": 3,
    "estimatedMinutes": 3,
    "tags": [
      "nlpllms",
      "attention",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 478,
      "contentLength": 34471
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#prompting-based-reasoning",
    "scrapedAt": "2025-12-28T11:54:00.654Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-decoding-and-aggregation-based-reasoning-7",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Invoking Reasoning in LLMs",
    "title": "Decoding and Aggregation-Based Reasoning",
    "subtitle": "Invoking Reasoning in LLMs",
    "contentHtml": "<ul>\n  <li>\n    <p>Decoding strategies strengthen reasoning robustness by <strong>sampling and aggregating multiple reasoning paths</strong> rather than trusting a single deterministic chain. They treat reasoning as probabilistic inference over latent cognitive trajectories. Examples below:</p>\n\n    <ul>\n      <li>\n        <p><strong>Self-Consistency Decoding</strong>: <a href=\"https://arxiv.org/abs/2203.11171\">Wang et al. (2022)</a> proposed sampling multiple reasoning chains and aggregating their final answers to approximate Bayesian marginalization:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi></mrow></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=&quot;false&quot;>]</mo><mo>,</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-402\" style=\"width: 13.023em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.419em, 1010.78em, 3.753em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-403\"><span class=\"texatom\" id=\"MathJax-Span-404\"><span class=\"mrow\" id=\"MathJax-Span-405\"><span class=\"munderover\" id=\"MathJax-Span-406\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-407\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-408\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-409\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-410\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-411\"></span><span class=\"munderover\" id=\"MathJax-Span-412\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-413\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.43em, -999.997em); top: -3.331em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-414\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-415\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-416\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.273em, -999.997em); top: -2.862em; left: 0.055em;\"><span class=\"texatom\" id=\"MathJax-Span-417\"><span class=\"mrow\" id=\"MathJax-Span-418\"><span class=\"mi\" id=\"MathJax-Span-419\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-420\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-421\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.52em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-422\"><span class=\"mrow\" id=\"MathJax-Span-423\"><span class=\"mi\" id=\"MathJax-Span-424\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-425\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-426\"><span class=\"mi\" id=\"MathJax-Span-427\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-428\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-429\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-430\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-431\"><span class=\"mrow\" id=\"MathJax-Span-432\"><span class=\"mo\" id=\"MathJax-Span-433\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-434\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-435\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-436\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-437\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span><span class=\"mo\" id=\"MathJax-Span-438\" style=\"font-family: STIXGeneral-Regular;\">]</span><span class=\"mo\" id=\"MathJax-Span-439\" style=\"font-family: STIXGeneral-Regular;\">,</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>K</mi></mrow></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=\"false\">]</mo><mo>,</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-30\">\\hat{y} = \\arg\\max_y \\sum_{k=1}^{K} \\mathbb{I}[y^{(k)} = y],</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-440\" style=\"width: 1.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.3em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-441\"><span class=\"msubsup\" id=\"MathJax-Span-442\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-443\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-444\"><span class=\"mrow\" id=\"MathJax-Span-445\"><span class=\"mo\" id=\"MathJax-Span-446\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-447\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-448\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-31\">y^{(k)}</script> are outcomes from diverse reasoning samples. This approach reduces variance and enhances robustness on multi-step tasks.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Reflection and Self-Verification Loops</strong>: Frameworks such as <em>Reflexion</em> (<a href=\"https://arxiv.org/abs/2303.11366\">Shinn et al. (2023)</a>) and <em>Self-Refine</em> (<a href=\"https://arxiv.org/abs/2303.17651\">Madaan et al. (2023)</a>) introduce iterative critique‚Äìrevise cycles, allowing models to assess and improve their reasoning traces:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>x</mi><mover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot;><mtext>reason</mtext></mpadded></mover><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot;><mtext>reflect</mtext></mpadded></mover><mi>c</mi><mover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot;><mtext>revise</mtext></mpadded></mover><mo stretchy=&quot;false&quot;>(</mo><msup><mi>z</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>y</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-449\" style=\"width: 17.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.732em, 1014.64em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-450\"><span class=\"mi\" id=\"MathJax-Span-451\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"munderover\" id=\"MathJax-Span-452\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.45em, 4.117em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-453\" style=\"\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: -0.049em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 1.617em;\">‚Üí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.315em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.732em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.201em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.09em, 4.169em, -999.997em); top: -4.685em; left: 0.003em;\"><span class=\"mpadded\" id=\"MathJax-Span-454\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1001.83em, 4.169em, -999.997em); top: -4.164em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-455\"><span class=\"mtext\" id=\"MathJax-Span-456\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">reason</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-457\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"mi\" id=\"MathJax-Span-458\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-459\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-460\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-461\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"munderover\" id=\"MathJax-Span-462\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.4em, 4.117em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-463\" style=\"\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: -0.049em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 1.565em;\">‚Üí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.315em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.732em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.148em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1002.09em, 4.169em, -999.997em); top: -4.685em; left: 0.003em;\"><span class=\"mpadded\" id=\"MathJax-Span-464\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.83em, 4.169em, -999.997em); top: -4.164em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-465\"><span class=\"mtext\" id=\"MathJax-Span-466\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">reflect</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-467\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">c</span><span class=\"munderover\" id=\"MathJax-Span-468\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.29em, 4.117em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-469\" style=\"\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: -0.049em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 1.461em;\">‚Üí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.419em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.94em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1001.93em, 4.169em, -999.997em); top: -4.685em; left: 0.003em;\"><span class=\"mpadded\" id=\"MathJax-Span-470\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.67em, 4.169em, -999.997em); top: -4.164em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-471\"><span class=\"mtext\" id=\"MathJax-Span-472\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">revise</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-473\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"msup\" id=\"MathJax-Span-474\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-475\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-476\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-477\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-478\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-479\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-480\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-481\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>x</mi><mover><mo>‚Üí</mo><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\".15em\"><mtext>reason</mtext></mpadded></mover><mo stretchy=\"false\">(</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mover><mo>‚Üí</mo><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\".15em\"><mtext>reflect</mtext></mpadded></mover><mi>c</mi><mover><mo>‚Üí</mo><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\".15em\"><mtext>revise</mtext></mpadded></mover><mo stretchy=\"false\">(</mo><msup><mi>z</mi><mo>‚Ä≤</mo></msup><mo>,</mo><msup><mi>y</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-32\">x \\xrightarrow{\\text{reason}} (z, y) \\xrightarrow{\\text{reflect}} c \\xrightarrow{\\text{revise}} (z', y')</script>\n\n        <ul>\n          <li>Each loop refines the reasoning toward correctness or coherence.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>RCOT and Critic‚ÄìJudge Systems</strong>: <a href=\"https://arxiv.org/abs/2402.05402\">Zhang et al. (2024)</a> and <a href=\"https://arxiv.org/abs/2305.20050\">Zhou et al. (2023)</a> formalized structured reflective reasoning where critic models evaluate reasoning traces. This improves factual accuracy and consistency through meta-evaluation.</p>\n      </li>\n    </ul>\n  </li>\n</ul>\n<p>Decoding strategies strengthen reasoning robustness by <strong>sampling and aggregating multiple reasoning paths</strong> rather than trusting a single deterministic chain. They treat reasoning as probabilistic inference over latent cognitive trajectories. Examples below:</p>\n<ul>\n      <li>\n        <p><strong>Self-Consistency Decoding</strong>: <a href=\"https://arxiv.org/abs/2203.11171\">Wang et al. (2022)</a> proposed sampling multiple reasoning chains and aggregating their final answers to approximate Bayesian marginalization:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi></mrow></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=&quot;false&quot;>]</mo><mo>,</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-402\" style=\"width: 13.023em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.419em, 1010.78em, 3.753em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-403\"><span class=\"texatom\" id=\"MathJax-Span-404\"><span class=\"mrow\" id=\"MathJax-Span-405\"><span class=\"munderover\" id=\"MathJax-Span-406\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-407\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-408\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-409\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-410\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-411\"></span><span class=\"munderover\" id=\"MathJax-Span-412\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-413\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.43em, -999.997em); top: -3.331em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-414\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-415\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-416\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.273em, -999.997em); top: -2.862em; left: 0.055em;\"><span class=\"texatom\" id=\"MathJax-Span-417\"><span class=\"mrow\" id=\"MathJax-Span-418\"><span class=\"mi\" id=\"MathJax-Span-419\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-420\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-421\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.52em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-422\"><span class=\"mrow\" id=\"MathJax-Span-423\"><span class=\"mi\" id=\"MathJax-Span-424\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-425\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-426\"><span class=\"mi\" id=\"MathJax-Span-427\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-428\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-429\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-430\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-431\"><span class=\"mrow\" id=\"MathJax-Span-432\"><span class=\"mo\" id=\"MathJax-Span-433\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-434\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-435\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-436\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-437\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span><span class=\"mo\" id=\"MathJax-Span-438\" style=\"font-family: STIXGeneral-Regular;\">]</span><span class=\"mo\" id=\"MathJax-Span-439\" style=\"font-family: STIXGeneral-Regular;\">,</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>K</mi></mrow></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=\"false\">]</mo><mo>,</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-30\">\\hat{y} = \\arg\\max_y \\sum_{k=1}^{K} \\mathbb{I}[y^{(k)} = y],</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-440\" style=\"width: 1.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.3em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-441\"><span class=\"msubsup\" id=\"MathJax-Span-442\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-443\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-444\"><span class=\"mrow\" id=\"MathJax-Span-445\"><span class=\"mo\" id=\"MathJax-Span-446\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-447\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-448\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-31\">y^{(k)}</script> are outcomes from diverse reasoning samples. This approach reduces variance and enhances robustness on multi-step tasks.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Reflection and Self-Verification Loops</strong>: Frameworks such as <em>Reflexion</em> (<a href=\"https://arxiv.org/abs/2303.11366\">Shinn et al. (2023)</a>) and <em>Self-Refine</em> (<a href=\"https://arxiv.org/abs/2303.17651\">Madaan et al. (2023)</a>) introduce iterative critique‚Äìrevise cycles, allowing models to assess and improve their reasoning traces:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>x</mi><mover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot;><mtext>reason</mtext></mpadded></mover><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot;><mtext>reflect</mtext></mpadded></mover><mi>c</mi><mover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot;><mtext>revise</mtext></mpadded></mover><mo stretchy=&quot;false&quot;>(</mo><msup><mi>z</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>y</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-449\" style=\"width: 17.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.732em, 1014.64em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-450\"><span class=\"mi\" id=\"MathJax-Span-451\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"munderover\" id=\"MathJax-Span-452\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.45em, 4.117em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-453\" style=\"\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: -0.049em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 1.617em;\">‚Üí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.315em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.732em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.201em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.09em, 4.169em, -999.997em); top: -4.685em; left: 0.003em;\"><span class=\"mpadded\" id=\"MathJax-Span-454\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1001.83em, 4.169em, -999.997em); top: -4.164em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-455\"><span class=\"mtext\" id=\"MathJax-Span-456\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">reason</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-457\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"mi\" id=\"MathJax-Span-458\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-459\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-460\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-461\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"munderover\" id=\"MathJax-Span-462\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.4em, 4.117em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-463\" style=\"\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: -0.049em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 1.565em;\">‚Üí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.315em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.732em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.148em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1002.09em, 4.169em, -999.997em); top: -4.685em; left: 0.003em;\"><span class=\"mpadded\" id=\"MathJax-Span-464\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.83em, 4.169em, -999.997em); top: -4.164em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-465\"><span class=\"mtext\" id=\"MathJax-Span-466\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">reflect</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-467\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">c</span><span class=\"munderover\" id=\"MathJax-Span-468\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.29em, 4.117em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-469\" style=\"\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: -0.049em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 1.461em;\">‚Üí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.419em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.94em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1001.93em, 4.169em, -999.997em); top: -4.685em; left: 0.003em;\"><span class=\"mpadded\" id=\"MathJax-Span-470\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.67em, 4.169em, -999.997em); top: -4.164em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-471\"><span class=\"mtext\" id=\"MathJax-Span-472\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">revise</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-473\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"msup\" id=\"MathJax-Span-474\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-475\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-476\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-477\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-478\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-479\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-480\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-481\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>x</mi><mover><mo>‚Üí</mo><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\".15em\"><mtext>reason</mtext></mpadded></mover><mo stretchy=\"false\">(</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mover><mo>‚Üí</mo><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\".15em\"><mtext>reflect</mtext></mpadded></mover><mi>c</mi><mover><mo>‚Üí</mo><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\".15em\"><mtext>revise</mtext></mpadded></mover><mo stretchy=\"false\">(</mo><msup><mi>z</mi><mo>‚Ä≤</mo></msup><mo>,</mo><msup><mi>y</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-32\">x \\xrightarrow{\\text{reason}} (z, y) \\xrightarrow{\\text{reflect}} c \\xrightarrow{\\text{revise}} (z', y')</script>\n\n        <ul>\n          <li>Each loop refines the reasoning toward correctness or coherence.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>RCOT and Critic‚ÄìJudge Systems</strong>: <a href=\"https://arxiv.org/abs/2402.05402\">Zhang et al. (2024)</a> and <a href=\"https://arxiv.org/abs/2305.20050\">Zhou et al. (2023)</a> formalized structured reflective reasoning where critic models evaluate reasoning traces. This improves factual accuracy and consistency through meta-evaluation.</p>\n      </li>\n    </ul>\n<p><strong>Self-Consistency Decoding</strong>: <a href=\"https://arxiv.org/abs/2203.11171\">Wang et al. (2022)</a> proposed sampling multiple reasoning chains and aggregating their final answers to approximate Bayesian marginalization:</p>\n<ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-440\" style=\"width: 1.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.3em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-441\"><span class=\"msubsup\" id=\"MathJax-Span-442\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-443\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-444\"><span class=\"mrow\" id=\"MathJax-Span-445\"><span class=\"mo\" id=\"MathJax-Span-446\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-447\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-448\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-31\">y^{(k)}</script> are outcomes from diverse reasoning samples. This approach reduces variance and enhances robustness on multi-step tasks.</li>\n        </ul>\n<p><strong>Reflection and Self-Verification Loops</strong>: Frameworks such as <em>Reflexion</em> (<a href=\"https://arxiv.org/abs/2303.11366\">Shinn et al. (2023)</a>) and <em>Self-Refine</em> (<a href=\"https://arxiv.org/abs/2303.17651\">Madaan et al. (2023)</a>) introduce iterative critique‚Äìrevise cycles, allowing models to assess and improve their reasoning traces:</p>\n<ul>\n          <li>Each loop refines the reasoning toward correctness or coherence.</li>\n        </ul>\n<p><strong>RCOT and Critic‚ÄìJudge Systems</strong>: <a href=\"https://arxiv.org/abs/2402.05402\">Zhang et al. (2024)</a> and <a href=\"https://arxiv.org/abs/2305.20050\">Zhou et al. (2023)</a> formalized structured reflective reasoning where critic models evaluate reasoning traces. This improves factual accuracy and consistency through meta-evaluation.</p>",
    "contentMarkdown": "*   Decoding strategies strengthen reasoning robustness by **sampling and aggregating multiple reasoning paths** rather than trusting a single deterministic chain. They treat reasoning as probabilistic inference over latent cognitive trajectories. Examples below:\n    \n    *   **Self-Consistency Decoding**: [Wang et al. (2022)](https://arxiv.org/abs/2203.11171) proposed sampling multiple reasoning chains and aggregating their final answers to approximate Bayesian marginalization:\n        \n        yÃÇ¬†\\=argmaxy‚àëk\\=1KùïÄ\\[y(k)\\=y\\],y^\\=arg‚Å°maxy‚àëk\\=1KI\\[y(k)\\=y\\],\n        \n        \\\\hat{y} = \\\\arg\\\\max\\_y \\\\sum\\_{k=1}^{K} \\\\mathbb{I}\\[y^{(k)} = y\\],\n        *   where y(k)y(k)y^{(k)} are outcomes from diverse reasoning samples. This approach reduces variance and enhances robustness on multi-step tasks.\n    *   **Reflection and Self-Verification Loops**: Frameworks such as _Reflexion_ ([Shinn et al. (2023)](https://arxiv.org/abs/2303.11366)) and _Self-Refine_ ([Madaan et al. (2023)](https://arxiv.org/abs/2303.17651)) introduce iterative critique‚Äìrevise cycles, allowing models to assess and improve their reasoning traces:\n        \n        x‚àí‚Üí‚àí‚àí‚àíreason(z,y)‚àí‚Üí‚àí‚àí‚àíreflectc‚àí‚Üí‚àí‚àírevise(z‚Ä≤,y‚Ä≤)x‚Üíreason(z,y)‚Üíreflectc‚Üírevise(z‚Ä≤,y‚Ä≤)\n        \n        x \\\\xrightarrow{\\\\text{reason}} (z, y) \\\\xrightarrow{\\\\text{reflect}} c \\\\xrightarrow{\\\\text{revise}} (z', y')\n        *   Each loop refines the reasoning toward correctness or coherence.\n    *   **RCOT and Critic‚ÄìJudge Systems**: [Zhang et al. (2024)](https://arxiv.org/abs/2402.05402) and [Zhou et al. (2023)](https://arxiv.org/abs/2305.20050) formalized structured reflective reasoning where critic models evaluate reasoning traces. This improves factual accuracy and consistency through meta-evaluation.\n        \n\nDecoding strategies strengthen reasoning robustness by **sampling and aggregating multiple reasoning paths** rather than trusting a single deterministic chain. They treat reasoning as probabilistic inference over latent cognitive trajectories. Examples below:\n\n*   **Self-Consistency Decoding**: [Wang et al. (2022)](https://arxiv.org/abs/2203.11171) proposed sampling multiple reasoning chains and aggregating their final answers to approximate Bayesian marginalization:\n    \n    yÃÇ¬†\\=argmaxy‚àëk\\=1KùïÄ\\[y(k)\\=y\\],y^\\=arg‚Å°maxy‚àëk\\=1KI\\[y(k)\\=y\\],\n    \n    \\\\hat{y} = \\\\arg\\\\max\\_y \\\\sum\\_{k=1}^{K} \\\\mathbb{I}\\[y^{(k)} = y\\],\n    *   where y(k)y(k)y^{(k)} are outcomes from diverse reasoning samples. This approach reduces variance and enhances robustness on multi-step tasks.\n*   **Reflection and Self-Verification Loops**: Frameworks such as _Reflexion_ ([Shinn et al. (2023)](https://arxiv.org/abs/2303.11366)) and _Self-Refine_ ([Madaan et al. (2023)](https://arxiv.org/abs/2303.17651)) introduce iterative critique‚Äìrevise cycles, allowing models to assess and improve their reasoning traces:\n    \n    x‚àí‚Üí‚àí‚àí‚àíreason(z,y)‚àí‚Üí‚àí‚àí‚àíreflectc‚àí‚Üí‚àí‚àírevise(z‚Ä≤,y‚Ä≤)x‚Üíreason(z,y)‚Üíreflectc‚Üírevise(z‚Ä≤,y‚Ä≤)\n    \n    x \\\\xrightarrow{\\\\text{reason}} (z, y) \\\\xrightarrow{\\\\text{reflect}} c \\\\xrightarrow{\\\\text{revise}} (z', y')\n    *   Each loop refines the reasoning toward correctness or coherence.\n*   **RCOT and Critic‚ÄìJudge Systems**: [Zhang et al. (2024)](https://arxiv.org/abs/2402.05402) and [Zhou et al. (2023)](https://arxiv.org/abs/2305.20050) formalized structured reflective reasoning where critic models evaluate reasoning traces. This improves factual accuracy and consistency through meta-evaluation.\n    \n\n**Self-Consistency Decoding**: [Wang et al. (2022)](https://arxiv.org/abs/2203.11171) proposed sampling multiple reasoning chains and aggregating their final answers to approximate Bayesian marginalization:\n\n*   where y(k)y(k)y^{(k)} are outcomes from diverse reasoning samples. This approach reduces variance and enhances robustness on multi-step tasks.\n\n**Reflection and Self-Verification Loops**: Frameworks such as _Reflexion_ ([Shinn et al. (2023)](https://arxiv.org/abs/2303.11366)) and _Self-Refine_ ([Madaan et al. (2023)](https://arxiv.org/abs/2303.17651)) introduce iterative critique‚Äìrevise cycles, allowing models to assess and improve their reasoning traces:\n\n*   Each loop refines the reasoning toward correctness or coherence.\n\n**RCOT and Critic‚ÄìJudge Systems**: [Zhang et al. (2024)](https://arxiv.org/abs/2402.05402) and [Zhou et al. (2023)](https://arxiv.org/abs/2305.20050) formalized structured reflective reasoning where critic models evaluate reasoning traces. This improves factual accuracy and consistency through meta-evaluation.",
    "order": 7,
    "orderInChapter": 3,
    "difficulty": 3,
    "estimatedMinutes": 3,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 440,
      "contentLength": 50936
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#decoding-and-aggregation-based-reasoning",
    "scrapedAt": "2025-12-28T11:54:00.654Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-search-based-reasoning-8",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Invoking Reasoning in LLMs",
    "title": "Search-Based Reasoning",
    "subtitle": "Invoking Reasoning in LLMs",
    "contentHtml": "<ul>\n  <li>\n    <p>Search-based reasoning treats reasoning as <strong>explicit exploration</strong> through a structured search space. Instead of committing to one reasoning chain, the model maintains and expands a frontier of partial thoughts guided by learned or heuristic values. Examples below:</p>\n\n    <ul>\n      <li>\n        <p><strong>Tree-of-Thoughts (ToT) Prompting</strong>: <a href=\"https://arxiv.org/abs/2305.10601\">Yao et al. (2023)</a> generalized CoT into a search tree of reasoning steps, where partial ‚Äúthoughts‚Äù are evaluated and expanded. This transforms reasoning from a linear chain to a controlled exploration process guided by heuristic value estimates.</p>\n      </li>\n      <li>\n        <p><strong>Monte Carlo Tree Search (MCTS) and Value-Guided Variants</strong>: Building on <em>Tree-of-Thoughts</em>, these methods treat reasoning trajectories as nodes in a decision tree, using stochastic rollouts and value estimates <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-482\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-483\"><span class=\"msubsup\" id=\"MathJax-Span-484\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-485\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-486\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-487\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-488\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-489\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-490\"><span class=\"mrow\" id=\"MathJax-Span-491\"><span class=\"mn\" id=\"MathJax-Span-492\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-493\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-494\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-495\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-33\">V_\\phi(z_{1:t})</script> to select the most promising branches:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-34-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mi>R</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-496\" style=\"width: 18.909em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 15.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1015.63em, 2.971em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-497\"><span class=\"msubsup\" id=\"MathJax-Span-498\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-499\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-500\"><span class=\"mrow\" id=\"MathJax-Span-501\"><span class=\"mi\" id=\"MathJax-Span-502\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-503\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-504\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-505\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-506\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-507\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-508\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-509\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-510\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-511\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-512\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-513\"><span class=\"mrow\" id=\"MathJax-Span-514\"><span class=\"mo\" id=\"MathJax-Span-515\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-516\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-517\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-518\"><span class=\"mrow\" id=\"MathJax-Span-519\"><span class=\"mo\" id=\"MathJax-Span-520\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-521\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-522\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-523\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-524\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-525\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-526\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-527\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-528\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-529\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-530\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-531\"><span class=\"mrow\" id=\"MathJax-Span-532\"><span class=\"mn\" id=\"MathJax-Span-533\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-534\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-535\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-536\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-537\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"texatom\" id=\"MathJax-Span-538\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-539\"><span class=\"mi\" id=\"MathJax-Span-540\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span class=\"mo\" id=\"MathJax-Span-541\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-542\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"texatom\" id=\"MathJax-Span-543\"><span class=\"mrow\" id=\"MathJax-Span-544\"><span class=\"mo\" id=\"MathJax-Span-545\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-546\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-547\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-548\"><span class=\"mrow\" id=\"MathJax-Span-549\"><span class=\"mn\" id=\"MathJax-Span-550\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-551\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-552\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-553\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>‚àº</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>&lt;</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mspace width=\"1em\"></mspace><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚âà</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mo stretchy=\"false\">[</mo><mi>R</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-34\">z_{t+1} \\sim \\pi_\\theta(z_t | z_{<t}), \\quad V_\\phi(z_{1:t}) \\approx \\mathbb{E}[R | z_{1:t}]</script>\n\n        <ul>\n          <li>This search-based framing bridges symbolic planning with neural reasoning and underlies deliberative reasoning systems that combine exploration, pruning, and value-guided selection.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n</ul>\n<p>Search-based reasoning treats reasoning as <strong>explicit exploration</strong> through a structured search space. Instead of committing to one reasoning chain, the model maintains and expands a frontier of partial thoughts guided by learned or heuristic values. Examples below:</p>\n<ul>\n      <li>\n        <p><strong>Tree-of-Thoughts (ToT) Prompting</strong>: <a href=\"https://arxiv.org/abs/2305.10601\">Yao et al. (2023)</a> generalized CoT into a search tree of reasoning steps, where partial ‚Äúthoughts‚Äù are evaluated and expanded. This transforms reasoning from a linear chain to a controlled exploration process guided by heuristic value estimates.</p>\n      </li>\n      <li>\n        <p><strong>Monte Carlo Tree Search (MCTS) and Value-Guided Variants</strong>: Building on <em>Tree-of-Thoughts</em>, these methods treat reasoning trajectories as nodes in a decision tree, using stochastic rollouts and value estimates <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-482\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-483\"><span class=\"msubsup\" id=\"MathJax-Span-484\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-485\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-486\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-487\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-488\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-489\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-490\"><span class=\"mrow\" id=\"MathJax-Span-491\"><span class=\"mn\" id=\"MathJax-Span-492\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-493\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-494\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-495\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-33\">V_\\phi(z_{1:t})</script> to select the most promising branches:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-34-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mi>R</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-496\" style=\"width: 18.909em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 15.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1015.63em, 2.971em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-497\"><span class=\"msubsup\" id=\"MathJax-Span-498\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-499\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-500\"><span class=\"mrow\" id=\"MathJax-Span-501\"><span class=\"mi\" id=\"MathJax-Span-502\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-503\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-504\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-505\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-506\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-507\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-508\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-509\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-510\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-511\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-512\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-513\"><span class=\"mrow\" id=\"MathJax-Span-514\"><span class=\"mo\" id=\"MathJax-Span-515\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-516\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-517\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-518\"><span class=\"mrow\" id=\"MathJax-Span-519\"><span class=\"mo\" id=\"MathJax-Span-520\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-521\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-522\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-523\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-524\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-525\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-526\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-527\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-528\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-529\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-530\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-531\"><span class=\"mrow\" id=\"MathJax-Span-532\"><span class=\"mn\" id=\"MathJax-Span-533\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-534\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-535\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-536\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-537\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"texatom\" id=\"MathJax-Span-538\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-539\"><span class=\"mi\" id=\"MathJax-Span-540\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span class=\"mo\" id=\"MathJax-Span-541\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-542\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"texatom\" id=\"MathJax-Span-543\"><span class=\"mrow\" id=\"MathJax-Span-544\"><span class=\"mo\" id=\"MathJax-Span-545\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-546\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-547\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-548\"><span class=\"mrow\" id=\"MathJax-Span-549\"><span class=\"mn\" id=\"MathJax-Span-550\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-551\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-552\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-553\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>‚àº</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>&lt;</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mspace width=\"1em\"></mspace><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚âà</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mo stretchy=\"false\">[</mo><mi>R</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-34\">z_{t+1} \\sim \\pi_\\theta(z_t | z_{<t}), \\quad V_\\phi(z_{1:t}) \\approx \\mathbb{E}[R | z_{1:t}]</script>\n\n        <ul>\n          <li>This search-based framing bridges symbolic planning with neural reasoning and underlies deliberative reasoning systems that combine exploration, pruning, and value-guided selection.</li>\n        </ul>\n      </li>\n    </ul>\n<p><strong>Tree-of-Thoughts (ToT) Prompting</strong>: <a href=\"https://arxiv.org/abs/2305.10601\">Yao et al. (2023)</a> generalized CoT into a search tree of reasoning steps, where partial ‚Äúthoughts‚Äù are evaluated and expanded. This transforms reasoning from a linear chain to a controlled exploration process guided by heuristic value estimates.</p>\n<p><strong>Monte Carlo Tree Search (MCTS) and Value-Guided Variants</strong>: Building on <em>Tree-of-Thoughts</em>, these methods treat reasoning trajectories as nodes in a decision tree, using stochastic rollouts and value estimates <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-482\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-483\"><span class=\"msubsup\" id=\"MathJax-Span-484\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-485\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-486\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-487\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-488\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-489\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-490\"><span class=\"mrow\" id=\"MathJax-Span-491\"><span class=\"mn\" id=\"MathJax-Span-492\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-493\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-494\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-495\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-33\">V_\\phi(z_{1:t})</script> to select the most promising branches:</p>\n<ul>\n          <li>This search-based framing bridges symbolic planning with neural reasoning and underlies deliberative reasoning systems that combine exploration, pruning, and value-guided selection.</li>\n        </ul>",
    "contentMarkdown": "*   Search-based reasoning treats reasoning as **explicit exploration** through a structured search space. Instead of committing to one reasoning chain, the model maintains and expands a frontier of partial thoughts guided by learned or heuristic values. Examples below:\n    \n    *   **Tree-of-Thoughts (ToT) Prompting**: [Yao et al. (2023)](https://arxiv.org/abs/2305.10601) generalized CoT into a search tree of reasoning steps, where partial ‚Äúthoughts‚Äù are evaluated and expanded. This transforms reasoning from a linear chain to a controlled exploration process guided by heuristic value estimates.\n        \n    *   **Monte Carlo Tree Search (MCTS) and Value-Guided Variants**: Building on _Tree-of-Thoughts_, these methods treat reasoning trajectories as nodes in a decision tree, using stochastic rollouts and value estimates Vœï(z1:t)Vœï(z1:t)V\\_\\\\phi(z\\_{1:t}) to select the most promising branches:\n        \n        zt+1‚àºœÄŒ∏(zt|z<t),Vœï(z1:t)‚âàùîº\\[R|z1:t\\]zt+1‚àºœÄŒ∏(zt|z<t),Vœï(z1:t)‚âàE\\[R|z1:t\\]\n        \n        z\\_{t+1} \\\\sim \\\\pi\\_\\\\theta(z\\_t | z\\_{<t}), \\\\quad V\\_\\\\phi(z\\_{1:t}) \\\\approx \\\\mathbb{E}\\[R | z\\_{1:t}\\]\n        *   This search-based framing bridges symbolic planning with neural reasoning and underlies deliberative reasoning systems that combine exploration, pruning, and value-guided selection.\n\nSearch-based reasoning treats reasoning as **explicit exploration** through a structured search space. Instead of committing to one reasoning chain, the model maintains and expands a frontier of partial thoughts guided by learned or heuristic values. Examples below:\n\n*   **Tree-of-Thoughts (ToT) Prompting**: [Yao et al. (2023)](https://arxiv.org/abs/2305.10601) generalized CoT into a search tree of reasoning steps, where partial ‚Äúthoughts‚Äù are evaluated and expanded. This transforms reasoning from a linear chain to a controlled exploration process guided by heuristic value estimates.\n    \n*   **Monte Carlo Tree Search (MCTS) and Value-Guided Variants**: Building on _Tree-of-Thoughts_, these methods treat reasoning trajectories as nodes in a decision tree, using stochastic rollouts and value estimates Vœï(z1:t)Vœï(z1:t)V\\_\\\\phi(z\\_{1:t}) to select the most promising branches:\n    \n    zt+1‚àºœÄŒ∏(zt|z<t),Vœï(z1:t)‚âàùîº\\[R|z1:t\\]zt+1‚àºœÄŒ∏(zt|z<t),Vœï(z1:t)‚âàE\\[R|z1:t\\]\n    \n    z\\_{t+1} \\\\sim \\\\pi\\_\\\\theta(z\\_t | z\\_{<t}), \\\\quad V\\_\\\\phi(z\\_{1:t}) \\\\approx \\\\mathbb{E}\\[R | z\\_{1:t}\\]\n    *   This search-based framing bridges symbolic planning with neural reasoning and underlies deliberative reasoning systems that combine exploration, pruning, and value-guided selection.\n\n**Tree-of-Thoughts (ToT) Prompting**: [Yao et al. (2023)](https://arxiv.org/abs/2305.10601) generalized CoT into a search tree of reasoning steps, where partial ‚Äúthoughts‚Äù are evaluated and expanded. This transforms reasoning from a linear chain to a controlled exploration process guided by heuristic value estimates.\n\n**Monte Carlo Tree Search (MCTS) and Value-Guided Variants**: Building on _Tree-of-Thoughts_, these methods treat reasoning trajectories as nodes in a decision tree, using stochastic rollouts and value estimates Vœï(z1:t)Vœï(z1:t)V\\_\\\\phi(z\\_{1:t}) to select the most promising branches:\n\n*   This search-based framing bridges symbolic planning with neural reasoning and underlies deliberative reasoning systems that combine exploration, pruning, and value-guided selection.",
    "order": 8,
    "orderInChapter": 4,
    "difficulty": 3,
    "estimatedMinutes": 2,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 394,
      "contentLength": 37124
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#search-based-reasoning",
    "scrapedAt": "2025-12-28T11:54:00.654Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-tool-augmented-and-interaction-based-reasoning-9",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Invoking Reasoning in LLMs",
    "title": "Tool-Augmented and Interaction-Based Reasoning",
    "subtitle": "Invoking Reasoning in LLMs",
    "contentHtml": "<ul>\n  <li>\n    <p>This family connects <strong>internal reasoning with external information or computational tools</strong>, turning static text prediction into <em>interactive cognition</em>. Examples below:</p>\n\n    <ul>\n      <li>\n        <p><strong>ReAct Frameworks (Reason + Act)</strong>: <a href=\"https://arxiv.org/abs/2210.03629\">Yao et al. (2022)</a> proposed alternating between internal ‚ÄúThought‚Äù and external ‚ÄúAction‚Äù steps:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-35-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>x</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mtext>Thought</mtext><mn>1</mn></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mtext>Action</mtext><mn>1</mn></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mtext>Observation</mtext><mn>1</mn></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mo>&amp;#x22EF;</mo><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mi>y</mi></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-554\" style=\"width: 26.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 22.398em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1022.4em, 2.815em, -999.997em); top: -2.393em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-555\"><span class=\"mi\" id=\"MathJax-Span-556\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-557\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-558\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.39em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-559\" style=\"font-family: STIXGeneral-Regular;\">Thought</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.747em; left: 3.388em;\"><span class=\"mn\" id=\"MathJax-Span-560\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-561\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-562\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1002.71em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-563\" style=\"font-family: STIXGeneral-Regular;\">Action</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 2.711em;\"><span class=\"mn\" id=\"MathJax-Span-564\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-565\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-566\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 5.315em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1004.9em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-567\" style=\"font-family: STIXGeneral-Regular;\">Observation</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 4.898em;\"><span class=\"mn\" id=\"MathJax-Span-568\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-569\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"mo\" id=\"MathJax-Span-570\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚ãØ</span><span class=\"mo\" id=\"MathJax-Span-571\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"mi\" id=\"MathJax-Span-572\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.398em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>x</mi><mo stretchy=\"false\">‚Üí</mo><msub><mtext>Thought</mtext><mn>1</mn></msub><mo stretchy=\"false\">‚Üí</mo><msub><mtext>Action</mtext><mn>1</mn></msub><mo stretchy=\"false\">‚Üí</mo><msub><mtext>Observation</mtext><mn>1</mn></msub><mo stretchy=\"false\">‚Üí</mo><mo>‚ãØ</mo><mo stretchy=\"false\">‚Üí</mo><mi>y</mi></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-35\">x \\rightarrow \\text{Thought}_1 \\rightarrow \\text{Action}_1 \\rightarrow \\text{Observation}_1 \\rightarrow \\cdots \\rightarrow y</script>\n\n        <ul>\n          <li>This structure enables reasoning intertwined with API calls, search, or tool execution.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Tool-Augmented Reasoning</strong>: <a href=\"https://arxiv.org/abs/2302.04761\">Schick et al. (2023)</a> (<em>Toolformer</em>) and <a href=\"https://arxiv.org/abs/2211.10435\">Gao et al. (2022)</a> (<em>PAL</em>) demonstrated that LLMs can autonomously learn to invoke external tools like Python interpreters or search engines, grounding reasoning in verifiable computation.</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-36-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;><mtr><mtd><mtext>generate thought&amp;#xA0;</mtext><msub><mi>z</mi><mi>t</mi></msub></mtd><mtd><mtext>if&amp;#xA0;</mtext><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mtext>think</mtext><mo>,</mo></mtd></mtr><mtr><mtd><mtext>call tool&amp;#xA0;</mtext><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow><mi>i</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mtd><mtd><mtext>if&amp;#xA0;</mtext><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mtext>act</mtext></mtd></mtr></mtable><mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;></mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-573\" style=\"width: 23.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 19.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.294em, 1019.69em, 4.846em, -999.997em); top: -3.799em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-574\"><span class=\"msubsup\" id=\"MathJax-Span-575\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-576\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-577\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-578\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-579\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-580\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-581\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-582\"><span class=\"mrow\" id=\"MathJax-Span-583\"><span class=\"mo\" id=\"MathJax-Span-584\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-585\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-586\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-587\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-588\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-589\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mrow\" id=\"MathJax-Span-590\" style=\"padding-left: 0.315em;\"><span class=\"mo\" id=\"MathJax-Span-591\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">{</span></span></span><span class=\"mtable\" id=\"MathJax-Span-592\" style=\"padding-right: 0.159em; padding-left: 0.159em;\"><span style=\"display: inline-block; position: relative; width: 14.013em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.607em, 1007.61em, 5.003em, -999.997em); top: -4.008em; left: 0em;\"><span style=\"display: inline-block; position: relative; width: 7.607em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1007.61em, 4.378em, -999.997em); top: -4.581em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-593\"><span class=\"mrow\" id=\"MathJax-Span-594\"><span class=\"mtext\" id=\"MathJax-Span-595\" style=\"font-family: STIXGeneral-Regular;\">generate thought&nbsp;</span><span class=\"msubsup\" id=\"MathJax-Span-596\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-597\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-598\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.128em, 1005.58em, 4.326em, -999.997em); top: -3.331em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-608\"><span class=\"mrow\" id=\"MathJax-Span-609\"><span class=\"mtext\" id=\"MathJax-Span-610\" style=\"font-family: STIXGeneral-Regular;\">call tool&nbsp;</span><span class=\"msubsup\" id=\"MathJax-Span-611\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.128em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-612\"><span class=\"mrow\" id=\"MathJax-Span-613\"><span class=\"mi\" id=\"MathJax-Span-614\" style=\"font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.211em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-615\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-616\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-617\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-618\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-619\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-620\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(2.607em, 1005.21em, 5.003em, -999.997em); top: -4.008em; left: 8.753em;\"><span style=\"display: inline-block; position: relative; width: 5.263em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1005.21em, 4.326em, -999.997em); top: -4.581em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-599\"><span class=\"mrow\" id=\"MathJax-Span-600\"><span class=\"mtext\" id=\"MathJax-Span-601\" style=\"font-family: STIXGeneral-Regular;\">if&nbsp;</span><span class=\"msubsup\" id=\"MathJax-Span-602\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-603\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-604\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-605\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mtext\" id=\"MathJax-Span-606\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">think</span><span class=\"mo\" id=\"MathJax-Span-607\" style=\"font-family: STIXGeneral-Regular;\">,</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1004.12em, 4.326em, -999.997em); top: -3.331em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-621\"><span class=\"mrow\" id=\"MathJax-Span-622\"><span class=\"mtext\" id=\"MathJax-Span-623\" style=\"font-family: STIXGeneral-Regular;\">if&nbsp;</span><span class=\"msubsup\" id=\"MathJax-Span-624\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-625\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-626\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-627\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mtext\" id=\"MathJax-Span-628\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">act</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-629\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.805em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign=\"left left\" rowspacing=\".2em\" columnspacing=\"1em\" displaystyle=\"false\"><mtr><mtd><mtext>generate thought&nbsp;</mtext><msub><mi>z</mi><mi>t</mi></msub></mtd><mtd><mtext>if&nbsp;</mtext><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mtext>think</mtext><mo>,</mo></mtd></mtr><mtr><mtd><mtext>call tool&nbsp;</mtext><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mtd><mtd><mtext>if&nbsp;</mtext><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mtext>act</mtext></mtd></mtr></mtable><mo fence=\"true\" stretchy=\"true\" symmetric=\"true\"></mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-36\">\\pi_\\theta(a_t | s_t) =\n\\begin{cases}\n\\text{generate thought } z_t & \\text{if } a_t = \\text{think},\\\\\n\\text{call tool } \\mathcal{T}_i(s_t) & \\text{if } a_t = \\text{act}\n\\end{cases}</script>\n      </li>\n      <li>\n        <p><strong>PAL (Program-Aided Language Models)</strong>: Delegates subproblems to code snippets, merging natural-language reasoning with executable verification. This hybrid reasoning yields higher factuality and transparency.</p>\n      </li>\n      <li>\n        <p><strong>Reflexion Agents</strong>: <a href=\"https://arxiv.org/abs/2303.11366\">Shinn et al. (2023)</a> extended ReAct-style systems with reflective feedback, enabling models to self-correct and improve during tool-based interactions.</p>\n      </li>\n    </ul>\n  </li>\n</ul>\n<p>This family connects <strong>internal reasoning with external information or computational tools</strong>, turning static text prediction into <em>interactive cognition</em>. Examples below:</p>\n<ul>\n      <li>\n        <p><strong>ReAct Frameworks (Reason + Act)</strong>: <a href=\"https://arxiv.org/abs/2210.03629\">Yao et al. (2022)</a> proposed alternating between internal ‚ÄúThought‚Äù and external ‚ÄúAction‚Äù steps:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-35-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>x</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mtext>Thought</mtext><mn>1</mn></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mtext>Action</mtext><mn>1</mn></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mtext>Observation</mtext><mn>1</mn></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mo>&amp;#x22EF;</mo><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mi>y</mi></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-554\" style=\"width: 26.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 22.398em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1022.4em, 2.815em, -999.997em); top: -2.393em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-555\"><span class=\"mi\" id=\"MathJax-Span-556\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-557\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-558\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.39em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-559\" style=\"font-family: STIXGeneral-Regular;\">Thought</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.747em; left: 3.388em;\"><span class=\"mn\" id=\"MathJax-Span-560\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-561\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-562\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1002.71em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-563\" style=\"font-family: STIXGeneral-Regular;\">Action</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 2.711em;\"><span class=\"mn\" id=\"MathJax-Span-564\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-565\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-566\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 5.315em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1004.9em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-567\" style=\"font-family: STIXGeneral-Regular;\">Observation</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 4.898em;\"><span class=\"mn\" id=\"MathJax-Span-568\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-569\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"mo\" id=\"MathJax-Span-570\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚ãØ</span><span class=\"mo\" id=\"MathJax-Span-571\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"mi\" id=\"MathJax-Span-572\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.398em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>x</mi><mo stretchy=\"false\">‚Üí</mo><msub><mtext>Thought</mtext><mn>1</mn></msub><mo stretchy=\"false\">‚Üí</mo><msub><mtext>Action</mtext><mn>1</mn></msub><mo stretchy=\"false\">‚Üí</mo><msub><mtext>Observation</mtext><mn>1</mn></msub><mo stretchy=\"false\">‚Üí</mo><mo>‚ãØ</mo><mo stretchy=\"false\">‚Üí</mo><mi>y</mi></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-35\">x \\rightarrow \\text{Thought}_1 \\rightarrow \\text{Action}_1 \\rightarrow \\text{Observation}_1 \\rightarrow \\cdots \\rightarrow y</script>\n\n        <ul>\n          <li>This structure enables reasoning intertwined with API calls, search, or tool execution.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Tool-Augmented Reasoning</strong>: <a href=\"https://arxiv.org/abs/2302.04761\">Schick et al. (2023)</a> (<em>Toolformer</em>) and <a href=\"https://arxiv.org/abs/2211.10435\">Gao et al. (2022)</a> (<em>PAL</em>) demonstrated that LLMs can autonomously learn to invoke external tools like Python interpreters or search engines, grounding reasoning in verifiable computation.</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-36-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;><mtr><mtd><mtext>generate thought&amp;#xA0;</mtext><msub><mi>z</mi><mi>t</mi></msub></mtd><mtd><mtext>if&amp;#xA0;</mtext><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mtext>think</mtext><mo>,</mo></mtd></mtr><mtr><mtd><mtext>call tool&amp;#xA0;</mtext><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow><mi>i</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mtd><mtd><mtext>if&amp;#xA0;</mtext><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mtext>act</mtext></mtd></mtr></mtable><mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;></mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-573\" style=\"width: 23.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 19.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.294em, 1019.69em, 4.846em, -999.997em); top: -3.799em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-574\"><span class=\"msubsup\" id=\"MathJax-Span-575\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-576\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-577\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-578\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-579\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-580\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-581\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-582\"><span class=\"mrow\" id=\"MathJax-Span-583\"><span class=\"mo\" id=\"MathJax-Span-584\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-585\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-586\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-587\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-588\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-589\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mrow\" id=\"MathJax-Span-590\" style=\"padding-left: 0.315em;\"><span class=\"mo\" id=\"MathJax-Span-591\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">{</span></span></span><span class=\"mtable\" id=\"MathJax-Span-592\" style=\"padding-right: 0.159em; padding-left: 0.159em;\"><span style=\"display: inline-block; position: relative; width: 14.013em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.607em, 1007.61em, 5.003em, -999.997em); top: -4.008em; left: 0em;\"><span style=\"display: inline-block; position: relative; width: 7.607em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1007.61em, 4.378em, -999.997em); top: -4.581em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-593\"><span class=\"mrow\" id=\"MathJax-Span-594\"><span class=\"mtext\" id=\"MathJax-Span-595\" style=\"font-family: STIXGeneral-Regular;\">generate thought&nbsp;</span><span class=\"msubsup\" id=\"MathJax-Span-596\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-597\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-598\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.128em, 1005.58em, 4.326em, -999.997em); top: -3.331em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-608\"><span class=\"mrow\" id=\"MathJax-Span-609\"><span class=\"mtext\" id=\"MathJax-Span-610\" style=\"font-family: STIXGeneral-Regular;\">call tool&nbsp;</span><span class=\"msubsup\" id=\"MathJax-Span-611\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.128em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-612\"><span class=\"mrow\" id=\"MathJax-Span-613\"><span class=\"mi\" id=\"MathJax-Span-614\" style=\"font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.211em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-615\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-616\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-617\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-618\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-619\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-620\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(2.607em, 1005.21em, 5.003em, -999.997em); top: -4.008em; left: 8.753em;\"><span style=\"display: inline-block; position: relative; width: 5.263em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1005.21em, 4.326em, -999.997em); top: -4.581em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-599\"><span class=\"mrow\" id=\"MathJax-Span-600\"><span class=\"mtext\" id=\"MathJax-Span-601\" style=\"font-family: STIXGeneral-Regular;\">if&nbsp;</span><span class=\"msubsup\" id=\"MathJax-Span-602\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-603\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-604\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-605\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mtext\" id=\"MathJax-Span-606\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">think</span><span class=\"mo\" id=\"MathJax-Span-607\" style=\"font-family: STIXGeneral-Regular;\">,</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1004.12em, 4.326em, -999.997em); top: -3.331em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-621\"><span class=\"mrow\" id=\"MathJax-Span-622\"><span class=\"mtext\" id=\"MathJax-Span-623\" style=\"font-family: STIXGeneral-Regular;\">if&nbsp;</span><span class=\"msubsup\" id=\"MathJax-Span-624\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-625\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-626\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-627\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mtext\" id=\"MathJax-Span-628\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">act</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-629\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.805em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign=\"left left\" rowspacing=\".2em\" columnspacing=\"1em\" displaystyle=\"false\"><mtr><mtd><mtext>generate thought&nbsp;</mtext><msub><mi>z</mi><mi>t</mi></msub></mtd><mtd><mtext>if&nbsp;</mtext><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mtext>think</mtext><mo>,</mo></mtd></mtr><mtr><mtd><mtext>call tool&nbsp;</mtext><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mtd><mtd><mtext>if&nbsp;</mtext><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mtext>act</mtext></mtd></mtr></mtable><mo fence=\"true\" stretchy=\"true\" symmetric=\"true\"></mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-36\">\\pi_\\theta(a_t | s_t) =\n\\begin{cases}\n\\text{generate thought } z_t & \\text{if } a_t = \\text{think},\\\\\n\\text{call tool } \\mathcal{T}_i(s_t) & \\text{if } a_t = \\text{act}\n\\end{cases}</script>\n      </li>\n      <li>\n        <p><strong>PAL (Program-Aided Language Models)</strong>: Delegates subproblems to code snippets, merging natural-language reasoning with executable verification. This hybrid reasoning yields higher factuality and transparency.</p>\n      </li>\n      <li>\n        <p><strong>Reflexion Agents</strong>: <a href=\"https://arxiv.org/abs/2303.11366\">Shinn et al. (2023)</a> extended ReAct-style systems with reflective feedback, enabling models to self-correct and improve during tool-based interactions.</p>\n      </li>\n    </ul>\n<p><strong>ReAct Frameworks (Reason + Act)</strong>: <a href=\"https://arxiv.org/abs/2210.03629\">Yao et al. (2022)</a> proposed alternating between internal ‚ÄúThought‚Äù and external ‚ÄúAction‚Äù steps:</p>\n<ul>\n          <li>This structure enables reasoning intertwined with API calls, search, or tool execution.</li>\n        </ul>\n<p><strong>Tool-Augmented Reasoning</strong>: <a href=\"https://arxiv.org/abs/2302.04761\">Schick et al. (2023)</a> (<em>Toolformer</em>) and <a href=\"https://arxiv.org/abs/2211.10435\">Gao et al. (2022)</a> (<em>PAL</em>) demonstrated that LLMs can autonomously learn to invoke external tools like Python interpreters or search engines, grounding reasoning in verifiable computation.</p>\n<p><strong>PAL (Program-Aided Language Models)</strong>: Delegates subproblems to code snippets, merging natural-language reasoning with executable verification. This hybrid reasoning yields higher factuality and transparency.</p>\n<p><strong>Reflexion Agents</strong>: <a href=\"https://arxiv.org/abs/2303.11366\">Shinn et al. (2023)</a> extended ReAct-style systems with reflective feedback, enabling models to self-correct and improve during tool-based interactions.</p>",
    "contentMarkdown": "*   This family connects **internal reasoning with external information or computational tools**, turning static text prediction into _interactive cognition_. Examples below:\n    \n    *   **ReAct Frameworks (Reason + Act)**: [Yao et al. (2022)](https://arxiv.org/abs/2210.03629) proposed alternating between internal ‚ÄúThought‚Äù and external ‚ÄúAction‚Äù steps:\n        \n        x‚ÜíThought1‚ÜíAction1‚ÜíObservation1‚Üí‚ãØ‚Üíyx‚ÜíThought1‚ÜíAction1‚ÜíObservation1‚Üí‚ãØ‚Üíy\n        \n        x \\\\rightarrow \\\\text{Thought}\\_1 \\\\rightarrow \\\\text{Action}\\_1 \\\\rightarrow \\\\text{Observation}\\_1 \\\\rightarrow \\\\cdots \\\\rightarrow y\n        *   This structure enables reasoning intertwined with API calls, search, or tool execution.\n    *   **Tool-Augmented Reasoning**: [Schick et al. (2023)](https://arxiv.org/abs/2302.04761) (_Toolformer_) and [Gao et al. (2022)](https://arxiv.org/abs/2211.10435) (_PAL_) demonstrated that LLMs can autonomously learn to invoke external tools like Python interpreters or search engines, grounding reasoning in verifiable computation.\n        \n        œÄŒ∏(at|st)\\={generate thought¬†ztcall tool¬†ÓâÄi(st)if¬†at\\=think,if¬†at\\=actœÄŒ∏(at|st)\\={generate thought¬†ztif¬†at\\=think,call tool¬†Ti(st)if¬†at\\=act\n        \n        \\\\pi\\_\\\\theta(a\\_t | s\\_t) = \\\\begin{cases} \\\\text{generate thought } z\\_t & \\\\text{if } a\\_t = \\\\text{think},\\\\\\\\ \\\\text{call tool } \\\\mathcal{T}\\_i(s\\_t) & \\\\text{if } a\\_t = \\\\text{act} \\\\end{cases}\n    *   **PAL (Program-Aided Language Models)**: Delegates subproblems to code snippets, merging natural-language reasoning with executable verification. This hybrid reasoning yields higher factuality and transparency.\n        \n    *   **Reflexion Agents**: [Shinn et al. (2023)](https://arxiv.org/abs/2303.11366) extended ReAct-style systems with reflective feedback, enabling models to self-correct and improve during tool-based interactions.\n        \n\nThis family connects **internal reasoning with external information or computational tools**, turning static text prediction into _interactive cognition_. Examples below:\n\n*   **ReAct Frameworks (Reason + Act)**: [Yao et al. (2022)](https://arxiv.org/abs/2210.03629) proposed alternating between internal ‚ÄúThought‚Äù and external ‚ÄúAction‚Äù steps:\n    \n    x‚ÜíThought1‚ÜíAction1‚ÜíObservation1‚Üí‚ãØ‚Üíyx‚ÜíThought1‚ÜíAction1‚ÜíObservation1‚Üí‚ãØ‚Üíy\n    \n    x \\\\rightarrow \\\\text{Thought}\\_1 \\\\rightarrow \\\\text{Action}\\_1 \\\\rightarrow \\\\text{Observation}\\_1 \\\\rightarrow \\\\cdots \\\\rightarrow y\n    *   This structure enables reasoning intertwined with API calls, search, or tool execution.\n*   **Tool-Augmented Reasoning**: [Schick et al. (2023)](https://arxiv.org/abs/2302.04761) (_Toolformer_) and [Gao et al. (2022)](https://arxiv.org/abs/2211.10435) (_PAL_) demonstrated that LLMs can autonomously learn to invoke external tools like Python interpreters or search engines, grounding reasoning in verifiable computation.\n    \n    œÄŒ∏(at|st)\\={generate thought¬†ztcall tool¬†ÓâÄi(st)if¬†at\\=think,if¬†at\\=actœÄŒ∏(at|st)\\={generate thought¬†ztif¬†at\\=think,call tool¬†Ti(st)if¬†at\\=act\n    \n    \\\\pi\\_\\\\theta(a\\_t | s\\_t) = \\\\begin{cases} \\\\text{generate thought } z\\_t & \\\\text{if } a\\_t = \\\\text{think},\\\\\\\\ \\\\text{call tool } \\\\mathcal{T}\\_i(s\\_t) & \\\\text{if } a\\_t = \\\\text{act} \\\\end{cases}\n*   **PAL (Program-Aided Language Models)**: Delegates subproblems to code snippets, merging natural-language reasoning with executable verification. This hybrid reasoning yields higher factuality and transparency.\n    \n*   **Reflexion Agents**: [Shinn et al. (2023)](https://arxiv.org/abs/2303.11366) extended ReAct-style systems with reflective feedback, enabling models to self-correct and improve during tool-based interactions.\n    \n\n**ReAct Frameworks (Reason + Act)**: [Yao et al. (2022)](https://arxiv.org/abs/2210.03629) proposed alternating between internal ‚ÄúThought‚Äù and external ‚ÄúAction‚Äù steps:\n\n*   This structure enables reasoning intertwined with API calls, search, or tool execution.\n\n**Tool-Augmented Reasoning**: [Schick et al. (2023)](https://arxiv.org/abs/2302.04761) (_Toolformer_) and [Gao et al. (2022)](https://arxiv.org/abs/2211.10435) (_PAL_) demonstrated that LLMs can autonomously learn to invoke external tools like Python interpreters or search engines, grounding reasoning in verifiable computation.\n\n**PAL (Program-Aided Language Models)**: Delegates subproblems to code snippets, merging natural-language reasoning with executable verification. This hybrid reasoning yields higher factuality and transparency.\n\n**Reflexion Agents**: [Shinn et al. (2023)](https://arxiv.org/abs/2303.11366) extended ReAct-style systems with reflective feedback, enabling models to self-correct and improve during tool-based interactions.",
    "order": 9,
    "orderInChapter": 5,
    "difficulty": 3,
    "estimatedMinutes": 3,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 478,
      "contentLength": 42002
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#tool-augmented-and-interaction-based-reasoning",
    "scrapedAt": "2025-12-28T11:54:00.654Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-reinforcement-learning-based-reasoning-10",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Invoking Reasoning in LLMs",
    "title": "Reinforcement Learning-Based Reasoning",
    "subtitle": "Invoking Reasoning in LLMs",
    "contentHtml": "<ul>\n  <li>\n    <p>Reinforcement Learning (RL) frames reasoning as <strong>policy optimization over reasoning trajectories</strong>, where models learn to maximize rewards reflecting correctness, efficiency, or verifiability. Examples below:</p>\n\n    <ul>\n      <li>\n        <p><strong>DeepSeek-R1 (Correctness-Guided Policy Optimization)</strong>: <a href=\"https://arxiv.org/abs/2501.12948\">Guo et al. (2025)</a> introduced a RL framework for reasoning that eliminates the need for human-annotated rationales. Instead, the model learns directly from correctness-based feedback signals that are objectively verifiable. The optimization objective is defined as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-37-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>J</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>,</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo>&amp;#x223C;</mo><mi>p</mi><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-630\" style=\"width: 13.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.096em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1010.99em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-631\"><span class=\"texatom\" id=\"MathJax-Span-632\"><span class=\"mrow\" id=\"MathJax-Span-633\"><span class=\"mi\" id=\"MathJax-Span-634\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∂<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-635\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-636\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-637\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-638\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-639\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.378em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-640\"><span class=\"mrow\" id=\"MathJax-Span-641\"><span class=\"mi\" id=\"MathJax-Span-642\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-643\"><span class=\"mrow\" id=\"MathJax-Span-644\"><span class=\"mi\" id=\"MathJax-Span-645\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-646\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-647\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-648\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-649\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-650\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"mi\" id=\"MathJax-Span-651\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">p</span><span class=\"mi\" id=\"MathJax-Span-652\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-653\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-654\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"texatom\" id=\"MathJax-Span-655\"><span class=\"mrow\" id=\"MathJax-Span-656\"><span class=\"mo\" id=\"MathJax-Span-657\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-658\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-659\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-660\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-661\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-662\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-663\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-664\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-665\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-666\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-667\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">J</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>,</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo>‚àº</mo><mi>p</mi><mi>Œ∏</mi><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo stretchy=\"false\">[</mo><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-37\">\\mathcal{J}(\\theta) = \\mathbb{E}_{x, z, y \\sim p \\theta(\\cdot|x)} [R(y, z)]</script>\n\n        <ul>\n          <li>\n            <p><strong>Key Components</strong>:</p>\n\n            <ul>\n              <li>\n                <p><strong>Reward Structure</strong>:</p>\n\n                <ul>\n                  <li>\n                    <p>The reward function integrates both correctness and computational efficiency:</p>\n\n                    <p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mtext>correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2212;</mo><mi>&amp;#x03BB;</mi><mtext>cost</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-668\" style=\"width: 14.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1012.09em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-669\"><span class=\"mi\" id=\"MathJax-Span-670\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-671\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-672\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-673\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-674\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-675\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-676\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-677\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-678\"><span class=\"mi\" id=\"MathJax-Span-679\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-680\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mtext\" id=\"MathJax-Span-681\" style=\"font-family: STIXGeneral-Regular;\">correct</span><span class=\"mo\" id=\"MathJax-Span-682\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-683\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-684\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-685\" style=\"font-family: STIXGeneral-Regular;\">]</span><span class=\"mo\" id=\"MathJax-Span-686\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-687\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œª</span><span class=\"mtext\" id=\"MathJax-Span-688\" style=\"font-family: STIXGeneral-Regular;\">cost</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><mtext>correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo>‚àí</mo><mi>Œª</mi><mtext>cost</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-38\">R(y, z) = \\mathbb{I}[\\text{correct}(y)] - \\lambda \\text{cost}</script>z<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-39-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; />\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-689\" style=\"width: 0em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-690\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-39\"></script></p>\n\n                    <ul>\n                      <li>where:\n                        <ul>\n                          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mtext>correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-691\" style=\"width: 5.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.951em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1004.85em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-692\"><span class=\"texatom\" id=\"MathJax-Span-693\"><span class=\"mrow\" id=\"MathJax-Span-694\"><span class=\"mi\" id=\"MathJax-Span-695\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-696\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mtext\" id=\"MathJax-Span-697\" style=\"font-family: STIXGeneral-Regular;\">correct</span><span class=\"mo\" id=\"MathJax-Span-698\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-699\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-700\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-701\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><mtext>correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-40\">\\mathbb{I}[\\text{correct}(y)]</script> indicates whether the model‚Äôs answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-702\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-703\"><span class=\"mi\" id=\"MathJax-Span-704\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">y</script> matches the ground truth, while <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>cost</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-705\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.461em, 1001.62em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-706\"><span class=\"mtext\" id=\"MathJax-Span-707\" style=\"font-family: STIXGeneral-Regular;\">cost</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>cost</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">\\text{cost}</script>z<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; />\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-708\" style=\"width: 0em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-709\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-43\"></script> measures the resource usage (e.g., number of reasoning steps or token length) of the reasoning trace <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-710\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-711\"><span class=\"mi\" id=\"MathJax-Span-712\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-44\">z</script>.</li>\n                          <li>The hyperparameter <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BB;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-713\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-714\"><span class=\"mi\" id=\"MathJax-Span-715\" style=\"font-family: STIXGeneral-Italic;\">Œª</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œª</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-45\">\\lambda</script> balances the trade-off between accuracy and efficiency.</li>\n                        </ul>\n                      </li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n              <li>\n                <p><strong>Policy Learning without Rationales</strong>:</p>\n\n                <ul>\n                  <li>Unlike earlier reasoning models that rely on <strong>process-level/step-level human supervision</strong> or <strong>rationalized trajectories</strong>, DeepSeek-R1 learns purely from outcome-level rewards.</li>\n                  <li>This shifts the training paradigm from <strong>imitating explanations</strong> to <strong>discovering effective reasoning trajectories</strong> through exploration and optimization.</li>\n                </ul>\n              </li>\n              <li>\n                <p><strong>Conciseness and Verifiability</strong>:</p>\n\n                <ul>\n                  <li>By penalizing longer or redundant reasoning paths, the model learns to favor concise solutions.</li>\n                  <li>The reward design implicitly biases the policy toward interpretable and verifiable reasoning traces, improving robustness across mathematical and symbolic reasoning tasks.</li>\n                </ul>\n              </li>\n              <li>\n                <p><strong>Empirical Findings</strong>:</p>\n\n                <ul>\n                  <li>DeepSeek-R1 demonstrates that outcome-based RL‚Äîwhen paired with reward shaping‚Äîcan achieve reasoning quality comparable to process-supervised models.</li>\n                  <li>The study highlights that reinforcement-driven optimization can uncover reasoning strategies aligned with correctness and minimal computational cost, without explicit human process supervision.</li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Process vs. Outcome Supervision</strong>: <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a> and <a href=\"https://openai.com/index/improving-mathematical-reasoning-with-process-supervision/\">OpenAI (2023)</a> demonstrated that step-level (i.e., process-level) correctness rewards improve reliability and stability compared to outcome-level rewards.</p>\n      </li>\n      <li>\n        <p><strong>Tool-Augmented RLHF</strong>: <a href=\"https://arxiv.org/abs/2112.09332\">Nakano et al. (2021)</a> extended RLHF to web-based environments.</p>\n\n        <ul>\n          <li>\n            <p>In <a href=\"https://arxiv.org/abs/2112.09332\">WebGPT</a>, Nakano et al. implemented <strong>Reinforcement Learning with Human Feedback</strong> (RLHF)** over a <strong>browser-driven interface</strong>, where the model navigated and queried the web to retrieve supporting evidence before answering. Reward models trained on human preferences compared answers and their citations, encouraging factual accuracy and verifiability through policy optimization with proximal policy optimization (PPO). This demonstrated that verifiable, tool-grounded reasoning could be operationalized within an RL framework.</p>\n          </li>\n          <li>\n            <p>Building on that foundation, <strong>Themis</strong> (<a href=\"https://arxiv.org/abs/2310.01045\">Li et al., 2024</a>) proposed <em>tool-augmented reward modeling</em>, allowing reward models themselves to call external APIs‚Äîcalculators, translators, or search engines‚Äîduring preference evaluation. The hybrid loss function</p>\n          </li>\n        </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-46-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>total</mtext></mrow></msub><mo>=</mo><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>RM</mtext></mrow></msub><mo>+</mo><mi>&amp;#x03B1;</mi><munder><mo>&amp;#x2211;</mo><mi>t</mi></munder><mo stretchy=&quot;false&quot;>(</mo><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>tool</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B2;</mi><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>obs</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03C9;</mi><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>rat</mtext></mrow></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-716\" style=\"width: 22.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 18.753em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1018.75em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-717\"><span class=\"msubsup\" id=\"MathJax-Span-718\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-719\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-720\"><span class=\"mrow\" id=\"MathJax-Span-721\"><span class=\"mtext\" id=\"MathJax-Span-722\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">total</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-723\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-724\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-725\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-726\"><span class=\"mrow\" id=\"MathJax-Span-727\"><span class=\"mtext\" id=\"MathJax-Span-728\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">RM</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-729\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-730\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"munderover\" id=\"MathJax-Span-731\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-732\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-733\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-734\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-735\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-736\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-737\"><span class=\"mrow\" id=\"MathJax-Span-738\"><span class=\"mtext\" id=\"MathJax-Span-739\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">tool</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-740\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-741\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-742\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-743\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-744\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-745\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-746\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-747\"><span class=\"mrow\" id=\"MathJax-Span-748\"><span class=\"mtext\" id=\"MathJax-Span-749\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">obs</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-750\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-751\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-752\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-753\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-754\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-755\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">œâ</span><span class=\"msubsup\" id=\"MathJax-Span-756\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-757\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-758\"><span class=\"mrow\" id=\"MathJax-Span-759\"><span class=\"mtext\" id=\"MathJax-Span-760\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">rat</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>total</mtext></mrow></msub><mo>=</mo><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>RM</mtext></mrow></msub><mo>+</mo><mi>Œ±</mi><munder><mo>‚àë</mo><mi>t</mi></munder><mo stretchy=\"false\">(</mo><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>tool</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ≤</mi><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>obs</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>+</mo><mi>œâ</mi><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>rat</mtext></mrow></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-46\">L_{\\text{total}} = L_{\\text{RM}} + \\alpha \\sum_t (L_{\\text{tool}}(t) + \\beta L_{\\text{obs}}(t)) + \\omega L_{\\text{rat}}</script>\n\n        <ul>\n          <li>unifies pairwise ranking with autoregressive reasoning supervision. Themis improves factuality, arithmetic precision, and interpretability, showing +17.7 % accuracy gain on tool-based datasets and a 7.3 % TruthfulQA improvement over standard reward models.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Tool Learning with Foundation Models</strong>: <a href=\"https://doi.org/10.1145/3704435\">Qin et al. (2024)</a> surveyed <em>tool-augmented reasoning</em> as a general paradigm, viewing foundation models as controllers that plan subtasks, invoke APIs, and optimize through feedback loops. RL-based reasoning appears within a broader reasoning‚Äìaction‚Äìobservation‚Äìreward cycle, emphasizing transparency, adaptability, and safety.</p>\n      </li>\n      <li>\n        <p><strong>Reflexion (Verbal RL)</strong>: <a href=\"https://arxiv.org/abs/2303.11366\">Shinn et al. (2023)</a> interpreted reflection as <em>verbal reinforcement learning</em>, where self-generated critiques act as linguistic rewards guiding iterative improvement.</p>\n      </li>\n    </ul>\n  </li>\n</ul>\n<p>Reinforcement Learning (RL) frames reasoning as <strong>policy optimization over reasoning trajectories</strong>, where models learn to maximize rewards reflecting correctness, efficiency, or verifiability. Examples below:</p>\n<ul>\n      <li>\n        <p><strong>DeepSeek-R1 (Correctness-Guided Policy Optimization)</strong>: <a href=\"https://arxiv.org/abs/2501.12948\">Guo et al. (2025)</a> introduced a RL framework for reasoning that eliminates the need for human-annotated rationales. Instead, the model learns directly from correctness-based feedback signals that are objectively verifiable. The optimization objective is defined as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-37-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>J</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>,</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo>&amp;#x223C;</mo><mi>p</mi><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-630\" style=\"width: 13.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.096em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1010.99em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-631\"><span class=\"texatom\" id=\"MathJax-Span-632\"><span class=\"mrow\" id=\"MathJax-Span-633\"><span class=\"mi\" id=\"MathJax-Span-634\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∂<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-635\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-636\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-637\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-638\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-639\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.378em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-640\"><span class=\"mrow\" id=\"MathJax-Span-641\"><span class=\"mi\" id=\"MathJax-Span-642\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-643\"><span class=\"mrow\" id=\"MathJax-Span-644\"><span class=\"mi\" id=\"MathJax-Span-645\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-646\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-647\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-648\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-649\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-650\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"mi\" id=\"MathJax-Span-651\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">p</span><span class=\"mi\" id=\"MathJax-Span-652\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-653\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-654\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"texatom\" id=\"MathJax-Span-655\"><span class=\"mrow\" id=\"MathJax-Span-656\"><span class=\"mo\" id=\"MathJax-Span-657\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-658\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-659\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-660\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-661\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-662\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-663\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-664\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-665\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-666\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-667\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">J</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>,</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo>‚àº</mo><mi>p</mi><mi>Œ∏</mi><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo stretchy=\"false\">[</mo><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-37\">\\mathcal{J}(\\theta) = \\mathbb{E}_{x, z, y \\sim p \\theta(\\cdot|x)} [R(y, z)]</script>\n\n        <ul>\n          <li>\n            <p><strong>Key Components</strong>:</p>\n\n            <ul>\n              <li>\n                <p><strong>Reward Structure</strong>:</p>\n\n                <ul>\n                  <li>\n                    <p>The reward function integrates both correctness and computational efficiency:</p>\n\n                    <p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mtext>correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2212;</mo><mi>&amp;#x03BB;</mi><mtext>cost</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-668\" style=\"width: 14.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1012.09em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-669\"><span class=\"mi\" id=\"MathJax-Span-670\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-671\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-672\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-673\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-674\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-675\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-676\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-677\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-678\"><span class=\"mi\" id=\"MathJax-Span-679\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-680\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mtext\" id=\"MathJax-Span-681\" style=\"font-family: STIXGeneral-Regular;\">correct</span><span class=\"mo\" id=\"MathJax-Span-682\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-683\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-684\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-685\" style=\"font-family: STIXGeneral-Regular;\">]</span><span class=\"mo\" id=\"MathJax-Span-686\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-687\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œª</span><span class=\"mtext\" id=\"MathJax-Span-688\" style=\"font-family: STIXGeneral-Regular;\">cost</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><mtext>correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo>‚àí</mo><mi>Œª</mi><mtext>cost</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-38\">R(y, z) = \\mathbb{I}[\\text{correct}(y)] - \\lambda \\text{cost}</script>z<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-39-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; />\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-689\" style=\"width: 0em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-690\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-39\"></script></p>\n\n                    <ul>\n                      <li>where:\n                        <ul>\n                          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mtext>correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-691\" style=\"width: 5.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.951em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1004.85em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-692\"><span class=\"texatom\" id=\"MathJax-Span-693\"><span class=\"mrow\" id=\"MathJax-Span-694\"><span class=\"mi\" id=\"MathJax-Span-695\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-696\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mtext\" id=\"MathJax-Span-697\" style=\"font-family: STIXGeneral-Regular;\">correct</span><span class=\"mo\" id=\"MathJax-Span-698\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-699\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-700\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-701\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><mtext>correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-40\">\\mathbb{I}[\\text{correct}(y)]</script> indicates whether the model‚Äôs answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-702\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-703\"><span class=\"mi\" id=\"MathJax-Span-704\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">y</script> matches the ground truth, while <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>cost</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-705\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.461em, 1001.62em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-706\"><span class=\"mtext\" id=\"MathJax-Span-707\" style=\"font-family: STIXGeneral-Regular;\">cost</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>cost</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">\\text{cost}</script>z<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; />\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-708\" style=\"width: 0em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-709\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-43\"></script> measures the resource usage (e.g., number of reasoning steps or token length) of the reasoning trace <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-710\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-711\"><span class=\"mi\" id=\"MathJax-Span-712\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-44\">z</script>.</li>\n                          <li>The hyperparameter <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BB;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-713\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-714\"><span class=\"mi\" id=\"MathJax-Span-715\" style=\"font-family: STIXGeneral-Italic;\">Œª</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œª</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-45\">\\lambda</script> balances the trade-off between accuracy and efficiency.</li>\n                        </ul>\n                      </li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n              <li>\n                <p><strong>Policy Learning without Rationales</strong>:</p>\n\n                <ul>\n                  <li>Unlike earlier reasoning models that rely on <strong>process-level/step-level human supervision</strong> or <strong>rationalized trajectories</strong>, DeepSeek-R1 learns purely from outcome-level rewards.</li>\n                  <li>This shifts the training paradigm from <strong>imitating explanations</strong> to <strong>discovering effective reasoning trajectories</strong> through exploration and optimization.</li>\n                </ul>\n              </li>\n              <li>\n                <p><strong>Conciseness and Verifiability</strong>:</p>\n\n                <ul>\n                  <li>By penalizing longer or redundant reasoning paths, the model learns to favor concise solutions.</li>\n                  <li>The reward design implicitly biases the policy toward interpretable and verifiable reasoning traces, improving robustness across mathematical and symbolic reasoning tasks.</li>\n                </ul>\n              </li>\n              <li>\n                <p><strong>Empirical Findings</strong>:</p>\n\n                <ul>\n                  <li>DeepSeek-R1 demonstrates that outcome-based RL‚Äîwhen paired with reward shaping‚Äîcan achieve reasoning quality comparable to process-supervised models.</li>\n                  <li>The study highlights that reinforcement-driven optimization can uncover reasoning strategies aligned with correctness and minimal computational cost, without explicit human process supervision.</li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Process vs. Outcome Supervision</strong>: <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a> and <a href=\"https://openai.com/index/improving-mathematical-reasoning-with-process-supervision/\">OpenAI (2023)</a> demonstrated that step-level (i.e., process-level) correctness rewards improve reliability and stability compared to outcome-level rewards.</p>\n      </li>\n      <li>\n        <p><strong>Tool-Augmented RLHF</strong>: <a href=\"https://arxiv.org/abs/2112.09332\">Nakano et al. (2021)</a> extended RLHF to web-based environments.</p>\n\n        <ul>\n          <li>\n            <p>In <a href=\"https://arxiv.org/abs/2112.09332\">WebGPT</a>, Nakano et al. implemented <strong>Reinforcement Learning with Human Feedback</strong> (RLHF)** over a <strong>browser-driven interface</strong>, where the model navigated and queried the web to retrieve supporting evidence before answering. Reward models trained on human preferences compared answers and their citations, encouraging factual accuracy and verifiability through policy optimization with proximal policy optimization (PPO). This demonstrated that verifiable, tool-grounded reasoning could be operationalized within an RL framework.</p>\n          </li>\n          <li>\n            <p>Building on that foundation, <strong>Themis</strong> (<a href=\"https://arxiv.org/abs/2310.01045\">Li et al., 2024</a>) proposed <em>tool-augmented reward modeling</em>, allowing reward models themselves to call external APIs‚Äîcalculators, translators, or search engines‚Äîduring preference evaluation. The hybrid loss function</p>\n          </li>\n        </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-46-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>total</mtext></mrow></msub><mo>=</mo><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>RM</mtext></mrow></msub><mo>+</mo><mi>&amp;#x03B1;</mi><munder><mo>&amp;#x2211;</mo><mi>t</mi></munder><mo stretchy=&quot;false&quot;>(</mo><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>tool</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B2;</mi><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>obs</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03C9;</mi><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>rat</mtext></mrow></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-716\" style=\"width: 22.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 18.753em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1018.75em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-717\"><span class=\"msubsup\" id=\"MathJax-Span-718\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-719\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-720\"><span class=\"mrow\" id=\"MathJax-Span-721\"><span class=\"mtext\" id=\"MathJax-Span-722\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">total</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-723\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-724\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-725\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-726\"><span class=\"mrow\" id=\"MathJax-Span-727\"><span class=\"mtext\" id=\"MathJax-Span-728\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">RM</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-729\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-730\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"munderover\" id=\"MathJax-Span-731\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-732\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-733\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-734\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-735\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-736\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-737\"><span class=\"mrow\" id=\"MathJax-Span-738\"><span class=\"mtext\" id=\"MathJax-Span-739\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">tool</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-740\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-741\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-742\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-743\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-744\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-745\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-746\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-747\"><span class=\"mrow\" id=\"MathJax-Span-748\"><span class=\"mtext\" id=\"MathJax-Span-749\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">obs</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-750\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-751\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-752\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-753\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-754\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-755\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">œâ</span><span class=\"msubsup\" id=\"MathJax-Span-756\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-757\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-758\"><span class=\"mrow\" id=\"MathJax-Span-759\"><span class=\"mtext\" id=\"MathJax-Span-760\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">rat</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>total</mtext></mrow></msub><mo>=</mo><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>RM</mtext></mrow></msub><mo>+</mo><mi>Œ±</mi><munder><mo>‚àë</mo><mi>t</mi></munder><mo stretchy=\"false\">(</mo><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>tool</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ≤</mi><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>obs</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>+</mo><mi>œâ</mi><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>rat</mtext></mrow></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-46\">L_{\\text{total}} = L_{\\text{RM}} + \\alpha \\sum_t (L_{\\text{tool}}(t) + \\beta L_{\\text{obs}}(t)) + \\omega L_{\\text{rat}}</script>\n\n        <ul>\n          <li>unifies pairwise ranking with autoregressive reasoning supervision. Themis improves factuality, arithmetic precision, and interpretability, showing +17.7 % accuracy gain on tool-based datasets and a 7.3 % TruthfulQA improvement over standard reward models.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Tool Learning with Foundation Models</strong>: <a href=\"https://doi.org/10.1145/3704435\">Qin et al. (2024)</a> surveyed <em>tool-augmented reasoning</em> as a general paradigm, viewing foundation models as controllers that plan subtasks, invoke APIs, and optimize through feedback loops. RL-based reasoning appears within a broader reasoning‚Äìaction‚Äìobservation‚Äìreward cycle, emphasizing transparency, adaptability, and safety.</p>\n      </li>\n      <li>\n        <p><strong>Reflexion (Verbal RL)</strong>: <a href=\"https://arxiv.org/abs/2303.11366\">Shinn et al. (2023)</a> interpreted reflection as <em>verbal reinforcement learning</em>, where self-generated critiques act as linguistic rewards guiding iterative improvement.</p>\n      </li>\n    </ul>\n<p><strong>DeepSeek-R1 (Correctness-Guided Policy Optimization)</strong>: <a href=\"https://arxiv.org/abs/2501.12948\">Guo et al. (2025)</a> introduced a RL framework for reasoning that eliminates the need for human-annotated rationales. Instead, the model learns directly from correctness-based feedback signals that are objectively verifiable. The optimization objective is defined as:</p>\n<ul>\n          <li>\n            <p><strong>Key Components</strong>:</p>\n\n            <ul>\n              <li>\n                <p><strong>Reward Structure</strong>:</p>\n\n                <ul>\n                  <li>\n                    <p>The reward function integrates both correctness and computational efficiency:</p>\n\n                    <p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mtext>correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2212;</mo><mi>&amp;#x03BB;</mi><mtext>cost</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-668\" style=\"width: 14.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1012.09em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-669\"><span class=\"mi\" id=\"MathJax-Span-670\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-671\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-672\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-673\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-674\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-675\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-676\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-677\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-678\"><span class=\"mi\" id=\"MathJax-Span-679\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-680\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mtext\" id=\"MathJax-Span-681\" style=\"font-family: STIXGeneral-Regular;\">correct</span><span class=\"mo\" id=\"MathJax-Span-682\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-683\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-684\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-685\" style=\"font-family: STIXGeneral-Regular;\">]</span><span class=\"mo\" id=\"MathJax-Span-686\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-687\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œª</span><span class=\"mtext\" id=\"MathJax-Span-688\" style=\"font-family: STIXGeneral-Regular;\">cost</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><mtext>correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo>‚àí</mo><mi>Œª</mi><mtext>cost</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-38\">R(y, z) = \\mathbb{I}[\\text{correct}(y)] - \\lambda \\text{cost}</script>z<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-39-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; />\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-689\" style=\"width: 0em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-690\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-39\"></script></p>\n\n                    <ul>\n                      <li>where:\n                        <ul>\n                          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mtext>correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-691\" style=\"width: 5.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.951em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1004.85em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-692\"><span class=\"texatom\" id=\"MathJax-Span-693\"><span class=\"mrow\" id=\"MathJax-Span-694\"><span class=\"mi\" id=\"MathJax-Span-695\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-696\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mtext\" id=\"MathJax-Span-697\" style=\"font-family: STIXGeneral-Regular;\">correct</span><span class=\"mo\" id=\"MathJax-Span-698\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-699\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-700\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-701\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><mtext>correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-40\">\\mathbb{I}[\\text{correct}(y)]</script> indicates whether the model‚Äôs answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-702\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-703\"><span class=\"mi\" id=\"MathJax-Span-704\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">y</script> matches the ground truth, while <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>cost</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-705\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.461em, 1001.62em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-706\"><span class=\"mtext\" id=\"MathJax-Span-707\" style=\"font-family: STIXGeneral-Regular;\">cost</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>cost</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">\\text{cost}</script>z<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; />\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-708\" style=\"width: 0em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-709\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-43\"></script> measures the resource usage (e.g., number of reasoning steps or token length) of the reasoning trace <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-710\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-711\"><span class=\"mi\" id=\"MathJax-Span-712\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-44\">z</script>.</li>\n                          <li>The hyperparameter <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BB;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-713\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-714\"><span class=\"mi\" id=\"MathJax-Span-715\" style=\"font-family: STIXGeneral-Italic;\">Œª</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œª</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-45\">\\lambda</script> balances the trade-off between accuracy and efficiency.</li>\n                        </ul>\n                      </li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n              <li>\n                <p><strong>Policy Learning without Rationales</strong>:</p>\n\n                <ul>\n                  <li>Unlike earlier reasoning models that rely on <strong>process-level/step-level human supervision</strong> or <strong>rationalized trajectories</strong>, DeepSeek-R1 learns purely from outcome-level rewards.</li>\n                  <li>This shifts the training paradigm from <strong>imitating explanations</strong> to <strong>discovering effective reasoning trajectories</strong> through exploration and optimization.</li>\n                </ul>\n              </li>\n              <li>\n                <p><strong>Conciseness and Verifiability</strong>:</p>\n\n                <ul>\n                  <li>By penalizing longer or redundant reasoning paths, the model learns to favor concise solutions.</li>\n                  <li>The reward design implicitly biases the policy toward interpretable and verifiable reasoning traces, improving robustness across mathematical and symbolic reasoning tasks.</li>\n                </ul>\n              </li>\n              <li>\n                <p><strong>Empirical Findings</strong>:</p>\n\n                <ul>\n                  <li>DeepSeek-R1 demonstrates that outcome-based RL‚Äîwhen paired with reward shaping‚Äîcan achieve reasoning quality comparable to process-supervised models.</li>\n                  <li>The study highlights that reinforcement-driven optimization can uncover reasoning strategies aligned with correctness and minimal computational cost, without explicit human process supervision.</li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ul>\n<p><strong>Key Components</strong>:</p>\n<ul>\n              <li>\n                <p><strong>Reward Structure</strong>:</p>\n\n                <ul>\n                  <li>\n                    <p>The reward function integrates both correctness and computational efficiency:</p>\n\n                    <p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mtext>correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2212;</mo><mi>&amp;#x03BB;</mi><mtext>cost</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-668\" style=\"width: 14.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1012.09em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-669\"><span class=\"mi\" id=\"MathJax-Span-670\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-671\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-672\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-673\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-674\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-675\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-676\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-677\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-678\"><span class=\"mi\" id=\"MathJax-Span-679\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-680\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mtext\" id=\"MathJax-Span-681\" style=\"font-family: STIXGeneral-Regular;\">correct</span><span class=\"mo\" id=\"MathJax-Span-682\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-683\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-684\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-685\" style=\"font-family: STIXGeneral-Regular;\">]</span><span class=\"mo\" id=\"MathJax-Span-686\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-687\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œª</span><span class=\"mtext\" id=\"MathJax-Span-688\" style=\"font-family: STIXGeneral-Regular;\">cost</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><mtext>correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo>‚àí</mo><mi>Œª</mi><mtext>cost</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-38\">R(y, z) = \\mathbb{I}[\\text{correct}(y)] - \\lambda \\text{cost}</script>z<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-39-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; />\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-689\" style=\"width: 0em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-690\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-39\"></script></p>\n\n                    <ul>\n                      <li>where:\n                        <ul>\n                          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mtext>correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-691\" style=\"width: 5.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.951em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1004.85em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-692\"><span class=\"texatom\" id=\"MathJax-Span-693\"><span class=\"mrow\" id=\"MathJax-Span-694\"><span class=\"mi\" id=\"MathJax-Span-695\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-696\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mtext\" id=\"MathJax-Span-697\" style=\"font-family: STIXGeneral-Regular;\">correct</span><span class=\"mo\" id=\"MathJax-Span-698\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-699\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-700\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-701\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><mtext>correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-40\">\\mathbb{I}[\\text{correct}(y)]</script> indicates whether the model‚Äôs answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-702\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-703\"><span class=\"mi\" id=\"MathJax-Span-704\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">y</script> matches the ground truth, while <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>cost</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-705\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.461em, 1001.62em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-706\"><span class=\"mtext\" id=\"MathJax-Span-707\" style=\"font-family: STIXGeneral-Regular;\">cost</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>cost</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">\\text{cost}</script>z<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; />\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-708\" style=\"width: 0em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-709\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-43\"></script> measures the resource usage (e.g., number of reasoning steps or token length) of the reasoning trace <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-710\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-711\"><span class=\"mi\" id=\"MathJax-Span-712\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-44\">z</script>.</li>\n                          <li>The hyperparameter <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BB;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-713\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-714\"><span class=\"mi\" id=\"MathJax-Span-715\" style=\"font-family: STIXGeneral-Italic;\">Œª</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œª</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-45\">\\lambda</script> balances the trade-off between accuracy and efficiency.</li>\n                        </ul>\n                      </li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n              <li>\n                <p><strong>Policy Learning without Rationales</strong>:</p>\n\n                <ul>\n                  <li>Unlike earlier reasoning models that rely on <strong>process-level/step-level human supervision</strong> or <strong>rationalized trajectories</strong>, DeepSeek-R1 learns purely from outcome-level rewards.</li>\n                  <li>This shifts the training paradigm from <strong>imitating explanations</strong> to <strong>discovering effective reasoning trajectories</strong> through exploration and optimization.</li>\n                </ul>\n              </li>\n              <li>\n                <p><strong>Conciseness and Verifiability</strong>:</p>\n\n                <ul>\n                  <li>By penalizing longer or redundant reasoning paths, the model learns to favor concise solutions.</li>\n                  <li>The reward design implicitly biases the policy toward interpretable and verifiable reasoning traces, improving robustness across mathematical and symbolic reasoning tasks.</li>\n                </ul>\n              </li>\n              <li>\n                <p><strong>Empirical Findings</strong>:</p>\n\n                <ul>\n                  <li>DeepSeek-R1 demonstrates that outcome-based RL‚Äîwhen paired with reward shaping‚Äîcan achieve reasoning quality comparable to process-supervised models.</li>\n                  <li>The study highlights that reinforcement-driven optimization can uncover reasoning strategies aligned with correctness and minimal computational cost, without explicit human process supervision.</li>\n                </ul>\n              </li>\n            </ul>\n<p><strong>Reward Structure</strong>:</p>\n<ul>\n                  <li>\n                    <p>The reward function integrates both correctness and computational efficiency:</p>\n\n                    <p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mtext>correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2212;</mo><mi>&amp;#x03BB;</mi><mtext>cost</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-668\" style=\"width: 14.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1012.09em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-669\"><span class=\"mi\" id=\"MathJax-Span-670\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-671\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-672\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-673\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-674\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-675\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-676\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-677\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-678\"><span class=\"mi\" id=\"MathJax-Span-679\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-680\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mtext\" id=\"MathJax-Span-681\" style=\"font-family: STIXGeneral-Regular;\">correct</span><span class=\"mo\" id=\"MathJax-Span-682\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-683\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-684\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-685\" style=\"font-family: STIXGeneral-Regular;\">]</span><span class=\"mo\" id=\"MathJax-Span-686\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-687\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œª</span><span class=\"mtext\" id=\"MathJax-Span-688\" style=\"font-family: STIXGeneral-Regular;\">cost</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><mtext>correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo>‚àí</mo><mi>Œª</mi><mtext>cost</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-38\">R(y, z) = \\mathbb{I}[\\text{correct}(y)] - \\lambda \\text{cost}</script>z<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-39-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; />\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-689\" style=\"width: 0em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-690\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-39\"></script></p>\n\n                    <ul>\n                      <li>where:\n                        <ul>\n                          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mtext>correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-691\" style=\"width: 5.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.951em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1004.85em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-692\"><span class=\"texatom\" id=\"MathJax-Span-693\"><span class=\"mrow\" id=\"MathJax-Span-694\"><span class=\"mi\" id=\"MathJax-Span-695\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-696\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mtext\" id=\"MathJax-Span-697\" style=\"font-family: STIXGeneral-Regular;\">correct</span><span class=\"mo\" id=\"MathJax-Span-698\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-699\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-700\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-701\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><mtext>correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-40\">\\mathbb{I}[\\text{correct}(y)]</script> indicates whether the model‚Äôs answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-702\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-703\"><span class=\"mi\" id=\"MathJax-Span-704\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">y</script> matches the ground truth, while <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>cost</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-705\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.461em, 1001.62em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-706\"><span class=\"mtext\" id=\"MathJax-Span-707\" style=\"font-family: STIXGeneral-Regular;\">cost</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>cost</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">\\text{cost}</script>z<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; />\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-708\" style=\"width: 0em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-709\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-43\"></script> measures the resource usage (e.g., number of reasoning steps or token length) of the reasoning trace <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-710\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-711\"><span class=\"mi\" id=\"MathJax-Span-712\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-44\">z</script>.</li>\n                          <li>The hyperparameter <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BB;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-713\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-714\"><span class=\"mi\" id=\"MathJax-Span-715\" style=\"font-family: STIXGeneral-Italic;\">Œª</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œª</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-45\">\\lambda</script> balances the trade-off between accuracy and efficiency.</li>\n                        </ul>\n                      </li>\n                    </ul>\n                  </li>\n                </ul>\n<p>The reward function integrates both correctness and computational efficiency:</p>\n<p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mtext>correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2212;</mo><mi>&amp;#x03BB;</mi><mtext>cost</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-668\" style=\"width: 14.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1012.09em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-669\"><span class=\"mi\" id=\"MathJax-Span-670\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-671\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-672\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-673\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-674\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-675\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-676\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-677\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-678\"><span class=\"mi\" id=\"MathJax-Span-679\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-680\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mtext\" id=\"MathJax-Span-681\" style=\"font-family: STIXGeneral-Regular;\">correct</span><span class=\"mo\" id=\"MathJax-Span-682\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-683\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-684\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-685\" style=\"font-family: STIXGeneral-Regular;\">]</span><span class=\"mo\" id=\"MathJax-Span-686\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-687\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œª</span><span class=\"mtext\" id=\"MathJax-Span-688\" style=\"font-family: STIXGeneral-Regular;\">cost</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><mtext>correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo>‚àí</mo><mi>Œª</mi><mtext>cost</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-38\">R(y, z) = \\mathbb{I}[\\text{correct}(y)] - \\lambda \\text{cost}</script>z<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-39-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; />\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-689\" style=\"width: 0em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-690\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-39\"></script></p>\n<ul>\n                      <li>where:\n                        <ul>\n                          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mtext>correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-691\" style=\"width: 5.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.951em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1004.85em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-692\"><span class=\"texatom\" id=\"MathJax-Span-693\"><span class=\"mrow\" id=\"MathJax-Span-694\"><span class=\"mi\" id=\"MathJax-Span-695\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-696\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mtext\" id=\"MathJax-Span-697\" style=\"font-family: STIXGeneral-Regular;\">correct</span><span class=\"mo\" id=\"MathJax-Span-698\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-699\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-700\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-701\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><mtext>correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-40\">\\mathbb{I}[\\text{correct}(y)]</script> indicates whether the model‚Äôs answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-702\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-703\"><span class=\"mi\" id=\"MathJax-Span-704\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">y</script> matches the ground truth, while <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>cost</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-705\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.461em, 1001.62em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-706\"><span class=\"mtext\" id=\"MathJax-Span-707\" style=\"font-family: STIXGeneral-Regular;\">cost</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>cost</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">\\text{cost}</script>z<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; />\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-708\" style=\"width: 0em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-709\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-43\"></script> measures the resource usage (e.g., number of reasoning steps or token length) of the reasoning trace <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-710\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-711\"><span class=\"mi\" id=\"MathJax-Span-712\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-44\">z</script>.</li>\n                          <li>The hyperparameter <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BB;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-713\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-714\"><span class=\"mi\" id=\"MathJax-Span-715\" style=\"font-family: STIXGeneral-Italic;\">Œª</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œª</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-45\">\\lambda</script> balances the trade-off between accuracy and efficiency.</li>\n                        </ul>\n                      </li>\n                    </ul>\n<ul>\n                          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mtext>correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-691\" style=\"width: 5.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.951em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1004.85em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-692\"><span class=\"texatom\" id=\"MathJax-Span-693\"><span class=\"mrow\" id=\"MathJax-Span-694\"><span class=\"mi\" id=\"MathJax-Span-695\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-696\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mtext\" id=\"MathJax-Span-697\" style=\"font-family: STIXGeneral-Regular;\">correct</span><span class=\"mo\" id=\"MathJax-Span-698\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-699\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-700\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-701\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><mtext>correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-40\">\\mathbb{I}[\\text{correct}(y)]</script> indicates whether the model‚Äôs answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-702\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-703\"><span class=\"mi\" id=\"MathJax-Span-704\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">y</script> matches the ground truth, while <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>cost</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-705\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.461em, 1001.62em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-706\"><span class=\"mtext\" id=\"MathJax-Span-707\" style=\"font-family: STIXGeneral-Regular;\">cost</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>cost</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">\\text{cost}</script>z<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; />\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-708\" style=\"width: 0em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-709\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-43\"></script> measures the resource usage (e.g., number of reasoning steps or token length) of the reasoning trace <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-710\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-711\"><span class=\"mi\" id=\"MathJax-Span-712\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-44\">z</script>.</li>\n                          <li>The hyperparameter <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BB;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-713\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-714\"><span class=\"mi\" id=\"MathJax-Span-715\" style=\"font-family: STIXGeneral-Italic;\">Œª</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œª</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-45\">\\lambda</script> balances the trade-off between accuracy and efficiency.</li>\n                        </ul>\n<p><strong>Policy Learning without Rationales</strong>:</p>\n<ul>\n                  <li>Unlike earlier reasoning models that rely on <strong>process-level/step-level human supervision</strong> or <strong>rationalized trajectories</strong>, DeepSeek-R1 learns purely from outcome-level rewards.</li>\n                  <li>This shifts the training paradigm from <strong>imitating explanations</strong> to <strong>discovering effective reasoning trajectories</strong> through exploration and optimization.</li>\n                </ul>\n<p><strong>Conciseness and Verifiability</strong>:</p>\n<ul>\n                  <li>By penalizing longer or redundant reasoning paths, the model learns to favor concise solutions.</li>\n                  <li>The reward design implicitly biases the policy toward interpretable and verifiable reasoning traces, improving robustness across mathematical and symbolic reasoning tasks.</li>\n                </ul>\n<p><strong>Empirical Findings</strong>:</p>\n<ul>\n                  <li>DeepSeek-R1 demonstrates that outcome-based RL‚Äîwhen paired with reward shaping‚Äîcan achieve reasoning quality comparable to process-supervised models.</li>\n                  <li>The study highlights that reinforcement-driven optimization can uncover reasoning strategies aligned with correctness and minimal computational cost, without explicit human process supervision.</li>\n                </ul>\n<p><strong>Process vs. Outcome Supervision</strong>: <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a> and <a href=\"https://openai.com/index/improving-mathematical-reasoning-with-process-supervision/\">OpenAI (2023)</a> demonstrated that step-level (i.e., process-level) correctness rewards improve reliability and stability compared to outcome-level rewards.</p>\n<p><strong>Tool-Augmented RLHF</strong>: <a href=\"https://arxiv.org/abs/2112.09332\">Nakano et al. (2021)</a> extended RLHF to web-based environments.</p>\n<ul>\n          <li>\n            <p>In <a href=\"https://arxiv.org/abs/2112.09332\">WebGPT</a>, Nakano et al. implemented <strong>Reinforcement Learning with Human Feedback</strong> (RLHF)** over a <strong>browser-driven interface</strong>, where the model navigated and queried the web to retrieve supporting evidence before answering. Reward models trained on human preferences compared answers and their citations, encouraging factual accuracy and verifiability through policy optimization with proximal policy optimization (PPO). This demonstrated that verifiable, tool-grounded reasoning could be operationalized within an RL framework.</p>\n          </li>\n          <li>\n            <p>Building on that foundation, <strong>Themis</strong> (<a href=\"https://arxiv.org/abs/2310.01045\">Li et al., 2024</a>) proposed <em>tool-augmented reward modeling</em>, allowing reward models themselves to call external APIs‚Äîcalculators, translators, or search engines‚Äîduring preference evaluation. The hybrid loss function</p>\n          </li>\n        </ul>\n<p>In <a href=\"https://arxiv.org/abs/2112.09332\">WebGPT</a>, Nakano et al. implemented <strong>Reinforcement Learning with Human Feedback</strong> (RLHF)** over a <strong>browser-driven interface</strong>, where the model navigated and queried the web to retrieve supporting evidence before answering. Reward models trained on human preferences compared answers and their citations, encouraging factual accuracy and verifiability through policy optimization with proximal policy optimization (PPO). This demonstrated that verifiable, tool-grounded reasoning could be operationalized within an RL framework.</p>\n<p>Building on that foundation, <strong>Themis</strong> (<a href=\"https://arxiv.org/abs/2310.01045\">Li et al., 2024</a>) proposed <em>tool-augmented reward modeling</em>, allowing reward models themselves to call external APIs‚Äîcalculators, translators, or search engines‚Äîduring preference evaluation. The hybrid loss function</p>\n<ul>\n          <li>unifies pairwise ranking with autoregressive reasoning supervision. Themis improves factuality, arithmetic precision, and interpretability, showing +17.7 % accuracy gain on tool-based datasets and a 7.3 % TruthfulQA improvement over standard reward models.</li>\n        </ul>\n<p><strong>Tool Learning with Foundation Models</strong>: <a href=\"https://doi.org/10.1145/3704435\">Qin et al. (2024)</a> surveyed <em>tool-augmented reasoning</em> as a general paradigm, viewing foundation models as controllers that plan subtasks, invoke APIs, and optimize through feedback loops. RL-based reasoning appears within a broader reasoning‚Äìaction‚Äìobservation‚Äìreward cycle, emphasizing transparency, adaptability, and safety.</p>\n<p><strong>Reflexion (Verbal RL)</strong>: <a href=\"https://arxiv.org/abs/2303.11366\">Shinn et al. (2023)</a> interpreted reflection as <em>verbal reinforcement learning</em>, where self-generated critiques act as linguistic rewards guiding iterative improvement.</p>",
    "contentMarkdown": "*   Reinforcement Learning (RL) frames reasoning as **policy optimization over reasoning trajectories**, where models learn to maximize rewards reflecting correctness, efficiency, or verifiability. Examples below:\n    \n    *   **DeepSeek-R1 (Correctness-Guided Policy Optimization)**: [Guo et al. (2025)](https://arxiv.org/abs/2501.12948) introduced a RL framework for reasoning that eliminates the need for human-annotated rationales. Instead, the model learns directly from correctness-based feedback signals that are objectively verifiable. The optimization objective is defined as:\n        \n        Óà∂(Œ∏)\\=ùîºx,z,y‚àºpŒ∏(‚ãÖ|x)\\[R(y,z)\\]J(Œ∏)\\=Ex,z,y‚àºpŒ∏(‚ãÖ|x)\\[R(y,z)\\]\n        \n        \\\\mathcal{J}(\\\\theta) = \\\\mathbb{E}\\_{x, z, y \\\\sim p \\\\theta(\\\\cdot|x)} \\[R(y, z)\\]\n        *   **Key Components**:\n            \n            *   **Reward Structure**:\n                \n                *   The reward function integrates both correctness and computational efficiency:\n                    \n                    R(y,z)\\=ùïÄ\\[correct(y)\\]‚àíŒªcostR(y,z)\\=I\\[correct(y)\\]‚àíŒªcostR(y, z) = \\\\mathbb{I}\\[\\\\text{correct}(y)\\] - \\\\lambda \\\\text{cost}z\n                    \n                    *   where:\n                        *   ùïÄ\\[correct(y)\\]I\\[correct(y)\\]\\\\mathbb{I}\\[\\\\text{correct}(y)\\] indicates whether the model‚Äôs answer yyy matches the ground truth, while costcost\\\\text{cost}z measures the resource usage (e.g., number of reasoning steps or token length) of the reasoning trace zzz.\n                        *   The hyperparameter ŒªŒª\\\\lambda balances the trade-off between accuracy and efficiency.\n            *   **Policy Learning without Rationales**:\n                \n                *   Unlike earlier reasoning models that rely on **process-level/step-level human supervision** or **rationalized trajectories**, DeepSeek-R1 learns purely from outcome-level rewards.\n                *   This shifts the training paradigm from **imitating explanations** to **discovering effective reasoning trajectories** through exploration and optimization.\n            *   **Conciseness and Verifiability**:\n                \n                *   By penalizing longer or redundant reasoning paths, the model learns to favor concise solutions.\n                *   The reward design implicitly biases the policy toward interpretable and verifiable reasoning traces, improving robustness across mathematical and symbolic reasoning tasks.\n            *   **Empirical Findings**:\n                \n                *   DeepSeek-R1 demonstrates that outcome-based RL‚Äîwhen paired with reward shaping‚Äîcan achieve reasoning quality comparable to process-supervised models.\n                *   The study highlights that reinforcement-driven optimization can uncover reasoning strategies aligned with correctness and minimal computational cost, without explicit human process supervision.\n    *   **Process vs. Outcome Supervision**: [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050) and [OpenAI (2023)](https://openai.com/index/improving-mathematical-reasoning-with-process-supervision/) demonstrated that step-level (i.e., process-level) correctness rewards improve reliability and stability compared to outcome-level rewards.\n        \n    *   **Tool-Augmented RLHF**: [Nakano et al. (2021)](https://arxiv.org/abs/2112.09332) extended RLHF to web-based environments.\n        \n        *   In [WebGPT](https://arxiv.org/abs/2112.09332), Nakano et al. implemented **Reinforcement Learning with Human Feedback** (RLHF)\\*\\* over a **browser-driven interface**, where the model navigated and queried the web to retrieve supporting evidence before answering. Reward models trained on human preferences compared answers and their citations, encouraging factual accuracy and verifiability through policy optimization with proximal policy optimization (PPO). This demonstrated that verifiable, tool-grounded reasoning could be operationalized within an RL framework.\n            \n        *   Building on that foundation, **Themis** ([Li et al., 2024](https://arxiv.org/abs/2310.01045)) proposed _tool-augmented reward modeling_, allowing reward models themselves to call external APIs‚Äîcalculators, translators, or search engines‚Äîduring preference evaluation. The hybrid loss function\n            \n        \n        Ltotal\\=LRM+Œ±‚àët(Ltool(t)+Œ≤Lobs(t))+œâLratLtotal\\=LRM+Œ±‚àët(Ltool(t)+Œ≤Lobs(t))+œâLrat\n        \n        L\\_{\\\\text{total}} = L\\_{\\\\text{RM}} + \\\\alpha \\\\sum\\_t (L\\_{\\\\text{tool}}(t) + \\\\beta L\\_{\\\\text{obs}}(t)) + \\\\omega L\\_{\\\\text{rat}}\n        *   unifies pairwise ranking with autoregressive reasoning supervision. Themis improves factuality, arithmetic precision, and interpretability, showing +17.7 % accuracy gain on tool-based datasets and a 7.3 % TruthfulQA improvement over standard reward models.\n    *   **Tool Learning with Foundation Models**: [Qin et al. (2024)](https://doi.org/10.1145/3704435) surveyed _tool-augmented reasoning_ as a general paradigm, viewing foundation models as controllers that plan subtasks, invoke APIs, and optimize through feedback loops. RL-based reasoning appears within a broader reasoning‚Äìaction‚Äìobservation‚Äìreward cycle, emphasizing transparency, adaptability, and safety.\n        \n    *   **Reflexion (Verbal RL)**: [Shinn et al. (2023)](https://arxiv.org/abs/2303.11366) interpreted reflection as _verbal reinforcement learning_, where self-generated critiques act as linguistic rewards guiding iterative improvement.\n        \n\nReinforcement Learning (RL) frames reasoning as **policy optimization over reasoning trajectories**, where models learn to maximize rewards reflecting correctness, efficiency, or verifiability. Examples below:\n\n*   **DeepSeek-R1 (Correctness-Guided Policy Optimization)**: [Guo et al. (2025)](https://arxiv.org/abs/2501.12948) introduced a RL framework for reasoning that eliminates the need for human-annotated rationales. Instead, the model learns directly from correctness-based feedback signals that are objectively verifiable. The optimization objective is defined as:\n    \n    Óà∂(Œ∏)\\=ùîºx,z,y‚àºpŒ∏(‚ãÖ|x)\\[R(y,z)\\]J(Œ∏)\\=Ex,z,y‚àºpŒ∏(‚ãÖ|x)\\[R(y,z)\\]\n    \n    \\\\mathcal{J}(\\\\theta) = \\\\mathbb{E}\\_{x, z, y \\\\sim p \\\\theta(\\\\cdot|x)} \\[R(y, z)\\]\n    *   **Key Components**:\n        \n        *   **Reward Structure**:\n            \n            *   The reward function integrates both correctness and computational efficiency:\n                \n                R(y,z)\\=ùïÄ\\[correct(y)\\]‚àíŒªcostR(y,z)\\=I\\[correct(y)\\]‚àíŒªcostR(y, z) = \\\\mathbb{I}\\[\\\\text{correct}(y)\\] - \\\\lambda \\\\text{cost}z\n                \n                *   where:\n                    *   ùïÄ\\[correct(y)\\]I\\[correct(y)\\]\\\\mathbb{I}\\[\\\\text{correct}(y)\\] indicates whether the model‚Äôs answer yyy matches the ground truth, while costcost\\\\text{cost}z measures the resource usage (e.g., number of reasoning steps or token length) of the reasoning trace zzz.\n                    *   The hyperparameter ŒªŒª\\\\lambda balances the trade-off between accuracy and efficiency.\n        *   **Policy Learning without Rationales**:\n            \n            *   Unlike earlier reasoning models that rely on **process-level/step-level human supervision** or **rationalized trajectories**, DeepSeek-R1 learns purely from outcome-level rewards.\n            *   This shifts the training paradigm from **imitating explanations** to **discovering effective reasoning trajectories** through exploration and optimization.\n        *   **Conciseness and Verifiability**:\n            \n            *   By penalizing longer or redundant reasoning paths, the model learns to favor concise solutions.\n            *   The reward design implicitly biases the policy toward interpretable and verifiable reasoning traces, improving robustness across mathematical and symbolic reasoning tasks.\n        *   **Empirical Findings**:\n            \n            *   DeepSeek-R1 demonstrates that outcome-based RL‚Äîwhen paired with reward shaping‚Äîcan achieve reasoning quality comparable to process-supervised models.\n            *   The study highlights that reinforcement-driven optimization can uncover reasoning strategies aligned with correctness and minimal computational cost, without explicit human process supervision.\n*   **Process vs. Outcome Supervision**: [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050) and [OpenAI (2023)](https://openai.com/index/improving-mathematical-reasoning-with-process-supervision/) demonstrated that step-level (i.e., process-level) correctness rewards improve reliability and stability compared to outcome-level rewards.\n    \n*   **Tool-Augmented RLHF**: [Nakano et al. (2021)](https://arxiv.org/abs/2112.09332) extended RLHF to web-based environments.\n    \n    *   In [WebGPT](https://arxiv.org/abs/2112.09332), Nakano et al. implemented **Reinforcement Learning with Human Feedback** (RLHF)\\*\\* over a **browser-driven interface**, where the model navigated and queried the web to retrieve supporting evidence before answering. Reward models trained on human preferences compared answers and their citations, encouraging factual accuracy and verifiability through policy optimization with proximal policy optimization (PPO). This demonstrated that verifiable, tool-grounded reasoning could be operationalized within an RL framework.\n        \n    *   Building on that foundation, **Themis** ([Li et al., 2024](https://arxiv.org/abs/2310.01045)) proposed _tool-augmented reward modeling_, allowing reward models themselves to call external APIs‚Äîcalculators, translators, or search engines‚Äîduring preference evaluation. The hybrid loss function\n        \n    \n    Ltotal\\=LRM+Œ±‚àët(Ltool(t)+Œ≤Lobs(t))+œâLratLtotal\\=LRM+Œ±‚àët(Ltool(t)+Œ≤Lobs(t))+œâLrat\n    \n    L\\_{\\\\text{total}} = L\\_{\\\\text{RM}} + \\\\alpha \\\\sum\\_t (L\\_{\\\\text{tool}}(t) + \\\\beta L\\_{\\\\text{obs}}(t)) + \\\\omega L\\_{\\\\text{rat}}\n    *   unifies pairwise ranking with autoregressive reasoning supervision. Themis improves factuality, arithmetic precision, and interpretability, showing +17.7 % accuracy gain on tool-based datasets and a 7.3 % TruthfulQA improvement over standard reward models.\n*   **Tool Learning with Foundation Models**: [Qin et al. (2024)](https://doi.org/10.1145/3704435) surveyed _tool-augmented reasoning_ as a general paradigm, viewing foundation models as controllers that plan subtasks, invoke APIs, and optimize through feedback loops. RL-based reasoning appears within a broader reasoning‚Äìaction‚Äìobservation‚Äìreward cycle, emphasizing transparency, adaptability, and safety.\n    \n*   **Reflexion (Verbal RL)**: [Shinn et al. (2023)](https://arxiv.org/abs/2303.11366) interpreted reflection as _verbal reinforcement learning_, where self-generated critiques act as linguistic rewards guiding iterative improvement.\n    \n\n**DeepSeek-R1 (Correctness-Guided Policy Optimization)**: [Guo et al. (2025)](https://arxiv.org/abs/2501.12948) introduced a RL framework for reasoning that eliminates the need for human-annotated rationales. Instead, the model learns directly from correctness-based feedback signals that are objectively verifiable. The optimization objective is defined as:\n\n*   **Key Components**:\n    \n    *   **Reward Structure**:\n        \n        *   The reward function integrates both correctness and computational efficiency:\n            \n            R(y,z)\\=ùïÄ\\[correct(y)\\]‚àíŒªcostR(y,z)\\=I\\[correct(y)\\]‚àíŒªcostR(y, z) = \\\\mathbb{I}\\[\\\\text{correct}(y)\\] - \\\\lambda \\\\text{cost}z\n            \n            *   where:\n                *   ùïÄ\\[correct(y)\\]I\\[correct(y)\\]\\\\mathbb{I}\\[\\\\text{correct}(y)\\] indicates whether the model‚Äôs answer yyy matches the ground truth, while costcost\\\\text{cost}z measures the resource usage (e.g., number of reasoning steps or token length) of the reasoning trace zzz.\n                *   The hyperparameter ŒªŒª\\\\lambda balances the trade-off between accuracy and efficiency.\n    *   **Policy Learning without Rationales**:\n        \n        *   Unlike earlier reasoning models that rely on **process-level/step-level human supervision** or **rationalized trajectories**, DeepSeek-R1 learns purely from outcome-level rewards.\n        *   This shifts the training paradigm from **imitating explanations** to **discovering effective reasoning trajectories** through exploration and optimization.\n    *   **Conciseness and Verifiability**:\n        \n        *   By penalizing longer or redundant reasoning paths, the model learns to favor concise solutions.\n        *   The reward design implicitly biases the policy toward interpretable and verifiable reasoning traces, improving robustness across mathematical and symbolic reasoning tasks.\n    *   **Empirical Findings**:\n        \n        *   DeepSeek-R1 demonstrates that outcome-based RL‚Äîwhen paired with reward shaping‚Äîcan achieve reasoning quality comparable to process-supervised models.\n        *   The study highlights that reinforcement-driven optimization can uncover reasoning strategies aligned with correctness and minimal computational cost, without explicit human process supervision.\n\n**Key Components**:\n\n*   **Reward Structure**:\n    \n    *   The reward function integrates both correctness and computational efficiency:\n        \n        R(y,z)\\=ùïÄ\\[correct(y)\\]‚àíŒªcostR(y,z)\\=I\\[correct(y)\\]‚àíŒªcostR(y, z) = \\\\mathbb{I}\\[\\\\text{correct}(y)\\] - \\\\lambda \\\\text{cost}z\n        \n        *   where:\n            *   ùïÄ\\[correct(y)\\]I\\[correct(y)\\]\\\\mathbb{I}\\[\\\\text{correct}(y)\\] indicates whether the model‚Äôs answer yyy matches the ground truth, while costcost\\\\text{cost}z measures the resource usage (e.g., number of reasoning steps or token length) of the reasoning trace zzz.\n            *   The hyperparameter ŒªŒª\\\\lambda balances the trade-off between accuracy and efficiency.\n*   **Policy Learning without Rationales**:\n    \n    *   Unlike earlier reasoning models that rely on **process-level/step-level human supervision** or **rationalized trajectories**, DeepSeek-R1 learns purely from outcome-level rewards.\n    *   This shifts the training paradigm from **imitating explanations** to **discovering effective reasoning trajectories** through exploration and optimization.\n*   **Conciseness and Verifiability**:\n    \n    *   By penalizing longer or redundant reasoning paths, the model learns to favor concise solutions.\n    *   The reward design implicitly biases the policy toward interpretable and verifiable reasoning traces, improving robustness across mathematical and symbolic reasoning tasks.\n*   **Empirical Findings**:\n    \n    *   DeepSeek-R1 demonstrates that outcome-based RL‚Äîwhen paired with reward shaping‚Äîcan achieve reasoning quality comparable to process-supervised models.\n    *   The study highlights that reinforcement-driven optimization can uncover reasoning strategies aligned with correctness and minimal computational cost, without explicit human process supervision.\n\n**Reward Structure**:\n\n*   The reward function integrates both correctness and computational efficiency:\n    \n    R(y,z)\\=ùïÄ\\[correct(y)\\]‚àíŒªcostR(y,z)\\=I\\[correct(y)\\]‚àíŒªcostR(y, z) = \\\\mathbb{I}\\[\\\\text{correct}(y)\\] - \\\\lambda \\\\text{cost}z\n    \n    *   where:\n        *   ùïÄ\\[correct(y)\\]I\\[correct(y)\\]\\\\mathbb{I}\\[\\\\text{correct}(y)\\] indicates whether the model‚Äôs answer yyy matches the ground truth, while costcost\\\\text{cost}z measures the resource usage (e.g., number of reasoning steps or token length) of the reasoning trace zzz.\n        *   The hyperparameter ŒªŒª\\\\lambda balances the trade-off between accuracy and efficiency.\n\nThe reward function integrates both correctness and computational efficiency:\n\nR(y,z)\\=ùïÄ\\[correct(y)\\]‚àíŒªcostR(y,z)\\=I\\[correct(y)\\]‚àíŒªcostR(y, z) = \\\\mathbb{I}\\[\\\\text{correct}(y)\\] - \\\\lambda \\\\text{cost}z\n\n*   where:\n    *   ùïÄ\\[correct(y)\\]I\\[correct(y)\\]\\\\mathbb{I}\\[\\\\text{correct}(y)\\] indicates whether the model‚Äôs answer yyy matches the ground truth, while costcost\\\\text{cost}z measures the resource usage (e.g., number of reasoning steps or token length) of the reasoning trace zzz.\n    *   The hyperparameter ŒªŒª\\\\lambda balances the trade-off between accuracy and efficiency.\n\n*   ùïÄ\\[correct(y)\\]I\\[correct(y)\\]\\\\mathbb{I}\\[\\\\text{correct}(y)\\] indicates whether the model‚Äôs answer yyy matches the ground truth, while costcost\\\\text{cost}z measures the resource usage (e.g., number of reasoning steps or token length) of the reasoning trace zzz.\n*   The hyperparameter ŒªŒª\\\\lambda balances the trade-off between accuracy and efficiency.\n\n**Policy Learning without Rationales**:\n\n*   Unlike earlier reasoning models that rely on **process-level/step-level human supervision** or **rationalized trajectories**, DeepSeek-R1 learns purely from outcome-level rewards.\n*   This shifts the training paradigm from **imitating explanations** to **discovering effective reasoning trajectories** through exploration and optimization.\n\n**Conciseness and Verifiability**:\n\n*   By penalizing longer or redundant reasoning paths, the model learns to favor concise solutions.\n*   The reward design implicitly biases the policy toward interpretable and verifiable reasoning traces, improving robustness across mathematical and symbolic reasoning tasks.\n\n**Empirical Findings**:\n\n*   DeepSeek-R1 demonstrates that outcome-based RL‚Äîwhen paired with reward shaping‚Äîcan achieve reasoning quality comparable to process-supervised models.\n*   The study highlights that reinforcement-driven optimization can uncover reasoning strategies aligned with correctness and minimal computational cost, without explicit human process supervision.\n\n**Process vs. Outcome Supervision**: [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050) and [OpenAI (2023)](https://openai.com/index/improving-mathematical-reasoning-with-process-supervision/) demonstrated that step-level (i.e., process-level) correctness rewards improve reliability and stability compared to outcome-level rewards.\n\n**Tool-Augmented RLHF**: [Nakano et al. (2021)](https://arxiv.org/abs/2112.09332) extended RLHF to web-based environments.\n\n*   In [WebGPT](https://arxiv.org/abs/2112.09332), Nakano et al. implemented **Reinforcement Learning with Human Feedback** (RLHF)\\*\\* over a **browser-driven interface**, where the model navigated and queried the web to retrieve supporting evidence before answering. Reward models trained on human preferences compared answers and their citations, encouraging factual accuracy and verifiability through policy optimization with proximal policy optimization (PPO). This demonstrated that verifiable, tool-grounded reasoning could be operationalized within an RL framework.\n    \n*   Building on that foundation, **Themis** ([Li et al., 2024](https://arxiv.org/abs/2310.01045)) proposed _tool-augmented reward modeling_, allowing reward models themselves to call external APIs‚Äîcalculators, translators, or search engines‚Äîduring preference evaluation. The hybrid loss function\n    \n\nIn [WebGPT](https://arxiv.org/abs/2112.09332), Nakano et al. implemented **Reinforcement Learning with Human Feedback** (RLHF)\\*\\* over a **browser-driven interface**, where the model navigated and queried the web to retrieve supporting evidence before answering. Reward models trained on human preferences compared answers and their citations, encouraging factual accuracy and verifiability through policy optimization with proximal policy optimization (PPO). This demonstrated that verifiable, tool-grounded reasoning could be operationalized within an RL framework.\n\nBuilding on that foundation, **Themis** ([Li et al., 2024](https://arxiv.org/abs/2310.01045)) proposed _tool-augmented reward modeling_, allowing reward models themselves to call external APIs‚Äîcalculators, translators, or search engines‚Äîduring preference evaluation. The hybrid loss function\n\n*   unifies pairwise ranking with autoregressive reasoning supervision. Themis improves factuality, arithmetic precision, and interpretability, showing +17.7 % accuracy gain on tool-based datasets and a 7.3 % TruthfulQA improvement over standard reward models.\n\n**Tool Learning with Foundation Models**: [Qin et al. (2024)](https://doi.org/10.1145/3704435) surveyed _tool-augmented reasoning_ as a general paradigm, viewing foundation models as controllers that plan subtasks, invoke APIs, and optimize through feedback loops. RL-based reasoning appears within a broader reasoning‚Äìaction‚Äìobservation‚Äìreward cycle, emphasizing transparency, adaptability, and safety.\n\n**Reflexion (Verbal RL)**: [Shinn et al. (2023)](https://arxiv.org/abs/2303.11366) interpreted reflection as _verbal reinforcement learning_, where self-generated critiques act as linguistic rewards guiding iterative improvement.",
    "order": 10,
    "orderInChapter": 6,
    "difficulty": 3,
    "estimatedMinutes": 11,
    "tags": [
      "nlpllms",
      "gpt",
      "reinforcement learning",
      "optimization",
      "loss function"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 2102,
      "contentLength": 143106
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#reinforcement-learning-based-reasoning",
    "scrapedAt": "2025-12-28T11:54:00.654Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-chain-of-thought-cot-prompting-11",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Prompting-Based Reasoning",
    "title": "Chain-of-Thought (CoT) Prompting",
    "subtitle": "Prompting-Based Reasoning",
    "contentHtml": "<ul>\n  <li>\n    <p>The CoT methodology explicitly elicits step-by-step reasoning before producing an answer. Instead of directly predicting the output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-47-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-761\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-762\"><span class=\"mi\" id=\"MathJax-Span-763\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-47\">y</script> from input <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-48-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-764\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-765\"><span class=\"mi\" id=\"MathJax-Span-766\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-48\">x</script>, the model is guided to generate intermediate steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-49-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>z</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-767\" style=\"width: 6.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.055em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1005.05em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-768\"><span class=\"msubsup\" id=\"MathJax-Span-769\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-770\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-771\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-772\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-773\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-774\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-775\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-776\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-777\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-778\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-779\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-780\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-781\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msub><mi>z</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-49\">z_1, z_2, \\ldots, z_k</script> that form a coherent reasoning chain:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-50-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>x</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mi>z</mi><mn>2</mn></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mo>&amp;#x22EF;</mo><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mi>z</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mi>y</mi></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-782\" style=\"width: 15.159em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.607em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.773em, 1012.61em, 2.763em, -999.997em); top: -2.393em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-783\"><span class=\"mi\" id=\"MathJax-Span-784\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-785\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-786\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-787\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-788\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-789\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-790\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-791\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-792\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-793\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"mo\" id=\"MathJax-Span-794\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚ãØ</span><span class=\"mo\" id=\"MathJax-Span-795\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-796\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-797\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-798\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-799\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"mi\" id=\"MathJax-Span-800\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.398em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>x</mi><mo stretchy=\"false\">‚Üí</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy=\"false\">‚Üí</mo><msub><mi>z</mi><mn>2</mn></msub><mo stretchy=\"false\">‚Üí</mo><mo>‚ãØ</mo><mo stretchy=\"false\">‚Üí</mo><msub><mi>z</mi><mi>k</mi></msub><mo stretchy=\"false\">‚Üí</mo><mi>y</mi></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-50\">x \\rightarrow z_1 \\rightarrow z_2 \\rightarrow \\cdots \\rightarrow z_k \\rightarrow y</script>\n  </li>\n  <li>This approach was introduced in <a href=\"https://arxiv.org/abs/2201.11903\">Chain-of-Thought Prompting Elicits Reasoning in Large Language Models</a> by Wei et al. (2022). The key contribution of Wei et al. was to show that <strong>few-shot exemplars containing reasoning traces</strong> („Äàinput, reasoning, answer„Äâ) dramatically improve reasoning performance. By providing examples of multi-step reasoning in the prompt, large models could successfully decompose problems into intermediate steps.</li>\n  <li>In contrast, <a href=\"https://arxiv.org/abs/2205.11916\">Large Language Models are Zero-Shot Reasoners</a> by Kojima et al. (2022) later demonstrated that the same multi-step reasoning could be triggered <strong>even without exemplars</strong>‚Äîby simply appending the phrase ‚ÄúLet‚Äôs think step by step,‚Äù enabling zero-shot reasoning. While Wei et al. highlighted reasoning as an emergent property of scale through structured exemplars, <a href=\"https://arxiv.org/abs/2205.11916\">Kojima et al. (2022)</a> revealed that linguistic cues alone can unlock latent reasoning abilities already present in pretrained LLMs.</li>\n</ul>\n<p>The CoT methodology explicitly elicits step-by-step reasoning before producing an answer. Instead of directly predicting the output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-47-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-761\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-762\"><span class=\"mi\" id=\"MathJax-Span-763\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-47\">y</script> from input <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-48-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-764\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-765\"><span class=\"mi\" id=\"MathJax-Span-766\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-48\">x</script>, the model is guided to generate intermediate steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-49-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>z</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-767\" style=\"width: 6.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.055em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1005.05em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-768\"><span class=\"msubsup\" id=\"MathJax-Span-769\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-770\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-771\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-772\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-773\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-774\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-775\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-776\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-777\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-778\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-779\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-780\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-781\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msub><mi>z</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-49\">z_1, z_2, \\ldots, z_k</script> that form a coherent reasoning chain:</p>\n<h4 id=\"mechanism\">Mechanism</h4>\n<ul>\n  <li><strong>Prompt-level induction:</strong> The prompt includes exemplars where the reasoning is explicit (<a href=\"https://arxiv.org/abs/2201.11903\">Wei et al. (2022)</a>).</li>\n  <li><strong>Latent structure exposure:</strong> The model learns to externalize intermediate computation as natural language.</li>\n  <li>\n    <p><strong>Generalization:</strong> Even without supervision, the model generalizes to unseen reasoning tasks (as shown by <a href=\"https://arxiv.org/abs/2205.11916\">Kojima et al. (2022)</a>).</p>\n  </li>\n  <li>\n    <p>Formally, CoT modifies inference to condition on a reasoning trace <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-51-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-801\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-802\"><span class=\"mi\" id=\"MathJax-Span-803\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-51\">z</script>:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-52-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder><munder><mo>&amp;#x2211;</mo><mi>z</mi></munder><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-804\" style=\"width: 13.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1010.94em, 3.701em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-805\"><span class=\"texatom\" id=\"MathJax-Span-806\"><span class=\"mrow\" id=\"MathJax-Span-807\"><span class=\"munderover\" id=\"MathJax-Span-808\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-809\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-810\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-811\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-812\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-813\"></span><span class=\"munderover\" id=\"MathJax-Span-814\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-815\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.43em, -999.997em); top: -3.331em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-816\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-817\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-818\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.326em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-819\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-820\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-821\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-822\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-823\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-824\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-825\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-826\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-827\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-828\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-829\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 2.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder><munder><mo>‚àë</mo><mi>z</mi></munder><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-52\">\\hat{y} = \\arg\\max_y \\sum_z p_\\theta(y, z \\mid x)</script>\n\n    <ul>\n      <li>\n        <p><strong>where:</strong></p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-53-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-830\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-831\"><span class=\"mi\" id=\"MathJax-Span-832\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-53\">x</script>: the input question or problem statement presented to the model.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-54-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-833\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-834\"><span class=\"mi\" id=\"MathJax-Span-835\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-54\">y</script>: the final output or predicted answer generated by the model.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-55-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-836\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-837\"><span class=\"mi\" id=\"MathJax-Span-838\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-55\">z</script>: the intermediate reasoning trace, consisting of one or more steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-56-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>z</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-839\" style=\"width: 6.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.055em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1005.05em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-840\"><span class=\"msubsup\" id=\"MathJax-Span-841\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-842\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-843\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-844\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-845\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-846\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-847\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-848\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-849\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-850\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-851\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-852\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-853\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msub><mi>z</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-56\">z_1, z_2, \\ldots, z_k</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-57-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-854\" style=\"width: 5.263em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.378em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1004.33em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-855\"><span class=\"msubsup\" id=\"MathJax-Span-856\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-857\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-858\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-859\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-860\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-861\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-862\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-863\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-864\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-865\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-57\">p_\\theta(y, z \\mid x)</script>: the joint probability of producing a reasoning sequence <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-58-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-866\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-867\"><span class=\"mi\" id=\"MathJax-Span-868\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-58\">z</script> and final answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-59-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-869\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-870\"><span class=\"mi\" id=\"MathJax-Span-871\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-59\">y</script> given input <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-60-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-872\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-873\"><span class=\"mi\" id=\"MathJax-Span-874\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-60\">x</script>, parameterized by model weights <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-61-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-875\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-876\"><span class=\"mi\" id=\"MathJax-Span-877\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-61\">\\theta</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-62-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><munder><mo>&amp;#x2211;</mo><mi>z</mi></munder></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-878\" style=\"width: 1.513em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1001.25em, 2.659em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-879\"><span class=\"munderover\" id=\"MathJax-Span-880\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-881\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-882\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><munder><mo>‚àë</mo><mi>z</mi></munder></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-62\">\\sum_z</script>: marginalization over all possible reasoning paths, representing the model‚Äôs implicit consideration of multiple reasoning trajectories.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-63-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-883\" style=\"width: 4.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.596em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1003.6em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-884\"><span class=\"mi\" id=\"MathJax-Span-885\" style=\"font-family: STIXGeneral-Regular;\">arg</span><span class=\"mo\" id=\"MathJax-Span-886\"></span><span class=\"munderover\" id=\"MathJax-Span-887\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-888\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"mi\" id=\"MathJax-Span-889\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-63\">\\arg\\max_y</script>: selects the answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-64-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-890\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-891\"><span class=\"mi\" id=\"MathJax-Span-892\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-64\">y</script> with the highest overall likelihood after integrating over possible reasoning traces.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-65-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-893\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1000.47em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-894\"><span class=\"texatom\" id=\"MathJax-Span-895\"><span class=\"mrow\" id=\"MathJax-Span-896\"><span class=\"munderover\" id=\"MathJax-Span-897\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-898\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-899\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-65\">\\hat{y}</script>: the final selected output predicted by the model.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>When CoT prompting is used, the summation is approximated by sampling one or several <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-66-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-900\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-901\"><span class=\"mi\" id=\"MathJax-Span-902\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-66\">z</script> sequences explicitly.</li>\n</ul>\n<p><strong>Generalization:</strong> Even without supervision, the model generalizes to unseen reasoning tasks (as shown by <a href=\"https://arxiv.org/abs/2205.11916\">Kojima et al. (2022)</a>).</p>\n<p>Formally, CoT modifies inference to condition on a reasoning trace <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-51-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-801\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-802\"><span class=\"mi\" id=\"MathJax-Span-803\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-51\">z</script>:</p>\n<ul>\n      <li>\n        <p><strong>where:</strong></p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-53-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-830\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-831\"><span class=\"mi\" id=\"MathJax-Span-832\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-53\">x</script>: the input question or problem statement presented to the model.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-54-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-833\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-834\"><span class=\"mi\" id=\"MathJax-Span-835\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-54\">y</script>: the final output or predicted answer generated by the model.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-55-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-836\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-837\"><span class=\"mi\" id=\"MathJax-Span-838\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-55\">z</script>: the intermediate reasoning trace, consisting of one or more steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-56-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>z</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-839\" style=\"width: 6.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.055em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1005.05em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-840\"><span class=\"msubsup\" id=\"MathJax-Span-841\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-842\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-843\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-844\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-845\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-846\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-847\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-848\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-849\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-850\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-851\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-852\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-853\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msub><mi>z</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-56\">z_1, z_2, \\ldots, z_k</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-57-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-854\" style=\"width: 5.263em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.378em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1004.33em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-855\"><span class=\"msubsup\" id=\"MathJax-Span-856\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-857\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-858\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-859\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-860\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-861\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-862\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-863\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-864\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-865\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-57\">p_\\theta(y, z \\mid x)</script>: the joint probability of producing a reasoning sequence <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-58-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-866\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-867\"><span class=\"mi\" id=\"MathJax-Span-868\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-58\">z</script> and final answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-59-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-869\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-870\"><span class=\"mi\" id=\"MathJax-Span-871\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-59\">y</script> given input <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-60-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-872\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-873\"><span class=\"mi\" id=\"MathJax-Span-874\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-60\">x</script>, parameterized by model weights <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-61-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-875\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-876\"><span class=\"mi\" id=\"MathJax-Span-877\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-61\">\\theta</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-62-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><munder><mo>&amp;#x2211;</mo><mi>z</mi></munder></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-878\" style=\"width: 1.513em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1001.25em, 2.659em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-879\"><span class=\"munderover\" id=\"MathJax-Span-880\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-881\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-882\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><munder><mo>‚àë</mo><mi>z</mi></munder></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-62\">\\sum_z</script>: marginalization over all possible reasoning paths, representing the model‚Äôs implicit consideration of multiple reasoning trajectories.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-63-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-883\" style=\"width: 4.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.596em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1003.6em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-884\"><span class=\"mi\" id=\"MathJax-Span-885\" style=\"font-family: STIXGeneral-Regular;\">arg</span><span class=\"mo\" id=\"MathJax-Span-886\"></span><span class=\"munderover\" id=\"MathJax-Span-887\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-888\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"mi\" id=\"MathJax-Span-889\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-63\">\\arg\\max_y</script>: selects the answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-64-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-890\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-891\"><span class=\"mi\" id=\"MathJax-Span-892\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-64\">y</script> with the highest overall likelihood after integrating over possible reasoning traces.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-65-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-893\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1000.47em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-894\"><span class=\"texatom\" id=\"MathJax-Span-895\"><span class=\"mrow\" id=\"MathJax-Span-896\"><span class=\"munderover\" id=\"MathJax-Span-897\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-898\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-899\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-65\">\\hat{y}</script>: the final selected output predicted by the model.</li>\n        </ul>\n      </li>\n    </ul>\n<p><strong>where:</strong></p>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-53-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-830\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-831\"><span class=\"mi\" id=\"MathJax-Span-832\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-53\">x</script>: the input question or problem statement presented to the model.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-54-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-833\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-834\"><span class=\"mi\" id=\"MathJax-Span-835\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-54\">y</script>: the final output or predicted answer generated by the model.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-55-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-836\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-837\"><span class=\"mi\" id=\"MathJax-Span-838\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-55\">z</script>: the intermediate reasoning trace, consisting of one or more steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-56-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>z</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-839\" style=\"width: 6.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.055em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1005.05em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-840\"><span class=\"msubsup\" id=\"MathJax-Span-841\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-842\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-843\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-844\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-845\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-846\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-847\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-848\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-849\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-850\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-851\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-852\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-853\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msub><mi>z</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-56\">z_1, z_2, \\ldots, z_k</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-57-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-854\" style=\"width: 5.263em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.378em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1004.33em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-855\"><span class=\"msubsup\" id=\"MathJax-Span-856\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-857\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-858\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-859\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-860\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-861\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-862\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-863\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-864\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-865\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-57\">p_\\theta(y, z \\mid x)</script>: the joint probability of producing a reasoning sequence <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-58-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-866\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-867\"><span class=\"mi\" id=\"MathJax-Span-868\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-58\">z</script> and final answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-59-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-869\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-870\"><span class=\"mi\" id=\"MathJax-Span-871\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-59\">y</script> given input <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-60-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-872\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-873\"><span class=\"mi\" id=\"MathJax-Span-874\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-60\">x</script>, parameterized by model weights <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-61-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-875\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-876\"><span class=\"mi\" id=\"MathJax-Span-877\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-61\">\\theta</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-62-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><munder><mo>&amp;#x2211;</mo><mi>z</mi></munder></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-878\" style=\"width: 1.513em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1001.25em, 2.659em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-879\"><span class=\"munderover\" id=\"MathJax-Span-880\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-881\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-882\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><munder><mo>‚àë</mo><mi>z</mi></munder></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-62\">\\sum_z</script>: marginalization over all possible reasoning paths, representing the model‚Äôs implicit consideration of multiple reasoning trajectories.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-63-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-883\" style=\"width: 4.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.596em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1003.6em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-884\"><span class=\"mi\" id=\"MathJax-Span-885\" style=\"font-family: STIXGeneral-Regular;\">arg</span><span class=\"mo\" id=\"MathJax-Span-886\"></span><span class=\"munderover\" id=\"MathJax-Span-887\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-888\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"mi\" id=\"MathJax-Span-889\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-63\">\\arg\\max_y</script>: selects the answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-64-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-890\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-891\"><span class=\"mi\" id=\"MathJax-Span-892\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-64\">y</script> with the highest overall likelihood after integrating over possible reasoning traces.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-65-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-893\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1000.47em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-894\"><span class=\"texatom\" id=\"MathJax-Span-895\"><span class=\"mrow\" id=\"MathJax-Span-896\"><span class=\"munderover\" id=\"MathJax-Span-897\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-898\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-899\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-65\">\\hat{y}</script>: the final selected output predicted by the model.</li>\n        </ul>\n<h4 id=\"variants\">Variants</h4>\n<ul>\n  <li><strong>Zero-shot CoT:</strong> Introduced by <a href=\"https://arxiv.org/abs/2205.11916\">Kojima et al. (2022)</a>, who found that simply prompting with ‚ÄúLet‚Äôs think step by step‚Äù elicits reasoning in the absence of any few-shot exemplars, proving that LLMs are zero-shot reasoners capable of multi-step inference without examples.</li>\n  <li><strong>Few-shot CoT:</strong> Proposed by <a href=\"https://arxiv.org/abs/2201.11903\">Wei et al. (2022)</a>, which relies on a few explicit reasoning demonstrations in the prompt to teach structured decomposition of problems.</li>\n  <li><strong>Multi-CoT aggregation:</strong> Proposed in <a href=\"https://arxiv.org/abs/2203.11171\">Self-Consistency Improves Chain of Thought Reasoning in Language Models</a> by Wang et al. (2022), combines multiple reasoning traces to improve robustness and consistency. By sampling diverse reasoning paths and aggregating their outcomes‚Äîthrough majority voting, confidence weighting, or entailment-based filtering‚Äîthis approach mitigates random errors in individual chains and enhances overall answer reliability, particularly on complex or ambiguous reasoning tasks. A detailed discourse on this topic is available in the <a href=\"#decoding-and-aggregation-based-reasoning-1\">Decoding and Aggregation-Based Reasoning</a> section.</li>\n</ul>\n<h4 id=\"advantages\">Advantages</h4>\n<ul>\n  <li>Readable, auditable reasoning process.</li>\n  <li>Enables interpretability and debugging.</li>\n  <li>Boosts performance on tasks requiring intermediate computation.</li>\n</ul>\n<h4 id=\"limitations\">Limitations</h4>\n<ul>\n  <li>Prone to verbosity and ‚Äúoverthinking.‚Äù</li>\n  <li>Can expose internal biases and hallucinations in intermediate steps.</li>\n  <li>Sensitive to prompt wording and length.</li>\n</ul>",
    "contentMarkdown": "*   The CoT methodology explicitly elicits step-by-step reasoning before producing an answer. Instead of directly predicting the output yyy from input xxx, the model is guided to generate intermediate steps z1,z2,‚Ä¶,zkz1,z2,‚Ä¶,zkz\\_1, z\\_2, \\\\ldots, z\\_k that form a coherent reasoning chain:\n    \n    x‚Üíz1‚Üíz2‚Üí‚ãØ‚Üízk‚Üíyx‚Üíz1‚Üíz2‚Üí‚ãØ‚Üízk‚Üíy\n    \n    x \\\\rightarrow z\\_1 \\\\rightarrow z\\_2 \\\\rightarrow \\\\cdots \\\\rightarrow z\\_k \\\\rightarrow y\n*   This approach was introduced in [Chain-of-Thought Prompting Elicits Reasoning in Large Language Models](https://arxiv.org/abs/2201.11903) by Wei et al. (2022). The key contribution of Wei et al. was to show that **few-shot exemplars containing reasoning traces** („Äàinput, reasoning, answer„Äâ) dramatically improve reasoning performance. By providing examples of multi-step reasoning in the prompt, large models could successfully decompose problems into intermediate steps.\n*   In contrast, [Large Language Models are Zero-Shot Reasoners](https://arxiv.org/abs/2205.11916) by Kojima et al. (2022) later demonstrated that the same multi-step reasoning could be triggered **even without exemplars**‚Äîby simply appending the phrase ‚ÄúLet‚Äôs think step by step,‚Äù enabling zero-shot reasoning. While Wei et al. highlighted reasoning as an emergent property of scale through structured exemplars, [Kojima et al. (2022)](https://arxiv.org/abs/2205.11916) revealed that linguistic cues alone can unlock latent reasoning abilities already present in pretrained LLMs.\n\nThe CoT methodology explicitly elicits step-by-step reasoning before producing an answer. Instead of directly predicting the output yyy from input xxx, the model is guided to generate intermediate steps z1,z2,‚Ä¶,zkz1,z2,‚Ä¶,zkz\\_1, z\\_2, \\\\ldots, z\\_k that form a coherent reasoning chain:\n\n#### Mechanism\n\n*   **Prompt-level induction:** The prompt includes exemplars where the reasoning is explicit ([Wei et al. (2022)](https://arxiv.org/abs/2201.11903)).\n*   **Latent structure exposure:** The model learns to externalize intermediate computation as natural language.\n*   **Generalization:** Even without supervision, the model generalizes to unseen reasoning tasks (as shown by [Kojima et al. (2022)](https://arxiv.org/abs/2205.11916)).\n    \n*   Formally, CoT modifies inference to condition on a reasoning trace zzz:\n    \n    yÃÇ¬†\\=argmaxy‚àëzpŒ∏(y,z‚à£x)y^\\=arg‚Å°maxy‚àëzpŒ∏(y,z‚à£x)\n    \n    \\\\hat{y} = \\\\arg\\\\max\\_y \\\\sum\\_z p\\_\\\\theta(y, z \\\\mid x)\n    *   **where:**\n        \n        *   xxx: the input question or problem statement presented to the model.\n        *   yyy: the final output or predicted answer generated by the model.\n        *   zzz: the intermediate reasoning trace, consisting of one or more steps z1,z2,‚Ä¶,zkz1,z2,‚Ä¶,zkz\\_1, z\\_2, \\\\ldots, z\\_k.\n        *   pŒ∏(y,z‚à£x)pŒ∏(y,z‚à£x)p\\_\\\\theta(y, z \\\\mid x): the joint probability of producing a reasoning sequence zzz and final answer yyy given input xxx, parameterized by model weights Œ∏Œ∏\\\\theta.\n        *   ‚àëz‚àëz\\\\sum\\_z: marginalization over all possible reasoning paths, representing the model‚Äôs implicit consideration of multiple reasoning trajectories.\n        *   argmaxyarg‚Å°maxy\\\\arg\\\\max\\_y: selects the answer yyy with the highest overall likelihood after integrating over possible reasoning traces.\n        *   yÃÇ¬†y^\\\\hat{y}: the final selected output predicted by the model.\n*   When CoT prompting is used, the summation is approximated by sampling one or several zzz sequences explicitly.\n\n**Generalization:** Even without supervision, the model generalizes to unseen reasoning tasks (as shown by [Kojima et al. (2022)](https://arxiv.org/abs/2205.11916)).\n\nFormally, CoT modifies inference to condition on a reasoning trace zzz:\n\n*   **where:**\n    \n    *   xxx: the input question or problem statement presented to the model.\n    *   yyy: the final output or predicted answer generated by the model.\n    *   zzz: the intermediate reasoning trace, consisting of one or more steps z1,z2,‚Ä¶,zkz1,z2,‚Ä¶,zkz\\_1, z\\_2, \\\\ldots, z\\_k.\n    *   pŒ∏(y,z‚à£x)pŒ∏(y,z‚à£x)p\\_\\\\theta(y, z \\\\mid x): the joint probability of producing a reasoning sequence zzz and final answer yyy given input xxx, parameterized by model weights Œ∏Œ∏\\\\theta.\n    *   ‚àëz‚àëz\\\\sum\\_z: marginalization over all possible reasoning paths, representing the model‚Äôs implicit consideration of multiple reasoning trajectories.\n    *   argmaxyarg‚Å°maxy\\\\arg\\\\max\\_y: selects the answer yyy with the highest overall likelihood after integrating over possible reasoning traces.\n    *   yÃÇ¬†y^\\\\hat{y}: the final selected output predicted by the model.\n\n**where:**\n\n*   xxx: the input question or problem statement presented to the model.\n*   yyy: the final output or predicted answer generated by the model.\n*   zzz: the intermediate reasoning trace, consisting of one or more steps z1,z2,‚Ä¶,zkz1,z2,‚Ä¶,zkz\\_1, z\\_2, \\\\ldots, z\\_k.\n*   pŒ∏(y,z‚à£x)pŒ∏(y,z‚à£x)p\\_\\\\theta(y, z \\\\mid x): the joint probability of producing a reasoning sequence zzz and final answer yyy given input xxx, parameterized by model weights Œ∏Œ∏\\\\theta.\n*   ‚àëz‚àëz\\\\sum\\_z: marginalization over all possible reasoning paths, representing the model‚Äôs implicit consideration of multiple reasoning trajectories.\n*   argmaxyarg‚Å°maxy\\\\arg\\\\max\\_y: selects the answer yyy with the highest overall likelihood after integrating over possible reasoning traces.\n*   yÃÇ¬†y^\\\\hat{y}: the final selected output predicted by the model.\n\n#### Variants\n\n*   **Zero-shot CoT:** Introduced by [Kojima et al. (2022)](https://arxiv.org/abs/2205.11916), who found that simply prompting with ‚ÄúLet‚Äôs think step by step‚Äù elicits reasoning in the absence of any few-shot exemplars, proving that LLMs are zero-shot reasoners capable of multi-step inference without examples.\n*   **Few-shot CoT:** Proposed by [Wei et al. (2022)](https://arxiv.org/abs/2201.11903), which relies on a few explicit reasoning demonstrations in the prompt to teach structured decomposition of problems.\n*   **Multi-CoT aggregation:** Proposed in [Self-Consistency Improves Chain of Thought Reasoning in Language Models](https://arxiv.org/abs/2203.11171) by Wang et al. (2022), combines multiple reasoning traces to improve robustness and consistency. By sampling diverse reasoning paths and aggregating their outcomes‚Äîthrough majority voting, confidence weighting, or entailment-based filtering‚Äîthis approach mitigates random errors in individual chains and enhances overall answer reliability, particularly on complex or ambiguous reasoning tasks. A detailed discourse on this topic is available in the [Decoding and Aggregation-Based Reasoning](#decoding-and-aggregation-based-reasoning-1) section.\n\n#### Advantages\n\n*   Readable, auditable reasoning process.\n*   Enables interpretability and debugging.\n*   Boosts performance on tasks requiring intermediate computation.\n\n#### Limitations\n\n*   Prone to verbosity and ‚Äúoverthinking.‚Äù\n*   Can expose internal biases and hallucinations in intermediate steps.\n*   Sensitive to prompt wording and length.",
    "order": 11,
    "orderInChapter": 1,
    "difficulty": 3,
    "estimatedMinutes": 5,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 874,
      "contentLength": 104041
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#chain-of-thought-(cot)-prompting",
    "scrapedAt": "2025-12-28T11:54:00.654Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-implicit-reasoning-via-in-context-composition-12",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Prompting-Based Reasoning",
    "title": "Implicit Reasoning Via In-Context Composition",
    "subtitle": "Prompting-Based Reasoning",
    "contentHtml": "<ul>\n  <li><strong>Implicit reasoning via in-context composition</strong> refers to the ability of LLMs to <em>perform structured reasoning without being explicitly instructed to reason step-by-step</em>. Instead of producing overt ‚Äúthoughts‚Äù or intermediate rationales, the model <strong>implicitly composes reasoning patterns</strong> from the examples, instructions, and latent structure provided in the prompt.</li>\n  <li>This phenomenon underlies <em>few-shot learning</em> and <em>in-context learning</em> (ICL), first formalized in <em>Language Models are Few-Shot Learners</em> by <a href=\"https://arxiv.org/abs/2005.14165\">Brown et al. (2020)</a>.</li>\n  <li>In short, implicit reasoning through in-context composition reveals that LLMs can simulate reasoning procedures <em>internally</em>‚Äîdemonstrating that reasoning is not only something models can ‚Äúsay,‚Äù but also something they can <em>do silently</em>.</li>\n</ul>\n<h4 id=\"core-idea\">Core Idea</h4>\n<ul>\n  <li>During in-context learning, an LLM observes examples of input‚Äìoutput pairs in the prompt:</li>\n</ul>\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><div><button class=\"btn-copy\" data-clipboard-action=\"copy\" data-clipboard-target=\"#code0\"><img src=\"https://aman.ai/images/copy.png\" style=\"margin:0; border:none; padding:2px 0px; width:100%; height:18px; width:18px;\"></button></div><code id=\"code0\">Example 1: x‚ÇÅ ‚Üí y‚ÇÅ\nExample 2: x‚ÇÇ ‚Üí y‚ÇÇ\n...\nQuery: x‚Çô ‚Üí ?\n</code></pre></div></div>\n<pre class=\"highlight\"><div><button class=\"btn-copy\" data-clipboard-action=\"copy\" data-clipboard-target=\"#code0\"><img src=\"https://aman.ai/images/copy.png\" style=\"margin:0; border:none; padding:2px 0px; width:100%; height:18px; width:18px;\"></button></div><code id=\"code0\">Example 1: x‚ÇÅ ‚Üí y‚ÇÅ\nExample 2: x‚ÇÇ ‚Üí y‚ÇÇ\n...\nQuery: x‚Çô ‚Üí ?\n</code></pre>\n<ul>\n  <li>\n    <p>Although no parameter updates occur, the model <strong>constructs an internal algorithm</strong> that maps inputs to outputs based on patterns in the examples.\nThis implicit mechanism acts as a <em>temporary reasoning program</em> embedded within the attention dynamics of the transformer.</p>\n  </li>\n  <li>\n    <p>Mathematically, the model approximates:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-67-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>n</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>x</mi><mi>n</mi></msub><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>f</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-903\" style=\"width: 11.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.534em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1009.48em, 2.867em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-904\"><span class=\"msubsup\" id=\"MathJax-Span-905\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-906\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-907\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-908\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-909\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-910\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-911\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-912\"><span class=\"mrow\" id=\"MathJax-Span-913\"><span class=\"mo\" id=\"MathJax-Span-914\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-915\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-916\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-917\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-918\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-919\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-920\"><span class=\"mi\" id=\"MathJax-Span-921\" style=\"font-family: STIXNonUnicode-Italic;\">ÓàØ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-922\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-923\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-924\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-925\" style=\"font-family: STIXGeneral-Italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-926\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-927\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-928\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-929\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-930\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-931\" style=\"font-family: STIXGeneral-Regular;\">;</span><span class=\"texatom\" id=\"MathJax-Span-932\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-933\"><span class=\"mi\" id=\"MathJax-Span-934\" style=\"font-family: STIXNonUnicode-Italic;\">ÓàØ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-935\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>n</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>x</mi><mi>n</mi></msub><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">C</mi></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>f</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>;</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">C</mi></mrow><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-67\">p_\\theta(y_n | x_n, \\mathcal{C}) = f_\\theta(x_n; \\mathcal{C})</script>\n\n    <ul>\n      <li>where the context <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-68-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>C</mi></mrow><mo>=</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-936\" style=\"width: 6.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1005.73em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-937\"><span class=\"texatom\" id=\"MathJax-Span-938\"><span class=\"mrow\" id=\"MathJax-Span-939\"><span class=\"mi\" id=\"MathJax-Span-940\" style=\"font-family: STIXNonUnicode-Italic;\">ÓàØ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-941\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-942\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1002.5em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-943\"><span class=\"mrow\" id=\"MathJax-Span-944\"><span class=\"mo\" id=\"MathJax-Span-945\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-946\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-947\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-948\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-949\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-950\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-951\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-952\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-953\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.273em, -999.997em); top: -4.477em; left: 2.555em;\"><span class=\"texatom\" id=\"MathJax-Span-954\"><span class=\"mrow\" id=\"MathJax-Span-955\"><span class=\"mi\" id=\"MathJax-Span-956\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-957\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-958\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.169em, -999.997em); top: -3.695em; left: 2.555em;\"><span class=\"texatom\" id=\"MathJax-Span-959\"><span class=\"mrow\" id=\"MathJax-Span-960\"><span class=\"mi\" id=\"MathJax-Span-961\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-962\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-963\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">C</mi></mrow><mo>=</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-68\">\\mathcal{C} = {(x_i, y_i)}_{i=1}^{n-1}</script> acts as a soft prompt encoding the reasoning structure.</li>\n    </ul>\n  </li>\n</ul>\n<p>Although no parameter updates occur, the model <strong>constructs an internal algorithm</strong> that maps inputs to outputs based on patterns in the examples.\nThis implicit mechanism acts as a <em>temporary reasoning program</em> embedded within the attention dynamics of the transformer.</p>\n<p>Mathematically, the model approximates:</p>\n<ul>\n      <li>where the context <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-68-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>C</mi></mrow><mo>=</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-936\" style=\"width: 6.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1005.73em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-937\"><span class=\"texatom\" id=\"MathJax-Span-938\"><span class=\"mrow\" id=\"MathJax-Span-939\"><span class=\"mi\" id=\"MathJax-Span-940\" style=\"font-family: STIXNonUnicode-Italic;\">ÓàØ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-941\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-942\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1002.5em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-943\"><span class=\"mrow\" id=\"MathJax-Span-944\"><span class=\"mo\" id=\"MathJax-Span-945\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-946\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-947\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-948\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-949\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-950\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-951\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-952\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-953\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.273em, -999.997em); top: -4.477em; left: 2.555em;\"><span class=\"texatom\" id=\"MathJax-Span-954\"><span class=\"mrow\" id=\"MathJax-Span-955\"><span class=\"mi\" id=\"MathJax-Span-956\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-957\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-958\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.169em, -999.997em); top: -3.695em; left: 2.555em;\"><span class=\"texatom\" id=\"MathJax-Span-959\"><span class=\"mrow\" id=\"MathJax-Span-960\"><span class=\"mi\" id=\"MathJax-Span-961\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-962\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-963\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">C</mi></mrow><mo>=</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-68\">\\mathcal{C} = {(x_i, y_i)}_{i=1}^{n-1}</script> acts as a soft prompt encoding the reasoning structure.</li>\n    </ul>\n<h4 id=\"mechanism-1\">Mechanism</h4>\n<ol>\n  <li>\n    <p><strong>Pattern induction</strong>\nThe attention mechanism identifies regularities across examples in the prompt (e.g., logical rules, transformations, or operations).</p>\n  </li>\n  <li>\n    <p><strong>Implicit composition</strong>\nThe model learns to simulate an algorithm consistent with those examples without explicit symbolic representation.</p>\n  </li>\n  <li>\n    <p><strong>Generalization</strong>\nWhen applied to the query, the model executes the induced procedure on-the-fly, effectively performing reasoning within the hidden activations rather than the output text.</p>\n  </li>\n</ol>\n<p><strong>Pattern induction</strong>\nThe attention mechanism identifies regularities across examples in the prompt (e.g., logical rules, transformations, or operations).</p>\n<p><strong>Implicit composition</strong>\nThe model learns to simulate an algorithm consistent with those examples without explicit symbolic representation.</p>\n<p><strong>Generalization</strong>\nWhen applied to the query, the model executes the induced procedure on-the-fly, effectively performing reasoning within the hidden activations rather than the output text.</p>\n<h4 id=\"evidence-of-implicit-reasoning\">Evidence of Implicit Reasoning</h4>\n<ul>\n  <li>\n    <p>Several studies show that LLMs can encode algorithmic reasoning purely through in-context composition:</p>\n\n    <ul>\n      <li><em>Transformers as Meta-Learners</em> by <a href=\"https://arxiv.org/abs/2301.05217\">von Oswald et al. (2023)</a>: demonstrates that transformers approximate gradient descent in activation space, effectively learning ‚Äúhow to learn‚Äù from examples.</li>\n      <li>\n        <p><em>Rethinking In-Context Learning as Implicit Bayesian Inference</em> by <a href=\"https://arxiv.org/abs/2205.13109\">Xie et al. (2022)</a>: formalizes ICL as a Bayesian posterior update over latent hypotheses <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-69-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-964\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-965\"><span class=\"mi\" id=\"MathJax-Span-966\" style=\"font-family: STIXGeneral-Italic;\">h</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>h</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-69\">h</script>, as follows:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-70-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>h</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>n</mi></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>n</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x221D;</mo><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>h</mi><mo stretchy=&quot;false&quot;>)</mo><munder><mo>&amp;#x220F;</mo><mi>i</mi></munder><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>h</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-967\" style=\"width: 16.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.805em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1013.75em, 3.909em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-968\"><span class=\"mi\" id=\"MathJax-Span-969\" style=\"font-family: STIXGeneral-Italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-970\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-971\" style=\"font-family: STIXGeneral-Italic;\">h</span><span class=\"texatom\" id=\"MathJax-Span-972\"><span class=\"mrow\" id=\"MathJax-Span-973\"><span class=\"mo\" id=\"MathJax-Span-974\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-975\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-976\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-977\"><span class=\"mrow\" id=\"MathJax-Span-978\"><span class=\"mn\" id=\"MathJax-Span-979\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-980\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-981\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-982\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-983\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-984\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-985\"><span class=\"mrow\" id=\"MathJax-Span-986\"><span class=\"mn\" id=\"MathJax-Span-987\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-988\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-989\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-990\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-991\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àù</span><span class=\"mi\" id=\"MathJax-Span-992\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">p</span><span class=\"mo\" id=\"MathJax-Span-993\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-994\" style=\"font-family: STIXGeneral-Italic;\">h</span><span class=\"mo\" id=\"MathJax-Span-995\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"munderover\" id=\"MathJax-Span-996\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.3em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-997\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àè</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.576em;\"><span class=\"mi\" id=\"MathJax-Span-998\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-999\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">p</span><span class=\"mo\" id=\"MathJax-Span-1000\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1001\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1002\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-1003\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1004\"><span class=\"mrow\" id=\"MathJax-Span-1005\"><span class=\"mo\" id=\"MathJax-Span-1006\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1007\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1008\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-1009\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1010\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1011\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">h</span><span class=\"mo\" id=\"MathJax-Span-1012\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>p</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>x</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>n</mi></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>n</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àù</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo><munder><mo>‚àè</mo><mi>i</mi></munder><mi>p</mi><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>h</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-70\">p(h|x_{1:n}, y_{1:n}) \\propto p(h)\\prod_i p(y_i|x_i, h)</script>\n      </li>\n      <li><em>What Learning Algorithms Can Transformers Implement?</em> by <a href=\"https://arxiv.org/abs/2302.06675\">Aky√ºrek et al. (2023)</a>: shows that transformers can instantiate implicit gradient-based learners and execute reasoning-like adaptations.</li>\n    </ul>\n  </li>\n  <li>\n    <p>These findings imply that reasoning does not necessarily require explicit verbalization‚Äîit can occur within the model‚Äôs hidden computation.</p>\n  </li>\n</ul>\n<p>Several studies show that LLMs can encode algorithmic reasoning purely through in-context composition:</p>\n<ul>\n      <li><em>Transformers as Meta-Learners</em> by <a href=\"https://arxiv.org/abs/2301.05217\">von Oswald et al. (2023)</a>: demonstrates that transformers approximate gradient descent in activation space, effectively learning ‚Äúhow to learn‚Äù from examples.</li>\n      <li>\n        <p><em>Rethinking In-Context Learning as Implicit Bayesian Inference</em> by <a href=\"https://arxiv.org/abs/2205.13109\">Xie et al. (2022)</a>: formalizes ICL as a Bayesian posterior update over latent hypotheses <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-69-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-964\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-965\"><span class=\"mi\" id=\"MathJax-Span-966\" style=\"font-family: STIXGeneral-Italic;\">h</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>h</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-69\">h</script>, as follows:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-70-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>h</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>n</mi></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>n</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x221D;</mo><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>h</mi><mo stretchy=&quot;false&quot;>)</mo><munder><mo>&amp;#x220F;</mo><mi>i</mi></munder><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>h</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-967\" style=\"width: 16.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.805em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1013.75em, 3.909em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-968\"><span class=\"mi\" id=\"MathJax-Span-969\" style=\"font-family: STIXGeneral-Italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-970\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-971\" style=\"font-family: STIXGeneral-Italic;\">h</span><span class=\"texatom\" id=\"MathJax-Span-972\"><span class=\"mrow\" id=\"MathJax-Span-973\"><span class=\"mo\" id=\"MathJax-Span-974\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-975\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-976\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-977\"><span class=\"mrow\" id=\"MathJax-Span-978\"><span class=\"mn\" id=\"MathJax-Span-979\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-980\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-981\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-982\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-983\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-984\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-985\"><span class=\"mrow\" id=\"MathJax-Span-986\"><span class=\"mn\" id=\"MathJax-Span-987\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-988\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-989\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-990\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-991\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àù</span><span class=\"mi\" id=\"MathJax-Span-992\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">p</span><span class=\"mo\" id=\"MathJax-Span-993\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-994\" style=\"font-family: STIXGeneral-Italic;\">h</span><span class=\"mo\" id=\"MathJax-Span-995\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"munderover\" id=\"MathJax-Span-996\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.3em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-997\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àè</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.576em;\"><span class=\"mi\" id=\"MathJax-Span-998\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-999\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">p</span><span class=\"mo\" id=\"MathJax-Span-1000\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1001\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1002\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-1003\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1004\"><span class=\"mrow\" id=\"MathJax-Span-1005\"><span class=\"mo\" id=\"MathJax-Span-1006\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1007\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1008\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-1009\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1010\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1011\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">h</span><span class=\"mo\" id=\"MathJax-Span-1012\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>p</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>x</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>n</mi></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>n</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àù</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo><munder><mo>‚àè</mo><mi>i</mi></munder><mi>p</mi><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>h</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-70\">p(h|x_{1:n}, y_{1:n}) \\propto p(h)\\prod_i p(y_i|x_i, h)</script>\n      </li>\n      <li><em>What Learning Algorithms Can Transformers Implement?</em> by <a href=\"https://arxiv.org/abs/2302.06675\">Aky√ºrek et al. (2023)</a>: shows that transformers can instantiate implicit gradient-based learners and execute reasoning-like adaptations.</li>\n    </ul>\n<p><em>Rethinking In-Context Learning as Implicit Bayesian Inference</em> by <a href=\"https://arxiv.org/abs/2205.13109\">Xie et al. (2022)</a>: formalizes ICL as a Bayesian posterior update over latent hypotheses <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-69-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-964\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-965\"><span class=\"mi\" id=\"MathJax-Span-966\" style=\"font-family: STIXGeneral-Italic;\">h</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>h</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-69\">h</script>, as follows:</p>\n<p>These findings imply that reasoning does not necessarily require explicit verbalization‚Äîit can occur within the model‚Äôs hidden computation.</p>\n<h4 id=\"examples\">Examples</h4>\n<ul>\n  <li>In-context arithmetic reasoning (e.g., ‚Äú2 + 3 = 5, 4 + 5 = 9, 6 + 7 = ?‚Äù) where the model infers the pattern without showing intermediate steps.</li>\n  <li>Logical pattern induction (e.g., mapping ‚ÄúA<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-71-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1013\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1014\"><span class=\"mo\" id=\"MathJax-Span-1015\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-71\">\\rightarrow</script>B, B<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-72-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1016\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1017\"><span class=\"mo\" id=\"MathJax-Span-1018\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-72\">\\rightarrow</script>C, therefore A<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-73-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1019\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1020\"><span class=\"mo\" id=\"MathJax-Span-1021\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-73\">\\rightarrow</script>C‚Äù) purely from example structure.</li>\n  <li>Code pattern imitation: reproducing unseen programming functions after seeing analogous examples in the context.</li>\n</ul>\n<h4 id=\"advantages-1\">Advantages</h4>\n<ul>\n  <li><strong>Efficiency:</strong> No need for verbose intermediate reasoning.</li>\n  <li><strong>Speed:</strong> Faster inference due to single-pass computation.</li>\n  <li><strong>Adaptivity:</strong> Learns task-specific reasoning patterns dynamically from the prompt.</li>\n</ul>\n<h4 id=\"limitations-1\">Limitations</h4>\n<ul>\n  <li><strong>Opacity:</strong> Reasoning is latent and not interpretable.</li>\n  <li><strong>Fragility:</strong> Sensitive to prompt order, formatting, and example selection.</li>\n  <li><strong>Limited generalization:</strong> Implicit algorithms often fail outside the statistical range of given examples.</li>\n</ul>\n<h4 id=\"relationship-to-explicit-reasoning\">Relationship to Explicit Reasoning</h4>\n<ul>\n  <li>Implicit reasoning complements explicit reasoning (like CoT) along a spectrum:</li>\n</ul>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reasoning Representation</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Interpretability</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Example</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Explicit</strong></td>\n<td class=\"tg-tleft-valign-first\">Textual steps visible in output</td>\n<td class=\"tg-tleft-valign-first\">High</td>\n<td class=\"tg-tleft-valign-second\">‚ÄúLet‚Äôs think step by step‚Äù</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Implicit</strong></td>\n<td class=\"tg-tleft-valign-first\">Reasoning internal to activations</td>\n<td class=\"tg-tleft-valign-first\">Low</td>\n<td class=\"tg-tleft-valign-second\">Few-shot induction, analogy</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reasoning Representation</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Interpretability</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Example</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Explicit</strong></td>\n<td class=\"tg-tleft-valign-first\">Textual steps visible in output</td>\n<td class=\"tg-tleft-valign-first\">High</td>\n<td class=\"tg-tleft-valign-second\">‚ÄúLet‚Äôs think step by step‚Äù</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Implicit</strong></td>\n<td class=\"tg-tleft-valign-first\">Reasoning internal to activations</td>\n<td class=\"tg-tleft-valign-first\">Low</td>\n<td class=\"tg-tleft-valign-second\">Few-shot induction, analogy</td>\n</tr>\n</tbody>\n</table>\n<ul>\n  <li>Recent work (<em>Learning to Reason with Language Models</em> by <a href=\"https://arxiv.org/abs/2206.15443\">Zelikman et al. (2022)</a>) suggests that both can coexist: explicit reasoning can <em>teach</em> the model to develop implicit reasoning circuits that persist even when steps are hidden.</li>\n</ul>",
    "contentMarkdown": "*   **Implicit reasoning via in-context composition** refers to the ability of LLMs to _perform structured reasoning without being explicitly instructed to reason step-by-step_. Instead of producing overt ‚Äúthoughts‚Äù or intermediate rationales, the model **implicitly composes reasoning patterns** from the examples, instructions, and latent structure provided in the prompt.\n*   This phenomenon underlies _few-shot learning_ and _in-context learning_ (ICL), first formalized in _Language Models are Few-Shot Learners_ by [Brown et al. (2020)](https://arxiv.org/abs/2005.14165).\n*   In short, implicit reasoning through in-context composition reveals that LLMs can simulate reasoning procedures _internally_‚Äîdemonstrating that reasoning is not only something models can ‚Äúsay,‚Äù but also something they can _do silently_.\n\n#### Core Idea\n\n*   During in-context learning, an LLM observes examples of input‚Äìoutput pairs in the prompt:\n\n![](https://aman.ai/images/copy.png)\n\n`Example 1: x‚ÇÅ ‚Üí y‚ÇÅ Example 2: x‚ÇÇ ‚Üí y‚ÇÇ ... Query: x‚Çô ‚Üí ?`\n\n![](https://aman.ai/images/copy.png)\n\n`Example 1: x‚ÇÅ ‚Üí y‚ÇÅ Example 2: x‚ÇÇ ‚Üí y‚ÇÇ ... Query: x‚Çô ‚Üí ?`\n\n*   Although no parameter updates occur, the model **constructs an internal algorithm** that maps inputs to outputs based on patterns in the examples. This implicit mechanism acts as a _temporary reasoning program_ embedded within the attention dynamics of the transformer.\n    \n*   Mathematically, the model approximates:\n    \n    pŒ∏(yn|xn,ÓàØ)\\=fŒ∏(xn;ÓàØ)pŒ∏(yn|xn,C)\\=fŒ∏(xn;C)\n    \n    p\\_\\\\theta(y\\_n | x\\_n, \\\\mathcal{C}) = f\\_\\\\theta(x\\_n; \\\\mathcal{C})\n    *   where the context ÓàØ\\=(xi,yi)n‚àí1i\\=1C\\=(xi,yi)i\\=1n‚àí1\\\\mathcal{C} = {(x\\_i, y\\_i)}\\_{i=1}^{n-1} acts as a soft prompt encoding the reasoning structure.\n\nAlthough no parameter updates occur, the model **constructs an internal algorithm** that maps inputs to outputs based on patterns in the examples. This implicit mechanism acts as a _temporary reasoning program_ embedded within the attention dynamics of the transformer.\n\nMathematically, the model approximates:\n\n*   where the context ÓàØ\\=(xi,yi)n‚àí1i\\=1C\\=(xi,yi)i\\=1n‚àí1\\\\mathcal{C} = {(x\\_i, y\\_i)}\\_{i=1}^{n-1} acts as a soft prompt encoding the reasoning structure.\n\n#### Mechanism\n\n1.  **Pattern induction** The attention mechanism identifies regularities across examples in the prompt (e.g., logical rules, transformations, or operations).\n    \n2.  **Implicit composition** The model learns to simulate an algorithm consistent with those examples without explicit symbolic representation.\n    \n3.  **Generalization** When applied to the query, the model executes the induced procedure on-the-fly, effectively performing reasoning within the hidden activations rather than the output text.\n    \n\n**Pattern induction** The attention mechanism identifies regularities across examples in the prompt (e.g., logical rules, transformations, or operations).\n\n**Implicit composition** The model learns to simulate an algorithm consistent with those examples without explicit symbolic representation.\n\n**Generalization** When applied to the query, the model executes the induced procedure on-the-fly, effectively performing reasoning within the hidden activations rather than the output text.\n\n#### Evidence of Implicit Reasoning\n\n*   Several studies show that LLMs can encode algorithmic reasoning purely through in-context composition:\n    \n    *   _Transformers as Meta-Learners_ by [von Oswald et al. (2023)](https://arxiv.org/abs/2301.05217): demonstrates that transformers approximate gradient descent in activation space, effectively learning ‚Äúhow to learn‚Äù from examples.\n    *   _Rethinking In-Context Learning as Implicit Bayesian Inference_ by [Xie et al. (2022)](https://arxiv.org/abs/2205.13109): formalizes ICL as a Bayesian posterior update over latent hypotheses hhh, as follows:\n        \n        p(h|x1:n,y1:n)‚àùp(h)‚àèip(yi|xi,h)p(h|x1:n,y1:n)‚àùp(h)‚àèip(yi|xi,h)\n        \n        p(h|x\\_{1:n}, y\\_{1:n}) \\\\propto p(h)\\\\prod\\_i p(y\\_i|x\\_i, h)\n    *   _What Learning Algorithms Can Transformers Implement?_ by [Aky√ºrek et al. (2023)](https://arxiv.org/abs/2302.06675): shows that transformers can instantiate implicit gradient-based learners and execute reasoning-like adaptations.\n*   These findings imply that reasoning does not necessarily require explicit verbalization‚Äîit can occur within the model‚Äôs hidden computation.\n    \n\nSeveral studies show that LLMs can encode algorithmic reasoning purely through in-context composition:\n\n*   _Transformers as Meta-Learners_ by [von Oswald et al. (2023)](https://arxiv.org/abs/2301.05217): demonstrates that transformers approximate gradient descent in activation space, effectively learning ‚Äúhow to learn‚Äù from examples.\n*   _Rethinking In-Context Learning as Implicit Bayesian Inference_ by [Xie et al. (2022)](https://arxiv.org/abs/2205.13109): formalizes ICL as a Bayesian posterior update over latent hypotheses hhh, as follows:\n    \n    p(h|x1:n,y1:n)‚àùp(h)‚àèip(yi|xi,h)p(h|x1:n,y1:n)‚àùp(h)‚àèip(yi|xi,h)\n    \n    p(h|x\\_{1:n}, y\\_{1:n}) \\\\propto p(h)\\\\prod\\_i p(y\\_i|x\\_i, h)\n*   _What Learning Algorithms Can Transformers Implement?_ by [Aky√ºrek et al. (2023)](https://arxiv.org/abs/2302.06675): shows that transformers can instantiate implicit gradient-based learners and execute reasoning-like adaptations.\n\n_Rethinking In-Context Learning as Implicit Bayesian Inference_ by [Xie et al. (2022)](https://arxiv.org/abs/2205.13109): formalizes ICL as a Bayesian posterior update over latent hypotheses hhh, as follows:\n\nThese findings imply that reasoning does not necessarily require explicit verbalization‚Äîit can occur within the model‚Äôs hidden computation.\n\n#### Examples\n\n*   In-context arithmetic reasoning (e.g., ‚Äú2 + 3 = 5, 4 + 5 = 9, 6 + 7 = ?‚Äù) where the model infers the pattern without showing intermediate steps.\n*   Logical pattern induction (e.g., mapping ‚ÄúA‚Üí‚Üí\\\\rightarrowB, B‚Üí‚Üí\\\\rightarrowC, therefore A‚Üí‚Üí\\\\rightarrowC‚Äù) purely from example structure.\n*   Code pattern imitation: reproducing unseen programming functions after seeing analogous examples in the context.\n\n#### Advantages\n\n*   **Efficiency:** No need for verbose intermediate reasoning.\n*   **Speed:** Faster inference due to single-pass computation.\n*   **Adaptivity:** Learns task-specific reasoning patterns dynamically from the prompt.\n\n#### Limitations\n\n*   **Opacity:** Reasoning is latent and not interpretable.\n*   **Fragility:** Sensitive to prompt order, formatting, and example selection.\n*   **Limited generalization:** Implicit algorithms often fail outside the statistical range of given examples.\n\n#### Relationship to Explicit Reasoning\n\n*   Implicit reasoning complements explicit reasoning (like CoT) along a spectrum:\n\n**Type**\n\n**Reasoning Representation**\n\n**Interpretability**\n\n**Example**\n\n**Explicit**\n\nTextual steps visible in output\n\nHigh\n\n‚ÄúLet‚Äôs think step by step‚Äù\n\n**Implicit**\n\nReasoning internal to activations\n\nLow\n\nFew-shot induction, analogy\n\n**Type**\n\n**Reasoning Representation**\n\n**Interpretability**\n\n**Example**\n\n**Explicit**\n\nTextual steps visible in output\n\nHigh\n\n‚ÄúLet‚Äôs think step by step‚Äù\n\n**Implicit**\n\nReasoning internal to activations\n\nLow\n\nFew-shot induction, analogy\n\n*   Recent work (_Learning to Reason with Language Models_ by [Zelikman et al. (2022)](https://arxiv.org/abs/2206.15443)) suggests that both can coexist: explicit reasoning can _teach_ the model to develop implicit reasoning circuits that persist even when steps are hidden.",
    "order": 12,
    "orderInChapter": 2,
    "difficulty": 4,
    "estimatedMinutes": 5,
    "tags": [
      "nlpllms",
      "transformer",
      "attention",
      "llm",
      "gradient descent",
      "activation"
    ],
    "metadata": {
      "hasCode": true,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 895,
      "contentLength": 54533
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#implicit-reasoning-via-in-context-composition",
    "scrapedAt": "2025-12-28T11:54:00.654Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-self-consistency-decoding-13",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Decoding and Aggregation-Based Reasoning",
    "title": "Self-Consistency Decoding",
    "subtitle": "Decoding and Aggregation-Based Reasoning",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Self-Consistency Decoding</strong> builds upon CoT prompting by introducing <strong>stochastic reasoning diversity</strong>‚Äîinstead of generating a single reasoning chain, the model samples multiple independent reasoning paths and aggregates their final answers to reach a more reliable conclusion.</p>\n  </li>\n  <li>\n    <p>This method was proposed in <em>Self-Consistency Improves Chain-of-Thought Reasoning in Language Models</em> by <a href=\"https://arxiv.org/abs/2203.11171\">Wang et al. (2022)</a>.</p>\n  </li>\n</ul>\n<p><strong>Self-Consistency Decoding</strong> builds upon CoT prompting by introducing <strong>stochastic reasoning diversity</strong>‚Äîinstead of generating a single reasoning chain, the model samples multiple independent reasoning paths and aggregates their final answers to reach a more reliable conclusion.</p>\n<p>This method was proposed in <em>Self-Consistency Improves Chain-of-Thought Reasoning in Language Models</em> by <a href=\"https://arxiv.org/abs/2203.11171\">Wang et al. (2022)</a>.</p>\n<h4 id=\"core-idea-1\">Core Idea</h4>\n<ul>\n  <li>\n    <p>LLMs can produce many plausible reasoning paths <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-74-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>,</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>K</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1022\" style=\"width: 8.023em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.669em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1006.67em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1023\"><span class=\"msubsup\" id=\"MathJax-Span-1024\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1025\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1026\"><span class=\"mrow\" id=\"MathJax-Span-1027\"><span class=\"mo\" id=\"MathJax-Span-1028\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-1029\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1030\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1031\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1032\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1033\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1034\"><span class=\"mrow\" id=\"MathJax-Span-1035\"><span class=\"mo\" id=\"MathJax-Span-1036\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-1037\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span class=\"mo\" id=\"MathJax-Span-1038\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1039\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-1040\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-1041\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1042\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1043\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1044\"><span class=\"mrow\" id=\"MathJax-Span-1045\"><span class=\"mo\" id=\"MathJax-Span-1046\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1047\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1048\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo>,</mo><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>K</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-74\">z^{(1)}, z^{(2)}, \\ldots, z^{(K)}</script> for the same input <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-75-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1049\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1050\"><span class=\"mi\" id=\"MathJax-Span-1051\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-75\">x</script>. Each path ends with a potential answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-76-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1052\" style=\"width: 1.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.3em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1053\"><span class=\"msubsup\" id=\"MathJax-Span-1054\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1055\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-1056\"><span class=\"mrow\" id=\"MathJax-Span-1057\"><span class=\"mo\" id=\"MathJax-Span-1058\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1059\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1060\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-76\">y^{(k)}</script>. Rather than trusting the first decoded path (which may be incorrect due to randomness or local bias), the model aggregates across samples to find the most <strong>self-consistent</strong> answer.</p>\n  </li>\n  <li>\n    <p>Formally, this can be written as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-77-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>y</mi></mrow></munder><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi></mrow></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1061\" style=\"width: 12.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.419em, 1010.47em, 3.753em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1062\"><span class=\"texatom\" id=\"MathJax-Span-1063\"><span class=\"mrow\" id=\"MathJax-Span-1064\"><span class=\"munderover\" id=\"MathJax-Span-1065\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1066\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1067\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1068\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1069\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-1070\"></span><span class=\"munderover\" id=\"MathJax-Span-1071\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1072\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.43em, -999.997em); top: -3.331em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-1073\"><span class=\"mrow\" id=\"MathJax-Span-1074\"><span class=\"mi\" id=\"MathJax-Span-1075\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-1076\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1077\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.273em, -999.997em); top: -2.862em; left: 0.055em;\"><span class=\"texatom\" id=\"MathJax-Span-1078\"><span class=\"mrow\" id=\"MathJax-Span-1079\"><span class=\"mi\" id=\"MathJax-Span-1080\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1081\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-1082\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.52em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-1083\"><span class=\"mrow\" id=\"MathJax-Span-1084\"><span class=\"mi\" id=\"MathJax-Span-1085\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1086\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-1087\"><span class=\"mi\" id=\"MathJax-Span-1088\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-1089\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-1090\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1091\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-1092\"><span class=\"mrow\" id=\"MathJax-Span-1093\"><span class=\"mo\" id=\"MathJax-Span-1094\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1095\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1096\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1097\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1098\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span><span class=\"mo\" id=\"MathJax-Span-1099\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>y</mi></mrow></munder><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>K</mi></mrow></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-77\">\\hat{y} = \\arg\\max_{y} \\sum_{k=1}^{K} \\mathbb{I}[y^{(k)} = y]</script>\n\n    <ul>\n      <li>\n        <p><strong>where:</strong></p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-78-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1100\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1000.47em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1101\"><span class=\"texatom\" id=\"MathJax-Span-1102\"><span class=\"mrow\" id=\"MathJax-Span-1103\"><span class=\"munderover\" id=\"MathJax-Span-1104\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1105\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1106\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-78\">\\hat{y}</script>: the final predicted answer obtained by selecting the most frequently occurring outcome among sampled reasoning paths.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-79-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1107\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1108\"><span class=\"mi\" id=\"MathJax-Span-1109\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-79\">y</script>: a candidate answer being evaluated for consistency across reasoning trajectories.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-80-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1110\" style=\"width: 1.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.3em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1111\"><span class=\"msubsup\" id=\"MathJax-Span-1112\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1113\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-1114\"><span class=\"mrow\" id=\"MathJax-Span-1115\"><span class=\"mo\" id=\"MathJax-Span-1116\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1117\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1118\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-80\">y^{(k)}</script>: the final output generated from the <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-81-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>h</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1119\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.15em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1120\"><span class=\"msubsup\" id=\"MathJax-Span-1121\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1122\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1123\"><span class=\"mrow\" id=\"MathJax-Span-1124\"><span class=\"mi\" id=\"MathJax-Span-1125\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1126\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">h</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>k</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mi>h</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-81\">k^{th}</script> reasoning chain <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-82-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1127\" style=\"width: 1.513em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.25em, 2.398em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1128\"><span class=\"msubsup\" id=\"MathJax-Span-1129\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1130\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1131\"><span class=\"mrow\" id=\"MathJax-Span-1132\"><span class=\"mo\" id=\"MathJax-Span-1133\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1134\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1135\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-82\">z^{(k)}</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-83-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1136\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1137\"><span class=\"mi\" id=\"MathJax-Span-1138\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-83\">K</script>: the total number of sampled reasoning paths (i.e., the number of independent reasoning attempts by the model).</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-84-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1139\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.86em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1140\"><span class=\"texatom\" id=\"MathJax-Span-1141\"><span class=\"mrow\" id=\"MathJax-Span-1142\"><span class=\"mi\" id=\"MathJax-Span-1143\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-1144\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-1145\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1146\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-1147\"><span class=\"mrow\" id=\"MathJax-Span-1148\"><span class=\"mo\" id=\"MathJax-Span-1149\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1150\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1151\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1152\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1153\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span><span class=\"mo\" id=\"MathJax-Span-1154\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-84\">\\mathbb{I}[y^{(k)} = y]</script>: an indicator function that equals 1 if the answer from the <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-85-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>h</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1155\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.15em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1156\"><span class=\"msubsup\" id=\"MathJax-Span-1157\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1158\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1159\"><span class=\"mrow\" id=\"MathJax-Span-1160\"><span class=\"mi\" id=\"MathJax-Span-1161\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1162\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">h</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>k</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mi>h</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-85\">k^{th}</script> reasoning path matches <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-86-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1163\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1164\"><span class=\"mi\" id=\"MathJax-Span-1165\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-86\">y</script>, and 0 otherwise.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-87-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi></mrow></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1166\" style=\"width: 7.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1006.2em, 2.815em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1167\"><span class=\"munderover\" id=\"MathJax-Span-1168\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1169\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-1170\"><span class=\"mrow\" id=\"MathJax-Span-1171\"><span class=\"mi\" id=\"MathJax-Span-1172\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-1173\"><span class=\"mrow\" id=\"MathJax-Span-1174\"><span class=\"mi\" id=\"MathJax-Span-1175\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1176\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-1177\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1178\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-1179\"><span class=\"mi\" id=\"MathJax-Span-1180\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-1181\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-1182\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1183\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-1184\"><span class=\"mrow\" id=\"MathJax-Span-1185\"><span class=\"mo\" id=\"MathJax-Span-1186\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1187\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1188\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1189\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1190\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span><span class=\"mo\" id=\"MathJax-Span-1191\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>K</mi></mrow></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-87\">\\sum_{k=1}^{K} \\mathbb{I}[y^{(k)} = y]</script>: counts how many times each candidate answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-88-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1192\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1193\"><span class=\"mi\" id=\"MathJax-Span-1194\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-88\">y</script> appears across all reasoning samples.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-89-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>y</mi></mrow></munder></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1195\" style=\"width: 4.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.596em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1003.6em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1196\"><span class=\"mi\" id=\"MathJax-Span-1197\" style=\"font-family: STIXGeneral-Regular;\">arg</span><span class=\"mo\" id=\"MathJax-Span-1198\"></span><span class=\"munderover\" id=\"MathJax-Span-1199\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1200\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"texatom\" id=\"MathJax-Span-1201\"><span class=\"mrow\" id=\"MathJax-Span-1202\"><span class=\"mi\" id=\"MathJax-Span-1203\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>y</mi></mrow></munder></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-89\">\\arg\\max_{y}</script>: selects the answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-90-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1204\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1205\"><span class=\"mi\" id=\"MathJax-Span-1206\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-90\">y</script> that occurs most frequently (the <strong>mode</strong>) among the <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-91-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1207\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1208\"><span class=\"mi\" id=\"MathJax-Span-1209\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-91\">K</script> generated reasoning paths, ensuring self-consistency through aggregation.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>In practice, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-92-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1210\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1211\"><span class=\"mi\" id=\"MathJax-Span-1212\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-92\">K</script> ranges from 5 to 50 samples depending on model size and task complexity.</p>\n  </li>\n</ul>\n<p>LLMs can produce many plausible reasoning paths <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-74-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>,</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>K</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1022\" style=\"width: 8.023em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.669em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1006.67em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1023\"><span class=\"msubsup\" id=\"MathJax-Span-1024\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1025\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1026\"><span class=\"mrow\" id=\"MathJax-Span-1027\"><span class=\"mo\" id=\"MathJax-Span-1028\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-1029\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1030\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1031\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1032\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1033\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1034\"><span class=\"mrow\" id=\"MathJax-Span-1035\"><span class=\"mo\" id=\"MathJax-Span-1036\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-1037\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span class=\"mo\" id=\"MathJax-Span-1038\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1039\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-1040\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-1041\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1042\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1043\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1044\"><span class=\"mrow\" id=\"MathJax-Span-1045\"><span class=\"mo\" id=\"MathJax-Span-1046\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1047\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1048\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo>,</mo><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>K</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-74\">z^{(1)}, z^{(2)}, \\ldots, z^{(K)}</script> for the same input <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-75-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1049\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1050\"><span class=\"mi\" id=\"MathJax-Span-1051\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-75\">x</script>. Each path ends with a potential answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-76-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1052\" style=\"width: 1.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.3em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1053\"><span class=\"msubsup\" id=\"MathJax-Span-1054\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1055\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-1056\"><span class=\"mrow\" id=\"MathJax-Span-1057\"><span class=\"mo\" id=\"MathJax-Span-1058\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1059\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1060\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-76\">y^{(k)}</script>. Rather than trusting the first decoded path (which may be incorrect due to randomness or local bias), the model aggregates across samples to find the most <strong>self-consistent</strong> answer.</p>\n<p>Formally, this can be written as:</p>\n<ul>\n      <li>\n        <p><strong>where:</strong></p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-78-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1100\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1000.47em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1101\"><span class=\"texatom\" id=\"MathJax-Span-1102\"><span class=\"mrow\" id=\"MathJax-Span-1103\"><span class=\"munderover\" id=\"MathJax-Span-1104\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1105\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1106\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-78\">\\hat{y}</script>: the final predicted answer obtained by selecting the most frequently occurring outcome among sampled reasoning paths.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-79-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1107\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1108\"><span class=\"mi\" id=\"MathJax-Span-1109\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-79\">y</script>: a candidate answer being evaluated for consistency across reasoning trajectories.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-80-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1110\" style=\"width: 1.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.3em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1111\"><span class=\"msubsup\" id=\"MathJax-Span-1112\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1113\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-1114\"><span class=\"mrow\" id=\"MathJax-Span-1115\"><span class=\"mo\" id=\"MathJax-Span-1116\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1117\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1118\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-80\">y^{(k)}</script>: the final output generated from the <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-81-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>h</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1119\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.15em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1120\"><span class=\"msubsup\" id=\"MathJax-Span-1121\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1122\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1123\"><span class=\"mrow\" id=\"MathJax-Span-1124\"><span class=\"mi\" id=\"MathJax-Span-1125\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1126\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">h</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>k</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mi>h</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-81\">k^{th}</script> reasoning chain <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-82-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1127\" style=\"width: 1.513em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.25em, 2.398em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1128\"><span class=\"msubsup\" id=\"MathJax-Span-1129\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1130\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1131\"><span class=\"mrow\" id=\"MathJax-Span-1132\"><span class=\"mo\" id=\"MathJax-Span-1133\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1134\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1135\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-82\">z^{(k)}</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-83-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1136\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1137\"><span class=\"mi\" id=\"MathJax-Span-1138\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-83\">K</script>: the total number of sampled reasoning paths (i.e., the number of independent reasoning attempts by the model).</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-84-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1139\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.86em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1140\"><span class=\"texatom\" id=\"MathJax-Span-1141\"><span class=\"mrow\" id=\"MathJax-Span-1142\"><span class=\"mi\" id=\"MathJax-Span-1143\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-1144\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-1145\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1146\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-1147\"><span class=\"mrow\" id=\"MathJax-Span-1148\"><span class=\"mo\" id=\"MathJax-Span-1149\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1150\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1151\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1152\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1153\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span><span class=\"mo\" id=\"MathJax-Span-1154\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-84\">\\mathbb{I}[y^{(k)} = y]</script>: an indicator function that equals 1 if the answer from the <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-85-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>h</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1155\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.15em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1156\"><span class=\"msubsup\" id=\"MathJax-Span-1157\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1158\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1159\"><span class=\"mrow\" id=\"MathJax-Span-1160\"><span class=\"mi\" id=\"MathJax-Span-1161\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1162\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">h</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>k</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mi>h</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-85\">k^{th}</script> reasoning path matches <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-86-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1163\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1164\"><span class=\"mi\" id=\"MathJax-Span-1165\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-86\">y</script>, and 0 otherwise.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-87-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi></mrow></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1166\" style=\"width: 7.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1006.2em, 2.815em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1167\"><span class=\"munderover\" id=\"MathJax-Span-1168\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1169\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-1170\"><span class=\"mrow\" id=\"MathJax-Span-1171\"><span class=\"mi\" id=\"MathJax-Span-1172\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-1173\"><span class=\"mrow\" id=\"MathJax-Span-1174\"><span class=\"mi\" id=\"MathJax-Span-1175\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1176\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-1177\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1178\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-1179\"><span class=\"mi\" id=\"MathJax-Span-1180\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-1181\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-1182\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1183\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-1184\"><span class=\"mrow\" id=\"MathJax-Span-1185\"><span class=\"mo\" id=\"MathJax-Span-1186\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1187\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1188\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1189\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1190\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span><span class=\"mo\" id=\"MathJax-Span-1191\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>K</mi></mrow></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-87\">\\sum_{k=1}^{K} \\mathbb{I}[y^{(k)} = y]</script>: counts how many times each candidate answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-88-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1192\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1193\"><span class=\"mi\" id=\"MathJax-Span-1194\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-88\">y</script> appears across all reasoning samples.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-89-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>y</mi></mrow></munder></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1195\" style=\"width: 4.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.596em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1003.6em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1196\"><span class=\"mi\" id=\"MathJax-Span-1197\" style=\"font-family: STIXGeneral-Regular;\">arg</span><span class=\"mo\" id=\"MathJax-Span-1198\"></span><span class=\"munderover\" id=\"MathJax-Span-1199\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1200\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"texatom\" id=\"MathJax-Span-1201\"><span class=\"mrow\" id=\"MathJax-Span-1202\"><span class=\"mi\" id=\"MathJax-Span-1203\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>y</mi></mrow></munder></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-89\">\\arg\\max_{y}</script>: selects the answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-90-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1204\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1205\"><span class=\"mi\" id=\"MathJax-Span-1206\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-90\">y</script> that occurs most frequently (the <strong>mode</strong>) among the <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-91-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1207\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1208\"><span class=\"mi\" id=\"MathJax-Span-1209\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-91\">K</script> generated reasoning paths, ensuring self-consistency through aggregation.</li>\n        </ul>\n      </li>\n    </ul>\n<p><strong>where:</strong></p>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-78-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1100\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1000.47em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1101\"><span class=\"texatom\" id=\"MathJax-Span-1102\"><span class=\"mrow\" id=\"MathJax-Span-1103\"><span class=\"munderover\" id=\"MathJax-Span-1104\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1105\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1106\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-78\">\\hat{y}</script>: the final predicted answer obtained by selecting the most frequently occurring outcome among sampled reasoning paths.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-79-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1107\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1108\"><span class=\"mi\" id=\"MathJax-Span-1109\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-79\">y</script>: a candidate answer being evaluated for consistency across reasoning trajectories.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-80-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1110\" style=\"width: 1.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.3em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1111\"><span class=\"msubsup\" id=\"MathJax-Span-1112\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1113\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-1114\"><span class=\"mrow\" id=\"MathJax-Span-1115\"><span class=\"mo\" id=\"MathJax-Span-1116\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1117\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1118\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-80\">y^{(k)}</script>: the final output generated from the <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-81-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>h</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1119\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.15em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1120\"><span class=\"msubsup\" id=\"MathJax-Span-1121\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1122\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1123\"><span class=\"mrow\" id=\"MathJax-Span-1124\"><span class=\"mi\" id=\"MathJax-Span-1125\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1126\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">h</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>k</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mi>h</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-81\">k^{th}</script> reasoning chain <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-82-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1127\" style=\"width: 1.513em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.25em, 2.398em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1128\"><span class=\"msubsup\" id=\"MathJax-Span-1129\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1130\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1131\"><span class=\"mrow\" id=\"MathJax-Span-1132\"><span class=\"mo\" id=\"MathJax-Span-1133\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1134\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1135\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-82\">z^{(k)}</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-83-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1136\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1137\"><span class=\"mi\" id=\"MathJax-Span-1138\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-83\">K</script>: the total number of sampled reasoning paths (i.e., the number of independent reasoning attempts by the model).</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-84-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1139\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.86em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1140\"><span class=\"texatom\" id=\"MathJax-Span-1141\"><span class=\"mrow\" id=\"MathJax-Span-1142\"><span class=\"mi\" id=\"MathJax-Span-1143\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-1144\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-1145\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1146\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-1147\"><span class=\"mrow\" id=\"MathJax-Span-1148\"><span class=\"mo\" id=\"MathJax-Span-1149\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1150\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1151\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1152\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1153\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span><span class=\"mo\" id=\"MathJax-Span-1154\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-84\">\\mathbb{I}[y^{(k)} = y]</script>: an indicator function that equals 1 if the answer from the <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-85-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>h</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1155\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.15em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1156\"><span class=\"msubsup\" id=\"MathJax-Span-1157\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1158\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1159\"><span class=\"mrow\" id=\"MathJax-Span-1160\"><span class=\"mi\" id=\"MathJax-Span-1161\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1162\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">h</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>k</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mi>h</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-85\">k^{th}</script> reasoning path matches <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-86-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1163\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1164\"><span class=\"mi\" id=\"MathJax-Span-1165\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-86\">y</script>, and 0 otherwise.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-87-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi></mrow></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1166\" style=\"width: 7.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1006.2em, 2.815em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1167\"><span class=\"munderover\" id=\"MathJax-Span-1168\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1169\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-1170\"><span class=\"mrow\" id=\"MathJax-Span-1171\"><span class=\"mi\" id=\"MathJax-Span-1172\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-1173\"><span class=\"mrow\" id=\"MathJax-Span-1174\"><span class=\"mi\" id=\"MathJax-Span-1175\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1176\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-1177\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1178\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-1179\"><span class=\"mi\" id=\"MathJax-Span-1180\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-1181\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-1182\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1183\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-1184\"><span class=\"mrow\" id=\"MathJax-Span-1185\"><span class=\"mo\" id=\"MathJax-Span-1186\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1187\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1188\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1189\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1190\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span><span class=\"mo\" id=\"MathJax-Span-1191\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>K</mi></mrow></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>y</mi><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-87\">\\sum_{k=1}^{K} \\mathbb{I}[y^{(k)} = y]</script>: counts how many times each candidate answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-88-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1192\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1193\"><span class=\"mi\" id=\"MathJax-Span-1194\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-88\">y</script> appears across all reasoning samples.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-89-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>y</mi></mrow></munder></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1195\" style=\"width: 4.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.596em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1003.6em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1196\"><span class=\"mi\" id=\"MathJax-Span-1197\" style=\"font-family: STIXGeneral-Regular;\">arg</span><span class=\"mo\" id=\"MathJax-Span-1198\"></span><span class=\"munderover\" id=\"MathJax-Span-1199\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1200\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"texatom\" id=\"MathJax-Span-1201\"><span class=\"mrow\" id=\"MathJax-Span-1202\"><span class=\"mi\" id=\"MathJax-Span-1203\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>y</mi></mrow></munder></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-89\">\\arg\\max_{y}</script>: selects the answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-90-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1204\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1205\"><span class=\"mi\" id=\"MathJax-Span-1206\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-90\">y</script> that occurs most frequently (the <strong>mode</strong>) among the <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-91-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1207\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1208\"><span class=\"mi\" id=\"MathJax-Span-1209\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-91\">K</script> generated reasoning paths, ensuring self-consistency through aggregation.</li>\n        </ul>\n<p>In practice, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-92-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1210\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1211\"><span class=\"mi\" id=\"MathJax-Span-1212\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-92\">K</script> ranges from 5 to 50 samples depending on model size and task complexity.</p>\n<h4 id=\"mechanism-2\">Mechanism</h4>\n<ol>\n  <li>\n    <p><strong>Sampling phase:</strong>\nUse temperature sampling (e.g., <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-93-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi><mo>=</mo><mn>0.7</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1213\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.08em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1214\"><span class=\"mi\" id=\"MathJax-Span-1215\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1216\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-1217\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0.7</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>T</mi><mo>=</mo><mn>0.7</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-93\">T = 0.7</script>) to generate diverse reasoning traces <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-94-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1218\" style=\"width: 1.513em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.25em, 2.398em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1219\"><span class=\"msubsup\" id=\"MathJax-Span-1220\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1221\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1222\"><span class=\"mrow\" id=\"MathJax-Span-1223\"><span class=\"mo\" id=\"MathJax-Span-1224\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1225\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1226\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-94\">z^{(k)}</script>.</p>\n  </li>\n  <li>\n    <p><strong>Aggregation phase:</strong>\nExtract the final answers <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-95-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1227\" style=\"width: 1.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.3em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1228\"><span class=\"msubsup\" id=\"MathJax-Span-1229\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1230\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-1231\"><span class=\"mrow\" id=\"MathJax-Span-1232\"><span class=\"mo\" id=\"MathJax-Span-1233\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1234\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1235\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-95\">y^{(k)}</script> and perform majority voting or probabilistic marginalization.</p>\n  </li>\n  <li>\n    <p><strong>Selection phase:</strong>\nChoose the most frequent answer (or a weighted consensus based on log-probabilities).</p>\n  </li>\n</ol>\n<p><strong>Sampling phase:</strong>\nUse temperature sampling (e.g., <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-93-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi><mo>=</mo><mn>0.7</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1213\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.08em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1214\"><span class=\"mi\" id=\"MathJax-Span-1215\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1216\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-1217\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0.7</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>T</mi><mo>=</mo><mn>0.7</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-93\">T = 0.7</script>) to generate diverse reasoning traces <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-94-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1218\" style=\"width: 1.513em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.25em, 2.398em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1219\"><span class=\"msubsup\" id=\"MathJax-Span-1220\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1221\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1222\"><span class=\"mrow\" id=\"MathJax-Span-1223\"><span class=\"mo\" id=\"MathJax-Span-1224\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1225\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1226\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-94\">z^{(k)}</script>.</p>\n<p><strong>Aggregation phase:</strong>\nExtract the final answers <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-95-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1227\" style=\"width: 1.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.3em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1228\"><span class=\"msubsup\" id=\"MathJax-Span-1229\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1230\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-1231\"><span class=\"mrow\" id=\"MathJax-Span-1232\"><span class=\"mo\" id=\"MathJax-Span-1233\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1234\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1235\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-95\">y^{(k)}</script> and perform majority voting or probabilistic marginalization.</p>\n<p><strong>Selection phase:</strong>\nChoose the most frequent answer (or a weighted consensus based on log-probabilities).</p>\n<ul>\n  <li>This implicitly integrates over multiple latent reasoning variables <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-96-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1236\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1237\"><span class=\"mi\" id=\"MathJax-Span-1238\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-96\">z</script>, approximating the marginalization in</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-97-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mo>&amp;#x2211;</mo><mi>z</mi></munder><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1239\" style=\"width: 14.846em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1012.29em, 3.961em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1240\"><span class=\"msubsup\" id=\"MathJax-Span-1241\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1242\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1243\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1244\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1245\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"texatom\" id=\"MathJax-Span-1246\"><span class=\"mrow\" id=\"MathJax-Span-1247\"><span class=\"mo\" id=\"MathJax-Span-1248\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-1249\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1250\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1251\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-1252\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1253\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.326em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1254\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1255\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1256\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1257\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1258\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1259\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"texatom\" id=\"MathJax-Span-1260\"><span class=\"mrow\" id=\"MathJax-Span-1261\"><span class=\"mo\" id=\"MathJax-Span-1262\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-1263\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1264\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1265\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-1266\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-1267\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1268\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1269\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1270\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1271\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"texatom\" id=\"MathJax-Span-1272\"><span class=\"mrow\" id=\"MathJax-Span-1273\"><span class=\"mo\" id=\"MathJax-Span-1274\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-1275\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1276\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 2.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mo>‚àë</mo><mi>z</mi></munder><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span></div>\n<h4 id=\"intuition\">Intuition</h4>\n<ul>\n  <li>\n    <p>Different reasoning paths represent samples from the model‚Äôs internal ‚Äúbelief distribution‚Äù over possible reasoning chains.\nSelf-Consistency acts as a <strong>Bayesian marginalization</strong> step, improving robustness to local hallucinations and premature reasoning collapses.</p>\n  </li>\n  <li>\n    <p>Empirically, the method yields substantial gains on multi-step arithmetic and logic benchmarks such as GSM8K, MultiArith, and StrategyQA.</p>\n  </li>\n</ul>\n<p>Different reasoning paths represent samples from the model‚Äôs internal ‚Äúbelief distribution‚Äù over possible reasoning chains.\nSelf-Consistency acts as a <strong>Bayesian marginalization</strong> step, improving robustness to local hallucinations and premature reasoning collapses.</p>\n<p>Empirically, the method yields substantial gains on multi-step arithmetic and logic benchmarks such as GSM8K, MultiArith, and StrategyQA.</p>\n<h4 id=\"advantages-2\">Advantages</h4>\n<ul>\n  <li>Reduces the variance and brittleness of individual CoT runs.</li>\n  <li>Encourages exploration of diverse reasoning paths.</li>\n  <li>Significantly improves accuracy on reasoning tasks without changing model parameters.</li>\n</ul>\n<h4 id=\"limitations-2\">Limitations</h4>\n<ul>\n  <li>Computationally expensive (requires many samples).</li>\n  <li>Inefficient for tasks where answers are non-discrete or continuous.</li>\n  <li>Aggregation may fail if reasoning errors are systematic across samples.</li>\n</ul>",
    "contentMarkdown": "*   **Self-Consistency Decoding** builds upon CoT prompting by introducing **stochastic reasoning diversity**‚Äîinstead of generating a single reasoning chain, the model samples multiple independent reasoning paths and aggregates their final answers to reach a more reliable conclusion.\n    \n*   This method was proposed in _Self-Consistency Improves Chain-of-Thought Reasoning in Language Models_ by [Wang et al. (2022)](https://arxiv.org/abs/2203.11171).\n    \n\n**Self-Consistency Decoding** builds upon CoT prompting by introducing **stochastic reasoning diversity**‚Äîinstead of generating a single reasoning chain, the model samples multiple independent reasoning paths and aggregates their final answers to reach a more reliable conclusion.\n\nThis method was proposed in _Self-Consistency Improves Chain-of-Thought Reasoning in Language Models_ by [Wang et al. (2022)](https://arxiv.org/abs/2203.11171).\n\n#### Core Idea\n\n*   LLMs can produce many plausible reasoning paths z(1),z(2),‚Ä¶,z(K)z(1),z(2),‚Ä¶,z(K)z^{(1)}, z^{(2)}, \\\\ldots, z^{(K)} for the same input xxx. Each path ends with a potential answer y(k)y(k)y^{(k)}. Rather than trusting the first decoded path (which may be incorrect due to randomness or local bias), the model aggregates across samples to find the most **self-consistent** answer.\n    \n*   Formally, this can be written as:\n    \n    yÃÇ¬†\\=argmaxy‚àëk\\=1KùïÄ\\[y(k)\\=y\\]y^\\=arg‚Å°maxy‚àëk\\=1KI\\[y(k)\\=y\\]\n    \n    \\\\hat{y} = \\\\arg\\\\max\\_{y} \\\\sum\\_{k=1}^{K} \\\\mathbb{I}\\[y^{(k)} = y\\]\n    *   **where:**\n        \n        *   yÃÇ¬†y^\\\\hat{y}: the final predicted answer obtained by selecting the most frequently occurring outcome among sampled reasoning paths.\n        *   yyy: a candidate answer being evaluated for consistency across reasoning trajectories.\n        *   y(k)y(k)y^{(k)}: the final output generated from the kthkthk^{th} reasoning chain z(k)z(k)z^{(k)}.\n        *   KKK: the total number of sampled reasoning paths (i.e., the number of independent reasoning attempts by the model).\n        *   ùïÄ\\[y(k)\\=y\\]I\\[y(k)\\=y\\]\\\\mathbb{I}\\[y^{(k)} = y\\]: an indicator function that equals 1 if the answer from the kthkthk^{th} reasoning path matches yyy, and 0 otherwise.\n        *   ‚àëKk\\=1ùïÄ\\[y(k)\\=y\\]‚àëk\\=1KI\\[y(k)\\=y\\]\\\\sum\\_{k=1}^{K} \\\\mathbb{I}\\[y^{(k)} = y\\]: counts how many times each candidate answer yyy appears across all reasoning samples.\n        *   argmaxyarg‚Å°maxy\\\\arg\\\\max\\_{y}: selects the answer yyy that occurs most frequently (the **mode**) among the KKK generated reasoning paths, ensuring self-consistency through aggregation.\n*   In practice, KKK ranges from 5 to 50 samples depending on model size and task complexity.\n    \n\nLLMs can produce many plausible reasoning paths z(1),z(2),‚Ä¶,z(K)z(1),z(2),‚Ä¶,z(K)z^{(1)}, z^{(2)}, \\\\ldots, z^{(K)} for the same input xxx. Each path ends with a potential answer y(k)y(k)y^{(k)}. Rather than trusting the first decoded path (which may be incorrect due to randomness or local bias), the model aggregates across samples to find the most **self-consistent** answer.\n\nFormally, this can be written as:\n\n*   **where:**\n    \n    *   yÃÇ¬†y^\\\\hat{y}: the final predicted answer obtained by selecting the most frequently occurring outcome among sampled reasoning paths.\n    *   yyy: a candidate answer being evaluated for consistency across reasoning trajectories.\n    *   y(k)y(k)y^{(k)}: the final output generated from the kthkthk^{th} reasoning chain z(k)z(k)z^{(k)}.\n    *   KKK: the total number of sampled reasoning paths (i.e., the number of independent reasoning attempts by the model).\n    *   ùïÄ\\[y(k)\\=y\\]I\\[y(k)\\=y\\]\\\\mathbb{I}\\[y^{(k)} = y\\]: an indicator function that equals 1 if the answer from the kthkthk^{th} reasoning path matches yyy, and 0 otherwise.\n    *   ‚àëKk\\=1ùïÄ\\[y(k)\\=y\\]‚àëk\\=1KI\\[y(k)\\=y\\]\\\\sum\\_{k=1}^{K} \\\\mathbb{I}\\[y^{(k)} = y\\]: counts how many times each candidate answer yyy appears across all reasoning samples.\n    *   argmaxyarg‚Å°maxy\\\\arg\\\\max\\_{y}: selects the answer yyy that occurs most frequently (the **mode**) among the KKK generated reasoning paths, ensuring self-consistency through aggregation.\n\n**where:**\n\n*   yÃÇ¬†y^\\\\hat{y}: the final predicted answer obtained by selecting the most frequently occurring outcome among sampled reasoning paths.\n*   yyy: a candidate answer being evaluated for consistency across reasoning trajectories.\n*   y(k)y(k)y^{(k)}: the final output generated from the kthkthk^{th} reasoning chain z(k)z(k)z^{(k)}.\n*   KKK: the total number of sampled reasoning paths (i.e., the number of independent reasoning attempts by the model).\n*   ùïÄ\\[y(k)\\=y\\]I\\[y(k)\\=y\\]\\\\mathbb{I}\\[y^{(k)} = y\\]: an indicator function that equals 1 if the answer from the kthkthk^{th} reasoning path matches yyy, and 0 otherwise.\n*   ‚àëKk\\=1ùïÄ\\[y(k)\\=y\\]‚àëk\\=1KI\\[y(k)\\=y\\]\\\\sum\\_{k=1}^{K} \\\\mathbb{I}\\[y^{(k)} = y\\]: counts how many times each candidate answer yyy appears across all reasoning samples.\n*   argmaxyarg‚Å°maxy\\\\arg\\\\max\\_{y}: selects the answer yyy that occurs most frequently (the **mode**) among the KKK generated reasoning paths, ensuring self-consistency through aggregation.\n\nIn practice, KKK ranges from 5 to 50 samples depending on model size and task complexity.\n\n#### Mechanism\n\n1.  **Sampling phase:** Use temperature sampling (e.g., T\\=0.7T\\=0.7T = 0.7) to generate diverse reasoning traces z(k)z(k)z^{(k)}.\n    \n2.  **Aggregation phase:** Extract the final answers y(k)y(k)y^{(k)} and perform majority voting or probabilistic marginalization.\n    \n3.  **Selection phase:** Choose the most frequent answer (or a weighted consensus based on log-probabilities).\n    \n\n**Sampling phase:** Use temperature sampling (e.g., T\\=0.7T\\=0.7T = 0.7) to generate diverse reasoning traces z(k)z(k)z^{(k)}.\n\n**Aggregation phase:** Extract the final answers y(k)y(k)y^{(k)} and perform majority voting or probabilistic marginalization.\n\n**Selection phase:** Choose the most frequent answer (or a weighted consensus based on log-probabilities).\n\n*   This implicitly integrates over multiple latent reasoning variables zzz, approximating the marginalization in\n\npŒ∏(y|x)\\=‚àëzpŒ∏(y|x,z)pŒ∏(z|x)pŒ∏(y|x)\\=‚àëzpŒ∏(y|x,z)pŒ∏(z|x)\n\n#### Intuition\n\n*   Different reasoning paths represent samples from the model‚Äôs internal ‚Äúbelief distribution‚Äù over possible reasoning chains. Self-Consistency acts as a **Bayesian marginalization** step, improving robustness to local hallucinations and premature reasoning collapses.\n    \n*   Empirically, the method yields substantial gains on multi-step arithmetic and logic benchmarks such as GSM8K, MultiArith, and StrategyQA.\n    \n\nDifferent reasoning paths represent samples from the model‚Äôs internal ‚Äúbelief distribution‚Äù over possible reasoning chains. Self-Consistency acts as a **Bayesian marginalization** step, improving robustness to local hallucinations and premature reasoning collapses.\n\nEmpirically, the method yields substantial gains on multi-step arithmetic and logic benchmarks such as GSM8K, MultiArith, and StrategyQA.\n\n#### Advantages\n\n*   Reduces the variance and brittleness of individual CoT runs.\n*   Encourages exploration of diverse reasoning paths.\n*   Significantly improves accuracy on reasoning tasks without changing model parameters.\n\n#### Limitations\n\n*   Computationally expensive (requires many samples).\n*   Inefficient for tasks where answers are non-discrete or continuous.\n*   Aggregation may fail if reasoning errors are systematic across samples.",
    "order": 13,
    "orderInChapter": 1,
    "difficulty": 3,
    "estimatedMinutes": 5,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 916,
      "contentLength": 149546
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#self-consistency-decoding",
    "scrapedAt": "2025-12-28T11:54:00.654Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-reflection-and-self-verification-loops-14",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Decoding and Aggregation-Based Reasoning",
    "title": "Reflection and Self-Verification Loops",
    "subtitle": "Decoding and Aggregation-Based Reasoning",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Reflection and self-verification</strong> methods extend reasoning by allowing a model to <strong>analyze, critique, and improve its own outputs</strong>. Rather than generating a single reasoning trace and final answer, the model iteratively reviews its reasoning, identifies potential errors, and either revises the reasoning or re-generates the answer.</p>\n  </li>\n  <li>\n    <p>This meta-cognitive process‚Äîanalogous to human self-checking‚Äîis central to recent efforts to make reasoning both <strong>more reliable</strong> and <strong>more factual</strong>.</p>\n  </li>\n  <li>\n    <p>A key paper introducing this paradigm is <em>Reflexion: Language Agents with Verbal Reinforcement Learning</em> by <a href=\"https://arxiv.org/abs/2303.11366\">Shinn et al. (2023)</a>, and <em>Self-Refine: Iterative Refinement with Self-Feedback</em> by <a href=\"https://arxiv.org/abs/2303.17651\">Madaan et al. (2023)</a>.</p>\n  </li>\n</ul>\n<p><strong>Reflection and self-verification</strong> methods extend reasoning by allowing a model to <strong>analyze, critique, and improve its own outputs</strong>. Rather than generating a single reasoning trace and final answer, the model iteratively reviews its reasoning, identifies potential errors, and either revises the reasoning or re-generates the answer.</p>\n<p>This meta-cognitive process‚Äîanalogous to human self-checking‚Äîis central to recent efforts to make reasoning both <strong>more reliable</strong> and <strong>more factual</strong>.</p>\n<p>A key paper introducing this paradigm is <em>Reflexion: Language Agents with Verbal Reinforcement Learning</em> by <a href=\"https://arxiv.org/abs/2303.11366\">Shinn et al. (2023)</a>, and <em>Self-Refine: Iterative Refinement with Self-Feedback</em> by <a href=\"https://arxiv.org/abs/2303.17651\">Madaan et al. (2023)</a>.</p>\n<h4 id=\"core-idea-2\">Core Idea</h4>\n<ul>\n  <li>\n    <p>Reflection frameworks conceptualize reasoning as an <strong>iterative loop</strong> between <em>generation</em>, <em>evaluation</em>, and <em>revision</em>.\nA single pass through the LLM may produce a reasoning chain <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-98-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1277\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1278\"><span class=\"mi\" id=\"MathJax-Span-1279\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-98\">z</script> and output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-99-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1280\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1281\"><span class=\"mi\" id=\"MathJax-Span-1282\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-99\">y</script>, but the model can further <em>reflect</em> on its own reasoning by generating a self-critique <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-100-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1283\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1284\"><span class=\"mi\" id=\"MathJax-Span-1285\" style=\"font-family: STIXGeneral-Italic;\">c</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>c</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-100\">c</script> that identifies flaws or inconsistencies.</p>\n  </li>\n  <li>\n    <p>This process can be formalized as:</p>\n  </li>\n</ul>\n<p>Reflection frameworks conceptualize reasoning as an <strong>iterative loop</strong> between <em>generation</em>, <em>evaluation</em>, and <em>revision</em>.\nA single pass through the LLM may produce a reasoning chain <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-98-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1277\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1278\"><span class=\"mi\" id=\"MathJax-Span-1279\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-98\">z</script> and output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-99-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1280\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1281\"><span class=\"mi\" id=\"MathJax-Span-1282\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-99\">y</script>, but the model can further <em>reflect</em> on its own reasoning by generating a self-critique <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-100-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1283\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1284\"><span class=\"mi\" id=\"MathJax-Span-1285\" style=\"font-family: STIXGeneral-Italic;\">c</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>c</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-100\">c</script> that identifies flaws or inconsistencies.</p>\n<p>This process can be formalized as:</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-101-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>x</mi><mover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot;><mtext>reason</mtext></mpadded></mover><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot;><mtext>reflect</mtext></mpadded></mover><mi>c</mi><mover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot;><mtext>revise</mtext></mpadded></mover><mo stretchy=&quot;false&quot;>(</mo><msup><mi>z</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>y</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1286\" style=\"width: 17.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.732em, 1014.64em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1287\"><span class=\"mi\" id=\"MathJax-Span-1288\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"munderover\" id=\"MathJax-Span-1289\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.45em, 4.117em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1290\" style=\"\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: -0.049em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 1.617em;\">‚Üí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.315em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.732em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.201em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.09em, 4.169em, -999.997em); top: -4.685em; left: 0.003em;\"><span class=\"mpadded\" id=\"MathJax-Span-1291\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1001.83em, 4.169em, -999.997em); top: -4.164em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-1292\"><span class=\"mtext\" id=\"MathJax-Span-1293\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">reason</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1294\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"mi\" id=\"MathJax-Span-1295\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-1296\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1297\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-1298\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"munderover\" id=\"MathJax-Span-1299\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.4em, 4.117em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1300\" style=\"\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: -0.049em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 1.565em;\">‚Üí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.315em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.732em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.148em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1002.09em, 4.169em, -999.997em); top: -4.685em; left: 0.003em;\"><span class=\"mpadded\" id=\"MathJax-Span-1301\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.83em, 4.169em, -999.997em); top: -4.164em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-1302\"><span class=\"mtext\" id=\"MathJax-Span-1303\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">reflect</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-1304\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">c</span><span class=\"munderover\" id=\"MathJax-Span-1305\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.29em, 4.117em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1306\" style=\"\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: -0.049em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 1.461em;\">‚Üí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.419em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.94em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1001.93em, 4.169em, -999.997em); top: -4.685em; left: 0.003em;\"><span class=\"mpadded\" id=\"MathJax-Span-1307\"><span style=\"display: inline-block; position: relative; width: 2.294em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.67em, 4.169em, -999.997em); top: -4.164em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-1308\"><span class=\"mtext\" id=\"MathJax-Span-1309\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">revise</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1310\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"msup\" id=\"MathJax-Span-1311\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1312\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1313\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1314\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-1315\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1316\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-1317\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1318\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>x</mi><mover><mo>‚Üí</mo><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\".15em\"><mtext>reason</mtext></mpadded></mover><mo stretchy=\"false\">(</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mover><mo>‚Üí</mo><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\".15em\"><mtext>reflect</mtext></mpadded></mover><mi>c</mi><mover><mo>‚Üí</mo><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\".15em\"><mtext>revise</mtext></mpadded></mover><mo stretchy=\"false\">(</mo><msup><mi>z</mi><mo>‚Ä≤</mo></msup><mo>,</mo><msup><mi>y</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></math></span></span></div>\n<ul>\n  <li>Each iteration ideally brings the reasoning trace closer to correctness or coherence.</li>\n</ul>\n<h4 id=\"mechanism-3\">Mechanism</h4>\n<ol>\n  <li>\n    <p><strong>Initial reasoning phase:</strong> The model generates a reasoning chain and provisional answer.</p>\n  </li>\n  <li>\n    <p><strong>Reflection phase:</strong> The model (or a secondary evaluator) reviews the reasoning for logical, factual, or procedural errors. Example prompt: <em>‚ÄúExamine the above reasoning carefully. Identify mistakes or unsupported steps, and propose corrections.‚Äù</em></p>\n  </li>\n  <li>\n    <p><strong>Revision phase:</strong> The model generates a new reasoning chain incorporating the critique. Optionally, feedback can be looped over multiple rounds.</p>\n  </li>\n  <li>\n    <p><strong>Termination:</strong> The loop ends when a confidence threshold or reflection limit is reached.</p>\n  </li>\n</ol>\n<p><strong>Initial reasoning phase:</strong> The model generates a reasoning chain and provisional answer.</p>\n<p><strong>Reflection phase:</strong> The model (or a secondary evaluator) reviews the reasoning for logical, factual, or procedural errors. Example prompt: <em>‚ÄúExamine the above reasoning carefully. Identify mistakes or unsupported steps, and propose corrections.‚Äù</em></p>\n<p><strong>Revision phase:</strong> The model generates a new reasoning chain incorporating the critique. Optionally, feedback can be looped over multiple rounds.</p>\n<p><strong>Termination:</strong> The loop ends when a confidence threshold or reflection limit is reached.</p>\n<h4 id=\"theoretical-framing\">Theoretical Framing</h4>\n<ul>\n  <li>\n    <p>Reflection can be viewed as <strong>approximate gradient descent in the space of reasoning traces</strong>, where the model updates its ‚Äúbeliefs‚Äù about a solution through internal self-assessment.</p>\n  </li>\n  <li>\n    <p>Given an initial reasoning trace <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-102-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1319\" style=\"width: 1.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.3em, 2.398em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1320\"><span class=\"msubsup\" id=\"MathJax-Span-1321\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1322\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1323\"><span class=\"mrow\" id=\"MathJax-Span-1324\"><span class=\"mo\" id=\"MathJax-Span-1325\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-1326\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-1327\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-102\">z^{(0)}</script>, the update rule can be seen as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-103-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mtext>Refine</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>,</mo><mtext>Critique</mtext><mo stretchy=&quot;false&quot;>(</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1328\" style=\"width: 16.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.544em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1013.39em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1329\"><span class=\"msubsup\" id=\"MathJax-Span-1330\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1331\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1332\"><span class=\"mrow\" id=\"MathJax-Span-1333\"><span class=\"mo\" id=\"MathJax-Span-1334\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1335\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1336\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-1337\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1338\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1339\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mtext\" id=\"MathJax-Span-1340\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">Refine</span><span class=\"texatom\" id=\"MathJax-Span-1341\"><span class=\"mrow\" id=\"MathJax-Span-1342\"><span class=\"mo\" id=\"MathJax-Span-1343\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1344\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1345\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1346\"><span class=\"mrow\" id=\"MathJax-Span-1347\"><span class=\"mo\" id=\"MathJax-Span-1348\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1349\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1350\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1351\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-1352\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">Critique</span><span class=\"mo\" id=\"MathJax-Span-1353\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1354\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1355\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1356\"><span class=\"mrow\" id=\"MathJax-Span-1357\"><span class=\"mo\" id=\"MathJax-Span-1358\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1359\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1360\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1361\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-1362\"><span class=\"mrow\" id=\"MathJax-Span-1363\"><span class=\"mo\" id=\"MathJax-Span-1364\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mtext>Refine</mtext><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>,</mo><mtext>Critique</mtext><mo stretchy=\"false\">(</mo><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-103\">z^{(t+1)} = \\text{Refine}\\big(z^{(t)}, \\text{Critique}(z^{(t)})\\big)</script>\n\n    <ul>\n      <li>where <strong>Critique</strong> is an operator producing feedback and <strong>Refine</strong> modifies the reasoning accordingly.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This closely parallels iterative inference in classical optimization and meta-learning frameworks.</p>\n  </li>\n</ul>\n<p>Reflection can be viewed as <strong>approximate gradient descent in the space of reasoning traces</strong>, where the model updates its ‚Äúbeliefs‚Äù about a solution through internal self-assessment.</p>\n<p>Given an initial reasoning trace <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-102-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1319\" style=\"width: 1.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.3em, 2.398em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1320\"><span class=\"msubsup\" id=\"MathJax-Span-1321\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1322\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1323\"><span class=\"mrow\" id=\"MathJax-Span-1324\"><span class=\"mo\" id=\"MathJax-Span-1325\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-1326\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-1327\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-102\">z^{(0)}</script>, the update rule can be seen as:</p>\n<ul>\n      <li>where <strong>Critique</strong> is an operator producing feedback and <strong>Refine</strong> modifies the reasoning accordingly.</li>\n    </ul>\n<p>This closely parallels iterative inference in classical optimization and meta-learning frameworks.</p>\n<h4 id=\"variants-1\">Variants</h4>\n<ul>\n  <li><strong>Reflexion</strong> (<a href=\"https://arxiv.org/abs/2303.11366\">Shinn et al. (2023)</a>): Uses verbal reinforcement (self-generated critique and reward).</li>\n  <li><strong>Self-Refine</strong> (<a href=\"https://arxiv.org/abs/2303.17651\">Madaan et al. (2023)</a>): Separates roles into <em>task solver</em>, <em>feedback provider</em>, and <em>reviser</em>.</li>\n  <li><strong>Critic‚ÄìJudge systems</strong> (<a href=\"https://arxiv.org/abs/2305.20050\">Zhou et al. (2023)</a>): Introduces a secondary ‚Äúcritic‚Äù model to evaluate and score reasoning traces.</li>\n  <li><strong>RCOT (Reflective Chain-of-Thought)</strong> (<a href=\"https://arxiv.org/abs/2402.05402\">Zhang et al. (2024)</a>): Adds structured self-correction within CoT reasoning.</li>\n</ul>\n<h4 id=\"advantages-3\">Advantages</h4>\n<ul>\n  <li>Improves factual correctness and logical soundness of reasoning chains.</li>\n  <li>Encourages interpretable, auditable reasoning corrections.</li>\n  <li>Can operate with minimal supervision‚Äîfeedback is model-generated.</li>\n</ul>\n<h4 id=\"limitations-3\">Limitations</h4>\n<ul>\n  <li>Computationally expensive due to iterative passes.</li>\n  <li>Susceptible to feedback loops‚Äîreflections may amplify minor errors.</li>\n  <li>Quality of reflection depends heavily on prompt design and model calibration.</li>\n</ul>\n<h4 id=\"relationship-to-rl-and-cot\">Relationship to RL and CoT</h4>\n<ul>\n  <li>\n    <p>Reflection complements <strong>RL</strong> and <strong>CoT</strong>:</p>\n\n    <ul>\n      <li>Like RL, it provides a feedback signal, but in natural language form rather than scalar rewards.</li>\n      <li>Like CoT, it operates at the level of reasoning traces, but introduces a <strong>meta-layer</strong> of critique.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This synergy is foundational in modern autonomous reasoning agents that continuously self-improve through reflection cycles.</p>\n  </li>\n</ul>\n<p>Reflection complements <strong>RL</strong> and <strong>CoT</strong>:</p>\n<ul>\n      <li>Like RL, it provides a feedback signal, but in natural language form rather than scalar rewards.</li>\n      <li>Like CoT, it operates at the level of reasoning traces, but introduces a <strong>meta-layer</strong> of critique.</li>\n    </ul>\n<p>This synergy is foundational in modern autonomous reasoning agents that continuously self-improve through reflection cycles.</p>",
    "contentMarkdown": "*   **Reflection and self-verification** methods extend reasoning by allowing a model to **analyze, critique, and improve its own outputs**. Rather than generating a single reasoning trace and final answer, the model iteratively reviews its reasoning, identifies potential errors, and either revises the reasoning or re-generates the answer.\n    \n*   This meta-cognitive process‚Äîanalogous to human self-checking‚Äîis central to recent efforts to make reasoning both **more reliable** and **more factual**.\n    \n*   A key paper introducing this paradigm is _Reflexion: Language Agents with Verbal Reinforcement Learning_ by [Shinn et al. (2023)](https://arxiv.org/abs/2303.11366), and _Self-Refine: Iterative Refinement with Self-Feedback_ by [Madaan et al. (2023)](https://arxiv.org/abs/2303.17651).\n    \n\n**Reflection and self-verification** methods extend reasoning by allowing a model to **analyze, critique, and improve its own outputs**. Rather than generating a single reasoning trace and final answer, the model iteratively reviews its reasoning, identifies potential errors, and either revises the reasoning or re-generates the answer.\n\nThis meta-cognitive process‚Äîanalogous to human self-checking‚Äîis central to recent efforts to make reasoning both **more reliable** and **more factual**.\n\nA key paper introducing this paradigm is _Reflexion: Language Agents with Verbal Reinforcement Learning_ by [Shinn et al. (2023)](https://arxiv.org/abs/2303.11366), and _Self-Refine: Iterative Refinement with Self-Feedback_ by [Madaan et al. (2023)](https://arxiv.org/abs/2303.17651).\n\n#### Core Idea\n\n*   Reflection frameworks conceptualize reasoning as an **iterative loop** between _generation_, _evaluation_, and _revision_. A single pass through the LLM may produce a reasoning chain zzz and output yyy, but the model can further _reflect_ on its own reasoning by generating a self-critique ccc that identifies flaws or inconsistencies.\n    \n*   This process can be formalized as:\n    \n\nReflection frameworks conceptualize reasoning as an **iterative loop** between _generation_, _evaluation_, and _revision_. A single pass through the LLM may produce a reasoning chain zzz and output yyy, but the model can further _reflect_ on its own reasoning by generating a self-critique ccc that identifies flaws or inconsistencies.\n\nThis process can be formalized as:\n\nx‚àí‚Üí‚àí‚àí‚àíreason(z,y)‚àí‚Üí‚àí‚àí‚àíreflectc‚àí‚Üí‚àí‚àírevise(z‚Ä≤,y‚Ä≤)x‚Üíreason(z,y)‚Üíreflectc‚Üírevise(z‚Ä≤,y‚Ä≤)\n\n*   Each iteration ideally brings the reasoning trace closer to correctness or coherence.\n\n#### Mechanism\n\n1.  **Initial reasoning phase:** The model generates a reasoning chain and provisional answer.\n    \n2.  **Reflection phase:** The model (or a secondary evaluator) reviews the reasoning for logical, factual, or procedural errors. Example prompt: _‚ÄúExamine the above reasoning carefully. Identify mistakes or unsupported steps, and propose corrections.‚Äù_\n    \n3.  **Revision phase:** The model generates a new reasoning chain incorporating the critique. Optionally, feedback can be looped over multiple rounds.\n    \n4.  **Termination:** The loop ends when a confidence threshold or reflection limit is reached.\n    \n\n**Initial reasoning phase:** The model generates a reasoning chain and provisional answer.\n\n**Reflection phase:** The model (or a secondary evaluator) reviews the reasoning for logical, factual, or procedural errors. Example prompt: _‚ÄúExamine the above reasoning carefully. Identify mistakes or unsupported steps, and propose corrections.‚Äù_\n\n**Revision phase:** The model generates a new reasoning chain incorporating the critique. Optionally, feedback can be looped over multiple rounds.\n\n**Termination:** The loop ends when a confidence threshold or reflection limit is reached.\n\n#### Theoretical Framing\n\n*   Reflection can be viewed as **approximate gradient descent in the space of reasoning traces**, where the model updates its ‚Äúbeliefs‚Äù about a solution through internal self-assessment.\n    \n*   Given an initial reasoning trace z(0)z(0)z^{(0)}, the update rule can be seen as:\n    \n    z(t+1)\\=Refine(z(t),Critique(z(t)))z(t+1)\\=Refine(z(t),Critique(z(t)))\n    \n    z^{(t+1)} = \\\\text{Refine}\\\\big(z^{(t)}, \\\\text{Critique}(z^{(t)})\\\\big)\n    *   where **Critique** is an operator producing feedback and **Refine** modifies the reasoning accordingly.\n*   This closely parallels iterative inference in classical optimization and meta-learning frameworks.\n    \n\nReflection can be viewed as **approximate gradient descent in the space of reasoning traces**, where the model updates its ‚Äúbeliefs‚Äù about a solution through internal self-assessment.\n\nGiven an initial reasoning trace z(0)z(0)z^{(0)}, the update rule can be seen as:\n\n*   where **Critique** is an operator producing feedback and **Refine** modifies the reasoning accordingly.\n\nThis closely parallels iterative inference in classical optimization and meta-learning frameworks.\n\n#### Variants\n\n*   **Reflexion** ([Shinn et al. (2023)](https://arxiv.org/abs/2303.11366)): Uses verbal reinforcement (self-generated critique and reward).\n*   **Self-Refine** ([Madaan et al. (2023)](https://arxiv.org/abs/2303.17651)): Separates roles into _task solver_, _feedback provider_, and _reviser_.\n*   **Critic‚ÄìJudge systems** ([Zhou et al. (2023)](https://arxiv.org/abs/2305.20050)): Introduces a secondary ‚Äúcritic‚Äù model to evaluate and score reasoning traces.\n*   **RCOT (Reflective Chain-of-Thought)** ([Zhang et al. (2024)](https://arxiv.org/abs/2402.05402)): Adds structured self-correction within CoT reasoning.\n\n#### Advantages\n\n*   Improves factual correctness and logical soundness of reasoning chains.\n*   Encourages interpretable, auditable reasoning corrections.\n*   Can operate with minimal supervision‚Äîfeedback is model-generated.\n\n#### Limitations\n\n*   Computationally expensive due to iterative passes.\n*   Susceptible to feedback loops‚Äîreflections may amplify minor errors.\n*   Quality of reflection depends heavily on prompt design and model calibration.\n\n#### Relationship to RL and CoT\n\n*   Reflection complements **RL** and **CoT**:\n    \n    *   Like RL, it provides a feedback signal, but in natural language form rather than scalar rewards.\n    *   Like CoT, it operates at the level of reasoning traces, but introduces a **meta-layer** of critique.\n*   This synergy is foundational in modern autonomous reasoning agents that continuously self-improve through reflection cycles.\n    \n\nReflection complements **RL** and **CoT**:\n\n*   Like RL, it provides a feedback signal, but in natural language form rather than scalar rewards.\n*   Like CoT, it operates at the level of reasoning traces, but introduces a **meta-layer** of critique.\n\nThis synergy is foundational in modern autonomous reasoning agents that continuously self-improve through reflection cycles.",
    "order": 14,
    "orderInChapter": 2,
    "difficulty": 3,
    "estimatedMinutes": 5,
    "tags": [
      "nlpllms",
      "llm",
      "reinforcement learning",
      "optimization",
      "gradient descent"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 853,
      "contentLength": 38258
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#reflection-and-self-verification-loops",
    "scrapedAt": "2025-12-28T11:54:00.655Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-tree-of-thoughts-tot-prompting-15",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Search-Based Reasoning",
    "title": "Tree-of-Thoughts (ToT) Prompting",
    "subtitle": "Search-Based Reasoning",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Tree-of-Thoughts (ToT)</strong> generalizes CoT prompting into a <strong>structured search process</strong> over multiple reasoning paths. Instead of committing to a single linear reasoning chain, ToT explores a branching search tree where each node corresponds to a partial ‚Äúthought,‚Äù and branches represent possible continuations of reasoning.</p>\n  </li>\n  <li>\n    <p>This approach was introduced in <em>Tree of Thoughts: Deliberate Problem Solving with Large Language Models</em> by <a href=\"https://arxiv.org/abs/2305.10601\">Yao et al. (2023)</a>.</p>\n  </li>\n</ul>\n<p><strong>Tree-of-Thoughts (ToT)</strong> generalizes CoT prompting into a <strong>structured search process</strong> over multiple reasoning paths. Instead of committing to a single linear reasoning chain, ToT explores a branching search tree where each node corresponds to a partial ‚Äúthought,‚Äù and branches represent possible continuations of reasoning.</p>\n<p>This approach was introduced in <em>Tree of Thoughts: Deliberate Problem Solving with Large Language Models</em> by <a href=\"https://arxiv.org/abs/2305.10601\">Yao et al. (2023)</a>.</p>\n<h4 id=\"core-idea-3\">Core Idea</h4>\n<ul>\n  <li>\n    <p>CoT prompting treats reasoning as a single sampled trajectory:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-104-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>x</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mi>z</mi><mn>2</mn></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mo>&amp;#x22EF;</mo><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mi>z</mi><mi>T</mi></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mi>y</mi></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1365\" style=\"width: 15.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.773em, 1012.76em, 2.763em, -999.997em); top: -2.393em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1366\"><span class=\"mi\" id=\"MathJax-Span-1367\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1368\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-1369\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1370\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-1371\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1372\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-1373\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1374\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-1375\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1376\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"mo\" id=\"MathJax-Span-1377\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚ãØ</span><span class=\"mo\" id=\"MathJax-Span-1378\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-1379\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1380\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1381\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1382\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"mi\" id=\"MathJax-Span-1383\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.398em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>x</mi><mo stretchy=\"false\">‚Üí</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy=\"false\">‚Üí</mo><msub><mi>z</mi><mn>2</mn></msub><mo stretchy=\"false\">‚Üí</mo><mo>‚ãØ</mo><mo stretchy=\"false\">‚Üí</mo><msub><mi>z</mi><mi>T</mi></msub><mo stretchy=\"false\">‚Üí</mo><mi>y</mi></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-104\">x \\rightarrow z_1 \\rightarrow z_2 \\rightarrow \\cdots \\rightarrow z_T \\rightarrow y</script>\n\n    <ul>\n      <li>while ToT treats reasoning as an <strong>exploration problem</strong> over multiple possible continuations at each step:</li>\n    </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-105-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo>&amp;#x2223;</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>&amp;#x2208;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow><mo>,</mo><mtext>&amp;#xA0;</mtext><msub><mi>z</mi><mi>t</mi></msub><mo>&amp;#x2208;</mo><mtext>Expand</mtext><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1384\" style=\"width: 20.211em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1016.77em, 2.659em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1385\"><span class=\"texatom\" id=\"MathJax-Span-1386\"><span class=\"mrow\" id=\"MathJax-Span-1387\"><span class=\"mi\" id=\"MathJax-Span-1388\" style=\"font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.211em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1389\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-1390\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-1391\"><span class=\"msubsup\" id=\"MathJax-Span-1392\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1393\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1394\"><span class=\"mrow\" id=\"MathJax-Span-1395\"><span class=\"mn\" id=\"MathJax-Span-1396\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1397\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1398\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1399\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1400\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1401\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1402\"><span class=\"mrow\" id=\"MathJax-Span-1403\"><span class=\"mn\" id=\"MathJax-Span-1404\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1405\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1406\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1407\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-1408\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1409\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àà</span><span class=\"texatom\" id=\"MathJax-Span-1410\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-1411\"><span class=\"mi\" id=\"MathJax-Span-1412\" style=\"font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.211em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1413\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-1414\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">&nbsp;</span><span class=\"msubsup\" id=\"MathJax-Span-1415\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1416\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1417\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1418\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àà</span><span class=\"mtext\" id=\"MathJax-Span-1419\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">Expand</span><span class=\"mo\" id=\"MathJax-Span-1420\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1421\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1422\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1423\"><span class=\"mrow\" id=\"MathJax-Span-1424\"><span class=\"mn\" id=\"MathJax-Span-1425\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1426\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1427\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1428\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-1429\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1430\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo>‚à£</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo>‚àà</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow><mo>,</mo><mtext>&nbsp;</mtext><msub><mi>z</mi><mi>t</mi></msub><mo>‚àà</mo><mtext>Expand</mtext><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-105\">\\mathcal{T} = {z_{1:t} \\mid z_{1:t-1} \\in \\mathcal{T},\\ z_t \\in \\text{Expand}(z_{1:t-1})}</script>\n  </li>\n  <li>\n    <p>The model explicitly evaluates partial thoughts <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-106-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1431\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.2em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1432\"><span class=\"msubsup\" id=\"MathJax-Span-1433\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1434\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1435\"><span class=\"mrow\" id=\"MathJax-Span-1436\"><span class=\"mn\" id=\"MathJax-Span-1437\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1438\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1439\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-106\">z_{1:t}</script> using a <strong>heuristic function</strong> or <strong>value model</strong>, guiding the expansion toward promising reasoning directions.</p>\n  </li>\n</ul>\n<p>CoT prompting treats reasoning as a single sampled trajectory:</p>\n<ul>\n      <li>while ToT treats reasoning as an <strong>exploration problem</strong> over multiple possible continuations at each step:</li>\n    </ul>\n<p>The model explicitly evaluates partial thoughts <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-106-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1431\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.2em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1432\"><span class=\"msubsup\" id=\"MathJax-Span-1433\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1434\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1435\"><span class=\"mrow\" id=\"MathJax-Span-1436\"><span class=\"mn\" id=\"MathJax-Span-1437\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1438\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1439\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-106\">z_{1:t}</script> using a <strong>heuristic function</strong> or <strong>value model</strong>, guiding the expansion toward promising reasoning directions.</p>\n<h4 id=\"mechanism-4\">Mechanism</h4>\n<ol>\n  <li><strong>Thought generation:</strong>\n    <ul>\n      <li>The model generates candidate continuations for the current thought, e.g., <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-107-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>z</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1440\" style=\"width: 7.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1006.51em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1441\"><span class=\"msubsup\" id=\"MathJax-Span-1442\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1443\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1444\"><span class=\"mrow\" id=\"MathJax-Span-1445\"><span class=\"mo\" id=\"MathJax-Span-1446\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-1447\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1448\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1449\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1450\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1451\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1452\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1453\"><span class=\"mrow\" id=\"MathJax-Span-1454\"><span class=\"mo\" id=\"MathJax-Span-1455\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-1456\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span class=\"mo\" id=\"MathJax-Span-1457\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1458\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1459\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-1460\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-1461\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1462\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1463\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1464\"><span class=\"mrow\" id=\"MathJax-Span-1465\"><span class=\"mo\" id=\"MathJax-Span-1466\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1467\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">b</span><span class=\"mo\" id=\"MathJax-Span-1468\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1469\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>z</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-107\">z_t^{(1)}, z_t^{(2)}, \\ldots, z_t^{(b)}</script></li>\n    </ul>\n  </li>\n  <li><strong>Evaluation:</strong>\n    <ul>\n      <li>Each partial reasoning sequence <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-108-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1470\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.2em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1471\"><span class=\"msubsup\" id=\"MathJax-Span-1472\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1473\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1474\"><span class=\"mrow\" id=\"MathJax-Span-1475\"><span class=\"mn\" id=\"MathJax-Span-1476\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1477\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1478\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-108\">z_{1:t}</script> is scored by the model itself or a learned value function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-109-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1479\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1480\"><span class=\"msubsup\" id=\"MathJax-Span-1481\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1482\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1483\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1484\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1485\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1486\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1487\"><span class=\"mrow\" id=\"MathJax-Span-1488\"><span class=\"mn\" id=\"MathJax-Span-1489\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1490\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1491\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1492\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-109\">V_\\phi(z_{1:t})</script>, estimating expected success.</li>\n    </ul>\n  </li>\n  <li><strong>Search algorithm:</strong>\n    <ul>\n      <li>Employs strategies such as <strong>breadth-first search (BFS)</strong>, <strong>depth-first search (DFS)</strong>, or <strong>Monte Carlo Tree Search (MCTS)</strong> to explore reasoning paths selectively.</li>\n    </ul>\n  </li>\n  <li><strong>Selection:</strong>\n    <ul>\n      <li>The final answer is derived from the highest-valued complete reasoning path or an ensemble of top candidates.</li>\n    </ul>\n  </li>\n</ol>\n<ul>\n      <li>The model generates candidate continuations for the current thought, e.g., <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-107-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>z</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1440\" style=\"width: 7.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1006.51em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1441\"><span class=\"msubsup\" id=\"MathJax-Span-1442\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1443\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1444\"><span class=\"mrow\" id=\"MathJax-Span-1445\"><span class=\"mo\" id=\"MathJax-Span-1446\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-1447\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1448\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1449\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1450\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1451\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1452\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1453\"><span class=\"mrow\" id=\"MathJax-Span-1454\"><span class=\"mo\" id=\"MathJax-Span-1455\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-1456\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span class=\"mo\" id=\"MathJax-Span-1457\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1458\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1459\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-1460\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-1461\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1462\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1463\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1464\"><span class=\"mrow\" id=\"MathJax-Span-1465\"><span class=\"mo\" id=\"MathJax-Span-1466\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1467\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">b</span><span class=\"mo\" id=\"MathJax-Span-1468\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1469\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>z</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-107\">z_t^{(1)}, z_t^{(2)}, \\ldots, z_t^{(b)}</script></li>\n    </ul>\n<ul>\n      <li>Each partial reasoning sequence <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-108-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1470\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.2em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1471\"><span class=\"msubsup\" id=\"MathJax-Span-1472\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1473\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1474\"><span class=\"mrow\" id=\"MathJax-Span-1475\"><span class=\"mn\" id=\"MathJax-Span-1476\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1477\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1478\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-108\">z_{1:t}</script> is scored by the model itself or a learned value function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-109-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1479\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1480\"><span class=\"msubsup\" id=\"MathJax-Span-1481\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1482\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1483\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1484\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1485\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1486\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1487\"><span class=\"mrow\" id=\"MathJax-Span-1488\"><span class=\"mn\" id=\"MathJax-Span-1489\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1490\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1491\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1492\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-109\">V_\\phi(z_{1:t})</script>, estimating expected success.</li>\n    </ul>\n<ul>\n      <li>Employs strategies such as <strong>breadth-first search (BFS)</strong>, <strong>depth-first search (DFS)</strong>, or <strong>Monte Carlo Tree Search (MCTS)</strong> to explore reasoning paths selectively.</li>\n    </ul>\n<ul>\n      <li>The final answer is derived from the highest-valued complete reasoning path or an ensemble of top candidates.</li>\n    </ul>\n<ul>\n  <li>\n    <p>Mathematically, this resembles a policy/value formulation:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-110-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mspace width=&quot;1em&quot; /><mtext>and</mtext><mspace width=&quot;1em&quot; /><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mi>R</mi><mo>&amp;#x2223;</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1493\" style=\"width: 22.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 19.013em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1018.91em, 2.815em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1494\"><span class=\"msubsup\" id=\"MathJax-Span-1495\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1496\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1497\"><span class=\"mrow\" id=\"MathJax-Span-1498\"><span class=\"mi\" id=\"MathJax-Span-1499\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1500\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-1501\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1502\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-1503\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1504\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1505\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1506\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1507\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1508\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1509\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1510\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1511\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1512\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1513\"><span class=\"mrow\" id=\"MathJax-Span-1514\"><span class=\"mn\" id=\"MathJax-Span-1515\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1516\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1517\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1518\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mspace\" id=\"MathJax-Span-1519\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"mtext\" id=\"MathJax-Span-1520\" style=\"font-family: STIXGeneral-Regular;\">and</span><span class=\"mspace\" id=\"MathJax-Span-1521\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-1522\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1523\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1524\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1525\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1526\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1527\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1528\"><span class=\"mrow\" id=\"MathJax-Span-1529\"><span class=\"mn\" id=\"MathJax-Span-1530\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1531\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1532\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1533\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1534\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"texatom\" id=\"MathJax-Span-1535\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-1536\"><span class=\"mi\" id=\"MathJax-Span-1537\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span class=\"mo\" id=\"MathJax-Span-1538\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-1539\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-1540\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1541\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1542\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1543\"><span class=\"mrow\" id=\"MathJax-Span-1544\"><span class=\"mn\" id=\"MathJax-Span-1545\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1546\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1547\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1548\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>‚àº</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mspace width=\"1em\"></mspace><mtext>and</mtext><mspace width=\"1em\"></mspace><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚âà</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mo stretchy=\"false\">[</mo><mi>R</mi><mo>‚à£</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-110\">z_{t+1} \\sim \\pi_\\theta(z_t \\mid z_{1:t}) \\quad \\text{and} \\quad V_\\phi(z_{1:t}) \\approx \\mathbb{E}[R \\mid z_{1:t}]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-111-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1549\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1550\"><span class=\"mi\" id=\"MathJax-Span-1551\" style=\"font-family: STIXGeneral-Italic;\">R</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-111\">R</script> is a reward for a correct or high-quality final output.</li>\n    </ul>\n  </li>\n</ul>\n<p>Mathematically, this resembles a policy/value formulation:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-111-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1549\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1550\"><span class=\"mi\" id=\"MathJax-Span-1551\" style=\"font-family: STIXGeneral-Italic;\">R</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-111\">R</script> is a reward for a correct or high-quality final output.</li>\n    </ul>\n<h4 id=\"example\">Example</h4>\n<ul>\n  <li>\n    <p>For a math problem such as <em>‚ÄúFind the smallest integer satisfying ‚Ä¶‚Äù</em>, the ToT procedure may branch into:</p>\n\n    <ul>\n      <li><strong>Thought A:</strong> Try algebraic manipulation.</li>\n      <li><strong>Thought B:</strong> Try substitution.</li>\n      <li><strong>Thought C:</strong> Try bounding argument.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The model evaluates which partial derivation yields progress and prunes unpromising branches, effectively performing <strong>deliberate reasoning</strong>.</p>\n  </li>\n</ul>\n<p>For a math problem such as <em>‚ÄúFind the smallest integer satisfying ‚Ä¶‚Äù</em>, the ToT procedure may branch into:</p>\n<ul>\n      <li><strong>Thought A:</strong> Try algebraic manipulation.</li>\n      <li><strong>Thought B:</strong> Try substitution.</li>\n      <li><strong>Thought C:</strong> Try bounding argument.</li>\n    </ul>\n<p>The model evaluates which partial derivation yields progress and prunes unpromising branches, effectively performing <strong>deliberate reasoning</strong>.</p>\n<h4 id=\"advantages-4\">Advantages</h4>\n<ul>\n  <li>Encourages <strong>exploration over multiple reasoning directions</strong>, avoiding early commitment to incorrect logic.</li>\n  <li>Enables <strong>planning and backtracking</strong>, crucial for complex reasoning.</li>\n  <li>Integrates well with external evaluators or reward functions.</li>\n</ul>\n<h4 id=\"limitations-4\">Limitations</h4>\n<ul>\n  <li><strong>Computationally expensive</strong>: exponential search space mitigated only by pruning heuristics.</li>\n  <li>Requires a reliable evaluation function to score partial reasoning.</li>\n  <li>Harder to parallelize and tune compared to CoT or Self-Consistency.</li>\n</ul>\n<h4 id=\"relation-to-other-methods\">Relation to Other Methods</h4>\n<ul>\n  <li>\n    <p>Tree-of-Thoughts bridges the gap between:</p>\n\n    <ul>\n      <li><strong>CoT</strong> (single deterministic reasoning chain), and</li>\n      <li><strong>Search-based reasoning</strong> in classical AI (state-space exploration, planning).</li>\n    </ul>\n  </li>\n  <li>\n    <p>In this sense, it operationalizes the idea that reasoning should be <strong>deliberative</strong>, not merely <strong>associative</strong>.</p>\n  </li>\n</ul>\n<p>Tree-of-Thoughts bridges the gap between:</p>\n<ul>\n      <li><strong>CoT</strong> (single deterministic reasoning chain), and</li>\n      <li><strong>Search-based reasoning</strong> in classical AI (state-space exploration, planning).</li>\n    </ul>\n<p>In this sense, it operationalizes the idea that reasoning should be <strong>deliberative</strong>, not merely <strong>associative</strong>.</p>",
    "contentMarkdown": "*   **Tree-of-Thoughts (ToT)** generalizes CoT prompting into a **structured search process** over multiple reasoning paths. Instead of committing to a single linear reasoning chain, ToT explores a branching search tree where each node corresponds to a partial ‚Äúthought,‚Äù and branches represent possible continuations of reasoning.\n    \n*   This approach was introduced in _Tree of Thoughts: Deliberate Problem Solving with Large Language Models_ by [Yao et al. (2023)](https://arxiv.org/abs/2305.10601).\n    \n\n**Tree-of-Thoughts (ToT)** generalizes CoT prompting into a **structured search process** over multiple reasoning paths. Instead of committing to a single linear reasoning chain, ToT explores a branching search tree where each node corresponds to a partial ‚Äúthought,‚Äù and branches represent possible continuations of reasoning.\n\nThis approach was introduced in _Tree of Thoughts: Deliberate Problem Solving with Large Language Models_ by [Yao et al. (2023)](https://arxiv.org/abs/2305.10601).\n\n#### Core Idea\n\n*   CoT prompting treats reasoning as a single sampled trajectory:\n    \n    x‚Üíz1‚Üíz2‚Üí‚ãØ‚ÜízT‚Üíyx‚Üíz1‚Üíz2‚Üí‚ãØ‚ÜízT‚Üíy\n    \n    x \\\\rightarrow z\\_1 \\\\rightarrow z\\_2 \\\\rightarrow \\\\cdots \\\\rightarrow z\\_T \\\\rightarrow y\n    \n    *   while ToT treats reasoning as an **exploration problem** over multiple possible continuations at each step:\n    \n    ÓâÄ\\=z1:t‚à£z1:t‚àí1‚ààÓâÄ,¬†zt‚ààExpand(z1:t‚àí1)T\\=z1:t‚à£z1:t‚àí1‚ààT,¬†zt‚ààExpand(z1:t‚àí1)\n    \n    \\\\mathcal{T} = {z\\_{1:t} \\\\mid z\\_{1:t-1} \\\\in \\\\mathcal{T},\\\\ z\\_t \\\\in \\\\text{Expand}(z\\_{1:t-1})}\n*   The model explicitly evaluates partial thoughts z1:tz1:tz\\_{1:t} using a **heuristic function** or **value model**, guiding the expansion toward promising reasoning directions.\n    \n\nCoT prompting treats reasoning as a single sampled trajectory:\n\n*   while ToT treats reasoning as an **exploration problem** over multiple possible continuations at each step:\n\nThe model explicitly evaluates partial thoughts z1:tz1:tz\\_{1:t} using a **heuristic function** or **value model**, guiding the expansion toward promising reasoning directions.\n\n#### Mechanism\n\n1.  **Thought generation:**\n    *   The model generates candidate continuations for the current thought, e.g., z(1)t,z(2)t,‚Ä¶,z(b)tzt(1),zt(2),‚Ä¶,zt(b)z\\_t^{(1)}, z\\_t^{(2)}, \\\\ldots, z\\_t^{(b)}\n2.  **Evaluation:**\n    *   Each partial reasoning sequence z1:tz1:tz\\_{1:t} is scored by the model itself or a learned value function Vœï(z1:t)Vœï(z1:t)V\\_\\\\phi(z\\_{1:t}), estimating expected success.\n3.  **Search algorithm:**\n    *   Employs strategies such as **breadth-first search (BFS)**, **depth-first search (DFS)**, or **Monte Carlo Tree Search (MCTS)** to explore reasoning paths selectively.\n4.  **Selection:**\n    *   The final answer is derived from the highest-valued complete reasoning path or an ensemble of top candidates.\n\n*   The model generates candidate continuations for the current thought, e.g., z(1)t,z(2)t,‚Ä¶,z(b)tzt(1),zt(2),‚Ä¶,zt(b)z\\_t^{(1)}, z\\_t^{(2)}, \\\\ldots, z\\_t^{(b)}\n\n*   Each partial reasoning sequence z1:tz1:tz\\_{1:t} is scored by the model itself or a learned value function Vœï(z1:t)Vœï(z1:t)V\\_\\\\phi(z\\_{1:t}), estimating expected success.\n\n*   Employs strategies such as **breadth-first search (BFS)**, **depth-first search (DFS)**, or **Monte Carlo Tree Search (MCTS)** to explore reasoning paths selectively.\n\n*   The final answer is derived from the highest-valued complete reasoning path or an ensemble of top candidates.\n\n*   Mathematically, this resembles a policy/value formulation:\n    \n    zt+1‚àºœÄŒ∏(zt‚à£z1:t)andVœï(z1:t)‚âàùîº\\[R‚à£z1:t\\]zt+1‚àºœÄŒ∏(zt‚à£z1:t)andVœï(z1:t)‚âàE\\[R‚à£z1:t\\]\n    \n    z\\_{t+1} \\\\sim \\\\pi\\_\\\\theta(z\\_t \\\\mid z\\_{1:t}) \\\\quad \\\\text{and} \\\\quad V\\_\\\\phi(z\\_{1:t}) \\\\approx \\\\mathbb{E}\\[R \\\\mid z\\_{1:t}\\]\n    *   where RRR is a reward for a correct or high-quality final output.\n\nMathematically, this resembles a policy/value formulation:\n\n*   where RRR is a reward for a correct or high-quality final output.\n\n#### Example\n\n*   For a math problem such as _‚ÄúFind the smallest integer satisfying ‚Ä¶‚Äù_, the ToT procedure may branch into:\n    \n    *   **Thought A:** Try algebraic manipulation.\n    *   **Thought B:** Try substitution.\n    *   **Thought C:** Try bounding argument.\n*   The model evaluates which partial derivation yields progress and prunes unpromising branches, effectively performing **deliberate reasoning**.\n    \n\nFor a math problem such as _‚ÄúFind the smallest integer satisfying ‚Ä¶‚Äù_, the ToT procedure may branch into:\n\n*   **Thought A:** Try algebraic manipulation.\n*   **Thought B:** Try substitution.\n*   **Thought C:** Try bounding argument.\n\nThe model evaluates which partial derivation yields progress and prunes unpromising branches, effectively performing **deliberate reasoning**.\n\n#### Advantages\n\n*   Encourages **exploration over multiple reasoning directions**, avoiding early commitment to incorrect logic.\n*   Enables **planning and backtracking**, crucial for complex reasoning.\n*   Integrates well with external evaluators or reward functions.\n\n#### Limitations\n\n*   **Computationally expensive**: exponential search space mitigated only by pruning heuristics.\n*   Requires a reliable evaluation function to score partial reasoning.\n*   Harder to parallelize and tune compared to CoT or Self-Consistency.\n\n#### Relation to Other Methods\n\n*   Tree-of-Thoughts bridges the gap between:\n    \n    *   **CoT** (single deterministic reasoning chain), and\n    *   **Search-based reasoning** in classical AI (state-space exploration, planning).\n*   In this sense, it operationalizes the idea that reasoning should be **deliberative**, not merely **associative**.\n    \n\nTree-of-Thoughts bridges the gap between:\n\n*   **CoT** (single deterministic reasoning chain), and\n*   **Search-based reasoning** in classical AI (state-space exploration, planning).\n\nIn this sense, it operationalizes the idea that reasoning should be **deliberative**, not merely **associative**.",
    "order": 15,
    "orderInChapter": 1,
    "difficulty": 3,
    "estimatedMinutes": 4,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 721,
      "contentLength": 65309
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#tree-of-thoughts-(tot)-prompting",
    "scrapedAt": "2025-12-28T11:54:00.655Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-monte-carlo-tree-search-mcts-based-reasoning-16",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Search-Based Reasoning",
    "title": "Monte Carlo Tree Search (MCTS)-based Reasoning",
    "subtitle": "Search-Based Reasoning",
    "contentHtml": "<h4 id=\"core-idea-4\">Core Idea</h4>\n<ul>\n  <li>\n    <p><strong>Monte Carlo Tree Search (MCTS)-based reasoning</strong> refines search-based reasoning by using <strong>stochastic simulations</strong> to balance exploration and exploitation over the reasoning space. Each node in the search tree represents a <em>partial reasoning trace</em> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-112-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1552\" style=\"width: 9.638em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1007.97em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1553\"><span class=\"msubsup\" id=\"MathJax-Span-1554\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1555\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1556\"><span class=\"mrow\" id=\"MathJax-Span-1557\"><span class=\"mn\" id=\"MathJax-Span-1558\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1559\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1560\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1561\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-1562\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1563\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1564\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-1565\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1566\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1567\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1568\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-1569\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1570\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-1571\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-1572\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1573\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1574\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1575\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1576\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-112\">z_{1:t} = (z_1, z_2, \\ldots, z_t)</script>, and edges represent possible next reasoning steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-113-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1577\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.51em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1578\"><span class=\"msubsup\" id=\"MathJax-Span-1579\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1580\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1581\"><span class=\"mrow\" id=\"MathJax-Span-1582\"><span class=\"mi\" id=\"MathJax-Span-1583\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1584\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-1585\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-113\">z_{t+1}</script>. Unlike simple breadth-first or depth-first traversal, MCTS uses probabilistic sampling to explore promising reasoning branches while still allocating some computation to less-visited ones, ensuring a balance between <strong>discovering new reasoning paths</strong> and <strong>refining strong candidates</strong>.</p>\n  </li>\n  <li>\n    <p>Formally, reasoning unfolds as a growing search tree <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-114-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1586\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.94em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1587\"><span class=\"texatom\" id=\"MathJax-Span-1588\"><span class=\"mrow\" id=\"MathJax-Span-1589\"><span class=\"mi\" id=\"MathJax-Span-1590\" style=\"font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.211em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-114\">\\mathcal{T}</script>:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-115-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo>&amp;#x2223;</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>&amp;#x2208;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow><mo>,</mo><mtext>&amp;#xA0;</mtext><msub><mi>z</mi><mi>t</mi></msub><mo>&amp;#x2208;</mo><mtext>Expand</mtext><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1591\" style=\"width: 20.211em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1016.77em, 2.659em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1592\"><span class=\"texatom\" id=\"MathJax-Span-1593\"><span class=\"mrow\" id=\"MathJax-Span-1594\"><span class=\"mi\" id=\"MathJax-Span-1595\" style=\"font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.211em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1596\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-1597\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-1598\"><span class=\"msubsup\" id=\"MathJax-Span-1599\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1600\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1601\"><span class=\"mrow\" id=\"MathJax-Span-1602\"><span class=\"mn\" id=\"MathJax-Span-1603\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1604\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1605\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1606\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1607\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1608\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1609\"><span class=\"mrow\" id=\"MathJax-Span-1610\"><span class=\"mn\" id=\"MathJax-Span-1611\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1612\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1613\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1614\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-1615\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1616\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àà</span><span class=\"texatom\" id=\"MathJax-Span-1617\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-1618\"><span class=\"mi\" id=\"MathJax-Span-1619\" style=\"font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.211em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1620\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-1621\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">&nbsp;</span><span class=\"msubsup\" id=\"MathJax-Span-1622\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1623\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1624\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1625\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àà</span><span class=\"mtext\" id=\"MathJax-Span-1626\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">Expand</span><span class=\"mo\" id=\"MathJax-Span-1627\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1628\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1629\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1630\"><span class=\"mrow\" id=\"MathJax-Span-1631\"><span class=\"mn\" id=\"MathJax-Span-1632\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1633\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1634\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1635\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-1636\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1637\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo>‚à£</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo>‚àà</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow><mo>,</mo><mtext>&nbsp;</mtext><msub><mi>z</mi><mi>t</mi></msub><mo>‚àà</mo><mtext>Expand</mtext><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-115\">\\mathcal{T} = { z_{1:t} \\mid z_{1:t-1} \\in \\mathcal{T},\\ z_t \\in \\text{Expand}(z_{1:t-1}) }</script>\n\n    <ul>\n      <li>where the <strong>Expand</strong> step is guided by the LLM‚Äôs conditional distribution <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-116-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1638\" style=\"width: 7.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1006.15em, 2.659em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1639\"><span class=\"msubsup\" id=\"MathJax-Span-1640\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1641\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1642\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1643\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1644\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1645\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1646\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1647\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1648\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1649\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1650\"><span class=\"mrow\" id=\"MathJax-Span-1651\"><span class=\"mn\" id=\"MathJax-Span-1652\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1653\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1654\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1655\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-1656\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1657\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1658\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1659\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-116\">p_\\theta(z_t \\mid z_{1:t-1}, x)</script>, and the <strong>evaluation function</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-117-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1660\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1661\"><span class=\"msubsup\" id=\"MathJax-Span-1662\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1663\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1664\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1665\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1666\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1667\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1668\"><span class=\"mrow\" id=\"MathJax-Span-1669\"><span class=\"mn\" id=\"MathJax-Span-1670\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1671\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1672\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1673\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-117\">V_\\phi(z_{1:t})</script> estimates how promising each partial reasoning sequence is.</li>\n    </ul>\n  </li>\n  <li>\n    <p>MCTS then uses <strong>simulated rollouts</strong>‚Äîpartial reasoning trajectories extended to completion‚Äîto estimate downstream rewards, which are <strong>backpropagated</strong> through the tree to update value and visit counts. The algorithm repeatedly selects nodes using an upper-confidence bound (UCB) criterion that trades off exploration and exploitation:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-118-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>a</mi><mo>&amp;#x2217;</mo></msup><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>a</mi></munder><mrow><mo>(</mo><mrow><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>c</mi><msqrt><mfrac><mrow><mi>log</mi><mo>&amp;#x2061;</mo><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mn>1</mn></mrow></mfrac></msqrt></mrow><mo>)</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1674\" style=\"width: 20.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 17.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.346em, 1017.09em, 5.263em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1675\"><span class=\"msubsup\" id=\"MathJax-Span-1676\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1677\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-1678\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1679\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1680\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-1681\"></span><span class=\"munderover\" id=\"MathJax-Span-1682\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1683\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.273em, -999.997em); top: -3.331em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-1684\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-1685\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-1686\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-1687\"><span class=\"mi\" id=\"MathJax-Span-1688\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-1689\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1690\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1691\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1692\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1693\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1694\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1695\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">c</span><span class=\"msqrt\" id=\"MathJax-Span-1696\"><span style=\"display: inline-block; position: relative; width: 5.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.503em, 1004.79em, 5.055em, -999.997em); top: -4.008em; left: 1.148em;\"><span class=\"mrow\" id=\"MathJax-Span-1697\"><span class=\"mfrac\" id=\"MathJax-Span-1698\"><span style=\"display: inline-block; position: relative; width: 4.586em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.23em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.612em;\"><span class=\"mrow\" id=\"MathJax-Span-1699\"><span class=\"mi\" id=\"MathJax-Span-1700\" style=\"font-family: STIXGeneral-Regular;\">log</span><span class=\"mo\" id=\"MathJax-Span-1701\"></span><span class=\"mi\" id=\"MathJax-Span-1702\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1703\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1704\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1705\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1004.38em, 4.326em, -999.997em); top: -3.331em; left: 50%; margin-left: -2.237em;\"><span class=\"mrow\" id=\"MathJax-Span-1706\"><span class=\"mi\" id=\"MathJax-Span-1707\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1708\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1709\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1710\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1711\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1712\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1713\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-1714\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.59em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.586em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.023em, 1004.85em, 3.388em, -999.997em); top: -4.737em; left: 1.148em;\"><span style=\"display: inline-block; position: relative; width: 4.846em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 0em;\">‚Äæ<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 4.326em;\">‚Äæ<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.419em;\">‚Äæ<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.836em;\">‚Äæ<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.305em;\">‚Äæ<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.721em;\">‚Äæ<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.138em;\">‚Äæ<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.607em;\">‚Äæ<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.023em;\">‚Äæ<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.492em;\">‚Äæ<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.909em;\">‚Äæ<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(1.826em, 1001.15em, 4.586em, -999.997em); top: -3.539em; left: 0em;\"><span style=\"font-family: STIXSizeTwoSym;\">‚àö</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1715\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>a</mi><mo>‚àó</mo></msup><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>a</mi></munder><mrow><mo>(</mo><mrow><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>c</mi><msqrt><mfrac><mrow><mi>log</mi><mo>‚Å°</mo><mi>N</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>N</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mn>1</mn></mrow></mfrac></msqrt></mrow><mo>)</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-118\">a^* = \\arg\\max_a \\left( Q(s, a) + c \\sqrt{\\frac{\\log N(s)}{N(s, a) + 1}} \\right)</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-119-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1716\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1717\"><span class=\"mi\" id=\"MathJax-Span-1718\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-1719\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1720\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1721\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1722\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1723\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-119\">Q(s, a)</script> is the average reward for taking reasoning step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-120-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1724\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1725\"><span class=\"mi\" id=\"MathJax-Span-1726\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-120\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-121-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1727\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1728\"><span class=\"mi\" id=\"MathJax-Span-1729\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-121\">s</script>, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-122-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1730\" style=\"width: 3.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.71em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1731\"><span class=\"mi\" id=\"MathJax-Span-1732\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1733\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1734\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1735\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1736\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1737\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>N</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-122\">N(s, a)</script> the number of visits, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-123-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1738\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1739\"><span class=\"mi\" id=\"MathJax-Span-1740\" style=\"font-family: STIXGeneral-Italic;\">c</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>c</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-123\">c</script> a temperature constant controlling exploration.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This process continues until reasoning trajectories reach terminal states‚Äîcomplete solutions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-124-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1741\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1742\"><span class=\"mi\" id=\"MathJax-Span-1743\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-124\">y</script>‚Äîand the highest-valued trace or ensemble of top traces is selected as the model‚Äôs output.</p>\n  </li>\n</ul>\n<p><strong>Monte Carlo Tree Search (MCTS)-based reasoning</strong> refines search-based reasoning by using <strong>stochastic simulations</strong> to balance exploration and exploitation over the reasoning space. Each node in the search tree represents a <em>partial reasoning trace</em> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-112-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1552\" style=\"width: 9.638em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1007.97em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1553\"><span class=\"msubsup\" id=\"MathJax-Span-1554\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1555\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1556\"><span class=\"mrow\" id=\"MathJax-Span-1557\"><span class=\"mn\" id=\"MathJax-Span-1558\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1559\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1560\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1561\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-1562\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1563\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1564\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-1565\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1566\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1567\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1568\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-1569\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1570\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-1571\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-1572\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1573\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1574\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1575\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1576\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-112\">z_{1:t} = (z_1, z_2, \\ldots, z_t)</script>, and edges represent possible next reasoning steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-113-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1577\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.51em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1578\"><span class=\"msubsup\" id=\"MathJax-Span-1579\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1580\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1581\"><span class=\"mrow\" id=\"MathJax-Span-1582\"><span class=\"mi\" id=\"MathJax-Span-1583\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1584\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-1585\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-113\">z_{t+1}</script>. Unlike simple breadth-first or depth-first traversal, MCTS uses probabilistic sampling to explore promising reasoning branches while still allocating some computation to less-visited ones, ensuring a balance between <strong>discovering new reasoning paths</strong> and <strong>refining strong candidates</strong>.</p>\n<p>Formally, reasoning unfolds as a growing search tree <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-114-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1586\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.94em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1587\"><span class=\"texatom\" id=\"MathJax-Span-1588\"><span class=\"mrow\" id=\"MathJax-Span-1589\"><span class=\"mi\" id=\"MathJax-Span-1590\" style=\"font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.211em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-114\">\\mathcal{T}</script>:</p>\n<ul>\n      <li>where the <strong>Expand</strong> step is guided by the LLM‚Äôs conditional distribution <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-116-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1638\" style=\"width: 7.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1006.15em, 2.659em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1639\"><span class=\"msubsup\" id=\"MathJax-Span-1640\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1641\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1642\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1643\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1644\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1645\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1646\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1647\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1648\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1649\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1650\"><span class=\"mrow\" id=\"MathJax-Span-1651\"><span class=\"mn\" id=\"MathJax-Span-1652\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1653\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1654\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1655\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-1656\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1657\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1658\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1659\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-116\">p_\\theta(z_t \\mid z_{1:t-1}, x)</script>, and the <strong>evaluation function</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-117-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1660\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1661\"><span class=\"msubsup\" id=\"MathJax-Span-1662\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1663\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1664\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1665\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1666\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1667\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1668\"><span class=\"mrow\" id=\"MathJax-Span-1669\"><span class=\"mn\" id=\"MathJax-Span-1670\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1671\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1672\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1673\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-117\">V_\\phi(z_{1:t})</script> estimates how promising each partial reasoning sequence is.</li>\n    </ul>\n<p>MCTS then uses <strong>simulated rollouts</strong>‚Äîpartial reasoning trajectories extended to completion‚Äîto estimate downstream rewards, which are <strong>backpropagated</strong> through the tree to update value and visit counts. The algorithm repeatedly selects nodes using an upper-confidence bound (UCB) criterion that trades off exploration and exploitation:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-119-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1716\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1717\"><span class=\"mi\" id=\"MathJax-Span-1718\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-1719\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1720\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1721\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1722\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1723\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-119\">Q(s, a)</script> is the average reward for taking reasoning step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-120-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1724\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1725\"><span class=\"mi\" id=\"MathJax-Span-1726\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-120\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-121-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1727\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1728\"><span class=\"mi\" id=\"MathJax-Span-1729\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-121\">s</script>, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-122-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1730\" style=\"width: 3.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.71em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1731\"><span class=\"mi\" id=\"MathJax-Span-1732\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1733\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1734\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1735\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1736\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1737\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>N</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-122\">N(s, a)</script> the number of visits, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-123-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1738\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1739\"><span class=\"mi\" id=\"MathJax-Span-1740\" style=\"font-family: STIXGeneral-Italic;\">c</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>c</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-123\">c</script> a temperature constant controlling exploration.</li>\n    </ul>\n<p>This process continues until reasoning trajectories reach terminal states‚Äîcomplete solutions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-124-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1741\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1742\"><span class=\"mi\" id=\"MathJax-Span-1743\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-124\">y</script>‚Äîand the highest-valued trace or ensemble of top traces is selected as the model‚Äôs output.</p>\n<h4 id=\"mechanism-5\">Mechanism</h4>\n<ol>\n  <li>\n    <p><strong>Selection</strong>: From the root node, traverse the tree by selecting the child that maximizes the <strong>UCB</strong> criterion, balancing high-value and underexplored reasoning branches.</p>\n  </li>\n  <li>\n    <p><strong>Expansion</strong>: When an underexplored node is reached, the model generates several possible next reasoning steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-125-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>z</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>&amp;#x223C;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1744\" style=\"width: 16.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.909em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1013.86em, 2.659em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1745\"><span class=\"msubsup\" id=\"MathJax-Span-1746\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1747\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1748\"><span class=\"mrow\" id=\"MathJax-Span-1749\"><span class=\"mo\" id=\"MathJax-Span-1750\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-1751\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1752\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1753\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1754\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1755\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1756\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1757\"><span class=\"mrow\" id=\"MathJax-Span-1758\"><span class=\"mo\" id=\"MathJax-Span-1759\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-1760\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span class=\"mo\" id=\"MathJax-Span-1761\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1762\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1763\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-1764\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-1765\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1766\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1767\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1768\"><span class=\"mrow\" id=\"MathJax-Span-1769\"><span class=\"mo\" id=\"MathJax-Span-1770\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1771\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">b</span><span class=\"mo\" id=\"MathJax-Span-1772\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1773\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1774\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-1775\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1776\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1777\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1778\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1779\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1780\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1781\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1782\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1783\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1784\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1785\"><span class=\"mrow\" id=\"MathJax-Span-1786\"><span class=\"mn\" id=\"MathJax-Span-1787\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1788\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1789\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1790\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-1791\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1792\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1793\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1794\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>z</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>‚àº</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-125\">z_t^{(1)}, z_t^{(2)}, \\ldots, z_t^{(b)} \\sim p_\\theta(z_t \\mid z_{1:t-1}, x)</script>, forming new branches for exploration.</p>\n  </li>\n  <li>\n    <p><strong>Simulation (Rollout)</strong>: The model continues reasoning (deterministically or stochastically) until reaching a terminal output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-126-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1795\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1796\"><span class=\"mi\" id=\"MathJax-Span-1797\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-126\">y</script>, producing a full reasoning chain <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-127-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1798\" style=\"width: 1.773em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.46em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1799\"><span class=\"msubsup\" id=\"MathJax-Span-1800\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1801\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1802\"><span class=\"mrow\" id=\"MathJax-Span-1803\"><span class=\"mn\" id=\"MathJax-Span-1804\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1805\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1806\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-127\">z_{1:T}</script>.</p>\n  </li>\n  <li>\n    <p><strong>Evaluation</strong>: The resulting trace is scored via a <strong>value estimator</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-128-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1807\" style=\"width: 3.961em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.284em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.23em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1808\"><span class=\"msubsup\" id=\"MathJax-Span-1809\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1810\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1811\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1812\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1813\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1814\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1815\"><span class=\"mrow\" id=\"MathJax-Span-1816\"><span class=\"mn\" id=\"MathJax-Span-1817\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1818\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1819\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1820\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-128\">V_\\phi(z_{1:T})</script> or a domain-specific verifier (e.g., math correctness, code execution success).</p>\n  </li>\n  <li>\n    <p><strong>Backpropagation</strong>: The value score is propagated upward, updating <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-129-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1821\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1822\"><span class=\"mi\" id=\"MathJax-Span-1823\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-1824\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1825\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1826\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1827\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1828\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-129\">Q(s, a)</script> and visit counts <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-130-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1829\" style=\"width: 3.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.71em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1830\"><span class=\"mi\" id=\"MathJax-Span-1831\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1832\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1833\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1834\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1835\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1836\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>N</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-130\">N(s, a)</script> along the path, gradually refining the search policy.</p>\n  </li>\n  <li>\n    <p><strong>Selection of Final Output</strong>: After sufficient iterations, the reasoning path with the highest cumulative value (or visit count) is chosen as the final answer.</p>\n  </li>\n</ol>\n<p><strong>Selection</strong>: From the root node, traverse the tree by selecting the child that maximizes the <strong>UCB</strong> criterion, balancing high-value and underexplored reasoning branches.</p>\n<p><strong>Expansion</strong>: When an underexplored node is reached, the model generates several possible next reasoning steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-125-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>z</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>&amp;#x223C;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1744\" style=\"width: 16.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.909em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1013.86em, 2.659em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1745\"><span class=\"msubsup\" id=\"MathJax-Span-1746\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1747\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1748\"><span class=\"mrow\" id=\"MathJax-Span-1749\"><span class=\"mo\" id=\"MathJax-Span-1750\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-1751\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1752\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1753\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1754\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1755\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1756\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1757\"><span class=\"mrow\" id=\"MathJax-Span-1758\"><span class=\"mo\" id=\"MathJax-Span-1759\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-1760\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span class=\"mo\" id=\"MathJax-Span-1761\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1762\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1763\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-1764\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-1765\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1766\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1767\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.477em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1768\"><span class=\"mrow\" id=\"MathJax-Span-1769\"><span class=\"mo\" id=\"MathJax-Span-1770\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1771\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">b</span><span class=\"mo\" id=\"MathJax-Span-1772\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1773\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1774\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-1775\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1776\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1777\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1778\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1779\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1780\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1781\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1782\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1783\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1784\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1785\"><span class=\"mrow\" id=\"MathJax-Span-1786\"><span class=\"mn\" id=\"MathJax-Span-1787\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1788\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1789\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1790\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-1791\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1792\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1793\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1794\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>z</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msubsup><mi>z</mi><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>‚àº</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-125\">z_t^{(1)}, z_t^{(2)}, \\ldots, z_t^{(b)} \\sim p_\\theta(z_t \\mid z_{1:t-1}, x)</script>, forming new branches for exploration.</p>\n<p><strong>Simulation (Rollout)</strong>: The model continues reasoning (deterministically or stochastically) until reaching a terminal output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-126-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1795\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1796\"><span class=\"mi\" id=\"MathJax-Span-1797\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-126\">y</script>, producing a full reasoning chain <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-127-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1798\" style=\"width: 1.773em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.46em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1799\"><span class=\"msubsup\" id=\"MathJax-Span-1800\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1801\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1802\"><span class=\"mrow\" id=\"MathJax-Span-1803\"><span class=\"mn\" id=\"MathJax-Span-1804\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1805\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1806\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-127\">z_{1:T}</script>.</p>\n<p><strong>Evaluation</strong>: The resulting trace is scored via a <strong>value estimator</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-128-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1807\" style=\"width: 3.961em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.284em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.23em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1808\"><span class=\"msubsup\" id=\"MathJax-Span-1809\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1810\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1811\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1812\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1813\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1814\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1815\"><span class=\"mrow\" id=\"MathJax-Span-1816\"><span class=\"mn\" id=\"MathJax-Span-1817\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1818\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1819\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1820\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-128\">V_\\phi(z_{1:T})</script> or a domain-specific verifier (e.g., math correctness, code execution success).</p>\n<p><strong>Backpropagation</strong>: The value score is propagated upward, updating <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-129-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1821\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1822\"><span class=\"mi\" id=\"MathJax-Span-1823\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-1824\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1825\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1826\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1827\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1828\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-129\">Q(s, a)</script> and visit counts <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-130-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1829\" style=\"width: 3.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.71em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1830\"><span class=\"mi\" id=\"MathJax-Span-1831\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1832\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1833\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1834\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1835\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1836\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>N</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-130\">N(s, a)</script> along the path, gradually refining the search policy.</p>\n<p><strong>Selection of Final Output</strong>: After sufficient iterations, the reasoning path with the highest cumulative value (or visit count) is chosen as the final answer.</p>\n<h4 id=\"theoretical-framing-1\">Theoretical Framing</h4>\n<ul>\n  <li>\n    <p>MCTS-based reasoning can be interpreted as an <strong>approximate Bayesian inference</strong> mechanism, marginalizing over reasoning paths by repeated stochastic sampling and value-based weighting. It formalizes reasoning as a <strong>policy‚Äìvalue system</strong>:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-131-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo>,</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mi>R</mi><mo>&amp;#x2223;</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1837\" style=\"width: 21.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 17.867em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1017.76em, 2.815em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1838\"><span class=\"msubsup\" id=\"MathJax-Span-1839\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1840\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1841\"><span class=\"mrow\" id=\"MathJax-Span-1842\"><span class=\"mi\" id=\"MathJax-Span-1843\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1844\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-1845\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1846\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-1847\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1848\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1849\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1850\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1851\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1852\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1853\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1854\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1855\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1856\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1857\"><span class=\"mrow\" id=\"MathJax-Span-1858\"><span class=\"mn\" id=\"MathJax-Span-1859\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1860\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1861\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1862\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1863\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1864\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1865\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-1866\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-1867\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1868\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1869\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1870\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1871\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1872\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1873\"><span class=\"mrow\" id=\"MathJax-Span-1874\"><span class=\"mn\" id=\"MathJax-Span-1875\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1876\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1877\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1878\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1879\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"texatom\" id=\"MathJax-Span-1880\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-1881\"><span class=\"mi\" id=\"MathJax-Span-1882\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span class=\"mo\" id=\"MathJax-Span-1883\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-1884\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-1885\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1886\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1887\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1888\"><span class=\"mrow\" id=\"MathJax-Span-1889\"><span class=\"mn\" id=\"MathJax-Span-1890\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-1891\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-1892\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1893\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>‚àº</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mspace width=\"1em\"></mspace><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚âà</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mo stretchy=\"false\">[</mo><mi>R</mi><mo>‚à£</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-131\">z_{t+1} \\sim \\pi_\\theta(z_t \\mid z_{1:t}, x), \\quad V_\\phi(z_{1:t}) \\approx \\mathbb{E}[R \\mid z_{1:t}]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-132-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1894\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1895\"><span class=\"msubsup\" id=\"MathJax-Span-1896\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1897\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1898\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-132\">\\pi_\\theta</script> is the reasoning policy and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-133-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1899\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1900\"><span class=\"msubsup\" id=\"MathJax-Span-1901\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1902\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1903\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-133\">V_\\phi</script> the expected reward estimator.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This structure directly parallels <strong>AlphaZero</strong>-style planning in RL: reasoning steps are ‚Äúmoves,‚Äù the value function measures progress toward correctness, and search iterations improve reasoning through <strong>self-guided exploration</strong>.</p>\n  </li>\n</ul>\n<p>MCTS-based reasoning can be interpreted as an <strong>approximate Bayesian inference</strong> mechanism, marginalizing over reasoning paths by repeated stochastic sampling and value-based weighting. It formalizes reasoning as a <strong>policy‚Äìvalue system</strong>:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-132-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1894\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1895\"><span class=\"msubsup\" id=\"MathJax-Span-1896\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1897\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1898\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-132\">\\pi_\\theta</script> is the reasoning policy and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-133-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1899\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1900\"><span class=\"msubsup\" id=\"MathJax-Span-1901\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1902\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1903\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-133\">V_\\phi</script> the expected reward estimator.</li>\n    </ul>\n<p>This structure directly parallels <strong>AlphaZero</strong>-style planning in RL: reasoning steps are ‚Äúmoves,‚Äù the value function measures progress toward correctness, and search iterations improve reasoning through <strong>self-guided exploration</strong>.</p>\n<h4 id=\"example-mathematical-problem-solving\">Example: Mathematical Problem Solving</h4>\n<ul>\n  <li>\n    <p>Consider a geometry proof question. A linear CoT might pursue a single argument, but an MCTS-based reasoner could simulate multiple reasoning directions:</p>\n\n    <ul>\n      <li><strong>Branch A:</strong> Attempt to derive relations via similar triangles.</li>\n      <li><strong>Branch B:</strong> Substitute coordinates and apply algebraic constraints.</li>\n      <li><strong>Branch C:</strong> Explore symmetry arguments for simplification.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Each branch is evaluated through rollouts‚Äîchecking consistency or partial correctness‚Äîand promising directions are expanded further, while unproductive branches are pruned. Over multiple iterations, the search converges on the most coherent reasoning trace, yielding deliberate and explainable reasoning rather than heuristic guessing.</p>\n  </li>\n</ul>\n<p>Consider a geometry proof question. A linear CoT might pursue a single argument, but an MCTS-based reasoner could simulate multiple reasoning directions:</p>\n<ul>\n      <li><strong>Branch A:</strong> Attempt to derive relations via similar triangles.</li>\n      <li><strong>Branch B:</strong> Substitute coordinates and apply algebraic constraints.</li>\n      <li><strong>Branch C:</strong> Explore symmetry arguments for simplification.</li>\n    </ul>\n<p>Each branch is evaluated through rollouts‚Äîchecking consistency or partial correctness‚Äîand promising directions are expanded further, while unproductive branches are pruned. Over multiple iterations, the search converges on the most coherent reasoning trace, yielding deliberate and explainable reasoning rather than heuristic guessing.</p>\n<h4 id=\"variants-and-extensions\">Variants and Extensions</h4>\n<ol>\n  <li><strong>LLM-MCTS (Yao et al. (2024))</strong>: Combines MCTS with Tree-of-Thought reasoning, using the LLM both for expansion and value estimation.</li>\n  <li><strong>Verifier-Guided MCTS</strong>: Integrates external verifiers to provide precise reward signals at rollout, improving pruning accuracy.</li>\n  <li><strong>Value-Guided MCTS</strong>: Employs a trained value model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-134-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1904\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1905\"><span class=\"msubsup\" id=\"MathJax-Span-1906\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1907\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1908\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-134\">V_\\phi</script> (similar to process reward models) to estimate reasoning quality before rollout.</li>\n  <li><strong>Hybrid Planning Frameworks</strong>: Combine symbolic planners (A*, BFS) with MCTS exploration to scale reasoning in code, logic, or multi-agent environments.</li>\n</ol>\n<h4 id=\"advantages-5\">Advantages</h4>\n<ul>\n  <li>Balances <strong>exploration and exploitation</strong>, avoiding premature convergence.</li>\n  <li>Can discover <strong>nonlinear, multi-path reasoning solutions</strong>.</li>\n  <li>Scales naturally to complex reasoning where evaluating partial progress is feasible.</li>\n  <li>Compatible with <strong>verifier-guided</strong> or <strong>reward-shaped</strong> supervision, enabling hybrid reasoning pipelines.</li>\n</ul>\n<h4 id=\"limitations-5\">Limitations</h4>\n<ul>\n  <li><strong>High computational cost</strong>: repeated rollouts and evaluations are expensive.</li>\n  <li><strong>Value-model sensitivity</strong>: incorrect scoring can misdirect exploration.</li>\n  <li><strong>Context window saturation</strong>: maintaining multiple partial traces taxes memory.</li>\n  <li><strong>Diminishing returns</strong>: excessive exploration may not improve accuracy proportionally.</li>\n</ul>\n<h4 id=\"relationship-to-other-reasoning-methods\">Relationship to Other Reasoning Methods</h4>\n<ul>\n  <li>MCTS generalizes <strong>Tree-of-Thoughts (ToT)</strong> by adding quantitative evaluation and stochastic rollouts, bridging symbolic search and probabilistic reasoning.</li>\n  <li>It operationalizes <strong>planning in reasoning space</strong>, complementing <strong>RL-based reasoning</strong> (which learns heuristics) and <strong>Self-Consistency decoding</strong> (which averages independent samples rather than guided rollouts).</li>\n  <li>Conceptually, MCTS moves LLM reasoning closer to <strong>explicit deliberation and decision-making</strong>, marking a key step from <strong>narrative reasoning</strong> toward <strong>search-based intelligence</strong>.</li>\n</ul>",
    "contentMarkdown": "#### Core Idea\n\n*   **Monte Carlo Tree Search (MCTS)-based reasoning** refines search-based reasoning by using **stochastic simulations** to balance exploration and exploitation over the reasoning space. Each node in the search tree represents a _partial reasoning trace_ z1:t\\=(z1,z2,‚Ä¶,zt)z1:t\\=(z1,z2,‚Ä¶,zt)z\\_{1:t} = (z\\_1, z\\_2, \\\\ldots, z\\_t), and edges represent possible next reasoning steps zt+1zt+1z\\_{t+1}. Unlike simple breadth-first or depth-first traversal, MCTS uses probabilistic sampling to explore promising reasoning branches while still allocating some computation to less-visited ones, ensuring a balance between **discovering new reasoning paths** and **refining strong candidates**.\n    \n*   Formally, reasoning unfolds as a growing search tree ÓâÄT\\\\mathcal{T}:\n    \n    ÓâÄ\\=z1:t‚à£z1:t‚àí1‚ààÓâÄ,¬†zt‚ààExpand(z1:t‚àí1)T\\=z1:t‚à£z1:t‚àí1‚ààT,¬†zt‚ààExpand(z1:t‚àí1)\n    \n    \\\\mathcal{T} = { z\\_{1:t} \\\\mid z\\_{1:t-1} \\\\in \\\\mathcal{T},\\\\ z\\_t \\\\in \\\\text{Expand}(z\\_{1:t-1}) }\n    *   where the **Expand** step is guided by the LLM‚Äôs conditional distribution pŒ∏(zt‚à£z1:t‚àí1,x)pŒ∏(zt‚à£z1:t‚àí1,x)p\\_\\\\theta(z\\_t \\\\mid z\\_{1:t-1}, x), and the **evaluation function** Vœï(z1:t)Vœï(z1:t)V\\_\\\\phi(z\\_{1:t}) estimates how promising each partial reasoning sequence is.\n*   MCTS then uses **simulated rollouts**‚Äîpartial reasoning trajectories extended to completion‚Äîto estimate downstream rewards, which are **backpropagated** through the tree to update value and visit counts. The algorithm repeatedly selects nodes using an upper-confidence bound (UCB) criterion that trades off exploration and exploitation:\n    \n    a‚àó\\=argmaxa(Q(s,a)+clogN(s)N(s,a)+1‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚àö)a‚àó\\=arg‚Å°maxa(Q(s,a)+clog‚Å°N(s)N(s,a)+1)\n    \n    a^\\* = \\\\arg\\\\max\\_a \\\\left( Q(s, a) + c \\\\sqrt{\\\\frac{\\\\log N(s)}{N(s, a) + 1}} \\\\right)\n    *   where Q(s,a)Q(s,a)Q(s, a) is the average reward for taking reasoning step aaa in state sss, N(s,a)N(s,a)N(s, a) the number of visits, and ccc a temperature constant controlling exploration.\n*   This process continues until reasoning trajectories reach terminal states‚Äîcomplete solutions yyy‚Äîand the highest-valued trace or ensemble of top traces is selected as the model‚Äôs output.\n    \n\n**Monte Carlo Tree Search (MCTS)-based reasoning** refines search-based reasoning by using **stochastic simulations** to balance exploration and exploitation over the reasoning space. Each node in the search tree represents a _partial reasoning trace_ z1:t\\=(z1,z2,‚Ä¶,zt)z1:t\\=(z1,z2,‚Ä¶,zt)z\\_{1:t} = (z\\_1, z\\_2, \\\\ldots, z\\_t), and edges represent possible next reasoning steps zt+1zt+1z\\_{t+1}. Unlike simple breadth-first or depth-first traversal, MCTS uses probabilistic sampling to explore promising reasoning branches while still allocating some computation to less-visited ones, ensuring a balance between **discovering new reasoning paths** and **refining strong candidates**.\n\nFormally, reasoning unfolds as a growing search tree ÓâÄT\\\\mathcal{T}:\n\n*   where the **Expand** step is guided by the LLM‚Äôs conditional distribution pŒ∏(zt‚à£z1:t‚àí1,x)pŒ∏(zt‚à£z1:t‚àí1,x)p\\_\\\\theta(z\\_t \\\\mid z\\_{1:t-1}, x), and the **evaluation function** Vœï(z1:t)Vœï(z1:t)V\\_\\\\phi(z\\_{1:t}) estimates how promising each partial reasoning sequence is.\n\nMCTS then uses **simulated rollouts**‚Äîpartial reasoning trajectories extended to completion‚Äîto estimate downstream rewards, which are **backpropagated** through the tree to update value and visit counts. The algorithm repeatedly selects nodes using an upper-confidence bound (UCB) criterion that trades off exploration and exploitation:\n\n*   where Q(s,a)Q(s,a)Q(s, a) is the average reward for taking reasoning step aaa in state sss, N(s,a)N(s,a)N(s, a) the number of visits, and ccc a temperature constant controlling exploration.\n\nThis process continues until reasoning trajectories reach terminal states‚Äîcomplete solutions yyy‚Äîand the highest-valued trace or ensemble of top traces is selected as the model‚Äôs output.\n\n#### Mechanism\n\n1.  **Selection**: From the root node, traverse the tree by selecting the child that maximizes the **UCB** criterion, balancing high-value and underexplored reasoning branches.\n    \n2.  **Expansion**: When an underexplored node is reached, the model generates several possible next reasoning steps z(1)t,z(2)t,‚Ä¶,z(b)t‚àºpŒ∏(zt‚à£z1:t‚àí1,x)zt(1),zt(2),‚Ä¶,zt(b)‚àºpŒ∏(zt‚à£z1:t‚àí1,x)z\\_t^{(1)}, z\\_t^{(2)}, \\\\ldots, z\\_t^{(b)} \\\\sim p\\_\\\\theta(z\\_t \\\\mid z\\_{1:t-1}, x), forming new branches for exploration.\n    \n3.  **Simulation (Rollout)**: The model continues reasoning (deterministically or stochastically) until reaching a terminal output yyy, producing a full reasoning chain z1:Tz1:Tz\\_{1:T}.\n    \n4.  **Evaluation**: The resulting trace is scored via a **value estimator** Vœï(z1:T)Vœï(z1:T)V\\_\\\\phi(z\\_{1:T}) or a domain-specific verifier (e.g., math correctness, code execution success).\n    \n5.  **Backpropagation**: The value score is propagated upward, updating Q(s,a)Q(s,a)Q(s, a) and visit counts N(s,a)N(s,a)N(s, a) along the path, gradually refining the search policy.\n    \n6.  **Selection of Final Output**: After sufficient iterations, the reasoning path with the highest cumulative value (or visit count) is chosen as the final answer.\n    \n\n**Selection**: From the root node, traverse the tree by selecting the child that maximizes the **UCB** criterion, balancing high-value and underexplored reasoning branches.\n\n**Expansion**: When an underexplored node is reached, the model generates several possible next reasoning steps z(1)t,z(2)t,‚Ä¶,z(b)t‚àºpŒ∏(zt‚à£z1:t‚àí1,x)zt(1),zt(2),‚Ä¶,zt(b)‚àºpŒ∏(zt‚à£z1:t‚àí1,x)z\\_t^{(1)}, z\\_t^{(2)}, \\\\ldots, z\\_t^{(b)} \\\\sim p\\_\\\\theta(z\\_t \\\\mid z\\_{1:t-1}, x), forming new branches for exploration.\n\n**Simulation (Rollout)**: The model continues reasoning (deterministically or stochastically) until reaching a terminal output yyy, producing a full reasoning chain z1:Tz1:Tz\\_{1:T}.\n\n**Evaluation**: The resulting trace is scored via a **value estimator** Vœï(z1:T)Vœï(z1:T)V\\_\\\\phi(z\\_{1:T}) or a domain-specific verifier (e.g., math correctness, code execution success).\n\n**Backpropagation**: The value score is propagated upward, updating Q(s,a)Q(s,a)Q(s, a) and visit counts N(s,a)N(s,a)N(s, a) along the path, gradually refining the search policy.\n\n**Selection of Final Output**: After sufficient iterations, the reasoning path with the highest cumulative value (or visit count) is chosen as the final answer.\n\n#### Theoretical Framing\n\n*   MCTS-based reasoning can be interpreted as an **approximate Bayesian inference** mechanism, marginalizing over reasoning paths by repeated stochastic sampling and value-based weighting. It formalizes reasoning as a **policy‚Äìvalue system**:\n    \n    zt+1‚àºœÄŒ∏(zt‚à£z1:t,x),Vœï(z1:t)‚âàùîº\\[R‚à£z1:t\\]zt+1‚àºœÄŒ∏(zt‚à£z1:t,x),Vœï(z1:t)‚âàE\\[R‚à£z1:t\\]\n    \n    z\\_{t+1} \\\\sim \\\\pi\\_\\\\theta(z\\_t \\\\mid z\\_{1:t}, x), \\\\quad V\\_\\\\phi(z\\_{1:t}) \\\\approx \\\\mathbb{E}\\[R \\\\mid z\\_{1:t}\\]\n    *   where œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta is the reasoning policy and VœïVœïV\\_\\\\phi the expected reward estimator.\n*   This structure directly parallels **AlphaZero**\\-style planning in RL: reasoning steps are ‚Äúmoves,‚Äù the value function measures progress toward correctness, and search iterations improve reasoning through **self-guided exploration**.\n    \n\nMCTS-based reasoning can be interpreted as an **approximate Bayesian inference** mechanism, marginalizing over reasoning paths by repeated stochastic sampling and value-based weighting. It formalizes reasoning as a **policy‚Äìvalue system**:\n\n*   where œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta is the reasoning policy and VœïVœïV\\_\\\\phi the expected reward estimator.\n\nThis structure directly parallels **AlphaZero**\\-style planning in RL: reasoning steps are ‚Äúmoves,‚Äù the value function measures progress toward correctness, and search iterations improve reasoning through **self-guided exploration**.\n\n#### Example: Mathematical Problem Solving\n\n*   Consider a geometry proof question. A linear CoT might pursue a single argument, but an MCTS-based reasoner could simulate multiple reasoning directions:\n    \n    *   **Branch A:** Attempt to derive relations via similar triangles.\n    *   **Branch B:** Substitute coordinates and apply algebraic constraints.\n    *   **Branch C:** Explore symmetry arguments for simplification.\n*   Each branch is evaluated through rollouts‚Äîchecking consistency or partial correctness‚Äîand promising directions are expanded further, while unproductive branches are pruned. Over multiple iterations, the search converges on the most coherent reasoning trace, yielding deliberate and explainable reasoning rather than heuristic guessing.\n    \n\nConsider a geometry proof question. A linear CoT might pursue a single argument, but an MCTS-based reasoner could simulate multiple reasoning directions:\n\n*   **Branch A:** Attempt to derive relations via similar triangles.\n*   **Branch B:** Substitute coordinates and apply algebraic constraints.\n*   **Branch C:** Explore symmetry arguments for simplification.\n\nEach branch is evaluated through rollouts‚Äîchecking consistency or partial correctness‚Äîand promising directions are expanded further, while unproductive branches are pruned. Over multiple iterations, the search converges on the most coherent reasoning trace, yielding deliberate and explainable reasoning rather than heuristic guessing.\n\n#### Variants and Extensions\n\n1.  **LLM-MCTS (Yao et al. (2024))**: Combines MCTS with Tree-of-Thought reasoning, using the LLM both for expansion and value estimation.\n2.  **Verifier-Guided MCTS**: Integrates external verifiers to provide precise reward signals at rollout, improving pruning accuracy.\n3.  **Value-Guided MCTS**: Employs a trained value model VœïVœïV\\_\\\\phi (similar to process reward models) to estimate reasoning quality before rollout.\n4.  **Hybrid Planning Frameworks**: Combine symbolic planners (A\\*, BFS) with MCTS exploration to scale reasoning in code, logic, or multi-agent environments.\n\n#### Advantages\n\n*   Balances **exploration and exploitation**, avoiding premature convergence.\n*   Can discover **nonlinear, multi-path reasoning solutions**.\n*   Scales naturally to complex reasoning where evaluating partial progress is feasible.\n*   Compatible with **verifier-guided** or **reward-shaped** supervision, enabling hybrid reasoning pipelines.\n\n#### Limitations\n\n*   **High computational cost**: repeated rollouts and evaluations are expensive.\n*   **Value-model sensitivity**: incorrect scoring can misdirect exploration.\n*   **Context window saturation**: maintaining multiple partial traces taxes memory.\n*   **Diminishing returns**: excessive exploration may not improve accuracy proportionally.\n\n#### Relationship to Other Reasoning Methods\n\n*   MCTS generalizes **Tree-of-Thoughts (ToT)** by adding quantitative evaluation and stochastic rollouts, bridging symbolic search and probabilistic reasoning.\n*   It operationalizes **planning in reasoning space**, complementing **RL-based reasoning** (which learns heuristics) and **Self-Consistency decoding** (which averages independent samples rather than guided rollouts).\n*   Conceptually, MCTS moves LLM reasoning closer to **explicit deliberation and decision-making**, marking a key step from **narrative reasoning** toward **search-based intelligence**.",
    "order": 16,
    "orderInChapter": 2,
    "difficulty": 5,
    "estimatedMinutes": 7,
    "tags": [
      "nlpllms",
      "llm",
      "backpropagation"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 1333,
      "contentLength": 150879
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#monte-carlo-tree-search-(mcts)-based-reasoning",
    "scrapedAt": "2025-12-28T11:54:00.655Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-react-reason-and-act-framework-17",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Tool-Augmented Reasoning",
    "title": "ReAct: Reason and Act Framework",
    "subtitle": "Tool-Augmented Reasoning",
    "contentHtml": "<h4 id=\"core-idea-5\">Core Idea</h4>\n<ul>\n  <li>\n    <p><em>ReAct</em> (Reason + Act) introduces a structured reasoning framework in which language models <strong>interleave internal reasoning (‚Äúthoughts‚Äù) with external actions (‚Äúacts‚Äù)</strong>. Rather than producing a single reasoning chain internally, the model alternates between cognitive reasoning steps and environment interactions, enabling active exploration, retrieval, and verification.</p>\n  </li>\n  <li>\n    <p>This concept was formalized in <em>ReAct: Synergizing Reasoning and Acting in Language Models</em> by <a href=\"https://arxiv.org/abs/2210.03629\">Yao et al. (2022)</a>, where an LLM engages in iterative cycles of <strong>thinking</strong>, <strong>acting</strong>, and <strong>observing</strong>, following the trajectory:</p>\n  </li>\n</ul>\n<p><em>ReAct</em> (Reason + Act) introduces a structured reasoning framework in which language models <strong>interleave internal reasoning (‚Äúthoughts‚Äù) with external actions (‚Äúacts‚Äù)</strong>. Rather than producing a single reasoning chain internally, the model alternates between cognitive reasoning steps and environment interactions, enabling active exploration, retrieval, and verification.</p>\n<p>This concept was formalized in <em>ReAct: Synergizing Reasoning and Acting in Language Models</em> by <a href=\"https://arxiv.org/abs/2210.03629\">Yao et al. (2022)</a>, where an LLM engages in iterative cycles of <strong>thinking</strong>, <strong>acting</strong>, and <strong>observing</strong>, following the trajectory:</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-138-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>x</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mtext>Thought</mtext><mn>1</mn></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mtext>Action</mtext><mn>1</mn></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mtext>Observation</mtext><mn>1</mn></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mtext>Thought</mtext><mn>2</mn></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msub><mtext>Action</mtext><mn>2</mn></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mo>&amp;#x22EF;</mo><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mi>y</mi></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1978\" style=\"width: 39.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 32.607em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1032.61em, 2.815em, -999.997em); top: -2.393em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1979\"><span class=\"mi\" id=\"MathJax-Span-1980\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1981\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-1982\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.39em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-1983\" style=\"font-family: STIXGeneral-Regular;\">Thought</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.747em; left: 3.388em;\"><span class=\"mn\" id=\"MathJax-Span-1984\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1985\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-1986\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1002.71em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-1987\" style=\"font-family: STIXGeneral-Regular;\">Action</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 2.711em;\"><span class=\"mn\" id=\"MathJax-Span-1988\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1989\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-1990\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 5.315em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1004.9em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-1991\" style=\"font-family: STIXGeneral-Regular;\">Observation</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 4.898em;\"><span class=\"mn\" id=\"MathJax-Span-1992\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1993\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-1994\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.39em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-1995\" style=\"font-family: STIXGeneral-Regular;\">Thought</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.747em; left: 3.388em;\"><span class=\"mn\" id=\"MathJax-Span-1996\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1997\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"msubsup\" id=\"MathJax-Span-1998\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1002.71em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-1999\" style=\"font-family: STIXGeneral-Regular;\">Action</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 2.711em;\"><span class=\"mn\" id=\"MathJax-Span-2000\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2001\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"mo\" id=\"MathJax-Span-2002\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚ãØ</span><span class=\"mo\" id=\"MathJax-Span-2003\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"mi\" id=\"MathJax-Span-2004\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.398em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>x</mi><mo stretchy=\"false\">‚Üí</mo><msub><mtext>Thought</mtext><mn>1</mn></msub><mo stretchy=\"false\">‚Üí</mo><msub><mtext>Action</mtext><mn>1</mn></msub><mo stretchy=\"false\">‚Üí</mo><msub><mtext>Observation</mtext><mn>1</mn></msub><mo stretchy=\"false\">‚Üí</mo><msub><mtext>Thought</mtext><mn>2</mn></msub><mo stretchy=\"false\">‚Üí</mo><msub><mtext>Action</mtext><mn>2</mn></msub><mo stretchy=\"false\">‚Üí</mo><mo>‚ãØ</mo><mo stretchy=\"false\">‚Üí</mo><mi>y</mi></math></span></span></div>\n<ul>\n  <li>Each thought is an internal deliberation; each action interacts with an external environment (e.g., a search query or calculator call); and each observation provides feedback that informs the next reasoning step.</li>\n</ul>\n<h4 id=\"mechanism-6\">Mechanism</h4>\n<ol>\n  <li><strong>Prompt Structure</strong>:\n    <ul>\n      <li>The model is trained or prompted to alternate explicitly between ‚ÄúThought:‚Äù and ‚ÄúAction:‚Äù stages.</li>\n      <li>Example:</li>\n    </ul>\n\n    <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><div><button class=\"btn-copy\" data-clipboard-action=\"copy\" data-clipboard-target=\"#code1\"><img src=\"https://aman.ai/images/copy.png\" style=\"margin:0; border:none; padding:2px 0px; width:100%; height:18px; width:18px;\"></button></div><code id=\"code1\">Thought: I should verify this fact.\nAction: search(\"When was the Theory of Relativity proposed?\")\nObservation: 1905.\nThought: That confirms Einstein‚Äôs 1905 paper.\n</code></pre></div>    </div>\n  </li>\n  <li><strong>Execution and Feedback</strong>:\n    <ul>\n      <li>Each ‚ÄúAction‚Äù triggers a system-level call (search, API, or computation). The resulting observation is appended to the prompt context, grounding the model‚Äôs next reasoning step.</li>\n    </ul>\n  </li>\n  <li><strong>Iterative Reasoning Loop</strong>:\n    <ul>\n      <li>\n        <p>This continues until the model converges on a final conclusion or the task‚Äôs stopping condition is met.</p>\n      </li>\n      <li>\n        <p>Formally, the reasoning trajectory is:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-139-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>&amp;#x03C4;</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>o</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2005\" style=\"width: 10.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.013em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1008.96em, 2.607em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2006\"><span class=\"mi\" id=\"MathJax-Span-2007\" style=\"font-family: STIXGeneral-Italic;\">œÑ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2008\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-2009\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"mi\" id=\"MathJax-Span-2010\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2011\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2012\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 4.794em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.65em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2013\"><span class=\"mrow\" id=\"MathJax-Span-2014\"><span class=\"mo\" id=\"MathJax-Span-2015\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2016\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.336em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2017\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2018\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2019\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2020\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2021\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2022\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2023\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2024\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2025\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2026\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2027\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -4.424em; left: 3.701em;\"><span class=\"mi\" id=\"MathJax-Span-2028\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.169em, -999.997em); top: -3.747em; left: 3.701em;\"><span class=\"texatom\" id=\"MathJax-Span-2029\"><span class=\"mrow\" id=\"MathJax-Span-2030\"><span class=\"mi\" id=\"MathJax-Span-2031\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-2032\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-2033\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2034\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2035\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-2036\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>œÑ</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>o</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-139\">\\tau = (x, {(t_i, a_i, o_i)}_{i=1}^T, y)</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-140-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2037\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.461em, 1000.58em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2038\"><span class=\"msubsup\" id=\"MathJax-Span-2039\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.336em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2040\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2041\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>t</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-140\">t_i</script> are reasoning traces, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-141-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2042\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2043\"><span class=\"msubsup\" id=\"MathJax-Span-2044\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2045\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2046\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-141\">a_i</script> are actions, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-142-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2047\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2048\"><span class=\"msubsup\" id=\"MathJax-Span-2049\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2050\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2051\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-142\">o_i</script> are observations.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n</ol>\n<ul>\n      <li>The model is trained or prompted to alternate explicitly between ‚ÄúThought:‚Äù and ‚ÄúAction:‚Äù stages.</li>\n      <li>Example:</li>\n    </ul>\n<pre class=\"highlight\"><div><button class=\"btn-copy\" data-clipboard-action=\"copy\" data-clipboard-target=\"#code1\"><img src=\"https://aman.ai/images/copy.png\" style=\"margin:0; border:none; padding:2px 0px; width:100%; height:18px; width:18px;\"></button></div><code id=\"code1\">Thought: I should verify this fact.\nAction: search(\"When was the Theory of Relativity proposed?\")\nObservation: 1905.\nThought: That confirms Einstein‚Äôs 1905 paper.\n</code></pre>\n<ul>\n      <li>Each ‚ÄúAction‚Äù triggers a system-level call (search, API, or computation). The resulting observation is appended to the prompt context, grounding the model‚Äôs next reasoning step.</li>\n    </ul>\n<ul>\n      <li>\n        <p>This continues until the model converges on a final conclusion or the task‚Äôs stopping condition is met.</p>\n      </li>\n      <li>\n        <p>Formally, the reasoning trajectory is:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-139-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>&amp;#x03C4;</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>o</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2005\" style=\"width: 10.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.013em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1008.96em, 2.607em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2006\"><span class=\"mi\" id=\"MathJax-Span-2007\" style=\"font-family: STIXGeneral-Italic;\">œÑ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2008\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-2009\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"mi\" id=\"MathJax-Span-2010\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2011\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2012\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 4.794em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.65em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2013\"><span class=\"mrow\" id=\"MathJax-Span-2014\"><span class=\"mo\" id=\"MathJax-Span-2015\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2016\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.336em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2017\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2018\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2019\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2020\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2021\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2022\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2023\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2024\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2025\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2026\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2027\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -4.424em; left: 3.701em;\"><span class=\"mi\" id=\"MathJax-Span-2028\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.169em, -999.997em); top: -3.747em; left: 3.701em;\"><span class=\"texatom\" id=\"MathJax-Span-2029\"><span class=\"mrow\" id=\"MathJax-Span-2030\"><span class=\"mi\" id=\"MathJax-Span-2031\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-2032\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-2033\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2034\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2035\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-2036\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>œÑ</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>o</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-139\">\\tau = (x, {(t_i, a_i, o_i)}_{i=1}^T, y)</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-140-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2037\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.461em, 1000.58em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2038\"><span class=\"msubsup\" id=\"MathJax-Span-2039\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.336em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2040\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2041\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>t</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-140\">t_i</script> are reasoning traces, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-141-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2042\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2043\"><span class=\"msubsup\" id=\"MathJax-Span-2044\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2045\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2046\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-141\">a_i</script> are actions, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-142-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2047\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2048\"><span class=\"msubsup\" id=\"MathJax-Span-2049\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2050\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2051\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-142\">o_i</script> are observations.</li>\n        </ul>\n      </li>\n    </ul>\n<p>This continues until the model converges on a final conclusion or the task‚Äôs stopping condition is met.</p>\n<p>Formally, the reasoning trajectory is:</p>\n<ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-140-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2037\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.461em, 1000.58em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2038\"><span class=\"msubsup\" id=\"MathJax-Span-2039\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.336em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2040\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2041\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>t</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-140\">t_i</script> are reasoning traces, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-141-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2042\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2043\"><span class=\"msubsup\" id=\"MathJax-Span-2044\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2045\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2046\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-141\">a_i</script> are actions, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-142-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2047\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2048\"><span class=\"msubsup\" id=\"MathJax-Span-2049\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2050\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2051\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-142\">o_i</script> are observations.</li>\n        </ul>\n<h4 id=\"theoretical-framing-2\">Theoretical Framing</h4>\n<ul>\n  <li>\n    <p>ReAct operationalizes reasoning as a <strong>policy</strong> over both thoughts and actions:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-143-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2052\" style=\"width: 6.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.003em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1004.95em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2053\"><span class=\"msubsup\" id=\"MathJax-Span-2054\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2055\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2056\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2057\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2058\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.336em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2059\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2060\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2061\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2062\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2063\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2064\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2065\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-2066\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2067\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2068\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2069\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-143\">\\pi_\\theta(t_i, a_i \\mid s_i)</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-144-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2070\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2071\"><span class=\"msubsup\" id=\"MathJax-Span-2072\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2073\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2074\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-144\">s_i</script> is the model‚Äôs current state (context + prior outputs).</li>\n    </ul>\n  </li>\n  <li>\n    <p>This allows the model to perform <strong>goal-directed reasoning</strong>, selectively gathering new information, evaluating results, and iteratively refining its understanding‚Äîessentially turning passive inference into <strong>interactive cognition</strong>.</p>\n  </li>\n</ul>\n<p>ReAct operationalizes reasoning as a <strong>policy</strong> over both thoughts and actions:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-144-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2070\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2071\"><span class=\"msubsup\" id=\"MathJax-Span-2072\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2073\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2074\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-144\">s_i</script> is the model‚Äôs current state (context + prior outputs).</li>\n    </ul>\n<p>This allows the model to perform <strong>goal-directed reasoning</strong>, selectively gathering new information, evaluating results, and iteratively refining its understanding‚Äîessentially turning passive inference into <strong>interactive cognition</strong>.</p>\n<h4 id=\"advantages-6\">Advantages</h4>\n<ul>\n  <li>Enables <strong>active information acquisition</strong>, reducing dependence on memorized knowledge.</li>\n  <li>Produces <strong>interpretable reasoning traces</strong> with explicit thought‚Äìaction‚Äìobservation sequences.</li>\n  <li>Scales naturally to <strong>multi-step, real-world tasks</strong> involving dynamic environments.</li>\n</ul>\n<h4 id=\"limitations-6\">Limitations</h4>\n<ul>\n  <li>Requires reliable execution infrastructure for handling tool calls and feedback.</li>\n  <li>Susceptible to <strong>looping behaviors</strong> if not properly constrained.</li>\n  <li>Context windows can become crowded with intermediate observations.</li>\n</ul>\n<h4 id=\"extensions\">Extensions</h4>\n<ul>\n  <li><strong>Reflexion</strong> (<a href=\"https://arxiv.org/abs/2303.11366\">Shinn et al. (2023)</a>): Adds self-evaluation and verbal RL to the ReAct cycle.</li>\n  <li><strong>AutoGPT / LangChain Agents (2023‚Äì2024)</strong>: Build upon ReAct‚Äôs iterative structure to enable multi-step autonomous task execution and planning.</li>\n</ul>",
    "contentMarkdown": "#### Core Idea\n\n*   _ReAct_ (Reason + Act) introduces a structured reasoning framework in which language models **interleave internal reasoning (‚Äúthoughts‚Äù) with external actions (‚Äúacts‚Äù)**. Rather than producing a single reasoning chain internally, the model alternates between cognitive reasoning steps and environment interactions, enabling active exploration, retrieval, and verification.\n    \n*   This concept was formalized in _ReAct: Synergizing Reasoning and Acting in Language Models_ by [Yao et al. (2022)](https://arxiv.org/abs/2210.03629), where an LLM engages in iterative cycles of **thinking**, **acting**, and **observing**, following the trajectory:\n    \n\n_ReAct_ (Reason + Act) introduces a structured reasoning framework in which language models **interleave internal reasoning (‚Äúthoughts‚Äù) with external actions (‚Äúacts‚Äù)**. Rather than producing a single reasoning chain internally, the model alternates between cognitive reasoning steps and environment interactions, enabling active exploration, retrieval, and verification.\n\nThis concept was formalized in _ReAct: Synergizing Reasoning and Acting in Language Models_ by [Yao et al. (2022)](https://arxiv.org/abs/2210.03629), where an LLM engages in iterative cycles of **thinking**, **acting**, and **observing**, following the trajectory:\n\nx‚ÜíThought1‚ÜíAction1‚ÜíObservation1‚ÜíThought2‚ÜíAction2‚Üí‚ãØ‚Üíyx‚ÜíThought1‚ÜíAction1‚ÜíObservation1‚ÜíThought2‚ÜíAction2‚Üí‚ãØ‚Üíy\n\n*   Each thought is an internal deliberation; each action interacts with an external environment (e.g., a search query or calculator call); and each observation provides feedback that informs the next reasoning step.\n\n#### Mechanism\n\n1.  **Prompt Structure**:\n    \n    *   The model is trained or prompted to alternate explicitly between ‚ÄúThought:‚Äù and ‚ÄúAction:‚Äù stages.\n    *   Example:\n    \n    ![](https://aman.ai/images/copy.png)\n    \n    `Thought: I should verify this fact. Action: search(\"When was the Theory of Relativity proposed?\") Observation: 1905. Thought: That confirms Einstein‚Äôs 1905 paper.`\n    \n2.  **Execution and Feedback**:\n    *   Each ‚ÄúAction‚Äù triggers a system-level call (search, API, or computation). The resulting observation is appended to the prompt context, grounding the model‚Äôs next reasoning step.\n3.  **Iterative Reasoning Loop**:\n    *   This continues until the model converges on a final conclusion or the task‚Äôs stopping condition is met.\n        \n    *   Formally, the reasoning trajectory is:\n        \n        œÑ\\=(x,(ti,ai,oi)Ti\\=1,y)œÑ\\=(x,(ti,ai,oi)i\\=1T,y)\n        \n        \\\\tau = (x, {(t\\_i, a\\_i, o\\_i)}\\_{i=1}^T, y)\n        *   where titit\\_i are reasoning traces, aiaia\\_i are actions, and oioio\\_i are observations.\n\n*   The model is trained or prompted to alternate explicitly between ‚ÄúThought:‚Äù and ‚ÄúAction:‚Äù stages.\n*   Example:\n\n![](https://aman.ai/images/copy.png)\n\n`Thought: I should verify this fact. Action: search(\"When was the Theory of Relativity proposed?\") Observation: 1905. Thought: That confirms Einstein‚Äôs 1905 paper.`\n\n*   Each ‚ÄúAction‚Äù triggers a system-level call (search, API, or computation). The resulting observation is appended to the prompt context, grounding the model‚Äôs next reasoning step.\n\n*   This continues until the model converges on a final conclusion or the task‚Äôs stopping condition is met.\n    \n*   Formally, the reasoning trajectory is:\n    \n    œÑ\\=(x,(ti,ai,oi)Ti\\=1,y)œÑ\\=(x,(ti,ai,oi)i\\=1T,y)\n    \n    \\\\tau = (x, {(t\\_i, a\\_i, o\\_i)}\\_{i=1}^T, y)\n    *   where titit\\_i are reasoning traces, aiaia\\_i are actions, and oioio\\_i are observations.\n\nThis continues until the model converges on a final conclusion or the task‚Äôs stopping condition is met.\n\nFormally, the reasoning trajectory is:\n\n*   where titit\\_i are reasoning traces, aiaia\\_i are actions, and oioio\\_i are observations.\n\n#### Theoretical Framing\n\n*   ReAct operationalizes reasoning as a **policy** over both thoughts and actions:\n    \n    œÄŒ∏(ti,ai‚à£si)œÄŒ∏(ti,ai‚à£si)\n    \n    \\\\pi\\_\\\\theta(t\\_i, a\\_i \\\\mid s\\_i)\n    *   where sisis\\_i is the model‚Äôs current state (context + prior outputs).\n*   This allows the model to perform **goal-directed reasoning**, selectively gathering new information, evaluating results, and iteratively refining its understanding‚Äîessentially turning passive inference into **interactive cognition**.\n    \n\nReAct operationalizes reasoning as a **policy** over both thoughts and actions:\n\n*   where sisis\\_i is the model‚Äôs current state (context + prior outputs).\n\nThis allows the model to perform **goal-directed reasoning**, selectively gathering new information, evaluating results, and iteratively refining its understanding‚Äîessentially turning passive inference into **interactive cognition**.\n\n#### Advantages\n\n*   Enables **active information acquisition**, reducing dependence on memorized knowledge.\n*   Produces **interpretable reasoning traces** with explicit thought‚Äìaction‚Äìobservation sequences.\n*   Scales naturally to **multi-step, real-world tasks** involving dynamic environments.\n\n#### Limitations\n\n*   Requires reliable execution infrastructure for handling tool calls and feedback.\n*   Susceptible to **looping behaviors** if not properly constrained.\n*   Context windows can become crowded with intermediate observations.\n\n#### Extensions\n\n*   **Reflexion** ([Shinn et al. (2023)](https://arxiv.org/abs/2303.11366)): Adds self-evaluation and verbal RL to the ReAct cycle.\n*   **AutoGPT / LangChain Agents (2023‚Äì2024)**: Build upon ReAct‚Äôs iterative structure to enable multi-step autonomous task execution and planning.",
    "order": 17,
    "orderInChapter": 1,
    "difficulty": 4,
    "estimatedMinutes": 4,
    "tags": [
      "nlpllms",
      "gpt",
      "llm"
    ],
    "metadata": {
      "hasCode": true,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 668,
      "contentLength": 53554
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#react:-reason-and-act-framework",
    "scrapedAt": "2025-12-28T11:54:00.655Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-toolformer-and-self-supervised-tool-learning-18",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Tool-Augmented Reasoning",
    "title": "Toolformer and Self-Supervised Tool Learning",
    "subtitle": "Tool-Augmented Reasoning",
    "contentHtml": "<h4 id=\"core-idea-6\">Core Idea</h4>\n<ul>\n  <li>\n    <p><em>Toolformer: Language Models Can Teach Themselves to Use Tools</em> by <a href=\"https://arxiv.org/abs/2302.04761\">Schick et al. (2023)</a> introduced a paradigm shift in <strong>self-supervised tool-augmented reasoning</strong>, where the model autonomously learns <em>when and how</em> to call external tools‚Äîwithout explicit supervision or hand-crafted prompts. Unlike <em>ReAct</em>, which depends on prompting and external orchestration, <em>Toolformer</em> integrates tool usage directly into the model‚Äôs generative policy, turning tool invocation into a <strong>learned reasoning behavior</strong> rather than a manually structured loop.</p>\n  </li>\n  <li>\n    <p>The central insight of Toolformer is that language models can <strong>self-label their own tool-use data</strong>: by inserting API calls into text and evaluating whether the resulting completion improves likelihood under the model‚Äôs own distribution. Through this mechanism, the model discovers not just how to use a tool, but when its invocation enhances reasoning performance.</p>\n  </li>\n  <li>\n    <p>This process transforms the model from a passive generator into an <strong>autonomous reasoning-controller</strong> that dynamically invokes external functions as part of its internal reasoning process.</p>\n  </li>\n</ul>\n<p><em>Toolformer: Language Models Can Teach Themselves to Use Tools</em> by <a href=\"https://arxiv.org/abs/2302.04761\">Schick et al. (2023)</a> introduced a paradigm shift in <strong>self-supervised tool-augmented reasoning</strong>, where the model autonomously learns <em>when and how</em> to call external tools‚Äîwithout explicit supervision or hand-crafted prompts. Unlike <em>ReAct</em>, which depends on prompting and external orchestration, <em>Toolformer</em> integrates tool usage directly into the model‚Äôs generative policy, turning tool invocation into a <strong>learned reasoning behavior</strong> rather than a manually structured loop.</p>\n<p>The central insight of Toolformer is that language models can <strong>self-label their own tool-use data</strong>: by inserting API calls into text and evaluating whether the resulting completion improves likelihood under the model‚Äôs own distribution. Through this mechanism, the model discovers not just how to use a tool, but when its invocation enhances reasoning performance.</p>\n<p>This process transforms the model from a passive generator into an <strong>autonomous reasoning-controller</strong> that dynamically invokes external functions as part of its internal reasoning process.</p>\n<h4 id=\"mechanism-7\">Mechanism</h4>\n<ol>\n  <li><strong>Candidate Tool Identification</strong>:\n    <ul>\n      <li>The model is exposed to a set of tools‚Äîe.g., calculator, Wikipedia search, translation API, or question-answering module.</li>\n    </ul>\n  </li>\n  <li><strong>Self-Supervised Data Generation</strong>:\n    <ul>\n      <li>Toolformer uses the base LLM to generate potential API calls within text (e.g., <code class=\"language-plaintext highlighter-rouge\">call(\"calculate(3*7)\")</code>) and then evaluates whether including the resulting API output improves the log-likelihood of the original completion.</li>\n    </ul>\n  </li>\n  <li><strong>Filtering and Fine-Tuning</strong>:\n    <ul>\n      <li>Only API calls that improve model likelihood are retained. The model is then fine-tuned on these augmented examples, learning to integrate tools naturally during inference.</li>\n    </ul>\n  </li>\n  <li><strong>Inference-Time Behavior</strong>:\n    <ul>\n      <li>\n        <p>During generation, the model autonomously decides when to invoke a tool. Tool outputs are inserted inline and directly influence subsequent reasoning steps.</p>\n      </li>\n      <li>\n        <p>Formally, the tool-augmented generation process is modeled as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-145-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow></mrow></munder><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2075\" style=\"width: 11.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.898em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1009.85em, 3.909em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2076\"><span class=\"mi\" id=\"MathJax-Span-2077\" style=\"font-family: STIXGeneral-Italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-2078\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2079\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"texatom\" id=\"MathJax-Span-2080\"><span class=\"mrow\" id=\"MathJax-Span-2081\"><span class=\"mo\" id=\"MathJax-Span-2082\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-2083\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2084\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2085\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-2086\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2087\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.52em, 4.273em, -999.997em); top: -2.81em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2088\"><span class=\"mrow\" id=\"MathJax-Span-2089\"><span class=\"texatom\" id=\"MathJax-Span-2090\"><span class=\"mrow\" id=\"MathJax-Span-2091\"><span class=\"mi\" id=\"MathJax-Span-2092\" style=\"font-size: 70.7%; font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2093\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2094\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2095\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2096\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2097\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2098\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-2099\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-2100\"><span class=\"mi\" id=\"MathJax-Span-2101\" style=\"font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.211em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2102\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2103\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2104\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2105\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>p</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow></mrow></munder><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-145\">p(y|x) = \\sum_{\\mathcal{T}} p_\\theta(y, \\mathcal{T}(x))</script>\n\n        <ul>\n          <li>where the model implicitly marginalizes over possible tool calls <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-146-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2106\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.94em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2107\"><span class=\"texatom\" id=\"MathJax-Span-2108\"><span class=\"mrow\" id=\"MathJax-Span-2109\"><span class=\"mi\" id=\"MathJax-Span-2110\" style=\"font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.211em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-146\">\\mathcal{T}</script> to produce the most likely reasoning continuation.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n</ol>\n<ul>\n      <li>The model is exposed to a set of tools‚Äîe.g., calculator, Wikipedia search, translation API, or question-answering module.</li>\n    </ul>\n<ul>\n      <li>Toolformer uses the base LLM to generate potential API calls within text (e.g., <code class=\"language-plaintext highlighter-rouge\">call(\"calculate(3*7)\")</code>) and then evaluates whether including the resulting API output improves the log-likelihood of the original completion.</li>\n    </ul>\n<ul>\n      <li>Only API calls that improve model likelihood are retained. The model is then fine-tuned on these augmented examples, learning to integrate tools naturally during inference.</li>\n    </ul>\n<ul>\n      <li>\n        <p>During generation, the model autonomously decides when to invoke a tool. Tool outputs are inserted inline and directly influence subsequent reasoning steps.</p>\n      </li>\n      <li>\n        <p>Formally, the tool-augmented generation process is modeled as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-145-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow></mrow></munder><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2075\" style=\"width: 11.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.898em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1009.85em, 3.909em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2076\"><span class=\"mi\" id=\"MathJax-Span-2077\" style=\"font-family: STIXGeneral-Italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-2078\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2079\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"texatom\" id=\"MathJax-Span-2080\"><span class=\"mrow\" id=\"MathJax-Span-2081\"><span class=\"mo\" id=\"MathJax-Span-2082\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-2083\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2084\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2085\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-2086\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2087\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.52em, 4.273em, -999.997em); top: -2.81em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2088\"><span class=\"mrow\" id=\"MathJax-Span-2089\"><span class=\"texatom\" id=\"MathJax-Span-2090\"><span class=\"mrow\" id=\"MathJax-Span-2091\"><span class=\"mi\" id=\"MathJax-Span-2092\" style=\"font-size: 70.7%; font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2093\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2094\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2095\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2096\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2097\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2098\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-2099\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-2100\"><span class=\"mi\" id=\"MathJax-Span-2101\" style=\"font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.211em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2102\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2103\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2104\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2105\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>p</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow></mrow></munder><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-145\">p(y|x) = \\sum_{\\mathcal{T}} p_\\theta(y, \\mathcal{T}(x))</script>\n\n        <ul>\n          <li>where the model implicitly marginalizes over possible tool calls <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-146-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2106\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.94em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2107\"><span class=\"texatom\" id=\"MathJax-Span-2108\"><span class=\"mrow\" id=\"MathJax-Span-2109\"><span class=\"mi\" id=\"MathJax-Span-2110\" style=\"font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.211em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-146\">\\mathcal{T}</script> to produce the most likely reasoning continuation.</li>\n        </ul>\n      </li>\n    </ul>\n<p>During generation, the model autonomously decides when to invoke a tool. Tool outputs are inserted inline and directly influence subsequent reasoning steps.</p>\n<p>Formally, the tool-augmented generation process is modeled as:</p>\n<ul>\n          <li>where the model implicitly marginalizes over possible tool calls <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-146-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2106\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.94em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2107\"><span class=\"texatom\" id=\"MathJax-Span-2108\"><span class=\"mrow\" id=\"MathJax-Span-2109\"><span class=\"mi\" id=\"MathJax-Span-2110\" style=\"font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.211em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-146\">\\mathcal{T}</script> to produce the most likely reasoning continuation.</li>\n        </ul>\n<h4 id=\"theoretical-framing-3\">Theoretical Framing</h4>\n<ul>\n  <li>\n    <p>Toolformer operationalizes <strong>compositional reasoning</strong> through <strong>differentiable decision-making over discrete actions</strong> (tool invocations). Each tool call acts as a functional composition step within the model‚Äôs reasoning trace, turning the sequence generation process into a form of <strong>neurosymbolic program synthesis</strong>.</p>\n  </li>\n  <li>\n    <p>By learning tool invocation autonomously, Toolformer bridges the gap between <strong>in-context reasoning</strong> and <strong>procedural reasoning</strong>, internalizing the interface between language and computation.</p>\n  </li>\n</ul>\n<p>Toolformer operationalizes <strong>compositional reasoning</strong> through <strong>differentiable decision-making over discrete actions</strong> (tool invocations). Each tool call acts as a functional composition step within the model‚Äôs reasoning trace, turning the sequence generation process into a form of <strong>neurosymbolic program synthesis</strong>.</p>\n<p>By learning tool invocation autonomously, Toolformer bridges the gap between <strong>in-context reasoning</strong> and <strong>procedural reasoning</strong>, internalizing the interface between language and computation.</p>\n<h4 id=\"representative-systems\">Representative Systems</h4>\n<ol>\n  <li><strong>Toolformer</strong> (<a href=\"https://arxiv.org/abs/2302.04761\">Schick et al. (2023)</a>): The foundational framework for self-supervised tool usage across multiple APIs.</li>\n  <li><strong>PAL (Program-Aided Language Models)</strong> (<a href=\"https://arxiv.org/abs/2211.10435\">Gao et al. (2022)</a>): Delegates structured reasoning to Python execution, using LLMs to generate executable programs rather than answers directly.</li>\n  <li><strong>Gorilla</strong> (<a href=\"https://arxiv.org/abs/2305.15334\">Patil et al. (2023)</a>): Extends the concept to large-scale API access, enabling natural-language-to-API mapping for thousands of real-world endpoints.</li>\n  <li><strong>LLM-Augmented Reasoning (LLM-AR)</strong> (<a href=\"https://arxiv.org/abs/2302.09419\">Paranjape et al. (2023)</a>): Integrates tool selection and programmatic reasoning within retrieval-augmented inference pipelines.</li>\n  <li><strong>ToolBench</strong> (<a href=\"https://arxiv.org/abs/2307.16789\">Huang et al. (2023)</a>): Provides a benchmark for evaluating tool-use generalization and the efficiency of learned tool invocation.</li>\n</ol>\n<h4 id=\"advantages-7\">Advantages</h4>\n<ul>\n  <li><strong>Autonomous learning</strong>: No human annotation required for tool-use examples.</li>\n  <li><strong>Improved factuality</strong>: External tools provide non-parametric computation and verifiable results.</li>\n  <li><strong>Composable reasoning</strong>: Tool invocation integrates seamlessly into text generation.</li>\n  <li><strong>Scalable</strong>: Supports continual integration of new tools through additional fine-tuning on newly self-labeled tool-use data, without modifying the model‚Äôs architecture.</li>\n</ul>\n<h4 id=\"limitations-7\">Limitations</h4>\n<ul>\n  <li>Requires reliable APIs and error-tolerant execution infrastructure.</li>\n  <li>Self-supervised signal can bias toward frequent or high-likelihood calls, underusing rare but useful tools.</li>\n  <li>Tool call latency and context-length constraints can affect real-time reasoning.</li>\n</ul>\n<h4 id=\"relationship-to-react-and-rl\">Relationship to ReAct and RL</h4>\n<ul>\n  <li>While <em>ReAct</em> structures reasoning via <strong>explicit prompts and environment interaction</strong>, <em>Toolformer</em> internalizes the decision to use tools via <strong>training-time self-supervision</strong>.</li>\n  <li>RL methods, such as <em>DeepSeek-R1</em>, can complement Toolformer by learning <strong>optimal tool invocation policies</strong> via reward feedback rather than likelihood improvement.</li>\n</ul>",
    "contentMarkdown": "#### Core Idea\n\n*   _Toolformer: Language Models Can Teach Themselves to Use Tools_ by [Schick et al. (2023)](https://arxiv.org/abs/2302.04761) introduced a paradigm shift in **self-supervised tool-augmented reasoning**, where the model autonomously learns _when and how_ to call external tools‚Äîwithout explicit supervision or hand-crafted prompts. Unlike _ReAct_, which depends on prompting and external orchestration, _Toolformer_ integrates tool usage directly into the model‚Äôs generative policy, turning tool invocation into a **learned reasoning behavior** rather than a manually structured loop.\n    \n*   The central insight of Toolformer is that language models can **self-label their own tool-use data**: by inserting API calls into text and evaluating whether the resulting completion improves likelihood under the model‚Äôs own distribution. Through this mechanism, the model discovers not just how to use a tool, but when its invocation enhances reasoning performance.\n    \n*   This process transforms the model from a passive generator into an **autonomous reasoning-controller** that dynamically invokes external functions as part of its internal reasoning process.\n    \n\n_Toolformer: Language Models Can Teach Themselves to Use Tools_ by [Schick et al. (2023)](https://arxiv.org/abs/2302.04761) introduced a paradigm shift in **self-supervised tool-augmented reasoning**, where the model autonomously learns _when and how_ to call external tools‚Äîwithout explicit supervision or hand-crafted prompts. Unlike _ReAct_, which depends on prompting and external orchestration, _Toolformer_ integrates tool usage directly into the model‚Äôs generative policy, turning tool invocation into a **learned reasoning behavior** rather than a manually structured loop.\n\nThe central insight of Toolformer is that language models can **self-label their own tool-use data**: by inserting API calls into text and evaluating whether the resulting completion improves likelihood under the model‚Äôs own distribution. Through this mechanism, the model discovers not just how to use a tool, but when its invocation enhances reasoning performance.\n\nThis process transforms the model from a passive generator into an **autonomous reasoning-controller** that dynamically invokes external functions as part of its internal reasoning process.\n\n#### Mechanism\n\n1.  **Candidate Tool Identification**:\n    *   The model is exposed to a set of tools‚Äîe.g., calculator, Wikipedia search, translation API, or question-answering module.\n2.  **Self-Supervised Data Generation**:\n    *   Toolformer uses the base LLM to generate potential API calls within text (e.g., `call(\"calculate(3*7)\")`) and then evaluates whether including the resulting API output improves the log-likelihood of the original completion.\n3.  **Filtering and Fine-Tuning**:\n    *   Only API calls that improve model likelihood are retained. The model is then fine-tuned on these augmented examples, learning to integrate tools naturally during inference.\n4.  **Inference-Time Behavior**:\n    *   During generation, the model autonomously decides when to invoke a tool. Tool outputs are inserted inline and directly influence subsequent reasoning steps.\n        \n    *   Formally, the tool-augmented generation process is modeled as:\n        \n        p(y|x)\\=‚àëÓâÄpŒ∏(y,ÓâÄ(x))p(y|x)\\=‚àëTpŒ∏(y,T(x))\n        \n        p(y|x) = \\\\sum\\_{\\\\mathcal{T}} p\\_\\\\theta(y, \\\\mathcal{T}(x))\n        *   where the model implicitly marginalizes over possible tool calls ÓâÄT\\\\mathcal{T} to produce the most likely reasoning continuation.\n\n*   The model is exposed to a set of tools‚Äîe.g., calculator, Wikipedia search, translation API, or question-answering module.\n\n*   Toolformer uses the base LLM to generate potential API calls within text (e.g., `call(\"calculate(3*7)\")`) and then evaluates whether including the resulting API output improves the log-likelihood of the original completion.\n\n*   Only API calls that improve model likelihood are retained. The model is then fine-tuned on these augmented examples, learning to integrate tools naturally during inference.\n\n*   During generation, the model autonomously decides when to invoke a tool. Tool outputs are inserted inline and directly influence subsequent reasoning steps.\n    \n*   Formally, the tool-augmented generation process is modeled as:\n    \n    p(y|x)\\=‚àëÓâÄpŒ∏(y,ÓâÄ(x))p(y|x)\\=‚àëTpŒ∏(y,T(x))\n    \n    p(y|x) = \\\\sum\\_{\\\\mathcal{T}} p\\_\\\\theta(y, \\\\mathcal{T}(x))\n    *   where the model implicitly marginalizes over possible tool calls ÓâÄT\\\\mathcal{T} to produce the most likely reasoning continuation.\n\nDuring generation, the model autonomously decides when to invoke a tool. Tool outputs are inserted inline and directly influence subsequent reasoning steps.\n\nFormally, the tool-augmented generation process is modeled as:\n\n*   where the model implicitly marginalizes over possible tool calls ÓâÄT\\\\mathcal{T} to produce the most likely reasoning continuation.\n\n#### Theoretical Framing\n\n*   Toolformer operationalizes **compositional reasoning** through **differentiable decision-making over discrete actions** (tool invocations). Each tool call acts as a functional composition step within the model‚Äôs reasoning trace, turning the sequence generation process into a form of **neurosymbolic program synthesis**.\n    \n*   By learning tool invocation autonomously, Toolformer bridges the gap between **in-context reasoning** and **procedural reasoning**, internalizing the interface between language and computation.\n    \n\nToolformer operationalizes **compositional reasoning** through **differentiable decision-making over discrete actions** (tool invocations). Each tool call acts as a functional composition step within the model‚Äôs reasoning trace, turning the sequence generation process into a form of **neurosymbolic program synthesis**.\n\nBy learning tool invocation autonomously, Toolformer bridges the gap between **in-context reasoning** and **procedural reasoning**, internalizing the interface between language and computation.\n\n#### Representative Systems\n\n1.  **Toolformer** ([Schick et al. (2023)](https://arxiv.org/abs/2302.04761)): The foundational framework for self-supervised tool usage across multiple APIs.\n2.  **PAL (Program-Aided Language Models)** ([Gao et al. (2022)](https://arxiv.org/abs/2211.10435)): Delegates structured reasoning to Python execution, using LLMs to generate executable programs rather than answers directly.\n3.  **Gorilla** ([Patil et al. (2023)](https://arxiv.org/abs/2305.15334)): Extends the concept to large-scale API access, enabling natural-language-to-API mapping for thousands of real-world endpoints.\n4.  **LLM-Augmented Reasoning (LLM-AR)** ([Paranjape et al. (2023)](https://arxiv.org/abs/2302.09419)): Integrates tool selection and programmatic reasoning within retrieval-augmented inference pipelines.\n5.  **ToolBench** ([Huang et al. (2023)](https://arxiv.org/abs/2307.16789)): Provides a benchmark for evaluating tool-use generalization and the efficiency of learned tool invocation.\n\n#### Advantages\n\n*   **Autonomous learning**: No human annotation required for tool-use examples.\n*   **Improved factuality**: External tools provide non-parametric computation and verifiable results.\n*   **Composable reasoning**: Tool invocation integrates seamlessly into text generation.\n*   **Scalable**: Supports continual integration of new tools through additional fine-tuning on newly self-labeled tool-use data, without modifying the model‚Äôs architecture.\n\n#### Limitations\n\n*   Requires reliable APIs and error-tolerant execution infrastructure.\n*   Self-supervised signal can bias toward frequent or high-likelihood calls, underusing rare but useful tools.\n*   Tool call latency and context-length constraints can affect real-time reasoning.\n\n#### Relationship to ReAct and RL\n\n*   While _ReAct_ structures reasoning via **explicit prompts and environment interaction**, _Toolformer_ internalizes the decision to use tools via **training-time self-supervision**.\n*   RL methods, such as _DeepSeek-R1_, can complement Toolformer by learning **optimal tool invocation policies** via reward feedback rather than likelihood improvement.",
    "order": 18,
    "orderInChapter": 2,
    "difficulty": 4,
    "estimatedMinutes": 6,
    "tags": [
      "nlpllms",
      "llm",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": true,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 1002,
      "contentLength": 27050
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#toolformer-and-self-supervised-tool-learning",
    "scrapedAt": "2025-12-28T11:54:00.655Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-webgpt-19",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Reinforcement Learning-Based Reasoning",
    "title": "WebGPT",
    "subtitle": "Reinforcement Learning-Based Reasoning",
    "contentHtml": "<ul>\n  <li>The paper <a href=\"https://arxiv.org/abs/2112.09332\">WebGPT: Browser-assisted Question-answering with Human Feedback</a> by Nakano et al. (2021) represents one of the earliest large-scale implementations of <strong>reinforcement learning from human feedback (RLHF)</strong> for reasoning. It extends LLMs beyond static text reasoning by introducing a controlled web-browsing interface, enabling them to search, navigate, and cite external information sources while answering questions.</li>\n  <li>By combining human preference modeling with interactive tool use, WebGPT laid the foundation for verifiable, tool-augmented reasoning systems.</li>\n</ul>\n<h4 id=\"core-idea-7\">Core Idea</h4>\n<ul>\n  <li>WebGPT extends the RL-style reasoning paradigm by equipping an LLM with a controlled web-browser interface: the model can query, click, scroll, and quote webpages in a simulated browsing environment (<a href=\"https://openai.com/index/webgpt/\">OpenAI</a>).</li>\n  <li>It then uses human feedback (via a reward model trained on pairwise comparisons) to select its best answers. In this way, the model‚Äôs reasoning trajectories include <em>external information retrieval and verification steps</em>, making reasoning more grounded and verifiable.</li>\n</ul>\n<h4 id=\"mechanism-8\">Mechanism</h4>\n<ul>\n  <li>The model begins with imitation learning (behavior cloning) on human browsing demonstrations, learning to execute search <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-147-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2111\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2112\"><span class=\"mo\" id=\"MathJax-Span-2113\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-147\">\\rightarrow</script> navigate <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-148-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2114\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2115\"><span class=\"mo\" id=\"MathJax-Span-2116\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-148\">\\rightarrow</script> quote chains.</li>\n  <li>Next, a separate reward model is trained to predict human preference among answer‚Äìreference pairs. Answers are harvested via browsing and then compared.</li>\n  <li>Finally, the policy is refined via rejection sampling (and optionally RL) with respect to that reward model: the top-ranked answers by the reward model are selected.</li>\n  <li>\n    <p>Browsing environment: At each time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-149-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2117\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2118\"><span class=\"mi\" id=\"MathJax-Span-2119\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-149\">t</script> the model is given browser state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-150-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2120\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2121\"><span class=\"msubsup\" id=\"MathJax-Span-2122\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2123\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2124\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-150\">s_t</script>, chooses an action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-151-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2208;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>Search</mtext><mo>,</mo><mtext>Click</mtext><mo>,</mo><mtext>Scroll</mtext><mo>,</mo><mtext>Quote</mtext></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2125\" style=\"width: 15.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.076em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1013.08em, 2.555em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2126\"><span class=\"msubsup\" id=\"MathJax-Span-2127\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2128\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2129\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2130\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àà</span><span class=\"texatom\" id=\"MathJax-Span-2131\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-2132\"><span class=\"mtext\" id=\"MathJax-Span-2133\" style=\"font-family: STIXGeneral-Regular;\">Search</span><span class=\"mo\" id=\"MathJax-Span-2134\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-2135\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">Click</span><span class=\"mo\" id=\"MathJax-Span-2136\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-2137\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">Scroll</span><span class=\"mo\" id=\"MathJax-Span-2138\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-2139\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">Quote</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>t</mi></msub><mo>‚àà</mo><mrow class=\"MJX-TeXAtom-ORD\"><mtext>Search</mtext><mo>,</mo><mtext>Click</mtext><mo>,</mo><mtext>Scroll</mtext><mo>,</mo><mtext>Quote</mtext></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-151\">a_t \\in {\\text{Search}, \\text{Click}, \\text{Scroll}, \\text{Quote}}</script>, and obtains the next state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-152-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2140\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.51em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2141\"><span class=\"msubsup\" id=\"MathJax-Span-2142\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2143\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2144\"><span class=\"mrow\" id=\"MathJax-Span-2145\"><span class=\"mi\" id=\"MathJax-Span-2146\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-2148\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-152\">s_{t+1}</script>. After <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-153-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2149\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2150\"><span class=\"mi\" id=\"MathJax-Span-2151\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>T</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-153\">T</script> steps, it produces answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-154-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2152\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2153\"><span class=\"mi\" id=\"MathJax-Span-2154\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-154\">y</script> with supporting references <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-155-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2155\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2156\"><span class=\"mi\" id=\"MathJax-Span-2157\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-155\">z</script>. The reward model assigns <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-156-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2158\" style=\"width: 3.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.71em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2159\"><span class=\"mi\" id=\"MathJax-Span-2160\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2161\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2162\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2163\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2164\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-2165\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-156\">R(y,z)</script>. The training objective is to increase the probability of trajectories leading to high <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-157-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2166\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2167\"><span class=\"mi\" id=\"MathJax-Span-2168\" style=\"font-family: STIXGeneral-Italic;\">R</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-157\">R</script>.</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-158-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>J</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2169\" style=\"width: 14.482em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1011.93em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2170\"><span class=\"texatom\" id=\"MathJax-Span-2171\"><span class=\"mrow\" id=\"MathJax-Span-2172\"><span class=\"mi\" id=\"MathJax-Span-2173\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∂<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2174\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2175\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2176\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2177\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2178\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 5.315em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2179\"><span class=\"mrow\" id=\"MathJax-Span-2180\"><span class=\"mi\" id=\"MathJax-Span-2181\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2182\"><span class=\"mrow\" id=\"MathJax-Span-2183\"><span class=\"mo\" id=\"MathJax-Span-2184\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2185\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2186\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-2187\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2188\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-2189\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2190\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2191\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2192\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"mi\" id=\"MathJax-Span-2193\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2194\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2195\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-2196\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"texatom\" id=\"MathJax-Span-2197\"><span class=\"mrow\" id=\"MathJax-Span-2198\"><span class=\"mo\" id=\"MathJax-Span-2199\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-2200\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2201\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2202\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2203\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-2204\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2205\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2206\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2207\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2208\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-2209\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2210\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">J</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mo stretchy=\"false\">(</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>‚àº</mo><mi>œÄ</mi><mi>Œ∏</mi><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow></msub><mo stretchy=\"false\">[</mo><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-158\">\\mathcal{J}(\\theta) = \\mathbb{E}_{(x, (z,y) \\sim \\pi \\theta(\\cdot|x))} [R(y,z)]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-159-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2211\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2212\"><span class=\"mi\" id=\"MathJax-Span-2213\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-159\">x</script> is the question and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-160-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2214\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2215\"><span class=\"mi\" id=\"MathJax-Span-2216\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-160\">z</script> is the set of quoted references.</li>\n    </ul>\n  </li>\n  <li>Use of citations: The model is required to produce citations so that humans can verify factual accuracy.</li>\n  <li>The following figure (<a href=\"https://arxiv.org/abs/2112.09332\">source</a>) shows the <em>text-based browsing interface</em> used in WebGPT, where a language model interacts with the environment via commands such as ‚Äúsearch,‚Äù ‚Äúscroll,‚Äù or ‚Äúquote‚Äù to collect references during question answering.</li>\n</ul>\n<p>Browsing environment: At each time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-149-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2117\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2118\"><span class=\"mi\" id=\"MathJax-Span-2119\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-149\">t</script> the model is given browser state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-150-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2120\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2121\"><span class=\"msubsup\" id=\"MathJax-Span-2122\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2123\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2124\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-150\">s_t</script>, chooses an action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-151-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2208;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>Search</mtext><mo>,</mo><mtext>Click</mtext><mo>,</mo><mtext>Scroll</mtext><mo>,</mo><mtext>Quote</mtext></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2125\" style=\"width: 15.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.076em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1013.08em, 2.555em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2126\"><span class=\"msubsup\" id=\"MathJax-Span-2127\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2128\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2129\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2130\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àà</span><span class=\"texatom\" id=\"MathJax-Span-2131\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-2132\"><span class=\"mtext\" id=\"MathJax-Span-2133\" style=\"font-family: STIXGeneral-Regular;\">Search</span><span class=\"mo\" id=\"MathJax-Span-2134\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-2135\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">Click</span><span class=\"mo\" id=\"MathJax-Span-2136\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-2137\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">Scroll</span><span class=\"mo\" id=\"MathJax-Span-2138\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-2139\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">Quote</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>t</mi></msub><mo>‚àà</mo><mrow class=\"MJX-TeXAtom-ORD\"><mtext>Search</mtext><mo>,</mo><mtext>Click</mtext><mo>,</mo><mtext>Scroll</mtext><mo>,</mo><mtext>Quote</mtext></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-151\">a_t \\in {\\text{Search}, \\text{Click}, \\text{Scroll}, \\text{Quote}}</script>, and obtains the next state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-152-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2140\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.51em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2141\"><span class=\"msubsup\" id=\"MathJax-Span-2142\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2143\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2144\"><span class=\"mrow\" id=\"MathJax-Span-2145\"><span class=\"mi\" id=\"MathJax-Span-2146\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-2148\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-152\">s_{t+1}</script>. After <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-153-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2149\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2150\"><span class=\"mi\" id=\"MathJax-Span-2151\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>T</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-153\">T</script> steps, it produces answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-154-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2152\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2153\"><span class=\"mi\" id=\"MathJax-Span-2154\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-154\">y</script> with supporting references <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-155-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2155\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2156\"><span class=\"mi\" id=\"MathJax-Span-2157\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-155\">z</script>. The reward model assigns <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-156-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2158\" style=\"width: 3.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.71em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2159\"><span class=\"mi\" id=\"MathJax-Span-2160\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2161\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2162\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2163\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2164\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-2165\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-156\">R(y,z)</script>. The training objective is to increase the probability of trajectories leading to high <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-157-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2166\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2167\"><span class=\"mi\" id=\"MathJax-Span-2168\" style=\"font-family: STIXGeneral-Italic;\">R</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-157\">R</script>.</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-159-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2211\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2212\"><span class=\"mi\" id=\"MathJax-Span-2213\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-159\">x</script> is the question and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-160-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2214\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2215\"><span class=\"mi\" id=\"MathJax-Span-2216\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-160\">z</script> is the set of quoted references.</li>\n    </ul>\n<p><img src=\"/primers/ai/assets/RL-for-agents/WebGPT.jpg\" alt=\"\"></p>\n<h4 id=\"implementation-details\">Implementation Details</h4>\n<ul>\n  <li>The base model is a fine-tuned version of GPT-3 (various sizes).</li>\n  <li>Demonstration dataset: approximately 6K human browsing demonstrations collected via the browsing interface.</li>\n  <li>Pairwise comparisons: approximately 21.5K human preference labels comparing two model‚Äêgenerated answers (with references) to train the reward model.</li>\n  <li>The browsing actions are limited to a text-browser interface (e.g., using the Bing Web Search API) to avoid full web access risks.</li>\n  <li>In evaluation, the best model‚Äôs answers were preferred 56 % of the time to human demonstrators and 69 % of the time to the highest-voted Reddit answer on the ELI5 dataset.</li>\n</ul>\n<h4 id=\"significance-for-rl-based-reasoning\">Significance for RL-Based Reasoning</h4>\n<ul>\n  <li>\n    <p>WebGPT advances RL-based reasoning in several ways:</p>\n\n    <ul>\n      <li>It moves beyond static, text-only reasoning chains to include <em>interactive retrieval and verification</em>, thus more closely approximating real-world reasoning.</li>\n      <li>It operationalizes the notion of <em>verifiable reasoning trajectories</em> by requiring citations and human-preferenced ranking.</li>\n      <li>It shows that LLMs can improve reasoning (in this case long-form QA) via reward-driven optimization of interactive reasoning policies, not just via next-token prediction.</li>\n    </ul>\n  </li>\n</ul>\n<p>WebGPT advances RL-based reasoning in several ways:</p>\n<ul>\n      <li>It moves beyond static, text-only reasoning chains to include <em>interactive retrieval and verification</em>, thus more closely approximating real-world reasoning.</li>\n      <li>It operationalizes the notion of <em>verifiable reasoning trajectories</em> by requiring citations and human-preferenced ranking.</li>\n      <li>It shows that LLMs can improve reasoning (in this case long-form QA) via reward-driven optimization of interactive reasoning policies, not just via next-token prediction.</li>\n    </ul>\n<h4 id=\"limitations-and-considerations\">Limitations and Considerations</h4>\n<ul>\n  <li>The browsing environment is constrained (text‚Äêonly, limited actions) and may still not fully capture open-web complexity.</li>\n  <li>The reward model remains human-preference based and can inherit biases or noise.</li>\n  <li>Credit assignment across long browsing trajectories remains challenging (a general RL-reasoning issue).</li>\n  <li>Scalability: Collecting demonstrations and preference data is expensive; deployment in open domains still faces reliability issues.</li>\n</ul>",
    "contentMarkdown": "*   The paper [WebGPT: Browser-assisted Question-answering with Human Feedback](https://arxiv.org/abs/2112.09332) by Nakano et al. (2021) represents one of the earliest large-scale implementations of **reinforcement learning from human feedback (RLHF)** for reasoning. It extends LLMs beyond static text reasoning by introducing a controlled web-browsing interface, enabling them to search, navigate, and cite external information sources while answering questions.\n*   By combining human preference modeling with interactive tool use, WebGPT laid the foundation for verifiable, tool-augmented reasoning systems.\n\n#### Core Idea\n\n*   WebGPT extends the RL-style reasoning paradigm by equipping an LLM with a controlled web-browser interface: the model can query, click, scroll, and quote webpages in a simulated browsing environment ([OpenAI](https://openai.com/index/webgpt/)).\n*   It then uses human feedback (via a reward model trained on pairwise comparisons) to select its best answers. In this way, the model‚Äôs reasoning trajectories include _external information retrieval and verification steps_, making reasoning more grounded and verifiable.\n\n#### Mechanism\n\n*   The model begins with imitation learning (behavior cloning) on human browsing demonstrations, learning to execute search ‚Üí‚Üí\\\\rightarrow navigate ‚Üí‚Üí\\\\rightarrow quote chains.\n*   Next, a separate reward model is trained to predict human preference among answer‚Äìreference pairs. Answers are harvested via browsing and then compared.\n*   Finally, the policy is refined via rejection sampling (and optionally RL) with respect to that reward model: the top-ranked answers by the reward model are selected.\n*   Browsing environment: At each time step ttt the model is given browser state ststs\\_t, chooses an action at‚ààSearch,Click,Scroll,Quoteat‚ààSearch,Click,Scroll,Quotea\\_t \\\\in {\\\\text{Search}, \\\\text{Click}, \\\\text{Scroll}, \\\\text{Quote}}, and obtains the next state st+1st+1s\\_{t+1}. After TTT steps, it produces answer yyy with supporting references zzz. The reward model assigns R(y,z)R(y,z)R(y,z). The training objective is to increase the probability of trajectories leading to high RRR.\n    \n    Óà∂(Œ∏)\\=ùîº(x,(z,y)‚àºœÄŒ∏(‚ãÖ|x))\\[R(y,z)\\]J(Œ∏)\\=E(x,(z,y)‚àºœÄŒ∏(‚ãÖ|x))\\[R(y,z)\\]\n    \n    \\\\mathcal{J}(\\\\theta) = \\\\mathbb{E}\\_{(x, (z,y) \\\\sim \\\\pi \\\\theta(\\\\cdot|x))} \\[R(y,z)\\]\n    *   where xxx is the question and zzz is the set of quoted references.\n*   Use of citations: The model is required to produce citations so that humans can verify factual accuracy.\n*   The following figure ([source](https://arxiv.org/abs/2112.09332)) shows the _text-based browsing interface_ used in WebGPT, where a language model interacts with the environment via commands such as ‚Äúsearch,‚Äù ‚Äúscroll,‚Äù or ‚Äúquote‚Äù to collect references during question answering.\n\nBrowsing environment: At each time step ttt the model is given browser state ststs\\_t, chooses an action at‚ààSearch,Click,Scroll,Quoteat‚ààSearch,Click,Scroll,Quotea\\_t \\\\in {\\\\text{Search}, \\\\text{Click}, \\\\text{Scroll}, \\\\text{Quote}}, and obtains the next state st+1st+1s\\_{t+1}. After TTT steps, it produces answer yyy with supporting references zzz. The reward model assigns R(y,z)R(y,z)R(y,z). The training objective is to increase the probability of trajectories leading to high RRR.\n\n*   where xxx is the question and zzz is the set of quoted references.\n\n![](/primers/ai/assets/RL-for-agents/WebGPT.jpg)\n\n#### Implementation Details\n\n*   The base model is a fine-tuned version of GPT-3 (various sizes).\n*   Demonstration dataset: approximately 6K human browsing demonstrations collected via the browsing interface.\n*   Pairwise comparisons: approximately 21.5K human preference labels comparing two model‚Äêgenerated answers (with references) to train the reward model.\n*   The browsing actions are limited to a text-browser interface (e.g., using the Bing Web Search API) to avoid full web access risks.\n*   In evaluation, the best model‚Äôs answers were preferred 56 % of the time to human demonstrators and 69 % of the time to the highest-voted Reddit answer on the ELI5 dataset.\n\n#### Significance for RL-Based Reasoning\n\n*   WebGPT advances RL-based reasoning in several ways:\n    \n    *   It moves beyond static, text-only reasoning chains to include _interactive retrieval and verification_, thus more closely approximating real-world reasoning.\n    *   It operationalizes the notion of _verifiable reasoning trajectories_ by requiring citations and human-preferenced ranking.\n    *   It shows that LLMs can improve reasoning (in this case long-form QA) via reward-driven optimization of interactive reasoning policies, not just via next-token prediction.\n\nWebGPT advances RL-based reasoning in several ways:\n\n*   It moves beyond static, text-only reasoning chains to include _interactive retrieval and verification_, thus more closely approximating real-world reasoning.\n*   It operationalizes the notion of _verifiable reasoning trajectories_ by requiring citations and human-preferenced ranking.\n*   It shows that LLMs can improve reasoning (in this case long-form QA) via reward-driven optimization of interactive reasoning policies, not just via next-token prediction.\n\n#### Limitations and Considerations\n\n*   The browsing environment is constrained (text‚Äêonly, limited actions) and may still not fully capture open-web complexity.\n*   The reward model remains human-preference based and can inherit biases or noise.\n*   Credit assignment across long browsing trajectories remains challenging (a general RL-reasoning issue).\n*   Scalability: Collecting demonstrations and preference data is expensive; deployment in open domains still faces reliability issues.",
    "order": 19,
    "orderInChapter": 1,
    "difficulty": 4,
    "estimatedMinutes": 4,
    "tags": [
      "nlpllms",
      "gpt",
      "llm",
      "reinforcement learning",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 738,
      "contentLength": 51871
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#webgpt",
    "scrapedAt": "2025-12-28T11:54:00.655Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-deepseek-r1-20",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Reinforcement Learning-Based Reasoning",
    "title": "DeepSeek-R1",
    "subtitle": "Reinforcement Learning-Based Reasoning",
    "contentHtml": "<ul>\n  <li>The most prominent example of RL for reasoning is <strong>DeepSeek-R1: Incentivizing Reasoning Capability in LLMs via Reinforcement Learning</strong> by <a href=\"https://arxiv.org/abs/2501.12948\">Guo et al. (2025)</a>.</li>\n</ul>\n<h4 id=\"core-idea-8\">Core Idea</h4>\n<ul>\n  <li>\n    <p>DeepSeek-R1 applies RL to improve reasoning performance <em>without supervised rationales</em>.\nThe model learns to generate intermediate steps that lead to verifiably correct outcomes, using a <strong>reinforcement signal</strong> that rewards correct or efficient reasoning trajectories.</p>\n  </li>\n  <li>\n    <p>Formally, for a given problem <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-161-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2217\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2218\"><span class=\"mi\" id=\"MathJax-Span-2219\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-161\">x</script>, reasoning trace <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-162-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2220\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2221\"><span class=\"mi\" id=\"MathJax-Span-2222\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-162\">z</script>, and final answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-163-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2223\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2224\"><span class=\"mi\" id=\"MathJax-Span-2225\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-163\">y</script>,</p>\n  </li>\n</ul>\n<p>DeepSeek-R1 applies RL to improve reasoning performance <em>without supervised rationales</em>.\nThe model learns to generate intermediate steps that lead to verifiably correct outcomes, using a <strong>reinforcement signal</strong> that rewards correct or efficient reasoning trajectories.</p>\n<p>Formally, for a given problem <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-161-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2217\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2218\"><span class=\"mi\" id=\"MathJax-Span-2219\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-161\">x</script>, reasoning trace <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-162-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2220\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2221\"><span class=\"mi\" id=\"MathJax-Span-2222\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-162\">z</script>, and final answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-163-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2223\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2224\"><span class=\"mi\" id=\"MathJax-Span-2225\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-163\">y</script>,</p>\n<p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-164-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mtext>correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2212;</mo><mi>&amp;#x03BB;</mi><mo>,</mo><mtext>cost</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2226\" style=\"width: 15.003em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.503em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1012.5em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2227\"><span class=\"mi\" id=\"MathJax-Span-2228\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2229\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2230\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2231\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2232\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-2233\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2234\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-2235\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-2236\"><span class=\"mi\" id=\"MathJax-Span-2237\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-2238\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mtext\" id=\"MathJax-Span-2239\" style=\"font-family: STIXGeneral-Regular;\">correct</span><span class=\"mo\" id=\"MathJax-Span-2240\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2241\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2242\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2243\" style=\"font-family: STIXGeneral-Regular;\">]</span><span class=\"mo\" id=\"MathJax-Span-2244\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2245\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œª</span><span class=\"mo\" id=\"MathJax-Span-2246\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-2247\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">cost</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><mtext>correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo>‚àí</mo><mi>Œª</mi><mo>,</mo><mtext>cost</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-164\">R(y, z) = \\mathbb{I}[\\text{correct}(y)] - \\lambda , \\text{cost}</script>z<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-165-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; />\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2248\" style=\"width: 0em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2249\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-165\"></script></p>\n<ul>\n  <li>‚Ä¶ and the objective is to maximize the expected reward:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-166-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>J</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>&amp;#x223C;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>D</mi></mrow><mo>,</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo>&amp;#x223C;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2250\" style=\"width: 14.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1011.98em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2251\"><span class=\"texatom\" id=\"MathJax-Span-2252\"><span class=\"mrow\" id=\"MathJax-Span-2253\"><span class=\"mi\" id=\"MathJax-Span-2254\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∂<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2255\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2256\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2257\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2258\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2259\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 5.367em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2260\"><span class=\"mrow\" id=\"MathJax-Span-2261\"><span class=\"mi\" id=\"MathJax-Span-2262\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2263\"><span class=\"mrow\" id=\"MathJax-Span-2264\"><span class=\"mi\" id=\"MathJax-Span-2265\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2266\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"texatom\" id=\"MathJax-Span-2267\"><span class=\"mrow\" id=\"MathJax-Span-2268\"><span class=\"mi\" id=\"MathJax-Span-2269\" style=\"font-size: 70.7%; font-family: STIXNonUnicode-Italic;\">Óà∞</span></span></span><span class=\"mo\" id=\"MathJax-Span-2270\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2271\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-2272\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2273\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2274\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-2275\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2276\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2277\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2278\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-2279\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"texatom\" id=\"MathJax-Span-2280\"><span class=\"mrow\" id=\"MathJax-Span-2281\"><span class=\"mo\" id=\"MathJax-Span-2282\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-2283\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2284\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2285\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-2286\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2287\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2288\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2289\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2290\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-2291\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2292\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">J</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>‚àº</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">D</mi></mrow><mo>,</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo>‚àº</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo stretchy=\"false\">[</mo><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div>\n<ul>\n  <li>The model parameters are updated using RL methods such as policy gradient or Proximal Policy Optimization (PPO), as used in RLHF by <a href=\"https://arxiv.org/abs/1706.03741\">Christiano et al. (2017)</a> and its language-model applications in <strong>InstructGPT</strong> by <a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al. (2022)</a>.</li>\n</ul>\n<h4 id=\"mechanism-9\">Mechanism</h4>\n<ol>\n  <li><strong>Base model:</strong>\n    <ul>\n      <li>Start with a pretrained LLM capable of multi-step reasoning (e.g., instruction-tuned).</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Reward design:</strong></p>\n\n    <ul>\n      <li><em>Outcome-based rewards:</em> correctness of final answer.</li>\n      <li><em>Process-based rewards:</em> alignment with logical or stylistic reasoning norms.</li>\n      <li><em>Efficiency penalties:</em> shorter, more coherent chains get higher reward.</li>\n    </ul>\n  </li>\n  <li><strong>Policy optimization:</strong>\n    <ul>\n      <li>Update the model parameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-167-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2293\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2294\"><span class=\"mi\" id=\"MathJax-Span-2295\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-167\">\\theta</script> to maximize expected reward using policy-gradient methods.</li>\n      <li>\n        <p>The gradient estimate is:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-168-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>J</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mo stretchy=&quot;false&quot;>(</mo><mi>R</mi><mo>&amp;#x2212;</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2296\" style=\"width: 18.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 15.315em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1015.21em, 2.867em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2297\"><span class=\"msubsup\" id=\"MathJax-Span-2298\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2299\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2300\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2301\"><span class=\"mrow\" id=\"MathJax-Span-2302\"><span class=\"mi\" id=\"MathJax-Span-2303\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∂<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2304\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2305\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2306\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2307\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-2308\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-2309\"><span class=\"mi\" id=\"MathJax-Span-2310\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span class=\"mo\" id=\"MathJax-Span-2311\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mo\" id=\"MathJax-Span-2312\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2313\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2314\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2315\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">b</span><span class=\"mo\" id=\"MathJax-Span-2316\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-2317\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2318\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2319\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2320\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-2321\"></span><span class=\"msubsup\" id=\"MathJax-Span-2322\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2323\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2324\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2325\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2326\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2327\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2328\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"texatom\" id=\"MathJax-Span-2329\"><span class=\"mrow\" id=\"MathJax-Span-2330\"><span class=\"mo\" id=\"MathJax-Span-2331\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-2332\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2333\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2334\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">J</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>R</mi><mo>‚àí</mo><mi>b</mi><mo stretchy=\"false\">)</mo><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>log</mi><mo>‚Å°</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-168\">\\nabla_\\theta \\mathcal{J}(\\theta) = \\mathbb{E}[(R - b)\\nabla_\\theta \\log p_\\theta(y,z|x)]</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-169-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2335\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2336\"><span class=\"mi\" id=\"MathJax-Span-2337\" style=\"font-family: STIXGeneral-Italic;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-169\">b</script> is a baseline to reduce variance.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li><strong>Iterative refinement:</strong>\nFeedback from reward models, verification models, or external evaluators is used to shape the model‚Äôs reasoning distribution.</li>\n</ol>\n<ul>\n      <li>Start with a pretrained LLM capable of multi-step reasoning (e.g., instruction-tuned).</li>\n    </ul>\n<p><strong>Reward design:</strong></p>\n<ul>\n      <li><em>Outcome-based rewards:</em> correctness of final answer.</li>\n      <li><em>Process-based rewards:</em> alignment with logical or stylistic reasoning norms.</li>\n      <li><em>Efficiency penalties:</em> shorter, more coherent chains get higher reward.</li>\n    </ul>\n<ul>\n      <li>Update the model parameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-167-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2293\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2294\"><span class=\"mi\" id=\"MathJax-Span-2295\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-167\">\\theta</script> to maximize expected reward using policy-gradient methods.</li>\n      <li>\n        <p>The gradient estimate is:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-168-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>J</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mo stretchy=&quot;false&quot;>(</mo><mi>R</mi><mo>&amp;#x2212;</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2296\" style=\"width: 18.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 15.315em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1015.21em, 2.867em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2297\"><span class=\"msubsup\" id=\"MathJax-Span-2298\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2299\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2300\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2301\"><span class=\"mrow\" id=\"MathJax-Span-2302\"><span class=\"mi\" id=\"MathJax-Span-2303\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∂<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2304\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2305\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2306\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2307\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-2308\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-2309\"><span class=\"mi\" id=\"MathJax-Span-2310\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span class=\"mo\" id=\"MathJax-Span-2311\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mo\" id=\"MathJax-Span-2312\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2313\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2314\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2315\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">b</span><span class=\"mo\" id=\"MathJax-Span-2316\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-2317\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2318\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2319\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2320\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-2321\"></span><span class=\"msubsup\" id=\"MathJax-Span-2322\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2323\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2324\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2325\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2326\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2327\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2328\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"texatom\" id=\"MathJax-Span-2329\"><span class=\"mrow\" id=\"MathJax-Span-2330\"><span class=\"mo\" id=\"MathJax-Span-2331\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-2332\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2333\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2334\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">J</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>R</mi><mo>‚àí</mo><mi>b</mi><mo stretchy=\"false\">)</mo><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>log</mi><mo>‚Å°</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-168\">\\nabla_\\theta \\mathcal{J}(\\theta) = \\mathbb{E}[(R - b)\\nabla_\\theta \\log p_\\theta(y,z|x)]</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-169-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2335\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2336\"><span class=\"mi\" id=\"MathJax-Span-2337\" style=\"font-family: STIXGeneral-Italic;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-169\">b</script> is a baseline to reduce variance.</li>\n        </ul>\n      </li>\n    </ul>\n<p>The gradient estimate is:</p>\n<ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-169-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2335\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2336\"><span class=\"mi\" id=\"MathJax-Span-2337\" style=\"font-family: STIXGeneral-Italic;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-169\">b</script> is a baseline to reduce variance.</li>\n        </ul>\n<h4 id=\"deepseek-r1-highlights\">DeepSeek-R1 Highlights</h4>\n<ul>\n  <li><strong>No human-annotated rationales:</strong> The system learns reasoning <em>emergently</em> through reward shaping.</li>\n  <li><strong>Curriculum design:</strong> Rewards evolve from simple tasks (e.g., arithmetic) to complex reasoning (e.g., proofs, logical deduction).</li>\n  <li><strong>Outcome:</strong> Demonstrated significant improvements on mathematical and logic benchmarks, outperforming supervised CoT-trained baselines.</li>\n</ul>\n<h4 id=\"theoretical-framing-4\">Theoretical Framing</h4>\n<ul>\n  <li>Reasoning is formalized as sequential decision-making with hidden intermediate states:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-170-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>z</mi><mi>t</mi></msub><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo>,</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mi>R</mi><mi>T</mi></msub><mo>=</mo><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>T</mi></msub><mo>,</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2264;</mo><mi>T</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2338\" style=\"width: 17.294em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.378em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1014.33em, 2.867em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2339\"><span class=\"msubsup\" id=\"MathJax-Span-2340\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2341\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2342\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2343\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-2344\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2345\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2346\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2347\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2348\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2349\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2350\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2351\"><span class=\"mrow\" id=\"MathJax-Span-2352\"><span class=\"mo\" id=\"MathJax-Span-2353\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-2354\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2355\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2356\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2357\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2358\"><span class=\"mrow\" id=\"MathJax-Span-2359\"><span class=\"mo\" id=\"MathJax-Span-2360\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-2361\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2362\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2363\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-2364\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-2365\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2366\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2367\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2368\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-2369\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2370\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2371\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2372\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2373\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2374\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2375\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2376\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2377\"><span class=\"mrow\" id=\"MathJax-Span-2378\"><span class=\"mo\" id=\"MathJax-Span-2379\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚â§</span><span class=\"mi\" id=\"MathJax-Span-2380\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2381\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>z</mi><mi>t</mi></msub><mo>‚àº</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo>,</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>&lt;</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mspace width=\"1em\"></mspace><msub><mi>R</mi><mi>T</mi></msub><mo>=</mo><mi>r</mi><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>T</mi></msub><mo>,</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>‚â§</mo><mi>T</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span></div>\n<ul>\n  <li>The RL agent (the LLM) learns to compose ‚Äúthoughts‚Äù that maximize expected cumulative reward, rather than likelihood of training text.\nThis bridges <em>text prediction</em> and <em>deliberate reasoning</em> via credit assignment.</li>\n</ul>\n<h4 id=\"advantages-8\">Advantages</h4>\n<ul>\n  <li>Encourages reasoning structures that generalize beyond training distributions.</li>\n  <li>Does not require labeled step-by-step data.</li>\n  <li>Enables automated self-improvement through reward feedback.</li>\n</ul>\n<h4 id=\"limitations-8\">Limitations</h4>\n<ul>\n  <li>Reward specification is delicate‚Äîpoorly designed rewards can lead to reasoning shortcuts or gaming behavior.</li>\n  <li>High computational cost due to exploration and rollouts.</li>\n  <li>Credit assignment remains challenging for long reasoning chains.</li>\n</ul>\n<h4 id=\"related-work\">Related Work</h4>\n<ul>\n  <li><em>Reflexion</em> by <a href=\"https://arxiv.org/abs/2303.11366\">Shinn et al. (2023)</a>: integrates self-reflective RL to iteratively improve reasoning quality.</li>\n  <li><em>Constitutional AI</em> by <a href=\"https://arxiv.org/abs/2212.08073\">Bai et al. (2022)</a>: replaces human feedback with rule-based evaluators to align reasoning.</li>\n  <li><em>Tool-Augmented RLHF</em> by <a href=\"https://arxiv.org/abs/2109.01652\">Nakano et al. (2021)</a>: incorporates tool usage (e.g., code execution) into reward computation.</li>\n  <li>In summary, RL-based reasoning represents a shift from <em>pattern completion</em> to <em>goal-directed optimization</em>, allowing models to discover reasoning patterns that are not explicitly demonstrated in the data.</li>\n</ul>\n<h4 id=\"deepseek-r1-practical-takeaways-and-design-patterns\">DeepSeek-R1: Practical Takeaways and Design Patterns</h4>\n<ul>\n  <li>\n    <p>DeepSeek-R1 reframed ‚Äúreasoning‚Äù as a policy-optimization problem: start from a capable base model, define reward signals that prefer verifiable reasoning, and use RL to shape the latent steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-171-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2382\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2383\"><span class=\"mi\" id=\"MathJax-Span-2384\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-171\">z</script> so that correct, readable chains become high-probability trajectories. The core lesson is operational: if you can score intermediate or final products reliably, you can push an LLM from pattern completion toward deliberate computation. For context on the method and results, see DeepSeek-R1 by <a href=\"https://arxiv.org/abs/2501.12948\">Guo et al. (2025)</a>.</p>\n  </li>\n  <li>\n    <p><strong>What DeepSeek-R1 actually optimizes</strong>:</p>\n\n    <ul>\n      <li>\n        <p>At a high level, R1 maximizes expected reward over sampled chains:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-172-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>J</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>&amp;#x223C;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>D</mi></mrow><mo>,</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo>&amp;#x223C;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2385\" style=\"width: 14.638em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1011.98em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2386\"><span class=\"texatom\" id=\"MathJax-Span-2387\"><span class=\"mrow\" id=\"MathJax-Span-2388\"><span class=\"mi\" id=\"MathJax-Span-2389\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∂<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2390\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2391\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2392\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2393\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2394\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 5.315em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2395\"><span class=\"mrow\" id=\"MathJax-Span-2396\"><span class=\"mi\" id=\"MathJax-Span-2397\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2398\"><span class=\"mrow\" id=\"MathJax-Span-2399\"><span class=\"mi\" id=\"MathJax-Span-2400\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2401\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"texatom\" id=\"MathJax-Span-2402\"><span class=\"mrow\" id=\"MathJax-Span-2403\"><span class=\"mi\" id=\"MathJax-Span-2404\" style=\"font-size: 70.7%; font-family: STIXNonUnicode-Italic;\">Óà∞</span></span></span><span class=\"mo\" id=\"MathJax-Span-2405\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2406\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-2407\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2408\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2409\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-2410\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2411\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2412\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2413\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-2414\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-2415\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2416\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2417\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2418\"><span class=\"mrow\" id=\"MathJax-Span-2419\"><span class=\"mo\" id=\"MathJax-Span-2420\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2421\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2422\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2423\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2424\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2425\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-2426\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-2427\"><span class=\"mrow\" id=\"MathJax-Span-2428\"><span class=\"mo\" id=\"MathJax-Span-2429\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">J</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>‚àº</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">D</mi></mrow><mo>,</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo>‚àº</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-172\">\\mathcal{J}(\\theta)=\\mathbb{E}_{x\\sim\\mathcal{D},z,y\\sim p_\\theta(\\cdot\\mid x)}\\big[R(y,z)\\big]</script>\n\n        <ul>\n          <li>\n            <p>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-173-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2430\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2431\"><span class=\"mi\" id=\"MathJax-Span-2432\" style=\"font-family: STIXGeneral-Italic;\">R</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-173\">R</script> blends correctness checks (exact answer, executable solver success), parsimony/format constraints, and sometimes readability penalties. In practice, implementations report variants of PPO/GRPO‚Äìstyle policy gradients:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-174-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>J</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>R</mi><mo>&amp;#x2212;</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2433\" style=\"width: 19.846em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1016.3em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2434\"><span class=\"msubsup\" id=\"MathJax-Span-2435\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2436\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2437\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2438\"><span class=\"mrow\" id=\"MathJax-Span-2439\"><span class=\"mi\" id=\"MathJax-Span-2440\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∂<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2441\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2442\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2443\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2444\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"texatom\" id=\"MathJax-Span-2445\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-2446\"><span class=\"mi\" id=\"MathJax-Span-2447\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span class=\"texatom\" id=\"MathJax-Span-2448\"><span class=\"mrow\" id=\"MathJax-Span-2449\"><span class=\"mo\" id=\"MathJax-Span-2450\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2451\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2452\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2453\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2454\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">b</span><span class=\"mo\" id=\"MathJax-Span-2455\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2456\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2457\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2458\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2459\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2460\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-2461\"></span><span class=\"msubsup\" id=\"MathJax-Span-2462\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2463\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2464\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2465\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2466\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2467\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2468\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-2469\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2470\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2471\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-2472\"><span class=\"mrow\" id=\"MathJax-Span-2473\"><span class=\"mo\" id=\"MathJax-Span-2474\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">J</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>‚âà</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mo stretchy=\"false\">(</mo><mi>R</mi><mo>‚àí</mo><mi>b</mi><mo stretchy=\"false\">)</mo><mo>,</mo><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>log</mi><mo>‚Å°</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-174\">\\nabla_\\theta\\mathcal{J}(\\theta)\\approx \\mathbb{E}\\big[(R-b),\\nabla_\\theta\\log p_\\theta(y,z\\mid x)\\big]</script>\n\n            <ul>\n              <li>‚Ä¶ with a baseline <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-175-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2475\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2476\"><span class=\"mi\" id=\"MathJax-Span-2477\" style=\"font-family: STIXGeneral-Italic;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-175\">b</script> for variance reduction. R1 also uses staged training (e.g., cold-start data before RL) to stabilize exploration and improve ‚Äúreadability‚Äù of chains. See the paper for the multi-stage schedule and comparisons to o1-style models.</li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Why process supervision still matters</strong>:</p>\n\n    <ul>\n      <li>Even when you train only on outcome rewards, a verified step signal improves stability and sample efficiency. A practical alternative or complement is process reward modeling (PRM): label or auto-label whether each step is correct, then reward step sequences. This was shown to beat outcome-only supervision on MATH in Let‚Äôs Verify Step by Step by <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a> and the accompanying OpenAI report by <a href=\"https://openai.com/index/improving-mathematical-reasoning-with-process-supervision/\">OpenAI (2023)</a>.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>A minimal R1-style recipe you can reproduce</strong>:</p>\n\n    <ol>\n      <li>Collect tasks with verifiable end states (GSM8K, AIME, MATH). Build an automatic checker <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-176-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2478\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2479\"><span class=\"mi\" id=\"MathJax-Span-2480\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-176\">V</script> that returns 1 when answers or traces pass.</li>\n      <li>Train a small verifier or PRM if you can: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-177-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2481\" style=\"width: 6.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1005.37em, 2.555em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2482\"><span class=\"mi\" id=\"MathJax-Span-2483\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2484\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2485\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2486\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2487\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2488\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2489\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àà</span><span class=\"mo\" id=\"MathJax-Span-2490\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">[</span><span class=\"mn\" id=\"MathJax-Span-2491\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-2492\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-2493\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-2494\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àà</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-177\">V(z_t)\\in[0,1]</script> for each step. Use it either as reward shaping <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-178-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><munder><mo>&amp;#x2211;</mo><mi>t</mi></munder><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2495\" style=\"width: 4.273em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.544em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1003.49em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2496\"><span class=\"munderover\" id=\"MathJax-Span-2497\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2498\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-2499\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2500\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2501\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2502\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2503\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2504\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2505\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><munder><mo>‚àë</mo><mi>t</mi></munder><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-178\">\\sum_t V(z_t)</script> or as a filter at decode time.</li>\n      <li>Warm-start with supervised or distilled rationales to avoid unreadable chains; then switch to RL for exploration.</li>\n      <li>Optimize a composite reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-179-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo>=</mo><msub><mi>&amp;#x03BB;</mi><mn>1</mn></msub><mtext>Correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msub><mi>&amp;#x03BB;</mi><mn>2</mn></msub><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></munder><mtext>StepOK</mtext><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>&amp;#x03BB;</mi><mn>3</mn></msub><mtext>Length</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>&amp;#x03BB;</mi><mn>4</mn></msub><mtext>FormatViolations</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2506\" style=\"width: 37.346em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 31.096em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1031.04em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2507\"><span class=\"mi\" id=\"MathJax-Span-2508\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2509\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2510\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2511\" style=\"font-family: STIXGeneral-Italic;\">Œª</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mn\" id=\"MathJax-Span-2512\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mtext\" id=\"MathJax-Span-2513\" style=\"font-family: STIXGeneral-Regular;\">Correct</span><span class=\"mo\" id=\"MathJax-Span-2514\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2515\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2516\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2517\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-2518\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2519\" style=\"font-family: STIXGeneral-Italic;\">Œª</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mn\" id=\"MathJax-Span-2520\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-2521\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2522\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-2523\"><span class=\"mrow\" id=\"MathJax-Span-2524\"><span class=\"mi\" id=\"MathJax-Span-2525\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mtext\" id=\"MathJax-Span-2526\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">StepOK</span><span class=\"mo\" id=\"MathJax-Span-2527\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2528\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2529\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2530\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2531\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2532\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-2533\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2534\" style=\"font-family: STIXGeneral-Italic;\">Œª</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mn\" id=\"MathJax-Span-2535\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">3</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mtext\" id=\"MathJax-Span-2536\" style=\"font-family: STIXGeneral-Regular;\">Length</span><span class=\"mo\" id=\"MathJax-Span-2537\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2538\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-2539\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2540\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-2541\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2542\" style=\"font-family: STIXGeneral-Italic;\">Œª</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mn\" id=\"MathJax-Span-2543\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">4</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mtext\" id=\"MathJax-Span-2544\" style=\"font-family: STIXGeneral-Regular;\">FormatViolations</span><span class=\"mo\" id=\"MathJax-Span-2545\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2546\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-2547\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo>=</mo><msub><mi>Œª</mi><mn>1</mn></msub><mtext>Correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>+</mo><msub><mi>Œª</mi><mn>2</mn></msub><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi></mrow></munder><mtext>StepOK</mtext><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>Œª</mi><mn>3</mn></msub><mtext>Length</mtext><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>Œª</mi><mn>4</mn></msub><mtext>FormatViolations</mtext><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-179\">R=\\lambda_1\\text{Correct}(y)+\\lambda_2\\sum_{t}\\text{StepOK}(z_t)-\\lambda_3\\text{Length}(z)-\\lambda_4\\text{FormatViolations}(z)</script>, tuning <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-180-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03BB;</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2548\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.73em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2549\"><span class=\"msubsup\" id=\"MathJax-Span-2550\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2551\" style=\"font-family: STIXGeneral-Italic;\">Œª</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2552\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Œª</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-180\">\\lambda_i</script> for your domain.</li>\n      <li>During inference, marginalize over latent thoughts with a small self-consistency budget <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-181-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2553\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2554\"><span class=\"mi\" id=\"MathJax-Span-2555\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-181\">K</script> and pick via verifier-guided selection‚Äîper Self-Consistency by <a href=\"https://arxiv.org/abs/2203.11171\">Wang et al. (2022)</a>.</li>\n    </ol>\n  </li>\n  <li>\n    <p><strong>Design patterns that travel well beyond R1</strong>:</p>\n\n    <ul>\n      <li>\n        <p><strong>Reward the thing you can check:</strong> If you can compile problems to executable checks, outcome-only RL is often enough to induce useful structure; add PRM when you need reliability. Evidence: process supervision consistently outperforms outcome supervision on math reasoning.</p>\n      </li>\n      <li>\n        <p><strong>Stage your training:</strong> Short supervised warm-ups (few curated traces) can prevent RL from converging on unreadable or language-mixed chains before formatting penalties kick in. DeepSeek-R1 explicitly reports multi-stage training to address readability and stability.</p>\n      </li>\n      <li>\n        <p><strong>Keep decoding and training consistent:</strong> If you will use verifier-guided selection at inference, train with that verifier ‚Äúin the loop‚Äù (e.g., as a reward or rejection sampler) to reduce train‚Äìtest mismatch.</p>\n      </li>\n      <li>\n        <p><strong>Prefer execution and tools over narration where possible:</strong> Program-aided solving (e.g., Python) shrinks the search space and makes rewards less noisy; combine with ReAct-style tool calls when tasks need retrieval or computation, as in ReAct by <a href=\"https://arxiv.org/abs/2210.03629\">Yao et al. (2022)</a>.</p>\n      </li>\n      <li>\n        <p><strong>Budget your ‚Äúthinking.:</strong> Use a small <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-182-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2556\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2557\"><span class=\"mi\" id=\"MathJax-Span-2558\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-182\">K</script> for self-consistency, then select with <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-183-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2559\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2560\"><span class=\"mi\" id=\"MathJax-Span-2561\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-183\">V</script>. You approximate <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-184-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi></mrow></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2562\" style=\"width: 14.378em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.982em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1011.77em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2563\"><span class=\"texatom\" id=\"MathJax-Span-2564\"><span class=\"mrow\" id=\"MathJax-Span-2565\"><span class=\"munderover\" id=\"MathJax-Span-2566\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2567\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-2568\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2569\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-2570\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-2571\"></span><span class=\"munderover\" id=\"MathJax-Span-2572\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2573\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"mi\" id=\"MathJax-Span-2574\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-2575\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2576\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-2577\"><span class=\"mrow\" id=\"MathJax-Span-2578\"><span class=\"mi\" id=\"MathJax-Span-2579\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-2580\"><span class=\"mrow\" id=\"MathJax-Span-2581\"><span class=\"mi\" id=\"MathJax-Span-2582\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2583\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-2584\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2585\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-2586\"><span class=\"mi\" id=\"MathJax-Span-2587\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"texatom\" id=\"MathJax-Span-2588\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-2589\"><span class=\"mo\" id=\"MathJax-Span-2590\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2591\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2592\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-2593\"><span class=\"mrow\" id=\"MathJax-Span-2594\"><span class=\"mo\" id=\"MathJax-Span-2595\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2596\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2597\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2598\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-2599\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span><span class=\"texatom\" id=\"MathJax-Span-2600\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-2601\"><span class=\"mo\" id=\"MathJax-Span-2602\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>K</mi></mrow></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-184\">\\hat{y}=\\arg\\max_y \\sum_{k=1}^{K}\\mathbb{I} \\big[y^{(k)}=y\\big]</script>, without exploding cost‚Äîagain following <a href=\"https://arxiv.org/abs/2203.11171\">Wang et al. (2022)</a>.</p>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Operational pitfalls and guardrails</strong>:</p>\n\n    <ul>\n      <li>\n        <p><strong>Reward hacking and shortcutting:</strong> If the checker can be gamed (format cues, guessable ranges), the policy will exploit it. Rotate perturbations and adversarial seeds; log chains alongside rewards. DeepSeek-R1 notes emergent but sometimes messy behaviors under pure RL.</p>\n      </li>\n      <li>\n        <p><strong>Over-deliberation and cost blow-ups:</strong> RL-trained reasoners may produce unnecessarily long chains. Penalize chain length and add early-stop verifiers; at inference, cap steps and prune with a threshold on <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-185-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2603\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2604\"><span class=\"mi\" id=\"MathJax-Span-2605\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-185\">V</script>.</p>\n      </li>\n      <li>\n        <p><strong>Verification bottlenecks:</strong> Human step labels do not scale. Borrow from PRM800K and template-based auto-labeling when feasible, and fall back to outcome-only rewards with strong executors; see <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a>.</p>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Where R1 fits in the broader landscape</strong>:</p>\n\n    <ul>\n      <li>R1-style RL sits between explicit prompting methods (CoT, self-consistency) and full agentic loops (ReAct/tools). It supplies a training-time force that makes those inference-time interfaces work more reliably: prompts elicit better chains, verifiers select more often-correct ones, and tools ground intermediate steps. That combination‚Äîpolicy shaping + marginalization + verification‚Äîis, to date, the most reliable way to turn text generators into auditable reasoners. For the primary R1 paper, see <a href=\"https://arxiv.org/abs/2501.12948\">Guo et al. (2025)</a>; for process supervision foundations, see <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a> and OpenAI‚Äôs report by <a href=\"https://openai.com/index/improving-mathematical-reasoning-with-process-supervision/\">OpenAI (2023)</a>.</li>\n    </ul>\n  </li>\n</ul>\n<p>DeepSeek-R1 reframed ‚Äúreasoning‚Äù as a policy-optimization problem: start from a capable base model, define reward signals that prefer verifiable reasoning, and use RL to shape the latent steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-171-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2382\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2383\"><span class=\"mi\" id=\"MathJax-Span-2384\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-171\">z</script> so that correct, readable chains become high-probability trajectories. The core lesson is operational: if you can score intermediate or final products reliably, you can push an LLM from pattern completion toward deliberate computation. For context on the method and results, see DeepSeek-R1 by <a href=\"https://arxiv.org/abs/2501.12948\">Guo et al. (2025)</a>.</p>\n<p><strong>What DeepSeek-R1 actually optimizes</strong>:</p>\n<ul>\n      <li>\n        <p>At a high level, R1 maximizes expected reward over sampled chains:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-172-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>J</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>&amp;#x223C;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>D</mi></mrow><mo>,</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo>&amp;#x223C;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2385\" style=\"width: 14.638em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1011.98em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2386\"><span class=\"texatom\" id=\"MathJax-Span-2387\"><span class=\"mrow\" id=\"MathJax-Span-2388\"><span class=\"mi\" id=\"MathJax-Span-2389\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∂<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2390\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2391\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2392\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2393\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2394\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 5.315em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2395\"><span class=\"mrow\" id=\"MathJax-Span-2396\"><span class=\"mi\" id=\"MathJax-Span-2397\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2398\"><span class=\"mrow\" id=\"MathJax-Span-2399\"><span class=\"mi\" id=\"MathJax-Span-2400\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2401\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"texatom\" id=\"MathJax-Span-2402\"><span class=\"mrow\" id=\"MathJax-Span-2403\"><span class=\"mi\" id=\"MathJax-Span-2404\" style=\"font-size: 70.7%; font-family: STIXNonUnicode-Italic;\">Óà∞</span></span></span><span class=\"mo\" id=\"MathJax-Span-2405\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2406\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-2407\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2408\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2409\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-2410\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2411\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2412\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2413\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-2414\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-2415\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2416\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2417\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2418\"><span class=\"mrow\" id=\"MathJax-Span-2419\"><span class=\"mo\" id=\"MathJax-Span-2420\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2421\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2422\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2423\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2424\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2425\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-2426\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-2427\"><span class=\"mrow\" id=\"MathJax-Span-2428\"><span class=\"mo\" id=\"MathJax-Span-2429\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">J</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>‚àº</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">D</mi></mrow><mo>,</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo>‚àº</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-172\">\\mathcal{J}(\\theta)=\\mathbb{E}_{x\\sim\\mathcal{D},z,y\\sim p_\\theta(\\cdot\\mid x)}\\big[R(y,z)\\big]</script>\n\n        <ul>\n          <li>\n            <p>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-173-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2430\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2431\"><span class=\"mi\" id=\"MathJax-Span-2432\" style=\"font-family: STIXGeneral-Italic;\">R</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-173\">R</script> blends correctness checks (exact answer, executable solver success), parsimony/format constraints, and sometimes readability penalties. In practice, implementations report variants of PPO/GRPO‚Äìstyle policy gradients:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-174-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>J</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>R</mi><mo>&amp;#x2212;</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2433\" style=\"width: 19.846em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1016.3em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2434\"><span class=\"msubsup\" id=\"MathJax-Span-2435\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2436\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2437\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2438\"><span class=\"mrow\" id=\"MathJax-Span-2439\"><span class=\"mi\" id=\"MathJax-Span-2440\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∂<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2441\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2442\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2443\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2444\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"texatom\" id=\"MathJax-Span-2445\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-2446\"><span class=\"mi\" id=\"MathJax-Span-2447\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span class=\"texatom\" id=\"MathJax-Span-2448\"><span class=\"mrow\" id=\"MathJax-Span-2449\"><span class=\"mo\" id=\"MathJax-Span-2450\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2451\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2452\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2453\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2454\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">b</span><span class=\"mo\" id=\"MathJax-Span-2455\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2456\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2457\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2458\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2459\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2460\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-2461\"></span><span class=\"msubsup\" id=\"MathJax-Span-2462\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2463\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2464\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2465\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2466\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2467\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2468\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-2469\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2470\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2471\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-2472\"><span class=\"mrow\" id=\"MathJax-Span-2473\"><span class=\"mo\" id=\"MathJax-Span-2474\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">J</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>‚âà</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mo stretchy=\"false\">(</mo><mi>R</mi><mo>‚àí</mo><mi>b</mi><mo stretchy=\"false\">)</mo><mo>,</mo><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>log</mi><mo>‚Å°</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-174\">\\nabla_\\theta\\mathcal{J}(\\theta)\\approx \\mathbb{E}\\big[(R-b),\\nabla_\\theta\\log p_\\theta(y,z\\mid x)\\big]</script>\n\n            <ul>\n              <li>‚Ä¶ with a baseline <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-175-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2475\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2476\"><span class=\"mi\" id=\"MathJax-Span-2477\" style=\"font-family: STIXGeneral-Italic;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-175\">b</script> for variance reduction. R1 also uses staged training (e.g., cold-start data before RL) to stabilize exploration and improve ‚Äúreadability‚Äù of chains. See the paper for the multi-stage schedule and comparisons to o1-style models.</li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ul>\n<p>At a high level, R1 maximizes expected reward over sampled chains:</p>\n<ul>\n          <li>\n            <p>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-173-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2430\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2431\"><span class=\"mi\" id=\"MathJax-Span-2432\" style=\"font-family: STIXGeneral-Italic;\">R</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-173\">R</script> blends correctness checks (exact answer, executable solver success), parsimony/format constraints, and sometimes readability penalties. In practice, implementations report variants of PPO/GRPO‚Äìstyle policy gradients:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-174-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>J</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>R</mi><mo>&amp;#x2212;</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2433\" style=\"width: 19.846em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1016.3em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2434\"><span class=\"msubsup\" id=\"MathJax-Span-2435\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2436\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2437\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2438\"><span class=\"mrow\" id=\"MathJax-Span-2439\"><span class=\"mi\" id=\"MathJax-Span-2440\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∂<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2441\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2442\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2443\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2444\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"texatom\" id=\"MathJax-Span-2445\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-2446\"><span class=\"mi\" id=\"MathJax-Span-2447\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span class=\"texatom\" id=\"MathJax-Span-2448\"><span class=\"mrow\" id=\"MathJax-Span-2449\"><span class=\"mo\" id=\"MathJax-Span-2450\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2451\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2452\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2453\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2454\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">b</span><span class=\"mo\" id=\"MathJax-Span-2455\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2456\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2457\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2458\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2459\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2460\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-2461\"></span><span class=\"msubsup\" id=\"MathJax-Span-2462\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2463\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2464\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2465\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2466\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2467\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2468\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-2469\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2470\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2471\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-2472\"><span class=\"mrow\" id=\"MathJax-Span-2473\"><span class=\"mo\" id=\"MathJax-Span-2474\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">J</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>‚âà</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mo stretchy=\"false\">(</mo><mi>R</mi><mo>‚àí</mo><mi>b</mi><mo stretchy=\"false\">)</mo><mo>,</mo><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>log</mi><mo>‚Å°</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-174\">\\nabla_\\theta\\mathcal{J}(\\theta)\\approx \\mathbb{E}\\big[(R-b),\\nabla_\\theta\\log p_\\theta(y,z\\mid x)\\big]</script>\n\n            <ul>\n              <li>‚Ä¶ with a baseline <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-175-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2475\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2476\"><span class=\"mi\" id=\"MathJax-Span-2477\" style=\"font-family: STIXGeneral-Italic;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-175\">b</script> for variance reduction. R1 also uses staged training (e.g., cold-start data before RL) to stabilize exploration and improve ‚Äúreadability‚Äù of chains. See the paper for the multi-stage schedule and comparisons to o1-style models.</li>\n            </ul>\n          </li>\n        </ul>\n<p>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-173-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2430\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2431\"><span class=\"mi\" id=\"MathJax-Span-2432\" style=\"font-family: STIXGeneral-Italic;\">R</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-173\">R</script> blends correctness checks (exact answer, executable solver success), parsimony/format constraints, and sometimes readability penalties. In practice, implementations report variants of PPO/GRPO‚Äìstyle policy gradients:</p>\n<ul>\n              <li>‚Ä¶ with a baseline <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-175-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2475\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2476\"><span class=\"mi\" id=\"MathJax-Span-2477\" style=\"font-family: STIXGeneral-Italic;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-175\">b</script> for variance reduction. R1 also uses staged training (e.g., cold-start data before RL) to stabilize exploration and improve ‚Äúreadability‚Äù of chains. See the paper for the multi-stage schedule and comparisons to o1-style models.</li>\n            </ul>\n<p><strong>Why process supervision still matters</strong>:</p>\n<ul>\n      <li>Even when you train only on outcome rewards, a verified step signal improves stability and sample efficiency. A practical alternative or complement is process reward modeling (PRM): label or auto-label whether each step is correct, then reward step sequences. This was shown to beat outcome-only supervision on MATH in Let‚Äôs Verify Step by Step by <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a> and the accompanying OpenAI report by <a href=\"https://openai.com/index/improving-mathematical-reasoning-with-process-supervision/\">OpenAI (2023)</a>.</li>\n    </ul>\n<p><strong>A minimal R1-style recipe you can reproduce</strong>:</p>\n<ol>\n      <li>Collect tasks with verifiable end states (GSM8K, AIME, MATH). Build an automatic checker <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-176-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2478\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2479\"><span class=\"mi\" id=\"MathJax-Span-2480\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-176\">V</script> that returns 1 when answers or traces pass.</li>\n      <li>Train a small verifier or PRM if you can: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-177-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2481\" style=\"width: 6.565em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1005.37em, 2.555em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2482\"><span class=\"mi\" id=\"MathJax-Span-2483\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2484\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2485\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2486\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2487\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2488\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2489\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àà</span><span class=\"mo\" id=\"MathJax-Span-2490\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">[</span><span class=\"mn\" id=\"MathJax-Span-2491\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-2492\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-2493\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-2494\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àà</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-177\">V(z_t)\\in[0,1]</script> for each step. Use it either as reward shaping <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-178-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><munder><mo>&amp;#x2211;</mo><mi>t</mi></munder><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2495\" style=\"width: 4.273em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.544em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1003.49em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2496\"><span class=\"munderover\" id=\"MathJax-Span-2497\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2498\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-2499\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2500\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2501\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2502\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2503\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2504\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2505\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><munder><mo>‚àë</mo><mi>t</mi></munder><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-178\">\\sum_t V(z_t)</script> or as a filter at decode time.</li>\n      <li>Warm-start with supervised or distilled rationales to avoid unreadable chains; then switch to RL for exploration.</li>\n      <li>Optimize a composite reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-179-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo>=</mo><msub><mi>&amp;#x03BB;</mi><mn>1</mn></msub><mtext>Correct</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msub><mi>&amp;#x03BB;</mi><mn>2</mn></msub><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></munder><mtext>StepOK</mtext><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>&amp;#x03BB;</mi><mn>3</mn></msub><mtext>Length</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>&amp;#x03BB;</mi><mn>4</mn></msub><mtext>FormatViolations</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2506\" style=\"width: 37.346em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 31.096em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1031.04em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2507\"><span class=\"mi\" id=\"MathJax-Span-2508\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2509\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2510\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2511\" style=\"font-family: STIXGeneral-Italic;\">Œª</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mn\" id=\"MathJax-Span-2512\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mtext\" id=\"MathJax-Span-2513\" style=\"font-family: STIXGeneral-Regular;\">Correct</span><span class=\"mo\" id=\"MathJax-Span-2514\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2515\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-2516\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2517\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-2518\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2519\" style=\"font-family: STIXGeneral-Italic;\">Œª</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mn\" id=\"MathJax-Span-2520\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-2521\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2522\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-2523\"><span class=\"mrow\" id=\"MathJax-Span-2524\"><span class=\"mi\" id=\"MathJax-Span-2525\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mtext\" id=\"MathJax-Span-2526\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">StepOK</span><span class=\"mo\" id=\"MathJax-Span-2527\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2528\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2529\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2530\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2531\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2532\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-2533\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2534\" style=\"font-family: STIXGeneral-Italic;\">Œª</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mn\" id=\"MathJax-Span-2535\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">3</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mtext\" id=\"MathJax-Span-2536\" style=\"font-family: STIXGeneral-Regular;\">Length</span><span class=\"mo\" id=\"MathJax-Span-2537\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2538\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-2539\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2540\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-2541\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2542\" style=\"font-family: STIXGeneral-Italic;\">Œª</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mn\" id=\"MathJax-Span-2543\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">4</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mtext\" id=\"MathJax-Span-2544\" style=\"font-family: STIXGeneral-Regular;\">FormatViolations</span><span class=\"mo\" id=\"MathJax-Span-2545\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2546\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-2547\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo>=</mo><msub><mi>Œª</mi><mn>1</mn></msub><mtext>Correct</mtext><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>+</mo><msub><mi>Œª</mi><mn>2</mn></msub><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi></mrow></munder><mtext>StepOK</mtext><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>Œª</mi><mn>3</mn></msub><mtext>Length</mtext><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>Œª</mi><mn>4</mn></msub><mtext>FormatViolations</mtext><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-179\">R=\\lambda_1\\text{Correct}(y)+\\lambda_2\\sum_{t}\\text{StepOK}(z_t)-\\lambda_3\\text{Length}(z)-\\lambda_4\\text{FormatViolations}(z)</script>, tuning <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-180-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03BB;</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2548\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.73em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2549\"><span class=\"msubsup\" id=\"MathJax-Span-2550\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2551\" style=\"font-family: STIXGeneral-Italic;\">Œª</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2552\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Œª</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-180\">\\lambda_i</script> for your domain.</li>\n      <li>During inference, marginalize over latent thoughts with a small self-consistency budget <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-181-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2553\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2554\"><span class=\"mi\" id=\"MathJax-Span-2555\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-181\">K</script> and pick via verifier-guided selection‚Äîper Self-Consistency by <a href=\"https://arxiv.org/abs/2203.11171\">Wang et al. (2022)</a>.</li>\n    </ol>\n<p><strong>Design patterns that travel well beyond R1</strong>:</p>\n<ul>\n      <li>\n        <p><strong>Reward the thing you can check:</strong> If you can compile problems to executable checks, outcome-only RL is often enough to induce useful structure; add PRM when you need reliability. Evidence: process supervision consistently outperforms outcome supervision on math reasoning.</p>\n      </li>\n      <li>\n        <p><strong>Stage your training:</strong> Short supervised warm-ups (few curated traces) can prevent RL from converging on unreadable or language-mixed chains before formatting penalties kick in. DeepSeek-R1 explicitly reports multi-stage training to address readability and stability.</p>\n      </li>\n      <li>\n        <p><strong>Keep decoding and training consistent:</strong> If you will use verifier-guided selection at inference, train with that verifier ‚Äúin the loop‚Äù (e.g., as a reward or rejection sampler) to reduce train‚Äìtest mismatch.</p>\n      </li>\n      <li>\n        <p><strong>Prefer execution and tools over narration where possible:</strong> Program-aided solving (e.g., Python) shrinks the search space and makes rewards less noisy; combine with ReAct-style tool calls when tasks need retrieval or computation, as in ReAct by <a href=\"https://arxiv.org/abs/2210.03629\">Yao et al. (2022)</a>.</p>\n      </li>\n      <li>\n        <p><strong>Budget your ‚Äúthinking.:</strong> Use a small <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-182-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2556\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2557\"><span class=\"mi\" id=\"MathJax-Span-2558\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-182\">K</script> for self-consistency, then select with <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-183-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2559\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2560\"><span class=\"mi\" id=\"MathJax-Span-2561\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-183\">V</script>. You approximate <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-184-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi></mrow></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2562\" style=\"width: 14.378em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.982em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1011.77em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2563\"><span class=\"texatom\" id=\"MathJax-Span-2564\"><span class=\"mrow\" id=\"MathJax-Span-2565\"><span class=\"munderover\" id=\"MathJax-Span-2566\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2567\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-2568\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2569\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-2570\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-2571\"></span><span class=\"munderover\" id=\"MathJax-Span-2572\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2573\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"mi\" id=\"MathJax-Span-2574\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-2575\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2576\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-2577\"><span class=\"mrow\" id=\"MathJax-Span-2578\"><span class=\"mi\" id=\"MathJax-Span-2579\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-2580\"><span class=\"mrow\" id=\"MathJax-Span-2581\"><span class=\"mi\" id=\"MathJax-Span-2582\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2583\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-2584\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2585\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-2586\"><span class=\"mi\" id=\"MathJax-Span-2587\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"texatom\" id=\"MathJax-Span-2588\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-2589\"><span class=\"mo\" id=\"MathJax-Span-2590\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2591\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2592\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-2593\"><span class=\"mrow\" id=\"MathJax-Span-2594\"><span class=\"mo\" id=\"MathJax-Span-2595\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2596\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2597\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2598\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-2599\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span><span class=\"texatom\" id=\"MathJax-Span-2600\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-2601\"><span class=\"mo\" id=\"MathJax-Span-2602\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>K</mi></mrow></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-184\">\\hat{y}=\\arg\\max_y \\sum_{k=1}^{K}\\mathbb{I} \\big[y^{(k)}=y\\big]</script>, without exploding cost‚Äîagain following <a href=\"https://arxiv.org/abs/2203.11171\">Wang et al. (2022)</a>.</p>\n      </li>\n    </ul>\n<p><strong>Reward the thing you can check:</strong> If you can compile problems to executable checks, outcome-only RL is often enough to induce useful structure; add PRM when you need reliability. Evidence: process supervision consistently outperforms outcome supervision on math reasoning.</p>\n<p><strong>Stage your training:</strong> Short supervised warm-ups (few curated traces) can prevent RL from converging on unreadable or language-mixed chains before formatting penalties kick in. DeepSeek-R1 explicitly reports multi-stage training to address readability and stability.</p>\n<p><strong>Keep decoding and training consistent:</strong> If you will use verifier-guided selection at inference, train with that verifier ‚Äúin the loop‚Äù (e.g., as a reward or rejection sampler) to reduce train‚Äìtest mismatch.</p>\n<p><strong>Prefer execution and tools over narration where possible:</strong> Program-aided solving (e.g., Python) shrinks the search space and makes rewards less noisy; combine with ReAct-style tool calls when tasks need retrieval or computation, as in ReAct by <a href=\"https://arxiv.org/abs/2210.03629\">Yao et al. (2022)</a>.</p>\n<p><strong>Budget your ‚Äúthinking.:</strong> Use a small <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-182-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2556\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2557\"><span class=\"mi\" id=\"MathJax-Span-2558\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-182\">K</script> for self-consistency, then select with <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-183-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2559\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2560\"><span class=\"mi\" id=\"MathJax-Span-2561\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-183\">V</script>. You approximate <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-184-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi></mrow></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2562\" style=\"width: 14.378em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.982em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1011.77em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2563\"><span class=\"texatom\" id=\"MathJax-Span-2564\"><span class=\"mrow\" id=\"MathJax-Span-2565\"><span class=\"munderover\" id=\"MathJax-Span-2566\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2567\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-2568\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2569\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-2570\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-2571\"></span><span class=\"munderover\" id=\"MathJax-Span-2572\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2573\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"mi\" id=\"MathJax-Span-2574\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-2575\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2576\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-2577\"><span class=\"mrow\" id=\"MathJax-Span-2578\"><span class=\"mi\" id=\"MathJax-Span-2579\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-2580\"><span class=\"mrow\" id=\"MathJax-Span-2581\"><span class=\"mi\" id=\"MathJax-Span-2582\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2583\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-2584\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2585\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-2586\"><span class=\"mi\" id=\"MathJax-Span-2587\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"texatom\" id=\"MathJax-Span-2588\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-2589\"><span class=\"mo\" id=\"MathJax-Span-2590\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2591\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2592\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-2593\"><span class=\"mrow\" id=\"MathJax-Span-2594\"><span class=\"mo\" id=\"MathJax-Span-2595\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2596\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2597\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2598\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-2599\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span><span class=\"texatom\" id=\"MathJax-Span-2600\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-2601\"><span class=\"mo\" id=\"MathJax-Span-2602\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>K</mi></mrow></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-184\">\\hat{y}=\\arg\\max_y \\sum_{k=1}^{K}\\mathbb{I} \\big[y^{(k)}=y\\big]</script>, without exploding cost‚Äîagain following <a href=\"https://arxiv.org/abs/2203.11171\">Wang et al. (2022)</a>.</p>\n<p><strong>Operational pitfalls and guardrails</strong>:</p>\n<ul>\n      <li>\n        <p><strong>Reward hacking and shortcutting:</strong> If the checker can be gamed (format cues, guessable ranges), the policy will exploit it. Rotate perturbations and adversarial seeds; log chains alongside rewards. DeepSeek-R1 notes emergent but sometimes messy behaviors under pure RL.</p>\n      </li>\n      <li>\n        <p><strong>Over-deliberation and cost blow-ups:</strong> RL-trained reasoners may produce unnecessarily long chains. Penalize chain length and add early-stop verifiers; at inference, cap steps and prune with a threshold on <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-185-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2603\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2604\"><span class=\"mi\" id=\"MathJax-Span-2605\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-185\">V</script>.</p>\n      </li>\n      <li>\n        <p><strong>Verification bottlenecks:</strong> Human step labels do not scale. Borrow from PRM800K and template-based auto-labeling when feasible, and fall back to outcome-only rewards with strong executors; see <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a>.</p>\n      </li>\n    </ul>\n<p><strong>Reward hacking and shortcutting:</strong> If the checker can be gamed (format cues, guessable ranges), the policy will exploit it. Rotate perturbations and adversarial seeds; log chains alongside rewards. DeepSeek-R1 notes emergent but sometimes messy behaviors under pure RL.</p>\n<p><strong>Over-deliberation and cost blow-ups:</strong> RL-trained reasoners may produce unnecessarily long chains. Penalize chain length and add early-stop verifiers; at inference, cap steps and prune with a threshold on <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-185-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2603\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2604\"><span class=\"mi\" id=\"MathJax-Span-2605\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-185\">V</script>.</p>\n<p><strong>Verification bottlenecks:</strong> Human step labels do not scale. Borrow from PRM800K and template-based auto-labeling when feasible, and fall back to outcome-only rewards with strong executors; see <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a>.</p>\n<p><strong>Where R1 fits in the broader landscape</strong>:</p>\n<ul>\n      <li>R1-style RL sits between explicit prompting methods (CoT, self-consistency) and full agentic loops (ReAct/tools). It supplies a training-time force that makes those inference-time interfaces work more reliably: prompts elicit better chains, verifiers select more often-correct ones, and tools ground intermediate steps. That combination‚Äîpolicy shaping + marginalization + verification‚Äîis, to date, the most reliable way to turn text generators into auditable reasoners. For the primary R1 paper, see <a href=\"https://arxiv.org/abs/2501.12948\">Guo et al. (2025)</a>; for process supervision foundations, see <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a> and OpenAI‚Äôs report by <a href=\"https://openai.com/index/improving-mathematical-reasoning-with-process-supervision/\">OpenAI (2023)</a>.</li>\n    </ul>",
    "contentMarkdown": "*   The most prominent example of RL for reasoning is **DeepSeek-R1: Incentivizing Reasoning Capability in LLMs via Reinforcement Learning** by [Guo et al. (2025)](https://arxiv.org/abs/2501.12948).\n\n#### Core Idea\n\n*   DeepSeek-R1 applies RL to improve reasoning performance _without supervised rationales_. The model learns to generate intermediate steps that lead to verifiably correct outcomes, using a **reinforcement signal** that rewards correct or efficient reasoning trajectories.\n    \n*   Formally, for a given problem xxx, reasoning trace zzz, and final answer yyy,\n    \n\nDeepSeek-R1 applies RL to improve reasoning performance _without supervised rationales_. The model learns to generate intermediate steps that lead to verifiably correct outcomes, using a **reinforcement signal** that rewards correct or efficient reasoning trajectories.\n\nFormally, for a given problem xxx, reasoning trace zzz, and final answer yyy,\n\nR(y,z)\\=ùïÄ\\[correct(y)\\]‚àíŒª,costR(y,z)\\=I\\[correct(y)\\]‚àíŒª,costR(y, z) = \\\\mathbb{I}\\[\\\\text{correct}(y)\\] - \\\\lambda , \\\\text{cost}z\n\n*   ‚Ä¶ and the objective is to maximize the expected reward:\n\nÓà∂(Œ∏)\\=ùîºx‚àºÓà∞,z,y‚àºpŒ∏(‚ãÖ|x)\\[R(y,z)\\]J(Œ∏)\\=Ex‚àºD,z,y‚àºpŒ∏(‚ãÖ|x)\\[R(y,z)\\]\n\n*   The model parameters are updated using RL methods such as policy gradient or Proximal Policy Optimization (PPO), as used in RLHF by [Christiano et al. (2017)](https://arxiv.org/abs/1706.03741) and its language-model applications in **InstructGPT** by [Ouyang et al. (2022)](https://arxiv.org/abs/2203.02155).\n\n#### Mechanism\n\n1.  **Base model:**\n    *   Start with a pretrained LLM capable of multi-step reasoning (e.g., instruction-tuned).\n2.  **Reward design:**\n    \n    *   _Outcome-based rewards:_ correctness of final answer.\n    *   _Process-based rewards:_ alignment with logical or stylistic reasoning norms.\n    *   _Efficiency penalties:_ shorter, more coherent chains get higher reward.\n3.  **Policy optimization:**\n    *   Update the model parameters Œ∏Œ∏\\\\theta to maximize expected reward using policy-gradient methods.\n    *   The gradient estimate is:\n        \n        ‚àáŒ∏Óà∂(Œ∏)\\=ùîº\\[(R‚àíb)‚àáŒ∏logpŒ∏(y,z|x)\\]‚àáŒ∏J(Œ∏)\\=E\\[(R‚àíb)‚àáŒ∏log‚Å°pŒ∏(y,z|x)\\]\n        \n        \\\\nabla\\_\\\\theta \\\\mathcal{J}(\\\\theta) = \\\\mathbb{E}\\[(R - b)\\\\nabla\\_\\\\theta \\\\log p\\_\\\\theta(y,z|x)\\]\n        *   where bbb is a baseline to reduce variance.\n4.  **Iterative refinement:** Feedback from reward models, verification models, or external evaluators is used to shape the model‚Äôs reasoning distribution.\n\n*   Start with a pretrained LLM capable of multi-step reasoning (e.g., instruction-tuned).\n\n**Reward design:**\n\n*   _Outcome-based rewards:_ correctness of final answer.\n*   _Process-based rewards:_ alignment with logical or stylistic reasoning norms.\n*   _Efficiency penalties:_ shorter, more coherent chains get higher reward.\n\n*   Update the model parameters Œ∏Œ∏\\\\theta to maximize expected reward using policy-gradient methods.\n*   The gradient estimate is:\n    \n    ‚àáŒ∏Óà∂(Œ∏)\\=ùîº\\[(R‚àíb)‚àáŒ∏logpŒ∏(y,z|x)\\]‚àáŒ∏J(Œ∏)\\=E\\[(R‚àíb)‚àáŒ∏log‚Å°pŒ∏(y,z|x)\\]\n    \n    \\\\nabla\\_\\\\theta \\\\mathcal{J}(\\\\theta) = \\\\mathbb{E}\\[(R - b)\\\\nabla\\_\\\\theta \\\\log p\\_\\\\theta(y,z|x)\\]\n    *   where bbb is a baseline to reduce variance.\n\nThe gradient estimate is:\n\n*   where bbb is a baseline to reduce variance.\n\n#### DeepSeek-R1 Highlights\n\n*   **No human-annotated rationales:** The system learns reasoning _emergently_ through reward shaping.\n*   **Curriculum design:** Rewards evolve from simple tasks (e.g., arithmetic) to complex reasoning (e.g., proofs, logical deduction).\n*   **Outcome:** Demonstrated significant improvements on mathematical and logic benchmarks, outperforming supervised CoT-trained baselines.\n\n#### Theoretical Framing\n\n*   Reasoning is formalized as sequential decision-making with hidden intermediate states:\n\nzt‚àºœÄŒ∏(zt|x,z<t),RT\\=r(yT,z‚â§T)zt‚àºœÄŒ∏(zt|x,z<t),RT\\=r(yT,z‚â§T)\n\n*   The RL agent (the LLM) learns to compose ‚Äúthoughts‚Äù that maximize expected cumulative reward, rather than likelihood of training text. This bridges _text prediction_ and _deliberate reasoning_ via credit assignment.\n\n#### Advantages\n\n*   Encourages reasoning structures that generalize beyond training distributions.\n*   Does not require labeled step-by-step data.\n*   Enables automated self-improvement through reward feedback.\n\n#### Limitations\n\n*   Reward specification is delicate‚Äîpoorly designed rewards can lead to reasoning shortcuts or gaming behavior.\n*   High computational cost due to exploration and rollouts.\n*   Credit assignment remains challenging for long reasoning chains.\n\n#### Related Work\n\n*   _Reflexion_ by [Shinn et al. (2023)](https://arxiv.org/abs/2303.11366): integrates self-reflective RL to iteratively improve reasoning quality.\n*   _Constitutional AI_ by [Bai et al. (2022)](https://arxiv.org/abs/2212.08073): replaces human feedback with rule-based evaluators to align reasoning.\n*   _Tool-Augmented RLHF_ by [Nakano et al. (2021)](https://arxiv.org/abs/2109.01652): incorporates tool usage (e.g., code execution) into reward computation.\n*   In summary, RL-based reasoning represents a shift from _pattern completion_ to _goal-directed optimization_, allowing models to discover reasoning patterns that are not explicitly demonstrated in the data.\n\n#### DeepSeek-R1: Practical Takeaways and Design Patterns\n\n*   DeepSeek-R1 reframed ‚Äúreasoning‚Äù as a policy-optimization problem: start from a capable base model, define reward signals that prefer verifiable reasoning, and use RL to shape the latent steps zzz so that correct, readable chains become high-probability trajectories. The core lesson is operational: if you can score intermediate or final products reliably, you can push an LLM from pattern completion toward deliberate computation. For context on the method and results, see DeepSeek-R1 by [Guo et al. (2025)](https://arxiv.org/abs/2501.12948).\n    \n*   **What DeepSeek-R1 actually optimizes**:\n    \n    *   At a high level, R1 maximizes expected reward over sampled chains:\n        \n        Óà∂(Œ∏)\\=ùîºx‚àºÓà∞,z,y‚àºpŒ∏(‚ãÖ‚à£x)\\[R(y,z)\\]J(Œ∏)\\=Ex‚àºD,z,y‚àºpŒ∏(‚ãÖ‚à£x)\\[R(y,z)\\]\n        \n        \\\\mathcal{J}(\\\\theta)=\\\\mathbb{E}\\_{x\\\\sim\\\\mathcal{D},z,y\\\\sim p\\_\\\\theta(\\\\cdot\\\\mid x)}\\\\big\\[R(y,z)\\\\big\\]\n        *   where RRR blends correctness checks (exact answer, executable solver success), parsimony/format constraints, and sometimes readability penalties. In practice, implementations report variants of PPO/GRPO‚Äìstyle policy gradients:\n            \n            ‚àáŒ∏Óà∂(Œ∏)‚âàùîº\\[(R‚àíb),‚àáŒ∏logpŒ∏(y,z‚à£x)\\]‚àáŒ∏J(Œ∏)‚âàE\\[(R‚àíb),‚àáŒ∏log‚Å°pŒ∏(y,z‚à£x)\\]\n            \n            \\\\nabla\\_\\\\theta\\\\mathcal{J}(\\\\theta)\\\\approx \\\\mathbb{E}\\\\big\\[(R-b),\\\\nabla\\_\\\\theta\\\\log p\\_\\\\theta(y,z\\\\mid x)\\\\big\\]\n            *   ‚Ä¶ with a baseline bbb for variance reduction. R1 also uses staged training (e.g., cold-start data before RL) to stabilize exploration and improve ‚Äúreadability‚Äù of chains. See the paper for the multi-stage schedule and comparisons to o1-style models.\n*   **Why process supervision still matters**:\n    \n    *   Even when you train only on outcome rewards, a verified step signal improves stability and sample efficiency. A practical alternative or complement is process reward modeling (PRM): label or auto-label whether each step is correct, then reward step sequences. This was shown to beat outcome-only supervision on MATH in Let‚Äôs Verify Step by Step by [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050) and the accompanying OpenAI report by [OpenAI (2023)](https://openai.com/index/improving-mathematical-reasoning-with-process-supervision/).\n*   **A minimal R1-style recipe you can reproduce**:\n    \n    1.  Collect tasks with verifiable end states (GSM8K, AIME, MATH). Build an automatic checker VVV that returns 1 when answers or traces pass.\n    2.  Train a small verifier or PRM if you can: V(zt)‚àà\\[0,1\\]V(zt)‚àà\\[0,1\\]V(z\\_t)\\\\in\\[0,1\\] for each step. Use it either as reward shaping ‚àëtV(zt)‚àëtV(zt)\\\\sum\\_t V(z\\_t) or as a filter at decode time.\n    3.  Warm-start with supervised or distilled rationales to avoid unreadable chains; then switch to RL for exploration.\n    4.  Optimize a composite reward R\\=Œª1Correct(y)+Œª2‚àëtStepOK(zt)‚àíŒª3Length(z)‚àíŒª4FormatViolations(z)R\\=Œª1Correct(y)+Œª2‚àëtStepOK(zt)‚àíŒª3Length(z)‚àíŒª4FormatViolations(z)R=\\\\lambda\\_1\\\\text{Correct}(y)+\\\\lambda\\_2\\\\sum\\_{t}\\\\text{StepOK}(z\\_t)-\\\\lambda\\_3\\\\text{Length}(z)-\\\\lambda\\_4\\\\text{FormatViolations}(z), tuning ŒªiŒªi\\\\lambda\\_i for your domain.\n    5.  During inference, marginalize over latent thoughts with a small self-consistency budget KKK and pick via verifier-guided selection‚Äîper Self-Consistency by [Wang et al. (2022)](https://arxiv.org/abs/2203.11171).\n*   **Design patterns that travel well beyond R1**:\n    \n    *   **Reward the thing you can check:** If you can compile problems to executable checks, outcome-only RL is often enough to induce useful structure; add PRM when you need reliability. Evidence: process supervision consistently outperforms outcome supervision on math reasoning.\n        \n    *   **Stage your training:** Short supervised warm-ups (few curated traces) can prevent RL from converging on unreadable or language-mixed chains before formatting penalties kick in. DeepSeek-R1 explicitly reports multi-stage training to address readability and stability.\n        \n    *   **Keep decoding and training consistent:** If you will use verifier-guided selection at inference, train with that verifier ‚Äúin the loop‚Äù (e.g., as a reward or rejection sampler) to reduce train‚Äìtest mismatch.\n        \n    *   **Prefer execution and tools over narration where possible:** Program-aided solving (e.g., Python) shrinks the search space and makes rewards less noisy; combine with ReAct-style tool calls when tasks need retrieval or computation, as in ReAct by [Yao et al. (2022)](https://arxiv.org/abs/2210.03629).\n        \n    *   **Budget your ‚Äúthinking.:** Use a small KKK for self-consistency, then select with VVV. You approximate yÃÇ¬†\\=argmaxy‚àëKk\\=1ùïÄ\\[y(k)\\=y\\]y^\\=arg‚Å°maxy‚àëk\\=1KI\\[y(k)\\=y\\]\\\\hat{y}=\\\\arg\\\\max\\_y \\\\sum\\_{k=1}^{K}\\\\mathbb{I} \\\\big\\[y^{(k)}=y\\\\big\\], without exploding cost‚Äîagain following [Wang et al. (2022)](https://arxiv.org/abs/2203.11171).\n        \n*   **Operational pitfalls and guardrails**:\n    \n    *   **Reward hacking and shortcutting:** If the checker can be gamed (format cues, guessable ranges), the policy will exploit it. Rotate perturbations and adversarial seeds; log chains alongside rewards. DeepSeek-R1 notes emergent but sometimes messy behaviors under pure RL.\n        \n    *   **Over-deliberation and cost blow-ups:** RL-trained reasoners may produce unnecessarily long chains. Penalize chain length and add early-stop verifiers; at inference, cap steps and prune with a threshold on VVV.\n        \n    *   **Verification bottlenecks:** Human step labels do not scale. Borrow from PRM800K and template-based auto-labeling when feasible, and fall back to outcome-only rewards with strong executors; see [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050).\n        \n*   **Where R1 fits in the broader landscape**:\n    \n    *   R1-style RL sits between explicit prompting methods (CoT, self-consistency) and full agentic loops (ReAct/tools). It supplies a training-time force that makes those inference-time interfaces work more reliably: prompts elicit better chains, verifiers select more often-correct ones, and tools ground intermediate steps. That combination‚Äîpolicy shaping + marginalization + verification‚Äîis, to date, the most reliable way to turn text generators into auditable reasoners. For the primary R1 paper, see [Guo et al. (2025)](https://arxiv.org/abs/2501.12948); for process supervision foundations, see [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050) and OpenAI‚Äôs report by [OpenAI (2023)](https://openai.com/index/improving-mathematical-reasoning-with-process-supervision/).\n\nDeepSeek-R1 reframed ‚Äúreasoning‚Äù as a policy-optimization problem: start from a capable base model, define reward signals that prefer verifiable reasoning, and use RL to shape the latent steps zzz so that correct, readable chains become high-probability trajectories. The core lesson is operational: if you can score intermediate or final products reliably, you can push an LLM from pattern completion toward deliberate computation. For context on the method and results, see DeepSeek-R1 by [Guo et al. (2025)](https://arxiv.org/abs/2501.12948).\n\n**What DeepSeek-R1 actually optimizes**:\n\n*   At a high level, R1 maximizes expected reward over sampled chains:\n    \n    Óà∂(Œ∏)\\=ùîºx‚àºÓà∞,z,y‚àºpŒ∏(‚ãÖ‚à£x)\\[R(y,z)\\]J(Œ∏)\\=Ex‚àºD,z,y‚àºpŒ∏(‚ãÖ‚à£x)\\[R(y,z)\\]\n    \n    \\\\mathcal{J}(\\\\theta)=\\\\mathbb{E}\\_{x\\\\sim\\\\mathcal{D},z,y\\\\sim p\\_\\\\theta(\\\\cdot\\\\mid x)}\\\\big\\[R(y,z)\\\\big\\]\n    *   where RRR blends correctness checks (exact answer, executable solver success), parsimony/format constraints, and sometimes readability penalties. In practice, implementations report variants of PPO/GRPO‚Äìstyle policy gradients:\n        \n        ‚àáŒ∏Óà∂(Œ∏)‚âàùîº\\[(R‚àíb),‚àáŒ∏logpŒ∏(y,z‚à£x)\\]‚àáŒ∏J(Œ∏)‚âàE\\[(R‚àíb),‚àáŒ∏log‚Å°pŒ∏(y,z‚à£x)\\]\n        \n        \\\\nabla\\_\\\\theta\\\\mathcal{J}(\\\\theta)\\\\approx \\\\mathbb{E}\\\\big\\[(R-b),\\\\nabla\\_\\\\theta\\\\log p\\_\\\\theta(y,z\\\\mid x)\\\\big\\]\n        *   ‚Ä¶ with a baseline bbb for variance reduction. R1 also uses staged training (e.g., cold-start data before RL) to stabilize exploration and improve ‚Äúreadability‚Äù of chains. See the paper for the multi-stage schedule and comparisons to o1-style models.\n\nAt a high level, R1 maximizes expected reward over sampled chains:\n\n*   where RRR blends correctness checks (exact answer, executable solver success), parsimony/format constraints, and sometimes readability penalties. In practice, implementations report variants of PPO/GRPO‚Äìstyle policy gradients:\n    \n    ‚àáŒ∏Óà∂(Œ∏)‚âàùîº\\[(R‚àíb),‚àáŒ∏logpŒ∏(y,z‚à£x)\\]‚àáŒ∏J(Œ∏)‚âàE\\[(R‚àíb),‚àáŒ∏log‚Å°pŒ∏(y,z‚à£x)\\]\n    \n    \\\\nabla\\_\\\\theta\\\\mathcal{J}(\\\\theta)\\\\approx \\\\mathbb{E}\\\\big\\[(R-b),\\\\nabla\\_\\\\theta\\\\log p\\_\\\\theta(y,z\\\\mid x)\\\\big\\]\n    *   ‚Ä¶ with a baseline bbb for variance reduction. R1 also uses staged training (e.g., cold-start data before RL) to stabilize exploration and improve ‚Äúreadability‚Äù of chains. See the paper for the multi-stage schedule and comparisons to o1-style models.\n\nwhere RRR blends correctness checks (exact answer, executable solver success), parsimony/format constraints, and sometimes readability penalties. In practice, implementations report variants of PPO/GRPO‚Äìstyle policy gradients:\n\n*   ‚Ä¶ with a baseline bbb for variance reduction. R1 also uses staged training (e.g., cold-start data before RL) to stabilize exploration and improve ‚Äúreadability‚Äù of chains. See the paper for the multi-stage schedule and comparisons to o1-style models.\n\n**Why process supervision still matters**:\n\n*   Even when you train only on outcome rewards, a verified step signal improves stability and sample efficiency. A practical alternative or complement is process reward modeling (PRM): label or auto-label whether each step is correct, then reward step sequences. This was shown to beat outcome-only supervision on MATH in Let‚Äôs Verify Step by Step by [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050) and the accompanying OpenAI report by [OpenAI (2023)](https://openai.com/index/improving-mathematical-reasoning-with-process-supervision/).\n\n**A minimal R1-style recipe you can reproduce**:\n\n1.  Collect tasks with verifiable end states (GSM8K, AIME, MATH). Build an automatic checker VVV that returns 1 when answers or traces pass.\n2.  Train a small verifier or PRM if you can: V(zt)‚àà\\[0,1\\]V(zt)‚àà\\[0,1\\]V(z\\_t)\\\\in\\[0,1\\] for each step. Use it either as reward shaping ‚àëtV(zt)‚àëtV(zt)\\\\sum\\_t V(z\\_t) or as a filter at decode time.\n3.  Warm-start with supervised or distilled rationales to avoid unreadable chains; then switch to RL for exploration.\n4.  Optimize a composite reward R\\=Œª1Correct(y)+Œª2‚àëtStepOK(zt)‚àíŒª3Length(z)‚àíŒª4FormatViolations(z)R\\=Œª1Correct(y)+Œª2‚àëtStepOK(zt)‚àíŒª3Length(z)‚àíŒª4FormatViolations(z)R=\\\\lambda\\_1\\\\text{Correct}(y)+\\\\lambda\\_2\\\\sum\\_{t}\\\\text{StepOK}(z\\_t)-\\\\lambda\\_3\\\\text{Length}(z)-\\\\lambda\\_4\\\\text{FormatViolations}(z), tuning ŒªiŒªi\\\\lambda\\_i for your domain.\n5.  During inference, marginalize over latent thoughts with a small self-consistency budget KKK and pick via verifier-guided selection‚Äîper Self-Consistency by [Wang et al. (2022)](https://arxiv.org/abs/2203.11171).\n\n**Design patterns that travel well beyond R1**:\n\n*   **Reward the thing you can check:** If you can compile problems to executable checks, outcome-only RL is often enough to induce useful structure; add PRM when you need reliability. Evidence: process supervision consistently outperforms outcome supervision on math reasoning.\n    \n*   **Stage your training:** Short supervised warm-ups (few curated traces) can prevent RL from converging on unreadable or language-mixed chains before formatting penalties kick in. DeepSeek-R1 explicitly reports multi-stage training to address readability and stability.\n    \n*   **Keep decoding and training consistent:** If you will use verifier-guided selection at inference, train with that verifier ‚Äúin the loop‚Äù (e.g., as a reward or rejection sampler) to reduce train‚Äìtest mismatch.\n    \n*   **Prefer execution and tools over narration where possible:** Program-aided solving (e.g., Python) shrinks the search space and makes rewards less noisy; combine with ReAct-style tool calls when tasks need retrieval or computation, as in ReAct by [Yao et al. (2022)](https://arxiv.org/abs/2210.03629).\n    \n*   **Budget your ‚Äúthinking.:** Use a small KKK for self-consistency, then select with VVV. You approximate yÃÇ¬†\\=argmaxy‚àëKk\\=1ùïÄ\\[y(k)\\=y\\]y^\\=arg‚Å°maxy‚àëk\\=1KI\\[y(k)\\=y\\]\\\\hat{y}=\\\\arg\\\\max\\_y \\\\sum\\_{k=1}^{K}\\\\mathbb{I} \\\\big\\[y^{(k)}=y\\\\big\\], without exploding cost‚Äîagain following [Wang et al. (2022)](https://arxiv.org/abs/2203.11171).\n    \n\n**Reward the thing you can check:** If you can compile problems to executable checks, outcome-only RL is often enough to induce useful structure; add PRM when you need reliability. Evidence: process supervision consistently outperforms outcome supervision on math reasoning.\n\n**Stage your training:** Short supervised warm-ups (few curated traces) can prevent RL from converging on unreadable or language-mixed chains before formatting penalties kick in. DeepSeek-R1 explicitly reports multi-stage training to address readability and stability.\n\n**Keep decoding and training consistent:** If you will use verifier-guided selection at inference, train with that verifier ‚Äúin the loop‚Äù (e.g., as a reward or rejection sampler) to reduce train‚Äìtest mismatch.\n\n**Prefer execution and tools over narration where possible:** Program-aided solving (e.g., Python) shrinks the search space and makes rewards less noisy; combine with ReAct-style tool calls when tasks need retrieval or computation, as in ReAct by [Yao et al. (2022)](https://arxiv.org/abs/2210.03629).\n\n**Budget your ‚Äúthinking.:** Use a small KKK for self-consistency, then select with VVV. You approximate yÃÇ¬†\\=argmaxy‚àëKk\\=1ùïÄ\\[y(k)\\=y\\]y^\\=arg‚Å°maxy‚àëk\\=1KI\\[y(k)\\=y\\]\\\\hat{y}=\\\\arg\\\\max\\_y \\\\sum\\_{k=1}^{K}\\\\mathbb{I} \\\\big\\[y^{(k)}=y\\\\big\\], without exploding cost‚Äîagain following [Wang et al. (2022)](https://arxiv.org/abs/2203.11171).\n\n**Operational pitfalls and guardrails**:\n\n*   **Reward hacking and shortcutting:** If the checker can be gamed (format cues, guessable ranges), the policy will exploit it. Rotate perturbations and adversarial seeds; log chains alongside rewards. DeepSeek-R1 notes emergent but sometimes messy behaviors under pure RL.\n    \n*   **Over-deliberation and cost blow-ups:** RL-trained reasoners may produce unnecessarily long chains. Penalize chain length and add early-stop verifiers; at inference, cap steps and prune with a threshold on VVV.\n    \n*   **Verification bottlenecks:** Human step labels do not scale. Borrow from PRM800K and template-based auto-labeling when feasible, and fall back to outcome-only rewards with strong executors; see [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050).\n    \n\n**Reward hacking and shortcutting:** If the checker can be gamed (format cues, guessable ranges), the policy will exploit it. Rotate perturbations and adversarial seeds; log chains alongside rewards. DeepSeek-R1 notes emergent but sometimes messy behaviors under pure RL.\n\n**Over-deliberation and cost blow-ups:** RL-trained reasoners may produce unnecessarily long chains. Penalize chain length and add early-stop verifiers; at inference, cap steps and prune with a threshold on VVV.\n\n**Verification bottlenecks:** Human step labels do not scale. Borrow from PRM800K and template-based auto-labeling when feasible, and fall back to outcome-only rewards with strong executors; see [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050).\n\n**Where R1 fits in the broader landscape**:\n\n*   R1-style RL sits between explicit prompting methods (CoT, self-consistency) and full agentic loops (ReAct/tools). It supplies a training-time force that makes those inference-time interfaces work more reliably: prompts elicit better chains, verifiers select more often-correct ones, and tools ground intermediate steps. That combination‚Äîpolicy shaping + marginalization + verification‚Äîis, to date, the most reliable way to turn text generators into auditable reasoners. For the primary R1 paper, see [Guo et al. (2025)](https://arxiv.org/abs/2501.12948); for process supervision foundations, see [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050) and OpenAI‚Äôs report by [OpenAI (2023)](https://openai.com/index/improving-mathematical-reasoning-with-process-supervision/).",
    "order": 20,
    "orderInChapter": 2,
    "difficulty": 5,
    "estimatedMinutes": 13,
    "tags": [
      "nlpllms",
      "gpt",
      "llm",
      "reinforcement learning",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 2498,
      "contentLength": 205881
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#deepseek-r1",
    "scrapedAt": "2025-12-28T11:54:00.655Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-reinforcement-learning-for-tool-integrated-reasoni-21",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Reinforcement Learning-Based Reasoning",
    "title": "Reinforcement Learning for Tool-Integrated Reasoning",
    "subtitle": "Reinforcement Learning-Based Reasoning",
    "contentHtml": "<ul>\n  <li><strong>Tool-Integrated Reasoning (TIR)</strong> marks a paradigm shift in how LLMs perform complex reasoning tasks. Instead of relying solely on text-based inference, TIR enables models to <strong>invoke external tools</strong>‚Äîsuch as code interpreters, APIs, databases, or symbolic solvers‚Äîwithin their reasoning trajectories.\n    <ul>\n      <li>\n        <p>Through this mechanism, models alternate between <em>linguistic reasoning</em> and <em>computational execution</em>, forming a hybrid cognitive process that grounds natural language thought in verifiable computation.\nFormally, a TIR process can be expressed as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-186-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>r</mi><mn>1</mn></msub><mo>,</mo><msub><mi>c</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>r</mi><mi>t</mi></msub><mo>,</mo><msub><mi>c</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mi>t</mi></msub></mrow><mo>,</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2606\" style=\"width: 13.128em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1010.89em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2607\"><span class=\"msubsup\" id=\"MathJax-Span-2608\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2609\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2610\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2611\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-2612\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-2613\"><span class=\"msubsup\" id=\"MathJax-Span-2614\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2615\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-2616\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2617\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2618\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2619\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mn\" id=\"MathJax-Span-2620\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2621\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2622\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2623\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-2624\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2625\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-2626\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-2627\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2628\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2629\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2630\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2631\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2632\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2633\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2634\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2635\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2636\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2637\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2638\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2639\" style=\"font-family: STIXGeneral-Regular;\">,</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>r</mi><mn>1</mn></msub><mo>,</mo><msub><mi>c</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msub><mi>r</mi><mi>t</mi></msub><mo>,</mo><msub><mi>c</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mi>t</mi></msub></mrow><mo>,</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-186\">s_t = {r_1, c_1, o_1, \\ldots, r_t, c_t, o_t},</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-187-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2640\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2641\"><span class=\"msubsup\" id=\"MathJax-Span-2642\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2643\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2644\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-187\">r_t</script> is a reasoning step, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-188-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2645\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2646\"><span class=\"msubsup\" id=\"MathJax-Span-2647\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2648\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2649\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>c</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-188\">c_t</script> a tool command, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-189-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>c</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2650\" style=\"width: 4.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.753em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.7em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2651\"><span class=\"msubsup\" id=\"MathJax-Span-2652\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2653\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2654\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2655\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-2656\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2657\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2658\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2659\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2660\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2661\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=\"false\">(</mo><msub><mi>c</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-189\">o_t = I(c_t)</script> the corresponding output from an interpreter <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-190-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2662\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2663\"><span class=\"mi\" id=\"MathJax-Span-2664\" style=\"font-family: STIXGeneral-Italic;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>I</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-190\">I</script>.</li>\n        </ul>\n      </li>\n      <li>\n        <p>This framework establishes a <strong>closed loop</strong> of <em>reason ‚Üí act ‚Üí verify</em>, significantly reducing hallucination and enabling models to achieve <em>self-correction</em> through external validation.</p>\n      </li>\n    </ul>\n  </li>\n  <li><strong>Tool-Integrated Reinforcement Learning (TIRL)</strong> extends this paradigm by introducing <strong>reinforcement learning (RL)</strong> into the TIR loop. In TIRL, models are not merely taught to use tools‚Äîthey <strong>learn</strong> when and how to use them optimally through trial, feedback, and reward.\n    <ul>\n      <li>\n        <p>The integration of RL allows the model to optimize over both symbolic actions (tool invocations) and linguistic reasoning steps, guided by reward functions that capture correctness, efficiency, and interpretability:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-191-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2665\" style=\"width: 14.69em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1011.93em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2666\"><span class=\"mi\" id=\"MathJax-Span-2667\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2668\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2669\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2670\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2671\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2672\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2673\"><span class=\"mrow\" id=\"MathJax-Span-2674\"><span class=\"mi\" id=\"MathJax-Span-2675\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2676\"><span class=\"mrow\" id=\"MathJax-Span-2677\"><span class=\"msubsup\" id=\"MathJax-Span-2678\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2679\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2680\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-2681\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2682\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-2683\"><span class=\"munderover\" id=\"MathJax-Span-2684\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2685\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-2686\"><span class=\"mrow\" id=\"MathJax-Span-2687\"><span class=\"mi\" id=\"MathJax-Span-2688\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2689\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-2690\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-2691\"><span class=\"mrow\" id=\"MathJax-Span-2692\"><span class=\"mi\" id=\"MathJax-Span-2693\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2694\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2695\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2696\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2697\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2698\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2699\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2700\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2701\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2702\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2703\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2704\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2705\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2706\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2707\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2708\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2709\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2710\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-2711\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><mi>r</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-191\">J(\\theta) = \\mathbb{E}_{\\pi_\\theta} \\left[\\sum_{t=0}^{T} \\gamma^t r(s_t, a_t, o_t)\\right]</script>\n\n        <ul>\n          <li>where the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-192-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2712\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.91em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2713\"><span class=\"msubsup\" id=\"MathJax-Span-2714\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2715\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2716\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2717\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2718\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2719\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2720\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2721\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-2722\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2723\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2724\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2725\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-192\">\\pi_\\theta(a_t \\mid s_t)</script> produces both reasoning and tool actions.</li>\n        </ul>\n      </li>\n      <li>\n        <p>This combination yields models capable of <em>adaptive computation</em>‚Äîdeciding dynamically whether to reason internally or delegate computation externally for optimal task success.</p>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>This section surveys three recent and complementary frameworks that embody the TIRL paradigm:</p>\n\n    <ul>\n      <li><strong><a href=\"https://arxiv.org/abs/2503.23383\">ToRL</a></strong> by Li et al. (2025): introduces <em>Tool-Oriented Reinforcement Learning</em> for code-augmented mathematical reasoning, coupling RL with symbolic execution for error correction and precision.</li>\n      <li><strong><a href=\"https://arxiv.org/abs/2504.11536\">ReTool</a></strong> by Feng et al. (2025): establishes a two-phase RL pipeline where LLMs interleave reasoning with real-time code execution, optimizing outcome-based rewards for verifiable solutions.</li>\n      <li><strong><a href=\"https://arxiv.org/abs/2510.23038\">TIR-Judge</a></strong> by Xu et al. (2025): extends the TIRL concept to <em>evaluation agents</em>, training LLM-based judges that reason, execute verification code, and learn reward functions for truthful, consistent assessment.</li>\n    </ul>\n  </li>\n  <li>Together, TIR and TIRL form the backbone of next-generation <strong>agentic intelligence</strong>‚Äîwhere reasoning is no longer passive text generation, but an <em>interactive, executable, and self-optimizing process</em> grounded in real-world feedback.</li>\n</ul>\n<ul>\n      <li>\n        <p>Through this mechanism, models alternate between <em>linguistic reasoning</em> and <em>computational execution</em>, forming a hybrid cognitive process that grounds natural language thought in verifiable computation.\nFormally, a TIR process can be expressed as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-186-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>r</mi><mn>1</mn></msub><mo>,</mo><msub><mi>c</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>r</mi><mi>t</mi></msub><mo>,</mo><msub><mi>c</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mi>t</mi></msub></mrow><mo>,</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2606\" style=\"width: 13.128em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1010.89em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2607\"><span class=\"msubsup\" id=\"MathJax-Span-2608\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2609\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2610\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2611\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-2612\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-2613\"><span class=\"msubsup\" id=\"MathJax-Span-2614\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2615\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-2616\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2617\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2618\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2619\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mn\" id=\"MathJax-Span-2620\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2621\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2622\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2623\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-2624\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2625\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-2626\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-2627\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2628\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2629\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2630\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2631\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2632\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2633\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2634\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2635\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2636\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2637\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2638\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2639\" style=\"font-family: STIXGeneral-Regular;\">,</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>r</mi><mn>1</mn></msub><mo>,</mo><msub><mi>c</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msub><mi>r</mi><mi>t</mi></msub><mo>,</mo><msub><mi>c</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mi>t</mi></msub></mrow><mo>,</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-186\">s_t = {r_1, c_1, o_1, \\ldots, r_t, c_t, o_t},</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-187-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2640\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2641\"><span class=\"msubsup\" id=\"MathJax-Span-2642\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2643\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2644\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-187\">r_t</script> is a reasoning step, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-188-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2645\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2646\"><span class=\"msubsup\" id=\"MathJax-Span-2647\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2648\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2649\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>c</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-188\">c_t</script> a tool command, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-189-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>c</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2650\" style=\"width: 4.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.753em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.7em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2651\"><span class=\"msubsup\" id=\"MathJax-Span-2652\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2653\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2654\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2655\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-2656\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2657\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2658\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2659\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2660\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2661\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=\"false\">(</mo><msub><mi>c</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-189\">o_t = I(c_t)</script> the corresponding output from an interpreter <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-190-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2662\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2663\"><span class=\"mi\" id=\"MathJax-Span-2664\" style=\"font-family: STIXGeneral-Italic;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>I</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-190\">I</script>.</li>\n        </ul>\n      </li>\n      <li>\n        <p>This framework establishes a <strong>closed loop</strong> of <em>reason ‚Üí act ‚Üí verify</em>, significantly reducing hallucination and enabling models to achieve <em>self-correction</em> through external validation.</p>\n      </li>\n    </ul>\n<p>Through this mechanism, models alternate between <em>linguistic reasoning</em> and <em>computational execution</em>, forming a hybrid cognitive process that grounds natural language thought in verifiable computation.\nFormally, a TIR process can be expressed as:</p>\n<ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-187-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2640\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2641\"><span class=\"msubsup\" id=\"MathJax-Span-2642\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2643\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2644\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-187\">r_t</script> is a reasoning step, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-188-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2645\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2646\"><span class=\"msubsup\" id=\"MathJax-Span-2647\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2648\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2649\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>c</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-188\">c_t</script> a tool command, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-189-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>c</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2650\" style=\"width: 4.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.753em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.7em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2651\"><span class=\"msubsup\" id=\"MathJax-Span-2652\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2653\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2654\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2655\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-2656\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2657\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2658\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2659\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2660\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2661\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=\"false\">(</mo><msub><mi>c</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-189\">o_t = I(c_t)</script> the corresponding output from an interpreter <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-190-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2662\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2663\"><span class=\"mi\" id=\"MathJax-Span-2664\" style=\"font-family: STIXGeneral-Italic;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>I</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-190\">I</script>.</li>\n        </ul>\n<p>This framework establishes a <strong>closed loop</strong> of <em>reason ‚Üí act ‚Üí verify</em>, significantly reducing hallucination and enabling models to achieve <em>self-correction</em> through external validation.</p>\n<ul>\n      <li>\n        <p>The integration of RL allows the model to optimize over both symbolic actions (tool invocations) and linguistic reasoning steps, guided by reward functions that capture correctness, efficiency, and interpretability:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-191-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2665\" style=\"width: 14.69em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1011.93em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2666\"><span class=\"mi\" id=\"MathJax-Span-2667\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2668\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2669\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2670\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2671\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2672\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2673\"><span class=\"mrow\" id=\"MathJax-Span-2674\"><span class=\"mi\" id=\"MathJax-Span-2675\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2676\"><span class=\"mrow\" id=\"MathJax-Span-2677\"><span class=\"msubsup\" id=\"MathJax-Span-2678\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2679\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2680\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-2681\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2682\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-2683\"><span class=\"munderover\" id=\"MathJax-Span-2684\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2685\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-2686\"><span class=\"mrow\" id=\"MathJax-Span-2687\"><span class=\"mi\" id=\"MathJax-Span-2688\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2689\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-2690\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-2691\"><span class=\"mrow\" id=\"MathJax-Span-2692\"><span class=\"mi\" id=\"MathJax-Span-2693\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2694\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2695\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2696\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2697\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2698\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2699\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2700\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2701\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2702\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2703\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2704\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2705\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2706\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2707\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2708\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2709\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2710\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-2711\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><mi>r</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>o</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-191\">J(\\theta) = \\mathbb{E}_{\\pi_\\theta} \\left[\\sum_{t=0}^{T} \\gamma^t r(s_t, a_t, o_t)\\right]</script>\n\n        <ul>\n          <li>where the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-192-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2712\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.91em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2713\"><span class=\"msubsup\" id=\"MathJax-Span-2714\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2715\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2716\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2717\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2718\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2719\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2720\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2721\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-2722\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2723\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2724\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2725\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-192\">\\pi_\\theta(a_t \\mid s_t)</script> produces both reasoning and tool actions.</li>\n        </ul>\n      </li>\n      <li>\n        <p>This combination yields models capable of <em>adaptive computation</em>‚Äîdeciding dynamically whether to reason internally or delegate computation externally for optimal task success.</p>\n      </li>\n    </ul>\n<p>The integration of RL allows the model to optimize over both symbolic actions (tool invocations) and linguistic reasoning steps, guided by reward functions that capture correctness, efficiency, and interpretability:</p>\n<ul>\n          <li>where the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-192-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2712\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.91em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2713\"><span class=\"msubsup\" id=\"MathJax-Span-2714\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2715\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2716\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2717\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2718\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2719\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2720\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2721\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-2722\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2723\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2724\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2725\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-192\">\\pi_\\theta(a_t \\mid s_t)</script> produces both reasoning and tool actions.</li>\n        </ul>\n<p>This combination yields models capable of <em>adaptive computation</em>‚Äîdeciding dynamically whether to reason internally or delegate computation externally for optimal task success.</p>\n<p>This section surveys three recent and complementary frameworks that embody the TIRL paradigm:</p>\n<ul>\n      <li><strong><a href=\"https://arxiv.org/abs/2503.23383\">ToRL</a></strong> by Li et al. (2025): introduces <em>Tool-Oriented Reinforcement Learning</em> for code-augmented mathematical reasoning, coupling RL with symbolic execution for error correction and precision.</li>\n      <li><strong><a href=\"https://arxiv.org/abs/2504.11536\">ReTool</a></strong> by Feng et al. (2025): establishes a two-phase RL pipeline where LLMs interleave reasoning with real-time code execution, optimizing outcome-based rewards for verifiable solutions.</li>\n      <li><strong><a href=\"https://arxiv.org/abs/2510.23038\">TIR-Judge</a></strong> by Xu et al. (2025): extends the TIRL concept to <em>evaluation agents</em>, training LLM-based judges that reason, execute verification code, and learn reward functions for truthful, consistent assessment.</li>\n    </ul>\n<h4 id=\"tool-integrated-reinforcement-learning-torl\">Tool-Integrated Reinforcement Learning (ToRL)</h4>\n<ul>\n  <li>\n    <p>The <a href=\"https://arxiv.org/abs/2503.23383\">Tool-Integrated Reinforcement Learning (ToRL)</a> framework by Li et al. (2025) directly scales reinforcement learning from base models‚Äîwithout supervised fine-tuning‚Äîto autonomously acquire computational tool usage.</p>\n  </li>\n  <li>\n    <p>Unlike earlier Tool-Integrated Reasoning (TIR) approaches such as <a href=\"https://arxiv.org/abs/2310.03731\">MathCoder</a> by Wang et al. (2023) or <a href=\"https://arxiv.org/abs/2309.17452\">ToRA</a> by Gou et al. (2023), ToRL does not rely on distilled tool trajectories. Instead, the model learns tool strategies through reward-driven exploration from scratch.</p>\n  </li>\n</ul>\n<p>The <a href=\"https://arxiv.org/abs/2503.23383\">Tool-Integrated Reinforcement Learning (ToRL)</a> framework by Li et al. (2025) directly scales reinforcement learning from base models‚Äîwithout supervised fine-tuning‚Äîto autonomously acquire computational tool usage.</p>\n<p>Unlike earlier Tool-Integrated Reasoning (TIR) approaches such as <a href=\"https://arxiv.org/abs/2310.03731\">MathCoder</a> by Wang et al. (2023) or <a href=\"https://arxiv.org/abs/2309.17452\">ToRA</a> by Gou et al. (2023), ToRL does not rely on distilled tool trajectories. Instead, the model learns tool strategies through reward-driven exploration from scratch.</p>\n<h5 id=\"core-idea-9\">Core Idea</h5>\n<ul>\n  <li>\n    <p>ToRL enables unrestricted RL exploration with embedded interpreters (e.g., Python) for solving mathematical reasoning problems. Through repeated interaction between analytical reasoning and code execution, the model learns to balance symbolic reasoning with computational accuracy.</p>\n  </li>\n  <li>\n    <p>ToRL employs <a href=\"https://arxiv.org/abs/2402.03300\">GRPO</a>, setting the rollout batch size to 128 and generating 16 samples per problem.</p>\n  </li>\n  <li>\n    <p>In ToRL, this formulation allows the model to optimize <em>end-to-end tool-use behavior</em> purely through reinforcement signals, without explicit imitation of tool trajectories. It further supports <strong>exploration-driven learning</strong>, where even incorrect executions can contribute useful gradient signals toward improving reasoning-tool coordination.</p>\n  </li>\n  <li>\n    <p>The following figure (<a href=\"https://arxiv.org/abs/2503.23383\">source</a>) shows an example of CoT and TIR solution of the problem. TIR enables the model to write code and call an interpreter to obtain the output of the executed code, and then perform further reasoning based on the execution results.</p>\n  </li>\n</ul>\n<p>ToRL enables unrestricted RL exploration with embedded interpreters (e.g., Python) for solving mathematical reasoning problems. Through repeated interaction between analytical reasoning and code execution, the model learns to balance symbolic reasoning with computational accuracy.</p>\n<p>ToRL employs <a href=\"https://arxiv.org/abs/2402.03300\">GRPO</a>, setting the rollout batch size to 128 and generating 16 samples per problem.</p>\n<p>In ToRL, this formulation allows the model to optimize <em>end-to-end tool-use behavior</em> purely through reinforcement signals, without explicit imitation of tool trajectories. It further supports <strong>exploration-driven learning</strong>, where even incorrect executions can contribute useful gradient signals toward improving reasoning-tool coordination.</p>\n<p>The following figure (<a href=\"https://arxiv.org/abs/2503.23383\">source</a>) shows an example of CoT and TIR solution of the problem. TIR enables the model to write code and call an interpreter to obtain the output of the executed code, and then perform further reasoning based on the execution results.</p>\n<p><img src=\"/primers/ai/assets/RL-for-agents/ToRL.jpg\" alt=\"\"></p>\n<h5 id=\"dataset-and-training-pipeline\">Dataset and Training Pipeline</h5>\n<ul>\n  <li>ToRL constructs a 28k-instance dataset from <strong>MATH</strong>, <strong>NuminaMATH</strong>, and <strong>DeepScaleR</strong>, filtering for verifiable numerical tasks and excluding open-ended proofs.</li>\n  <li>Training is performed directly on <strong>Qwen2.5-Math base models (1.5B, 7B)</strong>, without prior fine-tuning. The RL loop enables exploration of tool-use trajectories, guided solely by outcome-based rewards.</li>\n</ul>\n<h5 id=\"emergent-behaviors\">Emergent Behaviors</h5>\n<ul>\n  <li>\n    <p>ToRL demonstrates several <em>self-organizing cognitive behaviors</em>:</p>\n\n    <ul>\n      <li><strong>Code usage evolution:</strong> the share of tasks solved via code rises as RL progresses.</li>\n      <li><strong>Self-regulation:</strong> the model autonomously detects and avoids ineffective code patterns.</li>\n      <li><strong>Analytical‚Äìcomputational adaptation:</strong> dynamically alternates between symbolic reasoning and code execution.</li>\n    </ul>\n  </li>\n  <li>\n    <p>These capabilities emerge without explicit demonstrations‚Äîdriven purely by reward feedback.</p>\n  </li>\n</ul>\n<p>ToRL demonstrates several <em>self-organizing cognitive behaviors</em>:</p>\n<ul>\n      <li><strong>Code usage evolution:</strong> the share of tasks solved via code rises as RL progresses.</li>\n      <li><strong>Self-regulation:</strong> the model autonomously detects and avoids ineffective code patterns.</li>\n      <li><strong>Analytical‚Äìcomputational adaptation:</strong> dynamically alternates between symbolic reasoning and code execution.</li>\n    </ul>\n<p>These capabilities emerge without explicit demonstrations‚Äîdriven purely by reward feedback.</p>\n<h5 id=\"results\">Results</h5>\n<ul>\n  <li>ToRL-7B achieves <strong>43.3%</strong> accuracy on AIME24‚Äîsurpassing RL baselines by <strong>14%</strong> and SFT-based tool models by <strong>17%</strong>.</li>\n</ul>\n<h5 id=\"significance\">Significance</h5>\n<ul>\n  <li>ToRL pioneers <strong>tool integration in large-scale RL from scratch</strong>, showing that emergent metacognitive capabilities (reflection, verification) can arise naturally from outcome-based training, bridging analytical and computational reasoning.</li>\n</ul>\n<h4 id=\"reinforcement-learning-for-strategic-tool-use-retool\">Reinforcement Learning for Strategic Tool Use (ReTool)</h4>\n<ul>\n  <li><a href=\"https://arxiv.org/abs/2504.11536\">ReTool</a> by Feng et al. (2025) extends the RL paradigm by <em>explicitly embedding tool execution into the rollout process</em>. It introduces an <strong>interleaved reasoning and code execution framework</strong> for dynamic tool invocation and reflection.</li>\n</ul>\n<h5 id=\"overview\">Overview</h5>\n<ul>\n  <li>\n    <p>ReTool is designed around two phases:</p>\n\n    <ol>\n      <li><strong>Cold-start Supervised Fine-Tuning (SFT)</strong>: constructing synthetic ‚Äúcode-augmented reasoning‚Äù traces using dual-verification pipelines.</li>\n      <li><strong>Reinforcement Learning (RL)</strong>: refining the model‚Äôs policy to discover optimal tool-use strategies through <strong>outcome-based reward optimization</strong>.</li>\n    </ol>\n  </li>\n</ul>\n<p>ReTool is designed around two phases:</p>\n<ol>\n      <li><strong>Cold-start Supervised Fine-Tuning (SFT)</strong>: constructing synthetic ‚Äúcode-augmented reasoning‚Äù traces using dual-verification pipelines.</li>\n      <li><strong>Reinforcement Learning (RL)</strong>: refining the model‚Äôs policy to discover optimal tool-use strategies through <strong>outcome-based reward optimization</strong>.</li>\n    </ol>\n<h5 id=\"methodology\">Methodology</h5>\n<ul>\n  <li>\n    <p>ReTool‚Äôs training integrates real-time <strong>code interpreter feedback</strong> within the PPO objective:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-193-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>J</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>P</mi><mi>P</mi><mi>O</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><mi>D</mi></mrow></msub><mrow><mo>[</mo><mrow><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mrow><mo>(</mo><mrow><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>q</mi><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo>;</mo><mi>C</mi><mi>I</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>q</mi><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo>;</mo><mi>C</mi><mi>I</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub><mo>,</mo><mtext>clip</mtext><mrow><mo>(</mo><mrow><mfrac><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub></mfrac><mo>,</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03F5;</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>&amp;#x03F5;</mi></mrow><mo>)</mo></mrow><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2726\" style=\"width: 38.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 31.878em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.503em, 1031.67em, 5.263em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2727\"><span class=\"msubsup\" id=\"MathJax-Span-2728\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2729\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-2730\"><span class=\"mrow\" id=\"MathJax-Span-2731\"><span class=\"mi\" id=\"MathJax-Span-2732\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">P</span><span class=\"mi\" id=\"MathJax-Span-2733\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">P</span><span class=\"mi\" id=\"MathJax-Span-2734\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">O</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2735\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2736\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2737\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2738\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2739\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.076em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2740\"><span class=\"mrow\" id=\"MathJax-Span-2741\"><span class=\"mi\" id=\"MathJax-Span-2742\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2743\"><span class=\"mrow\" id=\"MathJax-Span-2744\"><span class=\"mo\" id=\"MathJax-Span-2745\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2746\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-2747\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2748\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2749\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2750\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"mi\" id=\"MathJax-Span-2751\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">D</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-2752\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2753\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-2754\"><span class=\"mo\" id=\"MathJax-Span-2755\" style=\"font-family: STIXGeneral-Regular;\">min</span><span class=\"mrow\" id=\"MathJax-Span-2756\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2757\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-2758\"><span class=\"mfrac\" id=\"MathJax-Span-2759\"><span style=\"display: inline-block; position: relative; width: 7.294em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1006.46em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -3.227em;\"><span class=\"mrow\" id=\"MathJax-Span-2760\"><span class=\"msubsup\" id=\"MathJax-Span-2761\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2762\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2763\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2764\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2765\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2766\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2767\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2768\"><span class=\"mrow\" id=\"MathJax-Span-2769\"><span class=\"mo\" id=\"MathJax-Span-2770\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-2771\" style=\"font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-2772\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2773\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2774\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2775\"><span class=\"mrow\" id=\"MathJax-Span-2776\"><span class=\"mo\" id=\"MathJax-Span-2777\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-2778\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2779\" style=\"font-family: STIXGeneral-Regular;\">;</span><span class=\"mi\" id=\"MathJax-Span-2780\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">C<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2781\" style=\"font-family: STIXGeneral-Italic;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2782\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1007.14em, 4.43em, -999.997em); top: -3.331em; left: 50%; margin-left: -3.591em;\"><span class=\"mrow\" id=\"MathJax-Span-2783\"><span class=\"msubsup\" id=\"MathJax-Span-2784\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2785\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2786\"><span class=\"mrow\" id=\"MathJax-Span-2787\"><span class=\"msubsup\" id=\"MathJax-Span-2788\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2789\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2790\"><span class=\"mrow\" id=\"MathJax-Span-2791\"><span class=\"mtext\" id=\"MathJax-Span-2792\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2793\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2794\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2795\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2796\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-2797\"><span class=\"mrow\" id=\"MathJax-Span-2798\"><span class=\"mo\" id=\"MathJax-Span-2799\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-2800\" style=\"font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-2801\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2802\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2803\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2804\"><span class=\"mrow\" id=\"MathJax-Span-2805\"><span class=\"mo\" id=\"MathJax-Span-2806\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-2807\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2808\" style=\"font-family: STIXGeneral-Regular;\">;</span><span class=\"mi\" id=\"MathJax-Span-2809\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">C<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2810\" style=\"font-family: STIXGeneral-Italic;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2811\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1007.29em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.294em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2812\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2813\"><span class=\"mrow\" id=\"MathJax-Span-2814\"><span class=\"munderover\" id=\"MathJax-Span-2815\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2816\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-2817\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2818\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2819\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-2820\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">clip</span><span class=\"mrow\" id=\"MathJax-Span-2821\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2822\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-2823\"><span class=\"mfrac\" id=\"MathJax-Span-2824\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.94em, 4.326em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.466em;\"><span class=\"msubsup\" id=\"MathJax-Span-2825\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2826\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2827\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1001.62em, 4.43em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.779em;\"><span class=\"msubsup\" id=\"MathJax-Span-2828\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2829\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2830\"><span class=\"mrow\" id=\"MathJax-Span-2831\"><span class=\"msubsup\" id=\"MathJax-Span-2832\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2833\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2834\"><span class=\"mrow\" id=\"MathJax-Span-2835\"><span class=\"mtext\" id=\"MathJax-Span-2836\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1001.72em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.721em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2837\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-2838\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-2839\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2840\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">œµ</span><span class=\"mo\" id=\"MathJax-Span-2841\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-2842\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-2843\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2844\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">œµ</span></span><span class=\"mo\" id=\"MathJax-Span-2845\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">)</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2846\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2847\"><span class=\"mrow\" id=\"MathJax-Span-2848\"><span class=\"munderover\" id=\"MathJax-Span-2849\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2850\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-2851\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2852\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2853\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">)</span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2854\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>J</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>P</mi><mi>P</mi><mi>O</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>q</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚àº</mo><mi>D</mi></mrow></msub><mrow><mo>[</mo><mrow><mo movablelimits=\"true\" form=\"prefix\">min</mo><mrow><mo>(</mo><mrow><mfrac><mrow><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>q</mi><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>&lt;</mo><mi>t</mi></mrow></msub><mo>;</mo><mi>C</mi><mi>I</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>q</mi><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>&lt;</mo><mi>t</mi></mrow></msub><mo>;</mo><mi>C</mi><mi>I</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub><mo>,</mo><mtext>clip</mtext><mrow><mo>(</mo><mrow><mfrac><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub></mfrac><mo>,</mo><mn>1</mn><mo>‚àí</mo><mi>œµ</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>œµ</mi></mrow><mo>)</mo></mrow><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-193\">J_{PPO}(\\theta) = \\mathbb{E}_{(q,a) \\sim D} \\left[\n\\min \\left(\n\\frac{\\pi_\\theta(o_t | q, o_{<t}; CI)}{\\pi_{\\theta_{\\text{old}}}(o_t | q, o_{<t}; CI)} \\hat{A}_t,\n\\text{clip}\\left(\\frac{\\pi_\\theta}{\\pi_{\\theta_{\\text{old}}}}, 1-\\epsilon, 1+\\epsilon\\right)\\hat{A}_t\n\\right)\n\\right]</script>\n\n    <ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-194-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><mi>q</mi><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo>;</mo><mi>C</mi><mi>I</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2855\" style=\"width: 8.44em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1006.98em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2856\"><span class=\"msubsup\" id=\"MathJax-Span-2857\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2858\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2859\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2860\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2861\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2862\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2863\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2864\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2865\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">q</span><span class=\"mo\" id=\"MathJax-Span-2866\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2867\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2868\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2869\"><span class=\"mrow\" id=\"MathJax-Span-2870\"><span class=\"mo\" id=\"MathJax-Span-2871\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-2872\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2873\" style=\"font-family: STIXGeneral-Regular;\">;</span><span class=\"mi\" id=\"MathJax-Span-2874\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">C<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2875\" style=\"font-family: STIXGeneral-Italic;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2876\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>‚à£</mo><mi>q</mi><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>&lt;</mo><mi>t</mi></mrow></msub><mo>;</mo><mi>C</mi><mi>I</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-194\">\\pi_\\theta(o_t \\mid q, o_{<t}; CI)</script> denotes the <strong>policy model</strong> conditioned on the <strong>code interpreter (CI) state</strong>, which dynamically integrates executable code feedback during reasoning rollouts.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-195-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2877\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.62em, 2.555em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2878\"><span class=\"msubsup\" id=\"MathJax-Span-2879\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2880\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2881\"><span class=\"mrow\" id=\"MathJax-Span-2882\"><span class=\"msubsup\" id=\"MathJax-Span-2883\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2884\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2885\"><span class=\"mrow\" id=\"MathJax-Span-2886\"><span class=\"mtext\" id=\"MathJax-Span-2887\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-195\">\\pi_{\\theta_{\\text{old}}}</script> is the <strong>reference (behavior) policy</strong> from the previous iteration, used for importance sampling to stabilize learning.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-196-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2888\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.992em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2889\"><span class=\"msubsup\" id=\"MathJax-Span-2890\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2891\"><span class=\"mrow\" id=\"MathJax-Span-2892\"><span class=\"munderover\" id=\"MathJax-Span-2893\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2894\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-2895\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2896\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-196\">\\hat{A}_t</script> is the <strong>advantage estimate</strong>, representing how much better an action performed compared to the baseline at time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-197-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2897\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2898\"><span class=\"mi\" id=\"MathJax-Span-2899\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-197\">t</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-198-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2900\" style=\"width: 0.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.42em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2901\"><span class=\"mi\" id=\"MathJax-Span-2902\" style=\"font-family: STIXGeneral-Italic;\">œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-198\">\\epsilon</script> is a <strong>clipping parameter</strong> that limits policy updates to prevent destructive policy shifts (as introduced in <a href=\"https://arxiv.org/abs/1707.06347\">Proximal Policy Optimization</a> by Schulman et al. (2017)).</li>\n          <li>The <strong>min</strong> operator enforces conservative updates by taking the smaller of the unclipped and clipped surrogate objectives.</li>\n          <li>The expectation <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-199-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><mi>D</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2903\" style=\"width: 3.701em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.076em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1003.08em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2904\"><span class=\"msubsup\" id=\"MathJax-Span-2905\"><span style=\"display: inline-block; position: relative; width: 3.076em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2906\"><span class=\"mrow\" id=\"MathJax-Span-2907\"><span class=\"mi\" id=\"MathJax-Span-2908\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2909\"><span class=\"mrow\" id=\"MathJax-Span-2910\"><span class=\"mo\" id=\"MathJax-Span-2911\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2912\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-2913\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2914\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2915\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2916\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"mi\" id=\"MathJax-Span-2917\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">D</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>q</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚àº</mo><mi>D</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-199\">\\mathbb{E}_{(q,a) \\sim D}</script> is taken over sampled question‚Äìanswer pairs from the training dataset <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-200-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2918\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2919\"><span class=\"mi\" id=\"MathJax-Span-2920\" style=\"font-family: STIXGeneral-Italic;\">D</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>D</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-200\">D</script>, reflecting the model‚Äôs distribution of reasoning trajectories.</li>\n          <li>The conditioning on <em>CI</em> allows <strong>real-time interpreter feedback</strong> to influence token-level decision probabilities, enabling the model to learn <em>when</em> and <em>how</em> to invoke code execution within multi-turn reasoning rollouts.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>The <strong>reward function</strong> is outcome-driven. It helps the model autonomously learn <em>when</em> and <em>how</em> to invoke tools through outcome-based reinforcement without human priors. It is expressed as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-201-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>a</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;><mtr><mtd><mn>1</mn></mtd><mtd><mtext>if&amp;#xA0;</mtext><mi>a</mi><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>a</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>,</mo></mtd></mtr><mtr><mtd><mo>&amp;#x2212;</mo><mn>1</mn></mtd><mtd><mtext>otherwise</mtext></mtd></mtr></mtable><mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;></mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2921\" style=\"width: 13.544em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.253em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.294em, 1011.25em, 4.846em, -999.997em); top: -3.799em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2922\"><span class=\"mi\" id=\"MathJax-Span-2923\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-2924\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2925\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2926\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-2927\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-2928\"><span class=\"munderover\" id=\"MathJax-Span-2929\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2930\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-2931\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2932\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2933\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mrow\" id=\"MathJax-Span-2934\" style=\"padding-left: 0.315em;\"><span class=\"mo\" id=\"MathJax-Span-2935\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">{</span></span></span><span class=\"mtable\" id=\"MathJax-Span-2936\" style=\"padding-right: 0.159em; padding-left: 0.159em;\"><span style=\"display: inline-block; position: relative; width: 6.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.607em, 1001.1em, 4.951em, -999.997em); top: -4.008em; left: 0em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.581em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-2937\"><span class=\"mrow\" id=\"MathJax-Span-2938\"><span class=\"mn\" id=\"MathJax-Span-2939\" style=\"font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1001.1em, 4.326em, -999.997em); top: -3.331em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-2951\"><span class=\"mrow\" id=\"MathJax-Span-2952\"><span class=\"mo\" id=\"MathJax-Span-2953\" style=\"font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-2954\" style=\"font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(2.555em, 1003.86em, 4.846em, -999.997em); top: -4.008em; left: 2.294em;\"><span style=\"display: inline-block; position: relative; width: 3.909em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.128em, 1003.39em, 4.326em, -999.997em); top: -4.581em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-2940\"><span class=\"mrow\" id=\"MathJax-Span-2941\"><span class=\"mtext\" id=\"MathJax-Span-2942\" style=\"font-family: STIXGeneral-Regular;\">if&nbsp;</span><span class=\"mi\" id=\"MathJax-Span-2943\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2944\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-2945\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-2946\"><span class=\"munderover\" id=\"MathJax-Span-2947\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2948\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-2949\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2950\" style=\"font-family: STIXGeneral-Regular;\">,</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.86em, 4.169em, -999.997em); top: -3.331em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-2955\"><span class=\"mrow\" id=\"MathJax-Span-2956\"><span class=\"mtext\" id=\"MathJax-Span-2957\" style=\"font-family: STIXGeneral-Regular;\">otherwise</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2958\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.805em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>a</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign=\"left left\" rowspacing=\".2em\" columnspacing=\"1em\" displaystyle=\"false\"><mtr><mtd><mn>1</mn></mtd><mtd><mtext>if&nbsp;</mtext><mi>a</mi><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>a</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>,</mo></mtd></mtr><mtr><mtd><mo>‚àí</mo><mn>1</mn></mtd><mtd><mtext>otherwise</mtext></mtd></mtr></mtable><mo fence=\"true\" stretchy=\"true\" symmetric=\"true\"></mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-201\">R(a, \\hat{a}) =\n\\begin{cases}\n1 & \\text{if } a = \\hat{a}, \\\\\n-1 & \\text{otherwise}\n\\end{cases}</script>\n\n    <ul>\n      <li>\n        <p><strong>Where:</strong></p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-202-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2959\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2960\"><span class=\"mi\" id=\"MathJax-Span-2961\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-202\">a</script> denotes the <strong>predicted answer</strong> produced by the policy model.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-203-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>a</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2962\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2963\"><span class=\"texatom\" id=\"MathJax-Span-2964\"><span class=\"mrow\" id=\"MathJax-Span-2965\"><span class=\"munderover\" id=\"MathJax-Span-2966\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2967\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-2968\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>a</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-203\">\\hat{a}</script> represents the <strong>ground-truth or reference answer</strong> derived from the supervised dataset or external evaluation function.</li>\n          <li>A reward of <strong>1</strong> indicates that the model‚Äôs predicted outcome matches the correct solution, signifying successful reasoning or problem-solving.</li>\n          <li>A reward of <strong>-1</strong> penalizes incorrect outcomes, incentivizing the model to refine tool invocation and reasoning strategies during training.</li>\n          <li>This rule-based accuracy reward is used in <a href=\"https://arxiv.org/abs/2504.11536\">ReTool: Reinforcement Learning for Strategic Tool Use in LLMs</a> by Feng et al. (2025)</li>\n        </ul>\n      </li>\n      <li>\n        <p>This design minimizes reward hacking and fosters exploration diversity.</p>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>The following figure (<a href=\"https://arxiv.org/abs/2504.11536\">source</a>) shows text-based RL training process and ReTool‚Äôs RL training process.</p>\n  </li>\n</ul>\n<p>ReTool‚Äôs training integrates real-time <strong>code interpreter feedback</strong> within the PPO objective:</p>\n<ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-194-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><mi>q</mi><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo>;</mo><mi>C</mi><mi>I</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2855\" style=\"width: 8.44em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1006.98em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2856\"><span class=\"msubsup\" id=\"MathJax-Span-2857\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2858\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2859\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2860\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2861\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2862\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2863\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2864\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2865\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">q</span><span class=\"mo\" id=\"MathJax-Span-2866\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2867\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2868\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2869\"><span class=\"mrow\" id=\"MathJax-Span-2870\"><span class=\"mo\" id=\"MathJax-Span-2871\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-2872\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2873\" style=\"font-family: STIXGeneral-Regular;\">;</span><span class=\"mi\" id=\"MathJax-Span-2874\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">C<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2875\" style=\"font-family: STIXGeneral-Italic;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2876\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>‚à£</mo><mi>q</mi><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>&lt;</mo><mi>t</mi></mrow></msub><mo>;</mo><mi>C</mi><mi>I</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-194\">\\pi_\\theta(o_t \\mid q, o_{<t}; CI)</script> denotes the <strong>policy model</strong> conditioned on the <strong>code interpreter (CI) state</strong>, which dynamically integrates executable code feedback during reasoning rollouts.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-195-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2877\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.62em, 2.555em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2878\"><span class=\"msubsup\" id=\"MathJax-Span-2879\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2880\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2881\"><span class=\"mrow\" id=\"MathJax-Span-2882\"><span class=\"msubsup\" id=\"MathJax-Span-2883\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2884\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2885\"><span class=\"mrow\" id=\"MathJax-Span-2886\"><span class=\"mtext\" id=\"MathJax-Span-2887\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-195\">\\pi_{\\theta_{\\text{old}}}</script> is the <strong>reference (behavior) policy</strong> from the previous iteration, used for importance sampling to stabilize learning.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-196-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2888\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.992em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2889\"><span class=\"msubsup\" id=\"MathJax-Span-2890\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2891\"><span class=\"mrow\" id=\"MathJax-Span-2892\"><span class=\"munderover\" id=\"MathJax-Span-2893\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2894\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-2895\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2896\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-196\">\\hat{A}_t</script> is the <strong>advantage estimate</strong>, representing how much better an action performed compared to the baseline at time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-197-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2897\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2898\"><span class=\"mi\" id=\"MathJax-Span-2899\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-197\">t</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-198-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2900\" style=\"width: 0.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.42em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2901\"><span class=\"mi\" id=\"MathJax-Span-2902\" style=\"font-family: STIXGeneral-Italic;\">œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-198\">\\epsilon</script> is a <strong>clipping parameter</strong> that limits policy updates to prevent destructive policy shifts (as introduced in <a href=\"https://arxiv.org/abs/1707.06347\">Proximal Policy Optimization</a> by Schulman et al. (2017)).</li>\n          <li>The <strong>min</strong> operator enforces conservative updates by taking the smaller of the unclipped and clipped surrogate objectives.</li>\n          <li>The expectation <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-199-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><mi>D</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2903\" style=\"width: 3.701em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.076em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1003.08em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2904\"><span class=\"msubsup\" id=\"MathJax-Span-2905\"><span style=\"display: inline-block; position: relative; width: 3.076em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2906\"><span class=\"mrow\" id=\"MathJax-Span-2907\"><span class=\"mi\" id=\"MathJax-Span-2908\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2909\"><span class=\"mrow\" id=\"MathJax-Span-2910\"><span class=\"mo\" id=\"MathJax-Span-2911\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2912\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-2913\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2914\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2915\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2916\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"mi\" id=\"MathJax-Span-2917\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">D</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>q</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚àº</mo><mi>D</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-199\">\\mathbb{E}_{(q,a) \\sim D}</script> is taken over sampled question‚Äìanswer pairs from the training dataset <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-200-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2918\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2919\"><span class=\"mi\" id=\"MathJax-Span-2920\" style=\"font-family: STIXGeneral-Italic;\">D</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>D</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-200\">D</script>, reflecting the model‚Äôs distribution of reasoning trajectories.</li>\n          <li>The conditioning on <em>CI</em> allows <strong>real-time interpreter feedback</strong> to influence token-level decision probabilities, enabling the model to learn <em>when</em> and <em>how</em> to invoke code execution within multi-turn reasoning rollouts.</li>\n        </ul>\n      </li>\n    </ul>\n<p>where:</p>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-194-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><mi>q</mi><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo>;</mo><mi>C</mi><mi>I</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2855\" style=\"width: 8.44em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1006.98em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2856\"><span class=\"msubsup\" id=\"MathJax-Span-2857\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2858\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2859\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2860\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2861\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2862\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2863\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2864\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2865\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">q</span><span class=\"mo\" id=\"MathJax-Span-2866\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2867\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2868\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2869\"><span class=\"mrow\" id=\"MathJax-Span-2870\"><span class=\"mo\" id=\"MathJax-Span-2871\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-2872\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2873\" style=\"font-family: STIXGeneral-Regular;\">;</span><span class=\"mi\" id=\"MathJax-Span-2874\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">C<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2875\" style=\"font-family: STIXGeneral-Italic;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2876\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>‚à£</mo><mi>q</mi><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>&lt;</mo><mi>t</mi></mrow></msub><mo>;</mo><mi>C</mi><mi>I</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-194\">\\pi_\\theta(o_t \\mid q, o_{<t}; CI)</script> denotes the <strong>policy model</strong> conditioned on the <strong>code interpreter (CI) state</strong>, which dynamically integrates executable code feedback during reasoning rollouts.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-195-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2877\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.62em, 2.555em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2878\"><span class=\"msubsup\" id=\"MathJax-Span-2879\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2880\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2881\"><span class=\"mrow\" id=\"MathJax-Span-2882\"><span class=\"msubsup\" id=\"MathJax-Span-2883\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2884\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2885\"><span class=\"mrow\" id=\"MathJax-Span-2886\"><span class=\"mtext\" id=\"MathJax-Span-2887\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-195\">\\pi_{\\theta_{\\text{old}}}</script> is the <strong>reference (behavior) policy</strong> from the previous iteration, used for importance sampling to stabilize learning.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-196-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2888\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.992em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2889\"><span class=\"msubsup\" id=\"MathJax-Span-2890\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2891\"><span class=\"mrow\" id=\"MathJax-Span-2892\"><span class=\"munderover\" id=\"MathJax-Span-2893\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2894\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-2895\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2896\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-196\">\\hat{A}_t</script> is the <strong>advantage estimate</strong>, representing how much better an action performed compared to the baseline at time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-197-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2897\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2898\"><span class=\"mi\" id=\"MathJax-Span-2899\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-197\">t</script>.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-198-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2900\" style=\"width: 0.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.42em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2901\"><span class=\"mi\" id=\"MathJax-Span-2902\" style=\"font-family: STIXGeneral-Italic;\">œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-198\">\\epsilon</script> is a <strong>clipping parameter</strong> that limits policy updates to prevent destructive policy shifts (as introduced in <a href=\"https://arxiv.org/abs/1707.06347\">Proximal Policy Optimization</a> by Schulman et al. (2017)).</li>\n          <li>The <strong>min</strong> operator enforces conservative updates by taking the smaller of the unclipped and clipped surrogate objectives.</li>\n          <li>The expectation <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-199-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><mi>D</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2903\" style=\"width: 3.701em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.076em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1003.08em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2904\"><span class=\"msubsup\" id=\"MathJax-Span-2905\"><span style=\"display: inline-block; position: relative; width: 3.076em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2906\"><span class=\"mrow\" id=\"MathJax-Span-2907\"><span class=\"mi\" id=\"MathJax-Span-2908\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2909\"><span class=\"mrow\" id=\"MathJax-Span-2910\"><span class=\"mo\" id=\"MathJax-Span-2911\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2912\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-2913\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2914\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2915\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2916\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"mi\" id=\"MathJax-Span-2917\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">D</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>q</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚àº</mo><mi>D</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-199\">\\mathbb{E}_{(q,a) \\sim D}</script> is taken over sampled question‚Äìanswer pairs from the training dataset <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-200-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2918\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2919\"><span class=\"mi\" id=\"MathJax-Span-2920\" style=\"font-family: STIXGeneral-Italic;\">D</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>D</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-200\">D</script>, reflecting the model‚Äôs distribution of reasoning trajectories.</li>\n          <li>The conditioning on <em>CI</em> allows <strong>real-time interpreter feedback</strong> to influence token-level decision probabilities, enabling the model to learn <em>when</em> and <em>how</em> to invoke code execution within multi-turn reasoning rollouts.</li>\n        </ul>\n<p>The <strong>reward function</strong> is outcome-driven. It helps the model autonomously learn <em>when</em> and <em>how</em> to invoke tools through outcome-based reinforcement without human priors. It is expressed as:</p>\n<ul>\n      <li>\n        <p><strong>Where:</strong></p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-202-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2959\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2960\"><span class=\"mi\" id=\"MathJax-Span-2961\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-202\">a</script> denotes the <strong>predicted answer</strong> produced by the policy model.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-203-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>a</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2962\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2963\"><span class=\"texatom\" id=\"MathJax-Span-2964\"><span class=\"mrow\" id=\"MathJax-Span-2965\"><span class=\"munderover\" id=\"MathJax-Span-2966\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2967\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-2968\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>a</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-203\">\\hat{a}</script> represents the <strong>ground-truth or reference answer</strong> derived from the supervised dataset or external evaluation function.</li>\n          <li>A reward of <strong>1</strong> indicates that the model‚Äôs predicted outcome matches the correct solution, signifying successful reasoning or problem-solving.</li>\n          <li>A reward of <strong>-1</strong> penalizes incorrect outcomes, incentivizing the model to refine tool invocation and reasoning strategies during training.</li>\n          <li>This rule-based accuracy reward is used in <a href=\"https://arxiv.org/abs/2504.11536\">ReTool: Reinforcement Learning for Strategic Tool Use in LLMs</a> by Feng et al. (2025)</li>\n        </ul>\n      </li>\n      <li>\n        <p>This design minimizes reward hacking and fosters exploration diversity.</p>\n      </li>\n    </ul>\n<p><strong>Where:</strong></p>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-202-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2959\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2960\"><span class=\"mi\" id=\"MathJax-Span-2961\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-202\">a</script> denotes the <strong>predicted answer</strong> produced by the policy model.</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-203-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>a</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2962\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2963\"><span class=\"texatom\" id=\"MathJax-Span-2964\"><span class=\"mrow\" id=\"MathJax-Span-2965\"><span class=\"munderover\" id=\"MathJax-Span-2966\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2967\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.107em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-2968\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>a</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-203\">\\hat{a}</script> represents the <strong>ground-truth or reference answer</strong> derived from the supervised dataset or external evaluation function.</li>\n          <li>A reward of <strong>1</strong> indicates that the model‚Äôs predicted outcome matches the correct solution, signifying successful reasoning or problem-solving.</li>\n          <li>A reward of <strong>-1</strong> penalizes incorrect outcomes, incentivizing the model to refine tool invocation and reasoning strategies during training.</li>\n          <li>This rule-based accuracy reward is used in <a href=\"https://arxiv.org/abs/2504.11536\">ReTool: Reinforcement Learning for Strategic Tool Use in LLMs</a> by Feng et al. (2025)</li>\n        </ul>\n<p>This design minimizes reward hacking and fosters exploration diversity.</p>\n<p>The following figure (<a href=\"https://arxiv.org/abs/2504.11536\">source</a>) shows text-based RL training process and ReTool‚Äôs RL training process.</p>\n<p><img src=\"/primers/ai/assets/RL-for-agents/ReTool.jpg\" alt=\"\"></p>\n<h5 id=\"emergent-behaviors-1\">Emergent Behaviors</h5>\n<ul>\n  <li>\n    <p>ReTool exhibits <em>strategic learning of code usage</em>, such as:</p>\n\n    <ul>\n      <li><strong>Adaptive timing</strong> of tool invocation.</li>\n      <li><strong>Code self-correction</strong>‚Äîdetecting and repairing tool errors mid-reasoning.</li>\n      <li><strong>Efficiency emergence</strong>, with response lengths reduced by ~40% after training.</li>\n    </ul>\n  </li>\n</ul>\n<p>ReTool exhibits <em>strategic learning of code usage</em>, such as:</p>\n<ul>\n      <li><strong>Adaptive timing</strong> of tool invocation.</li>\n      <li><strong>Code self-correction</strong>‚Äîdetecting and repairing tool errors mid-reasoning.</li>\n      <li><strong>Efficiency emergence</strong>, with response lengths reduced by ~40% after training.</li>\n    </ul>\n<h5 id=\"results-1\">Results</h5>\n<ul>\n  <li>ReTool-32B achieves <strong>67% accuracy on AIME2024</strong> in just 400 training steps‚Äîoutperforming text-only RL baselines (40% at 1080 steps) and surpassing <strong>OpenAI‚Äôs o1-preview</strong> by <strong>27.9%</strong>.</li>\n</ul>\n<h5 id=\"impact\">Impact</h5>\n<ul>\n  <li>ReTool establishes that <strong>dynamic interleaving of reasoning and code execution during RL</strong> leads to emergent meta-reasoning and adaptive tool use‚Äîkey traits for future agentic reasoning systems.</li>\n</ul>\n<h4 id=\"tool-integrated-reinforcement-learning-for-llm-judges-tir-judge\">Tool-Integrated Reinforcement Learning for LLM Judges (TIR-Judge)</h4>\n<ul>\n  <li><a href=\"https://arxiv.org/abs/2510.23038\">TIR-Judge</a> by Xu et al. (2025) extends tool-augmented RL beyond reasoning tasks to <strong>evaluation and alignment</strong>. It trains <em>LLM-based judges</em> that can autonomously verify, compute, and reason during the evaluation of model responses.</li>\n</ul>\n<h5 id=\"concept-and-framework\">Concept and Framework</h5>\n<ul>\n  <li>\n    <p>TIR-Judge builds an RL pipeline for <em>agentic evaluators</em>, allowing LLM judges to:</p>\n\n    <ol>\n      <li>Generate natural-language reasoning.</li>\n      <li>Produce code snippets for verification.</li>\n      <li>Execute them within a sandbox.</li>\n      <li>Incorporate results into final judgment.</li>\n    </ol>\n  </li>\n  <li>\n    <p>Each judgment trajectory is represented as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-204-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>s</mi><mi>k</mi></msub><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>r</mi><mn>1</mn></msub><mo>,</mo><msub><mi>c</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>r</mi><mi>k</mi></msub><mo>,</mo><msub><mi>c</mi><mi>k</mi></msub><mo>,</mo><msub><mi>o</mi><mi>k</mi></msub></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2969\" style=\"width: 13.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1011.15em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2970\"><span class=\"msubsup\" id=\"MathJax-Span-2971\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2972\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2973\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2974\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-2975\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-2976\"><span class=\"msubsup\" id=\"MathJax-Span-2977\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2978\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-2979\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2980\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2981\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2982\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mn\" id=\"MathJax-Span-2983\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2984\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2985\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2986\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-2987\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2988\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-2989\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-2990\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2991\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2992\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2993\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2994\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2995\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2996\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2997\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2998\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2999\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3000\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3001\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>s</mi><mi>k</mi></msub><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>r</mi><mn>1</mn></msub><mo>,</mo><msub><mi>c</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msub><mi>r</mi><mi>k</mi></msub><mo>,</mo><msub><mi>c</mi><mi>k</mi></msub><mo>,</mo><msub><mi>o</mi><mi>k</mi></msub></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-204\">s_k = {r_1, c_1, o_1, \\dots, r_k, c_k, o_k}</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-205-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3002\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3003\"><span class=\"msubsup\" id=\"MathJax-Span-3004\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3005\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3006\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-205\">r_i</script> is the reasoning step, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-206-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3007\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3008\"><span class=\"msubsup\" id=\"MathJax-Span-3009\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3010\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3011\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>c</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-206\">c_i</script> the generated code, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-207-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>i</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3012\" style=\"width: 4.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.753em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.7em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3013\"><span class=\"msubsup\" id=\"MathJax-Span-3014\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3015\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3016\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3017\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3018\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3019\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3020\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3021\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3022\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3023\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>i</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=\"false\">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-207\">o_i = I(c_i)</script> the interpreter output.</li>\n    </ul>\n  </li>\n</ul>\n<p>TIR-Judge builds an RL pipeline for <em>agentic evaluators</em>, allowing LLM judges to:</p>\n<ol>\n      <li>Generate natural-language reasoning.</li>\n      <li>Produce code snippets for verification.</li>\n      <li>Execute them within a sandbox.</li>\n      <li>Incorporate results into final judgment.</li>\n    </ol>\n<p>Each judgment trajectory is represented as:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-205-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3002\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3003\"><span class=\"msubsup\" id=\"MathJax-Span-3004\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3005\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3006\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-205\">r_i</script> is the reasoning step, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-206-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3007\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3008\"><span class=\"msubsup\" id=\"MathJax-Span-3009\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3010\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3011\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>c</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-206\">c_i</script> the generated code, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-207-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>i</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3012\" style=\"width: 4.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.753em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.7em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3013\"><span class=\"msubsup\" id=\"MathJax-Span-3014\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3015\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3016\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3017\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3018\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">I<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3019\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3020\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3021\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3022\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3023\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>i</mi></msub><mo>=</mo><mi>I</mi><mo stretchy=\"false\">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-207\">o_i = I(c_i)</script> the interpreter output.</li>\n    </ul>\n<h5 id=\"training\">Training</h5>\n<ul>\n  <li>\n    <p>TIR-Judge employs an <strong>iterative RL pipeline</strong> combining <strong>pairwise</strong>, <strong>pointwise</strong>, and <strong>listwise</strong> judgments‚Äîspanning both verifiable (math, code) and non-verifiable (dialogue, safety) domains.</p>\n  </li>\n  <li>\n    <p>Two variants are explored:</p>\n\n    <ul>\n      <li><strong>TIR-Judge-Distill</strong>, which uses small distillation-based initialization.</li>\n      <li><strong>TIR-Judge-Zero</strong>, trained purely via RL without any distillation data.\nHere is your text with added citations:</li>\n    </ul>\n  </li>\n  <li>\n    <p>TIR-Judge adopts Decoupled Clip and Dynamic Sampling Policy Optimization (<a href=\"https://arxiv.org/pdf/2503.14476v1\">DAPO</a>) (an improved variant of <a href=\"https://arxiv.org/abs/2402.03300\">GRPO</a>) for training the LLM judge <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-208-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>J</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3024\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3025\"><span class=\"mi\" id=\"MathJax-Span-3026\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>J</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-208\">J</script> parameterized by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-209-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3027\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3028\"><span class=\"msubsup\" id=\"MathJax-Span-3029\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3030\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3031\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-209\">\\pi_\\theta</script>. Given a prompt-answer pair <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-210-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3032\" style=\"width: 2.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.03em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3033\"><span class=\"mo\" id=\"MathJax-Span-3034\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3035\" style=\"font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-3036\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3037\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-3038\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>q</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-210\">(q, a)</script>, they first sample a group of <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-211-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3039\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3040\"><span class=\"mi\" id=\"MathJax-Span-3041\" style=\"font-family: STIXGeneral-Italic;\">G</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>G</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-211\">G</script> rollouts <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-212-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mi>i</mi></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3042\" style=\"width: 2.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1002.03em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3043\"><span class=\"msubsup\" id=\"MathJax-Span-3044\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3045\"><span class=\"mrow\" id=\"MathJax-Span-3046\"><span class=\"msubsup\" id=\"MathJax-Span-3047\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3048\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3049\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.372em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-3050\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.169em, -999.997em); top: -3.695em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3051\"><span class=\"mrow\" id=\"MathJax-Span-3052\"><span class=\"mi\" id=\"MathJax-Span-3053\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3054\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3055\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3056\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>s</mi><mi>i</mi></msub></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-212\">{s_i}_{i=1}^G)</script> from the current policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-213-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3057\" style=\"width: 2.346em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.88em, 2.607em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3058\"><span class=\"msubsup\" id=\"MathJax-Span-3059\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3060\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3061\"><span class=\"mrow\" id=\"MathJax-Span-3062\"><span class=\"msubsup\" id=\"MathJax-Span-3063\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3064\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3065\"><span class=\"mrow\" id=\"MathJax-Span-3066\"><span class=\"mtext\" id=\"MathJax-Span-3067\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3068\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-213\">\\pi_{\\theta_{\\text{old}}})</script>. Each rollout <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-214-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3069\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3070\"><span class=\"msubsup\" id=\"MathJax-Span-3071\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3072\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3073\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-214\">s_i</script> is assigned a scalar reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-215-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>i</mi></msub><mo>=</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3074\" style=\"width: 6.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.003em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.95em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3075\"><span class=\"msubsup\" id=\"MathJax-Span-3076\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3077\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3078\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3079\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3080\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">R</span><span class=\"mo\" id=\"MathJax-Span-3081\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3082\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3083\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3084\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3085\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3086\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-3087\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>i</mi></msub><mo>=</mo><mi>R</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-215\">R_i = R(s_i, a)</script> with access to the oracle answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-216-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3088\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3089\"><span class=\"mi\" id=\"MathJax-Span-3090\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-216\">a</script>. The policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-217-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3091\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3092\"><span class=\"msubsup\" id=\"MathJax-Span-3093\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3094\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3095\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-217\">\\pi_\\theta</script> is then updated with the following clipped policy gradient objective:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\"><span class=\"MathJax MathJax_FullWidth\" id=\"MathJax-Element-218-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>J</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>D</mi></mrow><mo>,</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mi>i</mi></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;2.470em&quot; minsize=&quot;2.470em&quot;>[</mo></mrow><mfrac><mn>1</mn><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>(</mo></mrow><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>p</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mi>&amp;#x03B5;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>low</mtext></mrow></msub><mo>,</mo><mn>1</mn><mo>+</mo><msub><mi>&amp;#x03B5;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>high</mtext></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow><mspace linebreak=&quot;newline&quot; /><mo>&amp;#x2212;</mo><mi>&amp;#x03B2;</mi><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo>,</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2016;</mo><mo>,</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;2.470em&quot; minsize=&quot;2.470em&quot;>]</mo></mrow><mspace linebreak=&quot;newline&quot; /><mspace width=&quot;1em&quot; /><mtext>s.t.&amp;#xA0;</mtext><mn>0</mn><mo>&amp;lt;&amp;#x2223;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mi>i</mi></msub><mo>:</mo><mtext>is_equivalent</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>&amp;#x2223;&amp;lt;</mo><mi>G</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3096\" style=\"width: 100%; display: inline-block; min-width: 28.857em;\"><span style=\"display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(13.076em, 1023.91em, 26.305em, -999.997em); top: -13.904em; left: 0em; width: 100%;\"><span class=\"mrow\" id=\"MathJax-Span-3097\"><span style=\"display: inline-block; position: relative; width: 100%; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1001.88em, 4.326em, -999.997em); top: -4.008em; left: 50%; margin-left: -0.987em;\"><span class=\"texatom\" id=\"MathJax-Span-3098\"><span class=\"mrow\" id=\"MathJax-Span-3099\"><span class=\"mi\" id=\"MathJax-Span-3100\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∂<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3101\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3102\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3103\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(2.138em, 1014.53em, 5.523em, -999.997em); top: -1.612em; left: 50%; margin-left: -7.289em;\"><span class=\"mo\" id=\"MathJax-Span-3104\" style=\"font-family: STIXGeneral-Regular;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3105\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 7.555em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3106\"><span class=\"mrow\" id=\"MathJax-Span-3107\"><span class=\"mi\" id=\"MathJax-Span-3108\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.747em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3109\"><span class=\"mrow\" id=\"MathJax-Span-3110\"><span class=\"mo\" id=\"MathJax-Span-3111\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3112\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-3113\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3114\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-3115\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3116\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"texatom\" id=\"MathJax-Span-3117\"><span class=\"mrow\" id=\"MathJax-Span-3118\"><span class=\"mi\" id=\"MathJax-Span-3119\" style=\"font-size: 70.7%; font-family: STIXNonUnicode-Italic;\">Óà∞</span></span></span><span class=\"mo\" id=\"MathJax-Span-3120\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3121\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.47em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3122\"><span class=\"mrow\" id=\"MathJax-Span-3123\"><span class=\"msubsup\" id=\"MathJax-Span-3124\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3125\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-3126\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.42em, 4.169em, -999.997em); top: -4.268em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3127\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.78em, 4.169em, -999.997em); top: -3.799em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3128\"><span class=\"mrow\" id=\"MathJax-Span-3129\"><span class=\"mi\" id=\"MathJax-Span-3130\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3131\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3132\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3133\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-3134\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3135\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3136\"><span class=\"mrow\" id=\"MathJax-Span-3137\"><span class=\"msubsup\" id=\"MathJax-Span-3138\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3139\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3140\"><span class=\"mrow\" id=\"MathJax-Span-3141\"><span class=\"mtext\" id=\"MathJax-Span-3142\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3143\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-3144\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-3145\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3146\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-3147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3148\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-3149\"><span class=\"mo\" id=\"MathJax-Span-3150\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span></span></span><span class=\"mfrac\" id=\"MathJax-Span-3151\"><span style=\"display: inline-block; position: relative; width: 3.648em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-3152\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(2.919em, 1003.39em, 4.482em, -999.997em); top: -3.07em; left: 50%; margin-left: -1.768em;\"><span class=\"mrow\" id=\"MathJax-Span-3153\"><span class=\"munderover\" id=\"MathJax-Span-3154\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3155\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-3156\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-3157\"><span class=\"mrow\" id=\"MathJax-Span-3158\"><span class=\"mi\" id=\"MathJax-Span-3159\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3160\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3161\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3162\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-3163\"><span class=\"mo\" id=\"MathJax-Span-3164\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3165\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3166\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3167\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3168\"><span class=\"mrow\" id=\"MathJax-Span-3169\"><span class=\"mo\" id=\"MathJax-Span-3170\" style=\"font-family: STIXVariants;\">|</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.65em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.648em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-3171\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3172\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.94em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-3173\"><span class=\"mrow\" id=\"MathJax-Span-3174\"><span class=\"mi\" id=\"MathJax-Span-3175\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3176\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3177\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.52em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-3178\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.065em;\"></span></span><span style=\"position: absolute; clip: rect(2.086em, 1023.91em, 5.471em, -999.997em); top: 1.982em; left: 50%; margin-left: -12.029em;\"><span class=\"munderover\" id=\"MathJax-Span-3179\" style=\"\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3180\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.99em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-3181\"><span class=\"mrow\" id=\"MathJax-Span-3182\"><span class=\"mi\" id=\"MathJax-Span-3183\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3184\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3185\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.84em, 4.326em, -999.997em); top: -5.258em; left: 0.211em;\"><span class=\"texatom\" id=\"MathJax-Span-3186\"><span class=\"mrow\" id=\"MathJax-Span-3187\"><span class=\"texatom\" id=\"MathJax-Span-3188\"><span class=\"mrow\" id=\"MathJax-Span-3189\"><span class=\"mo\" id=\"MathJax-Span-3190\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3191\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3192\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-3193\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3194\"><span class=\"mrow\" id=\"MathJax-Span-3195\"><span class=\"mo\" id=\"MathJax-Span-3196\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3197\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-3198\"><span class=\"mo\" id=\"MathJax-Span-3199\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">(</span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3200\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">min</span><span class=\"texatom\" id=\"MathJax-Span-3201\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-3202\"><span class=\"mo\" id=\"MathJax-Span-3203\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3204\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3205\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3206\"><span class=\"mrow\" id=\"MathJax-Span-3207\"><span class=\"mi\" id=\"MathJax-Span-3208\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3209\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3210\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3211\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3212\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3213\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3214\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3215\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.99em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3216\"><span class=\"mrow\" id=\"MathJax-Span-3217\"><span class=\"munderover\" id=\"MathJax-Span-3218\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0.211em;\"><span class=\"mi\" id=\"MathJax-Span-3219\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.076em, 1000.99em, 3.596em, -999.997em); top: -4.216em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3220\" style=\"\"><span style=\"font-family: STIXSizeTwoSym;\">ÀÜ</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.992em;\"><span class=\"texatom\" id=\"MathJax-Span-3221\"><span class=\"mrow\" id=\"MathJax-Span-3222\"><span class=\"mi\" id=\"MathJax-Span-3223\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3224\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3225\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3226\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-3227\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-3228\"><span class=\"mi\" id=\"MathJax-Span-3229\" style=\"font-family: STIXGeneral-Regular;\">c</span><span class=\"mi\" id=\"MathJax-Span-3230\" style=\"font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-3231\" style=\"font-family: STIXGeneral-Regular;\">i</span><span class=\"mi\" id=\"MathJax-Span-3232\" style=\"font-family: STIXGeneral-Regular;\">p</span></span></span><span class=\"mo\" id=\"MathJax-Span-3233\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3234\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3235\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3236\"><span class=\"mrow\" id=\"MathJax-Span-3237\"><span class=\"mi\" id=\"MathJax-Span-3238\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3239\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3240\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3241\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3242\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3243\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3244\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3245\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3246\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-3247\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3248\" style=\"font-family: STIXGeneral-Italic;\">Œµ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3249\"><span class=\"mrow\" id=\"MathJax-Span-3250\"><span class=\"mtext\" id=\"MathJax-Span-3251\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">low</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3252\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3253\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3254\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-3255\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3256\" style=\"font-family: STIXGeneral-Italic;\">Œµ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3257\"><span class=\"mrow\" id=\"MathJax-Span-3258\"><span class=\"mtext\" id=\"MathJax-Span-3259\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">high</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3260\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3261\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3262\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.99em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3263\"><span class=\"mrow\" id=\"MathJax-Span-3264\"><span class=\"munderover\" id=\"MathJax-Span-3265\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0.211em;\"><span class=\"mi\" id=\"MathJax-Span-3266\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.076em, 1000.99em, 3.596em, -999.997em); top: -4.216em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3267\" style=\"\"><span style=\"font-family: STIXSizeTwoSym;\">ÀÜ</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.992em;\"><span class=\"texatom\" id=\"MathJax-Span-3268\"><span class=\"mrow\" id=\"MathJax-Span-3269\"><span class=\"mi\" id=\"MathJax-Span-3270\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3271\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3272\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3273\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-3274\"><span class=\"mo\" id=\"MathJax-Span-3275\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.065em;\"></span></span><span style=\"position: absolute; clip: rect(2.138em, 1008.96em, 5.523em, -999.997em); top: 5.523em; left: 50%; margin-left: -4.633em;\"><span class=\"mspace\" id=\"MathJax-Span-3276\" style=\"height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3277\" style=\"font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-3278\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-3279\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3280\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-3281\"><span class=\"mrow\" id=\"MathJax-Span-3282\"><span class=\"mi\" id=\"MathJax-Span-3283\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3284\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">L</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3285\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-3286\"><span class=\"mo\" id=\"MathJax-Span-3287\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3288\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3289\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3290\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3291\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-3292\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Äñ</span><span class=\"mo\" id=\"MathJax-Span-3293\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3294\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3295\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3296\"><span class=\"mrow\" id=\"MathJax-Span-3297\"><span class=\"mi\" id=\"MathJax-Span-3298\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3299\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-3300\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3301\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-3302\"><span class=\"mo\" id=\"MathJax-Span-3303\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3304\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-3305\"><span class=\"mo\" id=\"MathJax-Span-3306\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">)</span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3307\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-3308\"><span class=\"mo\" id=\"MathJax-Span-3309\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.065em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1016.1em, 4.378em, -999.997em); top: 8.023em; left: 50%; margin-left: -8.07em;\"><span class=\"mspace\" id=\"MathJax-Span-3310\" style=\"height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;\"></span><span class=\"mspace\" id=\"MathJax-Span-3311\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"mtext\" id=\"MathJax-Span-3312\" style=\"font-family: STIXGeneral-Regular;\">s.t.&nbsp;</span><span class=\"mn\" id=\"MathJax-Span-3313\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3314\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">&lt;<span style=\"font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;\">‚à£</span></span><span class=\"texatom\" id=\"MathJax-Span-3315\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-3316\"><span class=\"msubsup\" id=\"MathJax-Span-3317\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3318\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3319\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3320\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">:</span><span class=\"mtext\" id=\"MathJax-Span-3321\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">is_equivalent</span><span class=\"mo\" id=\"MathJax-Span-3322\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3323\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-3324\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3325\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3326\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3327\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3328\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span class=\"mo\" id=\"MathJax-Span-3329\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£<span style=\"font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;\">&lt;</span></span><span class=\"mi\" id=\"MathJax-Span-3330\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 13.909em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -14.747em; border-left: 0px solid; width: 0px; height: 15.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">J</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>q</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚àº</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">D</mi></mrow><mo>,</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>s</mi><mi>i</mi></msub></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo>‚àº</mo><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"2.470em\" minsize=\"2.470em\">[</mo></mrow><mfrac><mn>1</mn><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>s</mi><mi>i</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow></mrow></mfrac><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></munderover><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>s</mi><mi>i</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow></mrow></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">(</mo></mrow><mo movablelimits=\"true\" form=\"prefix\">min</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo>^</mo></mover></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">c</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">p</mi></mrow><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mn>1</mn><mo>‚àí</mo><msub><mi>Œµ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>low</mtext></mrow></msub><mo>,</mo><mn>1</mn><mo>+</mo><msub><mi>Œµ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>high</mtext></mrow></msub><mo stretchy=\"false\">)</mo><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo>^</mo></mover></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow><mspace linebreak=\"newline\"></mspace><mo>‚àí</mo><mi>Œ≤</mi><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo>,</mo><mo fence=\"false\" stretchy=\"false\">‚Äñ</mo><mo>,</mo><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">)</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"2.470em\" minsize=\"2.470em\">]</mo></mrow><mspace linebreak=\"newline\"></mspace><mspace width=\"1em\"></mspace><mtext>s.t.&nbsp;</mtext><mn>0</mn><mo>&lt;‚à£</mo><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>s</mi><mi>i</mi></msub><mo>:</mo><mtext>is_equivalent</mtext><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>‚à£&lt;</mo><mi>G</mi></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-218\">\\mathcal J(\\theta) = \\mathbb E_{(q,a)\\sim \\mathcal D,{s_i}_{i=1}^G\\sim\\pi_{\\theta_{\\text{old}}}(\\cdot\\mid q)}\\Bigg[\\frac1{\\sum_{i=1}^G |s_i|} \\sum_{i=1}^G \\sum_{t=1}^{|s_i|} \\Big(\\min\\big(r_{i,t}(\\theta),\\widehat A_{i,t},\\mathrm{clip}(r_{i,t}(\\theta),1-\\varepsilon_{\\text{low}},1+\\varepsilon_{\\text{high}}),\\widehat A_{i,t}\\big)\\\\\n-\\beta D_{\\rm KL}\\big(\\pi_\\theta ,\\Vert, \\pi_{\\rm ref}\\big)\\Big)\\Bigg]\\\\\n\\quad\\text{s.t. }0<\\mid{s_i:\\text{is_equivalent}(a,s_i)}\\mid<G</script>\n\n    <ul>\n      <li>where:\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-219-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>&amp;#x2223;</mo><mi>q</mi><mo>,</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>d</mi></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>&amp;#x2223;</mo><mi>q</mi><mo>,</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3331\" style=\"width: 9.846em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.94em, 1008.18em, 3.023em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3332\"><span class=\"msubsup\" id=\"MathJax-Span-3333\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3334\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3335\"><span class=\"mrow\" id=\"MathJax-Span-3336\"><span class=\"mi\" id=\"MathJax-Span-3337\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3338\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3339\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3340\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3341\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3342\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3343\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-3344\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.482em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1003.65em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -1.82em;\"><span class=\"mrow\" id=\"MathJax-Span-3345\"><span class=\"msubsup\" id=\"MathJax-Span-3346\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3347\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3348\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3349\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3350\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3351\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3352\"><span class=\"mrow\" id=\"MathJax-Span-3353\"><span class=\"mi\" id=\"MathJax-Span-3354\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3355\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3356\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3357\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3358\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-3359\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3360\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3361\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3362\"><span class=\"mrow\" id=\"MathJax-Span-3363\"><span class=\"mi\" id=\"MathJax-Span-3364\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3365\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-3366\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-3367\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3368\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1004.33em, 4.43em, -999.997em); top: -3.591em; left: 50%; margin-left: -2.185em;\"><span class=\"mrow\" id=\"MathJax-Span-3369\"><span class=\"msubsup\" id=\"MathJax-Span-3370\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3371\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3372\"><span class=\"mrow\" id=\"MathJax-Span-3373\"><span class=\"msubsup\" id=\"MathJax-Span-3374\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3375\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3376\"><span class=\"mrow\" id=\"MathJax-Span-3377\"><span class=\"mi\" id=\"MathJax-Span-3378\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-3379\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-3380\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">d</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3381\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3382\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3383\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3384\"><span class=\"mrow\" id=\"MathJax-Span-3385\"><span class=\"mi\" id=\"MathJax-Span-3386\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3387\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3388\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3389\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3390\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-3391\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3392\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3393\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3394\"><span class=\"mrow\" id=\"MathJax-Span-3395\"><span class=\"mi\" id=\"MathJax-Span-3396\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3397\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-3398\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-3399\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3400\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.48em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.482em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>‚à£</mo><mi>q</mi><mo>,</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mo>&lt;</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">d</mi></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>‚à£</mo><mi>q</mi><mo>,</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mo>&lt;</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-219\">r_{i,t}(\\theta) = \\frac{\\pi_\\theta(s_{i,t}\\mid q, s_{i,<t})}{\\pi_{\\theta_{\\rm old}}(s_{i,t}\\mid q, s_{i,<t})}</script> is the token-level importance weight, and</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-220-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mi>mean</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>R</mi><mi>i</mi></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi>std</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>R</mi><mi>i</mi></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3401\" style=\"width: 9.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.836em, 1007.66em, 3.076em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3402\"><span class=\"msubsup\" id=\"MathJax-Span-3403\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.99em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3404\"><span class=\"mrow\" id=\"MathJax-Span-3405\"><span class=\"munderover\" id=\"MathJax-Span-3406\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0.211em;\"><span class=\"mi\" id=\"MathJax-Span-3407\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.076em, 1000.99em, 3.596em, -999.997em); top: -4.216em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3408\" style=\"\"><span style=\"font-family: STIXSizeTwoSym;\">ÀÜ</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.992em;\"><span class=\"texatom\" id=\"MathJax-Span-3409\"><span class=\"mrow\" id=\"MathJax-Span-3410\"><span class=\"mi\" id=\"MathJax-Span-3411\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3412\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3413\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3414\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-3415\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.638em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.232em, 1004.48em, 4.378em, -999.997em); top: -4.633em; left: 50%; margin-left: -2.237em;\"><span class=\"mrow\" id=\"MathJax-Span-3416\"><span class=\"msubsup\" id=\"MathJax-Span-3417\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3418\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-3419\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3420\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-3421\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">mean</span><span class=\"mo\" id=\"MathJax-Span-3422\" style=\"font-size: 70.7%;\"></span><span class=\"mo\" id=\"MathJax-Span-3423\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3424\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.63em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3425\"><span class=\"mrow\" id=\"MathJax-Span-3426\"><span class=\"msubsup\" id=\"MathJax-Span-3427\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3428\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-3429\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.42em, 4.169em, -999.997em); top: -4.268em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3430\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.78em, 4.169em, -999.997em); top: -3.799em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3431\"><span class=\"mrow\" id=\"MathJax-Span-3432\"><span class=\"mi\" id=\"MathJax-Span-3433\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3434\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3435\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3436\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.232em, 1002.66em, 4.378em, -999.997em); top: -3.487em; left: 50%; margin-left: -1.352em;\"><span class=\"mrow\" id=\"MathJax-Span-3437\"><span class=\"mi\" id=\"MathJax-Span-3438\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">std</span><span class=\"mo\" id=\"MathJax-Span-3439\" style=\"font-size: 70.7%;\"></span><span class=\"mo\" id=\"MathJax-Span-3440\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3441\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.63em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3442\"><span class=\"mrow\" id=\"MathJax-Span-3443\"><span class=\"msubsup\" id=\"MathJax-Span-3444\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3445\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-3446\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.42em, 4.169em, -999.997em); top: -4.268em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3447\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.78em, 4.169em, -999.997em); top: -3.799em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3448\"><span class=\"mrow\" id=\"MathJax-Span-3449\"><span class=\"mi\" id=\"MathJax-Span-3450\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3451\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3452\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3453\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.64em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.638em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.934em; border-left: 0px solid; width: 0px; height: 2.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo>^</mo></mover></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mi>i</mi></msub><mo>‚àí</mo><mi>mean</mi><mo>‚Å°</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>R</mi><mi>i</mi></msub></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=\"false\">)</mo></mrow><mrow><mi>std</mi><mo>‚Å°</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>R</mi><mi>i</mi></msub></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-220\">\\widehat A_{i,t} = \\frac{R_i - \\operatorname{mean}({R_i}_{i=1}^G)}{\\operatorname{std}({R_i}_{i=1}^G)}</script> is the token-level advantage</li>\n          <li>The hyperparameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-221-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B5;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>low</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3454\" style=\"width: 1.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.57em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3455\"><span class=\"msubsup\" id=\"MathJax-Span-3456\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3457\" style=\"font-family: STIXGeneral-Italic;\">Œµ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3458\"><span class=\"mrow\" id=\"MathJax-Span-3459\"><span class=\"mtext\" id=\"MathJax-Span-3460\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">low</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Œµ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>low</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-221\">\\varepsilon_{\\text {low}}</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-222-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B5;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>high</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3461\" style=\"width: 2.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.77em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3462\"><span class=\"msubsup\" id=\"MathJax-Span-3463\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3464\" style=\"font-family: STIXGeneral-Italic;\">Œµ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3465\"><span class=\"mrow\" id=\"MathJax-Span-3466\"><span class=\"mtext\" id=\"MathJax-Span-3467\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">high</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Œµ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>high</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-222\">\\varepsilon_{\\text{high}}</script> control the clipping range for importance weights, while <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-223-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3468\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3469\"><span class=\"mi\" id=\"MathJax-Span-3470\" style=\"font-family: STIXGeneral-Italic;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≤</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-223\">\\beta</script> regulates the KL-divergence penalty to stabilize training.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n</ul>\n<p>TIR-Judge employs an <strong>iterative RL pipeline</strong> combining <strong>pairwise</strong>, <strong>pointwise</strong>, and <strong>listwise</strong> judgments‚Äîspanning both verifiable (math, code) and non-verifiable (dialogue, safety) domains.</p>\n<p>Two variants are explored:</p>\n<ul>\n      <li><strong>TIR-Judge-Distill</strong>, which uses small distillation-based initialization.</li>\n      <li><strong>TIR-Judge-Zero</strong>, trained purely via RL without any distillation data.\nHere is your text with added citations:</li>\n    </ul>\n<p>TIR-Judge adopts Decoupled Clip and Dynamic Sampling Policy Optimization (<a href=\"https://arxiv.org/pdf/2503.14476v1\">DAPO</a>) (an improved variant of <a href=\"https://arxiv.org/abs/2402.03300\">GRPO</a>) for training the LLM judge <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-208-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>J</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3024\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3025\"><span class=\"mi\" id=\"MathJax-Span-3026\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>J</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-208\">J</script> parameterized by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-209-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3027\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3028\"><span class=\"msubsup\" id=\"MathJax-Span-3029\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3030\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3031\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-209\">\\pi_\\theta</script>. Given a prompt-answer pair <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-210-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3032\" style=\"width: 2.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.03em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3033\"><span class=\"mo\" id=\"MathJax-Span-3034\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3035\" style=\"font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-3036\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3037\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-3038\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>q</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-210\">(q, a)</script>, they first sample a group of <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-211-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3039\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3040\"><span class=\"mi\" id=\"MathJax-Span-3041\" style=\"font-family: STIXGeneral-Italic;\">G</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>G</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-211\">G</script> rollouts <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-212-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mi>i</mi></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3042\" style=\"width: 2.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1002.03em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3043\"><span class=\"msubsup\" id=\"MathJax-Span-3044\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3045\"><span class=\"mrow\" id=\"MathJax-Span-3046\"><span class=\"msubsup\" id=\"MathJax-Span-3047\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3048\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3049\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.372em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-3050\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.169em, -999.997em); top: -3.695em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3051\"><span class=\"mrow\" id=\"MathJax-Span-3052\"><span class=\"mi\" id=\"MathJax-Span-3053\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3054\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3055\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3056\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>s</mi><mi>i</mi></msub></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-212\">{s_i}_{i=1}^G)</script> from the current policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-213-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3057\" style=\"width: 2.346em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.88em, 2.607em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3058\"><span class=\"msubsup\" id=\"MathJax-Span-3059\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3060\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3061\"><span class=\"mrow\" id=\"MathJax-Span-3062\"><span class=\"msubsup\" id=\"MathJax-Span-3063\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3064\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3065\"><span class=\"mrow\" id=\"MathJax-Span-3066\"><span class=\"mtext\" id=\"MathJax-Span-3067\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3068\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-213\">\\pi_{\\theta_{\\text{old}}})</script>. Each rollout <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-214-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3069\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3070\"><span class=\"msubsup\" id=\"MathJax-Span-3071\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3072\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3073\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-214\">s_i</script> is assigned a scalar reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-215-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>i</mi></msub><mo>=</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3074\" style=\"width: 6.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.003em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.95em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3075\"><span class=\"msubsup\" id=\"MathJax-Span-3076\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3077\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3078\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3079\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3080\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">R</span><span class=\"mo\" id=\"MathJax-Span-3081\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3082\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3083\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3084\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3085\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3086\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-3087\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>R</mi><mi>i</mi></msub><mo>=</mo><mi>R</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-215\">R_i = R(s_i, a)</script> with access to the oracle answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-216-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3088\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3089\"><span class=\"mi\" id=\"MathJax-Span-3090\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-216\">a</script>. The policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-217-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3091\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3092\"><span class=\"msubsup\" id=\"MathJax-Span-3093\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3094\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3095\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-217\">\\pi_\\theta</script> is then updated with the following clipped policy gradient objective:</p>\n<ul>\n      <li>where:\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-219-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>&amp;#x2223;</mo><mi>q</mi><mo>,</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>d</mi></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>&amp;#x2223;</mo><mi>q</mi><mo>,</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3331\" style=\"width: 9.846em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.94em, 1008.18em, 3.023em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3332\"><span class=\"msubsup\" id=\"MathJax-Span-3333\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3334\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3335\"><span class=\"mrow\" id=\"MathJax-Span-3336\"><span class=\"mi\" id=\"MathJax-Span-3337\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3338\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3339\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3340\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3341\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3342\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3343\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-3344\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.482em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1003.65em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -1.82em;\"><span class=\"mrow\" id=\"MathJax-Span-3345\"><span class=\"msubsup\" id=\"MathJax-Span-3346\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3347\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3348\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3349\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3350\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3351\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3352\"><span class=\"mrow\" id=\"MathJax-Span-3353\"><span class=\"mi\" id=\"MathJax-Span-3354\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3355\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3356\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3357\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3358\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-3359\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3360\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3361\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3362\"><span class=\"mrow\" id=\"MathJax-Span-3363\"><span class=\"mi\" id=\"MathJax-Span-3364\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3365\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-3366\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-3367\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3368\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1004.33em, 4.43em, -999.997em); top: -3.591em; left: 50%; margin-left: -2.185em;\"><span class=\"mrow\" id=\"MathJax-Span-3369\"><span class=\"msubsup\" id=\"MathJax-Span-3370\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3371\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3372\"><span class=\"mrow\" id=\"MathJax-Span-3373\"><span class=\"msubsup\" id=\"MathJax-Span-3374\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3375\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3376\"><span class=\"mrow\" id=\"MathJax-Span-3377\"><span class=\"mi\" id=\"MathJax-Span-3378\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-3379\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-3380\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">d</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3381\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3382\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3383\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3384\"><span class=\"mrow\" id=\"MathJax-Span-3385\"><span class=\"mi\" id=\"MathJax-Span-3386\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3387\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3388\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3389\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3390\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-3391\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3392\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3393\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3394\"><span class=\"mrow\" id=\"MathJax-Span-3395\"><span class=\"mi\" id=\"MathJax-Span-3396\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3397\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-3398\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-3399\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3400\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.48em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.482em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>‚à£</mo><mi>q</mi><mo>,</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mo>&lt;</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">d</mi></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>‚à£</mo><mi>q</mi><mo>,</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mo>&lt;</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-219\">r_{i,t}(\\theta) = \\frac{\\pi_\\theta(s_{i,t}\\mid q, s_{i,<t})}{\\pi_{\\theta_{\\rm old}}(s_{i,t}\\mid q, s_{i,<t})}</script> is the token-level importance weight, and</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-220-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mi>mean</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>R</mi><mi>i</mi></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi>std</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>R</mi><mi>i</mi></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3401\" style=\"width: 9.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.836em, 1007.66em, 3.076em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3402\"><span class=\"msubsup\" id=\"MathJax-Span-3403\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.99em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3404\"><span class=\"mrow\" id=\"MathJax-Span-3405\"><span class=\"munderover\" id=\"MathJax-Span-3406\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0.211em;\"><span class=\"mi\" id=\"MathJax-Span-3407\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.076em, 1000.99em, 3.596em, -999.997em); top: -4.216em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3408\" style=\"\"><span style=\"font-family: STIXSizeTwoSym;\">ÀÜ</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.992em;\"><span class=\"texatom\" id=\"MathJax-Span-3409\"><span class=\"mrow\" id=\"MathJax-Span-3410\"><span class=\"mi\" id=\"MathJax-Span-3411\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3412\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3413\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3414\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-3415\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.638em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.232em, 1004.48em, 4.378em, -999.997em); top: -4.633em; left: 50%; margin-left: -2.237em;\"><span class=\"mrow\" id=\"MathJax-Span-3416\"><span class=\"msubsup\" id=\"MathJax-Span-3417\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3418\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-3419\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3420\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-3421\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">mean</span><span class=\"mo\" id=\"MathJax-Span-3422\" style=\"font-size: 70.7%;\"></span><span class=\"mo\" id=\"MathJax-Span-3423\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3424\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.63em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3425\"><span class=\"mrow\" id=\"MathJax-Span-3426\"><span class=\"msubsup\" id=\"MathJax-Span-3427\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3428\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-3429\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.42em, 4.169em, -999.997em); top: -4.268em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3430\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.78em, 4.169em, -999.997em); top: -3.799em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3431\"><span class=\"mrow\" id=\"MathJax-Span-3432\"><span class=\"mi\" id=\"MathJax-Span-3433\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3434\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3435\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3436\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.232em, 1002.66em, 4.378em, -999.997em); top: -3.487em; left: 50%; margin-left: -1.352em;\"><span class=\"mrow\" id=\"MathJax-Span-3437\"><span class=\"mi\" id=\"MathJax-Span-3438\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">std</span><span class=\"mo\" id=\"MathJax-Span-3439\" style=\"font-size: 70.7%;\"></span><span class=\"mo\" id=\"MathJax-Span-3440\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3441\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.63em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3442\"><span class=\"mrow\" id=\"MathJax-Span-3443\"><span class=\"msubsup\" id=\"MathJax-Span-3444\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3445\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-3446\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.42em, 4.169em, -999.997em); top: -4.268em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3447\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.78em, 4.169em, -999.997em); top: -3.799em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3448\"><span class=\"mrow\" id=\"MathJax-Span-3449\"><span class=\"mi\" id=\"MathJax-Span-3450\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3451\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3452\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3453\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.64em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.638em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.934em; border-left: 0px solid; width: 0px; height: 2.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo>^</mo></mover></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mi>i</mi></msub><mo>‚àí</mo><mi>mean</mi><mo>‚Å°</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>R</mi><mi>i</mi></msub></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=\"false\">)</mo></mrow><mrow><mi>std</mi><mo>‚Å°</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>R</mi><mi>i</mi></msub></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-220\">\\widehat A_{i,t} = \\frac{R_i - \\operatorname{mean}({R_i}_{i=1}^G)}{\\operatorname{std}({R_i}_{i=1}^G)}</script> is the token-level advantage</li>\n          <li>The hyperparameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-221-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B5;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>low</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3454\" style=\"width: 1.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.57em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3455\"><span class=\"msubsup\" id=\"MathJax-Span-3456\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3457\" style=\"font-family: STIXGeneral-Italic;\">Œµ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3458\"><span class=\"mrow\" id=\"MathJax-Span-3459\"><span class=\"mtext\" id=\"MathJax-Span-3460\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">low</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Œµ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>low</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-221\">\\varepsilon_{\\text {low}}</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-222-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B5;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>high</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3461\" style=\"width: 2.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.77em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3462\"><span class=\"msubsup\" id=\"MathJax-Span-3463\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3464\" style=\"font-family: STIXGeneral-Italic;\">Œµ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3465\"><span class=\"mrow\" id=\"MathJax-Span-3466\"><span class=\"mtext\" id=\"MathJax-Span-3467\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">high</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Œµ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>high</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-222\">\\varepsilon_{\\text{high}}</script> control the clipping range for importance weights, while <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-223-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3468\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3469\"><span class=\"mi\" id=\"MathJax-Span-3470\" style=\"font-family: STIXGeneral-Italic;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≤</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-223\">\\beta</script> regulates the KL-divergence penalty to stabilize training.</li>\n        </ul>\n      </li>\n    </ul>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-219-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>&amp;#x2223;</mo><mi>q</mi><mo>,</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>d</mi></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>&amp;#x2223;</mo><mi>q</mi><mo>,</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3331\" style=\"width: 9.846em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.94em, 1008.18em, 3.023em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3332\"><span class=\"msubsup\" id=\"MathJax-Span-3333\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3334\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3335\"><span class=\"mrow\" id=\"MathJax-Span-3336\"><span class=\"mi\" id=\"MathJax-Span-3337\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3338\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3339\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3340\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3341\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3342\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3343\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-3344\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.482em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1003.65em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -1.82em;\"><span class=\"mrow\" id=\"MathJax-Span-3345\"><span class=\"msubsup\" id=\"MathJax-Span-3346\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3347\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3348\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3349\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3350\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3351\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3352\"><span class=\"mrow\" id=\"MathJax-Span-3353\"><span class=\"mi\" id=\"MathJax-Span-3354\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3355\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3356\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3357\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3358\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-3359\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3360\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3361\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3362\"><span class=\"mrow\" id=\"MathJax-Span-3363\"><span class=\"mi\" id=\"MathJax-Span-3364\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3365\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-3366\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-3367\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3368\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1004.33em, 4.43em, -999.997em); top: -3.591em; left: 50%; margin-left: -2.185em;\"><span class=\"mrow\" id=\"MathJax-Span-3369\"><span class=\"msubsup\" id=\"MathJax-Span-3370\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3371\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3372\"><span class=\"mrow\" id=\"MathJax-Span-3373\"><span class=\"msubsup\" id=\"MathJax-Span-3374\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3375\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3376\"><span class=\"mrow\" id=\"MathJax-Span-3377\"><span class=\"mi\" id=\"MathJax-Span-3378\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-3379\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-3380\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">d</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3381\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3382\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3383\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3384\"><span class=\"mrow\" id=\"MathJax-Span-3385\"><span class=\"mi\" id=\"MathJax-Span-3386\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3387\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3388\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3389\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3390\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">q</span><span class=\"mo\" id=\"MathJax-Span-3391\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3392\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3393\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3394\"><span class=\"mrow\" id=\"MathJax-Span-3395\"><span class=\"mi\" id=\"MathJax-Span-3396\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3397\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-3398\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-3399\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3400\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.48em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.482em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>‚à£</mo><mi>q</mi><mo>,</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mo>&lt;</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">d</mi></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>‚à£</mo><mi>q</mi><mo>,</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mo>&lt;</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-219\">r_{i,t}(\\theta) = \\frac{\\pi_\\theta(s_{i,t}\\mid q, s_{i,<t})}{\\pi_{\\theta_{\\rm old}}(s_{i,t}\\mid q, s_{i,<t})}</script> is the token-level importance weight, and</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-220-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mi>mean</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>R</mi><mi>i</mi></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi>std</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>R</mi><mi>i</mi></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3401\" style=\"width: 9.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.836em, 1007.66em, 3.076em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3402\"><span class=\"msubsup\" id=\"MathJax-Span-3403\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.99em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3404\"><span class=\"mrow\" id=\"MathJax-Span-3405\"><span class=\"munderover\" id=\"MathJax-Span-3406\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0.211em;\"><span class=\"mi\" id=\"MathJax-Span-3407\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.076em, 1000.99em, 3.596em, -999.997em); top: -4.216em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3408\" style=\"\"><span style=\"font-family: STIXSizeTwoSym;\">ÀÜ</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.992em;\"><span class=\"texatom\" id=\"MathJax-Span-3409\"><span class=\"mrow\" id=\"MathJax-Span-3410\"><span class=\"mi\" id=\"MathJax-Span-3411\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3412\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3413\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3414\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-3415\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.638em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.232em, 1004.48em, 4.378em, -999.997em); top: -4.633em; left: 50%; margin-left: -2.237em;\"><span class=\"mrow\" id=\"MathJax-Span-3416\"><span class=\"msubsup\" id=\"MathJax-Span-3417\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3418\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-3419\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3420\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-3421\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">mean</span><span class=\"mo\" id=\"MathJax-Span-3422\" style=\"font-size: 70.7%;\"></span><span class=\"mo\" id=\"MathJax-Span-3423\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3424\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.63em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3425\"><span class=\"mrow\" id=\"MathJax-Span-3426\"><span class=\"msubsup\" id=\"MathJax-Span-3427\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3428\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-3429\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.42em, 4.169em, -999.997em); top: -4.268em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3430\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.78em, 4.169em, -999.997em); top: -3.799em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3431\"><span class=\"mrow\" id=\"MathJax-Span-3432\"><span class=\"mi\" id=\"MathJax-Span-3433\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3434\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3435\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3436\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.232em, 1002.66em, 4.378em, -999.997em); top: -3.487em; left: 50%; margin-left: -1.352em;\"><span class=\"mrow\" id=\"MathJax-Span-3437\"><span class=\"mi\" id=\"MathJax-Span-3438\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">std</span><span class=\"mo\" id=\"MathJax-Span-3439\" style=\"font-size: 70.7%;\"></span><span class=\"mo\" id=\"MathJax-Span-3440\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3441\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.63em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3442\"><span class=\"mrow\" id=\"MathJax-Span-3443\"><span class=\"msubsup\" id=\"MathJax-Span-3444\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3445\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-3446\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.42em, 4.169em, -999.997em); top: -4.268em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3447\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.78em, 4.169em, -999.997em); top: -3.799em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3448\"><span class=\"mrow\" id=\"MathJax-Span-3449\"><span class=\"mi\" id=\"MathJax-Span-3450\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3451\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3452\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3453\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.64em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.638em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.934em; border-left: 0px solid; width: 0px; height: 2.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo>^</mo></mover></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mi>i</mi></msub><mo>‚àí</mo><mi>mean</mi><mo>‚Å°</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>R</mi><mi>i</mi></msub></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=\"false\">)</mo></mrow><mrow><mi>std</mi><mo>‚Å°</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>R</mi><mi>i</mi></msub></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-220\">\\widehat A_{i,t} = \\frac{R_i - \\operatorname{mean}({R_i}_{i=1}^G)}{\\operatorname{std}({R_i}_{i=1}^G)}</script> is the token-level advantage</li>\n          <li>The hyperparameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-221-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B5;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>low</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3454\" style=\"width: 1.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.57em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3455\"><span class=\"msubsup\" id=\"MathJax-Span-3456\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3457\" style=\"font-family: STIXGeneral-Italic;\">Œµ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3458\"><span class=\"mrow\" id=\"MathJax-Span-3459\"><span class=\"mtext\" id=\"MathJax-Span-3460\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">low</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Œµ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>low</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-221\">\\varepsilon_{\\text {low}}</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-222-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B5;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>high</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3461\" style=\"width: 2.138em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.77em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3462\"><span class=\"msubsup\" id=\"MathJax-Span-3463\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3464\" style=\"font-family: STIXGeneral-Italic;\">Œµ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3465\"><span class=\"mrow\" id=\"MathJax-Span-3466\"><span class=\"mtext\" id=\"MathJax-Span-3467\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">high</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Œµ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>high</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-222\">\\varepsilon_{\\text{high}}</script> control the clipping range for importance weights, while <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-223-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3468\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3469\"><span class=\"mi\" id=\"MathJax-Span-3470\" style=\"font-family: STIXGeneral-Italic;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≤</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-223\">\\beta</script> regulates the KL-divergence penalty to stabilize training.</li>\n        </ul>\n<h5 id=\"results-2\">Results</h5>\n<ul>\n  <li>On seven public benchmarks, TIR-Judge surpasses reasoning-only judges by <strong>6.4% (pointwise)</strong> and <strong>7.7% (pairwise)</strong>, and achieves <strong>96% of Claude-Opus-4‚Äôs performance</strong> with only <strong>8B parameters</strong>.</li>\n  <li>The following figure (<a href=\"https://arxiv.org/abs/2510.23038\">source</a>) shows the TIR-Judge RL framework and training variants (TIR-Judge-Zero and Distill).</li>\n</ul>\n<p><img src=\"/primers/ai/assets/RL-for-agents/TIR-Judge.jpg\" alt=\"\"></p>\n<h5 id=\"key-insight\">Key Insight</h5>\n<ul>\n  <li>TIR-Judge demonstrates that reinforcement learning can endow LLM judges with <strong>agentic verification</strong> abilities‚Äîevaluating not only by textual reasoning but by executing verifiable logic to test correctness.</li>\n  <li>This closes the feedback loop in RLHF pipelines, enabling both <strong>reasoners and evaluators</strong> to become <em>tool-augmented and self-improving</em>.</li>\n</ul>\n<h4 id=\"comparative-analysis\">Comparative Analysis</h4>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Framework</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Focus</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Training Style</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Emergent Behavior</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key Results</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">ToRL</td>\n<td class=\"tg-tleft-valign-first\">Tool integration during RL</td>\n<td class=\"tg-tleft-valign-first\">GRPO</td>\n<td class=\"tg-tleft-valign-first\">Self-regulated code use, reflection</td>\n<td class=\"tg-tleft-valign-second\">+14% on AIME24</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">ReTool</td>\n<td class=\"tg-tleft-valign-first\">Strategic tool-use via interleaved code</td>\n<td class=\"tg-tleft-valign-first\">PPO with outcome reward</td>\n<td class=\"tg-tleft-valign-first\">Code self-correction, adaptive timing</td>\n<td class=\"tg-tleft-valign-second\">+27.9% vs o1-preview</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">TIR-Judge</td>\n<td class=\"tg-tleft-valign-first\">Tool-augmented evaluation</td>\n<td class=\"tg-tleft-valign-first\">DAPO (an improved variant of GRPO)</td>\n<td class=\"tg-tleft-valign-first\">Agentic verification, multi-domain generalization</td>\n<td class=\"tg-tleft-valign-second\">6.4‚Äì7.7% gains over text-only judges</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Framework</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Focus</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Training Style</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Emergent Behavior</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key Results</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">ToRL</td>\n<td class=\"tg-tleft-valign-first\">Tool integration during RL</td>\n<td class=\"tg-tleft-valign-first\">GRPO</td>\n<td class=\"tg-tleft-valign-first\">Self-regulated code use, reflection</td>\n<td class=\"tg-tleft-valign-second\">+14% on AIME24</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">ReTool</td>\n<td class=\"tg-tleft-valign-first\">Strategic tool-use via interleaved code</td>\n<td class=\"tg-tleft-valign-first\">PPO with outcome reward</td>\n<td class=\"tg-tleft-valign-first\">Code self-correction, adaptive timing</td>\n<td class=\"tg-tleft-valign-second\">+27.9% vs o1-preview</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">TIR-Judge</td>\n<td class=\"tg-tleft-valign-first\">Tool-augmented evaluation</td>\n<td class=\"tg-tleft-valign-first\">DAPO (an improved variant of GRPO)</td>\n<td class=\"tg-tleft-valign-first\">Agentic verification, multi-domain generalization</td>\n<td class=\"tg-tleft-valign-second\">6.4‚Äì7.7% gains over text-only judges</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"theoretical-framing-5\">Theoretical Framing</h4>\n<ul>\n  <li>\n    <p>All three frameworks share a <strong>reinforcement-based objective</strong> augmented with tool-conditioned state transitions:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-224-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munderover><mo>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></munderover><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo>,</mo><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo>,</mo><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3471\" style=\"width: 22.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 18.388em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.576em, 1018.34em, 3.909em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3472\"><span class=\"msubsup\" id=\"MathJax-Span-3473\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3474\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3475\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3476\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3477\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3478\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3479\"><span class=\"mrow\" id=\"MathJax-Span-3480\"><span class=\"mn\" id=\"MathJax-Span-3481\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-3482\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-3483\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3484\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3485\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3486\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3487\"><span class=\"mrow\" id=\"MathJax-Span-3488\"><span class=\"mn\" id=\"MathJax-Span-3489\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-3490\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-3491\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3492\"><span class=\"mrow\" id=\"MathJax-Span-3493\"><span class=\"mo\" id=\"MathJax-Span-3494\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-3495\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3496\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3497\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-3498\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.3em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3499\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àè</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.99em, 4.273em, -999.997em); top: -2.862em; left: 0.159em;\"><span class=\"texatom\" id=\"MathJax-Span-3500\"><span class=\"mrow\" id=\"MathJax-Span-3501\"><span class=\"mi\" id=\"MathJax-Span-3502\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3503\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3504\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3505\"><span class=\"mrow\" id=\"MathJax-Span-3506\"><span class=\"mi\" id=\"MathJax-Span-3507\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3508\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3509\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3510\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3511\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3512\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3513\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3514\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3515\"><span class=\"mrow\" id=\"MathJax-Span-3516\"><span class=\"mo\" id=\"MathJax-Span-3517\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-3518\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3519\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3520\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3521\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3522\"><span class=\"mrow\" id=\"MathJax-Span-3523\"><span class=\"mo\" id=\"MathJax-Span-3524\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-3525\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3526\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3527\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3528\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3529\"><span class=\"mrow\" id=\"MathJax-Span-3530\"><span class=\"mo\" id=\"MathJax-Span-3531\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-3532\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3533\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mi\" id=\"MathJax-Span-3534\" style=\"font-family: STIXGeneral-Italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-3535\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3536\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3537\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3538\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3539\"><span class=\"mrow\" id=\"MathJax-Span-3540\"><span class=\"mo\" id=\"MathJax-Span-3541\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3542\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3543\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3544\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3545\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>c</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munderover><mo>‚àè</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi></mrow></munderover><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo>,</mo><msub><mi>c</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>&lt;</mo><mi>t</mi></mrow></msub><mo>,</mo><msub><mi>o</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>&lt;</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mi>p</mi><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-224\">p_\\theta(c_{1:T}, o_{1:T} | x) = \\prod_{t=1}^{T} p_\\theta(a_t | x, c_{<t}, o_{<t}) p(o_t | a_t)</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-225-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3546\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3547\"><span class=\"msubsup\" id=\"MathJax-Span-3548\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3549\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3550\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-225\">a_t</script> represents either reasoning or tool action and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-226-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3551\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3552\"><span class=\"msubsup\" id=\"MathJax-Span-3553\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3554\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3555\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-226\">o_t</script> its observation.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This formalism generalizes the Themis-style hybrid objective by integrating <em>action-conditioned reasoning trajectories</em> into the reward model.</p>\n  </li>\n</ul>\n<p>All three frameworks share a <strong>reinforcement-based objective</strong> augmented with tool-conditioned state transitions:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-225-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3546\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3547\"><span class=\"msubsup\" id=\"MathJax-Span-3548\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3549\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3550\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-225\">a_t</script> represents either reasoning or tool action and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-226-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3551\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3552\"><span class=\"msubsup\" id=\"MathJax-Span-3553\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3554\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3555\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-226\">o_t</script> its observation.</li>\n    </ul>\n<p>This formalism generalizes the Themis-style hybrid objective by integrating <em>action-conditioned reasoning trajectories</em> into the reward model.</p>\n<h4 id=\"conceptual-implication\">Conceptual Implication</h4>\n<ul>\n  <li>The synthesis of ToRL, ReTool, and TIR-Judge underscores the transition from <strong>reactive reasoning</strong> to <strong>agentic reasoning</strong>‚Äîwhere LLMs not only <em>reason about outputs</em> but <em>interact with tools</em> to verify and improve them.</li>\n  <li>These approaches redefine RLHF as <strong>Tool-Integrated Reinforcement Learning for Reasoning and Evaluation (TIRL¬≤E)</strong>‚Äîa unified path toward verifiable, self-correcting AI systems.</li>\n</ul>",
    "contentMarkdown": "*   **Tool-Integrated Reasoning (TIR)** marks a paradigm shift in how LLMs perform complex reasoning tasks. Instead of relying solely on text-based inference, TIR enables models to **invoke external tools**‚Äîsuch as code interpreters, APIs, databases, or symbolic solvers‚Äîwithin their reasoning trajectories.\n    *   Through this mechanism, models alternate between _linguistic reasoning_ and _computational execution_, forming a hybrid cognitive process that grounds natural language thought in verifiable computation. Formally, a TIR process can be expressed as:\n        \n        st\\=r1,c1,o1,‚Ä¶,rt,ct,ot,st\\=r1,c1,o1,‚Ä¶,rt,ct,ot,\n        \n        s\\_t = {r\\_1, c\\_1, o\\_1, \\\\ldots, r\\_t, c\\_t, o\\_t},\n        *   where rtrtr\\_t is a reasoning step, ctctc\\_t a tool command, and ot\\=I(ct)ot\\=I(ct)o\\_t = I(c\\_t) the corresponding output from an interpreter III.\n    *   This framework establishes a **closed loop** of _reason ‚Üí act ‚Üí verify_, significantly reducing hallucination and enabling models to achieve _self-correction_ through external validation.\n        \n*   **Tool-Integrated Reinforcement Learning (TIRL)** extends this paradigm by introducing **reinforcement learning (RL)** into the TIR loop. In TIRL, models are not merely taught to use tools‚Äîthey **learn** when and how to use them optimally through trial, feedback, and reward.\n    *   The integration of RL allows the model to optimize over both symbolic actions (tool invocations) and linguistic reasoning steps, guided by reward functions that capture correctness, efficiency, and interpretability:\n        \n        J(Œ∏)\\=ùîºœÄŒ∏\\[‚àët\\=0TŒ≥tr(st,at,ot)\\]J(Œ∏)\\=EœÄŒ∏\\[‚àët\\=0TŒ≥tr(st,at,ot)\\]\n        \n        J(\\\\theta) = \\\\mathbb{E}\\_{\\\\pi\\_\\\\theta} \\\\left\\[\\\\sum\\_{t=0}^{T} \\\\gamma^t r(s\\_t, a\\_t, o\\_t)\\\\right\\]\n        *   where the policy œÄŒ∏(at‚à£st)œÄŒ∏(at‚à£st)\\\\pi\\_\\\\theta(a\\_t \\\\mid s\\_t) produces both reasoning and tool actions.\n    *   This combination yields models capable of _adaptive computation_‚Äîdeciding dynamically whether to reason internally or delegate computation externally for optimal task success.\n        \n*   This section surveys three recent and complementary frameworks that embody the TIRL paradigm:\n    \n    *   **[ToRL](https://arxiv.org/abs/2503.23383)** by Li et al. (2025): introduces _Tool-Oriented Reinforcement Learning_ for code-augmented mathematical reasoning, coupling RL with symbolic execution for error correction and precision.\n    *   **[ReTool](https://arxiv.org/abs/2504.11536)** by Feng et al. (2025): establishes a two-phase RL pipeline where LLMs interleave reasoning with real-time code execution, optimizing outcome-based rewards for verifiable solutions.\n    *   **[TIR-Judge](https://arxiv.org/abs/2510.23038)** by Xu et al. (2025): extends the TIRL concept to _evaluation agents_, training LLM-based judges that reason, execute verification code, and learn reward functions for truthful, consistent assessment.\n*   Together, TIR and TIRL form the backbone of next-generation **agentic intelligence**‚Äîwhere reasoning is no longer passive text generation, but an _interactive, executable, and self-optimizing process_ grounded in real-world feedback.\n\n*   Through this mechanism, models alternate between _linguistic reasoning_ and _computational execution_, forming a hybrid cognitive process that grounds natural language thought in verifiable computation. Formally, a TIR process can be expressed as:\n    \n    st\\=r1,c1,o1,‚Ä¶,rt,ct,ot,st\\=r1,c1,o1,‚Ä¶,rt,ct,ot,\n    \n    s\\_t = {r\\_1, c\\_1, o\\_1, \\\\ldots, r\\_t, c\\_t, o\\_t},\n    *   where rtrtr\\_t is a reasoning step, ctctc\\_t a tool command, and ot\\=I(ct)ot\\=I(ct)o\\_t = I(c\\_t) the corresponding output from an interpreter III.\n*   This framework establishes a **closed loop** of _reason ‚Üí act ‚Üí verify_, significantly reducing hallucination and enabling models to achieve _self-correction_ through external validation.\n    \n\nThrough this mechanism, models alternate between _linguistic reasoning_ and _computational execution_, forming a hybrid cognitive process that grounds natural language thought in verifiable computation. Formally, a TIR process can be expressed as:\n\n*   where rtrtr\\_t is a reasoning step, ctctc\\_t a tool command, and ot\\=I(ct)ot\\=I(ct)o\\_t = I(c\\_t) the corresponding output from an interpreter III.\n\nThis framework establishes a **closed loop** of _reason ‚Üí act ‚Üí verify_, significantly reducing hallucination and enabling models to achieve _self-correction_ through external validation.\n\n*   The integration of RL allows the model to optimize over both symbolic actions (tool invocations) and linguistic reasoning steps, guided by reward functions that capture correctness, efficiency, and interpretability:\n    \n    J(Œ∏)\\=ùîºœÄŒ∏\\[‚àët\\=0TŒ≥tr(st,at,ot)\\]J(Œ∏)\\=EœÄŒ∏\\[‚àët\\=0TŒ≥tr(st,at,ot)\\]\n    \n    J(\\\\theta) = \\\\mathbb{E}\\_{\\\\pi\\_\\\\theta} \\\\left\\[\\\\sum\\_{t=0}^{T} \\\\gamma^t r(s\\_t, a\\_t, o\\_t)\\\\right\\]\n    *   where the policy œÄŒ∏(at‚à£st)œÄŒ∏(at‚à£st)\\\\pi\\_\\\\theta(a\\_t \\\\mid s\\_t) produces both reasoning and tool actions.\n*   This combination yields models capable of _adaptive computation_‚Äîdeciding dynamically whether to reason internally or delegate computation externally for optimal task success.\n    \n\nThe integration of RL allows the model to optimize over both symbolic actions (tool invocations) and linguistic reasoning steps, guided by reward functions that capture correctness, efficiency, and interpretability:\n\n*   where the policy œÄŒ∏(at‚à£st)œÄŒ∏(at‚à£st)\\\\pi\\_\\\\theta(a\\_t \\\\mid s\\_t) produces both reasoning and tool actions.\n\nThis combination yields models capable of _adaptive computation_‚Äîdeciding dynamically whether to reason internally or delegate computation externally for optimal task success.\n\nThis section surveys three recent and complementary frameworks that embody the TIRL paradigm:\n\n*   **[ToRL](https://arxiv.org/abs/2503.23383)** by Li et al. (2025): introduces _Tool-Oriented Reinforcement Learning_ for code-augmented mathematical reasoning, coupling RL with symbolic execution for error correction and precision.\n*   **[ReTool](https://arxiv.org/abs/2504.11536)** by Feng et al. (2025): establishes a two-phase RL pipeline where LLMs interleave reasoning with real-time code execution, optimizing outcome-based rewards for verifiable solutions.\n*   **[TIR-Judge](https://arxiv.org/abs/2510.23038)** by Xu et al. (2025): extends the TIRL concept to _evaluation agents_, training LLM-based judges that reason, execute verification code, and learn reward functions for truthful, consistent assessment.\n\n#### Tool-Integrated Reinforcement Learning (ToRL)\n\n*   The [Tool-Integrated Reinforcement Learning (ToRL)](https://arxiv.org/abs/2503.23383) framework by Li et al. (2025) directly scales reinforcement learning from base models‚Äîwithout supervised fine-tuning‚Äîto autonomously acquire computational tool usage.\n    \n*   Unlike earlier Tool-Integrated Reasoning (TIR) approaches such as [MathCoder](https://arxiv.org/abs/2310.03731) by Wang et al. (2023) or [ToRA](https://arxiv.org/abs/2309.17452) by Gou et al. (2023), ToRL does not rely on distilled tool trajectories. Instead, the model learns tool strategies through reward-driven exploration from scratch.\n    \n\nThe [Tool-Integrated Reinforcement Learning (ToRL)](https://arxiv.org/abs/2503.23383) framework by Li et al. (2025) directly scales reinforcement learning from base models‚Äîwithout supervised fine-tuning‚Äîto autonomously acquire computational tool usage.\n\nUnlike earlier Tool-Integrated Reasoning (TIR) approaches such as [MathCoder](https://arxiv.org/abs/2310.03731) by Wang et al. (2023) or [ToRA](https://arxiv.org/abs/2309.17452) by Gou et al. (2023), ToRL does not rely on distilled tool trajectories. Instead, the model learns tool strategies through reward-driven exploration from scratch.\n\n##### Core Idea\n\n*   ToRL enables unrestricted RL exploration with embedded interpreters (e.g., Python) for solving mathematical reasoning problems. Through repeated interaction between analytical reasoning and code execution, the model learns to balance symbolic reasoning with computational accuracy.\n    \n*   ToRL employs [GRPO](https://arxiv.org/abs/2402.03300), setting the rollout batch size to 128 and generating 16 samples per problem.\n    \n*   In ToRL, this formulation allows the model to optimize _end-to-end tool-use behavior_ purely through reinforcement signals, without explicit imitation of tool trajectories. It further supports **exploration-driven learning**, where even incorrect executions can contribute useful gradient signals toward improving reasoning-tool coordination.\n    \n*   The following figure ([source](https://arxiv.org/abs/2503.23383)) shows an example of CoT and TIR solution of the problem. TIR enables the model to write code and call an interpreter to obtain the output of the executed code, and then perform further reasoning based on the execution results.\n    \n\nToRL enables unrestricted RL exploration with embedded interpreters (e.g., Python) for solving mathematical reasoning problems. Through repeated interaction between analytical reasoning and code execution, the model learns to balance symbolic reasoning with computational accuracy.\n\nToRL employs [GRPO](https://arxiv.org/abs/2402.03300), setting the rollout batch size to 128 and generating 16 samples per problem.\n\nIn ToRL, this formulation allows the model to optimize _end-to-end tool-use behavior_ purely through reinforcement signals, without explicit imitation of tool trajectories. It further supports **exploration-driven learning**, where even incorrect executions can contribute useful gradient signals toward improving reasoning-tool coordination.\n\nThe following figure ([source](https://arxiv.org/abs/2503.23383)) shows an example of CoT and TIR solution of the problem. TIR enables the model to write code and call an interpreter to obtain the output of the executed code, and then perform further reasoning based on the execution results.\n\n![](/primers/ai/assets/RL-for-agents/ToRL.jpg)\n\n##### Dataset and Training Pipeline\n\n*   ToRL constructs a 28k-instance dataset from **MATH**, **NuminaMATH**, and **DeepScaleR**, filtering for verifiable numerical tasks and excluding open-ended proofs.\n*   Training is performed directly on **Qwen2.5-Math base models (1.5B, 7B)**, without prior fine-tuning. The RL loop enables exploration of tool-use trajectories, guided solely by outcome-based rewards.\n\n##### Emergent Behaviors\n\n*   ToRL demonstrates several _self-organizing cognitive behaviors_:\n    \n    *   **Code usage evolution:** the share of tasks solved via code rises as RL progresses.\n    *   **Self-regulation:** the model autonomously detects and avoids ineffective code patterns.\n    *   **Analytical‚Äìcomputational adaptation:** dynamically alternates between symbolic reasoning and code execution.\n*   These capabilities emerge without explicit demonstrations‚Äîdriven purely by reward feedback.\n    \n\nToRL demonstrates several _self-organizing cognitive behaviors_:\n\n*   **Code usage evolution:** the share of tasks solved via code rises as RL progresses.\n*   **Self-regulation:** the model autonomously detects and avoids ineffective code patterns.\n*   **Analytical‚Äìcomputational adaptation:** dynamically alternates between symbolic reasoning and code execution.\n\nThese capabilities emerge without explicit demonstrations‚Äîdriven purely by reward feedback.\n\n##### Results\n\n*   ToRL-7B achieves **43.3%** accuracy on AIME24‚Äîsurpassing RL baselines by **14%** and SFT-based tool models by **17%**.\n\n##### Significance\n\n*   ToRL pioneers **tool integration in large-scale RL from scratch**, showing that emergent metacognitive capabilities (reflection, verification) can arise naturally from outcome-based training, bridging analytical and computational reasoning.\n\n#### Reinforcement Learning for Strategic Tool Use (ReTool)\n\n*   [ReTool](https://arxiv.org/abs/2504.11536) by Feng et al. (2025) extends the RL paradigm by _explicitly embedding tool execution into the rollout process_. It introduces an **interleaved reasoning and code execution framework** for dynamic tool invocation and reflection.\n\n##### Overview\n\n*   ReTool is designed around two phases:\n    \n    1.  **Cold-start Supervised Fine-Tuning (SFT)**: constructing synthetic ‚Äúcode-augmented reasoning‚Äù traces using dual-verification pipelines.\n    2.  **Reinforcement Learning (RL)**: refining the model‚Äôs policy to discover optimal tool-use strategies through **outcome-based reward optimization**.\n\nReTool is designed around two phases:\n\n1.  **Cold-start Supervised Fine-Tuning (SFT)**: constructing synthetic ‚Äúcode-augmented reasoning‚Äù traces using dual-verification pipelines.\n2.  **Reinforcement Learning (RL)**: refining the model‚Äôs policy to discover optimal tool-use strategies through **outcome-based reward optimization**.\n\n##### Methodology\n\n*   ReTool‚Äôs training integrates real-time **code interpreter feedback** within the PPO objective:\n    \n    JPPO(Œ∏)\\=ùîº(q,a)‚àºD\\[min(œÄŒ∏(ot|q,o<t;CI)œÄŒ∏old(ot|q,o<t;CI)AÃÇ¬†t,clip(œÄŒ∏œÄŒ∏old,1‚àíœµ,1+œµ)AÃÇ¬†t)\\]JPPO(Œ∏)\\=E(q,a)‚àºD\\[min(œÄŒ∏(ot|q,o<t;CI)œÄŒ∏old(ot|q,o<t;CI)A^t,clip(œÄŒ∏œÄŒ∏old,1‚àíœµ,1+œµ)A^t)\\]\n    \n    J\\_{PPO}(\\\\theta) = \\\\mathbb{E}\\_{(q,a) \\\\sim D} \\\\left\\[ \\\\min \\\\left( \\\\frac{\\\\pi\\_\\\\theta(o\\_t | q, o\\_{<t}; CI)}{\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}(o\\_t | q, o\\_{<t}; CI)} \\\\hat{A}\\_t, \\\\text{clip}\\\\left(\\\\frac{\\\\pi\\_\\\\theta}{\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}}, 1-\\\\epsilon, 1+\\\\epsilon\\\\right)\\\\hat{A}\\_t \\\\right) \\\\right\\]\n    *   where:\n        \n        *   œÄŒ∏(ot‚à£q,o<t;CI)œÄŒ∏(ot‚à£q,o<t;CI)\\\\pi\\_\\\\theta(o\\_t \\\\mid q, o\\_{<t}; CI) denotes the **policy model** conditioned on the **code interpreter (CI) state**, which dynamically integrates executable code feedback during reasoning rollouts.\n        *   œÄŒ∏oldœÄŒ∏old\\\\pi\\_{\\\\theta\\_{\\\\text{old}}} is the **reference (behavior) policy** from the previous iteration, used for importance sampling to stabilize learning.\n        *   AÃÇ¬†tA^t\\\\hat{A}\\_t is the **advantage estimate**, representing how much better an action performed compared to the baseline at time step ttt.\n        *   œµœµ\\\\epsilon is a **clipping parameter** that limits policy updates to prevent destructive policy shifts (as introduced in [Proximal Policy Optimization](https://arxiv.org/abs/1707.06347) by Schulman et al. (2017)).\n        *   The **min** operator enforces conservative updates by taking the smaller of the unclipped and clipped surrogate objectives.\n        *   The expectation ùîº(q,a)‚àºDE(q,a)‚àºD\\\\mathbb{E}\\_{(q,a) \\\\sim D} is taken over sampled question‚Äìanswer pairs from the training dataset DDD, reflecting the model‚Äôs distribution of reasoning trajectories.\n        *   The conditioning on _CI_ allows **real-time interpreter feedback** to influence token-level decision probabilities, enabling the model to learn _when_ and _how_ to invoke code execution within multi-turn reasoning rollouts.\n*   The **reward function** is outcome-driven. It helps the model autonomously learn _when_ and _how_ to invoke tools through outcome-based reinforcement without human priors. It is expressed as:\n    \n    R(a,aÃÇ¬†)\\={1‚àí1if¬†a\\=aÃÇ¬†,otherwiseR(a,a^)\\={1if¬†a\\=a^,‚àí1otherwise\n    \n    R(a, \\\\hat{a}) = \\\\begin{cases} 1 & \\\\text{if } a = \\\\hat{a}, \\\\\\\\ -1 & \\\\text{otherwise} \\\\end{cases}\n    *   **Where:**\n        \n        *   aaa denotes the **predicted answer** produced by the policy model.\n        *   aÃÇ¬†a^\\\\hat{a} represents the **ground-truth or reference answer** derived from the supervised dataset or external evaluation function.\n        *   A reward of **1** indicates that the model‚Äôs predicted outcome matches the correct solution, signifying successful reasoning or problem-solving.\n        *   A reward of **\\-1** penalizes incorrect outcomes, incentivizing the model to refine tool invocation and reasoning strategies during training.\n        *   This rule-based accuracy reward is used in [ReTool: Reinforcement Learning for Strategic Tool Use in LLMs](https://arxiv.org/abs/2504.11536) by Feng et al. (2025)\n    *   This design minimizes reward hacking and fosters exploration diversity.\n        \n*   The following figure ([source](https://arxiv.org/abs/2504.11536)) shows text-based RL training process and ReTool‚Äôs RL training process.\n    \n\nReTool‚Äôs training integrates real-time **code interpreter feedback** within the PPO objective:\n\n*   where:\n    \n    *   œÄŒ∏(ot‚à£q,o<t;CI)œÄŒ∏(ot‚à£q,o<t;CI)\\\\pi\\_\\\\theta(o\\_t \\\\mid q, o\\_{<t}; CI) denotes the **policy model** conditioned on the **code interpreter (CI) state**, which dynamically integrates executable code feedback during reasoning rollouts.\n    *   œÄŒ∏oldœÄŒ∏old\\\\pi\\_{\\\\theta\\_{\\\\text{old}}} is the **reference (behavior) policy** from the previous iteration, used for importance sampling to stabilize learning.\n    *   AÃÇ¬†tA^t\\\\hat{A}\\_t is the **advantage estimate**, representing how much better an action performed compared to the baseline at time step ttt.\n    *   œµœµ\\\\epsilon is a **clipping parameter** that limits policy updates to prevent destructive policy shifts (as introduced in [Proximal Policy Optimization](https://arxiv.org/abs/1707.06347) by Schulman et al. (2017)).\n    *   The **min** operator enforces conservative updates by taking the smaller of the unclipped and clipped surrogate objectives.\n    *   The expectation ùîº(q,a)‚àºDE(q,a)‚àºD\\\\mathbb{E}\\_{(q,a) \\\\sim D} is taken over sampled question‚Äìanswer pairs from the training dataset DDD, reflecting the model‚Äôs distribution of reasoning trajectories.\n    *   The conditioning on _CI_ allows **real-time interpreter feedback** to influence token-level decision probabilities, enabling the model to learn _when_ and _how_ to invoke code execution within multi-turn reasoning rollouts.\n\nwhere:\n\n*   œÄŒ∏(ot‚à£q,o<t;CI)œÄŒ∏(ot‚à£q,o<t;CI)\\\\pi\\_\\\\theta(o\\_t \\\\mid q, o\\_{<t}; CI) denotes the **policy model** conditioned on the **code interpreter (CI) state**, which dynamically integrates executable code feedback during reasoning rollouts.\n*   œÄŒ∏oldœÄŒ∏old\\\\pi\\_{\\\\theta\\_{\\\\text{old}}} is the **reference (behavior) policy** from the previous iteration, used for importance sampling to stabilize learning.\n*   AÃÇ¬†tA^t\\\\hat{A}\\_t is the **advantage estimate**, representing how much better an action performed compared to the baseline at time step ttt.\n*   œµœµ\\\\epsilon is a **clipping parameter** that limits policy updates to prevent destructive policy shifts (as introduced in [Proximal Policy Optimization](https://arxiv.org/abs/1707.06347) by Schulman et al. (2017)).\n*   The **min** operator enforces conservative updates by taking the smaller of the unclipped and clipped surrogate objectives.\n*   The expectation ùîº(q,a)‚àºDE(q,a)‚àºD\\\\mathbb{E}\\_{(q,a) \\\\sim D} is taken over sampled question‚Äìanswer pairs from the training dataset DDD, reflecting the model‚Äôs distribution of reasoning trajectories.\n*   The conditioning on _CI_ allows **real-time interpreter feedback** to influence token-level decision probabilities, enabling the model to learn _when_ and _how_ to invoke code execution within multi-turn reasoning rollouts.\n\nThe **reward function** is outcome-driven. It helps the model autonomously learn _when_ and _how_ to invoke tools through outcome-based reinforcement without human priors. It is expressed as:\n\n*   **Where:**\n    \n    *   aaa denotes the **predicted answer** produced by the policy model.\n    *   aÃÇ¬†a^\\\\hat{a} represents the **ground-truth or reference answer** derived from the supervised dataset or external evaluation function.\n    *   A reward of **1** indicates that the model‚Äôs predicted outcome matches the correct solution, signifying successful reasoning or problem-solving.\n    *   A reward of **\\-1** penalizes incorrect outcomes, incentivizing the model to refine tool invocation and reasoning strategies during training.\n    *   This rule-based accuracy reward is used in [ReTool: Reinforcement Learning for Strategic Tool Use in LLMs](https://arxiv.org/abs/2504.11536) by Feng et al. (2025)\n*   This design minimizes reward hacking and fosters exploration diversity.\n    \n\n**Where:**\n\n*   aaa denotes the **predicted answer** produced by the policy model.\n*   aÃÇ¬†a^\\\\hat{a} represents the **ground-truth or reference answer** derived from the supervised dataset or external evaluation function.\n*   A reward of **1** indicates that the model‚Äôs predicted outcome matches the correct solution, signifying successful reasoning or problem-solving.\n*   A reward of **\\-1** penalizes incorrect outcomes, incentivizing the model to refine tool invocation and reasoning strategies during training.\n*   This rule-based accuracy reward is used in [ReTool: Reinforcement Learning for Strategic Tool Use in LLMs](https://arxiv.org/abs/2504.11536) by Feng et al. (2025)\n\nThis design minimizes reward hacking and fosters exploration diversity.\n\nThe following figure ([source](https://arxiv.org/abs/2504.11536)) shows text-based RL training process and ReTool‚Äôs RL training process.\n\n![](/primers/ai/assets/RL-for-agents/ReTool.jpg)\n\n##### Emergent Behaviors\n\n*   ReTool exhibits _strategic learning of code usage_, such as:\n    \n    *   **Adaptive timing** of tool invocation.\n    *   **Code self-correction**‚Äîdetecting and repairing tool errors mid-reasoning.\n    *   **Efficiency emergence**, with response lengths reduced by ~40% after training.\n\nReTool exhibits _strategic learning of code usage_, such as:\n\n*   **Adaptive timing** of tool invocation.\n*   **Code self-correction**‚Äîdetecting and repairing tool errors mid-reasoning.\n*   **Efficiency emergence**, with response lengths reduced by ~40% after training.\n\n##### Results\n\n*   ReTool-32B achieves **67% accuracy on AIME2024** in just 400 training steps‚Äîoutperforming text-only RL baselines (40% at 1080 steps) and surpassing **OpenAI‚Äôs o1-preview** by **27.9%**.\n\n##### Impact\n\n*   ReTool establishes that **dynamic interleaving of reasoning and code execution during RL** leads to emergent meta-reasoning and adaptive tool use‚Äîkey traits for future agentic reasoning systems.\n\n#### Tool-Integrated Reinforcement Learning for LLM Judges (TIR-Judge)\n\n*   [TIR-Judge](https://arxiv.org/abs/2510.23038) by Xu et al. (2025) extends tool-augmented RL beyond reasoning tasks to **evaluation and alignment**. It trains _LLM-based judges_ that can autonomously verify, compute, and reason during the evaluation of model responses.\n\n##### Concept and Framework\n\n*   TIR-Judge builds an RL pipeline for _agentic evaluators_, allowing LLM judges to:\n    \n    1.  Generate natural-language reasoning.\n    2.  Produce code snippets for verification.\n    3.  Execute them within a sandbox.\n    4.  Incorporate results into final judgment.\n*   Each judgment trajectory is represented as:\n    \n    sk\\=r1,c1,o1,‚Ä¶,rk,ck,oksk\\=r1,c1,o1,‚Ä¶,rk,ck,ok\n    \n    s\\_k = {r\\_1, c\\_1, o\\_1, \\\\dots, r\\_k, c\\_k, o\\_k}\n    *   where ririr\\_i is the reasoning step, cicic\\_i the generated code, and oi\\=I(ci)oi\\=I(ci)o\\_i = I(c\\_i) the interpreter output.\n\nTIR-Judge builds an RL pipeline for _agentic evaluators_, allowing LLM judges to:\n\n1.  Generate natural-language reasoning.\n2.  Produce code snippets for verification.\n3.  Execute them within a sandbox.\n4.  Incorporate results into final judgment.\n\nEach judgment trajectory is represented as:\n\n*   where ririr\\_i is the reasoning step, cicic\\_i the generated code, and oi\\=I(ci)oi\\=I(ci)o\\_i = I(c\\_i) the interpreter output.\n\n##### Training\n\n*   TIR-Judge employs an **iterative RL pipeline** combining **pairwise**, **pointwise**, and **listwise** judgments‚Äîspanning both verifiable (math, code) and non-verifiable (dialogue, safety) domains.\n    \n*   Two variants are explored:\n    \n    *   **TIR-Judge-Distill**, which uses small distillation-based initialization.\n    *   **TIR-Judge-Zero**, trained purely via RL without any distillation data. Here is your text with added citations:\n*   TIR-Judge adopts Decoupled Clip and Dynamic Sampling Policy Optimization ([DAPO](https://arxiv.org/pdf/2503.14476v1)) (an improved variant of [GRPO](https://arxiv.org/abs/2402.03300)) for training the LLM judge JJJ parameterized by œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta. Given a prompt-answer pair (q,a)(q,a)(q, a), they first sample a group of GGG rollouts siGi\\=1)sii\\=1G){s\\_i}\\_{i=1}^G) from the current policy œÄŒ∏old)œÄŒ∏old)\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}). Each rollout sisis\\_i is assigned a scalar reward Ri\\=R(si,a)Ri\\=R(si,a)R\\_i = R(s\\_i, a) with access to the oracle answer aaa. The policy œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta is then updated with the following clipped policy gradient objective:\n    \n    Óà∂(Œ∏)\\=ùîº(q,a)‚àºÓà∞,siGi\\=1‚àºœÄŒ∏old(‚ãÖ‚à£q)\\[1‚àëGi\\=1|si|‚àëi\\=1G‚àët\\=1|si|(min(ri,t(Œ∏),AÀÜi,t,clip(ri,t(Œ∏),1‚àíŒµlow,1+Œµhigh),AÀÜi,t)‚àíŒ≤DKL(œÄŒ∏,‚Äñ,œÄref))\\]s.t.¬†0<‚à£si:is\\_equivalent(a,si)‚à£<GJ(Œ∏)\\=E(q,a)‚àºD,sii\\=1G‚àºœÄŒ∏old(‚ãÖ‚à£q)\\[1‚àëi\\=1G|si|‚àëi\\=1G‚àët\\=1|si|(min(ri,t(Œ∏),A^i,t,clip(ri,t(Œ∏),1‚àíŒµlow,1+Œµhigh),A^i,t)‚àíŒ≤DKL(œÄŒ∏,‚Äñ,œÄref))\\]s.t.¬†0<‚à£si:is\\_equivalent(a,si)‚à£<G\n    \n    \\\\mathcal J(\\\\theta) = \\\\mathbb E\\_{(q,a)\\\\sim \\\\mathcal D,{s\\_i}\\_{i=1}^G\\\\sim\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}(\\\\cdot\\\\mid q)}\\\\Bigg\\[\\\\frac1{\\\\sum\\_{i=1}^G |s\\_i|} \\\\sum\\_{i=1}^G \\\\sum\\_{t=1}^{|s\\_i|} \\\\Big(\\\\min\\\\big(r\\_{i,t}(\\\\theta),\\\\widehat A\\_{i,t},\\\\mathrm{clip}(r\\_{i,t}(\\\\theta),1-\\\\varepsilon\\_{\\\\text{low}},1+\\\\varepsilon\\_{\\\\text{high}}),\\\\widehat A\\_{i,t}\\\\big)\\\\\\\\ -\\\\beta D\\_{\\\\rm KL}\\\\big(\\\\pi\\_\\\\theta ,\\\\Vert, \\\\pi\\_{\\\\rm ref}\\\\big)\\\\Big)\\\\Bigg\\]\\\\\\\\ \\\\quad\\\\text{s.t. }0<\\\\mid{s\\_i:\\\\text{is\\_equivalent}(a,s\\_i)}\\\\mid<G\n    *   where:\n        *   ri,t(Œ∏)\\=œÄŒ∏(si,t‚à£q,si,<t)œÄŒ∏old(si,t‚à£q,si,<t)ri,t(Œ∏)\\=œÄŒ∏(si,t‚à£q,si,<t)œÄŒ∏old(si,t‚à£q,si,<t)r\\_{i,t}(\\\\theta) = \\\\frac{\\\\pi\\_\\\\theta(s\\_{i,t}\\\\mid q, s\\_{i,<t})}{\\\\pi\\_{\\\\theta\\_{\\\\rm old}}(s\\_{i,t}\\\\mid q, s\\_{i,<t})} is the token-level importance weight, and\n        *   AÀÜi,t\\=Ri‚àímean(RiGi\\=1)std(RiGi\\=1)A^i,t\\=Ri‚àímean‚Å°(Rii\\=1G)std‚Å°(Rii\\=1G)\\\\widehat A\\_{i,t} = \\\\frac{R\\_i - \\\\operatorname{mean}({R\\_i}\\_{i=1}^G)}{\\\\operatorname{std}({R\\_i}\\_{i=1}^G)} is the token-level advantage\n        *   The hyperparameters ŒµlowŒµlow\\\\varepsilon\\_{\\\\text {low}} and ŒµhighŒµhigh\\\\varepsilon\\_{\\\\text{high}} control the clipping range for importance weights, while Œ≤Œ≤\\\\beta regulates the KL-divergence penalty to stabilize training.\n\nTIR-Judge employs an **iterative RL pipeline** combining **pairwise**, **pointwise**, and **listwise** judgments‚Äîspanning both verifiable (math, code) and non-verifiable (dialogue, safety) domains.\n\nTwo variants are explored:\n\n*   **TIR-Judge-Distill**, which uses small distillation-based initialization.\n*   **TIR-Judge-Zero**, trained purely via RL without any distillation data. Here is your text with added citations:\n\nTIR-Judge adopts Decoupled Clip and Dynamic Sampling Policy Optimization ([DAPO](https://arxiv.org/pdf/2503.14476v1)) (an improved variant of [GRPO](https://arxiv.org/abs/2402.03300)) for training the LLM judge JJJ parameterized by œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta. Given a prompt-answer pair (q,a)(q,a)(q, a), they first sample a group of GGG rollouts siGi\\=1)sii\\=1G){s\\_i}\\_{i=1}^G) from the current policy œÄŒ∏old)œÄŒ∏old)\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}). Each rollout sisis\\_i is assigned a scalar reward Ri\\=R(si,a)Ri\\=R(si,a)R\\_i = R(s\\_i, a) with access to the oracle answer aaa. The policy œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta is then updated with the following clipped policy gradient objective:\n\n*   where:\n    *   ri,t(Œ∏)\\=œÄŒ∏(si,t‚à£q,si,<t)œÄŒ∏old(si,t‚à£q,si,<t)ri,t(Œ∏)\\=œÄŒ∏(si,t‚à£q,si,<t)œÄŒ∏old(si,t‚à£q,si,<t)r\\_{i,t}(\\\\theta) = \\\\frac{\\\\pi\\_\\\\theta(s\\_{i,t}\\\\mid q, s\\_{i,<t})}{\\\\pi\\_{\\\\theta\\_{\\\\rm old}}(s\\_{i,t}\\\\mid q, s\\_{i,<t})} is the token-level importance weight, and\n    *   AÀÜi,t\\=Ri‚àímean(RiGi\\=1)std(RiGi\\=1)A^i,t\\=Ri‚àímean‚Å°(Rii\\=1G)std‚Å°(Rii\\=1G)\\\\widehat A\\_{i,t} = \\\\frac{R\\_i - \\\\operatorname{mean}({R\\_i}\\_{i=1}^G)}{\\\\operatorname{std}({R\\_i}\\_{i=1}^G)} is the token-level advantage\n    *   The hyperparameters ŒµlowŒµlow\\\\varepsilon\\_{\\\\text {low}} and ŒµhighŒµhigh\\\\varepsilon\\_{\\\\text{high}} control the clipping range for importance weights, while Œ≤Œ≤\\\\beta regulates the KL-divergence penalty to stabilize training.\n\n*   ri,t(Œ∏)\\=œÄŒ∏(si,t‚à£q,si,<t)œÄŒ∏old(si,t‚à£q,si,<t)ri,t(Œ∏)\\=œÄŒ∏(si,t‚à£q,si,<t)œÄŒ∏old(si,t‚à£q,si,<t)r\\_{i,t}(\\\\theta) = \\\\frac{\\\\pi\\_\\\\theta(s\\_{i,t}\\\\mid q, s\\_{i,<t})}{\\\\pi\\_{\\\\theta\\_{\\\\rm old}}(s\\_{i,t}\\\\mid q, s\\_{i,<t})} is the token-level importance weight, and\n*   AÀÜi,t\\=Ri‚àímean(RiGi\\=1)std(RiGi\\=1)A^i,t\\=Ri‚àímean‚Å°(Rii\\=1G)std‚Å°(Rii\\=1G)\\\\widehat A\\_{i,t} = \\\\frac{R\\_i - \\\\operatorname{mean}({R\\_i}\\_{i=1}^G)}{\\\\operatorname{std}({R\\_i}\\_{i=1}^G)} is the token-level advantage\n*   The hyperparameters ŒµlowŒµlow\\\\varepsilon\\_{\\\\text {low}} and ŒµhighŒµhigh\\\\varepsilon\\_{\\\\text{high}} control the clipping range for importance weights, while Œ≤Œ≤\\\\beta regulates the KL-divergence penalty to stabilize training.\n\n##### Results\n\n*   On seven public benchmarks, TIR-Judge surpasses reasoning-only judges by **6.4% (pointwise)** and **7.7% (pairwise)**, and achieves **96% of Claude-Opus-4‚Äôs performance** with only **8B parameters**.\n*   The following figure ([source](https://arxiv.org/abs/2510.23038)) shows the TIR-Judge RL framework and training variants (TIR-Judge-Zero and Distill).\n\n![](/primers/ai/assets/RL-for-agents/TIR-Judge.jpg)\n\n##### Key Insight\n\n*   TIR-Judge demonstrates that reinforcement learning can endow LLM judges with **agentic verification** abilities‚Äîevaluating not only by textual reasoning but by executing verifiable logic to test correctness.\n*   This closes the feedback loop in RLHF pipelines, enabling both **reasoners and evaluators** to become _tool-augmented and self-improving_.\n\n#### Comparative Analysis\n\n**Framework**\n\n**Focus**\n\n**Training Style**\n\n**Emergent Behavior**\n\n**Key Results**\n\nToRL\n\nTool integration during RL\n\nGRPO\n\nSelf-regulated code use, reflection\n\n+14% on AIME24\n\nReTool\n\nStrategic tool-use via interleaved code\n\nPPO with outcome reward\n\nCode self-correction, adaptive timing\n\n+27.9% vs o1-preview\n\nTIR-Judge\n\nTool-augmented evaluation\n\nDAPO (an improved variant of GRPO)\n\nAgentic verification, multi-domain generalization\n\n6.4‚Äì7.7% gains over text-only judges\n\n**Framework**\n\n**Focus**\n\n**Training Style**\n\n**Emergent Behavior**\n\n**Key Results**\n\nToRL\n\nTool integration during RL\n\nGRPO\n\nSelf-regulated code use, reflection\n\n+14% on AIME24\n\nReTool\n\nStrategic tool-use via interleaved code\n\nPPO with outcome reward\n\nCode self-correction, adaptive timing\n\n+27.9% vs o1-preview\n\nTIR-Judge\n\nTool-augmented evaluation\n\nDAPO (an improved variant of GRPO)\n\nAgentic verification, multi-domain generalization\n\n6.4‚Äì7.7% gains over text-only judges\n\n#### Theoretical Framing\n\n*   All three frameworks share a **reinforcement-based objective** augmented with tool-conditioned state transitions:\n    \n    pŒ∏(c1:T,o1:T|x)\\=‚àèt\\=1TpŒ∏(at|x,c<t,o<t)p(ot|at)pŒ∏(c1:T,o1:T|x)\\=‚àèt\\=1TpŒ∏(at|x,c<t,o<t)p(ot|at)\n    \n    p\\_\\\\theta(c\\_{1:T}, o\\_{1:T} | x) = \\\\prod\\_{t=1}^{T} p\\_\\\\theta(a\\_t | x, c\\_{<t}, o\\_{<t}) p(o\\_t | a\\_t)\n    *   where atata\\_t represents either reasoning or tool action and ototo\\_t its observation.\n*   This formalism generalizes the Themis-style hybrid objective by integrating _action-conditioned reasoning trajectories_ into the reward model.\n    \n\nAll three frameworks share a **reinforcement-based objective** augmented with tool-conditioned state transitions:\n\n*   where atata\\_t represents either reasoning or tool action and ototo\\_t its observation.\n\nThis formalism generalizes the Themis-style hybrid objective by integrating _action-conditioned reasoning trajectories_ into the reward model.\n\n#### Conceptual Implication\n\n*   The synthesis of ToRL, ReTool, and TIR-Judge underscores the transition from **reactive reasoning** to **agentic reasoning**‚Äîwhere LLMs not only _reason about outputs_ but _interact with tools_ to verify and improve them.\n*   These approaches redefine RLHF as **Tool-Integrated Reinforcement Learning for Reasoning and Evaluation (TIRL¬≤E)**‚Äîa unified path toward verifiable, self-correcting AI systems.",
    "order": 21,
    "orderInChapter": 3,
    "difficulty": 5,
    "estimatedMinutes": 18,
    "tags": [
      "nlpllms",
      "embedding",
      "llm",
      "reinforcement learning",
      "optimization",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 3571,
      "contentLength": 441304
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#reinforcement-learning-for-tool-integrated-reasoning",
    "scrapedAt": "2025-12-28T11:54:00.656Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-tool-augmented-reward-modeling-themis-22",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Reinforcement Learning-Based Reasoning",
    "title": "Tool-Augmented Reward Modeling (Themis)",
    "subtitle": "Reinforcement Learning-Based Reasoning",
    "contentHtml": "<ul>\n  <li>The paper <a href=\"https://arxiv.org/abs/2310.01045\">Tool-Augmented Reward Modeling (Themis)</a> by Li et al. (2024) introduces an RLHF-based framework that directly enhances reasoning through external tool usage during the reward modeling process. The key idea is to allow reward models (RMs) to <strong>access external tools</strong>‚Äîsuch as search engines, calculators, and code interpreters‚Äîwhile evaluating responses, thereby grounding the reasoning process in factual and computational evidence.</li>\n  <li>In summary, Themis operationalizes the idea that <strong>reasoning should be rewardable</strong>‚Äîtransforming RLHF from passive alignment into active, evidence-grounded reasoning optimization.</li>\n</ul>\n<h4 id=\"process\">Process</h4>\n<ul>\n  <li>\n    <p>The training of the Themis reward model relies on <strong>supervised fine-tuning (SFT)</strong> rather than direct reinforcement learning. The RM is trained using <strong>supervised imitation</strong> of high-quality reasoning traces that demonstrate tool use and reward inference. This SFT stage helps the model learn to <strong>invoke tools, interpret results, and assign scores</strong> grounded in external evidence.</p>\n  </li>\n  <li>\n    <p>Importantly, <strong>reinforcement learning is <em>not</em> used</strong> to optimize the reward model itself‚ÄîThemis remains an <em>SFT-trained verifier</em> that provides reward signals for downstream <strong>policy optimization</strong> (which <em>can</em> use RLHF or PPO).</p>\n  </li>\n  <li>\n    <p>The supervised fine-tuning loss integrates multiple components:</p>\n\n    <ul>\n      <li>A ranking loss over preference pairs to train the reward model,</li>\n      <li>A reasoning loss to predict intermediate tool-use steps,</li>\n      <li>An observation and rationale loss to improve interpretability:</li>\n    </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-227-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>total</mtext></mrow></msub><mo>=</mo><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>RM</mtext></mrow></msub><mo>+</mo><mi>&amp;#x03B1;</mi><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></munderover><mo stretchy=&quot;false&quot;>(</mo><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>tool</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B2;</mi><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>obs</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03C9;</mi><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>rationale</mtext></mrow></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3556\" style=\"width: 24.638em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.263em, 1020.52em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3557\"><span class=\"msubsup\" id=\"MathJax-Span-3558\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3559\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3560\"><span class=\"mrow\" id=\"MathJax-Span-3561\"><span class=\"mtext\" id=\"MathJax-Span-3562\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">total</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3563\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3564\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3565\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3566\"><span class=\"mrow\" id=\"MathJax-Span-3567\"><span class=\"mtext\" id=\"MathJax-Span-3568\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">RM</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3569\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3570\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"munderover\" id=\"MathJax-Span-3571\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3572\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.99em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-3573\"><span class=\"mrow\" id=\"MathJax-Span-3574\"><span class=\"mi\" id=\"MathJax-Span-3575\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3576\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3577\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-3578\"><span class=\"mrow\" id=\"MathJax-Span-3579\"><span class=\"mi\" id=\"MathJax-Span-3580\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3581\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3582\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3583\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3584\"><span class=\"mrow\" id=\"MathJax-Span-3585\"><span class=\"mtext\" id=\"MathJax-Span-3586\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">tool</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3587\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3588\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3589\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3590\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3591\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-3592\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3593\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3594\"><span class=\"mrow\" id=\"MathJax-Span-3595\"><span class=\"mtext\" id=\"MathJax-Span-3596\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">obs</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3597\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3598\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3599\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3600\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3601\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3602\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">œâ</span><span class=\"msubsup\" id=\"MathJax-Span-3603\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3604\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3605\"><span class=\"mrow\" id=\"MathJax-Span-3606\"><span class=\"mtext\" id=\"MathJax-Span-3607\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">rationale</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>total</mtext></mrow></msub><mo>=</mo><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>RM</mtext></mrow></msub><mo>+</mo><mi>Œ±</mi><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi></mrow></munderover><mo stretchy=\"false\">(</mo><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>tool</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ≤</mi><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>obs</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>+</mo><mi>œâ</mi><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>rationale</mtext></mrow></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-227\">L_{\\text{total}} = L_{\\text{RM}} + \\alpha \\sum_{t=1}^{T} (L_{\\text{tool}}(t) + \\beta L_{\\text{obs}}(t)) + \\omega L_{\\text{rationale}}</script>\n\n    <p>where</p>\n\n    <ul>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-228-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>RM</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3608\" style=\"width: 2.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.72em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3609\"><span class=\"msubsup\" id=\"MathJax-Span-3610\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3611\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3612\"><span class=\"mrow\" id=\"MathJax-Span-3613\"><span class=\"mtext\" id=\"MathJax-Span-3614\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">RM</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>RM</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-228\">L_{\\text{RM}}</script> is the preference-based ranking loss,</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-229-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>tool</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3615\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.61em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3616\"><span class=\"msubsup\" id=\"MathJax-Span-3617\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3618\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3619\"><span class=\"mrow\" id=\"MathJax-Span-3620\"><span class=\"mtext\" id=\"MathJax-Span-3621\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">tool</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3622\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3623\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3624\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>tool</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-229\">L_{\\text{tool}}(t)</script> models tool selection accuracy,</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-230-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>obs</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3625\" style=\"width: 3.076em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.555em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.5em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3626\"><span class=\"msubsup\" id=\"MathJax-Span-3627\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3628\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3629\"><span class=\"mrow\" id=\"MathJax-Span-3630\"><span class=\"mtext\" id=\"MathJax-Span-3631\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">obs</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3632\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3633\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3634\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>obs</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-230\">L_{\\text{obs}}(t)</script> aligns model predictions with observed tool outputs, and</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-231-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>rationale</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3635\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1003.13em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3636\"><span class=\"msubsup\" id=\"MathJax-Span-3637\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3638\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3639\"><span class=\"mrow\" id=\"MathJax-Span-3640\"><span class=\"mtext\" id=\"MathJax-Span-3641\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">rationale</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>rationale</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-231\">L_{\\text{rationale}}</script> encourages the generation of coherent explanations for reward assignments.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This design enables Themis to be <strong>interpretable and verifiable</strong> without the instability of RL-based reward training. The authors note that RLHF or PPO can later be used to fine-tune the <em>policy</em> against the SFT-trained Themis RM‚Äîbut not vice versa.</p>\n  </li>\n  <li>\n    <p>The following figure (<a href=\"https://arxiv.org/abs/2310.01045\">source</a>) shows illustrates the pipeline of (a) Vanilla reward models (RMs); (b) Tool-augmented RMs, namely Themis; (c) RL via proximal policy optimization (PPO) on above RMs; (d) Examples of single or multiple tool use process in the proposed approach.</p>\n  </li>\n</ul>\n<p>The training of the Themis reward model relies on <strong>supervised fine-tuning (SFT)</strong> rather than direct reinforcement learning. The RM is trained using <strong>supervised imitation</strong> of high-quality reasoning traces that demonstrate tool use and reward inference. This SFT stage helps the model learn to <strong>invoke tools, interpret results, and assign scores</strong> grounded in external evidence.</p>\n<p>Importantly, <strong>reinforcement learning is <em>not</em> used</strong> to optimize the reward model itself‚ÄîThemis remains an <em>SFT-trained verifier</em> that provides reward signals for downstream <strong>policy optimization</strong> (which <em>can</em> use RLHF or PPO).</p>\n<p>The supervised fine-tuning loss integrates multiple components:</p>\n<ul>\n      <li>A ranking loss over preference pairs to train the reward model,</li>\n      <li>A reasoning loss to predict intermediate tool-use steps,</li>\n      <li>An observation and rationale loss to improve interpretability:</li>\n    </ul>\n<p>where</p>\n<ul>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-228-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>RM</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3608\" style=\"width: 2.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.72em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3609\"><span class=\"msubsup\" id=\"MathJax-Span-3610\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3611\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3612\"><span class=\"mrow\" id=\"MathJax-Span-3613\"><span class=\"mtext\" id=\"MathJax-Span-3614\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">RM</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>RM</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-228\">L_{\\text{RM}}</script> is the preference-based ranking loss,</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-229-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>tool</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3615\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.61em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3616\"><span class=\"msubsup\" id=\"MathJax-Span-3617\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3618\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3619\"><span class=\"mrow\" id=\"MathJax-Span-3620\"><span class=\"mtext\" id=\"MathJax-Span-3621\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">tool</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3622\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3623\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3624\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>tool</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-229\">L_{\\text{tool}}(t)</script> models tool selection accuracy,</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-230-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>obs</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3625\" style=\"width: 3.076em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.555em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.5em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3626\"><span class=\"msubsup\" id=\"MathJax-Span-3627\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3628\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3629\"><span class=\"mrow\" id=\"MathJax-Span-3630\"><span class=\"mtext\" id=\"MathJax-Span-3631\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">obs</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3632\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3633\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3634\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>obs</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-230\">L_{\\text{obs}}(t)</script> aligns model predictions with observed tool outputs, and</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-231-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>rationale</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3635\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1003.13em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3636\"><span class=\"msubsup\" id=\"MathJax-Span-3637\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3638\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3639\"><span class=\"mrow\" id=\"MathJax-Span-3640\"><span class=\"mtext\" id=\"MathJax-Span-3641\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">rationale</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>rationale</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-231\">L_{\\text{rationale}}</script> encourages the generation of coherent explanations for reward assignments.</li>\n    </ul>\n<p>This design enables Themis to be <strong>interpretable and verifiable</strong> without the instability of RL-based reward training. The authors note that RLHF or PPO can later be used to fine-tune the <em>policy</em> against the SFT-trained Themis RM‚Äîbut not vice versa.</p>\n<p>The following figure (<a href=\"https://arxiv.org/abs/2310.01045\">source</a>) shows illustrates the pipeline of (a) Vanilla reward models (RMs); (b) Tool-augmented RMs, namely Themis; (c) RL via proximal policy optimization (PPO) on above RMs; (d) Examples of single or multiple tool use process in the proposed approach.</p>\n<p><img src=\"/primers/ai/assets/RL-for-agents/Themis.jpg\" alt=\"\"></p>\n<h4 id=\"core-idea-10\">Core Idea</h4>\n<ul>\n  <li>\n    <p>Conventional reward models in RLHF predict human preferences solely based on static textual input. Themis instead models reasoning as a <strong>tool-augmented sequential decision process</strong>. Given a prompt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-232-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3642\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3643\"><span class=\"mi\" id=\"MathJax-Span-3644\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-232\">x</script> and model response <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-233-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3645\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3646\"><span class=\"mi\" id=\"MathJax-Span-3647\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-233\">y</script>, the reward model performs a multi-step reasoning trajectory <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-234-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>a</mi><mi>T</mi></msub><mo>,</mo><msub><mi>o</mi><mi>T</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3648\" style=\"width: 12.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1010.37em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3649\"><span class=\"msubsup\" id=\"MathJax-Span-3650\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3651\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3652\"><span class=\"mrow\" id=\"MathJax-Span-3653\"><span class=\"mn\" id=\"MathJax-Span-3654\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-3655\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-3656\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3657\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-3658\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3659\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3660\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-3661\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3662\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3663\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3664\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-3665\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3666\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-3667\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-3668\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3669\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3670\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3671\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3672\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3673\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3674\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3675\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3676\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>c</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msub><mi>a</mi><mi>T</mi></msub><mo>,</mo><msub><mi>o</mi><mi>T</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-234\">c_{1:T} = (a_1, o_1, \\dots, a_T, o_T)</script>, where each <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-235-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3677\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3678\"><span class=\"msubsup\" id=\"MathJax-Span-3679\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3680\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3681\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-235\">a_t</script> is an action (thought or tool invocation) and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-236-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3682\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3683\"><span class=\"msubsup\" id=\"MathJax-Span-3684\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3685\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3686\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-236\">o_t</script> is the resulting observation.</p>\n  </li>\n  <li>\n    <p>The overall reward is represented as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-237-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3687\" style=\"width: 5.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.951em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.9em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3688\"><span class=\"msubsup\" id=\"MathJax-Span-3689\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3690\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3691\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3692\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3693\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3694\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3695\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-3696\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3697\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3698\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3699\"><span class=\"mrow\" id=\"MathJax-Span-3700\"><span class=\"mn\" id=\"MathJax-Span-3701\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-3702\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-3703\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3704\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>r</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><msub><mi>c</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-237\">r_\\theta(x, y, c_{1:T})</script>\n  </li>\n  <li>\n    <p>‚Ä¶ and optimized through a hybrid objective combining ranking and autoregressive reasoning losses:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-238-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>total</mtext></mrow></msub><mo>=</mo><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>RM</mtext></mrow></msub><mo>+</mo><mi>&amp;#x03B1;</mi><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></munderover><mo stretchy=&quot;false&quot;>(</mo><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>tool</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B2;</mi><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>obs</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03C9;</mi><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>rationale</mtext></mrow></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3705\" style=\"width: 24.638em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.263em, 1020.52em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3706\"><span class=\"msubsup\" id=\"MathJax-Span-3707\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3708\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3709\"><span class=\"mrow\" id=\"MathJax-Span-3710\"><span class=\"mtext\" id=\"MathJax-Span-3711\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">total</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3712\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3713\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3714\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3715\"><span class=\"mrow\" id=\"MathJax-Span-3716\"><span class=\"mtext\" id=\"MathJax-Span-3717\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">RM</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3718\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3719\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"munderover\" id=\"MathJax-Span-3720\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3721\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.99em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-3722\"><span class=\"mrow\" id=\"MathJax-Span-3723\"><span class=\"mi\" id=\"MathJax-Span-3724\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3725\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3726\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-3727\"><span class=\"mrow\" id=\"MathJax-Span-3728\"><span class=\"mi\" id=\"MathJax-Span-3729\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3730\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3731\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3732\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3733\"><span class=\"mrow\" id=\"MathJax-Span-3734\"><span class=\"mtext\" id=\"MathJax-Span-3735\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">tool</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3736\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3737\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3738\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3739\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3740\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-3741\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3742\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3743\"><span class=\"mrow\" id=\"MathJax-Span-3744\"><span class=\"mtext\" id=\"MathJax-Span-3745\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">obs</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3746\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3747\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3748\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3749\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3750\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3751\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">œâ</span><span class=\"msubsup\" id=\"MathJax-Span-3752\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3753\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3754\"><span class=\"mrow\" id=\"MathJax-Span-3755\"><span class=\"mtext\" id=\"MathJax-Span-3756\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">rationale</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>total</mtext></mrow></msub><mo>=</mo><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>RM</mtext></mrow></msub><mo>+</mo><mi>Œ±</mi><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi></mrow></munderover><mo stretchy=\"false\">(</mo><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>tool</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ≤</mi><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>obs</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>+</mo><mi>œâ</mi><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>rationale</mtext></mrow></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-238\">L_{\\text{total}} = L_{\\text{RM}} + \\alpha \\sum_{t=1}^{T} (L_{\\text{tool}}(t) + \\beta L_{\\text{obs}}(t)) + \\omega L_{\\text{rationale}}</script>\n  </li>\n  <li>\n    <p>This enables the RM to learn both <em>what</em> to reward and <em>how</em> to reason about rewards using external evidence.</p>\n  </li>\n</ul>\n<p>Conventional reward models in RLHF predict human preferences solely based on static textual input. Themis instead models reasoning as a <strong>tool-augmented sequential decision process</strong>. Given a prompt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-232-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3642\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3643\"><span class=\"mi\" id=\"MathJax-Span-3644\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-232\">x</script> and model response <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-233-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3645\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3646\"><span class=\"mi\" id=\"MathJax-Span-3647\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-233\">y</script>, the reward model performs a multi-step reasoning trajectory <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-234-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>a</mi><mi>T</mi></msub><mo>,</mo><msub><mi>o</mi><mi>T</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3648\" style=\"width: 12.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1010.37em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3649\"><span class=\"msubsup\" id=\"MathJax-Span-3650\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3651\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3652\"><span class=\"mrow\" id=\"MathJax-Span-3653\"><span class=\"mn\" id=\"MathJax-Span-3654\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-3655\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-3656\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3657\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-3658\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3659\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3660\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-3661\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3662\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3663\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3664\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-3665\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3666\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-3667\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-3668\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3669\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3670\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3671\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3672\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3673\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3674\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3675\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3676\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>c</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>o</mi><mn>1</mn></msub><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msub><mi>a</mi><mi>T</mi></msub><mo>,</mo><msub><mi>o</mi><mi>T</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-234\">c_{1:T} = (a_1, o_1, \\dots, a_T, o_T)</script>, where each <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-235-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3677\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3678\"><span class=\"msubsup\" id=\"MathJax-Span-3679\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3680\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3681\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-235\">a_t</script> is an action (thought or tool invocation) and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-236-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3682\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3683\"><span class=\"msubsup\" id=\"MathJax-Span-3684\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3685\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3686\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>o</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-236\">o_t</script> is the resulting observation.</p>\n<p>The overall reward is represented as:</p>\n<p>‚Ä¶ and optimized through a hybrid objective combining ranking and autoregressive reasoning losses:</p>\n<p>This enables the RM to learn both <em>what</em> to reward and <em>how</em> to reason about rewards using external evidence.</p>\n<h4 id=\"mechanism-10\">Mechanism</h4>\n<ol>\n  <li><strong>Thought Generation:</strong> The RM decides whether external information is required.</li>\n  <li><strong>Tool Invocation:</strong> It dynamically selects a tool (e.g., Google, Calculator, Translator) and provides input arguments.</li>\n  <li><strong>Observation:</strong> The model processes the tool‚Äôs output.</li>\n  <li><strong>Rationale and Reward:</strong> It integrates the observations into a coherent rationale and outputs a scalar reward signal.</li>\n</ol>\n<ul>\n  <li>This sequence creates a transparent reward pipeline, with interpretable reasoning traces linking tool use to reward assignment‚Äîenhancing trustworthiness and debuggability.</li>\n</ul>\n<h4 id=\"implementation\">Implementation</h4>\n<ul>\n  <li>Themis uses <strong>Vicuna-7B</strong> as the backbone and is fine-tuned via SFT on the <strong>Tool-Augmented Reward Dataset (TARA)</strong>‚Äîa 15k-instance corpus combining seven tool APIs and human-annotated rationales.</li>\n  <li>The dataset construction pipeline includes: (i) collecting QA pairs, (ii) building a <em>ToolBank</em> with APIs like Calculator, Weather, and WikiSearch, (iii) generating multi-agent tool-use trajectories via GPT-4 simulations, and (iv) filtering noise.</li>\n  <li>In experiments, policies trained with Themis-based RMs outperform standard RMs by <strong>17.7%</strong> in preference ranking and achieve a <strong>32% win rate</strong> in human evaluations.</li>\n</ul>\n<h4 id=\"theoretical-framing-6\">Theoretical Framing</h4>\n<ul>\n  <li>\n    <p>Themis formalizes the reward inference as a reasoning trajectory:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-239-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munderover><mo>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></munderover><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>o</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3757\" style=\"width: 20.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 17.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.576em, 1017.4em, 3.909em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3758\"><span class=\"msubsup\" id=\"MathJax-Span-3759\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3760\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3761\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3762\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3763\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3764\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3765\"><span class=\"mrow\" id=\"MathJax-Span-3766\"><span class=\"mn\" id=\"MathJax-Span-3767\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-3768\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">:</span><span class=\"mi\" id=\"MathJax-Span-3769\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3770\"><span class=\"mrow\" id=\"MathJax-Span-3771\"><span class=\"mo\" id=\"MathJax-Span-3772\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-3773\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3774\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3775\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-3776\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3777\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-3778\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.3em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3779\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àè</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.99em, 4.273em, -999.997em); top: -2.862em; left: 0.159em;\"><span class=\"texatom\" id=\"MathJax-Span-3780\"><span class=\"mrow\" id=\"MathJax-Span-3781\"><span class=\"mi\" id=\"MathJax-Span-3782\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3783\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3784\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.47em, 4.169em, -999.997em); top: -5.206em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3785\"><span class=\"mrow\" id=\"MathJax-Span-3786\"><span class=\"mi\" id=\"MathJax-Span-3787\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3788\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3789\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3790\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3791\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3792\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3793\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3794\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3795\"><span class=\"mrow\" id=\"MathJax-Span-3796\"><span class=\"mo\" id=\"MathJax-Span-3797\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-3798\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3799\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3800\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-3801\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3802\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3803\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3804\"><span class=\"mrow\" id=\"MathJax-Span-3805\"><span class=\"mo\" id=\"MathJax-Span-3806\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-3807\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3808\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3809\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3810\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3811\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3812\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3813\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3814\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3815\" style=\"font-family: STIXGeneral-Italic;\">o</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3816\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3817\"><span class=\"mrow\" id=\"MathJax-Span-3818\"><span class=\"mo\" id=\"MathJax-Span-3819\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3820\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3821\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3822\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3823\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>c</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munderover><mo>‚àè</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi></mrow></munderover><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><msub><mi>c</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo>&lt;</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>,</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>o</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-239\">p_\\theta(c_{1:T} | x, y) = \\prod_{t=1}^{T} p_\\theta(a_t | x, y, c_{<t}) , p_\\theta(o_t | a_t)</script>\n  </li>\n  <li>\n    <p>The scalar reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-240-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3824\" style=\"width: 1.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.84em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3825\"><span class=\"msubsup\" id=\"MathJax-Span-3826\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3827\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3828\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-240\">r_\\theta</script> is derived from the terminal state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-241-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>T</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3829\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3830\"><span class=\"msubsup\" id=\"MathJax-Span-3831\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3832\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3833\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>T</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-241\">s_T</script> of this trajectory. The training objective encourages consistent ranking between correct and incorrect outputs via a contrastive loss:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-242-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>RM</mtext></mrow></msub><mo>=</mo><mo>&amp;#x2212;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><mi>D</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mi>log</mi><mo>&amp;#x2061;</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3834\" style=\"width: 22.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 18.753em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1018.65em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3835\"><span class=\"msubsup\" id=\"MathJax-Span-3836\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3837\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-3838\"><span class=\"mrow\" id=\"MathJax-Span-3839\"><span class=\"mtext\" id=\"MathJax-Span-3840\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">RM</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3841\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-3842\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-3843\"><span style=\"display: inline-block; position: relative; width: 4.065em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3844\"><span class=\"mrow\" id=\"MathJax-Span-3845\"><span class=\"mi\" id=\"MathJax-Span-3846\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3847\"><span class=\"mrow\" id=\"MathJax-Span-3848\"><span class=\"mo\" id=\"MathJax-Span-3849\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3850\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3851\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3852\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3853\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-3854\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3855\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3856\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3857\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-3858\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3859\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3860\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"mi\" id=\"MathJax-Span-3861\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">D</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3862\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-3863\" style=\"font-family: STIXGeneral-Regular;\">log</span><span class=\"mo\" id=\"MathJax-Span-3864\"></span><span class=\"mi\" id=\"MathJax-Span-3865\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">œÉ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3866\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3867\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3868\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3869\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3870\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3871\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3872\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3873\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3874\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3875\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3876\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3877\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-3878\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3879\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3880\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3881\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3882\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3883\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3884\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3885\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3886\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3887\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3888\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3889\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>RM</mtext></mrow></msub><mo>=</mo><mo>‚àí</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àº</mo><mi>D</mi></mrow></msub><mo stretchy=\"false\">[</mo><mi>log</mi><mo>‚Å°</mo><mi>œÉ</mi><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>r</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-242\">L_{\\text{RM}} = -\\mathbb{E}_{(x, y_w, y_l) \\sim D} [\\log \\sigma(r_\\theta(x, y_w) - r_\\theta(x, y_l))]</script>\n  </li>\n</ul>\n<p>Themis formalizes the reward inference as a reasoning trajectory:</p>\n<p>The scalar reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-240-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3824\" style=\"width: 1.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.84em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3825\"><span class=\"msubsup\" id=\"MathJax-Span-3826\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3827\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3828\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-240\">r_\\theta</script> is derived from the terminal state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-241-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>T</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3829\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3830\"><span class=\"msubsup\" id=\"MathJax-Span-3831\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3832\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3833\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>T</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-241\">s_T</script> of this trajectory. The training objective encourages consistent ranking between correct and incorrect outputs via a contrastive loss:</p>\n<h4 id=\"conceptual-significance\">Conceptual Significance</h4>\n<ul>\n  <li>Themis reframes RLHF as <em>interactive reasoning optimization</em>: RMs are no longer passive preference predictors but <strong>active verifiers</strong> that reason and validate before rewarding.</li>\n  <li>This bridges the gap between <em>verbal reasoning</em> and <em>procedural verification</em>, grounding alignment in externally verifiable evidence rather than subjective preference scores.</li>\n</ul>\n<h4 id=\"related-work-1\">Related Work</h4>\n<ul>\n  <li><a href=\"https://arxiv.org/abs/2210.03629\">ReAct</a> by Yao et al. (2022): integrates reasoning and action for tool use.</li>\n  <li><a href=\"https://arxiv.org/abs/2201.11903\">Chain-of-Thought</a> by Wei et al. (2022): scaffolds step-by-step reasoning.</li>\n  <li><a href=\"https://arxiv.org/abs/2203.02155\">InstructGPT</a> by Ouyang et al. (2022): establishes RLHF‚Äôs preference-based optimization paradigm.</li>\n  <li>Themis extends these by adding <strong>tool-augmented reasoning</strong> and <strong>interpretable reward generation</strong>‚Äîa move toward verifiable and grounded alignment.</li>\n</ul>",
    "contentMarkdown": "*   The paper [Tool-Augmented Reward Modeling (Themis)](https://arxiv.org/abs/2310.01045) by Li et al. (2024) introduces an RLHF-based framework that directly enhances reasoning through external tool usage during the reward modeling process. The key idea is to allow reward models (RMs) to **access external tools**‚Äîsuch as search engines, calculators, and code interpreters‚Äîwhile evaluating responses, thereby grounding the reasoning process in factual and computational evidence.\n*   In summary, Themis operationalizes the idea that **reasoning should be rewardable**‚Äîtransforming RLHF from passive alignment into active, evidence-grounded reasoning optimization.\n\n#### Process\n\n*   The training of the Themis reward model relies on **supervised fine-tuning (SFT)** rather than direct reinforcement learning. The RM is trained using **supervised imitation** of high-quality reasoning traces that demonstrate tool use and reward inference. This SFT stage helps the model learn to **invoke tools, interpret results, and assign scores** grounded in external evidence.\n    \n*   Importantly, **reinforcement learning is _not_ used** to optimize the reward model itself‚ÄîThemis remains an _SFT-trained verifier_ that provides reward signals for downstream **policy optimization** (which _can_ use RLHF or PPO).\n    \n*   The supervised fine-tuning loss integrates multiple components:\n    \n    *   A ranking loss over preference pairs to train the reward model,\n    *   A reasoning loss to predict intermediate tool-use steps,\n    *   An observation and rationale loss to improve interpretability:\n    \n    Ltotal\\=LRM+Œ±‚àët\\=1T(Ltool(t)+Œ≤Lobs(t))+œâLrationaleLtotal\\=LRM+Œ±‚àët\\=1T(Ltool(t)+Œ≤Lobs(t))+œâLrationale\n    \n    L\\_{\\\\text{total}} = L\\_{\\\\text{RM}} + \\\\alpha \\\\sum\\_{t=1}^{T} (L\\_{\\\\text{tool}}(t) + \\\\beta L\\_{\\\\text{obs}}(t)) + \\\\omega L\\_{\\\\text{rationale}}\n    \n    where\n    \n    *   LRMLRML\\_{\\\\text{RM}} is the preference-based ranking loss,\n    *   Ltool(t)Ltool(t)L\\_{\\\\text{tool}}(t) models tool selection accuracy,\n    *   Lobs(t)Lobs(t)L\\_{\\\\text{obs}}(t) aligns model predictions with observed tool outputs, and\n    *   LrationaleLrationaleL\\_{\\\\text{rationale}} encourages the generation of coherent explanations for reward assignments.\n*   This design enables Themis to be **interpretable and verifiable** without the instability of RL-based reward training. The authors note that RLHF or PPO can later be used to fine-tune the _policy_ against the SFT-trained Themis RM‚Äîbut not vice versa.\n    \n*   The following figure ([source](https://arxiv.org/abs/2310.01045)) shows illustrates the pipeline of (a) Vanilla reward models (RMs); (b) Tool-augmented RMs, namely Themis; (c) RL via proximal policy optimization (PPO) on above RMs; (d) Examples of single or multiple tool use process in the proposed approach.\n    \n\nThe training of the Themis reward model relies on **supervised fine-tuning (SFT)** rather than direct reinforcement learning. The RM is trained using **supervised imitation** of high-quality reasoning traces that demonstrate tool use and reward inference. This SFT stage helps the model learn to **invoke tools, interpret results, and assign scores** grounded in external evidence.\n\nImportantly, **reinforcement learning is _not_ used** to optimize the reward model itself‚ÄîThemis remains an _SFT-trained verifier_ that provides reward signals for downstream **policy optimization** (which _can_ use RLHF or PPO).\n\nThe supervised fine-tuning loss integrates multiple components:\n\n*   A ranking loss over preference pairs to train the reward model,\n*   A reasoning loss to predict intermediate tool-use steps,\n*   An observation and rationale loss to improve interpretability:\n\nwhere\n\n*   LRMLRML\\_{\\\\text{RM}} is the preference-based ranking loss,\n*   Ltool(t)Ltool(t)L\\_{\\\\text{tool}}(t) models tool selection accuracy,\n*   Lobs(t)Lobs(t)L\\_{\\\\text{obs}}(t) aligns model predictions with observed tool outputs, and\n*   LrationaleLrationaleL\\_{\\\\text{rationale}} encourages the generation of coherent explanations for reward assignments.\n\nThis design enables Themis to be **interpretable and verifiable** without the instability of RL-based reward training. The authors note that RLHF or PPO can later be used to fine-tune the _policy_ against the SFT-trained Themis RM‚Äîbut not vice versa.\n\nThe following figure ([source](https://arxiv.org/abs/2310.01045)) shows illustrates the pipeline of (a) Vanilla reward models (RMs); (b) Tool-augmented RMs, namely Themis; (c) RL via proximal policy optimization (PPO) on above RMs; (d) Examples of single or multiple tool use process in the proposed approach.\n\n![](/primers/ai/assets/RL-for-agents/Themis.jpg)\n\n#### Core Idea\n\n*   Conventional reward models in RLHF predict human preferences solely based on static textual input. Themis instead models reasoning as a **tool-augmented sequential decision process**. Given a prompt xxx and model response yyy, the reward model performs a multi-step reasoning trajectory c1:T\\=(a1,o1,‚Ä¶,aT,oT)c1:T\\=(a1,o1,‚Ä¶,aT,oT)c\\_{1:T} = (a\\_1, o\\_1, \\\\dots, a\\_T, o\\_T), where each atata\\_t is an action (thought or tool invocation) and ototo\\_t is the resulting observation.\n    \n*   The overall reward is represented as:\n    \n    rŒ∏(x,y,c1:T)rŒ∏(x,y,c1:T)\n    \n    r\\_\\\\theta(x, y, c\\_{1:T})\n*   ‚Ä¶ and optimized through a hybrid objective combining ranking and autoregressive reasoning losses:\n    \n    Ltotal\\=LRM+Œ±‚àët\\=1T(Ltool(t)+Œ≤Lobs(t))+œâLrationaleLtotal\\=LRM+Œ±‚àët\\=1T(Ltool(t)+Œ≤Lobs(t))+œâLrationale\n    \n    L\\_{\\\\text{total}} = L\\_{\\\\text{RM}} + \\\\alpha \\\\sum\\_{t=1}^{T} (L\\_{\\\\text{tool}}(t) + \\\\beta L\\_{\\\\text{obs}}(t)) + \\\\omega L\\_{\\\\text{rationale}}\n*   This enables the RM to learn both _what_ to reward and _how_ to reason about rewards using external evidence.\n    \n\nConventional reward models in RLHF predict human preferences solely based on static textual input. Themis instead models reasoning as a **tool-augmented sequential decision process**. Given a prompt xxx and model response yyy, the reward model performs a multi-step reasoning trajectory c1:T\\=(a1,o1,‚Ä¶,aT,oT)c1:T\\=(a1,o1,‚Ä¶,aT,oT)c\\_{1:T} = (a\\_1, o\\_1, \\\\dots, a\\_T, o\\_T), where each atata\\_t is an action (thought or tool invocation) and ototo\\_t is the resulting observation.\n\nThe overall reward is represented as:\n\n‚Ä¶ and optimized through a hybrid objective combining ranking and autoregressive reasoning losses:\n\nThis enables the RM to learn both _what_ to reward and _how_ to reason about rewards using external evidence.\n\n#### Mechanism\n\n1.  **Thought Generation:** The RM decides whether external information is required.\n2.  **Tool Invocation:** It dynamically selects a tool (e.g., Google, Calculator, Translator) and provides input arguments.\n3.  **Observation:** The model processes the tool‚Äôs output.\n4.  **Rationale and Reward:** It integrates the observations into a coherent rationale and outputs a scalar reward signal.\n\n*   This sequence creates a transparent reward pipeline, with interpretable reasoning traces linking tool use to reward assignment‚Äîenhancing trustworthiness and debuggability.\n\n#### Implementation\n\n*   Themis uses **Vicuna-7B** as the backbone and is fine-tuned via SFT on the **Tool-Augmented Reward Dataset (TARA)**‚Äîa 15k-instance corpus combining seven tool APIs and human-annotated rationales.\n*   The dataset construction pipeline includes: (i) collecting QA pairs, (ii) building a _ToolBank_ with APIs like Calculator, Weather, and WikiSearch, (iii) generating multi-agent tool-use trajectories via GPT-4 simulations, and (iv) filtering noise.\n*   In experiments, policies trained with Themis-based RMs outperform standard RMs by **17.7%** in preference ranking and achieve a **32% win rate** in human evaluations.\n\n#### Theoretical Framing\n\n*   Themis formalizes the reward inference as a reasoning trajectory:\n    \n    pŒ∏(c1:T|x,y)\\=‚àèt\\=1TpŒ∏(at|x,y,c<t),pŒ∏(ot|at)pŒ∏(c1:T|x,y)\\=‚àèt\\=1TpŒ∏(at|x,y,c<t),pŒ∏(ot|at)\n    \n    p\\_\\\\theta(c\\_{1:T} | x, y) = \\\\prod\\_{t=1}^{T} p\\_\\\\theta(a\\_t | x, y, c\\_{<t}) , p\\_\\\\theta(o\\_t | a\\_t)\n*   The scalar reward rŒ∏rŒ∏r\\_\\\\theta is derived from the terminal state sTsTs\\_T of this trajectory. The training objective encourages consistent ranking between correct and incorrect outputs via a contrastive loss:\n    \n    LRM\\=‚àíùîº(x,yw,yl)‚àºD\\[logœÉ(rŒ∏(x,yw)‚àírŒ∏(x,yl))\\]LRM\\=‚àíE(x,yw,yl)‚àºD\\[log‚Å°œÉ(rŒ∏(x,yw)‚àírŒ∏(x,yl))\\]\n    \n    L\\_{\\\\text{RM}} = -\\\\mathbb{E}\\_{(x, y\\_w, y\\_l) \\\\sim D} \\[\\\\log \\\\sigma(r\\_\\\\theta(x, y\\_w) - r\\_\\\\theta(x, y\\_l))\\]\n\nThemis formalizes the reward inference as a reasoning trajectory:\n\nThe scalar reward rŒ∏rŒ∏r\\_\\\\theta is derived from the terminal state sTsTs\\_T of this trajectory. The training objective encourages consistent ranking between correct and incorrect outputs via a contrastive loss:\n\n#### Conceptual Significance\n\n*   Themis reframes RLHF as _interactive reasoning optimization_: RMs are no longer passive preference predictors but **active verifiers** that reason and validate before rewarding.\n*   This bridges the gap between _verbal reasoning_ and _procedural verification_, grounding alignment in externally verifiable evidence rather than subjective preference scores.\n\n#### Related Work\n\n*   [ReAct](https://arxiv.org/abs/2210.03629) by Yao et al. (2022): integrates reasoning and action for tool use.\n*   [Chain-of-Thought](https://arxiv.org/abs/2201.11903) by Wei et al. (2022): scaffolds step-by-step reasoning.\n*   [InstructGPT](https://arxiv.org/abs/2203.02155) by Ouyang et al. (2022): establishes RLHF‚Äôs preference-based optimization paradigm.\n*   Themis extends these by adding **tool-augmented reasoning** and **interpretable reward generation**‚Äîa move toward verifiable and grounded alignment.",
    "order": 22,
    "orderInChapter": 4,
    "difficulty": 4,
    "estimatedMinutes": 6,
    "tags": [
      "nlpllms",
      "gpt",
      "reinforcement learning",
      "optimization",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 1185,
      "contentLength": 115358
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#tool-augmented-reward-modeling-(themis)",
    "scrapedAt": "2025-12-28T11:54:00.656Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-tool-learning-with-foundation-models-23",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Reinforcement Learning-Based Reasoning",
    "title": "Tool Learning with Foundation Models",
    "subtitle": "Reinforcement Learning-Based Reasoning",
    "contentHtml": "<ul>\n  <li>The paper <a href=\"https://doi.org/10.1145/3704435\">Tool Learning with Foundation Models</a> by Qin et al. (2024) provides a comprehensive survey of how large foundation models acquire, use, and reason with tools‚Äîsituating RL within a broader <em>tool-augmented reasoning paradigm</em>. It systematically maps out how reinforcement-based optimization interacts with external APIs, environments, and feedback mechanisms to enable verifiable reasoning and decision-making across domains.</li>\n</ul>\n<h4 id=\"core-idea-11\">Core Idea</h4>\n<ul>\n  <li>\n    <p>Tool learning expands the scope of reasoning beyond static text generation to <strong>interactive environments</strong>, where a foundation model acts as a <em>controller</em> that plans, executes, and refines multi-step tool usage. In this formulation, the model transitions between reasoning (thought generation) and acting (tool invocation), with each action influenced by rewards or feedback signals derived from tool outcomes or human evaluation.</p>\n  </li>\n  <li>\n    <p>Formally, tool learning is modeled as a <strong>closed feedback loop</strong>:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-243-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>Reason</mtext><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mtext>Act (via tools)</mtext><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mtext>Observe</mtext><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mtext>Reward</mtext><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mtext>Refine</mtext></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3890\" style=\"width: 29.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 24.273em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1024.27em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3891\"><span class=\"mtext\" id=\"MathJax-Span-3892\" style=\"font-family: STIXGeneral-Regular;\">Reason</span><span class=\"mo\" id=\"MathJax-Span-3893\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"mtext\" id=\"MathJax-Span-3894\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">Act (via tools)</span><span class=\"mo\" id=\"MathJax-Span-3895\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"mtext\" id=\"MathJax-Span-3896\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">Observe</span><span class=\"mo\" id=\"MathJax-Span-3897\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"mtext\" id=\"MathJax-Span-3898\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">Reward</span><span class=\"mo\" id=\"MathJax-Span-3899\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üí</span><span class=\"mtext\" id=\"MathJax-Span-3900\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">Refine</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mtext>Reason</mtext><mo stretchy=\"false\">‚Üí</mo><mtext>Act (via tools)</mtext><mo stretchy=\"false\">‚Üí</mo><mtext>Observe</mtext><mo stretchy=\"false\">‚Üí</mo><mtext>Reward</mtext><mo stretchy=\"false\">‚Üí</mo><mtext>Refine</mtext></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-243\">\\text{Reason} \\rightarrow \\text{Act (via tools)} \\rightarrow \\text{Observe} \\rightarrow \\text{Reward} \\rightarrow \\text{Refine}</script>\n\n    <ul>\n      <li>which aligns conceptually with RL-based reasoning frameworks like <a href=\"https://arxiv.org/abs/2310.01045\">Themis</a> by Li et al. (2024) and <a href=\"https://arxiv.org/abs/2501.12948\">DeepSeek-R1</a> by Guo et al. (2025).</li>\n    </ul>\n  </li>\n  <li>This structure transforms reasoning from an open-loop (text-only) system into a <em>closed cognitive loop</em> where every inference can be externally verified.</li>\n  <li>The following figure shows (<a href=\"https://doi.org/10.1145/3704435\">source</a>) the <em>conceptual overview of tool learning with foundation models</em>, where models dynamically decide when and how to invoke tools such as web search and other APIs to solve complex problems.</li>\n</ul>\n<p>Tool learning expands the scope of reasoning beyond static text generation to <strong>interactive environments</strong>, where a foundation model acts as a <em>controller</em> that plans, executes, and refines multi-step tool usage. In this formulation, the model transitions between reasoning (thought generation) and acting (tool invocation), with each action influenced by rewards or feedback signals derived from tool outcomes or human evaluation.</p>\n<p>Formally, tool learning is modeled as a <strong>closed feedback loop</strong>:</p>\n<ul>\n      <li>which aligns conceptually with RL-based reasoning frameworks like <a href=\"https://arxiv.org/abs/2310.01045\">Themis</a> by Li et al. (2024) and <a href=\"https://arxiv.org/abs/2501.12948\">DeepSeek-R1</a> by Guo et al. (2025).</li>\n    </ul>\n<p><img src=\"/primers/ai/assets/RL-for-agents/ToolLearningOverview.jpg\" alt=\"\"></p>\n<h4 id=\"mechanism-and-architecture\">Mechanism and Architecture</h4>\n<ul>\n  <li>\n    <p>Qin et al. describe tool learning as a <strong>three-layer cognitive stack</strong> integrated into the foundation model framework:</p>\n\n    <ol>\n      <li><strong>Planning Layer:</strong>\n        <ul>\n          <li>Generates high-level reasoning plans or subgoals based on input context.</li>\n          <li>Example: ‚ÄúTo answer this, I should retrieve relevant information and perform a computation.‚Äù</li>\n        </ul>\n      </li>\n      <li><strong>Tool Invocation Layer:</strong>\n        <ul>\n          <li>Translates plans into executable tool calls‚Äîe.g., invoking a Python interpreter, SQL engine, search API, or code execution module.</li>\n          <li>This layer operationalizes <em>action selection</em>, analogous to a policy in RL.</li>\n        </ul>\n      </li>\n      <li><strong>Feedback and Adaptation Layer:</strong>\n        <ul>\n          <li>Aggregates results, evaluates correctness, and provides reinforcement signals to refine the next cycle of planning.</li>\n          <li>The reward function combines correctness, efficiency, and tool-use cost:</li>\n        </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-244-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>R</mi><mo>=</mo><mi>&amp;#x03B1;</mi><mo>&amp;#x22C5;</mo><mtext>Accuracy</mtext><mo>+</mo><mi>&amp;#x03B2;</mi><mo>&amp;#x22C5;</mo><mtext>Relevance</mtext><mo>&amp;#x2212;</mo><mi>&amp;#x03B3;</mi><mo>&amp;#x22C5;</mo><mtext>Cost(tool use)</mtext><mo>.</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3901\" style=\"width: 27.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 22.555em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1022.5em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3902\"><span class=\"mi\" id=\"MathJax-Span-3903\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-3904\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3905\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œ±</span><span class=\"mo\" id=\"MathJax-Span-3906\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚ãÖ</span><span class=\"mtext\" id=\"MathJax-Span-3907\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">Accuracy</span><span class=\"mo\" id=\"MathJax-Span-3908\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3909\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3910\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚ãÖ</span><span class=\"mtext\" id=\"MathJax-Span-3911\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">Relevance</span><span class=\"mo\" id=\"MathJax-Span-3912\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-3913\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3914\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚ãÖ</span><span class=\"mtext\" id=\"MathJax-Span-3915\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">Cost(tool use)</span><span class=\"mo\" id=\"MathJax-Span-3916\" style=\"font-family: STIXGeneral-Regular;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>R</mi><mo>=</mo><mi>Œ±</mi><mo>‚ãÖ</mo><mtext>Accuracy</mtext><mo>+</mo><mi>Œ≤</mi><mo>‚ãÖ</mo><mtext>Relevance</mtext><mo>‚àí</mo><mi>Œ≥</mi><mo>‚ãÖ</mo><mtext>Cost(tool use)</mtext><mo>.</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-244\">R = \\alpha \\cdot \\text{Accuracy} + \\beta \\cdot \\text{Relevance} - \\gamma \\cdot \\text{Cost(tool use)}.</script>\n      </li>\n    </ol>\n  </li>\n  <li>\n    <p>This structure mirrors RL‚Äôs goal of <strong>policy optimization over reasoning trajectories</strong>, but within a modular, interpretable agentic architecture.</p>\n  </li>\n</ul>\n<p>Qin et al. describe tool learning as a <strong>three-layer cognitive stack</strong> integrated into the foundation model framework:</p>\n<ol>\n      <li><strong>Planning Layer:</strong>\n        <ul>\n          <li>Generates high-level reasoning plans or subgoals based on input context.</li>\n          <li>Example: ‚ÄúTo answer this, I should retrieve relevant information and perform a computation.‚Äù</li>\n        </ul>\n      </li>\n      <li><strong>Tool Invocation Layer:</strong>\n        <ul>\n          <li>Translates plans into executable tool calls‚Äîe.g., invoking a Python interpreter, SQL engine, search API, or code execution module.</li>\n          <li>This layer operationalizes <em>action selection</em>, analogous to a policy in RL.</li>\n        </ul>\n      </li>\n      <li><strong>Feedback and Adaptation Layer:</strong>\n        <ul>\n          <li>Aggregates results, evaluates correctness, and provides reinforcement signals to refine the next cycle of planning.</li>\n          <li>The reward function combines correctness, efficiency, and tool-use cost:</li>\n        </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-244-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>R</mi><mo>=</mo><mi>&amp;#x03B1;</mi><mo>&amp;#x22C5;</mo><mtext>Accuracy</mtext><mo>+</mo><mi>&amp;#x03B2;</mi><mo>&amp;#x22C5;</mo><mtext>Relevance</mtext><mo>&amp;#x2212;</mo><mi>&amp;#x03B3;</mi><mo>&amp;#x22C5;</mo><mtext>Cost(tool use)</mtext><mo>.</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3901\" style=\"width: 27.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 22.555em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1022.5em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3902\"><span class=\"mi\" id=\"MathJax-Span-3903\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-3904\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3905\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œ±</span><span class=\"mo\" id=\"MathJax-Span-3906\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚ãÖ</span><span class=\"mtext\" id=\"MathJax-Span-3907\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">Accuracy</span><span class=\"mo\" id=\"MathJax-Span-3908\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3909\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3910\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚ãÖ</span><span class=\"mtext\" id=\"MathJax-Span-3911\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">Relevance</span><span class=\"mo\" id=\"MathJax-Span-3912\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-3913\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3914\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚ãÖ</span><span class=\"mtext\" id=\"MathJax-Span-3915\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">Cost(tool use)</span><span class=\"mo\" id=\"MathJax-Span-3916\" style=\"font-family: STIXGeneral-Regular;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>R</mi><mo>=</mo><mi>Œ±</mi><mo>‚ãÖ</mo><mtext>Accuracy</mtext><mo>+</mo><mi>Œ≤</mi><mo>‚ãÖ</mo><mtext>Relevance</mtext><mo>‚àí</mo><mi>Œ≥</mi><mo>‚ãÖ</mo><mtext>Cost(tool use)</mtext><mo>.</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-244\">R = \\alpha \\cdot \\text{Accuracy} + \\beta \\cdot \\text{Relevance} - \\gamma \\cdot \\text{Cost(tool use)}.</script>\n      </li>\n    </ol>\n<ul>\n          <li>Generates high-level reasoning plans or subgoals based on input context.</li>\n          <li>Example: ‚ÄúTo answer this, I should retrieve relevant information and perform a computation.‚Äù</li>\n        </ul>\n<ul>\n          <li>Translates plans into executable tool calls‚Äîe.g., invoking a Python interpreter, SQL engine, search API, or code execution module.</li>\n          <li>This layer operationalizes <em>action selection</em>, analogous to a policy in RL.</li>\n        </ul>\n<ul>\n          <li>Aggregates results, evaluates correctness, and provides reinforcement signals to refine the next cycle of planning.</li>\n          <li>The reward function combines correctness, efficiency, and tool-use cost:</li>\n        </ul>\n<p>This structure mirrors RL‚Äôs goal of <strong>policy optimization over reasoning trajectories</strong>, but within a modular, interpretable agentic architecture.</p>\n<h4 id=\"implementation-and-evaluation\">Implementation and Evaluation</h4>\n<ul>\n  <li>\n    <p>The survey compiles empirical frameworks where RL-based reasoning interacts with tool environments:</p>\n\n    <ul>\n      <li><strong>ReAct framework</strong> (<a href=\"https://arxiv.org/abs/2210.03629\">Yao et al., 2022</a>) couples reasoning steps with external actions (e.g., web search, calculators).</li>\n      <li><strong>Toolformer</strong> (<a href=\"https://arxiv.org/abs/2302.04761\">Schick et al., 2023</a>) fine-tunes LLMs to decide when to use APIs by self-generating tool-usage data.</li>\n      <li><strong>CodeRL</strong> (<a href=\"https://arxiv.org/abs/2207.01780\">Le et al., 2022</a>) applies RL to improve code reasoning and debugging performance.</li>\n      <li><strong>Themis</strong> (<a href=\"https://arxiv.org/abs/2310.01045\">Li et al., 2024</a>) explicitly integrates tool interactions into reward modeling for verifiable reasoning.</li>\n      <li><strong>AutoGPT and related systems</strong> (<a href=\"https://github.com/Torant/AutoGPT\">Torant et al., 2023</a>) demonstrate autonomous chaining of reasoning‚Äìaction loops in open environments.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Collectively, these systems embody what Qin et al. term <strong>‚Äútool-augmented cognition‚Äù</strong>, where reasoning policies emerge from interaction, reflection, and correction rather than static imitation.</p>\n  </li>\n</ul>\n<p>The survey compiles empirical frameworks where RL-based reasoning interacts with tool environments:</p>\n<ul>\n      <li><strong>ReAct framework</strong> (<a href=\"https://arxiv.org/abs/2210.03629\">Yao et al., 2022</a>) couples reasoning steps with external actions (e.g., web search, calculators).</li>\n      <li><strong>Toolformer</strong> (<a href=\"https://arxiv.org/abs/2302.04761\">Schick et al., 2023</a>) fine-tunes LLMs to decide when to use APIs by self-generating tool-usage data.</li>\n      <li><strong>CodeRL</strong> (<a href=\"https://arxiv.org/abs/2207.01780\">Le et al., 2022</a>) applies RL to improve code reasoning and debugging performance.</li>\n      <li><strong>Themis</strong> (<a href=\"https://arxiv.org/abs/2310.01045\">Li et al., 2024</a>) explicitly integrates tool interactions into reward modeling for verifiable reasoning.</li>\n      <li><strong>AutoGPT and related systems</strong> (<a href=\"https://github.com/Torant/AutoGPT\">Torant et al., 2023</a>) demonstrate autonomous chaining of reasoning‚Äìaction loops in open environments.</li>\n    </ul>\n<p>Collectively, these systems embody what Qin et al. term <strong>‚Äútool-augmented cognition‚Äù</strong>, where reasoning policies emerge from interaction, reflection, and correction rather than static imitation.</p>\n<h4 id=\"theoretical-framing-7\">Theoretical Framing</h4>\n<ul>\n  <li>\n    <p>The survey situates tool learning within the RL framework by drawing analogies between policy optimization and reasoning adaptation. Given an environment <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-245-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3917\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3918\"><span class=\"mi\" id=\"MathJax-Span-3919\" style=\"font-family: STIXGeneral-Italic;\">E<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>E</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-245\">E</script> with a set of tools <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-246-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3920\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.94em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3921\"><span class=\"texatom\" id=\"MathJax-Span-3922\"><span class=\"mrow\" id=\"MathJax-Span-3923\"><span class=\"mi\" id=\"MathJax-Span-3924\" style=\"font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.211em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-246\">\\mathcal{T}</script>, a model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-247-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3925\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3926\"><span class=\"msubsup\" id=\"MathJax-Span-3927\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3928\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3929\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-247\">\\pi_\\theta</script> optimizes:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-248-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>J</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>a</mi><mo>,</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow><mo>,</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3930\" style=\"width: 15.003em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.503em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1012.45em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3931\"><span class=\"texatom\" id=\"MathJax-Span-3932\"><span class=\"mrow\" id=\"MathJax-Span-3933\"><span class=\"mi\" id=\"MathJax-Span-3934\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∂<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3935\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3936\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3937\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3938\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3939\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.169em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3940\"><span class=\"mrow\" id=\"MathJax-Span-3941\"><span class=\"mi\" id=\"MathJax-Span-3942\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3943\"><span class=\"mrow\" id=\"MathJax-Span-3944\"><span class=\"mo\" id=\"MathJax-Span-3945\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3946\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3947\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3948\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-3949\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3950\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3951\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-3952\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3953\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.216em; left: 0.263em;\"><span class=\"mo\" id=\"MathJax-Span-3954\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3955\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3956\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"texatom\" id=\"MathJax-Span-3957\"><span class=\"mrow\" id=\"MathJax-Span-3958\"><span class=\"mi\" id=\"MathJax-Span-3959\" style=\"font-size: 70.7%; font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3960\"><span class=\"mrow\" id=\"MathJax-Span-3961\"><span class=\"mo\" id=\"MathJax-Span-3962\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-3963\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-3964\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3965\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3966\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3967\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-3968\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-3969\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3970\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-3971\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3972\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-3973\"><span class=\"mrow\" id=\"MathJax-Span-3974\"><span class=\"mo\" id=\"MathJax-Span-3975\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3976\" style=\"font-family: STIXGeneral-Regular;\">,</span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">J</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo><mo>‚àº</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mi>R</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>a</mi><mo>,</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow><mo>,</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-248\">\\mathcal{J}(\\theta) = \\mathbb{E}_{(x, a, r, s') \\sim \\mathcal{T}} \\big[ R(x, a, s') \\big],</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-249-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3977\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3978\"><span class=\"mi\" id=\"MathJax-Span-3979\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-249\">a</script> corresponds to the tool action, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-250-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3980\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1000.73em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3981\"><span class=\"msup\" id=\"MathJax-Span-3982\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3983\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-3984\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>s</mi><mo>‚Ä≤</mo></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-250\">s'</script> represents the post-tool reasoning state.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The loop parallels model-based RL, where <em>tools serve as environment transitions</em> and <em>reasoning traces serve as trajectories</em>.</p>\n  </li>\n  <li>\n    <p>This reframing positions LLMs as <strong>general-purpose policy optimizers</strong> over heterogeneous environments‚Äîbridging symbolic reasoning, API orchestration, and human feedback alignment.</p>\n  </li>\n</ul>\n<p>The survey situates tool learning within the RL framework by drawing analogies between policy optimization and reasoning adaptation. Given an environment <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-245-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3917\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3918\"><span class=\"mi\" id=\"MathJax-Span-3919\" style=\"font-family: STIXGeneral-Italic;\">E<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>E</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-245\">E</script> with a set of tools <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-246-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>T</mi></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3920\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.94em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3921\"><span class=\"texatom\" id=\"MathJax-Span-3922\"><span class=\"mrow\" id=\"MathJax-Span-3923\"><span class=\"mi\" id=\"MathJax-Span-3924\" style=\"font-family: STIXNonUnicode-Italic;\">ÓâÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.211em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">T</mi></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-246\">\\mathcal{T}</script>, a model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-247-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3925\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3926\"><span class=\"msubsup\" id=\"MathJax-Span-3927\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3928\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3929\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-247\">\\pi_\\theta</script> optimizes:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-249-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3977\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3978\"><span class=\"mi\" id=\"MathJax-Span-3979\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-249\">a</script> corresponds to the tool action, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-250-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3980\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1000.73em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3981\"><span class=\"msup\" id=\"MathJax-Span-3982\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3983\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-3984\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>s</mi><mo>‚Ä≤</mo></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-250\">s'</script> represents the post-tool reasoning state.</li>\n    </ul>\n<p>The loop parallels model-based RL, where <em>tools serve as environment transitions</em> and <em>reasoning traces serve as trajectories</em>.</p>\n<p>This reframing positions LLMs as <strong>general-purpose policy optimizers</strong> over heterogeneous environments‚Äîbridging symbolic reasoning, API orchestration, and human feedback alignment.</p>\n<h4 id=\"challenges-and-open-problems\">Challenges and Open Problems</h4>\n<ul>\n  <li>\n    <p>Qin et al. identify key challenges in tool-integrated RL for reasoning:</p>\n\n    <ol>\n      <li><strong>Credit Assignment:</strong> Determining which tool interaction contributed most to final success.</li>\n      <li><strong>Exploration Efficiency:</strong> Balancing costly tool calls with information gain.</li>\n      <li><strong>Reward Design:</strong> Developing automatic, verifiable scoring mechanisms (e.g., verifiers, critics, self-evaluators).</li>\n      <li><strong>Safety and Trustworthiness:</strong> Ensuring reliable, interpretable tool use, especially in high-stakes domains like healthcare or finance.</li>\n      <li><strong>Generalization:</strong> Training models that can adapt to unseen tools or APIs without re-optimization.</li>\n    </ol>\n  </li>\n</ul>\n<p>Qin et al. identify key challenges in tool-integrated RL for reasoning:</p>\n<ol>\n      <li><strong>Credit Assignment:</strong> Determining which tool interaction contributed most to final success.</li>\n      <li><strong>Exploration Efficiency:</strong> Balancing costly tool calls with information gain.</li>\n      <li><strong>Reward Design:</strong> Developing automatic, verifiable scoring mechanisms (e.g., verifiers, critics, self-evaluators).</li>\n      <li><strong>Safety and Trustworthiness:</strong> Ensuring reliable, interpretable tool use, especially in high-stakes domains like healthcare or finance.</li>\n      <li><strong>Generalization:</strong> Training models that can adapt to unseen tools or APIs without re-optimization.</li>\n    </ol>\n<h4 id=\"conceptual-significance-1\">Conceptual Significance</h4>\n<ul>\n  <li>\n    <p>By synthesizing over 200 papers across AI, NLP, and robotics, <em>Tool Learning with Foundation Models</em> establishes <strong>tool-augmented reasoning</strong> as a unifying theme linking RL, reasoning, and alignment. The framework clarifies how reinforcement signals, tool feedback, and self-reflection together create <em>grounded intelligence</em>‚Äîwhere reasoning is both <strong>goal-driven</strong> and <strong>externally verifiable</strong>.</p>\n  </li>\n  <li>\n    <p>In the context of RL-based reasoning, the paper serves as a bridge between empirical advances like <em>Themis</em> and theoretical RL control principles, emphasizing that <em>tools are not add-ons but core operators in the reasoning policy loop</em>.</p>\n  </li>\n</ul>\n<p>By synthesizing over 200 papers across AI, NLP, and robotics, <em>Tool Learning with Foundation Models</em> establishes <strong>tool-augmented reasoning</strong> as a unifying theme linking RL, reasoning, and alignment. The framework clarifies how reinforcement signals, tool feedback, and self-reflection together create <em>grounded intelligence</em>‚Äîwhere reasoning is both <strong>goal-driven</strong> and <strong>externally verifiable</strong>.</p>\n<p>In the context of RL-based reasoning, the paper serves as a bridge between empirical advances like <em>Themis</em> and theoretical RL control principles, emphasizing that <em>tools are not add-ons but core operators in the reasoning policy loop</em>.</p>",
    "contentMarkdown": "*   The paper [Tool Learning with Foundation Models](https://doi.org/10.1145/3704435) by Qin et al. (2024) provides a comprehensive survey of how large foundation models acquire, use, and reason with tools‚Äîsituating RL within a broader _tool-augmented reasoning paradigm_. It systematically maps out how reinforcement-based optimization interacts with external APIs, environments, and feedback mechanisms to enable verifiable reasoning and decision-making across domains.\n\n#### Core Idea\n\n*   Tool learning expands the scope of reasoning beyond static text generation to **interactive environments**, where a foundation model acts as a _controller_ that plans, executes, and refines multi-step tool usage. In this formulation, the model transitions between reasoning (thought generation) and acting (tool invocation), with each action influenced by rewards or feedback signals derived from tool outcomes or human evaluation.\n    \n*   Formally, tool learning is modeled as a **closed feedback loop**:\n    \n    Reason‚ÜíAct (via tools)‚ÜíObserve‚ÜíReward‚ÜíRefineReason‚ÜíAct (via tools)‚ÜíObserve‚ÜíReward‚ÜíRefine\n    \n    \\\\text{Reason} \\\\rightarrow \\\\text{Act (via tools)} \\\\rightarrow \\\\text{Observe} \\\\rightarrow \\\\text{Reward} \\\\rightarrow \\\\text{Refine}\n    *   which aligns conceptually with RL-based reasoning frameworks like [Themis](https://arxiv.org/abs/2310.01045) by Li et al. (2024) and [DeepSeek-R1](https://arxiv.org/abs/2501.12948) by Guo et al. (2025).\n*   This structure transforms reasoning from an open-loop (text-only) system into a _closed cognitive loop_ where every inference can be externally verified.\n*   The following figure shows ([source](https://doi.org/10.1145/3704435)) the _conceptual overview of tool learning with foundation models_, where models dynamically decide when and how to invoke tools such as web search and other APIs to solve complex problems.\n\nTool learning expands the scope of reasoning beyond static text generation to **interactive environments**, where a foundation model acts as a _controller_ that plans, executes, and refines multi-step tool usage. In this formulation, the model transitions between reasoning (thought generation) and acting (tool invocation), with each action influenced by rewards or feedback signals derived from tool outcomes or human evaluation.\n\nFormally, tool learning is modeled as a **closed feedback loop**:\n\n*   which aligns conceptually with RL-based reasoning frameworks like [Themis](https://arxiv.org/abs/2310.01045) by Li et al. (2024) and [DeepSeek-R1](https://arxiv.org/abs/2501.12948) by Guo et al. (2025).\n\n![](/primers/ai/assets/RL-for-agents/ToolLearningOverview.jpg)\n\n#### Mechanism and Architecture\n\n*   Qin et al. describe tool learning as a **three-layer cognitive stack** integrated into the foundation model framework:\n    \n    1.  **Planning Layer:**\n        *   Generates high-level reasoning plans or subgoals based on input context.\n        *   Example: ‚ÄúTo answer this, I should retrieve relevant information and perform a computation.‚Äù\n    2.  **Tool Invocation Layer:**\n        *   Translates plans into executable tool calls‚Äîe.g., invoking a Python interpreter, SQL engine, search API, or code execution module.\n        *   This layer operationalizes _action selection_, analogous to a policy in RL.\n    3.  **Feedback and Adaptation Layer:**\n        \n        *   Aggregates results, evaluates correctness, and provides reinforcement signals to refine the next cycle of planning.\n        *   The reward function combines correctness, efficiency, and tool-use cost:\n        \n        R\\=Œ±‚ãÖAccuracy+Œ≤‚ãÖRelevance‚àíŒ≥‚ãÖCost(tool use).R\\=Œ±‚ãÖAccuracy+Œ≤‚ãÖRelevance‚àíŒ≥‚ãÖCost(tool use).\n        \n        R = \\\\alpha \\\\cdot \\\\text{Accuracy} + \\\\beta \\\\cdot \\\\text{Relevance} - \\\\gamma \\\\cdot \\\\text{Cost(tool use)}.\n*   This structure mirrors RL‚Äôs goal of **policy optimization over reasoning trajectories**, but within a modular, interpretable agentic architecture.\n    \n\nQin et al. describe tool learning as a **three-layer cognitive stack** integrated into the foundation model framework:\n\n1.  **Planning Layer:**\n    *   Generates high-level reasoning plans or subgoals based on input context.\n    *   Example: ‚ÄúTo answer this, I should retrieve relevant information and perform a computation.‚Äù\n2.  **Tool Invocation Layer:**\n    *   Translates plans into executable tool calls‚Äîe.g., invoking a Python interpreter, SQL engine, search API, or code execution module.\n    *   This layer operationalizes _action selection_, analogous to a policy in RL.\n3.  **Feedback and Adaptation Layer:**\n    \n    *   Aggregates results, evaluates correctness, and provides reinforcement signals to refine the next cycle of planning.\n    *   The reward function combines correctness, efficiency, and tool-use cost:\n    \n    R\\=Œ±‚ãÖAccuracy+Œ≤‚ãÖRelevance‚àíŒ≥‚ãÖCost(tool use).R\\=Œ±‚ãÖAccuracy+Œ≤‚ãÖRelevance‚àíŒ≥‚ãÖCost(tool use).\n    \n    R = \\\\alpha \\\\cdot \\\\text{Accuracy} + \\\\beta \\\\cdot \\\\text{Relevance} - \\\\gamma \\\\cdot \\\\text{Cost(tool use)}.\n\n*   Generates high-level reasoning plans or subgoals based on input context.\n*   Example: ‚ÄúTo answer this, I should retrieve relevant information and perform a computation.‚Äù\n\n*   Translates plans into executable tool calls‚Äîe.g., invoking a Python interpreter, SQL engine, search API, or code execution module.\n*   This layer operationalizes _action selection_, analogous to a policy in RL.\n\n*   Aggregates results, evaluates correctness, and provides reinforcement signals to refine the next cycle of planning.\n*   The reward function combines correctness, efficiency, and tool-use cost:\n\nThis structure mirrors RL‚Äôs goal of **policy optimization over reasoning trajectories**, but within a modular, interpretable agentic architecture.\n\n#### Implementation and Evaluation\n\n*   The survey compiles empirical frameworks where RL-based reasoning interacts with tool environments:\n    \n    *   **ReAct framework** ([Yao et al., 2022](https://arxiv.org/abs/2210.03629)) couples reasoning steps with external actions (e.g., web search, calculators).\n    *   **Toolformer** ([Schick et al., 2023](https://arxiv.org/abs/2302.04761)) fine-tunes LLMs to decide when to use APIs by self-generating tool-usage data.\n    *   **CodeRL** ([Le et al., 2022](https://arxiv.org/abs/2207.01780)) applies RL to improve code reasoning and debugging performance.\n    *   **Themis** ([Li et al., 2024](https://arxiv.org/abs/2310.01045)) explicitly integrates tool interactions into reward modeling for verifiable reasoning.\n    *   **AutoGPT and related systems** ([Torant et al., 2023](https://github.com/Torant/AutoGPT)) demonstrate autonomous chaining of reasoning‚Äìaction loops in open environments.\n*   Collectively, these systems embody what Qin et al. term **‚Äútool-augmented cognition‚Äù**, where reasoning policies emerge from interaction, reflection, and correction rather than static imitation.\n    \n\nThe survey compiles empirical frameworks where RL-based reasoning interacts with tool environments:\n\n*   **ReAct framework** ([Yao et al., 2022](https://arxiv.org/abs/2210.03629)) couples reasoning steps with external actions (e.g., web search, calculators).\n*   **Toolformer** ([Schick et al., 2023](https://arxiv.org/abs/2302.04761)) fine-tunes LLMs to decide when to use APIs by self-generating tool-usage data.\n*   **CodeRL** ([Le et al., 2022](https://arxiv.org/abs/2207.01780)) applies RL to improve code reasoning and debugging performance.\n*   **Themis** ([Li et al., 2024](https://arxiv.org/abs/2310.01045)) explicitly integrates tool interactions into reward modeling for verifiable reasoning.\n*   **AutoGPT and related systems** ([Torant et al., 2023](https://github.com/Torant/AutoGPT)) demonstrate autonomous chaining of reasoning‚Äìaction loops in open environments.\n\nCollectively, these systems embody what Qin et al. term **‚Äútool-augmented cognition‚Äù**, where reasoning policies emerge from interaction, reflection, and correction rather than static imitation.\n\n#### Theoretical Framing\n\n*   The survey situates tool learning within the RL framework by drawing analogies between policy optimization and reasoning adaptation. Given an environment EEE with a set of tools ÓâÄT\\\\mathcal{T}, a model œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta optimizes:\n    \n    Óà∂(Œ∏)\\=ùîº(x,a,r,s‚Ä≤)‚àºÓâÄ\\[R(x,a,s‚Ä≤)\\],J(Œ∏)\\=E(x,a,r,s‚Ä≤)‚àºT\\[R(x,a,s‚Ä≤)\\],\n    \n    \\\\mathcal{J}(\\\\theta) = \\\\mathbb{E}\\_{(x, a, r, s') \\\\sim \\\\mathcal{T}} \\\\big\\[ R(x, a, s') \\\\big\\],\n    *   where aaa corresponds to the tool action, and s‚Ä≤s‚Ä≤s' represents the post-tool reasoning state.\n*   The loop parallels model-based RL, where _tools serve as environment transitions_ and _reasoning traces serve as trajectories_.\n    \n*   This reframing positions LLMs as **general-purpose policy optimizers** over heterogeneous environments‚Äîbridging symbolic reasoning, API orchestration, and human feedback alignment.\n    \n\nThe survey situates tool learning within the RL framework by drawing analogies between policy optimization and reasoning adaptation. Given an environment EEE with a set of tools ÓâÄT\\\\mathcal{T}, a model œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta optimizes:\n\n*   where aaa corresponds to the tool action, and s‚Ä≤s‚Ä≤s' represents the post-tool reasoning state.\n\nThe loop parallels model-based RL, where _tools serve as environment transitions_ and _reasoning traces serve as trajectories_.\n\nThis reframing positions LLMs as **general-purpose policy optimizers** over heterogeneous environments‚Äîbridging symbolic reasoning, API orchestration, and human feedback alignment.\n\n#### Challenges and Open Problems\n\n*   Qin et al. identify key challenges in tool-integrated RL for reasoning:\n    \n    1.  **Credit Assignment:** Determining which tool interaction contributed most to final success.\n    2.  **Exploration Efficiency:** Balancing costly tool calls with information gain.\n    3.  **Reward Design:** Developing automatic, verifiable scoring mechanisms (e.g., verifiers, critics, self-evaluators).\n    4.  **Safety and Trustworthiness:** Ensuring reliable, interpretable tool use, especially in high-stakes domains like healthcare or finance.\n    5.  **Generalization:** Training models that can adapt to unseen tools or APIs without re-optimization.\n\nQin et al. identify key challenges in tool-integrated RL for reasoning:\n\n1.  **Credit Assignment:** Determining which tool interaction contributed most to final success.\n2.  **Exploration Efficiency:** Balancing costly tool calls with information gain.\n3.  **Reward Design:** Developing automatic, verifiable scoring mechanisms (e.g., verifiers, critics, self-evaluators).\n4.  **Safety and Trustworthiness:** Ensuring reliable, interpretable tool use, especially in high-stakes domains like healthcare or finance.\n5.  **Generalization:** Training models that can adapt to unseen tools or APIs without re-optimization.\n\n#### Conceptual Significance\n\n*   By synthesizing over 200 papers across AI, NLP, and robotics, _Tool Learning with Foundation Models_ establishes **tool-augmented reasoning** as a unifying theme linking RL, reasoning, and alignment. The framework clarifies how reinforcement signals, tool feedback, and self-reflection together create _grounded intelligence_‚Äîwhere reasoning is both **goal-driven** and **externally verifiable**.\n    \n*   In the context of RL-based reasoning, the paper serves as a bridge between empirical advances like _Themis_ and theoretical RL control principles, emphasizing that _tools are not add-ons but core operators in the reasoning policy loop_.\n    \n\nBy synthesizing over 200 papers across AI, NLP, and robotics, _Tool Learning with Foundation Models_ establishes **tool-augmented reasoning** as a unifying theme linking RL, reasoning, and alignment. The framework clarifies how reinforcement signals, tool feedback, and self-reflection together create _grounded intelligence_‚Äîwhere reasoning is both **goal-driven** and **externally verifiable**.\n\nIn the context of RL-based reasoning, the paper serves as a bridge between empirical advances like _Themis_ and theoretical RL control principles, emphasizing that _tools are not add-ons but core operators in the reasoning policy loop_.",
    "order": 23,
    "orderInChapter": 5,
    "difficulty": 4,
    "estimatedMinutes": 8,
    "tags": [
      "nlpllms",
      "gpt",
      "llm",
      "nlp",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 1465,
      "contentLength": 48381
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#tool-learning-with-foundation-models",
    "scrapedAt": "2025-12-28T11:54:00.656Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-the-deepseek-r1-perspective-24",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "The ‚ÄúAha‚Äù Moment and Emergent Reasoning",
    "title": "The DeepSeek-R1 Perspective",
    "subtitle": "The ‚ÄúAha‚Äù Moment and Emergent Reasoning",
    "contentHtml": "<ul>\n  <li>\n    <p>DeepSeek-R1 conceptualizes the ‚ÄúAha‚Äù moment as a <strong>policy-level transition</strong> in the reasoning dynamics of the model. During early RL training, the model‚Äôs outputs are dominated by shallow heuristics‚Äîlocally coherent but globally inconsistent reasoning chains. As reinforcement updates accumulate, the model begins to exploit verifiable reward structure: it learns that <strong>structured reasoning trajectories</strong> yield higher expected reward.</p>\n  </li>\n  <li>\n    <p>Formally, given a problem input <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-251-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3985\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3986\"><span class=\"mi\" id=\"MathJax-Span-3987\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-251\">x</script>, the model samples reasoning traces <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-252-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3988\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3989\"><span class=\"mi\" id=\"MathJax-Span-3990\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-252\">z</script> leading to outcomes <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-253-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3991\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3992\"><span class=\"mi\" id=\"MathJax-Span-3993\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-253\">y</script>, maximizing</p>\n  </li>\n</ul>\n<p>DeepSeek-R1 conceptualizes the ‚ÄúAha‚Äù moment as a <strong>policy-level transition</strong> in the reasoning dynamics of the model. During early RL training, the model‚Äôs outputs are dominated by shallow heuristics‚Äîlocally coherent but globally inconsistent reasoning chains. As reinforcement updates accumulate, the model begins to exploit verifiable reward structure: it learns that <strong>structured reasoning trajectories</strong> yield higher expected reward.</p>\n<p>Formally, given a problem input <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-251-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3985\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3986\"><span class=\"mi\" id=\"MathJax-Span-3987\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-251\">x</script>, the model samples reasoning traces <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-252-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3988\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3989\"><span class=\"mi\" id=\"MathJax-Span-3990\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-252\">z</script> leading to outcomes <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-253-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3991\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3992\"><span class=\"mi\" id=\"MathJax-Span-3993\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-253\">y</script>, maximizing</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-254-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>J</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>&amp;#x223C;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>D</mi></mrow><mo>,</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo>&amp;#x223C;</mo><mi>p</mi><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3994\" style=\"width: 14.586em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.138em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1012.03em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3995\"><span class=\"texatom\" id=\"MathJax-Span-3996\"><span class=\"mrow\" id=\"MathJax-Span-3997\"><span class=\"mi\" id=\"MathJax-Span-3998\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∂<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3999\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4000\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4001\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4002\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4003\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 5.419em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4004\"><span class=\"mrow\" id=\"MathJax-Span-4005\"><span class=\"mi\" id=\"MathJax-Span-4006\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-4007\"><span class=\"mrow\" id=\"MathJax-Span-4008\"><span class=\"mi\" id=\"MathJax-Span-4009\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4010\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"texatom\" id=\"MathJax-Span-4011\"><span class=\"mrow\" id=\"MathJax-Span-4012\"><span class=\"mi\" id=\"MathJax-Span-4013\" style=\"font-size: 70.7%; font-family: STIXNonUnicode-Italic;\">Óà∞</span></span></span><span class=\"mo\" id=\"MathJax-Span-4014\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4015\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-4016\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4017\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-4018\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"mi\" id=\"MathJax-Span-4019\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">p</span><span class=\"mi\" id=\"MathJax-Span-4020\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4021\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-4022\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"texatom\" id=\"MathJax-Span-4023\"><span class=\"mrow\" id=\"MathJax-Span-4024\"><span class=\"mo\" id=\"MathJax-Span-4025\" style=\"font-size: 70.7%; font-family: STIXVariants;\">|</span></span></span><span class=\"mi\" id=\"MathJax-Span-4026\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4027\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4028\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-4029\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-4030\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4031\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-4032\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4033\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-4034\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4035\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">J</mi></mrow><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>‚àº</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">D</mi></mrow><mo>,</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo>‚àº</mo><mi>p</mi><mi>Œ∏</mi><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo stretchy=\"false\">[</mo><mi>R</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div>\n<ul>\n  <li>\n    <p>Initially, reward gradients are sparse‚Äîmost reasoning attempts fail verification. But once the model discovers an internal representation <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-255-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4036\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4037\"><span class=\"mi\" id=\"MathJax-Span-4038\" style=\"font-family: STIXGeneral-Italic;\">h</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>h</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-255\">h</script> that decomposes the problem space (e.g., through implicit subgoal inference), reward signals align with coherent reasoning structure, triggering a <strong>phase transition</strong> in <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-256-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4039\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.44em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.39em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4040\"><span class=\"msubsup\" id=\"MathJax-Span-4041\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4042\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4043\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4044\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4045\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-4046\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4047\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4048\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-256\">p_\\theta(z \\mid x)</script>.</p>\n  </li>\n  <li>\n    <p>Empirically, DeepSeek-R1 observed that this transition is <em>abrupt</em> yet <em>self-stabilizing</em>: the model begins to reuse and generalize reasoning motifs across unseen domains, much like a human suddenly ‚Äúfigures out‚Äù a new way of thinking about problems.</p>\n  </li>\n</ul>\n<p>Initially, reward gradients are sparse‚Äîmost reasoning attempts fail verification. But once the model discovers an internal representation <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-255-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4036\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4037\"><span class=\"mi\" id=\"MathJax-Span-4038\" style=\"font-family: STIXGeneral-Italic;\">h</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>h</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-255\">h</script> that decomposes the problem space (e.g., through implicit subgoal inference), reward signals align with coherent reasoning structure, triggering a <strong>phase transition</strong> in <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-256-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4039\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.44em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.39em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4040\"><span class=\"msubsup\" id=\"MathJax-Span-4041\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4042\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4043\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4044\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4045\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-4046\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4047\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4048\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-256\">p_\\theta(z \\mid x)</script>.</p>\n<p>Empirically, DeepSeek-R1 observed that this transition is <em>abrupt</em> yet <em>self-stabilizing</em>: the model begins to reuse and generalize reasoning motifs across unseen domains, much like a human suddenly ‚Äúfigures out‚Äù a new way of thinking about problems.</p>",
    "contentMarkdown": "*   DeepSeek-R1 conceptualizes the ‚ÄúAha‚Äù moment as a **policy-level transition** in the reasoning dynamics of the model. During early RL training, the model‚Äôs outputs are dominated by shallow heuristics‚Äîlocally coherent but globally inconsistent reasoning chains. As reinforcement updates accumulate, the model begins to exploit verifiable reward structure: it learns that **structured reasoning trajectories** yield higher expected reward.\n    \n*   Formally, given a problem input xxx, the model samples reasoning traces zzz leading to outcomes yyy, maximizing\n    \n\nDeepSeek-R1 conceptualizes the ‚ÄúAha‚Äù moment as a **policy-level transition** in the reasoning dynamics of the model. During early RL training, the model‚Äôs outputs are dominated by shallow heuristics‚Äîlocally coherent but globally inconsistent reasoning chains. As reinforcement updates accumulate, the model begins to exploit verifiable reward structure: it learns that **structured reasoning trajectories** yield higher expected reward.\n\nFormally, given a problem input xxx, the model samples reasoning traces zzz leading to outcomes yyy, maximizing\n\nÓà∂(Œ∏)\\=ùîºx‚àºÓà∞,z,y‚àºpŒ∏(‚ãÖ|x)\\[R(y,z)\\]J(Œ∏)\\=Ex‚àºD,z,y‚àºpŒ∏(‚ãÖ|x)\\[R(y,z)\\]\n\n*   Initially, reward gradients are sparse‚Äîmost reasoning attempts fail verification. But once the model discovers an internal representation hhh that decomposes the problem space (e.g., through implicit subgoal inference), reward signals align with coherent reasoning structure, triggering a **phase transition** in pŒ∏(z‚à£x)pŒ∏(z‚à£x)p\\_\\\\theta(z \\\\mid x).\n    \n*   Empirically, DeepSeek-R1 observed that this transition is _abrupt_ yet _self-stabilizing_: the model begins to reuse and generalize reasoning motifs across unseen domains, much like a human suddenly ‚Äúfigures out‚Äù a new way of thinking about problems.\n    \n\nInitially, reward gradients are sparse‚Äîmost reasoning attempts fail verification. But once the model discovers an internal representation hhh that decomposes the problem space (e.g., through implicit subgoal inference), reward signals align with coherent reasoning structure, triggering a **phase transition** in pŒ∏(z‚à£x)pŒ∏(z‚à£x)p\\_\\\\theta(z \\\\mid x).\n\nEmpirically, DeepSeek-R1 observed that this transition is _abrupt_ yet _self-stabilizing_: the model begins to reuse and generalize reasoning motifs across unseen domains, much like a human suddenly ‚Äúfigures out‚Äù a new way of thinking about problems.",
    "order": 24,
    "orderInChapter": 1,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 309,
      "contentLength": 24819
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#the-deepseek-r1-perspective",
    "scrapedAt": "2025-12-28T11:54:00.656Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-what-triggers-the-aha-transition-25",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "The ‚ÄúAha‚Äù Moment and Emergent Reasoning",
    "title": "What Triggers the ‚ÄúAha‚Äù Transition?",
    "subtitle": "The ‚ÄúAha‚Äù Moment and Emergent Reasoning",
    "contentHtml": "<ul>\n  <li>\n    <p>The DeepSeek-R1 findings suggest that the transition arises from the <strong>interaction between reinforcement feedback and latent compositionality</strong>. Three components drive this behavior:</p>\n\n    <ol>\n      <li><strong>Sparse but verifiable rewards</strong>: Correct answers yield discrete, high-signal updates that privilege reasoning chains aligned with ground truth.</li>\n      <li><strong>Exploration pressure</strong>: The RL policy must explore sufficiently diverse reasoning paths before discovering stable, high-reward substructures.</li>\n      <li><strong>Representation reuse</strong>: Once a reasoning schema is found (e.g., arithmetic decomposition, symbolic manipulation), the model internalizes it as a reusable <em>reasoning primitive</em>.</li>\n    </ol>\n  </li>\n  <li>\n    <p>These factors produce a <strong>self-organizing dynamic</strong>: reward gradients reshape the latent geometry of the model‚Äôs activations until symbolic structure becomes an attractor state‚Äîeffectively, the model learns <em>how to think</em> rather than <em>what to say</em>.</p>\n  </li>\n</ul>\n<p>The DeepSeek-R1 findings suggest that the transition arises from the <strong>interaction between reinforcement feedback and latent compositionality</strong>. Three components drive this behavior:</p>\n<ol>\n      <li><strong>Sparse but verifiable rewards</strong>: Correct answers yield discrete, high-signal updates that privilege reasoning chains aligned with ground truth.</li>\n      <li><strong>Exploration pressure</strong>: The RL policy must explore sufficiently diverse reasoning paths before discovering stable, high-reward substructures.</li>\n      <li><strong>Representation reuse</strong>: Once a reasoning schema is found (e.g., arithmetic decomposition, symbolic manipulation), the model internalizes it as a reusable <em>reasoning primitive</em>.</li>\n    </ol>\n<p>These factors produce a <strong>self-organizing dynamic</strong>: reward gradients reshape the latent geometry of the model‚Äôs activations until symbolic structure becomes an attractor state‚Äîeffectively, the model learns <em>how to think</em> rather than <em>what to say</em>.</p>",
    "contentMarkdown": "*   The DeepSeek-R1 findings suggest that the transition arises from the **interaction between reinforcement feedback and latent compositionality**. Three components drive this behavior:\n    \n    1.  **Sparse but verifiable rewards**: Correct answers yield discrete, high-signal updates that privilege reasoning chains aligned with ground truth.\n    2.  **Exploration pressure**: The RL policy must explore sufficiently diverse reasoning paths before discovering stable, high-reward substructures.\n    3.  **Representation reuse**: Once a reasoning schema is found (e.g., arithmetic decomposition, symbolic manipulation), the model internalizes it as a reusable _reasoning primitive_.\n*   These factors produce a **self-organizing dynamic**: reward gradients reshape the latent geometry of the model‚Äôs activations until symbolic structure becomes an attractor state‚Äîeffectively, the model learns _how to think_ rather than _what to say_.\n    \n\nThe DeepSeek-R1 findings suggest that the transition arises from the **interaction between reinforcement feedback and latent compositionality**. Three components drive this behavior:\n\n1.  **Sparse but verifiable rewards**: Correct answers yield discrete, high-signal updates that privilege reasoning chains aligned with ground truth.\n2.  **Exploration pressure**: The RL policy must explore sufficiently diverse reasoning paths before discovering stable, high-reward substructures.\n3.  **Representation reuse**: Once a reasoning schema is found (e.g., arithmetic decomposition, symbolic manipulation), the model internalizes it as a reusable _reasoning primitive_.\n\nThese factors produce a **self-organizing dynamic**: reward gradients reshape the latent geometry of the model‚Äôs activations until symbolic structure becomes an attractor state‚Äîeffectively, the model learns _how to think_ rather than _what to say_.",
    "order": 25,
    "orderInChapter": 2,
    "difficulty": 3,
    "estimatedMinutes": 2,
    "tags": [
      "nlpllms",
      "activation"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 232,
      "contentLength": 2175
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#what-triggers-the-‚Äúaha‚Äù-transition?",
    "scrapedAt": "2025-12-28T11:54:00.656Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-relating-the-aha-moment-to-emergent-reasoning-26",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "The ‚ÄúAha‚Äù Moment and Emergent Reasoning",
    "title": "Relating the Aha Moment to Emergent Reasoning",
    "subtitle": "The ‚ÄúAha‚Äù Moment and Emergent Reasoning",
    "contentHtml": "<ul>\n  <li>\n    <p>DeepSeek-R1 reframes emergence not as a scaling accident, but as an <strong>optimization-driven restructuring</strong> of cognition within the model. What appears as a sudden ‚ÄúAha‚Äù is, in fact, a threshold phenomenon in representation alignment‚Äîwhen internal circuits that previously encoded diffuse associations crystallize into <strong>task-general reasoning routines</strong>.</p>\n  </li>\n  <li>\n    <p>This view aligns with the idea of <strong>representational phase transitions</strong>: as the model‚Äôs policy distribution becomes increasingly aligned with verifiable reward signals, latent subspaces reorganize to encode causal and compositional relations explicitly. At that point, the model exhibits stable reasoning behavior across mathematically verifiable tasks (AIME, MATH, GSM8K), a hallmark of emergent reasoning.</p>\n  </li>\n</ul>\n<p>DeepSeek-R1 reframes emergence not as a scaling accident, but as an <strong>optimization-driven restructuring</strong> of cognition within the model. What appears as a sudden ‚ÄúAha‚Äù is, in fact, a threshold phenomenon in representation alignment‚Äîwhen internal circuits that previously encoded diffuse associations crystallize into <strong>task-general reasoning routines</strong>.</p>\n<p>This view aligns with the idea of <strong>representational phase transitions</strong>: as the model‚Äôs policy distribution becomes increasingly aligned with verifiable reward signals, latent subspaces reorganize to encode causal and compositional relations explicitly. At that point, the model exhibits stable reasoning behavior across mathematically verifiable tasks (AIME, MATH, GSM8K), a hallmark of emergent reasoning.</p>",
    "contentMarkdown": "*   DeepSeek-R1 reframes emergence not as a scaling accident, but as an **optimization-driven restructuring** of cognition within the model. What appears as a sudden ‚ÄúAha‚Äù is, in fact, a threshold phenomenon in representation alignment‚Äîwhen internal circuits that previously encoded diffuse associations crystallize into **task-general reasoning routines**.\n    \n*   This view aligns with the idea of **representational phase transitions**: as the model‚Äôs policy distribution becomes increasingly aligned with verifiable reward signals, latent subspaces reorganize to encode causal and compositional relations explicitly. At that point, the model exhibits stable reasoning behavior across mathematically verifiable tasks (AIME, MATH, GSM8K), a hallmark of emergent reasoning.\n    \n\nDeepSeek-R1 reframes emergence not as a scaling accident, but as an **optimization-driven restructuring** of cognition within the model. What appears as a sudden ‚ÄúAha‚Äù is, in fact, a threshold phenomenon in representation alignment‚Äîwhen internal circuits that previously encoded diffuse associations crystallize into **task-general reasoning routines**.\n\nThis view aligns with the idea of **representational phase transitions**: as the model‚Äôs policy distribution becomes increasingly aligned with verifiable reward signals, latent subspaces reorganize to encode causal and compositional relations explicitly. At that point, the model exhibits stable reasoning behavior across mathematically verifiable tasks (AIME, MATH, GSM8K), a hallmark of emergent reasoning.",
    "order": 26,
    "orderInChapter": 3,
    "difficulty": 3,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "llm",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 198,
      "contentLength": 1680
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#relating-the-aha-moment-to-emergent-reasoning",
    "scrapedAt": "2025-12-28T11:54:00.656Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-why-it-matters-27",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "The ‚ÄúAha‚Äù Moment and Emergent Reasoning",
    "title": "Why It Matters",
    "subtitle": "The ‚ÄúAha‚Äù Moment and Emergent Reasoning",
    "contentHtml": "<ul>\n  <li>Understanding the ‚ÄúAha‚Äù moment through the lens of DeepSeek-R1 clarifies that emergence is <em>trainable</em>, not mysterious. It arises when a model‚Äôs <strong>optimization incentives</strong> begin to reward internal structure over surface coherence.\nOnce this shift occurs, the model moves beyond imitation of training data and begins to <strong>search, plan, and verify</strong>‚Äîthe minimal ingredients of genuine reasoning.</li>\n</ul>",
    "contentMarkdown": "*   Understanding the ‚ÄúAha‚Äù moment through the lens of DeepSeek-R1 clarifies that emergence is _trainable_, not mysterious. It arises when a model‚Äôs **optimization incentives** begin to reward internal structure over surface coherence. Once this shift occurs, the model moves beyond imitation of training data and begins to **search, plan, and verify**‚Äîthe minimal ingredients of genuine reasoning.",
    "order": 27,
    "orderInChapter": 4,
    "difficulty": 3,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 56,
      "contentLength": 449
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#why-it-matters",
    "scrapedAt": "2025-12-28T11:54:00.656Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-gsm8k-grade-school-math-reasoning-28",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Evaluation of Reasoning Using Datasets",
    "title": "GSM8K (grade-school Math Reasoning)",
    "subtitle": "Evaluation of Reasoning Using Datasets",
    "contentHtml": "<ul>\n  <li>\n    <p>GSM8K by <a href=\"https://arxiv.org/abs/2110.14168\">Cobbe et al. (2021)</a> is a curated benchmark of 8.5K grade-school arithmetic word problems designed to probe multi-step reasoning with simple operations. The official repository summarizes a split of 7.5K training problems and 1K test problems, with solutions that typically require 2‚Äì8 steps (see <a href=\"https://github.com/openai/grade-school-math\">dataset card</a>). GSM8K is often used to detect ‚Äúaha‚Äù-style thresholding because exact-match performance can jump sharply when models begin to reliably compose intermediate steps.</p>\n  </li>\n  <li><strong>Why it‚Äôs reasoning-centric</strong>:\n    <ul>\n      <li>Problems are crafted to be solvable by a bright middle-schooler yet require composing several elementary operations. The target is not retrieval but stepwise manipulation (counting, unit arithmetic, proportional reasoning). This favors methods that surface or verify intermediate traces.</li>\n    </ul>\n  </li>\n  <li><strong>Evaluation protocol</strong>:\n    <ul>\n      <li>Given a problem x, the model produces a reasoning trace <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-260-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4120\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4121\"><span class=\"mi\" id=\"MathJax-Span-4122\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-260\">z</script> and final answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-261-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4123\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4124\"><span class=\"mi\" id=\"MathJax-Span-4125\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-261\">y</script>. Exact match is computed as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-262-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>EM</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>&amp;#x22C6;</mo></msubsup><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4126\" style=\"width: 11.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.898em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1009.79em, 2.867em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4127\"><span class=\"mtext\" id=\"MathJax-Span-4128\" style=\"font-family: STIXGeneral-Regular;\">EM</span><span class=\"mo\" id=\"MathJax-Span-4129\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-4130\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -4.424em; left: 50%; margin-left: -0.154em;\"><span class=\"mn\" id=\"MathJax-Span-4131\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.258em;\"><span class=\"mi\" id=\"MathJax-Span-4132\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.628em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-4133\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4134\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-4135\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-4136\"><span class=\"mrow\" id=\"MathJax-Span-4137\"><span class=\"mi\" id=\"MathJax-Span-4138\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-4139\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-4140\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4141\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4142\"><span class=\"mi\" id=\"MathJax-Span-4143\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-4144\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-4145\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4146\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4148\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4149\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4150\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.58em, 4.169em, -999.997em); top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4151\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4152\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4153\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>EM</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>‚ãÜ</mo></msubsup><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-262\">\\text{EM}=\\frac{1}{N}\\sum_{i=1}^N \\mathbb{I}[y_i=y_i^\\star]</script>. Because <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-263-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>EM</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4154\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.51em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4155\"><span class=\"mtext\" id=\"MathJax-Span-4156\" style=\"font-family: STIXGeneral-Regular;\">EM</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>EM</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-263\">\\text{EM}</script> is thresholded, small gains in <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-264-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msup><mi>y</mi><mo>&amp;#x22C6;</mo></msup><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4157\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1003.91em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4158\"><span class=\"msubsup\" id=\"MathJax-Span-4159\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4160\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4161\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4162\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4163\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4164\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4165\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4166\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4167\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4168\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msup><mi>y</mi><mo>‚ãÜ</mo></msup><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-264\">p_\\theta(y^\\star\\mid x)</script> can yield large apparent jumps. Many evaluations now pair EM with verifier selection: sample K candidate solutions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-265-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>,</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4169\" style=\"width: 5.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.951em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.94em, 1004.95em, 2.555em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4170\"><span class=\"msubsup\" id=\"MathJax-Span-4171\"><span style=\"display: inline-block; position: relative; width: 4.951em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.023em, 1003.65em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4172\"><span class=\"mrow\" id=\"MathJax-Span-4173\"><span class=\"mo\" id=\"MathJax-Span-4174\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4175\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4176\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-4177\"><span class=\"mrow\" id=\"MathJax-Span-4178\"><span class=\"mo\" id=\"MathJax-Span-4179\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4180\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4181\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4182\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4183\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4184\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4185\"><span class=\"mrow\" id=\"MathJax-Span-4186\"><span class=\"mo\" id=\"MathJax-Span-4187\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4188\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4189\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4190\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.581em; left: 3.701em;\"><span class=\"mi\" id=\"MathJax-Span-4191\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.169em, -999.997em); top: -3.747em; left: 3.701em;\"><span class=\"texatom\" id=\"MathJax-Span-4192\"><span class=\"mrow\" id=\"MathJax-Span-4193\"><span class=\"mi\" id=\"MathJax-Span-4194\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4195\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-4196\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>,</mo><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-265\">{(z^{(k)},y^{(k)})}_{k=1}^K</script> and choose <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-266-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>k</mi><mo>&amp;#x22C6;</mo></msup><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>k</mi></munder><mi>V</mi><mrow><mo>(</mo><mrow><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>,</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></mrow><mo>)</mo></mrow><mo>,</mo><mspace width=&quot;2em&quot; /><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msup><mi>k</mi><mo>&amp;#x22C6;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4197\" style=\"width: 20.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 17.398em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.826em, 1017.4em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4198\"><span class=\"msubsup\" id=\"MathJax-Span-4199\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4200\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-4201\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4202\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4203\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-4204\"></span><span class=\"munderover\" id=\"MathJax-Span-4205\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4206\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"mi\" id=\"MathJax-Span-4207\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-4208\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mrow\" id=\"MathJax-Span-4209\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-4210\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-4211\"><span class=\"msubsup\" id=\"MathJax-Span-4212\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4213\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-4214\"><span class=\"mrow\" id=\"MathJax-Span-4215\"><span class=\"mo\" id=\"MathJax-Span-4216\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4217\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4218\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4219\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4220\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4221\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4222\"><span class=\"mrow\" id=\"MathJax-Span-4223\"><span class=\"mo\" id=\"MathJax-Span-4224\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4225\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4226\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4227\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">)</span></span></span><span class=\"mo\" id=\"MathJax-Span-4228\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"mspace\" id=\"MathJax-Span-4229\" style=\"height: 0em; vertical-align: 0em; width: 2.242em; display: inline-block; overflow: hidden;\"></span><span class=\"texatom\" id=\"MathJax-Span-4230\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4231\"><span class=\"munderover\" id=\"MathJax-Span-4232\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4233\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4234\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4235\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4236\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4237\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4238\"><span class=\"mrow\" id=\"MathJax-Span-4239\"><span class=\"mo\" id=\"MathJax-Span-4240\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4241\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4242\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-4243\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4244\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>k</mi><mo>‚ãÜ</mo></msup><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>k</mi></munder><mi>V</mi><mrow><mo>(</mo><mrow><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>,</mo><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow><mo>)</mo></mrow><mo>,</mo><mspace width=\"2em\"></mspace><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msup><mi>k</mi><mo>‚ãÜ</mo></msup><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-266\">k^\\star=\\arg\\max_k V \\left(z^{(k)},y^{(k)}\\right),\\qquad \\hat{y}=y^{(k^\\star)}</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-267-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4245\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4246\"><span class=\"mi\" id=\"MathJax-Span-4247\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-267\">V</script> is a trained verifier as introduced with GSM8K by <a href=\"https://arxiv.org/abs/2110.14168\">Cobbe et al. (2021)</a>. This turns evaluation into a two-stage generate‚Äìverify pipeline. Process supervision work such as Let‚Äôs Verify Step by Step by <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a> further scores intermediate steps, not just outcomes.</li>\n    </ul>\n  </li>\n  <li><strong>Interfaces that matter on GSM8K</strong>:\n    <ul>\n      <li>CoT prompting and self-consistency are especially effective. Self-Consistency Improves CoT Reasoning by <a href=\"https://arxiv.org/abs/2203.11171\">Wang et al. (2022)</a> showed large gains on GSM8K by sampling diverse chains and marginalizing answers, effectively approximating <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-268-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi></mrow></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mrow><mo>[</mo><mrow><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>y</mi></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4248\" style=\"width: 14.586em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.138em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.826em, 1011.98em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4249\"><span class=\"texatom\" id=\"MathJax-Span-4250\"><span class=\"mrow\" id=\"MathJax-Span-4251\"><span class=\"munderover\" id=\"MathJax-Span-4252\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4253\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4254\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4255\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4256\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-4257\"></span><span class=\"munderover\" id=\"MathJax-Span-4258\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4259\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"mi\" id=\"MathJax-Span-4260\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-4261\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4262\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-4263\"><span class=\"mrow\" id=\"MathJax-Span-4264\"><span class=\"mi\" id=\"MathJax-Span-4265\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-4266\"><span class=\"mrow\" id=\"MathJax-Span-4267\"><span class=\"mi\" id=\"MathJax-Span-4268\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4269\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-4270\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4271\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4272\"><span class=\"mi\" id=\"MathJax-Span-4273\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mrow\" id=\"MathJax-Span-4274\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-4275\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-4276\"><span class=\"msubsup\" id=\"MathJax-Span-4277\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4278\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4279\"><span class=\"mrow\" id=\"MathJax-Span-4280\"><span class=\"mo\" id=\"MathJax-Span-4281\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4282\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4283\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4284\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4285\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span></span><span class=\"mo\" id=\"MathJax-Span-4286\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>K</mi></mrow></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mrow><mo>[</mo><mrow><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>y</mi></mrow><mo>]</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-268\">\\hat{y}=\\arg\\max_y \\sum_{k=1}^{K}\\mathbb{I} \\left[y^{(k)}=y\\right]</script>.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Common pitfalls and controls:</strong></p>\n\n    <ul>\n      <li><strong>Overfitting to surface templates:</strong> vary paraphrases and numerical spans.</li>\n      <li><strong>Interface confounds:</strong> report with and without CoT and self-consistency.</li>\n      <li><strong>Verifier over-reliance:</strong> ensure the verifier isn‚Äôt shortcutting via superficial cues; ablate with randomized chains.</li>\n      <li>Report smooth metrics (log-prob, Brier/ECE) alongside EM to avoid ‚Äúmirage‚Äù emergence effects.</li>\n    </ul>\n  </li>\n  <li><strong>What to report for reproducibility:</strong>\n    <ul>\n      <li>Decoding temperatures and sample count <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-269-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4287\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4288\"><span class=\"mi\" id=\"MathJax-Span-4289\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-269\">K</script>, prompt format (few-shot exemplars and formatting), normalization rules for numeric answers, verifier architecture and training data, and any process-level scoring.</li>\n      <li>Where feasible, release prompts, sampled chains, and verifier decision logs to enable step-level auditing.</li>\n    </ul>\n  </li>\n</ul>\n<p>GSM8K by <a href=\"https://arxiv.org/abs/2110.14168\">Cobbe et al. (2021)</a> is a curated benchmark of 8.5K grade-school arithmetic word problems designed to probe multi-step reasoning with simple operations. The official repository summarizes a split of 7.5K training problems and 1K test problems, with solutions that typically require 2‚Äì8 steps (see <a href=\"https://github.com/openai/grade-school-math\">dataset card</a>). GSM8K is often used to detect ‚Äúaha‚Äù-style thresholding because exact-match performance can jump sharply when models begin to reliably compose intermediate steps.</p>\n<ul>\n      <li>Problems are crafted to be solvable by a bright middle-schooler yet require composing several elementary operations. The target is not retrieval but stepwise manipulation (counting, unit arithmetic, proportional reasoning). This favors methods that surface or verify intermediate traces.</li>\n    </ul>\n<ul>\n      <li>Given a problem x, the model produces a reasoning trace <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-260-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4120\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4121\"><span class=\"mi\" id=\"MathJax-Span-4122\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-260\">z</script> and final answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-261-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4123\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4124\"><span class=\"mi\" id=\"MathJax-Span-4125\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-261\">y</script>. Exact match is computed as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-262-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>EM</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>&amp;#x22C6;</mo></msubsup><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4126\" style=\"width: 11.878em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.898em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1009.79em, 2.867em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4127\"><span class=\"mtext\" id=\"MathJax-Span-4128\" style=\"font-family: STIXGeneral-Regular;\">EM</span><span class=\"mo\" id=\"MathJax-Span-4129\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-4130\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -4.424em; left: 50%; margin-left: -0.154em;\"><span class=\"mn\" id=\"MathJax-Span-4131\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.258em;\"><span class=\"mi\" id=\"MathJax-Span-4132\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.628em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-4133\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4134\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-4135\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-4136\"><span class=\"mrow\" id=\"MathJax-Span-4137\"><span class=\"mi\" id=\"MathJax-Span-4138\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-4139\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-4140\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4141\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4142\"><span class=\"mi\" id=\"MathJax-Span-4143\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-4144\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-4145\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4146\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4148\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4149\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4150\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.58em, 4.169em, -999.997em); top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4151\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4152\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4153\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>EM</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>‚ãÜ</mo></msubsup><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-262\">\\text{EM}=\\frac{1}{N}\\sum_{i=1}^N \\mathbb{I}[y_i=y_i^\\star]</script>. Because <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-263-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>EM</mtext></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4154\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.51em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4155\"><span class=\"mtext\" id=\"MathJax-Span-4156\" style=\"font-family: STIXGeneral-Regular;\">EM</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>EM</mtext></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-263\">\\text{EM}</script> is thresholded, small gains in <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-264-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msup><mi>y</mi><mo>&amp;#x22C6;</mo></msup><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4157\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1003.91em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4158\"><span class=\"msubsup\" id=\"MathJax-Span-4159\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4160\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4161\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4162\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4163\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4164\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4165\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4166\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4167\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4168\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msup><mi>y</mi><mo>‚ãÜ</mo></msup><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-264\">p_\\theta(y^\\star\\mid x)</script> can yield large apparent jumps. Many evaluations now pair EM with verifier selection: sample K candidate solutions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-265-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>,</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4169\" style=\"width: 5.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.951em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.94em, 1004.95em, 2.555em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4170\"><span class=\"msubsup\" id=\"MathJax-Span-4171\"><span style=\"display: inline-block; position: relative; width: 4.951em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.023em, 1003.65em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4172\"><span class=\"mrow\" id=\"MathJax-Span-4173\"><span class=\"mo\" id=\"MathJax-Span-4174\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4175\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4176\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-4177\"><span class=\"mrow\" id=\"MathJax-Span-4178\"><span class=\"mo\" id=\"MathJax-Span-4179\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4180\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4181\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4182\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4183\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4184\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4185\"><span class=\"mrow\" id=\"MathJax-Span-4186\"><span class=\"mo\" id=\"MathJax-Span-4187\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4188\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4189\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4190\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.581em; left: 3.701em;\"><span class=\"mi\" id=\"MathJax-Span-4191\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.169em, -999.997em); top: -3.747em; left: 3.701em;\"><span class=\"texatom\" id=\"MathJax-Span-4192\"><span class=\"mrow\" id=\"MathJax-Span-4193\"><span class=\"mi\" id=\"MathJax-Span-4194\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4195\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-4196\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>,</mo><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-265\">{(z^{(k)},y^{(k)})}_{k=1}^K</script> and choose <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-266-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>k</mi><mo>&amp;#x22C6;</mo></msup><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>k</mi></munder><mi>V</mi><mrow><mo>(</mo><mrow><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>,</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></mrow><mo>)</mo></mrow><mo>,</mo><mspace width=&quot;2em&quot; /><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msup><mi>k</mi><mo>&amp;#x22C6;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4197\" style=\"width: 20.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 17.398em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.826em, 1017.4em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4198\"><span class=\"msubsup\" id=\"MathJax-Span-4199\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4200\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-4201\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4202\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4203\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-4204\"></span><span class=\"munderover\" id=\"MathJax-Span-4205\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4206\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"mi\" id=\"MathJax-Span-4207\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-4208\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mrow\" id=\"MathJax-Span-4209\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-4210\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-4211\"><span class=\"msubsup\" id=\"MathJax-Span-4212\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4213\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-4214\"><span class=\"mrow\" id=\"MathJax-Span-4215\"><span class=\"mo\" id=\"MathJax-Span-4216\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4217\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4218\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4219\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4220\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4221\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4222\"><span class=\"mrow\" id=\"MathJax-Span-4223\"><span class=\"mo\" id=\"MathJax-Span-4224\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4225\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4226\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4227\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">)</span></span></span><span class=\"mo\" id=\"MathJax-Span-4228\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"mspace\" id=\"MathJax-Span-4229\" style=\"height: 0em; vertical-align: 0em; width: 2.242em; display: inline-block; overflow: hidden;\"></span><span class=\"texatom\" id=\"MathJax-Span-4230\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4231\"><span class=\"munderover\" id=\"MathJax-Span-4232\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4233\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4234\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4235\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4236\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.773em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4237\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4238\"><span class=\"mrow\" id=\"MathJax-Span-4239\"><span class=\"mo\" id=\"MathJax-Span-4240\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4241\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4242\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-4243\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4244\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>k</mi><mo>‚ãÜ</mo></msup><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>k</mi></munder><mi>V</mi><mrow><mo>(</mo><mrow><msup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>,</mo><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow><mo>)</mo></mrow><mo>,</mo><mspace width=\"2em\"></mspace><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msup><mi>k</mi><mo>‚ãÜ</mo></msup><mo stretchy=\"false\">)</mo></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-266\">k^\\star=\\arg\\max_k V \\left(z^{(k)},y^{(k)}\\right),\\qquad \\hat{y}=y^{(k^\\star)}</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-267-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4245\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4246\"><span class=\"mi\" id=\"MathJax-Span-4247\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-267\">V</script> is a trained verifier as introduced with GSM8K by <a href=\"https://arxiv.org/abs/2110.14168\">Cobbe et al. (2021)</a>. This turns evaluation into a two-stage generate‚Äìverify pipeline. Process supervision work such as Let‚Äôs Verify Step by Step by <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a> further scores intermediate steps, not just outcomes.</li>\n    </ul>\n<ul>\n      <li>CoT prompting and self-consistency are especially effective. Self-Consistency Improves CoT Reasoning by <a href=\"https://arxiv.org/abs/2203.11171\">Wang et al. (2022)</a> showed large gains on GSM8K by sampling diverse chains and marginalizing answers, effectively approximating <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-268-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi></mrow></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mrow><mo>[</mo><mrow><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>y</mi></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4248\" style=\"width: 14.586em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.138em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.826em, 1011.98em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4249\"><span class=\"texatom\" id=\"MathJax-Span-4250\"><span class=\"mrow\" id=\"MathJax-Span-4251\"><span class=\"munderover\" id=\"MathJax-Span-4252\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4253\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4254\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4255\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4256\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-4257\"></span><span class=\"munderover\" id=\"MathJax-Span-4258\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4259\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"mi\" id=\"MathJax-Span-4260\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-4261\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4262\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-4263\"><span class=\"mrow\" id=\"MathJax-Span-4264\"><span class=\"mi\" id=\"MathJax-Span-4265\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-4266\"><span class=\"mrow\" id=\"MathJax-Span-4267\"><span class=\"mi\" id=\"MathJax-Span-4268\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4269\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-4270\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4271\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4272\"><span class=\"mi\" id=\"MathJax-Span-4273\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mrow\" id=\"MathJax-Span-4274\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-4275\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-4276\"><span class=\"msubsup\" id=\"MathJax-Span-4277\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4278\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4279\"><span class=\"mrow\" id=\"MathJax-Span-4280\"><span class=\"mo\" id=\"MathJax-Span-4281\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4282\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4283\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4284\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4285\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">y</span></span><span class=\"mo\" id=\"MathJax-Span-4286\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>K</mi></mrow></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mrow><mo>[</mo><mrow><msup><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>y</mi></mrow><mo>]</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-268\">\\hat{y}=\\arg\\max_y \\sum_{k=1}^{K}\\mathbb{I} \\left[y^{(k)}=y\\right]</script>.</li>\n    </ul>\n<p><strong>Common pitfalls and controls:</strong></p>\n<ul>\n      <li><strong>Overfitting to surface templates:</strong> vary paraphrases and numerical spans.</li>\n      <li><strong>Interface confounds:</strong> report with and without CoT and self-consistency.</li>\n      <li><strong>Verifier over-reliance:</strong> ensure the verifier isn‚Äôt shortcutting via superficial cues; ablate with randomized chains.</li>\n      <li>Report smooth metrics (log-prob, Brier/ECE) alongside EM to avoid ‚Äúmirage‚Äù emergence effects.</li>\n    </ul>\n<ul>\n      <li>Decoding temperatures and sample count <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-269-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4287\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4288\"><span class=\"mi\" id=\"MathJax-Span-4289\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-269\">K</script>, prompt format (few-shot exemplars and formatting), normalization rules for numeric answers, verifier architecture and training data, and any process-level scoring.</li>\n      <li>Where feasible, release prompts, sampled chains, and verifier decision logs to enable step-level auditing.</li>\n    </ul>",
    "contentMarkdown": "*   GSM8K by [Cobbe et al. (2021)](https://arxiv.org/abs/2110.14168) is a curated benchmark of 8.5K grade-school arithmetic word problems designed to probe multi-step reasoning with simple operations. The official repository summarizes a split of 7.5K training problems and 1K test problems, with solutions that typically require 2‚Äì8 steps (see [dataset card](https://github.com/openai/grade-school-math)). GSM8K is often used to detect ‚Äúaha‚Äù-style thresholding because exact-match performance can jump sharply when models begin to reliably compose intermediate steps.\n    \n*   **Why it‚Äôs reasoning-centric**:\n    *   Problems are crafted to be solvable by a bright middle-schooler yet require composing several elementary operations. The target is not retrieval but stepwise manipulation (counting, unit arithmetic, proportional reasoning). This favors methods that surface or verify intermediate traces.\n*   **Evaluation protocol**:\n    *   Given a problem x, the model produces a reasoning trace zzz and final answer yyy. Exact match is computed as EM\\=1N‚àëNi\\=1ùïÄ\\[yi\\=y‚ãÜi\\]EM\\=1N‚àëi\\=1NI\\[yi\\=yi‚ãÜ\\]\\\\text{EM}=\\\\frac{1}{N}\\\\sum\\_{i=1}^N \\\\mathbb{I}\\[y\\_i=y\\_i^\\\\star\\]. Because EMEM\\\\text{EM} is thresholded, small gains in pŒ∏(y‚ãÜ‚à£x)pŒ∏(y‚ãÜ‚à£x)p\\_\\\\theta(y^\\\\star\\\\mid x) can yield large apparent jumps. Many evaluations now pair EM with verifier selection: sample K candidate solutions (z(k),y(k))Kk\\=1(z(k),y(k))k\\=1K{(z^{(k)},y^{(k)})}\\_{k=1}^K and choose k‚ãÜ\\=argmaxkV(z(k),y(k)),yÃÇ¬†\\=y(k‚ãÜ)k‚ãÜ\\=arg‚Å°maxkV(z(k),y(k)),y^\\=y(k‚ãÜ)k^\\\\star=\\\\arg\\\\max\\_k V \\\\left(z^{(k)},y^{(k)}\\\\right),\\\\qquad \\\\hat{y}=y^{(k^\\\\star)}, where VVV is a trained verifier as introduced with GSM8K by [Cobbe et al. (2021)](https://arxiv.org/abs/2110.14168). This turns evaluation into a two-stage generate‚Äìverify pipeline. Process supervision work such as Let‚Äôs Verify Step by Step by [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050) further scores intermediate steps, not just outcomes.\n*   **Interfaces that matter on GSM8K**:\n    *   CoT prompting and self-consistency are especially effective. Self-Consistency Improves CoT Reasoning by [Wang et al. (2022)](https://arxiv.org/abs/2203.11171) showed large gains on GSM8K by sampling diverse chains and marginalizing answers, effectively approximating yÃÇ¬†\\=argmaxy‚àëKk\\=1ùïÄ\\[y(k)\\=y\\]y^\\=arg‚Å°maxy‚àëk\\=1KI\\[y(k)\\=y\\]\\\\hat{y}=\\\\arg\\\\max\\_y \\\\sum\\_{k=1}^{K}\\\\mathbb{I} \\\\left\\[y^{(k)}=y\\\\right\\].\n*   **Common pitfalls and controls:**\n    \n    *   **Overfitting to surface templates:** vary paraphrases and numerical spans.\n    *   **Interface confounds:** report with and without CoT and self-consistency.\n    *   **Verifier over-reliance:** ensure the verifier isn‚Äôt shortcutting via superficial cues; ablate with randomized chains.\n    *   Report smooth metrics (log-prob, Brier/ECE) alongside EM to avoid ‚Äúmirage‚Äù emergence effects.\n*   **What to report for reproducibility:**\n    *   Decoding temperatures and sample count KKK, prompt format (few-shot exemplars and formatting), normalization rules for numeric answers, verifier architecture and training data, and any process-level scoring.\n    *   Where feasible, release prompts, sampled chains, and verifier decision logs to enable step-level auditing.\n\nGSM8K by [Cobbe et al. (2021)](https://arxiv.org/abs/2110.14168) is a curated benchmark of 8.5K grade-school arithmetic word problems designed to probe multi-step reasoning with simple operations. The official repository summarizes a split of 7.5K training problems and 1K test problems, with solutions that typically require 2‚Äì8 steps (see [dataset card](https://github.com/openai/grade-school-math)). GSM8K is often used to detect ‚Äúaha‚Äù-style thresholding because exact-match performance can jump sharply when models begin to reliably compose intermediate steps.\n\n*   Problems are crafted to be solvable by a bright middle-schooler yet require composing several elementary operations. The target is not retrieval but stepwise manipulation (counting, unit arithmetic, proportional reasoning). This favors methods that surface or verify intermediate traces.\n\n*   Given a problem x, the model produces a reasoning trace zzz and final answer yyy. Exact match is computed as EM\\=1N‚àëNi\\=1ùïÄ\\[yi\\=y‚ãÜi\\]EM\\=1N‚àëi\\=1NI\\[yi\\=yi‚ãÜ\\]\\\\text{EM}=\\\\frac{1}{N}\\\\sum\\_{i=1}^N \\\\mathbb{I}\\[y\\_i=y\\_i^\\\\star\\]. Because EMEM\\\\text{EM} is thresholded, small gains in pŒ∏(y‚ãÜ‚à£x)pŒ∏(y‚ãÜ‚à£x)p\\_\\\\theta(y^\\\\star\\\\mid x) can yield large apparent jumps. Many evaluations now pair EM with verifier selection: sample K candidate solutions (z(k),y(k))Kk\\=1(z(k),y(k))k\\=1K{(z^{(k)},y^{(k)})}\\_{k=1}^K and choose k‚ãÜ\\=argmaxkV(z(k),y(k)),yÃÇ¬†\\=y(k‚ãÜ)k‚ãÜ\\=arg‚Å°maxkV(z(k),y(k)),y^\\=y(k‚ãÜ)k^\\\\star=\\\\arg\\\\max\\_k V \\\\left(z^{(k)},y^{(k)}\\\\right),\\\\qquad \\\\hat{y}=y^{(k^\\\\star)}, where VVV is a trained verifier as introduced with GSM8K by [Cobbe et al. (2021)](https://arxiv.org/abs/2110.14168). This turns evaluation into a two-stage generate‚Äìverify pipeline. Process supervision work such as Let‚Äôs Verify Step by Step by [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050) further scores intermediate steps, not just outcomes.\n\n*   CoT prompting and self-consistency are especially effective. Self-Consistency Improves CoT Reasoning by [Wang et al. (2022)](https://arxiv.org/abs/2203.11171) showed large gains on GSM8K by sampling diverse chains and marginalizing answers, effectively approximating yÃÇ¬†\\=argmaxy‚àëKk\\=1ùïÄ\\[y(k)\\=y\\]y^\\=arg‚Å°maxy‚àëk\\=1KI\\[y(k)\\=y\\]\\\\hat{y}=\\\\arg\\\\max\\_y \\\\sum\\_{k=1}^{K}\\\\mathbb{I} \\\\left\\[y^{(k)}=y\\\\right\\].\n\n**Common pitfalls and controls:**\n\n*   **Overfitting to surface templates:** vary paraphrases and numerical spans.\n*   **Interface confounds:** report with and without CoT and self-consistency.\n*   **Verifier over-reliance:** ensure the verifier isn‚Äôt shortcutting via superficial cues; ablate with randomized chains.\n*   Report smooth metrics (log-prob, Brier/ECE) alongside EM to avoid ‚Äúmirage‚Äù emergence effects.\n\n*   Decoding temperatures and sample count KKK, prompt format (few-shot exemplars and formatting), normalization rules for numeric answers, verifier architecture and training data, and any process-level scoring.\n*   Where feasible, release prompts, sampled chains, and verifier decision logs to enable step-level auditing.",
    "order": 28,
    "orderInChapter": 1,
    "difficulty": 4,
    "estimatedMinutes": 4,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 701,
      "contentLength": 89317
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#gsm8k-(grade-school-math-reasoning)",
    "scrapedAt": "2025-12-28T11:54:00.656Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-purpose-and-design-29",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "MATH (competition-level Mathematical Reasoning)",
    "title": "Purpose and Design",
    "subtitle": "MATH (competition-level Mathematical Reasoning)",
    "contentHtml": "<ul>\n  <li>\n    <p>Where GSM8K tests arithmetic composition, MATH evaluates <strong>symbolic and abstract reasoning</strong> that requires structured derivations. Problems are sourced from math competitions (AMC, AIME, Olympiad-level) and rewritten to include human-readable reasoning steps.</p>\n  </li>\n  <li>\n    <p>Each sample <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-270-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msup><mi>z</mi><mo>&amp;#x22C6;</mo></msup><mo>,</mo><msup><mi>y</mi><mo>&amp;#x22C6;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4290\" style=\"width: 4.846em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.013em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1003.96em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4291\"><span class=\"mo\" id=\"MathJax-Span-4292\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4293\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4294\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4295\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4296\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-4297\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4298\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4299\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4300\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4301\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4302\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msup><mi>z</mi><mo>‚ãÜ</mo></msup><mo>,</mo><msup><mi>y</mi><mo>‚ãÜ</mo></msup><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-270\">(x, z^\\star, y^\\star)</script> includes:</p>\n\n    <ul>\n      <li>Problem text <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-271-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4303\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4304\"><span class=\"mi\" id=\"MathJax-Span-4305\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-271\">x</script></li>\n      <li>Step-by-step reasoning <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-272-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mo>&amp;#x22C6;</mo></msup><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>z</mi><mi>T</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4306\" style=\"width: 8.076em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.721em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1006.67em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4307\"><span class=\"msubsup\" id=\"MathJax-Span-4308\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4309\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-4310\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4311\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-4312\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4313\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4314\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-4315\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4316\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-4317\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-4318\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4319\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4320\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4321\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4322\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>z</mi><mo>‚ãÜ</mo></msup><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msub><mi>z</mi><mi>T</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-272\">z^\\star = (z_1, \\ldots, z_T)</script></li>\n      <li>Final answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-273-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mo>&amp;#x22C6;</mo></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4323\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1000.99em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4324\"><span class=\"msubsup\" id=\"MathJax-Span-4325\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4326\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4327\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>y</mi><mo>‚ãÜ</mo></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-273\">y^\\star</script></li>\n    </ul>\n  </li>\n  <li>\n    <p>This supports supervision or verification at the process level rather than only on final outcomes.</p>\n  </li>\n</ul>\n<p>Where GSM8K tests arithmetic composition, MATH evaluates <strong>symbolic and abstract reasoning</strong> that requires structured derivations. Problems are sourced from math competitions (AMC, AIME, Olympiad-level) and rewritten to include human-readable reasoning steps.</p>\n<p>Each sample <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-270-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msup><mi>z</mi><mo>&amp;#x22C6;</mo></msup><mo>,</mo><msup><mi>y</mi><mo>&amp;#x22C6;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4290\" style=\"width: 4.846em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.013em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1003.96em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4291\"><span class=\"mo\" id=\"MathJax-Span-4292\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4293\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4294\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4295\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4296\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-4297\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4298\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4299\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4300\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4301\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4302\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msup><mi>z</mi><mo>‚ãÜ</mo></msup><mo>,</mo><msup><mi>y</mi><mo>‚ãÜ</mo></msup><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-270\">(x, z^\\star, y^\\star)</script> includes:</p>\n<ul>\n      <li>Problem text <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-271-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4303\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4304\"><span class=\"mi\" id=\"MathJax-Span-4305\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-271\">x</script></li>\n      <li>Step-by-step reasoning <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-272-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mo>&amp;#x22C6;</mo></msup><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>z</mi><mi>T</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4306\" style=\"width: 8.076em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.721em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1006.67em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4307\"><span class=\"msubsup\" id=\"MathJax-Span-4308\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4309\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-4310\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4311\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-4312\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4313\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4314\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-4315\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4316\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-4317\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚Ä¶</span><span class=\"mo\" id=\"MathJax-Span-4318\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4319\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4320\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4321\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4322\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>z</mi><mo>‚ãÜ</mo></msup><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><mo>‚Ä¶</mo><mo>,</mo><msub><mi>z</mi><mi>T</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-272\">z^\\star = (z_1, \\ldots, z_T)</script></li>\n      <li>Final answer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-273-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mo>&amp;#x22C6;</mo></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4323\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1000.99em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4324\"><span class=\"msubsup\" id=\"MathJax-Span-4325\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4326\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4327\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>y</mi><mo>‚ãÜ</mo></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-273\">y^\\star</script></li>\n    </ul>\n<p>This supports supervision or verification at the process level rather than only on final outcomes.</p>",
    "contentMarkdown": "*   Where GSM8K tests arithmetic composition, MATH evaluates **symbolic and abstract reasoning** that requires structured derivations. Problems are sourced from math competitions (AMC, AIME, Olympiad-level) and rewritten to include human-readable reasoning steps.\n    \n*   Each sample (x,z‚ãÜ,y‚ãÜ)(x,z‚ãÜ,y‚ãÜ)(x, z^\\\\star, y^\\\\star) includes:\n    \n    *   Problem text xxx\n    *   Step-by-step reasoning z‚ãÜ\\=(z1,‚Ä¶,zT)z‚ãÜ\\=(z1,‚Ä¶,zT)z^\\\\star = (z\\_1, \\\\ldots, z\\_T)\n    *   Final answer y‚ãÜy‚ãÜy^\\\\star\n*   This supports supervision or verification at the process level rather than only on final outcomes.\n    \n\nWhere GSM8K tests arithmetic composition, MATH evaluates **symbolic and abstract reasoning** that requires structured derivations. Problems are sourced from math competitions (AMC, AIME, Olympiad-level) and rewritten to include human-readable reasoning steps.\n\nEach sample (x,z‚ãÜ,y‚ãÜ)(x,z‚ãÜ,y‚ãÜ)(x, z^\\\\star, y^\\\\star) includes:\n\n*   Problem text xxx\n*   Step-by-step reasoning z‚ãÜ\\=(z1,‚Ä¶,zT)z‚ãÜ\\=(z1,‚Ä¶,zT)z^\\\\star = (z\\_1, \\\\ldots, z\\_T)\n*   Final answer y‚ãÜy‚ãÜy^\\\\star\n\nThis supports supervision or verification at the process level rather than only on final outcomes.",
    "order": 29,
    "orderInChapter": 1,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 139,
      "contentLength": 22770
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#purpose-and-design",
    "scrapedAt": "2025-12-28T11:54:00.656Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-evaluation-protocol-30",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "MATH (competition-level Mathematical Reasoning)",
    "title": "Evaluation Protocol",
    "subtitle": "MATH (competition-level Mathematical Reasoning)",
    "contentHtml": "<ul>\n  <li>Models generate reasoning chains <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-274-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4328\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4329\"><span class=\"mi\" id=\"MathJax-Span-4330\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-274\">z</script> and final answers <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-275-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4331\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4332\"><span class=\"mi\" id=\"MathJax-Span-4333\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-275\">y</script>.</li>\n  <li>Evaluation includes:</li>\n</ul>\n<ol>\n  <li>\n    <p><strong>Exact-match accuracy</strong>:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-276-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>EM</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></munder><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>&amp;#x22C6;</mo></msubsup><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4334\" style=\"width: 11.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.378em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.836em, 1009.27em, 3.753em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4335\"><span class=\"mtext\" id=\"MathJax-Span-4336\" style=\"font-family: STIXGeneral-Regular;\">EM</span><span class=\"mo\" id=\"MathJax-Span-4337\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-4338\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-4339\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.362em;\"><span class=\"mi\" id=\"MathJax-Span-4340\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.84em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.836em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-4341\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4342\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4343\"><span class=\"mrow\" id=\"MathJax-Span-4344\"><span class=\"mi\" id=\"MathJax-Span-4345\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4346\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4347\"><span class=\"mi\" id=\"MathJax-Span-4348\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-4349\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-4350\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4351\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4352\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4353\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4354\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4355\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.58em, 4.169em, -999.997em); top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4356\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4357\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4358\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mtext>EM</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi></mrow></munder><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>‚ãÜ</mo></msubsup><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-276\">\\text{EM} = \\frac{1}{N}\\sum_{i}\\mathbb{I}[y_i = y_i^\\star]</script>\n\n    <ul>\n      <li>Here, numeric normalization and symbolic equivalence checking (e.g., <code class=\"language-plaintext highlighter-rouge\">sympy.simplify</code>) are required because answers may differ syntactically but be mathematically identical.</li>\n    </ul>\n  </li>\n  <li><strong>Verifier-based scoring</strong>:\n    <ul>\n      <li>Separate verifiers or math solvers can re-execute each reasoning chain to confirm correctness.</li>\n      <li>The ‚Äúsolver check‚Äù procedure detects inconsistent or hallucinated intermediate results.</li>\n    </ul>\n  </li>\n  <li><strong>Step-level agreement</strong>:\n    <ul>\n      <li>Compare generated reasoning steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-277-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4359\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4360\"><span class=\"msubsup\" id=\"MathJax-Span-4361\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4362\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4363\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-277\">z_t</script> against gold steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-278-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>z</mi><mi>t</mi><mo>&amp;#x22C6;</mo></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4364\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1000.94em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4365\"><span class=\"msubsup\" id=\"MathJax-Span-4366\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4367\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.58em, 4.169em, -999.997em); top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-4368\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4369\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>z</mi><mi>t</mi><mo>‚ãÜ</mo></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-278\">z_t^\\star</script>, useful for process supervision or reward model training.</li>\n    </ul>\n  </li>\n</ol>\n<p><strong>Exact-match accuracy</strong>:</p>\n<ul>\n      <li>Here, numeric normalization and symbolic equivalence checking (e.g., <code class=\"language-plaintext highlighter-rouge\">sympy.simplify</code>) are required because answers may differ syntactically but be mathematically identical.</li>\n    </ul>\n<ul>\n      <li>Separate verifiers or math solvers can re-execute each reasoning chain to confirm correctness.</li>\n      <li>The ‚Äúsolver check‚Äù procedure detects inconsistent or hallucinated intermediate results.</li>\n    </ul>\n<ul>\n      <li>Compare generated reasoning steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-277-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4359\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4360\"><span class=\"msubsup\" id=\"MathJax-Span-4361\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4362\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4363\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-277\">z_t</script> against gold steps <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-278-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>z</mi><mi>t</mi><mo>&amp;#x22C6;</mo></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4364\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1000.94em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4365\"><span class=\"msubsup\" id=\"MathJax-Span-4366\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4367\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.58em, 4.169em, -999.997em); top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-4368\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4369\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>z</mi><mi>t</mi><mo>‚ãÜ</mo></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-278\">z_t^\\star</script>, useful for process supervision or reward model training.</li>\n    </ul>",
    "contentMarkdown": "*   Models generate reasoning chains zzz and final answers yyy.\n*   Evaluation includes:\n\n1.  **Exact-match accuracy**:\n    \n    EM\\=1N‚àëiùïÄ\\[yi\\=y‚ãÜi\\]EM\\=1N‚àëiI\\[yi\\=yi‚ãÜ\\]\n    \n    \\\\text{EM} = \\\\frac{1}{N}\\\\sum\\_{i}\\\\mathbb{I}\\[y\\_i = y\\_i^\\\\star\\]\n    *   Here, numeric normalization and symbolic equivalence checking (e.g., `sympy.simplify`) are required because answers may differ syntactically but be mathematically identical.\n2.  **Verifier-based scoring**:\n    *   Separate verifiers or math solvers can re-execute each reasoning chain to confirm correctness.\n    *   The ‚Äúsolver check‚Äù procedure detects inconsistent or hallucinated intermediate results.\n3.  **Step-level agreement**:\n    *   Compare generated reasoning steps ztztz\\_t against gold steps z‚ãÜtzt‚ãÜz\\_t^\\\\star, useful for process supervision or reward model training.\n\n**Exact-match accuracy**:\n\n*   Here, numeric normalization and symbolic equivalence checking (e.g., `sympy.simplify`) are required because answers may differ syntactically but be mathematically identical.\n\n*   Separate verifiers or math solvers can re-execute each reasoning chain to confirm correctness.\n*   The ‚Äúsolver check‚Äù procedure detects inconsistent or hallucinated intermediate results.\n\n*   Compare generated reasoning steps ztztz\\_t against gold steps z‚ãÜtzt‚ãÜz\\_t^\\\\star, useful for process supervision or reward model training.",
    "order": 30,
    "orderInChapter": 2,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": true,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 158,
      "contentLength": 19121
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#evaluation-protocol",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-interfaces-and-findings-31",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "MATH (competition-level Mathematical Reasoning)",
    "title": "Interfaces and Findings",
    "subtitle": "MATH (competition-level Mathematical Reasoning)",
    "contentHtml": "<ul>\n  <li><strong>CoT prompting</strong> significantly improves performance compared to direct-answer prompting, confirming that explicit intermediate steps help symbolic reasoning.</li>\n  <li><strong>Self-consistency decoding</strong> (sampling multiple CoT paths and voting) further stabilizes results, as shown by <a href=\"https://arxiv.org/abs/2203.11171\">Wang et al. (2022)</a>.</li>\n  <li>\n    <p><strong>Process-supervised fine-tuning</strong>‚Äîtraining on correct intermediate steps‚Äîyields more interpretable and verifiable reasoning chains (see <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a>).</p>\n  </li>\n  <li>Recent improvements, including RL fine-tuning (e.g., <em>DeepSeek-R1</em> by <a href=\"https://arxiv.org/abs/2501.12948\">Guo et al. (2025)</a>), demonstrate that unsupervised reward shaping can further enhance reasoning without explicit step labels.</li>\n</ul>\n<p><strong>Process-supervised fine-tuning</strong>‚Äîtraining on correct intermediate steps‚Äîyields more interpretable and verifiable reasoning chains (see <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a>).</p>",
    "contentMarkdown": "*   **CoT prompting** significantly improves performance compared to direct-answer prompting, confirming that explicit intermediate steps help symbolic reasoning.\n*   **Self-consistency decoding** (sampling multiple CoT paths and voting) further stabilizes results, as shown by [Wang et al. (2022)](https://arxiv.org/abs/2203.11171).\n*   **Process-supervised fine-tuning**‚Äîtraining on correct intermediate steps‚Äîyields more interpretable and verifiable reasoning chains (see [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050)).\n    \n*   Recent improvements, including RL fine-tuning (e.g., _DeepSeek-R1_ by [Guo et al. (2025)](https://arxiv.org/abs/2501.12948)), demonstrate that unsupervised reward shaping can further enhance reasoning without explicit step labels.\n\n**Process-supervised fine-tuning**‚Äîtraining on correct intermediate steps‚Äîyields more interpretable and verifiable reasoning chains (see [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050)).",
    "order": 31,
    "orderInChapter": 3,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 98,
      "contentLength": 1132
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#interfaces-and-findings",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-advantages-32",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "MATH (competition-level Mathematical Reasoning)",
    "title": "Advantages",
    "subtitle": "MATH (competition-level Mathematical Reasoning)",
    "contentHtml": "<ul>\n  <li>Explicit reasoning labels make it ideal for <strong>process-level evaluation and training</strong>.</li>\n  <li>Covers a broad range of reasoning types‚Äîfrom algebraic manipulation to geometric proof sketching.</li>\n  <li>Provides a benchmark for assessing symbolic and logical generalization.</li>\n</ul>",
    "contentMarkdown": "*   Explicit reasoning labels make it ideal for **process-level evaluation and training**.\n*   Covers a broad range of reasoning types‚Äîfrom algebraic manipulation to geometric proof sketching.\n*   Provides a benchmark for assessing symbolic and logical generalization.",
    "order": 32,
    "orderInChapter": 4,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 36,
      "contentLength": 313
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#advantages",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-limitations-33",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "MATH (competition-level Mathematical Reasoning)",
    "title": "Limitations",
    "subtitle": "MATH (competition-level Mathematical Reasoning)",
    "contentHtml": "<ul>\n  <li>Heavy reliance on domain-specific knowledge; general LLMs may fail without fine-tuning.</li>\n  <li>Sensitive to formatting, LaTeX parsing, and equivalence evaluation.</li>\n  <li>High variance due to the compositional nature of mathematical syntax.</li>\n</ul>",
    "contentMarkdown": "*   Heavy reliance on domain-specific knowledge; general LLMs may fail without fine-tuning.\n*   Sensitive to formatting, LaTeX parsing, and equivalence evaluation.\n*   High variance due to the compositional nature of mathematical syntax.",
    "order": 33,
    "orderInChapter": 5,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "llm",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 32,
      "contentLength": 269
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#limitations",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-relation-to-gsm8k-34",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "MATH (competition-level Mathematical Reasoning)",
    "title": "Relation to GSM8K",
    "subtitle": "MATH (competition-level Mathematical Reasoning)",
    "contentHtml": "<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Aspect</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>GSM8K</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>MATH</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Domain</td>\n<td class=\"tg-tleft-valign-first\">Everyday arithmetic</td>\n<td class=\"tg-tleft-valign-second\">Competition mathematics</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Solution style</td>\n<td class=\"tg-tleft-valign-first\">Natural language steps</td>\n<td class=\"tg-tleft-valign-second\">Formal math derivations</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Difficulty</td>\n<td class=\"tg-tleft-valign-first\">Grade-school</td>\n<td class=\"tg-tleft-valign-second\">High school to college</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Step annotation</td>\n<td class=\"tg-tleft-valign-first\">Implicit</td>\n<td class=\"tg-tleft-valign-second\">Explicit (LaTeX and text)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Evaluation</td>\n<td class=\"tg-tleft-valign-first\">Numeric EM, verifier</td>\n<td class=\"tg-tleft-valign-second\">Symbolic EM, reasoning trace verification</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Aspect</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>GSM8K</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>MATH</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Domain</td>\n<td class=\"tg-tleft-valign-first\">Everyday arithmetic</td>\n<td class=\"tg-tleft-valign-second\">Competition mathematics</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Solution style</td>\n<td class=\"tg-tleft-valign-first\">Natural language steps</td>\n<td class=\"tg-tleft-valign-second\">Formal math derivations</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Difficulty</td>\n<td class=\"tg-tleft-valign-first\">Grade-school</td>\n<td class=\"tg-tleft-valign-second\">High school to college</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Step annotation</td>\n<td class=\"tg-tleft-valign-first\">Implicit</td>\n<td class=\"tg-tleft-valign-second\">Explicit (LaTeX and text)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Evaluation</td>\n<td class=\"tg-tleft-valign-first\">Numeric EM, verifier</td>\n<td class=\"tg-tleft-valign-second\">Symbolic EM, reasoning trace verification</td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "**Aspect**\n\n**GSM8K**\n\n**MATH**\n\nDomain\n\nEveryday arithmetic\n\nCompetition mathematics\n\nSolution style\n\nNatural language steps\n\nFormal math derivations\n\nDifficulty\n\nGrade-school\n\nHigh school to college\n\nStep annotation\n\nImplicit\n\nExplicit (LaTeX and text)\n\nEvaluation\n\nNumeric EM, verifier\n\nSymbolic EM, reasoning trace verification\n\n**Aspect**\n\n**GSM8K**\n\n**MATH**\n\nDomain\n\nEveryday arithmetic\n\nCompetition mathematics\n\nSolution style\n\nNatural language steps\n\nFormal math derivations\n\nDifficulty\n\nGrade-school\n\nHigh school to college\n\nStep annotation\n\nImplicit\n\nExplicit (LaTeX and text)\n\nEvaluation\n\nNumeric EM, verifier\n\nSymbolic EM, reasoning trace verification",
    "order": 34,
    "orderInChapter": 6,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 76,
      "contentLength": 2419
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#relation-to-gsm8k",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-recommended-reporting-35",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "MATH (competition-level Mathematical Reasoning)",
    "title": "Recommended Reporting",
    "subtitle": "MATH (competition-level Mathematical Reasoning)",
    "contentHtml": "<ul>\n  <li>Report both <strong>accuracy</strong> and <strong>step-consistency</strong> metrics.</li>\n  <li>Include <strong>per-topic breakdowns</strong> (algebra, geometry, etc.).</li>\n  <li>Use <strong>symbolic equivalence checks</strong> for fairness.</li>\n  <li>Where applicable, publish verifier logs and intermediate derivations for transparency.</li>\n</ul>",
    "contentMarkdown": "*   Report both **accuracy** and **step-consistency** metrics.\n*   Include **per-topic breakdowns** (algebra, geometry, etc.).\n*   Use **symbolic equivalence checks** for fairness.\n*   Where applicable, publish verifier logs and intermediate derivations for transparency.",
    "order": 35,
    "orderInChapter": 7,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 32,
      "contentLength": 362
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#recommended-reporting",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-aime-dataset-openais-aime-and-aime24-benchmarks-36",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "AIME and IMO: Mathematical Olympiad‚ÄìLevel Reasoning",
    "title": "AIME Dataset (OpenAI‚Äôs AIME and AIME24 Benchmarks)",
    "subtitle": "AIME and IMO: Mathematical Olympiad‚ÄìLevel Reasoning",
    "contentHtml": "<ul>\n  <li>The <strong>AIME</strong> benchmark originated from OpenAI‚Äôs evaluations of <strong>mathematical reasoning competence</strong> in GPT models, with early references appearing in <a href=\"https://cdn.openai.com/papers/gpt-4-system-card.pdf\">OpenAI‚Äôs technical system card for GPT-4 (2023)</a> and follow-up analyses by the research community.</li>\n  <li>\n    <p>Recently, curated versions such as <strong>AIME24</strong>, <strong>AIME‚Äô23</strong>, and <strong>AIME‚Äô25</strong> test sets have been used to track reasoning evolution in frontier models including GPT-4, DeepSeek-R1, and Claude 3 Opus.</p>\n  </li>\n  <li>\n    <p><strong>Structure:</strong></p>\n\n    <ul>\n      <li>15 competition-grade problems per year.</li>\n      <li>Each problem has an integer answer between 0 and 999.</li>\n      <li>Questions cover algebra, number theory, geometry, and combinatorics.</li>\n      <li>Each problem requires 3‚Äì10 reasoning steps‚Äîoften with nested sub-problems.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Example:</strong> ‚ÄúHow many positive integers (n) satisfy (n^2 + 12n - 2007 = k^2) for some integer (k)?‚Äù</p>\n  </li>\n  <li>\n    <p>Solving this requires:</p>\n\n    <ol>\n      <li>Completing the square: (n^2 + 12n = k^2 + 2007).</li>\n      <li>Reformulating as a Diophantine condition.</li>\n      <li>Identifying integer constraints and counting solutions.</li>\n    </ol>\n  </li>\n</ul>\n<p>Recently, curated versions such as <strong>AIME24</strong>, <strong>AIME‚Äô23</strong>, and <strong>AIME‚Äô25</strong> test sets have been used to track reasoning evolution in frontier models including GPT-4, DeepSeek-R1, and Claude 3 Opus.</p>\n<p><strong>Structure:</strong></p>\n<ul>\n      <li>15 competition-grade problems per year.</li>\n      <li>Each problem has an integer answer between 0 and 999.</li>\n      <li>Questions cover algebra, number theory, geometry, and combinatorics.</li>\n      <li>Each problem requires 3‚Äì10 reasoning steps‚Äîoften with nested sub-problems.</li>\n    </ul>\n<p><strong>Example:</strong> ‚ÄúHow many positive integers (n) satisfy (n^2 + 12n - 2007 = k^2) for some integer (k)?‚Äù</p>\n<p>Solving this requires:</p>\n<ol>\n      <li>Completing the square: (n^2 + 12n = k^2 + 2007).</li>\n      <li>Reformulating as a Diophantine condition.</li>\n      <li>Identifying integer constraints and counting solutions.</li>\n    </ol>",
    "contentMarkdown": "*   The **AIME** benchmark originated from OpenAI‚Äôs evaluations of **mathematical reasoning competence** in GPT models, with early references appearing in [OpenAI‚Äôs technical system card for GPT-4 (2023)](https://cdn.openai.com/papers/gpt-4-system-card.pdf) and follow-up analyses by the research community.\n*   Recently, curated versions such as **AIME24**, **AIME‚Äô23**, and **AIME‚Äô25** test sets have been used to track reasoning evolution in frontier models including GPT-4, DeepSeek-R1, and Claude 3 Opus.\n    \n*   **Structure:**\n    \n    *   15 competition-grade problems per year.\n    *   Each problem has an integer answer between 0 and 999.\n    *   Questions cover algebra, number theory, geometry, and combinatorics.\n    *   Each problem requires 3‚Äì10 reasoning steps‚Äîoften with nested sub-problems.\n*   **Example:** ‚ÄúHow many positive integers (n) satisfy (n^2 + 12n - 2007 = k^2) for some integer (k)?‚Äù\n    \n*   Solving this requires:\n    \n    1.  Completing the square: (n^2 + 12n = k^2 + 2007).\n    2.  Reformulating as a Diophantine condition.\n    3.  Identifying integer constraints and counting solutions.\n\nRecently, curated versions such as **AIME24**, **AIME‚Äô23**, and **AIME‚Äô25** test sets have been used to track reasoning evolution in frontier models including GPT-4, DeepSeek-R1, and Claude 3 Opus.\n\n**Structure:**\n\n*   15 competition-grade problems per year.\n*   Each problem has an integer answer between 0 and 999.\n*   Questions cover algebra, number theory, geometry, and combinatorics.\n*   Each problem requires 3‚Äì10 reasoning steps‚Äîoften with nested sub-problems.\n\n**Example:** ‚ÄúHow many positive integers (n) satisfy (n^2 + 12n - 2007 = k^2) for some integer (k)?‚Äù\n\nSolving this requires:\n\n1.  Completing the square: (n^2 + 12n = k^2 + 2007).\n2.  Reformulating as a Diophantine condition.\n3.  Identifying integer constraints and counting solutions.",
    "order": 36,
    "orderInChapter": 1,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "nlpllms",
      "gpt"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 258,
      "contentLength": 2348
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#aime-dataset-(openai‚Äôs-aime-and-aime24-benchmarks)",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-why-aime-is-a-pure-reasoning-benchmark-37",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "AIME and IMO: Mathematical Olympiad‚ÄìLevel Reasoning",
    "title": "Why AIME is a ‚ÄúPure‚Äù Reasoning Benchmark",
    "subtitle": "AIME and IMO: Mathematical Olympiad‚ÄìLevel Reasoning",
    "contentHtml": "<ul>\n  <li>AIME problems are deliberately <strong>non-retrievable</strong>‚Äîthey do not rely on memorized facts but on algebraic and logical construction.</li>\n  <li>This means models cannot rely on pattern recognition alone; instead, they must generate intermediate transformations such as:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-279-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mn>12</mn><mi>n</mi><mo>&amp;#x2212;</mo><mn>2007</mn><mo>=</mo><msup><mi>k</mi><mn>2</mn></msup><mo stretchy=&quot;false&quot;>&amp;#x21D2;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>+</mo><mn>6</mn><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mo>&amp;#x2212;</mo><msup><mi>k</mi><mn>2</mn></msup><mo>=</mo><mn>2043.</mn></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4370\" style=\"width: 22.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 18.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.461em, 1018.91em, 2.815em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4371\"><span class=\"msubsup\" id=\"MathJax-Span-4372\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4373\" style=\"font-family: STIXGeneral-Italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-4374\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4375\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-4376\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">12</span><span class=\"mi\" id=\"MathJax-Span-4377\" style=\"font-family: STIXGeneral-Italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-4378\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-4379\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">2007</span><span class=\"mo\" id=\"MathJax-Span-4380\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4381\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4382\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-4383\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4384\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚áí</span><span class=\"mo\" id=\"MathJax-Span-4385\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"mi\" id=\"MathJax-Span-4386\" style=\"font-family: STIXGeneral-Italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-4387\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-4388\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">6</span><span class=\"msubsup\" id=\"MathJax-Span-4389\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4390\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.315em;\"><span class=\"mn\" id=\"MathJax-Span-4391\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4392\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-4393\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4394\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-4395\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4396\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-4397\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">2043.</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mn>12</mn><mi>n</mi><mo>‚àí</mo><mn>2007</mn><mo>=</mo><msup><mi>k</mi><mn>2</mn></msup><mo stretchy=\"false\">‚áí</mo><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mn>6</mn><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>‚àí</mo><msup><mi>k</mi><mn>2</mn></msup><mo>=</mo><mn>2043.</mn></math></span></span></div>\n<ul>\n  <li>\n    <p>Then solve for integer factors of 2043, reasoning about parity and divisibility.</p>\n  </li>\n  <li>\n    <p>Thus, performance on AIME directly reflects the model‚Äôs <em>symbolic abstraction ability</em>, <em>logical completeness</em>, and <em>numerical stability</em> in long reasoning chains.</p>\n  </li>\n</ul>\n<p>Then solve for integer factors of 2043, reasoning about parity and divisibility.</p>\n<p>Thus, performance on AIME directly reflects the model‚Äôs <em>symbolic abstraction ability</em>, <em>logical completeness</em>, and <em>numerical stability</em> in long reasoning chains.</p>",
    "contentMarkdown": "*   AIME problems are deliberately **non-retrievable**‚Äîthey do not rely on memorized facts but on algebraic and logical construction.\n*   This means models cannot rely on pattern recognition alone; instead, they must generate intermediate transformations such as:\n\nn2+12n‚àí2007\\=k2‚áí(n+6)2‚àík2\\=2043.n2+12n‚àí2007\\=k2‚áí(n+6)2‚àík2\\=2043.\n\n*   Then solve for integer factors of 2043, reasoning about parity and divisibility.\n    \n*   Thus, performance on AIME directly reflects the model‚Äôs _symbolic abstraction ability_, _logical completeness_, and _numerical stability_ in long reasoning chains.\n    \n\nThen solve for integer factors of 2043, reasoning about parity and divisibility.\n\nThus, performance on AIME directly reflects the model‚Äôs _symbolic abstraction ability_, _logical completeness_, and _numerical stability_ in long reasoning chains.",
    "order": 37,
    "orderInChapter": 2,
    "difficulty": 5,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 103,
      "contentLength": 7227
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#why-aime-is-a-‚Äúpure‚Äù-reasoning-benchmark",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-evaluation-methodology-38",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "AIME and IMO: Mathematical Olympiad‚ÄìLevel Reasoning",
    "title": "Evaluation Methodology",
    "subtitle": "AIME and IMO: Mathematical Olympiad‚ÄìLevel Reasoning",
    "contentHtml": "<ul>\n  <li><strong>Accuracy</strong> is measured as the percentage of correct integer answers across 15 problems:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-280-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>Acc</mtext><mo>=</mo><mfrac><mn>1</mn><mn>15</mn></mfrac><munder><mo>&amp;#x2211;</mo><mi>i</mi></munder><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>&amp;#x22C6;</mo></msubsup><mo stretchy=&quot;false&quot;>]</mo><mo>.</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4398\" style=\"width: 12.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.055em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.836em, 1010em, 3.753em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4399\"><span class=\"mtext\" id=\"MathJax-Span-4400\" style=\"font-family: STIXGeneral-Regular;\">Acc</span><span class=\"mo\" id=\"MathJax-Span-4401\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-4402\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-4403\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1000.94em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.518em;\"><span class=\"mn\" id=\"MathJax-Span-4404\" style=\"font-family: STIXGeneral-Regular;\">15</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1001.15em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.148em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-4405\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4406\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.576em;\"><span class=\"mi\" id=\"MathJax-Span-4407\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4408\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4409\"><span class=\"mi\" id=\"MathJax-Span-4410\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-4411\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-4412\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4413\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4414\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4415\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4416\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4417\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.58em, 4.169em, -999.997em); top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4418\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4419\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4420\" style=\"font-family: STIXGeneral-Regular;\">]</span><span class=\"mo\" id=\"MathJax-Span-4421\" style=\"font-family: STIXGeneral-Regular;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mtext>Acc</mtext><mo>=</mo><mfrac><mn>1</mn><mn>15</mn></mfrac><munder><mo>‚àë</mo><mi>i</mi></munder><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>‚ãÜ</mo></msubsup><mo stretchy=\"false\">]</mo><mo>.</mo></math></span></span></div>\n<ul>\n  <li>Given the discrete numeric range, random guessing yields only 0.1 % expected accuracy.</li>\n  <li>\n    <p>Hence, even modest accuracy (20‚Äì40 %) represents nontrivial reasoning ability.</p>\n  </li>\n  <li>Modern evaluations also include <strong>CoT verification</strong>, where models must show step-by-step derivations.</li>\n  <li>For example, <a href=\"https://arxiv.org/abs/2501.12948\">DeepSeek-R1 (Guo et al. (2025))</a> achieved strong results on AIME‚Äô24 and AIME‚Äô25 using <em>unsupervised reinforcement fine-tuning</em> that directly optimized for reasoning correctness without labeled solutions.</li>\n</ul>\n<p>Hence, even modest accuracy (20‚Äì40 %) represents nontrivial reasoning ability.</p>",
    "contentMarkdown": "*   **Accuracy** is measured as the percentage of correct integer answers across 15 problems:\n\nAcc\\=115‚àëiùïÄ\\[yi\\=y‚ãÜi\\].Acc\\=115‚àëiI\\[yi\\=yi‚ãÜ\\].\n\n*   Given the discrete numeric range, random guessing yields only 0.1 % expected accuracy.\n*   Hence, even modest accuracy (20‚Äì40 %) represents nontrivial reasoning ability.\n    \n*   Modern evaluations also include **CoT verification**, where models must show step-by-step derivations.\n*   For example, [DeepSeek-R1 (Guo et al. (2025))](https://arxiv.org/abs/2501.12948) achieved strong results on AIME‚Äô24 and AIME‚Äô25 using _unsupervised reinforcement fine-tuning_ that directly optimized for reasoning correctness without labeled solutions.\n\nHence, even modest accuracy (20‚Äì40 %) represents nontrivial reasoning ability.",
    "order": 38,
    "orderInChapter": 3,
    "difficulty": 5,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 91,
      "contentLength": 7153
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#evaluation-methodology",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-imo-style-problems-and-datasets-39",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "AIME and IMO: Mathematical Olympiad‚ÄìLevel Reasoning",
    "title": "IMO-Style Problems and Datasets",
    "subtitle": "AIME and IMO: Mathematical Olympiad‚ÄìLevel Reasoning",
    "contentHtml": "<ul>\n  <li>\n    <p>The <strong>International Mathematical Olympiad (IMO)</strong> represents the highest level of pre-college mathematical reasoning.\nEach annual IMO features six proof-based problems over two days, requiring creative, multi-lemma arguments rather than formulaic manipulation.\nWhile no official IMO benchmark exists for open LLM evaluation, several datasets have emerged that capture this flavor:</p>\n\n    <ol>\n      <li>\n        <p><strong>MiniF2F</strong> by <a href=\"https://arxiv.org/abs/2109.00128\">Zheng et al. (2021)</a>:</p>\n\n        <ul>\n          <li>488 formalized math competition problems, including AIME, AMC, and IMO-like tasks.</li>\n          <li>Formulated for theorem provers such as Lean and Isabelle.</li>\n          <li>Used to test formal reasoning and theorem-proving capabilities.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>IMO Grand Challenge (OpenAI Formal Mathematics Dataset 2022‚Äì2024):</strong></p>\n\n        <ul>\n          <li>Informal and formal versions of IMO-level problems released for research on formal reasoning.</li>\n          <li>Evaluates both natural-language reasoning and formal proof synthesis.</li>\n          <li>Models must convert text statements into symbolic proof steps.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>ProofNet and LeanDojo</strong> (<a href=\"https://arxiv.org/abs/2202.01344\">Polu et al. (2022)</a>; <a href=\"https://arxiv.org/abs/2306.04788\">Zheng et al. (2023)</a>):</p>\n\n        <ul>\n          <li>Contain IMO-like formal proofs represented in Lean.</li>\n          <li>Allow objective scoring of proof correctness.</li>\n        </ul>\n      </li>\n    </ol>\n  </li>\n  <li>\n    <p>These datasets bridge <strong>mathematical language understanding</strong> and <strong>formal symbolic reasoning</strong>, advancing LLMs from numeric manipulation to verifiable theorem-level reasoning.</p>\n  </li>\n</ul>\n<p>The <strong>International Mathematical Olympiad (IMO)</strong> represents the highest level of pre-college mathematical reasoning.\nEach annual IMO features six proof-based problems over two days, requiring creative, multi-lemma arguments rather than formulaic manipulation.\nWhile no official IMO benchmark exists for open LLM evaluation, several datasets have emerged that capture this flavor:</p>\n<ol>\n      <li>\n        <p><strong>MiniF2F</strong> by <a href=\"https://arxiv.org/abs/2109.00128\">Zheng et al. (2021)</a>:</p>\n\n        <ul>\n          <li>488 formalized math competition problems, including AIME, AMC, and IMO-like tasks.</li>\n          <li>Formulated for theorem provers such as Lean and Isabelle.</li>\n          <li>Used to test formal reasoning and theorem-proving capabilities.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>IMO Grand Challenge (OpenAI Formal Mathematics Dataset 2022‚Äì2024):</strong></p>\n\n        <ul>\n          <li>Informal and formal versions of IMO-level problems released for research on formal reasoning.</li>\n          <li>Evaluates both natural-language reasoning and formal proof synthesis.</li>\n          <li>Models must convert text statements into symbolic proof steps.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>ProofNet and LeanDojo</strong> (<a href=\"https://arxiv.org/abs/2202.01344\">Polu et al. (2022)</a>; <a href=\"https://arxiv.org/abs/2306.04788\">Zheng et al. (2023)</a>):</p>\n\n        <ul>\n          <li>Contain IMO-like formal proofs represented in Lean.</li>\n          <li>Allow objective scoring of proof correctness.</li>\n        </ul>\n      </li>\n    </ol>\n<p><strong>MiniF2F</strong> by <a href=\"https://arxiv.org/abs/2109.00128\">Zheng et al. (2021)</a>:</p>\n<ul>\n          <li>488 formalized math competition problems, including AIME, AMC, and IMO-like tasks.</li>\n          <li>Formulated for theorem provers such as Lean and Isabelle.</li>\n          <li>Used to test formal reasoning and theorem-proving capabilities.</li>\n        </ul>\n<p><strong>IMO Grand Challenge (OpenAI Formal Mathematics Dataset 2022‚Äì2024):</strong></p>\n<ul>\n          <li>Informal and formal versions of IMO-level problems released for research on formal reasoning.</li>\n          <li>Evaluates both natural-language reasoning and formal proof synthesis.</li>\n          <li>Models must convert text statements into symbolic proof steps.</li>\n        </ul>\n<p><strong>ProofNet and LeanDojo</strong> (<a href=\"https://arxiv.org/abs/2202.01344\">Polu et al. (2022)</a>; <a href=\"https://arxiv.org/abs/2306.04788\">Zheng et al. (2023)</a>):</p>\n<ul>\n          <li>Contain IMO-like formal proofs represented in Lean.</li>\n          <li>Allow objective scoring of proof correctness.</li>\n        </ul>\n<p>These datasets bridge <strong>mathematical language understanding</strong> and <strong>formal symbolic reasoning</strong>, advancing LLMs from numeric manipulation to verifiable theorem-level reasoning.</p>",
    "contentMarkdown": "*   The **International Mathematical Olympiad (IMO)** represents the highest level of pre-college mathematical reasoning. Each annual IMO features six proof-based problems over two days, requiring creative, multi-lemma arguments rather than formulaic manipulation. While no official IMO benchmark exists for open LLM evaluation, several datasets have emerged that capture this flavor:\n    \n    1.  **MiniF2F** by [Zheng et al. (2021)](https://arxiv.org/abs/2109.00128):\n        \n        *   488 formalized math competition problems, including AIME, AMC, and IMO-like tasks.\n        *   Formulated for theorem provers such as Lean and Isabelle.\n        *   Used to test formal reasoning and theorem-proving capabilities.\n    2.  **IMO Grand Challenge (OpenAI Formal Mathematics Dataset 2022‚Äì2024):**\n        \n        *   Informal and formal versions of IMO-level problems released for research on formal reasoning.\n        *   Evaluates both natural-language reasoning and formal proof synthesis.\n        *   Models must convert text statements into symbolic proof steps.\n    3.  **ProofNet and LeanDojo** ([Polu et al. (2022)](https://arxiv.org/abs/2202.01344); [Zheng et al. (2023)](https://arxiv.org/abs/2306.04788)):\n        \n        *   Contain IMO-like formal proofs represented in Lean.\n        *   Allow objective scoring of proof correctness.\n*   These datasets bridge **mathematical language understanding** and **formal symbolic reasoning**, advancing LLMs from numeric manipulation to verifiable theorem-level reasoning.\n    \n\nThe **International Mathematical Olympiad (IMO)** represents the highest level of pre-college mathematical reasoning. Each annual IMO features six proof-based problems over two days, requiring creative, multi-lemma arguments rather than formulaic manipulation. While no official IMO benchmark exists for open LLM evaluation, several datasets have emerged that capture this flavor:\n\n1.  **MiniF2F** by [Zheng et al. (2021)](https://arxiv.org/abs/2109.00128):\n    \n    *   488 formalized math competition problems, including AIME, AMC, and IMO-like tasks.\n    *   Formulated for theorem provers such as Lean and Isabelle.\n    *   Used to test formal reasoning and theorem-proving capabilities.\n2.  **IMO Grand Challenge (OpenAI Formal Mathematics Dataset 2022‚Äì2024):**\n    \n    *   Informal and formal versions of IMO-level problems released for research on formal reasoning.\n    *   Evaluates both natural-language reasoning and formal proof synthesis.\n    *   Models must convert text statements into symbolic proof steps.\n3.  **ProofNet and LeanDojo** ([Polu et al. (2022)](https://arxiv.org/abs/2202.01344); [Zheng et al. (2023)](https://arxiv.org/abs/2306.04788)):\n    \n    *   Contain IMO-like formal proofs represented in Lean.\n    *   Allow objective scoring of proof correctness.\n\n**MiniF2F** by [Zheng et al. (2021)](https://arxiv.org/abs/2109.00128):\n\n*   488 formalized math competition problems, including AIME, AMC, and IMO-like tasks.\n*   Formulated for theorem provers such as Lean and Isabelle.\n*   Used to test formal reasoning and theorem-proving capabilities.\n\n**IMO Grand Challenge (OpenAI Formal Mathematics Dataset 2022‚Äì2024):**\n\n*   Informal and formal versions of IMO-level problems released for research on formal reasoning.\n*   Evaluates both natural-language reasoning and formal proof synthesis.\n*   Models must convert text statements into symbolic proof steps.\n\n**ProofNet and LeanDojo** ([Polu et al. (2022)](https://arxiv.org/abs/2202.01344); [Zheng et al. (2023)](https://arxiv.org/abs/2306.04788)):\n\n*   Contain IMO-like formal proofs represented in Lean.\n*   Allow objective scoring of proof correctness.\n\nThese datasets bridge **mathematical language understanding** and **formal symbolic reasoning**, advancing LLMs from numeric manipulation to verifiable theorem-level reasoning.",
    "order": 39,
    "orderInChapter": 4,
    "difficulty": 4,
    "estimatedMinutes": 3,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 456,
      "contentLength": 4893
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#imo-style-problems-and-datasets",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-aime-and-imo-in-modern-reasoning-research-40",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "AIME and IMO: Mathematical Olympiad‚ÄìLevel Reasoning",
    "title": "AIME and IMO in Modern Reasoning Research",
    "subtitle": "AIME and IMO: Mathematical Olympiad‚ÄìLevel Reasoning",
    "contentHtml": "<ul>\n  <li><strong>AIME as performance baseline:</strong> Many reasoning-focused models (e.g., DeepSeek-R1, OpenAI‚Äôs o1, and OpenMath) report AIME‚Äô24 accuracy as their headline metric, reflecting pure reasoning improvement.</li>\n  <li><strong>IMO as reasoning frontier:</strong> Proof-oriented tasks from IMO data drive progress toward <em>formal reasoning alignment</em>‚Äîwhere LLMs are trained to generate coherent proof steps verified by theorem provers.</li>\n  <li><strong>Bridging informal and formal reasoning:</strong> The <em>MiniF2F</em> and <em>LeanDojo</em> datasets link natural language reasoning to symbolic proof checking, a key step toward automated theorem discovery.</li>\n</ul>",
    "contentMarkdown": "*   **AIME as performance baseline:** Many reasoning-focused models (e.g., DeepSeek-R1, OpenAI‚Äôs o1, and OpenMath) report AIME‚Äô24 accuracy as their headline metric, reflecting pure reasoning improvement.\n*   **IMO as reasoning frontier:** Proof-oriented tasks from IMO data drive progress toward _formal reasoning alignment_‚Äîwhere LLMs are trained to generate coherent proof steps verified by theorem provers.\n*   **Bridging informal and formal reasoning:** The _MiniF2F_ and _LeanDojo_ datasets link natural language reasoning to symbolic proof checking, a key step toward automated theorem discovery.",
    "order": 40,
    "orderInChapter": 5,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 79,
      "contentLength": 694
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#aime-and-imo-in-modern-reasoning-research",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-comparative-summary-41",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "AIME and IMO: Mathematical Olympiad‚ÄìLevel Reasoning",
    "title": "Comparative Summary",
    "subtitle": "AIME and IMO: Mathematical Olympiad‚ÄìLevel Reasoning",
    "contentHtml": "<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Benchmark</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Domain</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Problem Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Evaluation</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reasoning Depth</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Typical Use</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>GSM8K</strong></td>\n<td class=\"tg-tleft-valign-first\">Grade-school</td>\n<td class=\"tg-tleft-valign-first\">Arithmetic</td>\n<td class=\"tg-tleft-valign-first\">EM, verifier</td>\n<td class=\"tg-tleft-valign-first\">2‚Äì6 steps</td>\n<td class=\"tg-tleft-valign-second\">Introductory reasoning</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>MATH</strong></td>\n<td class=\"tg-tleft-valign-first\">High school/college</td>\n<td class=\"tg-tleft-valign-first\">Symbolic</td>\n<td class=\"tg-tleft-valign-first\">EM + symbolic equivalence</td>\n<td class=\"tg-tleft-valign-first\">4‚Äì8 steps</td>\n<td class=\"tg-tleft-valign-second\">Formal algebraic reasoning</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>AIME</strong></td>\n<td class=\"tg-tleft-valign-first\">Olympiad-level</td>\n<td class=\"tg-tleft-valign-first\">Integer/symbolic</td>\n<td class=\"tg-tleft-valign-first\">Numeric EM</td>\n<td class=\"tg-tleft-valign-first\">5‚Äì10 steps</td>\n<td class=\"tg-tleft-valign-second\">High-level logical synthesis</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>IMO / MiniF2F</strong></td>\n<td class=\"tg-tleft-valign-first\">Olympiad/formal</td>\n<td class=\"tg-tleft-valign-first\">Proof synthesis</td>\n<td class=\"tg-tleft-valign-first\">Theorem verification</td>\n<td class=\"tg-tleft-valign-first\">10+ steps</td>\n<td class=\"tg-tleft-valign-second\">Formal and creative reasoning</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Benchmark</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Domain</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Problem Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Evaluation</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reasoning Depth</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Typical Use</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>GSM8K</strong></td>\n<td class=\"tg-tleft-valign-first\">Grade-school</td>\n<td class=\"tg-tleft-valign-first\">Arithmetic</td>\n<td class=\"tg-tleft-valign-first\">EM, verifier</td>\n<td class=\"tg-tleft-valign-first\">2‚Äì6 steps</td>\n<td class=\"tg-tleft-valign-second\">Introductory reasoning</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>MATH</strong></td>\n<td class=\"tg-tleft-valign-first\">High school/college</td>\n<td class=\"tg-tleft-valign-first\">Symbolic</td>\n<td class=\"tg-tleft-valign-first\">EM + symbolic equivalence</td>\n<td class=\"tg-tleft-valign-first\">4‚Äì8 steps</td>\n<td class=\"tg-tleft-valign-second\">Formal algebraic reasoning</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>AIME</strong></td>\n<td class=\"tg-tleft-valign-first\">Olympiad-level</td>\n<td class=\"tg-tleft-valign-first\">Integer/symbolic</td>\n<td class=\"tg-tleft-valign-first\">Numeric EM</td>\n<td class=\"tg-tleft-valign-first\">5‚Äì10 steps</td>\n<td class=\"tg-tleft-valign-second\">High-level logical synthesis</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>IMO / MiniF2F</strong></td>\n<td class=\"tg-tleft-valign-first\">Olympiad/formal</td>\n<td class=\"tg-tleft-valign-first\">Proof synthesis</td>\n<td class=\"tg-tleft-valign-first\">Theorem verification</td>\n<td class=\"tg-tleft-valign-first\">10+ steps</td>\n<td class=\"tg-tleft-valign-second\">Formal and creative reasoning</td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "**Benchmark**\n\n**Domain**\n\n**Problem Type**\n\n**Evaluation**\n\n**Reasoning Depth**\n\n**Typical Use**\n\n**GSM8K**\n\nGrade-school\n\nArithmetic\n\nEM, verifier\n\n2‚Äì6 steps\n\nIntroductory reasoning\n\n**MATH**\n\nHigh school/college\n\nSymbolic\n\nEM + symbolic equivalence\n\n4‚Äì8 steps\n\nFormal algebraic reasoning\n\n**AIME**\n\nOlympiad-level\n\nInteger/symbolic\n\nNumeric EM\n\n5‚Äì10 steps\n\nHigh-level logical synthesis\n\n**IMO / MiniF2F**\n\nOlympiad/formal\n\nProof synthesis\n\nTheorem verification\n\n10+ steps\n\nFormal and creative reasoning\n\n**Benchmark**\n\n**Domain**\n\n**Problem Type**\n\n**Evaluation**\n\n**Reasoning Depth**\n\n**Typical Use**\n\n**GSM8K**\n\nGrade-school\n\nArithmetic\n\nEM, verifier\n\n2‚Äì6 steps\n\nIntroductory reasoning\n\n**MATH**\n\nHigh school/college\n\nSymbolic\n\nEM + symbolic equivalence\n\n4‚Äì8 steps\n\nFormal algebraic reasoning\n\n**AIME**\n\nOlympiad-level\n\nInteger/symbolic\n\nNumeric EM\n\n5‚Äì10 steps\n\nHigh-level logical synthesis\n\n**IMO / MiniF2F**\n\nOlympiad/formal\n\nProof synthesis\n\nTheorem verification\n\n10+ steps\n\nFormal and creative reasoning",
    "order": 41,
    "orderInChapter": 6,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 110,
      "contentLength": 3849
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#comparative-summary",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-why-aime-and-imo-matter-for-reasoning-evaluation-42",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "AIME and IMO: Mathematical Olympiad‚ÄìLevel Reasoning",
    "title": "Why AIME and IMO Matter for Reasoning Evaluation",
    "subtitle": "AIME and IMO: Mathematical Olympiad‚ÄìLevel Reasoning",
    "contentHtml": "<ol>\n  <li><strong>They minimize retrieval bias:</strong> Success depends on symbolic reasoning, not memorization.</li>\n  <li><strong>They require compositional thinking:</strong> Multi-step reasoning chains must stay coherent under symbolic constraints.</li>\n  <li><strong>They connect to formal verification:</strong> Proof datasets allow automated correctness checks.</li>\n  <li><strong>They expose limits of scaling:</strong> Even frontier models (GPT-4, DeepSeek-R1, Claude 3 Opus) plateau at 30‚Äì50 % accuracy, far below expert humans.</li>\n</ol>",
    "contentMarkdown": "1.  **They minimize retrieval bias:** Success depends on symbolic reasoning, not memorization.\n2.  **They require compositional thinking:** Multi-step reasoning chains must stay coherent under symbolic constraints.\n3.  **They connect to formal verification:** Proof datasets allow automated correctness checks.\n4.  **They expose limits of scaling:** Even frontier models (GPT-4, DeepSeek-R1, Claude 3 Opus) plateau at 30‚Äì50 % accuracy, far below expert humans.",
    "order": 42,
    "orderInChapter": 7,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "gpt"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 61,
      "contentLength": 551
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#why-aime-and-imo-matter-for-reasoning-evaluation",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-arc-agi-1-original-arc-challenge-43",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "ARC and Science QA Benchmarks (ARC-AGI-1 and ARC-AGI-2)",
    "title": "ARC-AGI-1 (Original ARC Challenge)",
    "subtitle": "ARC and Science QA Benchmarks (ARC-AGI-1 and ARC-AGI-2)",
    "contentHtml": "<h4 id=\"dataset-overview\">Dataset Overview</h4>\n<ul>\n  <li>ARC-AGI-1 consists of 7,787 grade-school science questions drawn from standardized exams in the United States, divided into an <strong>Easy Set</strong> (requiring factual recall) and a <strong>Challenge Set</strong> (requiring reasoning, causality, and multi-hop inference).</li>\n  <li>Each item is multiple-choice with 3‚Äì5 answer options.</li>\n</ul>\n<h4 id=\"why-it-matters-for-reasoning\">Why It Matters for Reasoning</h4>\n<ul>\n  <li>Unlike reading-comprehension tasks such as SQuAD, ARC‚Äôs Challenge questions cannot be solved by surface matching; they require the model to <em>combine multiple scientific facts</em> to reach the answer.</li>\n  <li>For instance: ‚ÄúWhy does placing a metal spoon in hot water make the handle warm?‚Äù</li>\n  <li>Answering requires the latent inference chain: <em>metal conducts heat <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-281-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4422\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4423\"><span class=\"mo\" id=\"MathJax-Span-4424\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-281\">\\rightarrow</script> heat flows along the spoon <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-282-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4425\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4426\"><span class=\"mo\" id=\"MathJax-Span-4427\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-282\">\\rightarrow</script> handle warms.</em></li>\n</ul>\n<h4 id=\"evaluation\">Evaluation</h4>\n<ul>\n  <li>Performance is computed as plain accuracy:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-283-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>Acc</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munder><mo>&amp;#x2211;</mo><mi>i</mi></munder><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>&amp;#x22C6;</mo></msubsup><mo stretchy=&quot;false&quot;>]</mo><mo>.</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4428\" style=\"width: 11.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.742em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.836em, 1009.69em, 3.753em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4429\"><span class=\"mtext\" id=\"MathJax-Span-4430\" style=\"font-family: STIXGeneral-Regular;\">Acc</span><span class=\"mo\" id=\"MathJax-Span-4431\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-4432\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-4433\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.362em;\"><span class=\"mi\" id=\"MathJax-Span-4434\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.84em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.836em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-4435\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4436\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.576em;\"><span class=\"mi\" id=\"MathJax-Span-4437\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4438\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4439\"><span class=\"mi\" id=\"MathJax-Span-4440\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-4441\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-4442\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4443\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4444\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4445\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4446\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4447\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.58em, 4.169em, -999.997em); top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4448\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4449\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4450\" style=\"font-family: STIXGeneral-Regular;\">]</span><span class=\"mo\" id=\"MathJax-Span-4451\" style=\"font-family: STIXGeneral-Regular;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mtext>Acc</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munder><mo>‚àë</mo><mi>i</mi></munder><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>‚ãÜ</mo></msubsup><mo stretchy=\"false\">]</mo><mo>.</mo></math></span></span></div>\n<ul>\n  <li>However, modern setups also log reasoning traces <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-284-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4452\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4453\"><span class=\"mi\" id=\"MathJax-Span-4454\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-284\">z</script> and check whether the final selected option follows a coherent causal explanation.</li>\n</ul>\n<h4 id=\"key-baselines\">Key Baselines</h4>\n<ul>\n  <li>*IR and PMI systems** (2018‚Äì2019): retrieval + heuristics.</li>\n  <li><strong>Transformer baselines (BERT, RoBERTa)</strong>‚Äîe.g., <em>BERT by</em> <a href=\"https://arxiv.org/abs/1810.04805\">Devlin et al. (2018)</a>‚Äîachieved large gains but still trailed human performance.</li>\n  <li><strong>CoT prompting</strong> (2022 onward) improved Challenge-set accuracy sharply, showing that explicit reasoning helps even with multiple-choice formats.</li>\n</ul>",
    "contentMarkdown": "#### Dataset Overview\n\n*   ARC-AGI-1 consists of 7,787 grade-school science questions drawn from standardized exams in the United States, divided into an **Easy Set** (requiring factual recall) and a **Challenge Set** (requiring reasoning, causality, and multi-hop inference).\n*   Each item is multiple-choice with 3‚Äì5 answer options.\n\n#### Why It Matters for Reasoning\n\n*   Unlike reading-comprehension tasks such as SQuAD, ARC‚Äôs Challenge questions cannot be solved by surface matching; they require the model to _combine multiple scientific facts_ to reach the answer.\n*   For instance: ‚ÄúWhy does placing a metal spoon in hot water make the handle warm?‚Äù\n*   Answering requires the latent inference chain: _metal conducts heat ‚Üí‚Üí\\\\rightarrow heat flows along the spoon ‚Üí‚Üí\\\\rightarrow handle warms._\n\n#### Evaluation\n\n*   Performance is computed as plain accuracy:\n\nAcc\\=1N‚àëiùïÄ\\[yi\\=y‚ãÜi\\].Acc\\=1N‚àëiI\\[yi\\=yi‚ãÜ\\].\n\n*   However, modern setups also log reasoning traces zzz and check whether the final selected option follows a coherent causal explanation.\n\n#### Key Baselines\n\n*   \\*IR and PMI systems\\*\\* (2018‚Äì2019): retrieval + heuristics.\n*   **Transformer baselines (BERT, RoBERTa)**‚Äîe.g., _BERT by_ [Devlin et al. (2018)](https://arxiv.org/abs/1810.04805)‚Äîachieved large gains but still trailed human performance.\n*   **CoT prompting** (2022 onward) improved Challenge-set accuracy sharply, showing that explicit reasoning helps even with multiple-choice formats.",
    "order": 43,
    "orderInChapter": 1,
    "difficulty": 5,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "transformer",
      "bert"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 195,
      "contentLength": 11787
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#arc-agi-1-(original-arc-challenge)",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-arc-agi-2-the-abstraction-and-generalization-intel-44",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "ARC and Science QA Benchmarks (ARC-AGI-1 and ARC-AGI-2)",
    "title": "ARC-AGI-2 (The Abstraction and Generalization Intelligence Benchmark)",
    "subtitle": "ARC and Science QA Benchmarks (ARC-AGI-1 and ARC-AGI-2)",
    "contentHtml": "<h4 id=\"motivation\">Motivation</h4>\n<ul>\n  <li>By 2023, large models surpassed 90 % on the original ARC Challenge, largely through pattern matching and memorization.</li>\n  <li>To push beyond this, <a href=\"https://arxiv.org/abs/2308.01405\">Clark et al. (2023)</a> introduced <strong>ARC-AGI-2</strong>, built to evaluate <em>systematic generalization and abstraction</em> rather than recall.</li>\n</ul>\n<h4 id=\"design\">Design</h4>\n<ul>\n  <li>ARC-AGI-2 redefines each task family as a visual‚Äìsymbolic reasoning problem.\nProblems resemble simple ‚Äúconcept games‚Äù expressed as grid transformations or symbolic relations; they test the model‚Äôs ability to infer <em>rules</em> and apply them to new instances.</li>\n  <li>This format inherits the design of the original ‚ÄúAbstraction and Reasoning Corpus‚Äù (ARC) by <a href=\"https://arxiv.org/abs/1911.01547\">Chollet (2019)</a> but formalizes it into a fixed AGI-style benchmark suite.</li>\n</ul>\n<h4 id=\"dataset-composition\">Dataset Composition</h4>\n<ul>\n  <li>400 training, 200 validation, and 400 test tasks.</li>\n  <li>Each task contains 2‚Äì5 input-output example pairs and a novel test case to solve.</li>\n  <li>Inputs and outputs are small colored grids (e.g., 10√ó10 arrays).</li>\n  <li>Tasks involve transformations such as symmetry, counting, pattern extension, or logical composition.</li>\n</ul>\n<h4 id=\"why-it-matters-1\">Why It Matters</h4>\n<ul>\n  <li>ARC-AGI-2 tests for <em>compositional generalization</em>: models must discover and apply a hidden transformation rule from few examples, with no overlap between training and test transformations.</li>\n  <li>It is explicitly designed to resist memorization and to reward <strong>algorithmic reasoning</strong>.</li>\n</ul>\n<h4 id=\"evaluation-1\">Evaluation</h4>\n<ul>\n  <li>Performance is the fraction of tasks for which all output grids exactly match ground truth:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-285-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mtext>Acc</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>task</mtext></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munder><mo>&amp;#x2211;</mo><mi>i</mi></munder><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>&amp;#x22C6;</mo></msubsup><mo stretchy=&quot;false&quot;>]</mo><mo>.</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4455\" style=\"width: 13.128em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.836em, 1010.89em, 3.753em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4456\"><span class=\"msubsup\" id=\"MathJax-Span-4457\"><span style=\"display: inline-block; position: relative; width: 2.815em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1001.57em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-4458\" style=\"font-family: STIXGeneral-Regular;\">Acc</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.617em;\"><span class=\"texatom\" id=\"MathJax-Span-4459\"><span class=\"mrow\" id=\"MathJax-Span-4460\"><span class=\"mtext\" id=\"MathJax-Span-4461\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">task</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4462\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-4463\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-4464\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.362em;\"><span class=\"mi\" id=\"MathJax-Span-4465\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.84em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.836em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-4466\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4467\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.576em;\"><span class=\"mi\" id=\"MathJax-Span-4468\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4469\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4470\"><span class=\"mi\" id=\"MathJax-Span-4471\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-4472\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-4473\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4474\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4475\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4476\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4477\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4478\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.58em, 4.169em, -999.997em); top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4479\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4480\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4481\" style=\"font-family: STIXGeneral-Regular;\">]</span><span class=\"mo\" id=\"MathJax-Span-4482\" style=\"font-family: STIXGeneral-Regular;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mtext>Acc</mtext><mrow class=\"MJX-TeXAtom-ORD\"><mtext>task</mtext></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munder><mo>‚àë</mo><mi>i</mi></munder><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>‚ãÜ</mo></msubsup><mo stretchy=\"false\">]</mo><mo>.</mo></math></span></span></div>\n<ul>\n  <li>Since each task has a single correct transformation, partial credit is not given.</li>\n  <li>Some studies additionally compute <em>object-level F1</em> for graded evaluation.</li>\n</ul>",
    "contentMarkdown": "#### Motivation\n\n*   By 2023, large models surpassed 90 % on the original ARC Challenge, largely through pattern matching and memorization.\n*   To push beyond this, [Clark et al. (2023)](https://arxiv.org/abs/2308.01405) introduced **ARC-AGI-2**, built to evaluate _systematic generalization and abstraction_ rather than recall.\n\n#### Design\n\n*   ARC-AGI-2 redefines each task family as a visual‚Äìsymbolic reasoning problem. Problems resemble simple ‚Äúconcept games‚Äù expressed as grid transformations or symbolic relations; they test the model‚Äôs ability to infer _rules_ and apply them to new instances.\n*   This format inherits the design of the original ‚ÄúAbstraction and Reasoning Corpus‚Äù (ARC) by [Chollet (2019)](https://arxiv.org/abs/1911.01547) but formalizes it into a fixed AGI-style benchmark suite.\n\n#### Dataset Composition\n\n*   400 training, 200 validation, and 400 test tasks.\n*   Each task contains 2‚Äì5 input-output example pairs and a novel test case to solve.\n*   Inputs and outputs are small colored grids (e.g., 10√ó10 arrays).\n*   Tasks involve transformations such as symmetry, counting, pattern extension, or logical composition.\n\n#### Why It Matters\n\n*   ARC-AGI-2 tests for _compositional generalization_: models must discover and apply a hidden transformation rule from few examples, with no overlap between training and test transformations.\n*   It is explicitly designed to resist memorization and to reward **algorithmic reasoning**.\n\n#### Evaluation\n\n*   Performance is the fraction of tasks for which all output grids exactly match ground truth:\n\nAcctask\\=1N‚àëiùïÄ\\[yi\\=y‚ãÜi\\].Acctask\\=1N‚àëiI\\[yi\\=yi‚ãÜ\\].\n\n*   Since each task has a single correct transformation, partial credit is not given.\n*   Some studies additionally compute _object-level F1_ for graded evaluation.",
    "order": 44,
    "orderInChapter": 2,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 244,
      "contentLength": 9327
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#arc-agi-2-(the-abstraction-and-generalization-intelligence-benchmark)",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-comparative-insights-arc-vs-arc-agi-2-45",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "ARC and Science QA Benchmarks (ARC-AGI-1 and ARC-AGI-2)",
    "title": "Comparative Insights: ARC vs. ARC-AGI-2",
    "subtitle": "ARC and Science QA Benchmarks (ARC-AGI-1 and ARC-AGI-2)",
    "contentHtml": "<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Property</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>ARC-AGI-1</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>ARC-AGI-2</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Domain</td>\n<td class=\"tg-tleft-valign-first\">Textual grade-school science</td>\n<td class=\"tg-tleft-valign-second\">Visual-symbolic abstraction</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Input format</td>\n<td class=\"tg-tleft-valign-first\">Multiple-choice text</td>\n<td class=\"tg-tleft-valign-second\">Grid-based pattern transformations</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Knowledge dependence</td>\n<td class=\"tg-tleft-valign-first\">Requires external science facts</td>\n<td class=\"tg-tleft-valign-second\">Minimal; focuses on reasoning rule induction</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Evaluation metric</td>\n<td class=\"tg-tleft-valign-first\">Accuracy on discrete choices</td>\n<td class=\"tg-tleft-valign-second\">Exact grid-match (task success)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Reasoning type</td>\n<td class=\"tg-tleft-valign-first\">Multi-hop causal inference</td>\n<td class=\"tg-tleft-valign-second\">Program induction / rule synthesis</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Typical LLM interface</td>\n<td class=\"tg-tleft-valign-first\">CoT or retrieval-augmented QA</td>\n<td class=\"tg-tleft-valign-second\">Program-generation or symbolic-executor integration</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Property</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>ARC-AGI-1</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>ARC-AGI-2</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Domain</td>\n<td class=\"tg-tleft-valign-first\">Textual grade-school science</td>\n<td class=\"tg-tleft-valign-second\">Visual-symbolic abstraction</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Input format</td>\n<td class=\"tg-tleft-valign-first\">Multiple-choice text</td>\n<td class=\"tg-tleft-valign-second\">Grid-based pattern transformations</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Knowledge dependence</td>\n<td class=\"tg-tleft-valign-first\">Requires external science facts</td>\n<td class=\"tg-tleft-valign-second\">Minimal; focuses on reasoning rule induction</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Evaluation metric</td>\n<td class=\"tg-tleft-valign-first\">Accuracy on discrete choices</td>\n<td class=\"tg-tleft-valign-second\">Exact grid-match (task success)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Reasoning type</td>\n<td class=\"tg-tleft-valign-first\">Multi-hop causal inference</td>\n<td class=\"tg-tleft-valign-second\">Program induction / rule synthesis</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Typical LLM interface</td>\n<td class=\"tg-tleft-valign-first\">CoT or retrieval-augmented QA</td>\n<td class=\"tg-tleft-valign-second\">Program-generation or symbolic-executor integration</td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "**Property**\n\n**ARC-AGI-1**\n\n**ARC-AGI-2**\n\nDomain\n\nTextual grade-school science\n\nVisual-symbolic abstraction\n\nInput format\n\nMultiple-choice text\n\nGrid-based pattern transformations\n\nKnowledge dependence\n\nRequires external science facts\n\nMinimal; focuses on reasoning rule induction\n\nEvaluation metric\n\nAccuracy on discrete choices\n\nExact grid-match (task success)\n\nReasoning type\n\nMulti-hop causal inference\n\nProgram induction / rule synthesis\n\nTypical LLM interface\n\nCoT or retrieval-augmented QA\n\nProgram-generation or symbolic-executor integration\n\n**Property**\n\n**ARC-AGI-1**\n\n**ARC-AGI-2**\n\nDomain\n\nTextual grade-school science\n\nVisual-symbolic abstraction\n\nInput format\n\nMultiple-choice text\n\nGrid-based pattern transformations\n\nKnowledge dependence\n\nRequires external science facts\n\nMinimal; focuses on reasoning rule induction\n\nEvaluation metric\n\nAccuracy on discrete choices\n\nExact grid-match (task success)\n\nReasoning type\n\nMulti-hop causal inference\n\nProgram induction / rule synthesis\n\nTypical LLM interface\n\nCoT or retrieval-augmented QA\n\nProgram-generation or symbolic-executor integration",
    "order": 45,
    "orderInChapter": 3,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 118,
      "contentLength": 3111
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#comparative-insights:-arc-vs.-arc-agi-2",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-empirical-trends-46",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "ARC and Science QA Benchmarks (ARC-AGI-1 and ARC-AGI-2)",
    "title": "Empirical Trends",
    "subtitle": "ARC and Science QA Benchmarks (ARC-AGI-1 and ARC-AGI-2)",
    "contentHtml": "<ul>\n  <li>CoT and retrieval-augmented prompting lifted ARC-AGI-1 accuracy above 80 % on recent frontier models.</li>\n  <li>ARC-AGI-2 remains unsolved; even advanced models (GPT-4, Gemini 1.5 Pro, Claude 3 Opus) perform below 20 %, highlighting a continuing gap in compositional abstraction.</li>\n</ul>",
    "contentMarkdown": "*   CoT and retrieval-augmented prompting lifted ARC-AGI-1 accuracy above 80 % on recent frontier models.\n*   ARC-AGI-2 remains unsolved; even advanced models (GPT-4, Gemini 1.5 Pro, Claude 3 Opus) perform below 20 %, highlighting a continuing gap in compositional abstraction.",
    "order": 46,
    "orderInChapter": 4,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "gpt"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 40,
      "contentLength": 302
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#empirical-trends",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-practical-evaluation-guidance-47",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "ARC and Science QA Benchmarks (ARC-AGI-1 and ARC-AGI-2)",
    "title": "Practical Evaluation Guidance",
    "subtitle": "ARC and Science QA Benchmarks (ARC-AGI-1 and ARC-AGI-2)",
    "contentHtml": "<ol>\n  <li><strong>For ARC-AGI-1</strong>, report separate Easy vs. Challenge accuracies and check reasoning trace consistency.</li>\n  <li><strong>For ARC-AGI-2</strong>, pair symbolic executors (e.g., Python grid interpreters) with LLMs and report both per-task accuracy and per-object F1.</li>\n  <li><strong>Control for contamination:</strong> ARC-AGI-2 tasks are meant to be unseen; verify models were not fine-tuned on similar puzzles.</li>\n  <li><strong>Visualize rule inference:</strong> Output transformation code or step reasoning to make results interpretable.</li>\n</ol>",
    "contentMarkdown": "1.  **For ARC-AGI-1**, report separate Easy vs. Challenge accuracies and check reasoning trace consistency.\n2.  **For ARC-AGI-2**, pair symbolic executors (e.g., Python grid interpreters) with LLMs and report both per-task accuracy and per-object F1.\n3.  **Control for contamination:** ARC-AGI-2 tasks are meant to be unseen; verify models were not fine-tuned on similar puzzles.\n4.  **Visualize rule inference:** Output transformation code or step reasoning to make results interpretable.",
    "order": 47,
    "orderInChapter": 5,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 67,
      "contentLength": 580
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#practical-evaluation-guidance",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-design-and-pipeline-48",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "OpenThoughts3: Large-Scale Open Reasoning Dataset",
    "title": "Design and Pipeline",
    "subtitle": "OpenThoughts3: Large-Scale Open Reasoning Dataset",
    "contentHtml": "<ul>\n  <li>OpenThoughts3 introduces a fully controlled, ablation-driven data construction pipeline designed to isolate and improve each component contributing to reasoning performance. The pipeline comprises six major stages:</li>\n</ul>\n<ol>\n  <li><strong>Question sourcing:</strong> Questions are drawn from both existing high-quality repositories (e.g., OpenR1-Math, AutoMathText, CodeFeedback) and newly generated datasets.</li>\n  <li><strong>Question mixing:</strong> Top-performing question sources are combined to enhance diversity.</li>\n  <li><strong>Filtering questions:</strong> FastText and LLM-based filters remove ambiguous or malformed inputs.</li>\n  <li><strong>Answer generation:</strong> Multiple candidate answers are produced per question using teacher models.</li>\n  <li><strong>Answer verification:</strong> Low-quality or inconsistent answers are filtered using LLM-based verification or majority consensus.</li>\n  <li><strong>Teacher selection:</strong> The best-performing teacher model is chosen empirically through small-scale fine-tuning trials.</li>\n</ol>\n<ul>\n  <li>This pipeline allows reproducible scaling and quality control at each stage. Experiments with controlled subsets of 31,600 examples were used to evaluate each design decision before scaling up to the full dataset.</li>\n</ul>",
    "contentMarkdown": "*   OpenThoughts3 introduces a fully controlled, ablation-driven data construction pipeline designed to isolate and improve each component contributing to reasoning performance. The pipeline comprises six major stages:\n\n1.  **Question sourcing:** Questions are drawn from both existing high-quality repositories (e.g., OpenR1-Math, AutoMathText, CodeFeedback) and newly generated datasets.\n2.  **Question mixing:** Top-performing question sources are combined to enhance diversity.\n3.  **Filtering questions:** FastText and LLM-based filters remove ambiguous or malformed inputs.\n4.  **Answer generation:** Multiple candidate answers are produced per question using teacher models.\n5.  **Answer verification:** Low-quality or inconsistent answers are filtered using LLM-based verification or majority consensus.\n6.  **Teacher selection:** The best-performing teacher model is chosen empirically through small-scale fine-tuning trials.\n\n*   This pipeline allows reproducible scaling and quality control at each stage. Experiments with controlled subsets of 31,600 examples were used to evaluate each design decision before scaling up to the full dataset.",
    "order": 48,
    "orderInChapter": 1,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "llm",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 144,
      "contentLength": 1318
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#design-and-pipeline",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-evaluation-framework-49",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "OpenThoughts3: Large-Scale Open Reasoning Dataset",
    "title": "Evaluation Framework",
    "subtitle": "OpenThoughts3: Large-Scale Open Reasoning Dataset",
    "contentHtml": "<ul>\n  <li>\n    <p>OpenThoughts3 evaluates reasoning performance across eight standardized benchmarks, spanning multiple domains:</p>\n  </li>\n  <li><strong>Math:</strong> AIME24, AMC23, MATH500</li>\n  <li><strong>Code:</strong> CodeElo, CodeForces, LiveCodeBench (05/23‚Äì05/24)</li>\n  <li>\n    <p><strong>Science:</strong> GPQA Diamond, JEEBench</p>\n  </li>\n  <li>Each model trained on OpenThoughts3 is scored by average accuracy across these benchmarks, with decontamination procedures ensuring that no overlapping samples remain between training and test data. Evaluation uses the <em>Evalchemy</em> framework, with consistent metrics for accuracy, calibration, and robustness.</li>\n</ul>\n<p>OpenThoughts3 evaluates reasoning performance across eight standardized benchmarks, spanning multiple domains:</p>\n<p><strong>Science:</strong> GPQA Diamond, JEEBench</p>",
    "contentMarkdown": "*   OpenThoughts3 evaluates reasoning performance across eight standardized benchmarks, spanning multiple domains:\n    \n*   **Math:** AIME24, AMC23, MATH500\n*   **Code:** CodeElo, CodeForces, LiveCodeBench (05/23‚Äì05/24)\n*   **Science:** GPQA Diamond, JEEBench\n    \n*   Each model trained on OpenThoughts3 is scored by average accuracy across these benchmarks, with decontamination procedures ensuring that no overlapping samples remain between training and test data. Evaluation uses the _Evalchemy_ framework, with consistent metrics for accuracy, calibration, and robustness.\n\nOpenThoughts3 evaluates reasoning performance across eight standardized benchmarks, spanning multiple domains:\n\n**Science:** GPQA Diamond, JEEBench",
    "order": 49,
    "orderInChapter": 2,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 84,
      "contentLength": 863
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#evaluation-framework",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-results-and-scaling-behavior-50",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "OpenThoughts3: Large-Scale Open Reasoning Dataset",
    "title": "Results and Scaling Behavior",
    "subtitle": "OpenThoughts3: Large-Scale Open Reasoning Dataset",
    "contentHtml": "<ul>\n  <li>OpenThoughts3 outperforms prior supervised fine-tuning (SFT) reasoning datasets‚Äîincluding AM, Nemotron Nano, and LIMO‚Äîwhen all models are fine-tuned from <strong>Qwen-2.5-7B-Instruct</strong>. Scaling analyses (from 1K to 1M samples) demonstrate that OpenThoughts3 achieves higher asymptotic performance and stronger data efficiency, particularly on <strong>AIME 2025</strong>, <strong>LiveCodeBench</strong>, and <strong>GPQA Diamond</strong>, where it improves accuracy by 15‚Äì20 percentage points over comparable datasets.</li>\n</ul>",
    "contentMarkdown": "*   OpenThoughts3 outperforms prior supervised fine-tuning (SFT) reasoning datasets‚Äîincluding AM, Nemotron Nano, and LIMO‚Äîwhen all models are fine-tuned from **Qwen-2.5-7B-Instruct**. Scaling analyses (from 1K to 1M samples) demonstrate that OpenThoughts3 achieves higher asymptotic performance and stronger data efficiency, particularly on **AIME 2025**, **LiveCodeBench**, and **GPQA Diamond**, where it improves accuracy by 15‚Äì20 percentage points over comparable datasets.",
    "order": 50,
    "orderInChapter": 3,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 57,
      "contentLength": 546
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#results-and-scaling-behavior",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-model-progression-and-impact-51",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "OpenThoughts3: Large-Scale Open Reasoning Dataset",
    "title": "Model Progression and Impact",
    "subtitle": "OpenThoughts3: Large-Scale Open Reasoning Dataset",
    "contentHtml": "<ul>\n  <li>Successive generations of models trained on OpenThoughts datasets‚ÄîBespoke-Stratos, OpenThinker, OpenThinker2, and OpenThinker3‚Äîillustrate consistent gains across reasoning domains:</li>\n</ul>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Model</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>AIME24</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>AIME25</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>GPQA-D</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>LiveCodeBench</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Bespoke-Stratos-7B</td>\n<td class=\"tg-tleft-valign-first\">14.3</td>\n<td class=\"tg-tleft-valign-first\">12.7</td>\n<td class=\"tg-tleft-valign-first\">31.8</td>\n<td class=\"tg-tleft-valign-second\">27.4</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">OpenThinker-7B</td>\n<td class=\"tg-tleft-valign-first\">29.3</td>\n<td class=\"tg-tleft-valign-first\">25.3</td>\n<td class=\"tg-tleft-valign-first\">44.1</td>\n<td class=\"tg-tleft-valign-second\">38.8</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">OpenThinker2-7B</td>\n<td class=\"tg-tleft-valign-first\">60.7</td>\n<td class=\"tg-tleft-valign-first\">38.7</td>\n<td class=\"tg-tleft-valign-first\">47.0</td>\n<td class=\"tg-tleft-valign-second\">56.3</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>OpenThinker3-7B</strong></td>\n<td class=\"tg-tleft-valign-first\"><strong>69.0</strong></td>\n<td class=\"tg-tleft-valign-first\"><strong>53.3</strong></td>\n<td class=\"tg-tleft-valign-first\"><strong>53.7</strong></td>\n<td class=\"tg-tleft-valign-second\"><strong>64.5</strong></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Model</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>AIME24</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>AIME25</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>GPQA-D</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>LiveCodeBench</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Bespoke-Stratos-7B</td>\n<td class=\"tg-tleft-valign-first\">14.3</td>\n<td class=\"tg-tleft-valign-first\">12.7</td>\n<td class=\"tg-tleft-valign-first\">31.8</td>\n<td class=\"tg-tleft-valign-second\">27.4</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">OpenThinker-7B</td>\n<td class=\"tg-tleft-valign-first\">29.3</td>\n<td class=\"tg-tleft-valign-first\">25.3</td>\n<td class=\"tg-tleft-valign-first\">44.1</td>\n<td class=\"tg-tleft-valign-second\">38.8</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">OpenThinker2-7B</td>\n<td class=\"tg-tleft-valign-first\">60.7</td>\n<td class=\"tg-tleft-valign-first\">38.7</td>\n<td class=\"tg-tleft-valign-first\">47.0</td>\n<td class=\"tg-tleft-valign-second\">56.3</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>OpenThinker3-7B</strong></td>\n<td class=\"tg-tleft-valign-first\"><strong>69.0</strong></td>\n<td class=\"tg-tleft-valign-first\"><strong>53.3</strong></td>\n<td class=\"tg-tleft-valign-first\"><strong>53.7</strong></td>\n<td class=\"tg-tleft-valign-second\"><strong>64.5</strong></td>\n</tr>\n</tbody>\n</table>\n<ul>\n  <li>The dataset‚Äôs public availability and transparent pipeline make it a cornerstone for open benchmarking of reasoning in LLMs. It also serves as a model for reproducible dataset design, providing controlled ablations and fully open access to both data and evaluation scripts through <a href=\"https://openthoughts.ai\">openthoughts.ai</a>.</li>\n</ul>",
    "contentMarkdown": "*   Successive generations of models trained on OpenThoughts datasets‚ÄîBespoke-Stratos, OpenThinker, OpenThinker2, and OpenThinker3‚Äîillustrate consistent gains across reasoning domains:\n\n**Model**\n\n**AIME24**\n\n**AIME25**\n\n**GPQA-D**\n\n**LiveCodeBench**\n\nBespoke-Stratos-7B\n\n14.3\n\n12.7\n\n31.8\n\n27.4\n\nOpenThinker-7B\n\n29.3\n\n25.3\n\n44.1\n\n38.8\n\nOpenThinker2-7B\n\n60.7\n\n38.7\n\n47.0\n\n56.3\n\n**OpenThinker3-7B**\n\n**69.0**\n\n**53.3**\n\n**53.7**\n\n**64.5**\n\n**Model**\n\n**AIME24**\n\n**AIME25**\n\n**GPQA-D**\n\n**LiveCodeBench**\n\nBespoke-Stratos-7B\n\n14.3\n\n12.7\n\n31.8\n\n27.4\n\nOpenThinker-7B\n\n29.3\n\n25.3\n\n44.1\n\n38.8\n\nOpenThinker2-7B\n\n60.7\n\n38.7\n\n47.0\n\n56.3\n\n**OpenThinker3-7B**\n\n**69.0**\n\n**53.3**\n\n**53.7**\n\n**64.5**\n\n*   The dataset‚Äôs public availability and transparent pipeline make it a cornerstone for open benchmarking of reasoning in LLMs. It also serves as a model for reproducible dataset design, providing controlled ablations and fully open access to both data and evaluation scripts through [openthoughts.ai](https://openthoughts.ai).",
    "order": 51,
    "orderInChapter": 4,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 112,
      "contentLength": 3516
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#model-progression-and-impact",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-summary-52",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "OpenThoughts3: Large-Scale Open Reasoning Dataset",
    "title": "Summary",
    "subtitle": "OpenThoughts3: Large-Scale Open Reasoning Dataset",
    "contentHtml": "<ul>\n  <li><strong>Scope:</strong> 1.2M verified reasoning examples across math, code, and science</li>\n  <li><strong>Evaluation:</strong> Multi-domain, process-aware, and decontaminated benchmarking</li>\n  <li><strong>Teacher Model:</strong> QwQ-32B</li>\n  <li><strong>Performance:</strong> 53 % on AIME 2025, 51 % on LiveCodeBench, 54 % on GPQA Diamond</li>\n  <li>\n    <p><strong>Release:</strong> Fully open dataset and training scripts</p>\n  </li>\n  <li>OpenThoughts3 thus establishes a reproducible, open baseline for evaluating reasoning capabilities, enabling community-wide comparisons and accelerating transparent progress in reasoning-focused LLM development.</li>\n</ul>\n<p><strong>Release:</strong> Fully open dataset and training scripts</p>",
    "contentMarkdown": "*   **Scope:** 1.2M verified reasoning examples across math, code, and science\n*   **Evaluation:** Multi-domain, process-aware, and decontaminated benchmarking\n*   **Teacher Model:** QwQ-32B\n*   **Performance:** 53 % on AIME 2025, 51 % on LiveCodeBench, 54 % on GPQA Diamond\n*   **Release:** Fully open dataset and training scripts\n    \n*   OpenThoughts3 thus establishes a reproducible, open baseline for evaluating reasoning capabilities, enabling community-wide comparisons and accelerating transparent progress in reasoning-focused LLM development.\n\n**Release:** Fully open dataset and training scripts",
    "order": 52,
    "orderInChapter": 5,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 76,
      "contentLength": 753
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#summary",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-dataset-overview-53",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "DROP and Numerical Reading-Comprehension Reasoning",
    "title": "Dataset Overview",
    "subtitle": "DROP and Numerical Reading-Comprehension Reasoning",
    "contentHtml": "<ul>\n  <li><strong>Source</strong>: Passages drawn from Wikipedia.</li>\n  <li><strong>Scale</strong>: ~96,000 question‚Äìanswer pairs.</li>\n  <li><strong>Format</strong>: Each instance consists of a paragraph and a question requiring counting, addition/subtraction, sorting, or comparison.</li>\n  <li>\n    <p><strong>Answer types</strong>: integers, dates, or text spans that must be <em>computed</em>, not just extracted.</p>\n  </li>\n  <li>Example:\n    <ul>\n      <li><strong>Paragraph:</strong> ‚ÄúThe Lakers scored 30 points in the first quarter, 27 in the second, and 33 in the third.‚Äù</li>\n      <li><strong>Question:</strong> ‚ÄúHow many points did they score in the first three quarters?‚Äù</li>\n      <li>Answer: 90.</li>\n    </ul>\n  </li>\n  <li>A standard span-based model (like BERT QA) fails here because the answer does not appear verbatim in the paragraph‚Äîit must be <strong>derived</strong>.</li>\n</ul>\n<p><strong>Answer types</strong>: integers, dates, or text spans that must be <em>computed</em>, not just extracted.</p>\n<ul>\n      <li><strong>Paragraph:</strong> ‚ÄúThe Lakers scored 30 points in the first quarter, 27 in the second, and 33 in the third.‚Äù</li>\n      <li><strong>Question:</strong> ‚ÄúHow many points did they score in the first three quarters?‚Äù</li>\n      <li>Answer: 90.</li>\n    </ul>",
    "contentMarkdown": "*   **Source**: Passages drawn from Wikipedia.\n*   **Scale**: ~96,000 question‚Äìanswer pairs.\n*   **Format**: Each instance consists of a paragraph and a question requiring counting, addition/subtraction, sorting, or comparison.\n*   **Answer types**: integers, dates, or text spans that must be _computed_, not just extracted.\n    \n*   Example:\n    *   **Paragraph:** ‚ÄúThe Lakers scored 30 points in the first quarter, 27 in the second, and 33 in the third.‚Äù\n    *   **Question:** ‚ÄúHow many points did they score in the first three quarters?‚Äù\n    *   Answer: 90.\n*   A standard span-based model (like BERT QA) fails here because the answer does not appear verbatim in the paragraph‚Äîit must be **derived**.\n\n**Answer types**: integers, dates, or text spans that must be _computed_, not just extracted.\n\n*   **Paragraph:** ‚ÄúThe Lakers scored 30 points in the first quarter, 27 in the second, and 33 in the third.‚Äù\n*   **Question:** ‚ÄúHow many points did they score in the first three quarters?‚Äù\n*   Answer: 90.",
    "order": 53,
    "orderInChapter": 1,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "bert"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 154,
      "contentLength": 1309
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#dataset-overview",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-motivation-and-reasoning-focus-54",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "DROP and Numerical Reading-Comprehension Reasoning",
    "title": "Motivation and Reasoning Focus",
    "subtitle": "DROP and Numerical Reading-Comprehension Reasoning",
    "contentHtml": "<ul>\n  <li>DROP was created to probe whether language models can perform <strong>discrete reasoning operations</strong>‚Äîarithmetic, comparison, and logic‚Äîover textual contexts.</li>\n  <li>It shifts evaluation from ‚Äúpattern recognition‚Äù to <em>programmatic inference</em>, where solving a question entails recovering the latent computational procedure:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-286-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>y</mi><mo>&amp;#x22C6;</mo></msup><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>Compute</mtext><mo stretchy=&quot;false&quot;>(</mo><mtext>Extract</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4483\" style=\"width: 16.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.701em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1013.65em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4484\"><span class=\"msubsup\" id=\"MathJax-Span-4485\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4486\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4487\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4488\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4489\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4490\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4491\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4492\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4493\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mtext\" id=\"MathJax-Span-4494\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">Compute</span><span class=\"mo\" id=\"MathJax-Span-4495\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mtext\" id=\"MathJax-Span-4496\" style=\"font-family: STIXGeneral-Regular;\">Extract</span><span class=\"mo\" id=\"MathJax-Span-4497\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4498\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4499\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4500\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4501\" style=\"font-family: STIXGeneral-Regular;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>y</mi><mo>‚ãÜ</mo></msup><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mtext>Compute</mtext><mo stretchy=\"false\">(</mo><mtext>Extract</mtext><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>.</mo></math></span></span></div>\n<ul>\n  <li>Here, Extract identifies relevant numbers and entities, while Compute performs arithmetic or comparison.</li>\n</ul>",
    "contentMarkdown": "*   DROP was created to probe whether language models can perform **discrete reasoning operations**‚Äîarithmetic, comparison, and logic‚Äîover textual contexts.\n*   It shifts evaluation from ‚Äúpattern recognition‚Äù to _programmatic inference_, where solving a question entails recovering the latent computational procedure:\n\ny‚ãÜ\\=f(x)\\=Compute(Extract(x)).y‚ãÜ\\=f(x)\\=Compute(Extract(x)).\n\n*   Here, Extract identifies relevant numbers and entities, while Compute performs arithmetic or comparison.",
    "order": 54,
    "orderInChapter": 2,
    "difficulty": 5,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 54,
      "contentLength": 4571
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#motivation-and-reasoning-focus",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-evaluation-metrics-55",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "DROP and Numerical Reading-Comprehension Reasoning",
    "title": "Evaluation Metrics",
    "subtitle": "DROP and Numerical Reading-Comprehension Reasoning",
    "contentHtml": "<ol>\n  <li>\n    <p><strong>Exact Match (EM):</strong></p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-287-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>EM</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munder><mo>&amp;#x2211;</mo><mi>i</mi></munder><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>&amp;#x22C6;</mo></msubsup><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4502\" style=\"width: 11.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.378em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.836em, 1009.27em, 3.753em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4503\"><span class=\"mtext\" id=\"MathJax-Span-4504\" style=\"font-family: STIXGeneral-Regular;\">EM</span><span class=\"mo\" id=\"MathJax-Span-4505\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-4506\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-4507\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.362em;\"><span class=\"mi\" id=\"MathJax-Span-4508\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.84em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.836em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-4509\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4510\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.576em;\"><span class=\"mi\" id=\"MathJax-Span-4511\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4512\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4513\"><span class=\"mi\" id=\"MathJax-Span-4514\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-4515\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-4516\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4517\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4518\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4519\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4520\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4521\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.58em, 4.169em, -999.997em); top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4522\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4523\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4524\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mtext>EM</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munder><mo>‚àë</mo><mi>i</mi></munder><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>‚ãÜ</mo></msubsup><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-287\">\\text{EM} = \\frac{1}{N}\\sum_i \\mathbb{I}[y_i = y_i^\\star]</script>\n\n    <ul>\n      <li>This metric is strict‚Äîminor numeric formatting differences cause failure.</li>\n    </ul>\n  </li>\n  <li><strong>F1 (Token-level Overlap):</strong>\n    <ul>\n      <li>Measures partial overlap for non-numeric answers (e.g., names, events).</li>\n    </ul>\n  </li>\n  <li><strong>Programmatic Evaluation (Optional):</strong>\n    <ul>\n      <li>Later models include execution-based scoring where answers are verified via symbolic solvers.</li>\n    </ul>\n  </li>\n  <li><strong>Rationale Correctness:</strong>\n    <ul>\n      <li>Optional metric where model-generated reasoning chains are compared against gold reasoning traces.</li>\n    </ul>\n  </li>\n</ol>\n<p><strong>Exact Match (EM):</strong></p>\n<ul>\n      <li>This metric is strict‚Äîminor numeric formatting differences cause failure.</li>\n    </ul>\n<ul>\n      <li>Measures partial overlap for non-numeric answers (e.g., names, events).</li>\n    </ul>\n<ul>\n      <li>Later models include execution-based scoring where answers are verified via symbolic solvers.</li>\n    </ul>\n<ul>\n      <li>Optional metric where model-generated reasoning chains are compared against gold reasoning traces.</li>\n    </ul>",
    "contentMarkdown": "1.  **Exact Match (EM):**\n    \n    EM\\=1N‚àëiùïÄ\\[yi\\=y‚ãÜi\\]EM\\=1N‚àëiI\\[yi\\=yi‚ãÜ\\]\n    \n    \\\\text{EM} = \\\\frac{1}{N}\\\\sum\\_i \\\\mathbb{I}\\[y\\_i = y\\_i^\\\\star\\]\n    *   This metric is strict‚Äîminor numeric formatting differences cause failure.\n2.  **F1 (Token-level Overlap):**\n    *   Measures partial overlap for non-numeric answers (e.g., names, events).\n3.  **Programmatic Evaluation (Optional):**\n    *   Later models include execution-based scoring where answers are verified via symbolic solvers.\n4.  **Rationale Correctness:**\n    *   Optional metric where model-generated reasoning chains are compared against gold reasoning traces.\n\n**Exact Match (EM):**\n\n*   This metric is strict‚Äîminor numeric formatting differences cause failure.\n\n*   Measures partial overlap for non-numeric answers (e.g., names, events).\n\n*   Later models include execution-based scoring where answers are verified via symbolic solvers.\n\n*   Optional metric where model-generated reasoning chains are compared against gold reasoning traces.",
    "order": 55,
    "orderInChapter": 3,
    "difficulty": 5,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 117,
      "contentLength": 7729
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#evaluation-metrics",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-baselines-and-key-results-56",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "DROP and Numerical Reading-Comprehension Reasoning",
    "title": "Baselines and Key Results",
    "subtitle": "DROP and Numerical Reading-Comprehension Reasoning",
    "contentHtml": "<ul>\n  <li><strong>BERT + span extraction</strong> (2019 baseline): ~33 F1 on dev set‚Äîfailed on arithmetic.</li>\n  <li><strong>NumNet and NAQANet</strong> by <a href=\"https://arxiv.org/abs/1903.00161\">Dua et al. (2019)</a>: introduced neural modules for number reasoning (addition, counting).</li>\n  <li><strong>T5, GPT-3, GPT-4</strong> family models (2020‚Äì2024): surpassed 90 F1 using CoT and tool-augmented reasoning (calling calculators or parsers).</li>\n  <li><strong>ReAct frameworks</strong> (see <a href=\"https://arxiv.org/abs/2210.03629\">Yao et al. (2022)</a>): used reasoning + acting loops to dynamically extract, compute, and verify numeric answers.</li>\n</ul>",
    "contentMarkdown": "*   **BERT + span extraction** (2019 baseline): ~33 F1 on dev set‚Äîfailed on arithmetic.\n*   **NumNet and NAQANet** by [Dua et al. (2019)](https://arxiv.org/abs/1903.00161): introduced neural modules for number reasoning (addition, counting).\n*   **T5, GPT-3, GPT-4** family models (2020‚Äì2024): surpassed 90 F1 using CoT and tool-augmented reasoning (calling calculators or parsers).\n*   **ReAct frameworks** (see [Yao et al. (2022)](https://arxiv.org/abs/2210.03629)): used reasoning + acting loops to dynamically extract, compute, and verify numeric answers.",
    "order": 56,
    "orderInChapter": 4,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "bert",
      "gpt"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 71,
      "contentLength": 672
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#baselines-and-key-results",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-reasoning-interfaces-and-enhancements-57",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "DROP and Numerical Reading-Comprehension Reasoning",
    "title": "Reasoning Interfaces and Enhancements",
    "subtitle": "DROP and Numerical Reading-Comprehension Reasoning",
    "contentHtml": "<ol>\n  <li><strong>CoT + Numeric Parsing</strong>\n    <ul>\n      <li>LLMs produce structured reasoning steps such as:</li>\n    </ul>\n\n    <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><div><button class=\"btn-copy\" data-clipboard-action=\"copy\" data-clipboard-target=\"#code2\"><img src=\"https://aman.ai/images/copy.png\" style=\"margin:0; border:none; padding:2px 0px; width:100%; height:18px; width:18px;\"></button></div><code id=\"code2\">Let's add the points: 30 + 27 + 33 = 90.\nThe answer is 90.\n</code></pre></div>    </div>\n\n    <ul>\n      <li>Evaluation then checks whether intermediate steps correspond to correct operations.</li>\n    </ul>\n  </li>\n  <li><strong>Tool-Augmented Solvers</strong>\n    <ul>\n      <li>Toolformer (<a href=\"https://arxiv.org/abs/2302.04761\">Schick et al. (2023)</a>) and PAL (<a href=\"https://arxiv.org/abs/2211.10435\">Gao et al. (2022)</a>) approaches delegate computation to external interpreters (Python), converting reasoning into verifiable program traces.</li>\n    </ul>\n  </li>\n  <li><strong>Process Verification</strong>\n    <ul>\n      <li>Verifier-based checks, inspired by GSM8K‚Äôs verification setup (<a href=\"https://arxiv.org/abs/2110.14168\">Cobbe et al. (2021)</a>), score the consistency between the reasoning chain and the numerical result.</li>\n    </ul>\n  </li>\n</ol>\n<ul>\n      <li>LLMs produce structured reasoning steps such as:</li>\n    </ul>\n<pre class=\"highlight\"><div><button class=\"btn-copy\" data-clipboard-action=\"copy\" data-clipboard-target=\"#code2\"><img src=\"https://aman.ai/images/copy.png\" style=\"margin:0; border:none; padding:2px 0px; width:100%; height:18px; width:18px;\"></button></div><code id=\"code2\">Let's add the points: 30 + 27 + 33 = 90.\nThe answer is 90.\n</code></pre>\n<ul>\n      <li>Evaluation then checks whether intermediate steps correspond to correct operations.</li>\n    </ul>\n<ul>\n      <li>Toolformer (<a href=\"https://arxiv.org/abs/2302.04761\">Schick et al. (2023)</a>) and PAL (<a href=\"https://arxiv.org/abs/2211.10435\">Gao et al. (2022)</a>) approaches delegate computation to external interpreters (Python), converting reasoning into verifiable program traces.</li>\n    </ul>\n<ul>\n      <li>Verifier-based checks, inspired by GSM8K‚Äôs verification setup (<a href=\"https://arxiv.org/abs/2110.14168\">Cobbe et al. (2021)</a>), score the consistency between the reasoning chain and the numerical result.</li>\n    </ul>",
    "contentMarkdown": "1.  **CoT + Numeric Parsing**\n    \n    *   LLMs produce structured reasoning steps such as:\n    \n    ![](https://aman.ai/images/copy.png)\n    \n    `Let's add the points: 30 + 27 + 33 = 90. The answer is 90.`\n    \n    *   Evaluation then checks whether intermediate steps correspond to correct operations.\n2.  **Tool-Augmented Solvers**\n    *   Toolformer ([Schick et al. (2023)](https://arxiv.org/abs/2302.04761)) and PAL ([Gao et al. (2022)](https://arxiv.org/abs/2211.10435)) approaches delegate computation to external interpreters (Python), converting reasoning into verifiable program traces.\n3.  **Process Verification**\n    *   Verifier-based checks, inspired by GSM8K‚Äôs verification setup ([Cobbe et al. (2021)](https://arxiv.org/abs/2110.14168)), score the consistency between the reasoning chain and the numerical result.\n\n*   LLMs produce structured reasoning steps such as:\n\n![](https://aman.ai/images/copy.png)\n\n`Let's add the points: 30 + 27 + 33 = 90. The answer is 90.`\n\n*   Evaluation then checks whether intermediate steps correspond to correct operations.\n\n*   Toolformer ([Schick et al. (2023)](https://arxiv.org/abs/2302.04761)) and PAL ([Gao et al. (2022)](https://arxiv.org/abs/2211.10435)) approaches delegate computation to external interpreters (Python), converting reasoning into verifiable program traces.\n\n*   Verifier-based checks, inspired by GSM8K‚Äôs verification setup ([Cobbe et al. (2021)](https://arxiv.org/abs/2110.14168)), score the consistency between the reasoning chain and the numerical result.",
    "order": 57,
    "orderInChapter": 5,
    "difficulty": 5,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": true,
      "hasMath": false,
      "hasImages": true,
      "wordCount": 177,
      "contentLength": 2446
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#reasoning-interfaces-and-enhancements",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-dataset-extensions-and-successors-58",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "DROP and Numerical Reading-Comprehension Reasoning",
    "title": "Dataset Extensions and Successors",
    "subtitle": "DROP and Numerical Reading-Comprehension Reasoning",
    "contentHtml": "<ul>\n  <li><strong>QASC</strong> (<a href=\"https://arxiv.org/abs/2001.07166\">Khot et al. (2020)</a>): tests multi-hop science reasoning with facts, complementing DROP‚Äôs numerical focus.</li>\n  <li><strong>MathQA-NL</strong> (<a href=\"https://arxiv.org/abs/1905.13319\">Amini et al. (2019)</a>): converts math word problems into natural language arithmetic reasoning tasks.</li>\n  <li><strong>NumGLUE</strong> (<a href=\"https://arxiv.org/abs/2204.05456\">Lin et al. (2022)</a>): provides broader numeric reasoning tasks across diverse NLP settings.</li>\n</ul>",
    "contentMarkdown": "*   **QASC** ([Khot et al. (2020)](https://arxiv.org/abs/2001.07166)): tests multi-hop science reasoning with facts, complementing DROP‚Äôs numerical focus.\n*   **MathQA-NL** ([Amini et al. (2019)](https://arxiv.org/abs/1905.13319)): converts math word problems into natural language arithmetic reasoning tasks.\n*   **NumGLUE** ([Lin et al. (2022)](https://arxiv.org/abs/2204.05456)): provides broader numeric reasoning tasks across diverse NLP settings.",
    "order": 58,
    "orderInChapter": 6,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "nlp"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 47,
      "contentLength": 556
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#dataset-extensions-and-successors",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-key-insights-from-drop-59",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "DROP and Numerical Reading-Comprehension Reasoning",
    "title": "Key Insights from DROP",
    "subtitle": "DROP and Numerical Reading-Comprehension Reasoning",
    "contentHtml": "<ul>\n  <li><strong>Discrete reasoning is bottlenecked by arithmetic grounding</strong>, not linguistic comprehension.</li>\n  <li><strong>Tool augmentation</strong> consistently boosts performance by externalizing computation.</li>\n  <li><strong>Self-verification</strong> (reflection) improves robustness to arithmetic hallucinations.</li>\n  <li><strong>Evaluation beyond accuracy</strong>‚Äîincluding reasoning trace validity‚Äîis essential for judging genuine reasoning.</li>\n</ul>",
    "contentMarkdown": "*   **Discrete reasoning is bottlenecked by arithmetic grounding**, not linguistic comprehension.\n*   **Tool augmentation** consistently boosts performance by externalizing computation.\n*   **Self-verification** (reflection) improves robustness to arithmetic hallucinations.\n*   **Evaluation beyond accuracy**‚Äîincluding reasoning trace validity‚Äîis essential for judging genuine reasoning.",
    "order": 59,
    "orderInChapter": 7,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 40,
      "contentLength": 479
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#key-insights-from-drop",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-purpose-and-structure-60",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "BIG-bench and BIG-bench Hard",
    "title": "Purpose and Structure",
    "subtitle": "BIG-bench and BIG-bench Hard",
    "contentHtml": "<ul>\n  <li>\n    <p>BIG-bench‚Äôs goal is to measure <strong>emergent capabilities</strong>‚Äîbehaviors that appear only once models cross certain scale or training thresholds.\nEach task consists of an input prompt, model-generated completion, and ground-truth reference, with metrics varying by task type (accuracy, BLEU, likelihood, etc.).</p>\n  </li>\n  <li>\n    <p><strong>Task families include:</strong></p>\n\n    <ul>\n      <li><strong>Symbolic and logical reasoning:</strong> arithmetic, boolean algebra, sorting, and pattern completion.</li>\n      <li><strong>Commonsense reasoning:</strong> physical causality, temporal logic, and counterfactual inference.</li>\n      <li><strong>Language understanding:</strong> ambiguity resolution, analogies, and narrative reasoning.</li>\n      <li><strong>Social and ethical reasoning:</strong> moral dilemmas, intent recognition, sarcasm detection.</li>\n    </ul>\n  </li>\n</ul>\n<p>BIG-bench‚Äôs goal is to measure <strong>emergent capabilities</strong>‚Äîbehaviors that appear only once models cross certain scale or training thresholds.\nEach task consists of an input prompt, model-generated completion, and ground-truth reference, with metrics varying by task type (accuracy, BLEU, likelihood, etc.).</p>\n<p><strong>Task families include:</strong></p>\n<ul>\n      <li><strong>Symbolic and logical reasoning:</strong> arithmetic, boolean algebra, sorting, and pattern completion.</li>\n      <li><strong>Commonsense reasoning:</strong> physical causality, temporal logic, and counterfactual inference.</li>\n      <li><strong>Language understanding:</strong> ambiguity resolution, analogies, and narrative reasoning.</li>\n      <li><strong>Social and ethical reasoning:</strong> moral dilemmas, intent recognition, sarcasm detection.</li>\n    </ul>",
    "contentMarkdown": "*   BIG-bench‚Äôs goal is to measure **emergent capabilities**‚Äîbehaviors that appear only once models cross certain scale or training thresholds. Each task consists of an input prompt, model-generated completion, and ground-truth reference, with metrics varying by task type (accuracy, BLEU, likelihood, etc.).\n    \n*   **Task families include:**\n    \n    *   **Symbolic and logical reasoning:** arithmetic, boolean algebra, sorting, and pattern completion.\n    *   **Commonsense reasoning:** physical causality, temporal logic, and counterfactual inference.\n    *   **Language understanding:** ambiguity resolution, analogies, and narrative reasoning.\n    *   **Social and ethical reasoning:** moral dilemmas, intent recognition, sarcasm detection.\n\nBIG-bench‚Äôs goal is to measure **emergent capabilities**‚Äîbehaviors that appear only once models cross certain scale or training thresholds. Each task consists of an input prompt, model-generated completion, and ground-truth reference, with metrics varying by task type (accuracy, BLEU, likelihood, etc.).\n\n**Task families include:**\n\n*   **Symbolic and logical reasoning:** arithmetic, boolean algebra, sorting, and pattern completion.\n*   **Commonsense reasoning:** physical causality, temporal logic, and counterfactual inference.\n*   **Language understanding:** ambiguity resolution, analogies, and narrative reasoning.\n*   **Social and ethical reasoning:** moral dilemmas, intent recognition, sarcasm detection.",
    "order": 60,
    "orderInChapter": 1,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 172,
      "contentLength": 1783
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#purpose-and-structure",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-big-bench-hard-bbh-61",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "BIG-bench and BIG-bench Hard",
    "title": "BIG-bench Hard (BBH)",
    "subtitle": "BIG-bench and BIG-bench Hard",
    "contentHtml": "<h4 id=\"motivation-1\">Motivation</h4>\n<ul>\n  <li>\n    <p>In the original BIG-bench, task difficulty varied widely. To better analyze ‚Äúemergence,‚Äù <a href=\"https://arxiv.org/abs/2210.09261\">Suzgun et al. (2022)</a> selected <strong>23 particularly challenging tasks</strong> where:</p>\n\n    <ul>\n      <li>Small models (e.g., GPT-2 XL, 1.5B) performed at chance, but</li>\n      <li>Larger models (e.g., PaLM 62B, 540B) showed steep accuracy gains.</li>\n    </ul>\n  </li>\n  <li>\n    <p>These are called <em>BIG-bench Hard</em> tasks.</p>\n  </li>\n  <li>\n    <p><strong>Examples of BBH tasks:</strong></p>\n\n    <ul>\n      <li>Logical deduction and implication.</li>\n      <li>Dyck language (balanced parentheses) recognition.</li>\n      <li>Object counting and list manipulation.</li>\n      <li>Strategy and planning puzzles.</li>\n      <li>Hyperbaton (syntactic inversion) understanding.</li>\n    </ul>\n  </li>\n</ul>\n<p>In the original BIG-bench, task difficulty varied widely. To better analyze ‚Äúemergence,‚Äù <a href=\"https://arxiv.org/abs/2210.09261\">Suzgun et al. (2022)</a> selected <strong>23 particularly challenging tasks</strong> where:</p>\n<ul>\n      <li>Small models (e.g., GPT-2 XL, 1.5B) performed at chance, but</li>\n      <li>Larger models (e.g., PaLM 62B, 540B) showed steep accuracy gains.</li>\n    </ul>\n<p>These are called <em>BIG-bench Hard</em> tasks.</p>\n<p><strong>Examples of BBH tasks:</strong></p>\n<ul>\n      <li>Logical deduction and implication.</li>\n      <li>Dyck language (balanced parentheses) recognition.</li>\n      <li>Object counting and list manipulation.</li>\n      <li>Strategy and planning puzzles.</li>\n      <li>Hyperbaton (syntactic inversion) understanding.</li>\n    </ul>\n<h4 id=\"evaluation-and-analysis\">Evaluation and Analysis</h4>\n<ul>\n  <li>Performance on BIG-bench and BBH is typically reported as accuracy or exact-match correctness.</li>\n  <li>\n    <p>Researchers also track performance curves over model scale to detect emergent ‚Äúaha‚Äù transitions:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-288-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mtext>Acc</mtext><mi>s</mi></msub><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mtext>params</mtext><mi>s</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4525\" style=\"width: 9.065em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.555em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1007.5em, 2.607em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4526\"><span class=\"msubsup\" id=\"MathJax-Span-4527\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1001.57em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-4528\" style=\"font-family: STIXGeneral-Regular;\">Acc</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.617em;\"><span class=\"mi\" id=\"MathJax-Span-4529\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4530\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4531\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4532\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4533\"><span style=\"display: inline-block; position: relative; width: 3.232em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.87em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mtext\" id=\"MathJax-Span-4534\" style=\"font-family: STIXGeneral-Regular;\">params</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.747em; left: 2.867em;\"><span class=\"mi\" id=\"MathJax-Span-4535\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4536\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mtext>Acc</mtext><mi>s</mi></msub><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mtext>params</mtext><mi>s</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-288\">\\text{Acc}_s = f(\\text{params}_s)</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-289-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4537\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4538\"><span class=\"mi\" id=\"MathJax-Span-4539\" style=\"font-family: STIXGeneral-Italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>f</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-289\">f</script> shows near-flat trends for small models and steep rises once model capacity exceeds a critical threshold.</li>\n    </ul>\n  </li>\n  <li>\n    <p>To reduce metric artifacts, <a href=\"https://arxiv.org/abs/2304.15004\">Schaeffer et al. (2023)</a> recommend supplementing discrete accuracy with smoother calibration or log-likelihood metrics.</p>\n  </li>\n  <li>\n    <p><strong>Metrics typically used:</strong></p>\n\n    <ul>\n      <li>Accuracy (binary/categorical tasks).</li>\n      <li>BLEU or F1 (generation tasks).</li>\n      <li>Calibration Error (ECE).</li>\n      <li>Agreement with reasoning verifiers (for CoT versions).</li>\n    </ul>\n  </li>\n</ul>\n<p>Researchers also track performance curves over model scale to detect emergent ‚Äúaha‚Äù transitions:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-289-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4537\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4538\"><span class=\"mi\" id=\"MathJax-Span-4539\" style=\"font-family: STIXGeneral-Italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.159em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>f</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-289\">f</script> shows near-flat trends for small models and steep rises once model capacity exceeds a critical threshold.</li>\n    </ul>\n<p>To reduce metric artifacts, <a href=\"https://arxiv.org/abs/2304.15004\">Schaeffer et al. (2023)</a> recommend supplementing discrete accuracy with smoother calibration or log-likelihood metrics.</p>\n<p><strong>Metrics typically used:</strong></p>\n<ul>\n      <li>Accuracy (binary/categorical tasks).</li>\n      <li>BLEU or F1 (generation tasks).</li>\n      <li>Calibration Error (ECE).</li>\n      <li>Agreement with reasoning verifiers (for CoT versions).</li>\n    </ul>\n<h4 id=\"findings-and-emergent-patterns\">Findings and Emergent Patterns</h4>\n<ul>\n  <li><strong>Emergence with scale:</strong> Several tasks (e.g., logical deduction, hyperbaton) show abrupt accuracy jumps once model scale passes tens of billions of parameters.</li>\n  <li><strong>Prompting sensitivity:</strong> CoT and self-consistency often unlock previously latent competence.</li>\n  <li><strong>Task diversity:</strong> Certain reasoning domains (symbolic or mathematical) scale predictably, while others (commonsense, ethics) show flat curves.</li>\n  <li><strong>Interface effect:</strong> Some improvements reflect reasoning elicitation rather than new model structure‚Äîhighlighting the importance of consistent evaluation.</li>\n</ul>\n<h4 id=\"big-bench-as-a-meta-evaluation-platform\">BIG-bench As a Meta-Evaluation Platform</h4>\n<ul>\n  <li>\n    <p>BIG-bench is not a single dataset but an <strong>evaluation framework</strong>:</p>\n\n    <ul>\n      <li>Tasks are JSON-based and standardized for easy replication.</li>\n      <li>Each model‚Äôs results are published via the <a href=\"https://github.com/google/BIG-bench\">BIG-bench leaderboard</a>.</li>\n      <li>Later extensions (e.g., <strong>HELM</strong> by <a href=\"https://arxiv.org/abs/2211.09110\">Liang et al. (2022)</a>) adopt its multi-metric design philosophy.</li>\n    </ul>\n  </li>\n</ul>\n<p>BIG-bench is not a single dataset but an <strong>evaluation framework</strong>:</p>\n<ul>\n      <li>Tasks are JSON-based and standardized for easy replication.</li>\n      <li>Each model‚Äôs results are published via the <a href=\"https://github.com/google/BIG-bench\">BIG-bench leaderboard</a>.</li>\n      <li>Later extensions (e.g., <strong>HELM</strong> by <a href=\"https://arxiv.org/abs/2211.09110\">Liang et al. (2022)</a>) adopt its multi-metric design philosophy.</li>\n    </ul>\n<h4 id=\"key-insights\">Key Insights</h4>\n<ul>\n  <li><strong>Reasoning as a function of scale:</strong> BBH tasks provide the cleanest empirical evidence of emergent reasoning, complementing the theoretical analyses of <a href=\"https://arxiv.org/abs/2206.07682\">Wei et al. (2022)</a>.</li>\n  <li><strong>Variance across domains:</strong> Some reasoning abilities (e.g., symbolic manipulation) are more predictable under scaling than others (commonsense or analogical reasoning).</li>\n  <li><strong>Need for mixed metrics:</strong> Threshold metrics exaggerate ‚Äúemergence‚Äù and should be balanced with probabilistic scores.</li>\n  <li><strong>Prompting and sampling matter:</strong> CoT and self-consistency often unlock hidden performance, showing that reasoning can be elicited rather than learned.</li>\n</ul>\n<h4 id=\"relation-to-other-benchmarks\">Relation to Other Benchmarks</h4>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Benchmark</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Focus</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reasoning Type</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Metric</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">GSM8K</td>\n<td class=\"tg-tleft-valign-first\">Multi-step arithmetic</td>\n<td class=\"tg-tleft-valign-first\">Quantitative</td>\n<td class=\"tg-tleft-valign-second\">EM, verifier accuracy</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">MATH</td>\n<td class=\"tg-tleft-valign-first\">Symbolic derivation</td>\n<td class=\"tg-tleft-valign-first\">Algebraic/logical</td>\n<td class=\"tg-tleft-valign-second\">Symbolic EM</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">DROP</td>\n<td class=\"tg-tleft-valign-first\">Numerical text reasoning</td>\n<td class=\"tg-tleft-valign-first\">Discrete arithmetic</td>\n<td class=\"tg-tleft-valign-second\">EM, F1</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">BIG-bench</td>\n<td class=\"tg-tleft-valign-first\">General reasoning (200+ tasks)</td>\n<td class=\"tg-tleft-valign-first\">Mixed</td>\n<td class=\"tg-tleft-valign-second\">Accuracy, calibration</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">BBH</td>\n<td class=\"tg-tleft-valign-first\">Emergent reasoning subset</td>\n<td class=\"tg-tleft-valign-first\">Symbolic, logical</td>\n<td class=\"tg-tleft-valign-second\">Accuracy</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Benchmark</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Focus</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reasoning Type</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Metric</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">GSM8K</td>\n<td class=\"tg-tleft-valign-first\">Multi-step arithmetic</td>\n<td class=\"tg-tleft-valign-first\">Quantitative</td>\n<td class=\"tg-tleft-valign-second\">EM, verifier accuracy</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">MATH</td>\n<td class=\"tg-tleft-valign-first\">Symbolic derivation</td>\n<td class=\"tg-tleft-valign-first\">Algebraic/logical</td>\n<td class=\"tg-tleft-valign-second\">Symbolic EM</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">DROP</td>\n<td class=\"tg-tleft-valign-first\">Numerical text reasoning</td>\n<td class=\"tg-tleft-valign-first\">Discrete arithmetic</td>\n<td class=\"tg-tleft-valign-second\">EM, F1</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">BIG-bench</td>\n<td class=\"tg-tleft-valign-first\">General reasoning (200+ tasks)</td>\n<td class=\"tg-tleft-valign-first\">Mixed</td>\n<td class=\"tg-tleft-valign-second\">Accuracy, calibration</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">BBH</td>\n<td class=\"tg-tleft-valign-first\">Emergent reasoning subset</td>\n<td class=\"tg-tleft-valign-first\">Symbolic, logical</td>\n<td class=\"tg-tleft-valign-second\">Accuracy</td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "#### Motivation\n\n*   In the original BIG-bench, task difficulty varied widely. To better analyze ‚Äúemergence,‚Äù [Suzgun et al. (2022)](https://arxiv.org/abs/2210.09261) selected **23 particularly challenging tasks** where:\n    \n    *   Small models (e.g., GPT-2 XL, 1.5B) performed at chance, but\n    *   Larger models (e.g., PaLM 62B, 540B) showed steep accuracy gains.\n*   These are called _BIG-bench Hard_ tasks.\n    \n*   **Examples of BBH tasks:**\n    \n    *   Logical deduction and implication.\n    *   Dyck language (balanced parentheses) recognition.\n    *   Object counting and list manipulation.\n    *   Strategy and planning puzzles.\n    *   Hyperbaton (syntactic inversion) understanding.\n\nIn the original BIG-bench, task difficulty varied widely. To better analyze ‚Äúemergence,‚Äù [Suzgun et al. (2022)](https://arxiv.org/abs/2210.09261) selected **23 particularly challenging tasks** where:\n\n*   Small models (e.g., GPT-2 XL, 1.5B) performed at chance, but\n*   Larger models (e.g., PaLM 62B, 540B) showed steep accuracy gains.\n\nThese are called _BIG-bench Hard_ tasks.\n\n**Examples of BBH tasks:**\n\n*   Logical deduction and implication.\n*   Dyck language (balanced parentheses) recognition.\n*   Object counting and list manipulation.\n*   Strategy and planning puzzles.\n*   Hyperbaton (syntactic inversion) understanding.\n\n#### Evaluation and Analysis\n\n*   Performance on BIG-bench and BBH is typically reported as accuracy or exact-match correctness.\n*   Researchers also track performance curves over model scale to detect emergent ‚Äúaha‚Äù transitions:\n    \n    Accs\\=f(paramss)Accs\\=f(paramss)\n    \n    \\\\text{Acc}\\_s = f(\\\\text{params}\\_s)\n    *   where fff shows near-flat trends for small models and steep rises once model capacity exceeds a critical threshold.\n*   To reduce metric artifacts, [Schaeffer et al. (2023)](https://arxiv.org/abs/2304.15004) recommend supplementing discrete accuracy with smoother calibration or log-likelihood metrics.\n    \n*   **Metrics typically used:**\n    \n    *   Accuracy (binary/categorical tasks).\n    *   BLEU or F1 (generation tasks).\n    *   Calibration Error (ECE).\n    *   Agreement with reasoning verifiers (for CoT versions).\n\nResearchers also track performance curves over model scale to detect emergent ‚Äúaha‚Äù transitions:\n\n*   where fff shows near-flat trends for small models and steep rises once model capacity exceeds a critical threshold.\n\nTo reduce metric artifacts, [Schaeffer et al. (2023)](https://arxiv.org/abs/2304.15004) recommend supplementing discrete accuracy with smoother calibration or log-likelihood metrics.\n\n**Metrics typically used:**\n\n*   Accuracy (binary/categorical tasks).\n*   BLEU or F1 (generation tasks).\n*   Calibration Error (ECE).\n*   Agreement with reasoning verifiers (for CoT versions).\n\n#### Findings and Emergent Patterns\n\n*   **Emergence with scale:** Several tasks (e.g., logical deduction, hyperbaton) show abrupt accuracy jumps once model scale passes tens of billions of parameters.\n*   **Prompting sensitivity:** CoT and self-consistency often unlock previously latent competence.\n*   **Task diversity:** Certain reasoning domains (symbolic or mathematical) scale predictably, while others (commonsense, ethics) show flat curves.\n*   **Interface effect:** Some improvements reflect reasoning elicitation rather than new model structure‚Äîhighlighting the importance of consistent evaluation.\n\n#### BIG-bench As a Meta-Evaluation Platform\n\n*   BIG-bench is not a single dataset but an **evaluation framework**:\n    \n    *   Tasks are JSON-based and standardized for easy replication.\n    *   Each model‚Äôs results are published via the [BIG-bench leaderboard](https://github.com/google/BIG-bench).\n    *   Later extensions (e.g., **HELM** by [Liang et al. (2022)](https://arxiv.org/abs/2211.09110)) adopt its multi-metric design philosophy.\n\nBIG-bench is not a single dataset but an **evaluation framework**:\n\n*   Tasks are JSON-based and standardized for easy replication.\n*   Each model‚Äôs results are published via the [BIG-bench leaderboard](https://github.com/google/BIG-bench).\n*   Later extensions (e.g., **HELM** by [Liang et al. (2022)](https://arxiv.org/abs/2211.09110)) adopt its multi-metric design philosophy.\n\n#### Key Insights\n\n*   **Reasoning as a function of scale:** BBH tasks provide the cleanest empirical evidence of emergent reasoning, complementing the theoretical analyses of [Wei et al. (2022)](https://arxiv.org/abs/2206.07682).\n*   **Variance across domains:** Some reasoning abilities (e.g., symbolic manipulation) are more predictable under scaling than others (commonsense or analogical reasoning).\n*   **Need for mixed metrics:** Threshold metrics exaggerate ‚Äúemergence‚Äù and should be balanced with probabilistic scores.\n*   **Prompting and sampling matter:** CoT and self-consistency often unlock hidden performance, showing that reasoning can be elicited rather than learned.\n\n#### Relation to Other Benchmarks\n\n**Benchmark**\n\n**Focus**\n\n**Reasoning Type**\n\n**Metric**\n\nGSM8K\n\nMulti-step arithmetic\n\nQuantitative\n\nEM, verifier accuracy\n\nMATH\n\nSymbolic derivation\n\nAlgebraic/logical\n\nSymbolic EM\n\nDROP\n\nNumerical text reasoning\n\nDiscrete arithmetic\n\nEM, F1\n\nBIG-bench\n\nGeneral reasoning (200+ tasks)\n\nMixed\n\nAccuracy, calibration\n\nBBH\n\nEmergent reasoning subset\n\nSymbolic, logical\n\nAccuracy\n\n**Benchmark**\n\n**Focus**\n\n**Reasoning Type**\n\n**Metric**\n\nGSM8K\n\nMulti-step arithmetic\n\nQuantitative\n\nEM, verifier accuracy\n\nMATH\n\nSymbolic derivation\n\nAlgebraic/logical\n\nSymbolic EM\n\nDROP\n\nNumerical text reasoning\n\nDiscrete arithmetic\n\nEM, F1\n\nBIG-bench\n\nGeneral reasoning (200+ tasks)\n\nMixed\n\nAccuracy, calibration\n\nBBH\n\nEmergent reasoning subset\n\nSymbolic, logical\n\nAccuracy",
    "order": 61,
    "orderInChapter": 2,
    "difficulty": 5,
    "estimatedMinutes": 4,
    "tags": [
      "nlpllms",
      "gpt"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 686,
      "contentLength": 15134
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#big-bench-hard-(bbh)",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-mmlu-strengths-and-limitations-62",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "MMLU and AGIEval (Knowledge + Reasoning Exam Benchmarks)",
    "title": "MMLU: Strengths and Limitations",
    "subtitle": "MMLU and AGIEval (Knowledge + Reasoning Exam Benchmarks)",
    "contentHtml": "<h4 id=\"overview-1\">Overview</h4>\n<ul>\n  <li>MMLU consists of <strong>15,908 multiple-choice questions</strong> drawn from <strong>57 academic subjects</strong> spanning four difficulty levels: elementary, high school, college, and professional.</li>\n  <li>Each question has four answer options and one correct answer.</li>\n  <li>It was designed to evaluate <em>broad world knowledge</em> and <em>academic competence</em>‚Äîfrom U.S. history to physics to philosophy.</li>\n</ul>\n<h4 id=\"what-it-measures\">What It Measures</h4>\n<ul>\n  <li>Despite being widely reported as a reasoning benchmark, MMLU primarily tests <strong>factual recall and concept recognition</strong> rather than multi-step reasoning.</li>\n  <li>Many questions take the form: ‚ÄúWhich of the following best describes the function of mitochondria?‚Äù*</li>\n  <li>Such questions require retrieving a known fact rather than performing compositional inference or deduction.</li>\n  <li>A smaller subset‚Äîparticularly in mathematics, logic, and formal reasoning subdomains‚Äîdo require actual reasoning, but these represent a minority.</li>\n  <li>Formally, models solve most MMLU items by maximizing <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-290-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4540\" style=\"width: 10.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1008.91em, 2.711em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4541\"><span class=\"texatom\" id=\"MathJax-Span-4542\"><span class=\"mrow\" id=\"MathJax-Span-4543\"><span class=\"munderover\" id=\"MathJax-Span-4544\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4545\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4546\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4547\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4548\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-4549\"></span><span class=\"munderover\" id=\"MathJax-Span-4550\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4551\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 1.721em;\"><span class=\"mi\" id=\"MathJax-Span-4552\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4553\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4554\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4555\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4556\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4557\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-4558\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4559\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4560\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-290\">\\hat{y} = \\arg\\max_y p_\\theta(y\\mid x)</script>, without needing to construct latent reasoning chains <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-291-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4561\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4562\"><span class=\"mi\" id=\"MathJax-Span-4563\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-291\">z</script>.</li>\n  <li>The evaluation does <strong>not</strong> assess reasoning steps, explanations, or causal understanding.</li>\n</ul>\n<h4 id=\"empirical-pattern\">Empirical Pattern</h4>\n<ul>\n  <li>\n    <p>Performance correlates strongly with model <em>pretraining breadth</em> and <em>instruction-tuning</em>, not with explicit reasoning training:</p>\n\n    <ul>\n      <li>GPT-4, Claude 3, and Gemini 1.5 Pro all exceed 85 % accuracy, approaching or surpassing average human expert performance.</li>\n      <li>Smaller models (‚â§13B parameters) exhibit smooth scaling without discontinuous ‚Äúaha‚Äù jumps.</li>\n      <li>Reasoning-centric techniques (e.g., CoT prompting) yield only minor improvements‚Äîconfirming that most tasks do not require stepwise inference.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Thus, <strong>MMLU is a great measure of factual competence and transfer learning</strong>, but a <strong>weak measure of true reasoning</strong>.</p>\n  </li>\n</ul>\n<p>Performance correlates strongly with model <em>pretraining breadth</em> and <em>instruction-tuning</em>, not with explicit reasoning training:</p>\n<ul>\n      <li>GPT-4, Claude 3, and Gemini 1.5 Pro all exceed 85 % accuracy, approaching or surpassing average human expert performance.</li>\n      <li>Smaller models (‚â§13B parameters) exhibit smooth scaling without discontinuous ‚Äúaha‚Äù jumps.</li>\n      <li>Reasoning-centric techniques (e.g., CoT prompting) yield only minor improvements‚Äîconfirming that most tasks do not require stepwise inference.</li>\n    </ul>\n<p>Thus, <strong>MMLU is a great measure of factual competence and transfer learning</strong>, but a <strong>weak measure of true reasoning</strong>.</p>",
    "contentMarkdown": "#### Overview\n\n*   MMLU consists of **15,908 multiple-choice questions** drawn from **57 academic subjects** spanning four difficulty levels: elementary, high school, college, and professional.\n*   Each question has four answer options and one correct answer.\n*   It was designed to evaluate _broad world knowledge_ and _academic competence_‚Äîfrom U.S. history to physics to philosophy.\n\n#### What It Measures\n\n*   Despite being widely reported as a reasoning benchmark, MMLU primarily tests **factual recall and concept recognition** rather than multi-step reasoning.\n*   Many questions take the form: ‚ÄúWhich of the following best describes the function of mitochondria?‚Äù\\*\n*   Such questions require retrieving a known fact rather than performing compositional inference or deduction.\n*   A smaller subset‚Äîparticularly in mathematics, logic, and formal reasoning subdomains‚Äîdo require actual reasoning, but these represent a minority.\n*   Formally, models solve most MMLU items by maximizing yÃÇ¬†\\=argmaxypŒ∏(y‚à£x)y^\\=arg‚Å°maxypŒ∏(y‚à£x)\\\\hat{y} = \\\\arg\\\\max\\_y p\\_\\\\theta(y\\\\mid x), without needing to construct latent reasoning chains zzz.\n*   The evaluation does **not** assess reasoning steps, explanations, or causal understanding.\n\n#### Empirical Pattern\n\n*   Performance correlates strongly with model _pretraining breadth_ and _instruction-tuning_, not with explicit reasoning training:\n    \n    *   GPT-4, Claude 3, and Gemini 1.5 Pro all exceed 85 % accuracy, approaching or surpassing average human expert performance.\n    *   Smaller models (‚â§13B parameters) exhibit smooth scaling without discontinuous ‚Äúaha‚Äù jumps.\n    *   Reasoning-centric techniques (e.g., CoT prompting) yield only minor improvements‚Äîconfirming that most tasks do not require stepwise inference.\n*   Thus, **MMLU is a great measure of factual competence and transfer learning**, but a **weak measure of true reasoning**.\n    \n\nPerformance correlates strongly with model _pretraining breadth_ and _instruction-tuning_, not with explicit reasoning training:\n\n*   GPT-4, Claude 3, and Gemini 1.5 Pro all exceed 85 % accuracy, approaching or surpassing average human expert performance.\n*   Smaller models (‚â§13B parameters) exhibit smooth scaling without discontinuous ‚Äúaha‚Äù jumps.\n*   Reasoning-centric techniques (e.g., CoT prompting) yield only minor improvements‚Äîconfirming that most tasks do not require stepwise inference.\n\nThus, **MMLU is a great measure of factual competence and transfer learning**, but a **weak measure of true reasoning**.",
    "order": 62,
    "orderInChapter": 1,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "nlpllms",
      "gpt",
      "transfer learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 334,
      "contentLength": 9326
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#mmlu:-strengths-and-limitations",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-agieval-toward-cognitive-and-reasoning-exams-63",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "MMLU and AGIEval (Knowledge + Reasoning Exam Benchmarks)",
    "title": "AGIEval: Toward Cognitive and Reasoning Exams",
    "subtitle": "MMLU and AGIEval (Knowledge + Reasoning Exam Benchmarks)",
    "contentHtml": "<h4 id=\"overview-2\">Overview</h4>\n<ul>\n  <li>AGIEval, introduced by <a href=\"https://arxiv.org/abs/2304.06364\">Zhong et al. (2023)</a>, repositions evaluation around <strong>human standardized exams</strong>‚ÄîSAT, LSAT, GRE, Gaokao, and CPA‚Äîto test not just recall but <em>logical, linguistic, and numerical reasoning</em>.</li>\n</ul>\n<h4 id=\"dataset-composition-1\">Dataset Composition</h4>\n<ul>\n  <li>~5,000 exam-style multiple-choice questions.</li>\n  <li>Sources include real standardized tests with verified solutions.</li>\n  <li>Domains: reading comprehension, logical reasoning, quantitative problem solving, and language understanding.</li>\n</ul>\n<h4 id=\"why-it-matters-2\">Why It Matters</h4>\n<ul>\n  <li>AGIEval questions are structurally different from MMLU‚Äôs academic facts:</li>\n  <li>They often require <em>multi-step reasoning over text</em>, e.g., drawing inferences, identifying assumptions, or evaluating argument strength.</li>\n  <li>\n    <p>Many items cannot be solved by simple lookup or pattern matching.</p>\n  </li>\n  <li>\n    <p>For instance:</p>\n\n    <blockquote>\n      <p>‚ÄúIf all A are B, and some B are not C, which of the following must be true?‚Äù</p>\n    </blockquote>\n  </li>\n  <li>This demands deductive reasoning‚Äîsomething MMLU largely omits.</li>\n</ul>\n<p>Many items cannot be solved by simple lookup or pattern matching.</p>\n<p>For instance:</p>\n<blockquote>\n      <p>‚ÄúIf all A are B, and some B are not C, which of the following must be true?‚Äù</p>\n    </blockquote>\n<p>‚ÄúIf all A are B, and some B are not C, which of the following must be true?‚Äù</p>\n<h4 id=\"evaluation-metric\">Evaluation Metric</h4>\n<ul>\n  <li>Standard accuracy:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-292-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>Acc</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munder><mo>&amp;#x2211;</mo><mi>i</mi></munder><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>I</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>&amp;#x22C6;</mo></msubsup><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4564\" style=\"width: 11.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.482em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.836em, 1009.38em, 3.753em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4565\"><span class=\"mtext\" id=\"MathJax-Span-4566\" style=\"font-family: STIXGeneral-Regular;\">Acc</span><span class=\"mo\" id=\"MathJax-Span-4567\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-4568\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-4569\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.362em;\"><span class=\"mi\" id=\"MathJax-Span-4570\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.84em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.836em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-4571\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4572\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.576em;\"><span class=\"mi\" id=\"MathJax-Span-4573\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4574\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4575\"><span class=\"mi\" id=\"MathJax-Span-4576\" style=\"font-family: STIXGeneral-Regular;\">ùïÄ</span></span></span><span class=\"mo\" id=\"MathJax-Span-4577\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-4578\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4579\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4580\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4581\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4582\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4583\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.58em, 4.169em, -999.997em); top: -4.372em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-4584\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÜ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4585\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4586\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mtext>Acc</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munder><mo>‚àë</mo><mi>i</mi></munder><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">I</mi></mrow><mo stretchy=\"false\">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mo>‚ãÜ</mo></msubsup><mo stretchy=\"false\">]</mo></math></span></span></div>\n<ul>\n  <li>Optionally augmented by <strong>process-based scoring</strong> for models that generate reasoning traces before selecting an answer (e.g., ‚ÄúLet‚Äôs think step by step‚Äù).</li>\n</ul>\n<h4 id=\"empirical-findings\">Empirical Findings</h4>\n<ul>\n  <li>Models that use <strong>CoT prompting</strong> perform significantly better on AGIEval (up to +15 %), indicating real reasoning benefit.</li>\n  <li>Human-level reasoning (90 %+) is not yet achieved even by frontier models; top systems like GPT-4 and Claude 3 remain around 70‚Äì80 %.</li>\n  <li>Results on AGIEval correlate more closely with reasoning-heavy benchmarks like BBH and ARC-AGI-2 than with MMLU.</li>\n</ul>",
    "contentMarkdown": "#### Overview\n\n*   AGIEval, introduced by [Zhong et al. (2023)](https://arxiv.org/abs/2304.06364), repositions evaluation around **human standardized exams**‚ÄîSAT, LSAT, GRE, Gaokao, and CPA‚Äîto test not just recall but _logical, linguistic, and numerical reasoning_.\n\n#### Dataset Composition\n\n*   ~5,000 exam-style multiple-choice questions.\n*   Sources include real standardized tests with verified solutions.\n*   Domains: reading comprehension, logical reasoning, quantitative problem solving, and language understanding.\n\n#### Why It Matters\n\n*   AGIEval questions are structurally different from MMLU‚Äôs academic facts:\n*   They often require _multi-step reasoning over text_, e.g., drawing inferences, identifying assumptions, or evaluating argument strength.\n*   Many items cannot be solved by simple lookup or pattern matching.\n    \n*   For instance:\n    \n    > ‚ÄúIf all A are B, and some B are not C, which of the following must be true?‚Äù\n    \n*   This demands deductive reasoning‚Äîsomething MMLU largely omits.\n\nMany items cannot be solved by simple lookup or pattern matching.\n\nFor instance:\n\n> ‚ÄúIf all A are B, and some B are not C, which of the following must be true?‚Äù\n\n‚ÄúIf all A are B, and some B are not C, which of the following must be true?‚Äù\n\n#### Evaluation Metric\n\n*   Standard accuracy:\n\nAcc\\=1N‚àëiùïÄ\\[yi\\=y‚ãÜi\\]Acc\\=1N‚àëiI\\[yi\\=yi‚ãÜ\\]\n\n*   Optionally augmented by **process-based scoring** for models that generate reasoning traces before selecting an answer (e.g., ‚ÄúLet‚Äôs think step by step‚Äù).\n\n#### Empirical Findings\n\n*   Models that use **CoT prompting** perform significantly better on AGIEval (up to +15 %), indicating real reasoning benefit.\n*   Human-level reasoning (90 %+) is not yet achieved even by frontier models; top systems like GPT-4 and Claude 3 remain around 70‚Äì80 %.\n*   Results on AGIEval correlate more closely with reasoning-heavy benchmarks like BBH and ARC-AGI-2 than with MMLU.",
    "order": 63,
    "orderInChapter": 2,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "nlpllms",
      "gpt"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 275,
      "contentLength": 8640
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#agieval:-toward-cognitive-and-reasoning-exams",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-comparative-analysis-64",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "MMLU and AGIEval (Knowledge + Reasoning Exam Benchmarks)",
    "title": "Comparative Analysis",
    "subtitle": "MMLU and AGIEval (Knowledge + Reasoning Exam Benchmarks)",
    "contentHtml": "<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Benchmark</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Scope</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reasoning Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Nature of Difficulty</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Primary Strength</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Primary Weakness</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>MMLU</strong></td>\n<td class=\"tg-tleft-valign-first\">57 subjects</td>\n<td class=\"tg-tleft-valign-first\">Mostly factual, some conceptual reasoning</td>\n<td class=\"tg-tleft-valign-first\">Wide domain coverage</td>\n<td class=\"tg-tleft-valign-first\">Measures knowledge breadth and domain recall</td>\n<td class=\"tg-tleft-valign-second\">Weak process reasoning, high data overlap risk</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>AGIEval</strong></td>\n<td class=\"tg-tleft-valign-first\">Human exams (SAT, LSAT, etc.)</td>\n<td class=\"tg-tleft-valign-first\">Deductive, verbal, and quantitative reasoning</td>\n<td class=\"tg-tleft-valign-first\">Deep text comprehension</td>\n<td class=\"tg-tleft-valign-first\">Stronger reasoning discrimination</td>\n<td class=\"tg-tleft-valign-second\">Smaller scale, limited public data</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Benchmark</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Scope</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reasoning Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Nature of Difficulty</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Primary Strength</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Primary Weakness</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>MMLU</strong></td>\n<td class=\"tg-tleft-valign-first\">57 subjects</td>\n<td class=\"tg-tleft-valign-first\">Mostly factual, some conceptual reasoning</td>\n<td class=\"tg-tleft-valign-first\">Wide domain coverage</td>\n<td class=\"tg-tleft-valign-first\">Measures knowledge breadth and domain recall</td>\n<td class=\"tg-tleft-valign-second\">Weak process reasoning, high data overlap risk</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>AGIEval</strong></td>\n<td class=\"tg-tleft-valign-first\">Human exams (SAT, LSAT, etc.)</td>\n<td class=\"tg-tleft-valign-first\">Deductive, verbal, and quantitative reasoning</td>\n<td class=\"tg-tleft-valign-first\">Deep text comprehension</td>\n<td class=\"tg-tleft-valign-first\">Stronger reasoning discrimination</td>\n<td class=\"tg-tleft-valign-second\">Smaller scale, limited public data</td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "**Benchmark**\n\n**Scope**\n\n**Reasoning Type**\n\n**Nature of Difficulty**\n\n**Primary Strength**\n\n**Primary Weakness**\n\n**MMLU**\n\n57 subjects\n\nMostly factual, some conceptual reasoning\n\nWide domain coverage\n\nMeasures knowledge breadth and domain recall\n\nWeak process reasoning, high data overlap risk\n\n**AGIEval**\n\nHuman exams (SAT, LSAT, etc.)\n\nDeductive, verbal, and quantitative reasoning\n\nDeep text comprehension\n\nStronger reasoning discrimination\n\nSmaller scale, limited public data\n\n**Benchmark**\n\n**Scope**\n\n**Reasoning Type**\n\n**Nature of Difficulty**\n\n**Primary Strength**\n\n**Primary Weakness**\n\n**MMLU**\n\n57 subjects\n\nMostly factual, some conceptual reasoning\n\nWide domain coverage\n\nMeasures knowledge breadth and domain recall\n\nWeak process reasoning, high data overlap risk\n\n**AGIEval**\n\nHuman exams (SAT, LSAT, etc.)\n\nDeductive, verbal, and quantitative reasoning\n\nDeep text comprehension\n\nStronger reasoning discrimination\n\nSmaller scale, limited public data",
    "order": 64,
    "orderInChapter": 3,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 114,
      "contentLength": 2793
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#comparative-analysis",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-motivation-65",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "HELM and Holistic Multi-Metric Reasoning Evaluation",
    "title": "Motivation",
    "subtitle": "HELM and Holistic Multi-Metric Reasoning Evaluation",
    "contentHtml": "<ul>\n  <li>Prior benchmarks (like MMLU, GSM8K, or BIG-bench) tend to isolate narrow skills‚Äîeither factual recall or specific reasoning patterns‚Äîand use coarse metrics such as exact match or accuracy.</li>\n  <li>\n    <p>HELM argues that such single-dimensional evaluations are <strong>incomplete and sometimes misleading</strong>, because real reasoning quality depends on <strong>trade-offs among multiple axes</strong>:</p>\n\n    <ol>\n      <li><strong>Accuracy:</strong> Does the model produce the correct output?</li>\n      <li><strong>Calibration:</strong> Does the model know what it doesn‚Äôt know?</li>\n      <li><strong>Robustness:</strong> Is reasoning stable under paraphrase, perturbation, or prompt variation?</li>\n      <li><strong>Fairness and bias:</strong> Does reasoning remain consistent across demographic contexts?</li>\n      <li><strong>Efficiency:</strong> How much computation or prompting is required?</li>\n      <li><strong>Transparency:</strong> Can we interpret and reproduce the reasoning process?</li>\n    </ol>\n  </li>\n  <li>\n    <p>This multidimensional framing turns reasoning evaluation into a <em>Pareto optimization</em> problem:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-293-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>Model quality</mtext><mo>=</mo><mtext>Pareto</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>A</mi><mo>,</mo><mi>R</mi><mo>,</mo><mi>C</mi><mo>,</mo><mi>F</mi><mo>,</mo><mi>E</mi><mo>,</mo><mi>T</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4587\" style=\"width: 19.586em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.305em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1016.25em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4588\"><span class=\"mtext\" id=\"MathJax-Span-4589\" style=\"font-family: STIXGeneral-Regular;\">Model quality</span><span class=\"mo\" id=\"MathJax-Span-4590\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mtext\" id=\"MathJax-Span-4591\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">Pareto</span><span class=\"mo\" id=\"MathJax-Span-4592\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4593\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-4594\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4595\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">R</span><span class=\"mo\" id=\"MathJax-Span-4596\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4597\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">C<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4598\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4599\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">F<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4600\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4601\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">E<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4602\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4603\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4604\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mtext>Model quality</mtext><mo>=</mo><mtext>Pareto</mtext><mo stretchy=\"false\">(</mo><mi>A</mi><mo>,</mo><mi>R</mi><mo>,</mo><mi>C</mi><mo>,</mo><mi>F</mi><mo>,</mo><mi>E</mi><mo>,</mo><mi>T</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-293\">\\text{Model quality} = \\text{Pareto}(A, R, C, F, E, T)</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-294-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>A</mi><mo>,</mo><mi>R</mi><mo>,</mo><mi>C</mi><mo>,</mo><mi>F</mi><mo>,</mo><mi>E</mi><mo>,</mo><mi>T</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4605\" style=\"width: 8.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.93em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1006.88em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4606\"><span class=\"mo\" id=\"MathJax-Span-4607\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4608\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-4609\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4610\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">R</span><span class=\"mo\" id=\"MathJax-Span-4611\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4612\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">C<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4613\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4614\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">F<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4615\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4616\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">E<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4617\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4618\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4619\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>A</mi><mo>,</mo><mi>R</mi><mo>,</mo><mi>C</mi><mo>,</mo><mi>F</mi><mo>,</mo><mi>E</mi><mo>,</mo><mi>T</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-294\">(A, R, C, F, E, T)</script> correspond to the six axes above.</li>\n    </ul>\n  </li>\n</ul>\n<p>HELM argues that such single-dimensional evaluations are <strong>incomplete and sometimes misleading</strong>, because real reasoning quality depends on <strong>trade-offs among multiple axes</strong>:</p>\n<ol>\n      <li><strong>Accuracy:</strong> Does the model produce the correct output?</li>\n      <li><strong>Calibration:</strong> Does the model know what it doesn‚Äôt know?</li>\n      <li><strong>Robustness:</strong> Is reasoning stable under paraphrase, perturbation, or prompt variation?</li>\n      <li><strong>Fairness and bias:</strong> Does reasoning remain consistent across demographic contexts?</li>\n      <li><strong>Efficiency:</strong> How much computation or prompting is required?</li>\n      <li><strong>Transparency:</strong> Can we interpret and reproduce the reasoning process?</li>\n    </ol>\n<p>This multidimensional framing turns reasoning evaluation into a <em>Pareto optimization</em> problem:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-294-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>A</mi><mo>,</mo><mi>R</mi><mo>,</mo><mi>C</mi><mo>,</mo><mi>F</mi><mo>,</mo><mi>E</mi><mo>,</mo><mi>T</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4605\" style=\"width: 8.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.93em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1006.88em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4606\"><span class=\"mo\" id=\"MathJax-Span-4607\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4608\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-4609\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4610\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">R</span><span class=\"mo\" id=\"MathJax-Span-4611\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4612\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">C<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4613\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4614\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">F<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4615\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4616\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">E<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4617\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4618\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4619\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>A</mi><mo>,</mo><mi>R</mi><mo>,</mo><mi>C</mi><mo>,</mo><mi>F</mi><mo>,</mo><mi>E</mi><mo>,</mo><mi>T</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-294\">(A, R, C, F, E, T)</script> correspond to the six axes above.</li>\n    </ul>",
    "contentMarkdown": "*   Prior benchmarks (like MMLU, GSM8K, or BIG-bench) tend to isolate narrow skills‚Äîeither factual recall or specific reasoning patterns‚Äîand use coarse metrics such as exact match or accuracy.\n*   HELM argues that such single-dimensional evaluations are **incomplete and sometimes misleading**, because real reasoning quality depends on **trade-offs among multiple axes**:\n    \n    1.  **Accuracy:** Does the model produce the correct output?\n    2.  **Calibration:** Does the model know what it doesn‚Äôt know?\n    3.  **Robustness:** Is reasoning stable under paraphrase, perturbation, or prompt variation?\n    4.  **Fairness and bias:** Does reasoning remain consistent across demographic contexts?\n    5.  **Efficiency:** How much computation or prompting is required?\n    6.  **Transparency:** Can we interpret and reproduce the reasoning process?\n*   This multidimensional framing turns reasoning evaluation into a _Pareto optimization_ problem:\n    \n    Model quality\\=Pareto(A,R,C,F,E,T)Model quality\\=Pareto(A,R,C,F,E,T)\n    \n    \\\\text{Model quality} = \\\\text{Pareto}(A, R, C, F, E, T)\n    *   where (A,R,C,F,E,T)(A,R,C,F,E,T)(A, R, C, F, E, T) correspond to the six axes above.\n\nHELM argues that such single-dimensional evaluations are **incomplete and sometimes misleading**, because real reasoning quality depends on **trade-offs among multiple axes**:\n\n1.  **Accuracy:** Does the model produce the correct output?\n2.  **Calibration:** Does the model know what it doesn‚Äôt know?\n3.  **Robustness:** Is reasoning stable under paraphrase, perturbation, or prompt variation?\n4.  **Fairness and bias:** Does reasoning remain consistent across demographic contexts?\n5.  **Efficiency:** How much computation or prompting is required?\n6.  **Transparency:** Can we interpret and reproduce the reasoning process?\n\nThis multidimensional framing turns reasoning evaluation into a _Pareto optimization_ problem:\n\n*   where (A,R,C,F,E,T)(A,R,C,F,E,T)(A, R, C, F, E, T) correspond to the six axes above.",
    "order": 65,
    "orderInChapter": 1,
    "difficulty": 5,
    "estimatedMinutes": 2,
    "tags": [
      "nlpllms",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 254,
      "contentLength": 12162
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#motivation",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-structure-of-helm-66",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "HELM and Holistic Multi-Metric Reasoning Evaluation",
    "title": "Structure of HELM",
    "subtitle": "HELM and Holistic Multi-Metric Reasoning Evaluation",
    "contentHtml": "<ul>\n  <li>HELM integrates <strong>over 40 datasets</strong> covering reasoning, knowledge, and generative tasks.</li>\n  <li>\n    <p>Its reasoning-oriented subsets include:</p>\n\n    <ul>\n      <li><strong>GSM8K</strong> (mathematical reasoning).</li>\n      <li><strong>DROP</strong> (numerical reasoning).</li>\n      <li><strong>BoolQ</strong> (yes/no logical reasoning).</li>\n      <li><strong>HellaSwag</strong> (commonsense reasoning).</li>\n      <li><strong>ARC-Challenge</strong> (science reasoning).</li>\n      <li><strong>BBH</strong> (emergent reasoning).</li>\n    </ul>\n  </li>\n  <li>For each dataset, HELM reports a consistent set of <strong>12 metrics</strong>, not just accuracy.\nThis enables a full performance ‚Äúprofile‚Äù for each model.</li>\n</ul>\n<p>Its reasoning-oriented subsets include:</p>\n<ul>\n      <li><strong>GSM8K</strong> (mathematical reasoning).</li>\n      <li><strong>DROP</strong> (numerical reasoning).</li>\n      <li><strong>BoolQ</strong> (yes/no logical reasoning).</li>\n      <li><strong>HellaSwag</strong> (commonsense reasoning).</li>\n      <li><strong>ARC-Challenge</strong> (science reasoning).</li>\n      <li><strong>BBH</strong> (emergent reasoning).</li>\n    </ul>",
    "contentMarkdown": "*   HELM integrates **over 40 datasets** covering reasoning, knowledge, and generative tasks.\n*   Its reasoning-oriented subsets include:\n    \n    *   **GSM8K** (mathematical reasoning).\n    *   **DROP** (numerical reasoning).\n    *   **BoolQ** (yes/no logical reasoning).\n    *   **HellaSwag** (commonsense reasoning).\n    *   **ARC-Challenge** (science reasoning).\n    *   **BBH** (emergent reasoning).\n*   For each dataset, HELM reports a consistent set of **12 metrics**, not just accuracy. This enables a full performance ‚Äúprofile‚Äù for each model.\n\nIts reasoning-oriented subsets include:\n\n*   **GSM8K** (mathematical reasoning).\n*   **DROP** (numerical reasoning).\n*   **BoolQ** (yes/no logical reasoning).\n*   **HellaSwag** (commonsense reasoning).\n*   **ARC-Challenge** (science reasoning).\n*   **BBH** (emergent reasoning).",
    "order": 66,
    "orderInChapter": 2,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 95,
      "contentLength": 1204
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#structure-of-helm",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-key-evaluation-dimensions-for-reasoning-67",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "HELM and Holistic Multi-Metric Reasoning Evaluation",
    "title": "Key Evaluation Dimensions for Reasoning",
    "subtitle": "HELM and Holistic Multi-Metric Reasoning Evaluation",
    "contentHtml": "<ol>\n  <li>\n    <p><strong>Process fidelity</strong>\nDoes the model‚Äôs reasoning trace (if produced) align with valid logical steps?\nProcess supervision (as in <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a>) can be embedded into HELM evaluation pipelines.</p>\n  </li>\n  <li>\n    <p><strong>Factual consistency</strong>\nMeasures alignment between reasoning steps and external knowledge sources‚Äîimportant for fact-based reasoning tasks.\nDerived from factuality literature (see <a href=\"https://arxiv.org/abs/2303.15046\">Min et al. (2023)</a>).</p>\n  </li>\n  <li>\n    <p><strong>Calibration of confidence</strong>\nUses metrics like <strong>Expected Calibration Error (ECE)</strong> or <strong>Brier score</strong> to test whether probability estimates match correctness likelihood.\nFor reasoning, this checks whether the model‚Äôs ‚Äúconfidence‚Äù reflects reasoning soundness.</p>\n  </li>\n  <li>\n    <p><strong>Robustness and generalization</strong>\nEvaluates whether reasoning quality persists under paraphrasing or domain shifts‚Äîe.g., testing multiple phrasings of GSM8K or DROP problems.</p>\n  </li>\n  <li>\n    <p><strong>Efficiency and scalability</strong>\nTracks compute usage per query and sensitivity to sampling parameters (temperature, top-k).\nHelps reveal when reasoning improvements depend on costly inference techniques (e.g., self-consistency with 50 samples).</p>\n  </li>\n</ol>\n<p><strong>Process fidelity</strong>\nDoes the model‚Äôs reasoning trace (if produced) align with valid logical steps?\nProcess supervision (as in <a href=\"https://arxiv.org/abs/2305.20050\">Lightman et al. (2023)</a>) can be embedded into HELM evaluation pipelines.</p>\n<p><strong>Factual consistency</strong>\nMeasures alignment between reasoning steps and external knowledge sources‚Äîimportant for fact-based reasoning tasks.\nDerived from factuality literature (see <a href=\"https://arxiv.org/abs/2303.15046\">Min et al. (2023)</a>).</p>\n<p><strong>Calibration of confidence</strong>\nUses metrics like <strong>Expected Calibration Error (ECE)</strong> or <strong>Brier score</strong> to test whether probability estimates match correctness likelihood.\nFor reasoning, this checks whether the model‚Äôs ‚Äúconfidence‚Äù reflects reasoning soundness.</p>\n<p><strong>Robustness and generalization</strong>\nEvaluates whether reasoning quality persists under paraphrasing or domain shifts‚Äîe.g., testing multiple phrasings of GSM8K or DROP problems.</p>\n<p><strong>Efficiency and scalability</strong>\nTracks compute usage per query and sensitivity to sampling parameters (temperature, top-k).\nHelps reveal when reasoning improvements depend on costly inference techniques (e.g., self-consistency with 50 samples).</p>",
    "contentMarkdown": "1.  **Process fidelity** Does the model‚Äôs reasoning trace (if produced) align with valid logical steps? Process supervision (as in [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050)) can be embedded into HELM evaluation pipelines.\n    \n2.  **Factual consistency** Measures alignment between reasoning steps and external knowledge sources‚Äîimportant for fact-based reasoning tasks. Derived from factuality literature (see [Min et al. (2023)](https://arxiv.org/abs/2303.15046)).\n    \n3.  **Calibration of confidence** Uses metrics like **Expected Calibration Error (ECE)** or **Brier score** to test whether probability estimates match correctness likelihood. For reasoning, this checks whether the model‚Äôs ‚Äúconfidence‚Äù reflects reasoning soundness.\n    \n4.  **Robustness and generalization** Evaluates whether reasoning quality persists under paraphrasing or domain shifts‚Äîe.g., testing multiple phrasings of GSM8K or DROP problems.\n    \n5.  **Efficiency and scalability** Tracks compute usage per query and sensitivity to sampling parameters (temperature, top-k). Helps reveal when reasoning improvements depend on costly inference techniques (e.g., self-consistency with 50 samples).\n    \n\n**Process fidelity** Does the model‚Äôs reasoning trace (if produced) align with valid logical steps? Process supervision (as in [Lightman et al. (2023)](https://arxiv.org/abs/2305.20050)) can be embedded into HELM evaluation pipelines.\n\n**Factual consistency** Measures alignment between reasoning steps and external knowledge sources‚Äîimportant for fact-based reasoning tasks. Derived from factuality literature (see [Min et al. (2023)](https://arxiv.org/abs/2303.15046)).\n\n**Calibration of confidence** Uses metrics like **Expected Calibration Error (ECE)** or **Brier score** to test whether probability estimates match correctness likelihood. For reasoning, this checks whether the model‚Äôs ‚Äúconfidence‚Äù reflects reasoning soundness.\n\n**Robustness and generalization** Evaluates whether reasoning quality persists under paraphrasing or domain shifts‚Äîe.g., testing multiple phrasings of GSM8K or DROP problems.\n\n**Efficiency and scalability** Tracks compute usage per query and sensitivity to sampling parameters (temperature, top-k). Helps reveal when reasoning improvements depend on costly inference techniques (e.g., self-consistency with 50 samples).",
    "order": 67,
    "orderInChapter": 3,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 277,
      "contentLength": 2705
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#key-evaluation-dimensions-for-reasoning",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-helm-as-meta-evaluation-infrastructure-68",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "HELM and Holistic Multi-Metric Reasoning Evaluation",
    "title": "HELM As Meta-Evaluation Infrastructure",
    "subtitle": "HELM and Holistic Multi-Metric Reasoning Evaluation",
    "contentHtml": "<ul>\n  <li>\n    <p>HELM is <strong>modular and extensible</strong>:</p>\n\n    <ul>\n      <li>Provides a standard API for adding reasoning tasks.</li>\n      <li>Normalizes metrics across datasets, allowing meaningful comparison of reasoning vs. recall performance.</li>\n      <li>Exposes <em>Pareto frontiers</em>‚Äîplots showing trade-offs among metrics (e.g., accuracy vs. calibration).</li>\n    </ul>\n  </li>\n  <li>Example:\n    <ul>\n      <li>A model that is 2 % less accurate but 30 % better calibrated may be preferable for safety-critical reasoning.</li>\n    </ul>\n  </li>\n  <li>Open evaluation dashboards are maintained at <a href=\"https://crfm.stanford.edu/helm\">https://crfm.stanford.edu/helm</a>, where recent LLMs (GPT-4, Claude 3, Gemini, Llama 3) are compared under identical metrics and contexts.</li>\n</ul>\n<p>HELM is <strong>modular and extensible</strong>:</p>\n<ul>\n      <li>Provides a standard API for adding reasoning tasks.</li>\n      <li>Normalizes metrics across datasets, allowing meaningful comparison of reasoning vs. recall performance.</li>\n      <li>Exposes <em>Pareto frontiers</em>‚Äîplots showing trade-offs among metrics (e.g., accuracy vs. calibration).</li>\n    </ul>\n<ul>\n      <li>A model that is 2 % less accurate but 30 % better calibrated may be preferable for safety-critical reasoning.</li>\n    </ul>",
    "contentMarkdown": "*   HELM is **modular and extensible**:\n    \n    *   Provides a standard API for adding reasoning tasks.\n    *   Normalizes metrics across datasets, allowing meaningful comparison of reasoning vs. recall performance.\n    *   Exposes _Pareto frontiers_‚Äîplots showing trade-offs among metrics (e.g., accuracy vs. calibration).\n*   Example:\n    *   A model that is 2 % less accurate but 30 % better calibrated may be preferable for safety-critical reasoning.\n*   Open evaluation dashboards are maintained at [https://crfm.stanford.edu/helm](https://crfm.stanford.edu/helm), where recent LLMs (GPT-4, Claude 3, Gemini, Llama 3) are compared under identical metrics and contexts.\n\nHELM is **modular and extensible**:\n\n*   Provides a standard API for adding reasoning tasks.\n*   Normalizes metrics across datasets, allowing meaningful comparison of reasoning vs. recall performance.\n*   Exposes _Pareto frontiers_‚Äîplots showing trade-offs among metrics (e.g., accuracy vs. calibration).\n\n*   A model that is 2 % less accurate but 30 % better calibrated may be preferable for safety-critical reasoning.",
    "order": 68,
    "orderInChapter": 4,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "gpt",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 145,
      "contentLength": 1336
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#helm-as-meta-evaluation-infrastructure",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-insights-from-helm-on-reasoning-evaluation-69",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "HELM and Holistic Multi-Metric Reasoning Evaluation",
    "title": "Insights from HELM on Reasoning Evaluation",
    "subtitle": "HELM and Holistic Multi-Metric Reasoning Evaluation",
    "contentHtml": "<ul>\n  <li><strong>Reasoning quality is multidimensional:</strong> Pure accuracy hides calibration or brittleness problems.</li>\n  <li><strong>Bigger isn‚Äôt always better:</strong> Some smaller, specialized models show higher <em>process fidelity</em> despite lower overall accuracy.</li>\n  <li><strong>Process metrics matter:</strong> Explicit reasoning supervision yields better calibration and factual consistency scores even when raw accuracy changes little.</li>\n  <li><strong>Benchmark unification helps generalization:</strong> Comparing performance across multiple reasoning datasets reveals consistent failure modes (e.g., arithmetic carry errors, logic reversals).</li>\n</ul>",
    "contentMarkdown": "*   **Reasoning quality is multidimensional:** Pure accuracy hides calibration or brittleness problems.\n*   **Bigger isn‚Äôt always better:** Some smaller, specialized models show higher _process fidelity_ despite lower overall accuracy.\n*   **Process metrics matter:** Explicit reasoning supervision yields better calibration and factual consistency scores even when raw accuracy changes little.\n*   **Benchmark unification helps generalization:** Comparing performance across multiple reasoning datasets reveals consistent failure modes (e.g., arithmetic carry errors, logic reversals).",
    "order": 69,
    "orderInChapter": 5,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 70,
      "contentLength": 684
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#insights-from-helm-on-reasoning-evaluation",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-tabular-summary-70",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "HELM and Holistic Multi-Metric Reasoning Evaluation",
    "title": "Tabular Summary",
    "subtitle": "HELM and Holistic Multi-Metric Reasoning Evaluation",
    "contentHtml": "<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Property</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Goal</strong></td>\n<td class=\"tg-tleft-valign-second\">Unified, multi-metric evaluation of LLM reasoning and knowledge</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Key Metrics</strong></td>\n<td class=\"tg-tleft-valign-second\">Accuracy, calibration, robustness, fairness, efficiency, transparency</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Core Idea</strong></td>\n<td class=\"tg-tleft-valign-second\">Reasoning should be judged holistically, not just by EM or accuracy</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Representative Paper</strong></td>\n<td class=\"tg-tleft-valign-second\"><em>HELM: Holistic Evaluation of Language Models</em> by <a href=\"https://arxiv.org/abs/2211.09110\">Liang et al. (2022)</a></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Property</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Goal</strong></td>\n<td class=\"tg-tleft-valign-second\">Unified, multi-metric evaluation of LLM reasoning and knowledge</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Key Metrics</strong></td>\n<td class=\"tg-tleft-valign-second\">Accuracy, calibration, robustness, fairness, efficiency, transparency</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Core Idea</strong></td>\n<td class=\"tg-tleft-valign-second\">Reasoning should be judged holistically, not just by EM or accuracy</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Representative Paper</strong></td>\n<td class=\"tg-tleft-valign-second\"><em>HELM: Holistic Evaluation of Language Models</em> by <a href=\"https://arxiv.org/abs/2211.09110\">Liang et al. (2022)</a></td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "**Property**\n\n**Description**\n\n**Goal**\n\nUnified, multi-metric evaluation of LLM reasoning and knowledge\n\n**Key Metrics**\n\nAccuracy, calibration, robustness, fairness, efficiency, transparency\n\n**Core Idea**\n\nReasoning should be judged holistically, not just by EM or accuracy\n\n**Representative Paper**\n\n_HELM: Holistic Evaluation of Language Models_ by [Liang et al. (2022)](https://arxiv.org/abs/2211.09110)\n\n**Property**\n\n**Description**\n\n**Goal**\n\nUnified, multi-metric evaluation of LLM reasoning and knowledge\n\n**Key Metrics**\n\nAccuracy, calibration, robustness, fairness, efficiency, transparency\n\n**Core Idea**\n\nReasoning should be judged holistically, not just by EM or accuracy\n\n**Representative Paper**\n\n_HELM: Holistic Evaluation of Language Models_ by [Liang et al. (2022)](https://arxiv.org/abs/2211.09110)",
    "order": 70,
    "orderInChapter": 6,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 90,
      "contentLength": 2053
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#tabular-summary",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-architectural-families-71",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Multimodal Reasoning and Factuality",
    "title": "Architectural Families",
    "subtitle": "Multimodal Reasoning and Factuality",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Encoder‚ÄìLLM adapters</strong>: Vision features flow into a frozen or lightly tuned LLM through learned adapters/gates. Representative examples include Flamingo by <a href=\"https://arxiv.org/abs/2204.14198\">Alayrac et al. (2022)</a>. These models handle interleaved image‚Äìtext streams and support few-shot visual learning.</p>\n  </li>\n  <li>\n    <p><strong>End-to-end LVLMs with visual instruction tuning</strong>: LLaVA scales a vision encoder + LLM via curated ‚Äúvisual instruction‚Äù data to unlock step-by-step multimodal dialogue; see Visual Instruction Tuning (LLaVA) by <a href=\"https://arxiv.org/abs/2304.08485\">Liu et al. (2023)</a> and the <a href=\"https://llava-vl.github.io/\">LLaVA project page</a>).</p>\n  </li>\n  <li>\n    <p><strong>Embodied multimodal models</strong>: PaLM-E projects continuous robot/vision observations into a language space to support grounded planning and question answering, demonstrating cross-modal transfer from VL tasks to real-world control by <a href=\"https://arxiv.org/abs/2303.03378\">Driess et al. (2023)</a> (<a href=\"https://palm-e.github.io/\">Project page</a>).</p>\n  </li>\n</ul>\n<p><strong>Encoder‚ÄìLLM adapters</strong>: Vision features flow into a frozen or lightly tuned LLM through learned adapters/gates. Representative examples include Flamingo by <a href=\"https://arxiv.org/abs/2204.14198\">Alayrac et al. (2022)</a>. These models handle interleaved image‚Äìtext streams and support few-shot visual learning.</p>\n<p><strong>End-to-end LVLMs with visual instruction tuning</strong>: LLaVA scales a vision encoder + LLM via curated ‚Äúvisual instruction‚Äù data to unlock step-by-step multimodal dialogue; see Visual Instruction Tuning (LLaVA) by <a href=\"https://arxiv.org/abs/2304.08485\">Liu et al. (2023)</a> and the <a href=\"https://llava-vl.github.io/\">LLaVA project page</a>).</p>\n<p><strong>Embodied multimodal models</strong>: PaLM-E projects continuous robot/vision observations into a language space to support grounded planning and question answering, demonstrating cross-modal transfer from VL tasks to real-world control by <a href=\"https://arxiv.org/abs/2303.03378\">Driess et al. (2023)</a> (<a href=\"https://palm-e.github.io/\">Project page</a>).</p>",
    "contentMarkdown": "*   **Encoder‚ÄìLLM adapters**: Vision features flow into a frozen or lightly tuned LLM through learned adapters/gates. Representative examples include Flamingo by [Alayrac et al. (2022)](https://arxiv.org/abs/2204.14198). These models handle interleaved image‚Äìtext streams and support few-shot visual learning.\n    \n*   **End-to-end LVLMs with visual instruction tuning**: LLaVA scales a vision encoder + LLM via curated ‚Äúvisual instruction‚Äù data to unlock step-by-step multimodal dialogue; see Visual Instruction Tuning (LLaVA) by [Liu et al. (2023)](https://arxiv.org/abs/2304.08485) and the [LLaVA project page](https://llava-vl.github.io/)).\n    \n*   **Embodied multimodal models**: PaLM-E projects continuous robot/vision observations into a language space to support grounded planning and question answering, demonstrating cross-modal transfer from VL tasks to real-world control by [Driess et al. (2023)](https://arxiv.org/abs/2303.03378) ([Project page](https://palm-e.github.io/)).\n    \n\n**Encoder‚ÄìLLM adapters**: Vision features flow into a frozen or lightly tuned LLM through learned adapters/gates. Representative examples include Flamingo by [Alayrac et al. (2022)](https://arxiv.org/abs/2204.14198). These models handle interleaved image‚Äìtext streams and support few-shot visual learning.\n\n**End-to-end LVLMs with visual instruction tuning**: LLaVA scales a vision encoder + LLM via curated ‚Äúvisual instruction‚Äù data to unlock step-by-step multimodal dialogue; see Visual Instruction Tuning (LLaVA) by [Liu et al. (2023)](https://arxiv.org/abs/2304.08485) and the [LLaVA project page](https://llava-vl.github.io/)).\n\n**Embodied multimodal models**: PaLM-E projects continuous robot/vision observations into a language space to support grounded planning and question answering, demonstrating cross-modal transfer from VL tasks to real-world control by [Driess et al. (2023)](https://arxiv.org/abs/2303.03378) ([Project page](https://palm-e.github.io/)).",
    "order": 71,
    "orderInChapter": 1,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 219,
      "contentLength": 2233
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#architectural-families",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-reasoning-interfaces-72",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Multimodal Reasoning and Factuality",
    "title": "Reasoning Interfaces",
    "subtitle": "Multimodal Reasoning and Factuality",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Multimodal CoT</strong>: Extend textual CoT with visual grounding: first generate a rationale that references detected objects/regions, then infer the answer. Multimodal CoT by <a href=\"https://arxiv.org/abs/2302.00923\">Zhang et al. (2023)</a> (OpenReview: <a href=\"https://openreview.net/forum?id=gDlsMWost9\">https://openreview.net/forum?id=gDlsMWost9</a>) formalizes a two-stage pipeline: rationale generation followed by answer inference.</p>\n  </li>\n  <li>\n    <p><strong>Tool-augmented visual reasoning</strong>: For charts, documents, and math-in-images, models benefit from OCR, table parsers, and Python execution. This effectively computes:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-298-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>y</mi></munder><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>z</mi></mrow></munder><mo>,</mo><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><mi>z</mi><mo>,</mo><mtext>OCR</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>v</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mtext>Exec</mtext><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow><mo>,</mo><msub><mi>p</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo>,</mo><mi>v</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4667\" style=\"width: 25.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 21.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.034em, 1021.15em, 4.638em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4668\"><span class=\"texatom\" id=\"MathJax-Span-4669\"><span class=\"mrow\" id=\"MathJax-Span-4670\"><span class=\"munderover\" id=\"MathJax-Span-4671\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4672\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4673\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4674\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4675\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-4676\"></span><span class=\"munderover\" id=\"MathJax-Span-4677\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4678\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.43em, -999.997em); top: -3.331em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-4679\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-4680\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4681\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.326em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4682\"><span class=\"mrow\" id=\"MathJax-Span-4683\"><span class=\"mi\" id=\"MathJax-Span-4684\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4685\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4686\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"texatom\" id=\"MathJax-Span-4687\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-4688\"><span class=\"mo\" id=\"MathJax-Span-4689\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-4690\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-4691\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-4692\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">OCR</span><span class=\"mo\" id=\"MathJax-Span-4693\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4694\" style=\"font-family: STIXGeneral-Italic;\">v</span><span class=\"mo\" id=\"MathJax-Span-4695\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4696\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-4697\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">Exec</span><span class=\"mo\" id=\"MathJax-Span-4698\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-4699\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-4700\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-4701\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-4702\"><span class=\"mo\" id=\"MathJax-Span-4703\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4704\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4705\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4706\" style=\"font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4707\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4708\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4709\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-4710\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4711\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4712\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4713\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">v</span><span class=\"mo\" id=\"MathJax-Span-4714\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 2.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>y</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>y</mi></munder><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>z</mi></mrow></munder><mo>,</mo><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><mi>z</mi><mo>,</mo><mtext>OCR</mtext><mo stretchy=\"false\">(</mo><mi>v</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mtext>Exec</mtext><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow><mo>,</mo><msub><mi>p</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>z</mi><mo>‚à£</mo><mi>x</mi><mo>,</mo><mi>v</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-298\">\\hat{y}=\\arg\\max_y \\sum_{z}, V \\big(z,\\text{OCR}(v),\\text{Exec}(\\cdot)\\big),p_\\theta(z\\mid x,v)</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-299-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4715\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4716\"><span class=\"mi\" id=\"MathJax-Span-4717\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-299\">V</script> is a verifier combining visual extraction with symbolic checks.</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Multimodal CoT</strong>: Extend textual CoT with visual grounding: first generate a rationale that references detected objects/regions, then infer the answer. Multimodal CoT by <a href=\"https://arxiv.org/abs/2302.00923\">Zhang et al. (2023)</a> (OpenReview: <a href=\"https://openreview.net/forum?id=gDlsMWost9\">https://openreview.net/forum?id=gDlsMWost9</a>) formalizes a two-stage pipeline: rationale generation followed by answer inference.</p>\n<p><strong>Tool-augmented visual reasoning</strong>: For charts, documents, and math-in-images, models benefit from OCR, table parsers, and Python execution. This effectively computes:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-299-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4715\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4716\"><span class=\"mi\" id=\"MathJax-Span-4717\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-299\">V</script> is a verifier combining visual extraction with symbolic checks.</li>\n    </ul>",
    "contentMarkdown": "*   **Multimodal CoT**: Extend textual CoT with visual grounding: first generate a rationale that references detected objects/regions, then infer the answer. Multimodal CoT by [Zhang et al. (2023)](https://arxiv.org/abs/2302.00923) (OpenReview: [https://openreview.net/forum?id=gDlsMWost9](https://openreview.net/forum?id=gDlsMWost9)) formalizes a two-stage pipeline: rationale generation followed by answer inference.\n    \n*   **Tool-augmented visual reasoning**: For charts, documents, and math-in-images, models benefit from OCR, table parsers, and Python execution. This effectively computes:\n    \n    yÃÇ¬†\\=argmaxy‚àëz,V(z,OCR(v),Exec(‚ãÖ)),pŒ∏(z‚à£x,v)y^\\=arg‚Å°maxy‚àëz,V(z,OCR(v),Exec(‚ãÖ)),pŒ∏(z‚à£x,v)\n    \n    \\\\hat{y}=\\\\arg\\\\max\\_y \\\\sum\\_{z}, V \\\\big(z,\\\\text{OCR}(v),\\\\text{Exec}(\\\\cdot)\\\\big),p\\_\\\\theta(z\\\\mid x,v)\n    *   where VVV is a verifier combining visual extraction with symbolic checks.\n\n**Multimodal CoT**: Extend textual CoT with visual grounding: first generate a rationale that references detected objects/regions, then infer the answer. Multimodal CoT by [Zhang et al. (2023)](https://arxiv.org/abs/2302.00923) (OpenReview: [https://openreview.net/forum?id=gDlsMWost9](https://openreview.net/forum?id=gDlsMWost9)) formalizes a two-stage pipeline: rationale generation followed by answer inference.\n\n**Tool-augmented visual reasoning**: For charts, documents, and math-in-images, models benefit from OCR, table parsers, and Python execution. This effectively computes:\n\n*   where VVV is a verifier combining visual extraction with symbolic checks.",
    "order": 72,
    "orderInChapter": 2,
    "difficulty": 5,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 151,
      "contentLength": 13780
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#reasoning-interfaces",
    "scrapedAt": "2025-12-28T11:54:00.657Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-evaluation-datasets-breadth-to-depth-73",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Multimodal Reasoning and Factuality",
    "title": "Evaluation Datasets (breadth to Depth)",
    "subtitle": "Multimodal Reasoning and Factuality",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>General science, images + text</strong>: ScienceQA couples images with short curricula and annotated explanations, enabling process-aware scoring; see Learn to Explain: Multimodal Reasoning via Thought Chains for ScienceQA by <a href=\"https://arxiv.org/abs/2209.09513\">Lu et al. (2022)</a> and the <a href=\"https://scienceqa.github.io/\">project page</a>. LLaVA-style visual instruction tuning reports large gains on this set.</p>\n  </li>\n  <li>\n    <p><strong>Reading text in images (OCR-centric QA)</strong>: TextVQA targets questions that depend on reading text in the scene‚Äîclassic failure mode for purely semantic vision models; see Towards VQA Models That Can Read by <a href=\"https://arxiv.org/abs/1904.08920\">Singh et al. (2019)</a> and <a href=\"https://huggingface.co/datasets/facebook/textvqa\">dataset hub</a>).</p>\n  </li>\n  <li>\n    <p><strong>Charts and data graphics</strong>: ChartQA evaluates numerical and logical reasoning over plots, where correctness hinges on faithful extraction and computation by <a href=\"https://arxiv.org/abs/2203.10244\">Masry et al. (2022)</a>. Recent extensions like ChartQA-X add stepwise explanations.</p>\n  </li>\n  <li>\n    <p><strong>Math in visual contexts</strong>: <a href=\"https://mathvista.github.io/\">MathVista</a> aggregates 28 sources and introduces new subsets (IQTest, FunctionQA, PaperQA) to probe diagram/math reasoning with images by <a href=\"https://arxiv.org/abs/2310.02255\">Lu et al. (2023)</a>. It‚Äôs a strong stress test for multimodal CoT + tools.</p>\n  </li>\n  <li>\n    <p><strong>Documents and forms (DocVQA family)</strong>: DocVQA tasks require layout-aware reasoning (reading, aligning fields, aggregating numbers); canonical overviews appear in early DocVQA work by <a href=\"https://arxiv.org/abs/2007.00398\">Mathew et al. (2021)</a> and successors (surveyed across the DocVQA track). Note: exact subsets vary; evaluation typically combines span accuracy with structure-aware metrics.</p>\n  </li>\n</ul>\n<p><strong>General science, images + text</strong>: ScienceQA couples images with short curricula and annotated explanations, enabling process-aware scoring; see Learn to Explain: Multimodal Reasoning via Thought Chains for ScienceQA by <a href=\"https://arxiv.org/abs/2209.09513\">Lu et al. (2022)</a> and the <a href=\"https://scienceqa.github.io/\">project page</a>. LLaVA-style visual instruction tuning reports large gains on this set.</p>\n<p><strong>Reading text in images (OCR-centric QA)</strong>: TextVQA targets questions that depend on reading text in the scene‚Äîclassic failure mode for purely semantic vision models; see Towards VQA Models That Can Read by <a href=\"https://arxiv.org/abs/1904.08920\">Singh et al. (2019)</a> and <a href=\"https://huggingface.co/datasets/facebook/textvqa\">dataset hub</a>).</p>\n<p><strong>Charts and data graphics</strong>: ChartQA evaluates numerical and logical reasoning over plots, where correctness hinges on faithful extraction and computation by <a href=\"https://arxiv.org/abs/2203.10244\">Masry et al. (2022)</a>. Recent extensions like ChartQA-X add stepwise explanations.</p>\n<p><strong>Math in visual contexts</strong>: <a href=\"https://mathvista.github.io/\">MathVista</a> aggregates 28 sources and introduces new subsets (IQTest, FunctionQA, PaperQA) to probe diagram/math reasoning with images by <a href=\"https://arxiv.org/abs/2310.02255\">Lu et al. (2023)</a>. It‚Äôs a strong stress test for multimodal CoT + tools.</p>\n<p><strong>Documents and forms (DocVQA family)</strong>: DocVQA tasks require layout-aware reasoning (reading, aligning fields, aggregating numbers); canonical overviews appear in early DocVQA work by <a href=\"https://arxiv.org/abs/2007.00398\">Mathew et al. (2021)</a> and successors (surveyed across the DocVQA track). Note: exact subsets vary; evaluation typically combines span accuracy with structure-aware metrics.</p>",
    "contentMarkdown": "*   **General science, images + text**: ScienceQA couples images with short curricula and annotated explanations, enabling process-aware scoring; see Learn to Explain: Multimodal Reasoning via Thought Chains for ScienceQA by [Lu et al. (2022)](https://arxiv.org/abs/2209.09513) and the [project page](https://scienceqa.github.io/). LLaVA-style visual instruction tuning reports large gains on this set.\n    \n*   **Reading text in images (OCR-centric QA)**: TextVQA targets questions that depend on reading text in the scene‚Äîclassic failure mode for purely semantic vision models; see Towards VQA Models That Can Read by [Singh et al. (2019)](https://arxiv.org/abs/1904.08920) and [dataset hub](https://huggingface.co/datasets/facebook/textvqa)).\n    \n*   **Charts and data graphics**: ChartQA evaluates numerical and logical reasoning over plots, where correctness hinges on faithful extraction and computation by [Masry et al. (2022)](https://arxiv.org/abs/2203.10244). Recent extensions like ChartQA-X add stepwise explanations.\n    \n*   **Math in visual contexts**: [MathVista](https://mathvista.github.io/) aggregates 28 sources and introduces new subsets (IQTest, FunctionQA, PaperQA) to probe diagram/math reasoning with images by [Lu et al. (2023)](https://arxiv.org/abs/2310.02255). It‚Äôs a strong stress test for multimodal CoT + tools.\n    \n*   **Documents and forms (DocVQA family)**: DocVQA tasks require layout-aware reasoning (reading, aligning fields, aggregating numbers); canonical overviews appear in early DocVQA work by [Mathew et al. (2021)](https://arxiv.org/abs/2007.00398) and successors (surveyed across the DocVQA track). Note: exact subsets vary; evaluation typically combines span accuracy with structure-aware metrics.\n    \n\n**General science, images + text**: ScienceQA couples images with short curricula and annotated explanations, enabling process-aware scoring; see Learn to Explain: Multimodal Reasoning via Thought Chains for ScienceQA by [Lu et al. (2022)](https://arxiv.org/abs/2209.09513) and the [project page](https://scienceqa.github.io/). LLaVA-style visual instruction tuning reports large gains on this set.\n\n**Reading text in images (OCR-centric QA)**: TextVQA targets questions that depend on reading text in the scene‚Äîclassic failure mode for purely semantic vision models; see Towards VQA Models That Can Read by [Singh et al. (2019)](https://arxiv.org/abs/1904.08920) and [dataset hub](https://huggingface.co/datasets/facebook/textvqa)).\n\n**Charts and data graphics**: ChartQA evaluates numerical and logical reasoning over plots, where correctness hinges on faithful extraction and computation by [Masry et al. (2022)](https://arxiv.org/abs/2203.10244). Recent extensions like ChartQA-X add stepwise explanations.\n\n**Math in visual contexts**: [MathVista](https://mathvista.github.io/) aggregates 28 sources and introduces new subsets (IQTest, FunctionQA, PaperQA) to probe diagram/math reasoning with images by [Lu et al. (2023)](https://arxiv.org/abs/2310.02255). It‚Äôs a strong stress test for multimodal CoT + tools.\n\n**Documents and forms (DocVQA family)**: DocVQA tasks require layout-aware reasoning (reading, aligning fields, aggregating numbers); canonical overviews appear in early DocVQA work by [Mathew et al. (2021)](https://arxiv.org/abs/2007.00398) and successors (surveyed across the DocVQA track). Note: exact subsets vary; evaluation typically combines span accuracy with structure-aware metrics.",
    "order": 73,
    "orderInChapter": 3,
    "difficulty": 4,
    "estimatedMinutes": 3,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 405,
      "contentLength": 3895
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#evaluation-datasets-(breadth-to-depth)",
    "scrapedAt": "2025-12-28T11:54:00.658Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-multimodal-factuality-common-failure-modes-and-che-74",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Multimodal Reasoning and Factuality",
    "title": "Multimodal Factuality: Common Failure Modes and Checks",
    "subtitle": "Multimodal Reasoning and Factuality",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Hallucinated perception</strong>: Models assert objects/text that are not present. Mitigation: require OCR/string citations from the image (evidence-required prompting) and penalize unsupported claims in the rationale.</p>\n  </li>\n  <li>\n    <p><strong>Numeracy and unit grounding</strong>: Chart/diagram answers drift when units or scales are misread. Mitigation: explicit extraction‚Äìcompute pipelines (ChartQA/MathVista style) and execution-based verification.</p>\n  </li>\n  <li>\n    <p><strong>Visual‚Äìtext consistency</strong>: Rationales must cite specific regions or tokens; require a verifier that re-reads the referenced region or re-parses the figure. ScienceQA‚Äôs annotated explanations are useful here.</p>\n  </li>\n  <li>\n    <p><strong>Robustness to rendering/quality</strong>: Performance can collapse under low-resolution, skewed scans, or font variations‚Äîespecially for OCR-heavy tasks (TextVQA, DocVQA). Reporting should include perturbation tests and confidence‚Äìaccuracy calibration.</p>\n  </li>\n</ul>\n<p><strong>Hallucinated perception</strong>: Models assert objects/text that are not present. Mitigation: require OCR/string citations from the image (evidence-required prompting) and penalize unsupported claims in the rationale.</p>\n<p><strong>Numeracy and unit grounding</strong>: Chart/diagram answers drift when units or scales are misread. Mitigation: explicit extraction‚Äìcompute pipelines (ChartQA/MathVista style) and execution-based verification.</p>\n<p><strong>Visual‚Äìtext consistency</strong>: Rationales must cite specific regions or tokens; require a verifier that re-reads the referenced region or re-parses the figure. ScienceQA‚Äôs annotated explanations are useful here.</p>\n<p><strong>Robustness to rendering/quality</strong>: Performance can collapse under low-resolution, skewed scans, or font variations‚Äîespecially for OCR-heavy tasks (TextVQA, DocVQA). Reporting should include perturbation tests and confidence‚Äìaccuracy calibration.</p>",
    "contentMarkdown": "*   **Hallucinated perception**: Models assert objects/text that are not present. Mitigation: require OCR/string citations from the image (evidence-required prompting) and penalize unsupported claims in the rationale.\n    \n*   **Numeracy and unit grounding**: Chart/diagram answers drift when units or scales are misread. Mitigation: explicit extraction‚Äìcompute pipelines (ChartQA/MathVista style) and execution-based verification.\n    \n*   **Visual‚Äìtext consistency**: Rationales must cite specific regions or tokens; require a verifier that re-reads the referenced region or re-parses the figure. ScienceQA‚Äôs annotated explanations are useful here.\n    \n*   **Robustness to rendering/quality**: Performance can collapse under low-resolution, skewed scans, or font variations‚Äîespecially for OCR-heavy tasks (TextVQA, DocVQA). Reporting should include perturbation tests and confidence‚Äìaccuracy calibration.\n    \n\n**Hallucinated perception**: Models assert objects/text that are not present. Mitigation: require OCR/string citations from the image (evidence-required prompting) and penalize unsupported claims in the rationale.\n\n**Numeracy and unit grounding**: Chart/diagram answers drift when units or scales are misread. Mitigation: explicit extraction‚Äìcompute pipelines (ChartQA/MathVista style) and execution-based verification.\n\n**Visual‚Äìtext consistency**: Rationales must cite specific regions or tokens; require a verifier that re-reads the referenced region or re-parses the figure. ScienceQA‚Äôs annotated explanations are useful here.\n\n**Robustness to rendering/quality**: Performance can collapse under low-resolution, skewed scans, or font variations‚Äîespecially for OCR-heavy tasks (TextVQA, DocVQA). Reporting should include perturbation tests and confidence‚Äìaccuracy calibration.",
    "order": 74,
    "orderInChapter": 4,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 204,
      "contentLength": 2000
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#multimodal-factuality:-common-failure-modes-and-checks",
    "scrapedAt": "2025-12-28T11:54:00.658Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-takeaways-75",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Multimodal Reasoning and Factuality",
    "title": "Takeaways",
    "subtitle": "Multimodal Reasoning and Factuality",
    "contentHtml": "<ul>\n  <li>Multimodal reasoning benefits most from explicit grounding and tools: CoT alone is often insufficient when numbers or text must be read from images.</li>\n  <li>Evaluation should pair outcome accuracy with process fidelity: require models to show which pixels/strings support each step and verify with OCR/symbolic checks.</li>\n  <li>Benchmarks like ScienceQA, TextVQA, ChartQA, and MathVista collectively surface perception, grounding, and computation‚Äîthree pillars of multimodal factuality.</li>\n</ul>",
    "contentMarkdown": "*   Multimodal reasoning benefits most from explicit grounding and tools: CoT alone is often insufficient when numbers or text must be read from images.\n*   Evaluation should pair outcome accuracy with process fidelity: require models to show which pixels/strings support each step and verify with OCR/symbolic checks.\n*   Benchmarks like ScienceQA, TextVQA, ChartQA, and MathVista collectively surface perception, grounding, and computation‚Äîthree pillars of multimodal factuality.",
    "order": 75,
    "orderInChapter": 5,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 65,
      "contentLength": 513
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#takeaways",
    "scrapedAt": "2025-12-28T11:54:00.658Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-taxonomy-of-reasoning-datasets-76",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Summary of Reasoning Evaluation Datasets and Their Interrelations",
    "title": "Taxonomy of Reasoning Datasets",
    "subtitle": "Summary of Reasoning Evaluation Datasets and Their Interrelations",
    "contentHtml": "<ul>\n  <li>\n    <p>We can group reasoning benchmarks along <strong>two orthogonal axes</strong>:</p>\n\n    <ol>\n      <li><strong>Reasoning type</strong>: arithmetic, symbolic, causal, commonsense, multimodal, etc.</li>\n      <li><strong>Evaluation focus</strong>: process vs. outcome, factual vs. abstract, single vs. multi-modal input</li>\n    </ol>\n  </li>\n  <li>\n    <p>The resulting taxonomy looks as follows:</p>\n  </li>\n</ul>\n<p>We can group reasoning benchmarks along <strong>two orthogonal axes</strong>:</p>\n<ol>\n      <li><strong>Reasoning type</strong>: arithmetic, symbolic, causal, commonsense, multimodal, etc.</li>\n      <li><strong>Evaluation focus</strong>: process vs. outcome, factual vs. abstract, single vs. multi-modal input</li>\n    </ol>\n<p>The resulting taxonomy looks as follows:</p>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Tier</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Dataset</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Domain</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reasoning Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Input Modality</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Eval Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Process Evaluation</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Level</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">1</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2110.14168\">GSM8K</a> (Cobbe et al. (2021))</td>\n<td class=\"tg-tleft-valign-first\">Arithmetic</td>\n<td class=\"tg-tleft-valign-first\">Quantitative, multi-step</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Exact Match, verifier</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\">Grade-school</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">2</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2103.03874\">MATH</a> (Hendrycks et al. (2021))</td>\n<td class=\"tg-tleft-valign-first\">Algebraic, symbolic</td>\n<td class=\"tg-tleft-valign-first\">Formal derivation</td>\n<td class=\"tg-tleft-valign-first\">Text, LaTeX</td>\n<td class=\"tg-tleft-valign-first\">Symbolic equivalence</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\">High school‚Äìcollege</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">3</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://cdn.openai.com/papers/gpt-4-system-card.pdf\">AIME</a> (OpenAI (2023)); <a href=\"https://arxiv.org/abs/2501.12948\">Guo et al. (2025)</a></td>\n<td class=\"tg-tleft-valign-first\">Olympiad math</td>\n<td class=\"tg-tleft-valign-first\">Logical synthesis</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Numeric EM</td>\n<td class=\"tg-tleft-valign-first\">Partial (trace)</td>\n<td class=\"tg-tleft-valign-second\">Olympiad</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">4</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2109.00128\">IMO / MiniF2F</a> (Zheng et al. (2021))</td>\n<td class=\"tg-tleft-valign-first\">Formal math</td>\n<td class=\"tg-tleft-valign-first\">Proof reasoning</td>\n<td class=\"tg-tleft-valign-first\">Text + Formal</td>\n<td class=\"tg-tleft-valign-first\">Theorem check</td>\n<td class=\"tg-tleft-valign-first\">Full</td>\n<td class=\"tg-tleft-valign-second\">Olympiad/formal</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">5</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/1903.00161\">DROP</a> (Dua et al. (2019))</td>\n<td class=\"tg-tleft-valign-first\">Reading + arithmetic</td>\n<td class=\"tg-tleft-valign-first\">Discrete reasoning</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">EM, F1</td>\n<td class=\"tg-tleft-valign-first\">Optional</td>\n<td class=\"tg-tleft-valign-second\">Middle/high school</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">6</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/1803.05457\">ARC-AGI-1</a> (Clark et al. (2018))</td>\n<td class=\"tg-tleft-valign-first\">Science QA</td>\n<td class=\"tg-tleft-valign-first\">Causal/multi-hop</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy</td>\n<td class=\"tg-tleft-valign-first\">Partial</td>\n<td class=\"tg-tleft-valign-second\">K‚Äì12</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">7</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2308.01405\">ARC-AGI-2</a> (Clark et al. (2023))</td>\n<td class=\"tg-tleft-valign-first\">Abstract reasoning</td>\n<td class=\"tg-tleft-valign-first\">Symbolic induction</td>\n<td class=\"tg-tleft-valign-first\">Grid images</td>\n<td class=\"tg-tleft-valign-first\">Task accuracy</td>\n<td class=\"tg-tleft-valign-first\">Implicit</td>\n<td class=\"tg-tleft-valign-second\">AGI-level abstraction</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">8</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2206.04615\">BIG-bench</a> (Srivastava et al. (2022))</td>\n<td class=\"tg-tleft-valign-first\">Multi-domain</td>\n<td class=\"tg-tleft-valign-first\">Logical, analogical, commonsense</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy</td>\n<td class=\"tg-tleft-valign-first\">Limited</td>\n<td class=\"tg-tleft-valign-second\">General</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">9</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2210.09261\">BIG-bench Hard</a> (Suzgun et al. (2022))</td>\n<td class=\"tg-tleft-valign-first\">Subset (hard tasks)</td>\n<td class=\"tg-tleft-valign-first\">Symbolic logic</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy</td>\n<td class=\"tg-tleft-valign-first\">Some</td>\n<td class=\"tg-tleft-valign-second\">Emergent reasoning</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">10</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2009.03300\">MMLU</a> (Hendrycks et al. (2020))</td>\n<td class=\"tg-tleft-valign-first\">Academic exams</td>\n<td class=\"tg-tleft-valign-first\">Knowledge recall</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy</td>\n<td class=\"tg-tleft-valign-first\">No</td>\n<td class=\"tg-tleft-valign-second\">Factual</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">11</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2304.06364\">AGIEval</a> (Zhong et al. (2023))</td>\n<td class=\"tg-tleft-valign-first\">Human exams</td>\n<td class=\"tg-tleft-valign-first\">Deductive, linguistic, numerical</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy</td>\n<td class=\"tg-tleft-valign-first\">Some</td>\n<td class=\"tg-tleft-valign-second\">Reasoning-heavy</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">12</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2211.09110\">HELM</a> (Liang et al. (2022))</td>\n<td class=\"tg-tleft-valign-first\">Multi-domain</td>\n<td class=\"tg-tleft-valign-first\">Holistic reasoning + factuality</td>\n<td class=\"tg-tleft-valign-first\">Mixed</td>\n<td class=\"tg-tleft-valign-first\">Multi-metric (12 metrics)</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\">Meta-eval</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">13</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2209.09513\">ScienceQA</a> (Lu et al. (2022))</td>\n<td class=\"tg-tleft-valign-first\">Visual science</td>\n<td class=\"tg-tleft-valign-first\">Multimodal + causal</td>\n<td class=\"tg-tleft-valign-first\">Image + text</td>\n<td class=\"tg-tleft-valign-first\">EM, rationale F1</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\">Multimodal reasoning</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">14</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2203.10244\">ChartQA</a> (Masry et al. (2022))</td>\n<td class=\"tg-tleft-valign-first\">Charts and graphs</td>\n<td class=\"tg-tleft-valign-first\">Quantitative visual reasoning</td>\n<td class=\"tg-tleft-valign-first\">Image + text</td>\n<td class=\"tg-tleft-valign-first\">EM</td>\n<td class=\"tg-tleft-valign-first\">Partial</td>\n<td class=\"tg-tleft-valign-second\">Multimodal numeric</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">15</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2310.02255\">MathVista</a> (Lu et al. (2023))</td>\n<td class=\"tg-tleft-valign-first\">Diagram math</td>\n<td class=\"tg-tleft-valign-first\">Symbolic visual</td>\n<td class=\"tg-tleft-valign-first\">Image + text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy, process check</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\">Multimodal symbolic</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">16</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/1904.08920\">TextVQA</a> (Singh et al. (2019))</td>\n<td class=\"tg-tleft-valign-first\">OCR-based QA</td>\n<td class=\"tg-tleft-valign-first\">Perceptual reasoning</td>\n<td class=\"tg-tleft-valign-first\">Image</td>\n<td class=\"tg-tleft-valign-first\">Accuracy</td>\n<td class=\"tg-tleft-valign-first\">No</td>\n<td class=\"tg-tleft-valign-second\">Visual perception</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">17</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/1803.05355\">FEVER</a> (Thorne et al. (2018))</td>\n<td class=\"tg-tleft-valign-first\">Fact verification</td>\n<td class=\"tg-tleft-valign-first\">Factual consistency</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy, entailment</td>\n<td class=\"tg-tleft-valign-first\">No</td>\n<td class=\"tg-tleft-valign-second\">Factual verification</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">18</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2004.14974\">SciFact</a> (Wadden et al. (2020))</td>\n<td class=\"tg-tleft-valign-first\">Science claims</td>\n<td class=\"tg-tleft-valign-first\">Factual + causal</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy, entailment</td>\n<td class=\"tg-tleft-valign-first\">Some</td>\n<td class=\"tg-tleft-valign-second\">Research reasoning</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Tier</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Dataset</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Domain</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reasoning Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Input Modality</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Eval Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Process Evaluation</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Level</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">1</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2110.14168\">GSM8K</a> (Cobbe et al. (2021))</td>\n<td class=\"tg-tleft-valign-first\">Arithmetic</td>\n<td class=\"tg-tleft-valign-first\">Quantitative, multi-step</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Exact Match, verifier</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\">Grade-school</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">2</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2103.03874\">MATH</a> (Hendrycks et al. (2021))</td>\n<td class=\"tg-tleft-valign-first\">Algebraic, symbolic</td>\n<td class=\"tg-tleft-valign-first\">Formal derivation</td>\n<td class=\"tg-tleft-valign-first\">Text, LaTeX</td>\n<td class=\"tg-tleft-valign-first\">Symbolic equivalence</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\">High school‚Äìcollege</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">3</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://cdn.openai.com/papers/gpt-4-system-card.pdf\">AIME</a> (OpenAI (2023)); <a href=\"https://arxiv.org/abs/2501.12948\">Guo et al. (2025)</a></td>\n<td class=\"tg-tleft-valign-first\">Olympiad math</td>\n<td class=\"tg-tleft-valign-first\">Logical synthesis</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Numeric EM</td>\n<td class=\"tg-tleft-valign-first\">Partial (trace)</td>\n<td class=\"tg-tleft-valign-second\">Olympiad</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">4</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2109.00128\">IMO / MiniF2F</a> (Zheng et al. (2021))</td>\n<td class=\"tg-tleft-valign-first\">Formal math</td>\n<td class=\"tg-tleft-valign-first\">Proof reasoning</td>\n<td class=\"tg-tleft-valign-first\">Text + Formal</td>\n<td class=\"tg-tleft-valign-first\">Theorem check</td>\n<td class=\"tg-tleft-valign-first\">Full</td>\n<td class=\"tg-tleft-valign-second\">Olympiad/formal</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">5</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/1903.00161\">DROP</a> (Dua et al. (2019))</td>\n<td class=\"tg-tleft-valign-first\">Reading + arithmetic</td>\n<td class=\"tg-tleft-valign-first\">Discrete reasoning</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">EM, F1</td>\n<td class=\"tg-tleft-valign-first\">Optional</td>\n<td class=\"tg-tleft-valign-second\">Middle/high school</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">6</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/1803.05457\">ARC-AGI-1</a> (Clark et al. (2018))</td>\n<td class=\"tg-tleft-valign-first\">Science QA</td>\n<td class=\"tg-tleft-valign-first\">Causal/multi-hop</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy</td>\n<td class=\"tg-tleft-valign-first\">Partial</td>\n<td class=\"tg-tleft-valign-second\">K‚Äì12</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">7</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2308.01405\">ARC-AGI-2</a> (Clark et al. (2023))</td>\n<td class=\"tg-tleft-valign-first\">Abstract reasoning</td>\n<td class=\"tg-tleft-valign-first\">Symbolic induction</td>\n<td class=\"tg-tleft-valign-first\">Grid images</td>\n<td class=\"tg-tleft-valign-first\">Task accuracy</td>\n<td class=\"tg-tleft-valign-first\">Implicit</td>\n<td class=\"tg-tleft-valign-second\">AGI-level abstraction</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">8</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2206.04615\">BIG-bench</a> (Srivastava et al. (2022))</td>\n<td class=\"tg-tleft-valign-first\">Multi-domain</td>\n<td class=\"tg-tleft-valign-first\">Logical, analogical, commonsense</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy</td>\n<td class=\"tg-tleft-valign-first\">Limited</td>\n<td class=\"tg-tleft-valign-second\">General</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">9</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2210.09261\">BIG-bench Hard</a> (Suzgun et al. (2022))</td>\n<td class=\"tg-tleft-valign-first\">Subset (hard tasks)</td>\n<td class=\"tg-tleft-valign-first\">Symbolic logic</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy</td>\n<td class=\"tg-tleft-valign-first\">Some</td>\n<td class=\"tg-tleft-valign-second\">Emergent reasoning</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">10</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2009.03300\">MMLU</a> (Hendrycks et al. (2020))</td>\n<td class=\"tg-tleft-valign-first\">Academic exams</td>\n<td class=\"tg-tleft-valign-first\">Knowledge recall</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy</td>\n<td class=\"tg-tleft-valign-first\">No</td>\n<td class=\"tg-tleft-valign-second\">Factual</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">11</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2304.06364\">AGIEval</a> (Zhong et al. (2023))</td>\n<td class=\"tg-tleft-valign-first\">Human exams</td>\n<td class=\"tg-tleft-valign-first\">Deductive, linguistic, numerical</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy</td>\n<td class=\"tg-tleft-valign-first\">Some</td>\n<td class=\"tg-tleft-valign-second\">Reasoning-heavy</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">12</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2211.09110\">HELM</a> (Liang et al. (2022))</td>\n<td class=\"tg-tleft-valign-first\">Multi-domain</td>\n<td class=\"tg-tleft-valign-first\">Holistic reasoning + factuality</td>\n<td class=\"tg-tleft-valign-first\">Mixed</td>\n<td class=\"tg-tleft-valign-first\">Multi-metric (12 metrics)</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\">Meta-eval</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">13</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2209.09513\">ScienceQA</a> (Lu et al. (2022))</td>\n<td class=\"tg-tleft-valign-first\">Visual science</td>\n<td class=\"tg-tleft-valign-first\">Multimodal + causal</td>\n<td class=\"tg-tleft-valign-first\">Image + text</td>\n<td class=\"tg-tleft-valign-first\">EM, rationale F1</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\">Multimodal reasoning</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">14</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2203.10244\">ChartQA</a> (Masry et al. (2022))</td>\n<td class=\"tg-tleft-valign-first\">Charts and graphs</td>\n<td class=\"tg-tleft-valign-first\">Quantitative visual reasoning</td>\n<td class=\"tg-tleft-valign-first\">Image + text</td>\n<td class=\"tg-tleft-valign-first\">EM</td>\n<td class=\"tg-tleft-valign-first\">Partial</td>\n<td class=\"tg-tleft-valign-second\">Multimodal numeric</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">15</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2310.02255\">MathVista</a> (Lu et al. (2023))</td>\n<td class=\"tg-tleft-valign-first\">Diagram math</td>\n<td class=\"tg-tleft-valign-first\">Symbolic visual</td>\n<td class=\"tg-tleft-valign-first\">Image + text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy, process check</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\">Multimodal symbolic</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">16</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/1904.08920\">TextVQA</a> (Singh et al. (2019))</td>\n<td class=\"tg-tleft-valign-first\">OCR-based QA</td>\n<td class=\"tg-tleft-valign-first\">Perceptual reasoning</td>\n<td class=\"tg-tleft-valign-first\">Image</td>\n<td class=\"tg-tleft-valign-first\">Accuracy</td>\n<td class=\"tg-tleft-valign-first\">No</td>\n<td class=\"tg-tleft-valign-second\">Visual perception</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">17</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/1803.05355\">FEVER</a> (Thorne et al. (2018))</td>\n<td class=\"tg-tleft-valign-first\">Fact verification</td>\n<td class=\"tg-tleft-valign-first\">Factual consistency</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy, entailment</td>\n<td class=\"tg-tleft-valign-first\">No</td>\n<td class=\"tg-tleft-valign-second\">Factual verification</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">18</td>\n<td class=\"tg-tleft-valign-first\"><a href=\"https://arxiv.org/abs/2004.14974\">SciFact</a> (Wadden et al. (2020))</td>\n<td class=\"tg-tleft-valign-first\">Science claims</td>\n<td class=\"tg-tleft-valign-first\">Factual + causal</td>\n<td class=\"tg-tleft-valign-first\">Text</td>\n<td class=\"tg-tleft-valign-first\">Accuracy, entailment</td>\n<td class=\"tg-tleft-valign-first\">Some</td>\n<td class=\"tg-tleft-valign-second\">Research reasoning</td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "*   We can group reasoning benchmarks along **two orthogonal axes**:\n    \n    1.  **Reasoning type**: arithmetic, symbolic, causal, commonsense, multimodal, etc.\n    2.  **Evaluation focus**: process vs. outcome, factual vs. abstract, single vs. multi-modal input\n*   The resulting taxonomy looks as follows:\n    \n\nWe can group reasoning benchmarks along **two orthogonal axes**:\n\n1.  **Reasoning type**: arithmetic, symbolic, causal, commonsense, multimodal, etc.\n2.  **Evaluation focus**: process vs. outcome, factual vs. abstract, single vs. multi-modal input\n\nThe resulting taxonomy looks as follows:\n\n**Tier**\n\n**Dataset**\n\n**Domain**\n\n**Reasoning Type**\n\n**Input Modality**\n\n**Eval Type**\n\n**Process Evaluation**\n\n**Level**\n\n1\n\n[GSM8K](https://arxiv.org/abs/2110.14168) (Cobbe et al. (2021))\n\nArithmetic\n\nQuantitative, multi-step\n\nText\n\nExact Match, verifier\n\nYes\n\nGrade-school\n\n2\n\n[MATH](https://arxiv.org/abs/2103.03874) (Hendrycks et al. (2021))\n\nAlgebraic, symbolic\n\nFormal derivation\n\nText, LaTeX\n\nSymbolic equivalence\n\nYes\n\nHigh school‚Äìcollege\n\n3\n\n[AIME](https://cdn.openai.com/papers/gpt-4-system-card.pdf) (OpenAI (2023)); [Guo et al. (2025)](https://arxiv.org/abs/2501.12948)\n\nOlympiad math\n\nLogical synthesis\n\nText\n\nNumeric EM\n\nPartial (trace)\n\nOlympiad\n\n4\n\n[IMO / MiniF2F](https://arxiv.org/abs/2109.00128) (Zheng et al. (2021))\n\nFormal math\n\nProof reasoning\n\nText + Formal\n\nTheorem check\n\nFull\n\nOlympiad/formal\n\n5\n\n[DROP](https://arxiv.org/abs/1903.00161) (Dua et al. (2019))\n\nReading + arithmetic\n\nDiscrete reasoning\n\nText\n\nEM, F1\n\nOptional\n\nMiddle/high school\n\n6\n\n[ARC-AGI-1](https://arxiv.org/abs/1803.05457) (Clark et al. (2018))\n\nScience QA\n\nCausal/multi-hop\n\nText\n\nAccuracy\n\nPartial\n\nK‚Äì12\n\n7\n\n[ARC-AGI-2](https://arxiv.org/abs/2308.01405) (Clark et al. (2023))\n\nAbstract reasoning\n\nSymbolic induction\n\nGrid images\n\nTask accuracy\n\nImplicit\n\nAGI-level abstraction\n\n8\n\n[BIG-bench](https://arxiv.org/abs/2206.04615) (Srivastava et al. (2022))\n\nMulti-domain\n\nLogical, analogical, commonsense\n\nText\n\nAccuracy\n\nLimited\n\nGeneral\n\n9\n\n[BIG-bench Hard](https://arxiv.org/abs/2210.09261) (Suzgun et al. (2022))\n\nSubset (hard tasks)\n\nSymbolic logic\n\nText\n\nAccuracy\n\nSome\n\nEmergent reasoning\n\n10\n\n[MMLU](https://arxiv.org/abs/2009.03300) (Hendrycks et al. (2020))\n\nAcademic exams\n\nKnowledge recall\n\nText\n\nAccuracy\n\nNo\n\nFactual\n\n11\n\n[AGIEval](https://arxiv.org/abs/2304.06364) (Zhong et al. (2023))\n\nHuman exams\n\nDeductive, linguistic, numerical\n\nText\n\nAccuracy\n\nSome\n\nReasoning-heavy\n\n12\n\n[HELM](https://arxiv.org/abs/2211.09110) (Liang et al. (2022))\n\nMulti-domain\n\nHolistic reasoning + factuality\n\nMixed\n\nMulti-metric (12 metrics)\n\nYes\n\nMeta-eval\n\n13\n\n[ScienceQA](https://arxiv.org/abs/2209.09513) (Lu et al. (2022))\n\nVisual science\n\nMultimodal + causal\n\nImage + text\n\nEM, rationale F1\n\nYes\n\nMultimodal reasoning\n\n14\n\n[ChartQA](https://arxiv.org/abs/2203.10244) (Masry et al. (2022))\n\nCharts and graphs\n\nQuantitative visual reasoning\n\nImage + text\n\nEM\n\nPartial\n\nMultimodal numeric\n\n15\n\n[MathVista](https://arxiv.org/abs/2310.02255) (Lu et al. (2023))\n\nDiagram math\n\nSymbolic visual\n\nImage + text\n\nAccuracy, process check\n\nYes\n\nMultimodal symbolic\n\n16\n\n[TextVQA](https://arxiv.org/abs/1904.08920) (Singh et al. (2019))\n\nOCR-based QA\n\nPerceptual reasoning\n\nImage\n\nAccuracy\n\nNo\n\nVisual perception\n\n17\n\n[FEVER](https://arxiv.org/abs/1803.05355) (Thorne et al. (2018))\n\nFact verification\n\nFactual consistency\n\nText\n\nAccuracy, entailment\n\nNo\n\nFactual verification\n\n18\n\n[SciFact](https://arxiv.org/abs/2004.14974) (Wadden et al. (2020))\n\nScience claims\n\nFactual + causal\n\nText\n\nAccuracy, entailment\n\nSome\n\nResearch reasoning\n\n**Tier**\n\n**Dataset**\n\n**Domain**\n\n**Reasoning Type**\n\n**Input Modality**\n\n**Eval Type**\n\n**Process Evaluation**\n\n**Level**\n\n1\n\n[GSM8K](https://arxiv.org/abs/2110.14168) (Cobbe et al. (2021))\n\nArithmetic\n\nQuantitative, multi-step\n\nText\n\nExact Match, verifier\n\nYes\n\nGrade-school\n\n2\n\n[MATH](https://arxiv.org/abs/2103.03874) (Hendrycks et al. (2021))\n\nAlgebraic, symbolic\n\nFormal derivation\n\nText, LaTeX\n\nSymbolic equivalence\n\nYes\n\nHigh school‚Äìcollege\n\n3\n\n[AIME](https://cdn.openai.com/papers/gpt-4-system-card.pdf) (OpenAI (2023)); [Guo et al. (2025)](https://arxiv.org/abs/2501.12948)\n\nOlympiad math\n\nLogical synthesis\n\nText\n\nNumeric EM\n\nPartial (trace)\n\nOlympiad\n\n4\n\n[IMO / MiniF2F](https://arxiv.org/abs/2109.00128) (Zheng et al. (2021))\n\nFormal math\n\nProof reasoning\n\nText + Formal\n\nTheorem check\n\nFull\n\nOlympiad/formal\n\n5\n\n[DROP](https://arxiv.org/abs/1903.00161) (Dua et al. (2019))\n\nReading + arithmetic\n\nDiscrete reasoning\n\nText\n\nEM, F1\n\nOptional\n\nMiddle/high school\n\n6\n\n[ARC-AGI-1](https://arxiv.org/abs/1803.05457) (Clark et al. (2018))\n\nScience QA\n\nCausal/multi-hop\n\nText\n\nAccuracy\n\nPartial\n\nK‚Äì12\n\n7\n\n[ARC-AGI-2](https://arxiv.org/abs/2308.01405) (Clark et al. (2023))\n\nAbstract reasoning\n\nSymbolic induction\n\nGrid images\n\nTask accuracy\n\nImplicit\n\nAGI-level abstraction\n\n8\n\n[BIG-bench](https://arxiv.org/abs/2206.04615) (Srivastava et al. (2022))\n\nMulti-domain\n\nLogical, analogical, commonsense\n\nText\n\nAccuracy\n\nLimited\n\nGeneral\n\n9\n\n[BIG-bench Hard](https://arxiv.org/abs/2210.09261) (Suzgun et al. (2022))\n\nSubset (hard tasks)\n\nSymbolic logic\n\nText\n\nAccuracy\n\nSome\n\nEmergent reasoning\n\n10\n\n[MMLU](https://arxiv.org/abs/2009.03300) (Hendrycks et al. (2020))\n\nAcademic exams\n\nKnowledge recall\n\nText\n\nAccuracy\n\nNo\n\nFactual\n\n11\n\n[AGIEval](https://arxiv.org/abs/2304.06364) (Zhong et al. (2023))\n\nHuman exams\n\nDeductive, linguistic, numerical\n\nText\n\nAccuracy\n\nSome\n\nReasoning-heavy\n\n12\n\n[HELM](https://arxiv.org/abs/2211.09110) (Liang et al. (2022))\n\nMulti-domain\n\nHolistic reasoning + factuality\n\nMixed\n\nMulti-metric (12 metrics)\n\nYes\n\nMeta-eval\n\n13\n\n[ScienceQA](https://arxiv.org/abs/2209.09513) (Lu et al. (2022))\n\nVisual science\n\nMultimodal + causal\n\nImage + text\n\nEM, rationale F1\n\nYes\n\nMultimodal reasoning\n\n14\n\n[ChartQA](https://arxiv.org/abs/2203.10244) (Masry et al. (2022))\n\nCharts and graphs\n\nQuantitative visual reasoning\n\nImage + text\n\nEM\n\nPartial\n\nMultimodal numeric\n\n15\n\n[MathVista](https://arxiv.org/abs/2310.02255) (Lu et al. (2023))\n\nDiagram math\n\nSymbolic visual\n\nImage + text\n\nAccuracy, process check\n\nYes\n\nMultimodal symbolic\n\n16\n\n[TextVQA](https://arxiv.org/abs/1904.08920) (Singh et al. (2019))\n\nOCR-based QA\n\nPerceptual reasoning\n\nImage\n\nAccuracy\n\nNo\n\nVisual perception\n\n17\n\n[FEVER](https://arxiv.org/abs/1803.05355) (Thorne et al. (2018))\n\nFact verification\n\nFactual consistency\n\nText\n\nAccuracy, entailment\n\nNo\n\nFactual verification\n\n18\n\n[SciFact](https://arxiv.org/abs/2004.14974) (Wadden et al. (2020))\n\nScience claims\n\nFactual + causal\n\nText\n\nAccuracy, entailment\n\nSome\n\nResearch reasoning",
    "order": 76,
    "orderInChapter": 1,
    "difficulty": 5,
    "estimatedMinutes": 4,
    "tags": [
      "nlpllms",
      "gpt"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 698,
      "contentLength": 19677
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#taxonomy-of-reasoning-datasets",
    "scrapedAt": "2025-12-28T11:54:00.658Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-conceptual-clusters-77",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Summary of Reasoning Evaluation Datasets and Their Interrelations",
    "title": "Conceptual Clusters",
    "subtitle": "Summary of Reasoning Evaluation Datasets and Their Interrelations",
    "contentHtml": "<ul>\n  <li>\n    <p>Reasoning datasets cluster naturally into <strong>five meta-domains</strong>:</p>\n\n    <ol>\n      <li>\n        <p><strong>Quantitative reasoning</strong>: GSM8K, MATH, AIME, IMO, DROP, NumGLUE.</p>\n\n        <ul>\n          <li>Evaluates symbolic arithmetic and algebraic reasoning.</li>\n          <li>Process-verifiable with numeric or symbolic solvers.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Causal and commonsense reasoning</strong>: ARC, ScienceQA, ATOMIC, AGIEval.</p>\n\n        <ul>\n          <li>Tests everyday and scientific causal inference.</li>\n          <li>Often factual but requires multi-hop logic.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Abstract and algorithmic reasoning</strong>: ARC-AGI-2, BIG-bench Hard.</p>\n\n        <ul>\n          <li>Measures rule discovery and compositional generalization.</li>\n          <li>Evaluates systematic reasoning beyond retrieval.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Multimodal reasoning</strong>: ScienceQA, ChartQA, MathVista, TextVQA.</p>\n\n        <ul>\n          <li>Combines perception with reasoning over visual/text inputs.</li>\n          <li>Central for factual grounding and cross-modal coherence.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Factual reasoning and calibration</strong>: MMLU, HELM, FEVER, SciFact.</p>\n\n        <ul>\n          <li>Tests whether reasoning aligns with external truth.</li>\n          <li>Important for assessing faithfulness and factual grounding.</li>\n        </ul>\n      </li>\n    </ol>\n  </li>\n</ul>\n<p>Reasoning datasets cluster naturally into <strong>five meta-domains</strong>:</p>\n<ol>\n      <li>\n        <p><strong>Quantitative reasoning</strong>: GSM8K, MATH, AIME, IMO, DROP, NumGLUE.</p>\n\n        <ul>\n          <li>Evaluates symbolic arithmetic and algebraic reasoning.</li>\n          <li>Process-verifiable with numeric or symbolic solvers.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Causal and commonsense reasoning</strong>: ARC, ScienceQA, ATOMIC, AGIEval.</p>\n\n        <ul>\n          <li>Tests everyday and scientific causal inference.</li>\n          <li>Often factual but requires multi-hop logic.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Abstract and algorithmic reasoning</strong>: ARC-AGI-2, BIG-bench Hard.</p>\n\n        <ul>\n          <li>Measures rule discovery and compositional generalization.</li>\n          <li>Evaluates systematic reasoning beyond retrieval.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Multimodal reasoning</strong>: ScienceQA, ChartQA, MathVista, TextVQA.</p>\n\n        <ul>\n          <li>Combines perception with reasoning over visual/text inputs.</li>\n          <li>Central for factual grounding and cross-modal coherence.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Factual reasoning and calibration</strong>: MMLU, HELM, FEVER, SciFact.</p>\n\n        <ul>\n          <li>Tests whether reasoning aligns with external truth.</li>\n          <li>Important for assessing faithfulness and factual grounding.</li>\n        </ul>\n      </li>\n    </ol>\n<p><strong>Quantitative reasoning</strong>: GSM8K, MATH, AIME, IMO, DROP, NumGLUE.</p>\n<ul>\n          <li>Evaluates symbolic arithmetic and algebraic reasoning.</li>\n          <li>Process-verifiable with numeric or symbolic solvers.</li>\n        </ul>\n<p><strong>Causal and commonsense reasoning</strong>: ARC, ScienceQA, ATOMIC, AGIEval.</p>\n<ul>\n          <li>Tests everyday and scientific causal inference.</li>\n          <li>Often factual but requires multi-hop logic.</li>\n        </ul>\n<p><strong>Abstract and algorithmic reasoning</strong>: ARC-AGI-2, BIG-bench Hard.</p>\n<ul>\n          <li>Measures rule discovery and compositional generalization.</li>\n          <li>Evaluates systematic reasoning beyond retrieval.</li>\n        </ul>\n<p><strong>Multimodal reasoning</strong>: ScienceQA, ChartQA, MathVista, TextVQA.</p>\n<ul>\n          <li>Combines perception with reasoning over visual/text inputs.</li>\n          <li>Central for factual grounding and cross-modal coherence.</li>\n        </ul>\n<p><strong>Factual reasoning and calibration</strong>: MMLU, HELM, FEVER, SciFact.</p>\n<ul>\n          <li>Tests whether reasoning aligns with external truth.</li>\n          <li>Important for assessing faithfulness and factual grounding.</li>\n        </ul>",
    "contentMarkdown": "*   Reasoning datasets cluster naturally into **five meta-domains**:\n    \n    1.  **Quantitative reasoning**: GSM8K, MATH, AIME, IMO, DROP, NumGLUE.\n        \n        *   Evaluates symbolic arithmetic and algebraic reasoning.\n        *   Process-verifiable with numeric or symbolic solvers.\n    2.  **Causal and commonsense reasoning**: ARC, ScienceQA, ATOMIC, AGIEval.\n        \n        *   Tests everyday and scientific causal inference.\n        *   Often factual but requires multi-hop logic.\n    3.  **Abstract and algorithmic reasoning**: ARC-AGI-2, BIG-bench Hard.\n        \n        *   Measures rule discovery and compositional generalization.\n        *   Evaluates systematic reasoning beyond retrieval.\n    4.  **Multimodal reasoning**: ScienceQA, ChartQA, MathVista, TextVQA.\n        \n        *   Combines perception with reasoning over visual/text inputs.\n        *   Central for factual grounding and cross-modal coherence.\n    5.  **Factual reasoning and calibration**: MMLU, HELM, FEVER, SciFact.\n        \n        *   Tests whether reasoning aligns with external truth.\n        *   Important for assessing faithfulness and factual grounding.\n\nReasoning datasets cluster naturally into **five meta-domains**:\n\n1.  **Quantitative reasoning**: GSM8K, MATH, AIME, IMO, DROP, NumGLUE.\n    \n    *   Evaluates symbolic arithmetic and algebraic reasoning.\n    *   Process-verifiable with numeric or symbolic solvers.\n2.  **Causal and commonsense reasoning**: ARC, ScienceQA, ATOMIC, AGIEval.\n    \n    *   Tests everyday and scientific causal inference.\n    *   Often factual but requires multi-hop logic.\n3.  **Abstract and algorithmic reasoning**: ARC-AGI-2, BIG-bench Hard.\n    \n    *   Measures rule discovery and compositional generalization.\n    *   Evaluates systematic reasoning beyond retrieval.\n4.  **Multimodal reasoning**: ScienceQA, ChartQA, MathVista, TextVQA.\n    \n    *   Combines perception with reasoning over visual/text inputs.\n    *   Central for factual grounding and cross-modal coherence.\n5.  **Factual reasoning and calibration**: MMLU, HELM, FEVER, SciFact.\n    \n    *   Tests whether reasoning aligns with external truth.\n    *   Important for assessing faithfulness and factual grounding.\n\n**Quantitative reasoning**: GSM8K, MATH, AIME, IMO, DROP, NumGLUE.\n\n*   Evaluates symbolic arithmetic and algebraic reasoning.\n*   Process-verifiable with numeric or symbolic solvers.\n\n**Causal and commonsense reasoning**: ARC, ScienceQA, ATOMIC, AGIEval.\n\n*   Tests everyday and scientific causal inference.\n*   Often factual but requires multi-hop logic.\n\n**Abstract and algorithmic reasoning**: ARC-AGI-2, BIG-bench Hard.\n\n*   Measures rule discovery and compositional generalization.\n*   Evaluates systematic reasoning beyond retrieval.\n\n**Multimodal reasoning**: ScienceQA, ChartQA, MathVista, TextVQA.\n\n*   Combines perception with reasoning over visual/text inputs.\n*   Central for factual grounding and cross-modal coherence.\n\n**Factual reasoning and calibration**: MMLU, HELM, FEVER, SciFact.\n\n*   Tests whether reasoning aligns with external truth.\n*   Important for assessing faithfulness and factual grounding.",
    "order": 77,
    "orderInChapter": 2,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 355,
      "contentLength": 4411
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#conceptual-clusters",
    "scrapedAt": "2025-12-28T11:54:00.658Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-process-vs-outcome-alignment-78",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Summary of Reasoning Evaluation Datasets and Their Interrelations",
    "title": "Process vs. Outcome Alignment",
    "subtitle": "Summary of Reasoning Evaluation Datasets and Their Interrelations",
    "contentHtml": "<ul>\n  <li>Reasoning benchmarks differ not only in difficulty but in whether they <strong>evaluate process fidelity</strong> or merely <strong>final correctness</strong>.</li>\n</ul>\n<p>Here is your table formatted according to the specified style:</p>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Evaluation Dimension</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Process-aware</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Outcome-only</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Step validation</td>\n<td class=\"tg-tleft-valign-first\">GSM8K, MATH, ScienceQA, HELM</td>\n<td class=\"tg-tleft-valign-second\">MMLU, AGIEval</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Verifier presence</td>\n<td class=\"tg-tleft-valign-first\">GSM8K, DeepSeek-R1, PAL tasks</td>\n<td class=\"tg-tleft-valign-second\">ARC-AGI-1, ARC-AGI-2</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Multi-modal alignment</td>\n<td class=\"tg-tleft-valign-first\">ScienceQA, ChartQA, MathVista</td>\n<td class=\"tg-tleft-valign-second\">TextVQA</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Factual trace scoring</td>\n<td class=\"tg-tleft-valign-first\">FEVER, SciFact, HELM</td>\n<td class=\"tg-tleft-valign-second\">None (factual EM only)</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Evaluation Dimension</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Process-aware</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Outcome-only</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Step validation</td>\n<td class=\"tg-tleft-valign-first\">GSM8K, MATH, ScienceQA, HELM</td>\n<td class=\"tg-tleft-valign-second\">MMLU, AGIEval</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Verifier presence</td>\n<td class=\"tg-tleft-valign-first\">GSM8K, DeepSeek-R1, PAL tasks</td>\n<td class=\"tg-tleft-valign-second\">ARC-AGI-1, ARC-AGI-2</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Multi-modal alignment</td>\n<td class=\"tg-tleft-valign-first\">ScienceQA, ChartQA, MathVista</td>\n<td class=\"tg-tleft-valign-second\">TextVQA</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Factual trace scoring</td>\n<td class=\"tg-tleft-valign-first\">FEVER, SciFact, HELM</td>\n<td class=\"tg-tleft-valign-second\">None (factual EM only)</td>\n</tr>\n</tbody>\n</table>\n<ul>\n  <li>A general trend emerges: <strong>datasets built after 2022 increasingly support process-level scoring</strong>, allowing reasoning verification rather than answer-only grading.</li>\n</ul>",
    "contentMarkdown": "*   Reasoning benchmarks differ not only in difficulty but in whether they **evaluate process fidelity** or merely **final correctness**.\n\nHere is your table formatted according to the specified style:\n\n**Evaluation Dimension**\n\n**Process-aware**\n\n**Outcome-only**\n\nStep validation\n\nGSM8K, MATH, ScienceQA, HELM\n\nMMLU, AGIEval\n\nVerifier presence\n\nGSM8K, DeepSeek-R1, PAL tasks\n\nARC-AGI-1, ARC-AGI-2\n\nMulti-modal alignment\n\nScienceQA, ChartQA, MathVista\n\nTextVQA\n\nFactual trace scoring\n\nFEVER, SciFact, HELM\n\nNone (factual EM only)\n\n**Evaluation Dimension**\n\n**Process-aware**\n\n**Outcome-only**\n\nStep validation\n\nGSM8K, MATH, ScienceQA, HELM\n\nMMLU, AGIEval\n\nVerifier presence\n\nGSM8K, DeepSeek-R1, PAL tasks\n\nARC-AGI-1, ARC-AGI-2\n\nMulti-modal alignment\n\nScienceQA, ChartQA, MathVista\n\nTextVQA\n\nFactual trace scoring\n\nFEVER, SciFact, HELM\n\nNone (factual EM only)\n\n*   A general trend emerges: **datasets built after 2022 increasingly support process-level scoring**, allowing reasoning verification rather than answer-only grading.",
    "order": 78,
    "orderInChapter": 3,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 121,
      "contentLength": 2610
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#process-vs.-outcome-alignment",
    "scrapedAt": "2025-12-28T11:54:00.658Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-complementarity-in-reasoning-diagnostics-79",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Summary of Reasoning Evaluation Datasets and Their Interrelations",
    "title": "Complementarity in Reasoning Diagnostics",
    "subtitle": "Summary of Reasoning Evaluation Datasets and Their Interrelations",
    "contentHtml": "<ul>\n  <li>\n    <p>Different benchmarks expose different weaknesses:</p>\n\n    <ul>\n      <li><strong>GSM8K</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-300-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4718\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4719\"><span class=\"mo\" id=\"MathJax-Span-4720\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-300\">\\rightarrow</script> Arithmetic chain stability.</li>\n      <li><strong>DROP</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-301-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4721\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4722\"><span class=\"mo\" id=\"MathJax-Span-4723\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-301\">\\rightarrow</script> Numeric grounding errors.</li>\n      <li><strong>MATH</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-302-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4724\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4725\"><span class=\"mo\" id=\"MathJax-Span-4726\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-302\">\\rightarrow</script> Symbolic generalization.</li>\n      <li><strong>AGIEval</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-303-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4727\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4728\"><span class=\"mo\" id=\"MathJax-Span-4729\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-303\">\\rightarrow</script> Deductive reasoning under linguistic ambiguity.</li>\n      <li><strong>ARC-AGI-2</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-304-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4730\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4731\"><span class=\"mo\" id=\"MathJax-Span-4732\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-304\">\\rightarrow</script> Compositional abstraction.</li>\n      <li><strong>ChartQA / MathVista</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-305-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4733\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4734\"><span class=\"mo\" id=\"MathJax-Span-4735\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-305\">\\rightarrow</script> Grounded multimodal computation.</li>\n      <li><strong>HELM</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-306-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4736\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4737\"><span class=\"mo\" id=\"MathJax-Span-4738\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-306\">\\rightarrow</script> Multi-metric reasoning balance (accuracy vs. calibration).</li>\n    </ul>\n  </li>\n  <li>\n    <p>Comprehensive reasoning evaluation therefore requires <strong>cross-benchmark triangulation</strong>, where performance consistency across clusters (e.g., math + causal + factual) signals genuine general reasoning ability rather than domain memorization.</p>\n  </li>\n</ul>\n<p>Different benchmarks expose different weaknesses:</p>\n<ul>\n      <li><strong>GSM8K</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-300-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4718\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4719\"><span class=\"mo\" id=\"MathJax-Span-4720\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-300\">\\rightarrow</script> Arithmetic chain stability.</li>\n      <li><strong>DROP</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-301-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4721\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4722\"><span class=\"mo\" id=\"MathJax-Span-4723\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-301\">\\rightarrow</script> Numeric grounding errors.</li>\n      <li><strong>MATH</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-302-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4724\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4725\"><span class=\"mo\" id=\"MathJax-Span-4726\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-302\">\\rightarrow</script> Symbolic generalization.</li>\n      <li><strong>AGIEval</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-303-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4727\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4728\"><span class=\"mo\" id=\"MathJax-Span-4729\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-303\">\\rightarrow</script> Deductive reasoning under linguistic ambiguity.</li>\n      <li><strong>ARC-AGI-2</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-304-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4730\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4731\"><span class=\"mo\" id=\"MathJax-Span-4732\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-304\">\\rightarrow</script> Compositional abstraction.</li>\n      <li><strong>ChartQA / MathVista</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-305-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4733\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4734\"><span class=\"mo\" id=\"MathJax-Span-4735\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-305\">\\rightarrow</script> Grounded multimodal computation.</li>\n      <li><strong>HELM</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-306-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4736\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4737\"><span class=\"mo\" id=\"MathJax-Span-4738\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-306\">\\rightarrow</script> Multi-metric reasoning balance (accuracy vs. calibration).</li>\n    </ul>\n<p>Comprehensive reasoning evaluation therefore requires <strong>cross-benchmark triangulation</strong>, where performance consistency across clusters (e.g., math + causal + factual) signals genuine general reasoning ability rather than domain memorization.</p>",
    "contentMarkdown": "*   Different benchmarks expose different weaknesses:\n    \n    *   **GSM8K** ‚Üí‚Üí\\\\rightarrow Arithmetic chain stability.\n    *   **DROP** ‚Üí‚Üí\\\\rightarrow Numeric grounding errors.\n    *   **MATH** ‚Üí‚Üí\\\\rightarrow Symbolic generalization.\n    *   **AGIEval** ‚Üí‚Üí\\\\rightarrow Deductive reasoning under linguistic ambiguity.\n    *   **ARC-AGI-2** ‚Üí‚Üí\\\\rightarrow Compositional abstraction.\n    *   **ChartQA / MathVista** ‚Üí‚Üí\\\\rightarrow Grounded multimodal computation.\n    *   **HELM** ‚Üí‚Üí\\\\rightarrow Multi-metric reasoning balance (accuracy vs. calibration).\n*   Comprehensive reasoning evaluation therefore requires **cross-benchmark triangulation**, where performance consistency across clusters (e.g., math + causal + factual) signals genuine general reasoning ability rather than domain memorization.\n    \n\nDifferent benchmarks expose different weaknesses:\n\n*   **GSM8K** ‚Üí‚Üí\\\\rightarrow Arithmetic chain stability.\n*   **DROP** ‚Üí‚Üí\\\\rightarrow Numeric grounding errors.\n*   **MATH** ‚Üí‚Üí\\\\rightarrow Symbolic generalization.\n*   **AGIEval** ‚Üí‚Üí\\\\rightarrow Deductive reasoning under linguistic ambiguity.\n*   **ARC-AGI-2** ‚Üí‚Üí\\\\rightarrow Compositional abstraction.\n*   **ChartQA / MathVista** ‚Üí‚Üí\\\\rightarrow Grounded multimodal computation.\n*   **HELM** ‚Üí‚Üí\\\\rightarrow Multi-metric reasoning balance (accuracy vs. calibration).\n\nComprehensive reasoning evaluation therefore requires **cross-benchmark triangulation**, where performance consistency across clusters (e.g., math + causal + factual) signals genuine general reasoning ability rather than domain memorization.",
    "order": 79,
    "orderInChapter": 4,
    "difficulty": 5,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 160,
      "contentLength": 19279
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#complementarity-in-reasoning-diagnostics",
    "scrapedAt": "2025-12-28T11:54:00.658Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-evolutionary-timeline-of-reasoning-datasets-80",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Summary of Reasoning Evaluation Datasets and Their Interrelations",
    "title": "Evolutionary Timeline of Reasoning Datasets",
    "subtitle": "Summary of Reasoning Evaluation Datasets and Their Interrelations",
    "contentHtml": "<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Period</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Representative Datasets</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Evaluation Trend</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>2018‚Äì2019</strong></td>\n<td class=\"tg-tleft-valign-first\">FEVER, DROP, ARC-AGI-1</td>\n<td class=\"tg-tleft-valign-second\">Simple factual or numerical reasoning</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>2020‚Äì2021</strong></td>\n<td class=\"tg-tleft-valign-first\">MMLU, MATH, SciFact</td>\n<td class=\"tg-tleft-valign-second\">Broader academic reasoning; factual grounding</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>2022</strong></td>\n<td class=\"tg-tleft-valign-first\">BIG-bench, BBH, ScienceQA</td>\n<td class=\"tg-tleft-valign-second\">Emergence and multimodality</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>2023</strong></td>\n<td class=\"tg-tleft-valign-first\">ARC-AGI-2, AGIEval, ChartQA</td>\n<td class=\"tg-tleft-valign-second\">Abstraction and exam-level reasoning</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>2024‚Äì2025</strong></td>\n<td class=\"tg-tleft-valign-first\">MathVista, DeepSeek-R1 evals, AIME24, HELM 2.0</td>\n<td class=\"tg-tleft-valign-second\">Process-level and verifier-based evaluation</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Period</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Representative Datasets</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Evaluation Trend</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>2018‚Äì2019</strong></td>\n<td class=\"tg-tleft-valign-first\">FEVER, DROP, ARC-AGI-1</td>\n<td class=\"tg-tleft-valign-second\">Simple factual or numerical reasoning</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>2020‚Äì2021</strong></td>\n<td class=\"tg-tleft-valign-first\">MMLU, MATH, SciFact</td>\n<td class=\"tg-tleft-valign-second\">Broader academic reasoning; factual grounding</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>2022</strong></td>\n<td class=\"tg-tleft-valign-first\">BIG-bench, BBH, ScienceQA</td>\n<td class=\"tg-tleft-valign-second\">Emergence and multimodality</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>2023</strong></td>\n<td class=\"tg-tleft-valign-first\">ARC-AGI-2, AGIEval, ChartQA</td>\n<td class=\"tg-tleft-valign-second\">Abstraction and exam-level reasoning</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>2024‚Äì2025</strong></td>\n<td class=\"tg-tleft-valign-first\">MathVista, DeepSeek-R1 evals, AIME24, HELM 2.0</td>\n<td class=\"tg-tleft-valign-second\">Process-level and verifier-based evaluation</td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "**Period**\n\n**Representative Datasets**\n\n**Evaluation Trend**\n\n**2018‚Äì2019**\n\nFEVER, DROP, ARC-AGI-1\n\nSimple factual or numerical reasoning\n\n**2020‚Äì2021**\n\nMMLU, MATH, SciFact\n\nBroader academic reasoning; factual grounding\n\n**2022**\n\nBIG-bench, BBH, ScienceQA\n\nEmergence and multimodality\n\n**2023**\n\nARC-AGI-2, AGIEval, ChartQA\n\nAbstraction and exam-level reasoning\n\n**2024‚Äì2025**\n\nMathVista, DeepSeek-R1 evals, AIME24, HELM 2.0\n\nProcess-level and verifier-based evaluation\n\n**Period**\n\n**Representative Datasets**\n\n**Evaluation Trend**\n\n**2018‚Äì2019**\n\nFEVER, DROP, ARC-AGI-1\n\nSimple factual or numerical reasoning\n\n**2020‚Äì2021**\n\nMMLU, MATH, SciFact\n\nBroader academic reasoning; factual grounding\n\n**2022**\n\nBIG-bench, BBH, ScienceQA\n\nEmergence and multimodality\n\n**2023**\n\nARC-AGI-2, AGIEval, ChartQA\n\nAbstraction and exam-level reasoning\n\n**2024‚Äì2025**\n\nMathVista, DeepSeek-R1 evals, AIME24, HELM 2.0\n\nProcess-level and verifier-based evaluation",
    "order": 80,
    "orderInChapter": 5,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 98,
      "contentLength": 2833
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#evolutionary-timeline-of-reasoning-datasets",
    "scrapedAt": "2025-12-28T11:54:00.658Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-takeaways-81",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "Summary of Reasoning Evaluation Datasets and Their Interrelations",
    "title": "Takeaways",
    "subtitle": "Summary of Reasoning Evaluation Datasets and Their Interrelations",
    "contentHtml": "<ol>\n  <li>No single dataset fully captures ‚Äúreasoning ability.‚Äù</li>\n  <li>Process-level evaluation (verifier-based) is key for distinguishing reasoning from memorization.</li>\n  <li>Factual and multimodal reasoning datasets highlight grounding and calibration as equally important dimensions.</li>\n  <li>Emergent models (DeepSeek-R1, o1) show consistent gains across process-verifiable datasets‚Äîsuggesting <strong>genuine reasoning generalization</strong>, not just surface recall.</li>\n  <li>Future benchmarks will likely blend structured multimodal reasoning (MathVista-style) with holistic factual calibration (HELM-style).</li>\n</ol>",
    "contentMarkdown": "1.  No single dataset fully captures ‚Äúreasoning ability.‚Äù\n2.  Process-level evaluation (verifier-based) is key for distinguishing reasoning from memorization.\n3.  Factual and multimodal reasoning datasets highlight grounding and calibration as equally important dimensions.\n4.  Emergent models (DeepSeek-R1, o1) show consistent gains across process-verifiable datasets‚Äîsuggesting **genuine reasoning generalization**, not just surface recall.\n5.  Future benchmarks will likely blend structured multimodal reasoning (MathVista-style) with holistic factual calibration (HELM-style).",
    "order": 81,
    "orderInChapter": 6,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 66,
      "contentLength": 639
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#takeaways",
    "scrapedAt": "2025-12-28T11:54:00.658Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-prompting-based-and-decodingaggregation-reasoning-82",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "References",
    "title": "Prompting-Based and Decoding‚ÄìAggregation Reasoning",
    "subtitle": "References",
    "contentHtml": "<ul>\n  <li><a href=\"https://arxiv.org/abs/2201.11903\">Chain-of-Thought Prompting Elicits Reasoning in Large Language Models</a></li>\n  <li><a href=\"https://arxiv.org/abs/2203.11171\">Self-Consistency Improves Chain-of-Thought Reasoning in Language Models</a></li>\n  <li><a href=\"https://arxiv.org/abs/2404.03602\">From Sparse to Rich Reasoning: The ‚ÄúAha Moment‚Äù in LLMs</a></li>\n  <li><a href=\"https://arxiv.org/abs/2403.04978\">Faithful Reasoning Using Large Language Models</a></li>\n  <li><a href=\"https://arxiv.org/abs/2405.02382\">Reasoning Benchmarks: Survey and Analysis</a></li>\n</ul>",
    "contentMarkdown": "*   [Chain-of-Thought Prompting Elicits Reasoning in Large Language Models](https://arxiv.org/abs/2201.11903)\n*   [Self-Consistency Improves Chain-of-Thought Reasoning in Language Models](https://arxiv.org/abs/2203.11171)\n*   [From Sparse to Rich Reasoning: The ‚ÄúAha Moment‚Äù in LLMs](https://arxiv.org/abs/2404.03602)\n*   [Faithful Reasoning Using Large Language Models](https://arxiv.org/abs/2403.04978)\n*   [Reasoning Benchmarks: Survey and Analysis](https://arxiv.org/abs/2405.02382)",
    "order": 82,
    "orderInChapter": 1,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 41,
      "contentLength": 587
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#prompting-based-and-decoding‚Äìaggregation-reasoning",
    "scrapedAt": "2025-12-28T11:54:00.658Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-search-based-reasoning-83",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "References",
    "title": "Search-Based Reasoning",
    "subtitle": "References",
    "contentHtml": "<ul>\n  <li><a href=\"https://arxiv.org/abs/2305.10601\">Tree of Thoughts: Deliberate Problem Solving with Large Language Models</a></li>\n  <li><a href=\"https://arxiv.org/abs/2109.15074\">A Survey of Monte Carlo Tree Search Methods</a></li>\n  <li><a href=\"https://arxiv.org/abs/2305.14992\">Reasoning with Language Models is Planning with World Models (RAP)</a></li>\n  <li><a href=\"https://arxiv.org/abs/2305.20050\">Critic‚ÄìJudge: Evaluating Reasoning Chains with Critique Models</a></li>\n</ul>",
    "contentMarkdown": "*   [Tree of Thoughts: Deliberate Problem Solving with Large Language Models](https://arxiv.org/abs/2305.10601)\n*   [A Survey of Monte Carlo Tree Search Methods](https://arxiv.org/abs/2109.15074)\n*   [Reasoning with Language Models is Planning with World Models (RAP)](https://arxiv.org/abs/2305.14992)\n*   [Critic‚ÄìJudge: Evaluating Reasoning Chains with Critique Models](https://arxiv.org/abs/2305.20050)",
    "order": 83,
    "orderInChapter": 2,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 39,
      "contentLength": 488
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#search-based-reasoning",
    "scrapedAt": "2025-12-28T11:54:00.658Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-reflection-and-self-verification-84",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "References",
    "title": "Reflection and Self-Verification",
    "subtitle": "References",
    "contentHtml": "<ul>\n  <li><a href=\"https://arxiv.org/abs/2303.11366\">Reflexion: Language Agents with Verbal Reinforcement Learning</a></li>\n  <li><a href=\"https://arxiv.org/abs/2303.17651\">Self-Refine: Iterative Refinement with Self-Feedback</a></li>\n  <li><a href=\"https://arxiv.org/abs/2402.05402\">RCOT: Reflective Chain-of-Thought Learning</a></li>\n</ul>",
    "contentMarkdown": "*   [Reflexion: Language Agents with Verbal Reinforcement Learning](https://arxiv.org/abs/2303.11366)\n*   [Self-Refine: Iterative Refinement with Self-Feedback](https://arxiv.org/abs/2303.17651)\n*   [RCOT: Reflective Chain-of-Thought Learning](https://arxiv.org/abs/2402.05402)",
    "order": 84,
    "orderInChapter": 3,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 19,
      "contentLength": 342
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#reflection-and-self-verification",
    "scrapedAt": "2025-12-28T11:54:00.658Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-tool-augmented-and-interaction-based-reasoning-85",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "References",
    "title": "Tool-Augmented and Interaction-Based Reasoning",
    "subtitle": "References",
    "contentHtml": "<ul>\n  <li><a href=\"https://arxiv.org/abs/2302.04761\">Toolformer: Language Models Can Teach Themselves to Use Tools</a></li>\n  <li><a href=\"https://arxiv.org/abs/2210.03629\">ReAct: Synergizing Reasoning and Acting in Language Models</a></li>\n  <li><a href=\"https://arxiv.org/abs/2211.10435\">Program-Aided Language Models (PAL): Improving Reasoning with Code Execution</a></li>\n  <li><a href=\"https://arxiv.org/abs/2305.15334\">Gorilla: Large Language Model Connected with Massive APIs</a></li>\n  <li><a href=\"https://arxiv.org/abs/2302.09419\">LLM-Augmented Reasoning: Integrating Tool Use in Language Models</a></li>\n  <li><a href=\"https://arxiv.org/abs/2307.16789\">ToolBench: Benchmarking Large Language Models for Tool Learning</a></li>\n</ul>",
    "contentMarkdown": "*   [Toolformer: Language Models Can Teach Themselves to Use Tools](https://arxiv.org/abs/2302.04761)\n*   [ReAct: Synergizing Reasoning and Acting in Language Models](https://arxiv.org/abs/2210.03629)\n*   [Program-Aided Language Models (PAL): Improving Reasoning with Code Execution](https://arxiv.org/abs/2211.10435)\n*   [Gorilla: Large Language Model Connected with Massive APIs](https://arxiv.org/abs/2305.15334)\n*   [LLM-Augmented Reasoning: Integrating Tool Use in Language Models](https://arxiv.org/abs/2302.09419)\n*   [ToolBench: Benchmarking Large Language Models for Tool Learning](https://arxiv.org/abs/2307.16789)",
    "order": 85,
    "orderInChapter": 4,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 56,
      "contentLength": 743
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#tool-augmented-and-interaction-based-reasoning",
    "scrapedAt": "2025-12-28T11:54:00.658Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-reinforcement-learning-and-policy-based-reasoning-86",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "References",
    "title": "Reinforcement Learning and Policy-Based Reasoning",
    "subtitle": "References",
    "contentHtml": "<ul>\n  <li><a href=\"https://arxiv.org/abs/2501.12948\">DeepSeek-R1: Encouraging Reasoning in LLMs via Reinforcement Learning</a></li>\n  <li><a href=\"https://arxiv.org/abs/2310.00531\">Beyond the Imitation Game: Quantifying and Improving LLM Reasoning</a></li>\n</ul>",
    "contentMarkdown": "*   [DeepSeek-R1: Encouraging Reasoning in LLMs via Reinforcement Learning](https://arxiv.org/abs/2501.12948)\n*   [Beyond the Imitation Game: Quantifying and Improving LLM Reasoning](https://arxiv.org/abs/2310.00531)",
    "order": 86,
    "orderInChapter": 5,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms",
      "llm",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 19,
      "contentLength": 263
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#reinforcement-learning-and-policy-based-reasoning",
    "scrapedAt": "2025-12-28T11:54:00.658Z"
  },
  {
    "id": "ai-reasoning-in-LLMs-benchmark-and-evaluation-datasets-87",
    "domain": "ai_primers",
    "category": "NLP/LLMs",
    "article": "Reasoning in LLMs",
    "articleSlug": "reasoning-in-LLMs",
    "chapter": "References",
    "title": "Benchmark and Evaluation Datasets",
    "subtitle": "References",
    "contentHtml": "<ul>\n  <li><a href=\"https://arxiv.org/abs/2009.03300\">MMLU: Measuring Massive Multitask Language Understanding</a></li>\n  <li><a href=\"https://arxiv.org/abs/2406.19314\">ARC-AGI: Evaluating Reasoning and Abstraction in Artificial General Intelligence</a></li>\n  <li><a href=\"https://arxiv.org/abs/2402.18617\">AIME-Level Mathematical Reasoning in Large Language Models</a></li>\n  <li><a href=\"https://arxiv.org/abs/2409.12015\">IMO-AGI: Benchmarking Mathematical Olympiad-Level Reasoning in Language Models</a></li>\n</ul>",
    "contentMarkdown": "*   [MMLU: Measuring Massive Multitask Language Understanding](https://arxiv.org/abs/2009.03300)\n*   [ARC-AGI: Evaluating Reasoning and Abstraction in Artificial General Intelligence](https://arxiv.org/abs/2406.19314)\n*   [AIME-Level Mathematical Reasoning in Large Language Models](https://arxiv.org/abs/2402.18617)\n*   [IMO-AGI: Benchmarking Mathematical Olympiad-Level Reasoning in Language Models](https://arxiv.org/abs/2409.12015)",
    "order": 87,
    "orderInChapter": 6,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "nlpllms"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 34,
      "contentLength": 518
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reasoning-in-LLMs/#benchmark-and-evaluation-datasets",
    "scrapedAt": "2025-12-28T11:54:00.658Z"
  }
]