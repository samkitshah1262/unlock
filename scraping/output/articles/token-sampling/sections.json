[
  {
    "id": "ai-token-sampling-autoregressive-decoding-1",
    "articleSlug": "token-sampling",
    "articleTitle": "Token Sampling Methods",
    "category": "Algorithms/Architecture",
    "chapter": "Background",
    "title": "Autoregressive Decoding",
    "order": 1,
    "orderInChapter": 1,
    "contentHtml": "<ul>\n  <li>\n    <p>When we generate a textual sequence with a language model, we typically begin with a textual prefix/prompt. Then, we follow the steps shown below:</p>\n\n    <ol>\n      <li>Use the language model to generate the next token.</li>\n      <li>Add this output token to our input sequence.</li>\n      <li>Repeat.</li>\n    </ol>\n  </li>\n  <li>\n    <p>By continually generating the next token in this manner (i.e., this is what we call the autoregressive decoding process), we can generate an entire textual sequence (cf. below image; <a href=\"https://www.linkedin.com/in/cameron-r-wolfe-ph-d-04744a238/\">source</a>).</p>\n  </li>\n</ul>\n<p>When we generate a textual sequence with a language model, we typically begin with a textual prefix/prompt. Then, we follow the steps shown below:</p>\n<ol>\n      <li>Use the language model to generate the next token.</li>\n      <li>Add this output token to our input sequence.</li>\n      <li>Repeat.</li>\n    </ol>\n<p>By continually generating the next token in this manner (i.e., this is what we call the autoregressive decoding process), we can generate an entire textual sequence (cf. below image; <a href=\"https://www.linkedin.com/in/cameron-r-wolfe-ph-d-04744a238/\">source</a>).</p>\n<p><img src=\"/primers/ai/assets/token-sampling/ar.jpg\" alt=\"\"></p>",
    "contentMarkdown": "*   When we generate a textual sequence with a language model, we typically begin with a textual prefix/prompt. Then, we follow the steps shown below:\n    \n    1.  Use the language model to generate the next token.\n    2.  Add this output token to our input sequence.\n    3.  Repeat.\n*   By continually generating the next token in this manner (i.e., this is what we call the autoregressive decoding process), we can generate an entire textual sequence (cf. below image; [source](https://www.linkedin.com/in/cameron-r-wolfe-ph-d-04744a238/)).\n    \n\nWhen we generate a textual sequence with a language model, we typically begin with a textual prefix/prompt. Then, we follow the steps shown below:\n\n1.  Use the language model to generate the next token.\n2.  Add this output token to our input sequence.\n3.  Repeat.\n\nBy continually generating the next token in this manner (i.e., this is what we call the autoregressive decoding process), we can generate an entire textual sequence (cf. below image; [source](https://www.linkedin.com/in/cameron-r-wolfe-ph-d-04744a238/)).\n\n![](/primers/ai/assets/token-sampling/ar.jpg)",
    "contentLength": 1302,
    "wordCount": 153,
    "hasCode": false,
    "hasMath": false,
    "hasImages": true,
    "url": "https://aman.ai/primers/ai/token-sampling/#autoregressive-decoding"
  },
  {
    "id": "ai-token-sampling-token-probabilities-2",
    "articleSlug": "token-sampling",
    "articleTitle": "Token Sampling Methods",
    "category": "Algorithms/Architecture",
    "chapter": "Background",
    "title": "Token Probabilities",
    "order": 2,
    "orderInChapter": 2,
    "contentHtml": "<ul>\n  <li>But, how do we choose/predict the next token (i.e., step one shown above)?</li>\n  <li>Instead of directly outputting the next token, language models output a probability distribution over the set of all possible tokens. Put simply, LLMs are essentially neural networks tackling a classification problem over the vocabulary (unique tokens).</li>\n  <li>Given this probability distribution, we can follow several different strategies for selecting the next token. For example, greedy decoding <a href=\"#greedy-decoding\">(one potential strategy)</a>, as we’ll see below, simply selects the token with the highest probability as the next token.</li>\n</ul>",
    "contentMarkdown": "*   But, how do we choose/predict the next token (i.e., step one shown above)?\n*   Instead of directly outputting the next token, language models output a probability distribution over the set of all possible tokens. Put simply, LLMs are essentially neural networks tackling a classification problem over the vocabulary (unique tokens).\n*   Given this probability distribution, we can follow several different strategies for selecting the next token. For example, greedy decoding [(one potential strategy)](#greedy-decoding), as we’ll see below, simply selects the token with the highest probability as the next token.",
    "contentLength": 661,
    "wordCount": 90,
    "hasCode": false,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/token-sampling/#token-probabilities"
  },
  {
    "id": "ai-token-sampling-logits-and-softmax-3",
    "articleSlug": "token-sampling",
    "articleTitle": "Token Sampling Methods",
    "category": "Algorithms/Architecture",
    "chapter": "Background",
    "title": "Logits and Softmax",
    "order": 3,
    "orderInChapter": 3,
    "contentHtml": "<ul>\n  <li>\n    <p>LLMs produce class probabilities with logit vector <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-25\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1000.47em, 2.659em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-26\"><span class=\"texatom\" id=\"MathJax-Span-27\"><span class=\"mrow\" id=\"MathJax-Span-28\"><span class=\"mi\" id=\"MathJax-Span-29\" style=\"font-family: STIXGeneral; font-weight: bold;\">z</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">z</mi></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-9\">\\mathbf{z}</script> where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mo>=</mo><mrow><mo>(</mo><mrow><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow><mo>)</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-30\" style=\"width: 7.346em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.096em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1006.04em, 2.815em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-31\"><span class=\"texatom\" id=\"MathJax-Span-32\"><span class=\"mrow\" id=\"MathJax-Span-33\"><span class=\"mi\" id=\"MathJax-Span-34\" style=\"font-family: STIXGeneral; font-weight: bold;\">z</span></span></span><span class=\"mo\" id=\"MathJax-Span-35\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mrow\" id=\"MathJax-Span-36\" style=\"padding-left: 0.315em;\"><span class=\"mo\" id=\"MathJax-Span-37\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mrow\" id=\"MathJax-Span-38\"><span class=\"msubsup\" id=\"MathJax-Span-39\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-40\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-41\"><span class=\"mrow\" id=\"MathJax-Span-42\"><span class=\"mn\" id=\"MathJax-Span-43\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-44\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-45\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">…</span><span class=\"mo\" id=\"MathJax-Span-46\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-47\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-48\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-49\"><span class=\"mrow\" id=\"MathJax-Span-50\"><span class=\"mi\" id=\"MathJax-Span-51\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-52\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">z</mi></mrow><mo>=</mo><mrow><mo>(</mo><mrow><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>n</mi></mrow></msub></mrow><mo>)</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-10\">\\mathbf{z}=\\left(z_{1}, \\ldots, z_{n}\\right)</script> by performing the softmax function to produce probability vector <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>q</mi></mrow><mo>=</mo><mrow><mo>(</mo><mrow><msub><mi>q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow><mo>)</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-53\" style=\"width: 7.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1006.36em, 2.867em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-54\"><span class=\"texatom\" id=\"MathJax-Span-55\"><span class=\"mrow\" id=\"MathJax-Span-56\"><span class=\"mi\" id=\"MathJax-Span-57\" style=\"font-family: STIXGeneral; font-weight: bold;\">q</span></span></span><span class=\"mo\" id=\"MathJax-Span-58\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mrow\" id=\"MathJax-Span-59\" style=\"padding-left: 0.315em;\"><span class=\"mo\" id=\"MathJax-Span-60\" style=\"vertical-align: 0em;\"><span style=\"font-family: STIXGeneral-Regular;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-61\"><span class=\"msubsup\" id=\"MathJax-Span-62\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-63\" style=\"font-family: STIXGeneral-Italic;\">q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-64\"><span class=\"mrow\" id=\"MathJax-Span-65\"><span class=\"mn\" id=\"MathJax-Span-66\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-67\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-68\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">…</span><span class=\"mo\" id=\"MathJax-Span-69\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-70\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-71\" style=\"font-family: STIXGeneral-Italic;\">q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-72\"><span class=\"mrow\" id=\"MathJax-Span-73\"><span class=\"mi\" id=\"MathJax-Span-74\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-75\" style=\"vertical-align: 0em;\"><span style=\"font-family: STIXGeneral-Regular;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">q</mi></mrow><mo>=</mo><mrow><mo>(</mo><mrow><msub><mi>q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>n</mi></mrow></msub></mrow><mo>)</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-11\">\\mathbf{q}=\\left(q_{1}, \\ldots, q_{n}\\right)</script> by comparing <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-76\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-77\"><span class=\"msubsup\" id=\"MathJax-Span-78\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-79\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-80\"><span class=\"mrow\" id=\"MathJax-Span-81\"><span class=\"mi\" id=\"MathJax-Span-82\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-12\">z_{i}</script> with with the other logits.</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>&amp;#x2061;</mo><mrow><mo>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>)</mo></mrow></mrow><mrow><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></munder><mi>exp</mi><mo>&amp;#x2061;</mo><mrow><mo>(</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></msub><mo>)</mo></mrow></mrow></mfrac></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-83\" style=\"width: 8.128em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.773em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.68em, 1006.77em, 3.648em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-84\"><span class=\"msubsup\" id=\"MathJax-Span-85\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-86\" style=\"font-family: STIXGeneral-Italic;\">q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-87\"><span class=\"mrow\" id=\"MathJax-Span-88\"><span class=\"mi\" id=\"MathJax-Span-89\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-90\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-91\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.586em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1002.71em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.404em;\"><span class=\"mrow\" id=\"MathJax-Span-92\"><span class=\"mi\" id=\"MathJax-Span-93\" style=\"font-family: STIXGeneral-Regular;\">exp</span><span class=\"mo\" id=\"MathJax-Span-94\"></span><span class=\"mrow\" id=\"MathJax-Span-95\"><span class=\"mo\" id=\"MathJax-Span-96\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-97\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-98\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-99\"><span class=\"mrow\" id=\"MathJax-Span-100\"><span class=\"mi\" id=\"MathJax-Span-101\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-102\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(2.971em, 1004.33em, 4.638em, -999.997em); top: -3.174em; left: 50%; margin-left: -2.237em;\"><span class=\"mrow\" id=\"MathJax-Span-103\"><span class=\"munderover\" id=\"MathJax-Span-104\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-105\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-106\"><span class=\"mrow\" id=\"MathJax-Span-107\"><span class=\"mi\" id=\"MathJax-Span-108\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-109\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">exp</span><span class=\"mo\" id=\"MathJax-Span-110\"></span><span class=\"mrow\" id=\"MathJax-Span-111\"><span class=\"mo\" id=\"MathJax-Span-112\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">(</span></span><span class=\"msubsup\" id=\"MathJax-Span-113\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-114\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-115\"><span class=\"mrow\" id=\"MathJax-Span-116\"><span class=\"mi\" id=\"MathJax-Span-117\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-118\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.59em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.586em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo>(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi></mrow></msub><mo>)</mo></mrow></mrow><mrow><munder><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi></mrow></munder><mi>exp</mi><mo>⁡</mo><mrow><mo>(</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi></mrow></msub><mo>)</mo></mrow></mrow></mfrac></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-13\">q_{i}=\\frac{\\exp \\left(z_{i}\\right)}{\\sum_{j} \\exp \\left(z_{j}\\right)}</script>\n  </li>\n  <li>\n    <p>The softmax function normalizes the candidates at each iteration of the network based on their exponential values by ensuring the network outputs are all between zero and one at every timestep, thereby easing their interpretation as probability values (cf. below image; <a href=\"https://www.linkedin.com/in/cameron-r-wolfe-ph-d-04744a238/\">source</a>).</p>\n  </li>\n</ul>\n<p>LLMs produce class probabilities with logit vector <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-25\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1000.47em, 2.659em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-26\"><span class=\"texatom\" id=\"MathJax-Span-27\"><span class=\"mrow\" id=\"MathJax-Span-28\"><span class=\"mi\" id=\"MathJax-Span-29\" style=\"font-family: STIXGeneral; font-weight: bold;\">z</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">z</mi></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-9\">\\mathbf{z}</script> where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>z</mi></mrow><mo>=</mo><mrow><mo>(</mo><mrow><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow><mo>)</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-30\" style=\"width: 7.346em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.096em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1006.04em, 2.815em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-31\"><span class=\"texatom\" id=\"MathJax-Span-32\"><span class=\"mrow\" id=\"MathJax-Span-33\"><span class=\"mi\" id=\"MathJax-Span-34\" style=\"font-family: STIXGeneral; font-weight: bold;\">z</span></span></span><span class=\"mo\" id=\"MathJax-Span-35\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mrow\" id=\"MathJax-Span-36\" style=\"padding-left: 0.315em;\"><span class=\"mo\" id=\"MathJax-Span-37\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mrow\" id=\"MathJax-Span-38\"><span class=\"msubsup\" id=\"MathJax-Span-39\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-40\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-41\"><span class=\"mrow\" id=\"MathJax-Span-42\"><span class=\"mn\" id=\"MathJax-Span-43\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-44\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-45\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">…</span><span class=\"mo\" id=\"MathJax-Span-46\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-47\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-48\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-49\"><span class=\"mrow\" id=\"MathJax-Span-50\"><span class=\"mi\" id=\"MathJax-Span-51\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-52\" style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">z</mi></mrow><mo>=</mo><mrow><mo>(</mo><mrow><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>n</mi></mrow></msub></mrow><mo>)</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-10\">\\mathbf{z}=\\left(z_{1}, \\ldots, z_{n}\\right)</script> by performing the softmax function to produce probability vector <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>q</mi></mrow><mo>=</mo><mrow><mo>(</mo><mrow><msub><mi>q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow><mo>)</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-53\" style=\"width: 7.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1006.36em, 2.867em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-54\"><span class=\"texatom\" id=\"MathJax-Span-55\"><span class=\"mrow\" id=\"MathJax-Span-56\"><span class=\"mi\" id=\"MathJax-Span-57\" style=\"font-family: STIXGeneral; font-weight: bold;\">q</span></span></span><span class=\"mo\" id=\"MathJax-Span-58\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mrow\" id=\"MathJax-Span-59\" style=\"padding-left: 0.315em;\"><span class=\"mo\" id=\"MathJax-Span-60\" style=\"vertical-align: 0em;\"><span style=\"font-family: STIXGeneral-Regular;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-61\"><span class=\"msubsup\" id=\"MathJax-Span-62\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-63\" style=\"font-family: STIXGeneral-Italic;\">q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-64\"><span class=\"mrow\" id=\"MathJax-Span-65\"><span class=\"mn\" id=\"MathJax-Span-66\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-67\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-68\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">…</span><span class=\"mo\" id=\"MathJax-Span-69\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-70\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-71\" style=\"font-family: STIXGeneral-Italic;\">q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-72\"><span class=\"mrow\" id=\"MathJax-Span-73\"><span class=\"mi\" id=\"MathJax-Span-74\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-75\" style=\"vertical-align: 0em;\"><span style=\"font-family: STIXGeneral-Regular;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">q</mi></mrow><mo>=</mo><mrow><mo>(</mo><mrow><msub><mi>q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>n</mi></mrow></msub></mrow><mo>)</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-11\">\\mathbf{q}=\\left(q_{1}, \\ldots, q_{n}\\right)</script> by comparing <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-76\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-77\"><span class=\"msubsup\" id=\"MathJax-Span-78\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.273em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-79\" style=\"font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-80\"><span class=\"mrow\" id=\"MathJax-Span-81\"><span class=\"mi\" id=\"MathJax-Span-82\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-12\">z_{i}</script> with with the other logits.</p>\n<p>The softmax function normalizes the candidates at each iteration of the network based on their exponential values by ensuring the network outputs are all between zero and one at every timestep, thereby easing their interpretation as probability values (cf. below image; <a href=\"https://www.linkedin.com/in/cameron-r-wolfe-ph-d-04744a238/\">source</a>).</p>\n<p><img src=\"/primers/ai/assets/token-sampling/Softmax.jpg\" alt=\"\"></p>",
    "contentMarkdown": "*   LLMs produce class probabilities with logit vector zz\\\\mathbf{z} where z\\=(z1,…,zn)z\\=(z1,…,zn)\\\\mathbf{z}=\\\\left(z\\_{1}, \\\\ldots, z\\_{n}\\\\right) by performing the softmax function to produce probability vector q\\=(q1,…,qn)q\\=(q1,…,qn)\\\\mathbf{q}=\\\\left(q\\_{1}, \\\\ldots, q\\_{n}\\\\right) by comparing ziziz\\_{i} with with the other logits.\n    \n    qi\\=exp(zi)∑jexp(zj)qi\\=exp⁡(zi)∑jexp⁡(zj)\n    \n    q\\_{i}=\\\\frac{\\\\exp \\\\left(z\\_{i}\\\\right)}{\\\\sum\\_{j} \\\\exp \\\\left(z\\_{j}\\\\right)}\n*   The softmax function normalizes the candidates at each iteration of the network based on their exponential values by ensuring the network outputs are all between zero and one at every timestep, thereby easing their interpretation as probability values (cf. below image; [source](https://www.linkedin.com/in/cameron-r-wolfe-ph-d-04744a238/)).\n    \n\nLLMs produce class probabilities with logit vector zz\\\\mathbf{z} where z\\=(z1,…,zn)z\\=(z1,…,zn)\\\\mathbf{z}=\\\\left(z\\_{1}, \\\\ldots, z\\_{n}\\\\right) by performing the softmax function to produce probability vector q\\=(q1,…,qn)q\\=(q1,…,qn)\\\\mathbf{q}=\\\\left(q\\_{1}, \\\\ldots, q\\_{n}\\\\right) by comparing ziziz\\_{i} with with the other logits.\n\nThe softmax function normalizes the candidates at each iteration of the network based on their exponential values by ensuring the network outputs are all between zero and one at every timestep, thereby easing their interpretation as probability values (cf. below image; [source](https://www.linkedin.com/in/cameron-r-wolfe-ph-d-04744a238/)).\n\n![](/primers/ai/assets/token-sampling/Softmax.jpg)",
    "contentLength": 32691,
    "wordCount": 156,
    "hasCode": false,
    "hasMath": true,
    "hasImages": true,
    "url": "https://aman.ai/primers/ai/token-sampling/#logits-and-softmax"
  },
  {
    "id": "ai-token-sampling-the-role-of-temperature-in-softmax-4",
    "articleSlug": "token-sampling",
    "articleTitle": "Token Sampling Methods",
    "category": "Algorithms/Architecture",
    "chapter": "Related: Temperature",
    "title": "The Role of Temperature in Softmax",
    "order": 4,
    "orderInChapter": 1,
    "contentHtml": "<ul>\n  <li>\n    <p>The “vanilla” softmax function in the <a href=\"#logits-and-softmax\">Logits and Softmax</a> section incorporates the temperature hyperparameter <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-119\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-120\"><span class=\"mi\" id=\"MathJax-Span-121\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>T</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-14\">T</script> as follows:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>=</mo><mfrac><mfrac><mrow><mi>exp</mi><mo>&amp;#x2061;</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></mrow><mi>T</mi></mfrac><mrow><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></munder><mfrac><mrow><mi>exp</mi><mo>&amp;#x2061;</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></msub></mrow><mi>T</mi></mfrac></mrow></mfrac></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-122\" style=\"width: 6.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.315em, 1005.78em, 3.701em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-123\"><span class=\"msubsup\" id=\"MathJax-Span-124\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-125\" style=\"font-family: STIXGeneral-Italic;\">q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-126\"><span class=\"mrow\" id=\"MathJax-Span-127\"><span class=\"mi\" id=\"MathJax-Span-128\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-129\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-130\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.596em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(2.971em, 1002.09em, 4.534em, -999.997em); top: -4.841em; left: 50%; margin-left: -1.039em;\"><span class=\"mfrac\" id=\"MathJax-Span-131\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.544em, 1001.72em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -0.831em;\"><span class=\"mrow\" id=\"MathJax-Span-132\"><span class=\"mi\" id=\"MathJax-Span-133\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">exp</span><span class=\"mo\" id=\"MathJax-Span-134\" style=\"font-size: 70.7%;\"></span><span class=\"msubsup\" id=\"MathJax-Span-135\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.221em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-136\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-137\"><span class=\"mrow\" id=\"MathJax-Span-138\"><span class=\"mi\" id=\"MathJax-Span-139\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.47em, 4.169em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.206em;\"><span class=\"mi\" id=\"MathJax-Span-140\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1001.83em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.826em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(2.919em, 1003.44em, 4.638em, -999.997em); top: -3.07em; left: 50%; margin-left: -1.716em;\"><span class=\"mrow\" id=\"MathJax-Span-141\"><span class=\"munderover\" id=\"MathJax-Span-142\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-143\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-144\"><span class=\"mrow\" id=\"MathJax-Span-145\"><span class=\"mi\" id=\"MathJax-Span-146\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mfrac\" id=\"MathJax-Span-147\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.544em, 1001.72em, 4.378em, -999.997em); top: -4.633em; left: 50%; margin-left: -0.831em;\"><span class=\"mrow\" id=\"MathJax-Span-148\"><span class=\"mi\" id=\"MathJax-Span-149\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">exp</span><span class=\"mo\" id=\"MathJax-Span-150\" style=\"font-size: 70.7%;\"></span><span class=\"msubsup\" id=\"MathJax-Span-151\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.221em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-152\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">z</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-153\"><span class=\"mrow\" id=\"MathJax-Span-154\"><span class=\"mi\" id=\"MathJax-Span-155\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.47em, 4.169em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.206em;\"><span class=\"mi\" id=\"MathJax-Span-156\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1001.83em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.826em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.6em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.596em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.684em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi></mrow></msub><mo>=</mo><mfrac><mfrac><mrow><mi>exp</mi><mo>⁡</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi></mrow></msub></mrow><mi>T</mi></mfrac><mrow><munder><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi></mrow></munder><mfrac><mrow><mi>exp</mi><mo>⁡</mo><msub><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi></mrow></msub></mrow><mi>T</mi></mfrac></mrow></mfrac></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-15\">q_{i}=\\frac{\\frac{\\exp z_{i}}{T}}{\\sum_{j} \\frac{\\exp z_{j}}{T}}</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-157\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-158\"><span class=\"mi\" id=\"MathJax-Span-159\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>T</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">T</script> is the temperature parameter (set to 1 by default).</li>\n    </ul>\n  </li>\n  <li>\n    <p>When the temperature is 1, we compute the softmax directly on the logits (the unscaled output of earlier layers). Using a temperature of 0.6, the model computes the softmax on <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mtext>logits</mtext><mn>0.6</mn></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-160\" style=\"width: 2.294em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.94em, 1001.88em, 2.711em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-161\"><span class=\"mfrac\" id=\"MathJax-Span-162\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.57em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -0.779em;\"><span class=\"mtext\" id=\"MathJax-Span-163\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">logits</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.169em, -999.997em); top: -3.591em; left: 50%; margin-left: -0.414em;\"><span class=\"mn\" id=\"MathJax-Span-164\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0.6</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1001.67em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.669em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mfrac><mtext>logits</mtext><mn>0.6</mn></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-17\">\\frac{\\text {logits}}{0.6}</script>, resulting in a larger value. Performing softmax on larger values makes the model more <strong>confident</strong> (less input is needed to activate the output layer) but also more <strong>conservative</strong> in its samples (it is less likely to sample from unlikely candidates).</p>\n  </li>\n</ul>\n<p>The “vanilla” softmax function in the <a href=\"#logits-and-softmax\">Logits and Softmax</a> section incorporates the temperature hyperparameter <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-119\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-120\"><span class=\"mi\" id=\"MathJax-Span-121\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>T</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-14\">T</script> as follows:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-157\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.68em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-158\"><span class=\"mi\" id=\"MathJax-Span-159\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>T</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">T</script> is the temperature parameter (set to 1 by default).</li>\n    </ul>\n<p>When the temperature is 1, we compute the softmax directly on the logits (the unscaled output of earlier layers). Using a temperature of 0.6, the model computes the softmax on <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mtext>logits</mtext><mn>0.6</mn></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-160\" style=\"width: 2.294em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.94em, 1001.88em, 2.711em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-161\"><span class=\"mfrac\" id=\"MathJax-Span-162\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.57em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -0.779em;\"><span class=\"mtext\" id=\"MathJax-Span-163\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">logits</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.169em, -999.997em); top: -3.591em; left: 50%; margin-left: -0.414em;\"><span class=\"mn\" id=\"MathJax-Span-164\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0.6</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1001.67em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.669em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mfrac><mtext>logits</mtext><mn>0.6</mn></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-17\">\\frac{\\text {logits}}{0.6}</script>, resulting in a larger value. Performing softmax on larger values makes the model more <strong>confident</strong> (less input is needed to activate the output layer) but also more <strong>conservative</strong> in its samples (it is less likely to sample from unlikely candidates).</p>",
    "contentMarkdown": "*   The “vanilla” softmax function in the [Logits and Softmax](#logits-and-softmax) section incorporates the temperature hyperparameter TTT as follows:\n    \n    qi\\=expziT∑jexpzjTqi\\=exp⁡ziT∑jexp⁡zjT\n    \n    q\\_{i}=\\\\frac{\\\\frac{\\\\exp z\\_{i}}{T}}{\\\\sum\\_{j} \\\\frac{\\\\exp z\\_{j}}{T}}\n    *   where TTT is the temperature parameter (set to 1 by default).\n*   When the temperature is 1, we compute the softmax directly on the logits (the unscaled output of earlier layers). Using a temperature of 0.6, the model computes the softmax on logits0.6logits0.6\\\\frac{\\\\text {logits}}{0.6}, resulting in a larger value. Performing softmax on larger values makes the model more **confident** (less input is needed to activate the output layer) but also more **conservative** in its samples (it is less likely to sample from unlikely candidates).\n    \n\nThe “vanilla” softmax function in the [Logits and Softmax](#logits-and-softmax) section incorporates the temperature hyperparameter TTT as follows:\n\n*   where TTT is the temperature parameter (set to 1 by default).\n\nWhen the temperature is 1, we compute the softmax directly on the logits (the unscaled output of earlier layers). Using a temperature of 0.6, the model computes the softmax on logits0.6logits0.6\\\\frac{\\\\text {logits}}{0.6}, resulting in a larger value. Performing softmax on larger values makes the model more **confident** (less input is needed to activate the output layer) but also more **conservative** in its samples (it is less likely to sample from unlikely candidates).",
    "contentLength": 20865,
    "wordCount": 209,
    "hasCode": false,
    "hasMath": true,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/token-sampling/#the-role-of-temperature-in-softmax"
  },
  {
    "id": "ai-token-sampling-temperature-ranges-and-their-effects-5",
    "articleSlug": "token-sampling",
    "articleTitle": "Token Sampling Methods",
    "category": "Algorithms/Architecture",
    "chapter": "Related: Temperature",
    "title": "Temperature Ranges and Their Effects",
    "order": 5,
    "orderInChapter": 2,
    "contentHtml": "<h4 id=\"low-temperature-t--00---05\">Low Temperature (T ≈ 0.0 - 0.5)</h4>\n<ul>\n  <li><strong>Characteristics</strong>:\n    <ul>\n      <li>Strong preference for high-probability tokens.</li>\n      <li>Results in deterministic outputs and lower randomness.</li>\n      <li>Outputs are often repetitive and lack diversity.</li>\n    </ul>\n  </li>\n  <li><strong>Applications</strong>:\n    <ul>\n      <li>Ideal for scenarios where precision and confidence are critical (e.g., when generating factual text or answers).</li>\n    </ul>\n  </li>\n  <li><strong>Limitations</strong>:\n    <ul>\n      <li>May lead to overly conservative predictions and repetitive loops.</li>\n    </ul>\n  </li>\n</ul>\n<ul>\n      <li>Strong preference for high-probability tokens.</li>\n      <li>Results in deterministic outputs and lower randomness.</li>\n      <li>Outputs are often repetitive and lack diversity.</li>\n    </ul>\n<ul>\n      <li>Ideal for scenarios where precision and confidence are critical (e.g., when generating factual text or answers).</li>\n    </ul>\n<ul>\n      <li>May lead to overly conservative predictions and repetitive loops.</li>\n    </ul>\n<h4 id=\"moderate-temperature-t--06---10\">Moderate Temperature (T ≈ 0.6 - 1.0)</h4>\n<ul>\n  <li><strong>Characteristics</strong>:\n    <ul>\n      <li>Balances diversity and coherence in token sampling.</li>\n      <li>Allows the model to explore less likely candidates without compromising too much on coherence.</li>\n    </ul>\n  </li>\n  <li><strong>Applications</strong>:\n    <ul>\n      <li>Commonly used for generating creative but realistic outputs.</li>\n      <li>Suitable for generating human-like text, code suggestions, or musical compositions.</li>\n    </ul>\n  </li>\n  <li><strong>Limitations</strong>:\n    <ul>\n      <li>May still favor higher-probability tokens, limiting exploration of very unlikely candidates.</li>\n    </ul>\n  </li>\n</ul>\n<ul>\n      <li>Balances diversity and coherence in token sampling.</li>\n      <li>Allows the model to explore less likely candidates without compromising too much on coherence.</li>\n    </ul>\n<ul>\n      <li>Commonly used for generating creative but realistic outputs.</li>\n      <li>Suitable for generating human-like text, code suggestions, or musical compositions.</li>\n    </ul>\n<ul>\n      <li>May still favor higher-probability tokens, limiting exploration of very unlikely candidates.</li>\n    </ul>\n<h4 id=\"high-temperature-t--10\">High Temperature (T &gt; 1.0)</h4>\n<ul>\n  <li><strong>Characteristics</strong>:\n    <ul>\n      <li>Produces a softer probability distribution over classes.</li>\n      <li>Results in more diverse and random outputs by increasing sensitivity to low-probability candidates.</li>\n      <li>Allows the RNN to escape repetitive loops and explore a wider range of token possibilities.</li>\n    </ul>\n  </li>\n  <li><strong>Applications</strong>:\n    <ul>\n      <li>Useful for brainstorming ideas or generating highly creative content.</li>\n      <li>Enables exploration of unconventional outputs in art, music, or storytelling tasks.</li>\n    </ul>\n  </li>\n  <li><strong>Limitations</strong>:\n    <ul>\n      <li>Leads to more mistakes and incoherent outputs.</li>\n      <li>Increases the likelihood of selecting improbable candidates, which might not always align with the desired result.</li>\n    </ul>\n  </li>\n</ul>\n<ul>\n      <li>Produces a softer probability distribution over classes.</li>\n      <li>Results in more diverse and random outputs by increasing sensitivity to low-probability candidates.</li>\n      <li>Allows the RNN to escape repetitive loops and explore a wider range of token possibilities.</li>\n    </ul>\n<ul>\n      <li>Useful for brainstorming ideas or generating highly creative content.</li>\n      <li>Enables exploration of unconventional outputs in art, music, or storytelling tasks.</li>\n    </ul>\n<ul>\n      <li>Leads to more mistakes and incoherent outputs.</li>\n      <li>Increases the likelihood of selecting improbable candidates, which might not always align with the desired result.</li>\n    </ul>",
    "contentMarkdown": "#### Low Temperature (T ≈ 0.0 - 0.5)\n\n*   **Characteristics**:\n    *   Strong preference for high-probability tokens.\n    *   Results in deterministic outputs and lower randomness.\n    *   Outputs are often repetitive and lack diversity.\n*   **Applications**:\n    *   Ideal for scenarios where precision and confidence are critical (e.g., when generating factual text or answers).\n*   **Limitations**:\n    *   May lead to overly conservative predictions and repetitive loops.\n\n*   Strong preference for high-probability tokens.\n*   Results in deterministic outputs and lower randomness.\n*   Outputs are often repetitive and lack diversity.\n\n*   Ideal for scenarios where precision and confidence are critical (e.g., when generating factual text or answers).\n\n*   May lead to overly conservative predictions and repetitive loops.\n\n#### Moderate Temperature (T ≈ 0.6 - 1.0)\n\n*   **Characteristics**:\n    *   Balances diversity and coherence in token sampling.\n    *   Allows the model to explore less likely candidates without compromising too much on coherence.\n*   **Applications**:\n    *   Commonly used for generating creative but realistic outputs.\n    *   Suitable for generating human-like text, code suggestions, or musical compositions.\n*   **Limitations**:\n    *   May still favor higher-probability tokens, limiting exploration of very unlikely candidates.\n\n*   Balances diversity and coherence in token sampling.\n*   Allows the model to explore less likely candidates without compromising too much on coherence.\n\n*   Commonly used for generating creative but realistic outputs.\n*   Suitable for generating human-like text, code suggestions, or musical compositions.\n\n*   May still favor higher-probability tokens, limiting exploration of very unlikely candidates.\n\n#### High Temperature (T > 1.0)\n\n*   **Characteristics**:\n    *   Produces a softer probability distribution over classes.\n    *   Results in more diverse and random outputs by increasing sensitivity to low-probability candidates.\n    *   Allows the RNN to escape repetitive loops and explore a wider range of token possibilities.\n*   **Applications**:\n    *   Useful for brainstorming ideas or generating highly creative content.\n    *   Enables exploration of unconventional outputs in art, music, or storytelling tasks.\n*   **Limitations**:\n    *   Leads to more mistakes and incoherent outputs.\n    *   Increases the likelihood of selecting improbable candidates, which might not always align with the desired result.\n\n*   Produces a softer probability distribution over classes.\n*   Results in more diverse and random outputs by increasing sensitivity to low-probability candidates.\n*   Allows the RNN to escape repetitive loops and explore a wider range of token possibilities.\n\n*   Useful for brainstorming ideas or generating highly creative content.\n*   Enables exploration of unconventional outputs in art, music, or storytelling tasks.\n\n*   Leads to more mistakes and incoherent outputs.\n*   Increases the likelihood of selecting improbable candidates, which might not always align with the desired result.",
    "contentLength": 4042,
    "wordCount": 418,
    "hasCode": false,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/token-sampling/#temperature-ranges-and-their-effects"
  },
  {
    "id": "ai-token-sampling-insights-from-the-softmax-function-6",
    "articleSlug": "token-sampling",
    "articleTitle": "Token Sampling Methods",
    "category": "Algorithms/Architecture",
    "chapter": "Related: Temperature",
    "title": "Insights from the Softmax Function",
    "order": 6,
    "orderInChapter": 3,
    "contentHtml": "<ul>\n  <li>From the <a href=\"https://en.wikipedia.org/wiki/Softmax_function\">Wikipedia article on softmax function</a>:</li>\n</ul>\n<blockquote>\n  <p>For high temperatures <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C4;</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-165\" style=\"width: 3.799em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.15em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.391em, 1003.06em, 2.549em, -999.998em); top: -2.22em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-166\"><span class=\"mo\" id=\"MathJax-Span-167\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-168\" style=\"font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.002em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-169\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.326em;\">→</span><span class=\"mi\" id=\"MathJax-Span-170\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.326em;\">∞</span></span><span style=\"display: inline-block; width: 0px; height: 2.225em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.114em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>τ</mi><mo stretchy=\"false\">→</mo><mi mathvariant=\"normal\">∞</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">(\\tau \\rightarrow \\infty</script>), all samples have nearly the same probability, and the lower the temperature, the more expected rewards affect the probability. For a low temperature <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>(</mo><mrow><mi>&amp;#x03C4;</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msup><mn>0</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>+</mo></mrow></msup></mrow><mo>)</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-171\" style=\"width: 4.956em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.123em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.947em, 1003.98em, 3.475em, -999.998em); top: -2.961em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-172\"><span class=\"mrow\" id=\"MathJax-Span-173\"><span class=\"mo\" id=\"MathJax-Span-174\" style=\"vertical-align: -0.183em;\"><span style=\"font-family: STIXSizeOneSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-175\"><span class=\"mi\" id=\"MathJax-Span-176\" style=\"font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.002em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-177\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.326em;\">→</span><span class=\"msubsup\" id=\"MathJax-Span-178\" style=\"padding-left: 0.326em;\"><span style=\"display: inline-block; position: relative; width: 1.067em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.15em, 1000.47em, 4.123em, -999.998em); top: -3.979em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-179\" style=\"font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 3.984em;\"></span></span><span style=\"position: absolute; top: -4.396em; left: 0.512em;\"><span class=\"texatom\" id=\"MathJax-Span-180\"><span class=\"mrow\" id=\"MathJax-Span-181\"><span class=\"mo\" id=\"MathJax-Span-182\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span></span></span><span style=\"display: inline-block; width: 0px; height: 3.984em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-183\" style=\"vertical-align: -0.183em;\"><span style=\"font-family: STIXSizeOneSym;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.965em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.614em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow><mo>(</mo><mrow><mi>τ</mi><mo stretchy=\"false\">→</mo><msup><mn>0</mn><mrow class=\"MJX-TeXAtom-ORD\"><mo>+</mo></mrow></msup></mrow><mo>)</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">\\left(\\tau \\rightarrow 0^{+}\\right)</script>, the probability of the sample with the highest expected reward tends to 1.</p>\n</blockquote>\n<p>For high temperatures <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C4;</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-165\" style=\"width: 3.799em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.15em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.391em, 1003.06em, 2.549em, -999.998em); top: -2.22em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-166\"><span class=\"mo\" id=\"MathJax-Span-167\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-168\" style=\"font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.002em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-169\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.326em;\">→</span><span class=\"mi\" id=\"MathJax-Span-170\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.326em;\">∞</span></span><span style=\"display: inline-block; width: 0px; height: 2.225em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.114em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>τ</mi><mo stretchy=\"false\">→</mo><mi mathvariant=\"normal\">∞</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">(\\tau \\rightarrow \\infty</script>), all samples have nearly the same probability, and the lower the temperature, the more expected rewards affect the probability. For a low temperature <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>(</mo><mrow><mi>&amp;#x03C4;</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msup><mn>0</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>+</mo></mrow></msup></mrow><mo>)</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-171\" style=\"width: 4.956em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.123em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.947em, 1003.98em, 3.475em, -999.998em); top: -2.961em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-172\"><span class=\"mrow\" id=\"MathJax-Span-173\"><span class=\"mo\" id=\"MathJax-Span-174\" style=\"vertical-align: -0.183em;\"><span style=\"font-family: STIXSizeOneSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-175\"><span class=\"mi\" id=\"MathJax-Span-176\" style=\"font-family: STIXGeneral-Italic;\">τ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.002em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-177\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.326em;\">→</span><span class=\"msubsup\" id=\"MathJax-Span-178\" style=\"padding-left: 0.326em;\"><span style=\"display: inline-block; position: relative; width: 1.067em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.15em, 1000.47em, 4.123em, -999.998em); top: -3.979em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-179\" style=\"font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 3.984em;\"></span></span><span style=\"position: absolute; top: -4.396em; left: 0.512em;\"><span class=\"texatom\" id=\"MathJax-Span-180\"><span class=\"mrow\" id=\"MathJax-Span-181\"><span class=\"mo\" id=\"MathJax-Span-182\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span></span></span><span style=\"display: inline-block; width: 0px; height: 3.984em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-183\" style=\"vertical-align: -0.183em;\"><span style=\"font-family: STIXSizeOneSym;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.965em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.614em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow><mo>(</mo><mrow><mi>τ</mi><mo stretchy=\"false\">→</mo><msup><mn>0</mn><mrow class=\"MJX-TeXAtom-ORD\"><mo>+</mo></mrow></msup></mrow><mo>)</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">\\left(\\tau \\rightarrow 0^{+}\\right)</script>, the probability of the sample with the highest expected reward tends to 1.</p>",
    "contentMarkdown": "*   From the [Wikipedia article on softmax function](https://en.wikipedia.org/wiki/Softmax_function):\n\n> For high temperatures (τ→∞(τ→∞(\\\\tau \\\\rightarrow \\\\infty), all samples have nearly the same probability, and the lower the temperature, the more expected rewards affect the probability. For a low temperature (τ→0+)(τ→0+)\\\\left(\\\\tau \\\\rightarrow 0^{+}\\\\right), the probability of the sample with the highest expected reward tends to 1.\n\nFor high temperatures (τ→∞(τ→∞(\\\\tau \\\\rightarrow \\\\infty), all samples have nearly the same probability, and the lower the temperature, the more expected rewards affect the probability. For a low temperature (τ→0+)(τ→0+)\\\\left(\\\\tau \\\\rightarrow 0^{+}\\\\right), the probability of the sample with the highest expected reward tends to 1.",
    "contentLength": 10169,
    "wordCount": 99,
    "hasCode": false,
    "hasMath": true,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/token-sampling/#insights-from-the-softmax-function"
  },
  {
    "id": "ai-token-sampling-summary-of-temperatures-impact-7",
    "articleSlug": "token-sampling",
    "articleTitle": "Token Sampling Methods",
    "category": "Algorithms/Architecture",
    "chapter": "Related: Temperature",
    "title": "Summary of Temperature’s Impact",
    "order": 7,
    "orderInChapter": 4,
    "contentHtml": "<ul>\n  <li>A lower temperature makes the model more confident and conservative, ideal for deterministic outputs.</li>\n  <li>A moderate temperature strikes a balance between randomness and coherence.</li>\n  <li>A higher temperature increases randomness and diversity but may lead to mistakes.</li>\n  <li>Adjusting the temperature allows fine-tuning the model’s behavior depending on the task, enhancing the versatility of language models in diverse applications.</li>\n</ul>",
    "contentMarkdown": "*   A lower temperature makes the model more confident and conservative, ideal for deterministic outputs.\n*   A moderate temperature strikes a balance between randomness and coherence.\n*   A higher temperature increases randomness and diversity but may lead to mistakes.\n*   Adjusting the temperature allows fine-tuning the model’s behavior depending on the task, enhancing the versatility of language models in diverse applications.",
    "contentLength": 472,
    "wordCount": 61,
    "hasCode": false,
    "hasMath": false,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/token-sampling/#summary-of-temperature’s-impact"
  },
  {
    "id": "ai-token-sampling-banking-8",
    "articleSlug": "token-sampling",
    "articleTitle": "Token Sampling Methods",
    "category": "Algorithms/Architecture",
    "chapter": "Constrained Beam Search",
    "title": "Banking",
    "order": 8,
    "orderInChapter": 1,
    "contentHtml": "<ul>\n  <li>Now a practical next question would be, wouldn’t forcing a token create nonsensical outputs? Using banks solves this problem by creating a balance between fulfilling the constraints and creating sensible output, and we can see this illustrated in the figure below <a href=\"https://huggingface.co/blog/constrained-beam-search\">(source)</a>:</li>\n</ul>\n<p><img src=\"/primers/ai/assets/token-sampling/6.png\" alt=\"\"></p>\n<ul>\n  <li>“After sorting all the possible beams into their respective banks, we do a round-robin selection. With the above example, we’d select the most probable output from Bank 2, then most probable from Bank 1, one from Bank 0, the second most probable from Bank 2, the second most probable from Bank 1, and so forth. Assuming we’re using three beams, we just do the above process three times to end up with <code class=\"language-plaintext highlighter-rouge\">[\"The is fast\", \"The dog is\", \"The dog and\"]</code>.” <a href=\"https://huggingface.co/blog/constrained-beam-search\">(source)</a></li>\n  <li>Thus, even though we are forcing tokens on the model, we are still keeping track of other high probable sequences that are likely not nonsensical.</li>\n  <li>The image below <a href=\"https://huggingface.co/blog/constrained-beam-search\">(source)</a> shows the result and all the steps combined.</li>\n</ul>\n<p><img src=\"/primers/ai/assets/token-sampling/7.png\" alt=\"\"></p>",
    "contentMarkdown": "*   Now a practical next question would be, wouldn’t forcing a token create nonsensical outputs? Using banks solves this problem by creating a balance between fulfilling the constraints and creating sensible output, and we can see this illustrated in the figure below [(source)](https://huggingface.co/blog/constrained-beam-search):\n\n![](/primers/ai/assets/token-sampling/6.png)\n\n*   “After sorting all the possible beams into their respective banks, we do a round-robin selection. With the above example, we’d select the most probable output from Bank 2, then most probable from Bank 1, one from Bank 0, the second most probable from Bank 2, the second most probable from Bank 1, and so forth. Assuming we’re using three beams, we just do the above process three times to end up with `[\"The is fast\", \"The dog is\", \"The dog and\"]`.” [(source)](https://huggingface.co/blog/constrained-beam-search)\n*   Thus, even though we are forcing tokens on the model, we are still keeping track of other high probable sequences that are likely not nonsensical.\n*   The image below [(source)](https://huggingface.co/blog/constrained-beam-search) shows the result and all the steps combined.\n\n![](/primers/ai/assets/token-sampling/7.png)",
    "contentLength": 1401,
    "wordCount": 167,
    "hasCode": true,
    "hasMath": false,
    "hasImages": true,
    "url": "https://aman.ai/primers/ai/token-sampling/#banking"
  },
  {
    "id": "ai-token-sampling-how-is-nucleus-sampling-useful-9",
    "articleSlug": "token-sampling",
    "articleTitle": "Token Sampling Methods",
    "category": "Algorithms/Architecture",
    "chapter": "Top-ppp (nucleus Sampling)",
    "title": "How is Nucleus Sampling Useful?",
    "order": 9,
    "orderInChapter": 1,
    "contentHtml": "<ul>\n  <li>Top-<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-60-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-325\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-326\"><span class=\"mi\" id=\"MathJax-Span-327\" style=\"font-family: STIXGeneral-Italic;\">p</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>p</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-60\">p</script> is more suitable for tasks that require more fine-grained control over the diversity and fluency of the output, such as language modeling and text summarization. However, in reality, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-61-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-328\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-329\"><span class=\"mi\" id=\"MathJax-Span-330\" style=\"font-family: STIXGeneral-Italic;\">p</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>p</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-61\">p</script> is actually set a lot higher (about 75%) to limit the long tail of low probability tokens that may have been sampled.</li>\n  <li>Furthermore, consider a case where a single token has a very high probability (i.e., larger than top-<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-62-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-331\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-332\"><span class=\"mi\" id=\"MathJax-Span-333\" style=\"font-family: STIXGeneral-Italic;\">p</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>p</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-62\">p</script>). In this case, nucleus sampling will always sample this token. Alternatively, assigning more uniform probability across tokens may cause a larger number of tokens to be considered during decoding. Put simply, nucleus sampling can dynamically adjust the number of tokens that are considered during decoding based on their probabilities.</li>\n  <li>Additionally top-<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-63-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-334\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-335\"><span class=\"mi\" id=\"MathJax-Span-336\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-63\">k</script> and top-<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-64-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-337\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-338\"><span class=\"mi\" id=\"MathJax-Span-339\" style=\"font-family: STIXGeneral-Italic;\">p</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>p</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-64\">p</script> can work simultaneously, but <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-65-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-340\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-341\"><span class=\"mi\" id=\"MathJax-Span-342\" style=\"font-family: STIXGeneral-Italic;\">p</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>p</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-65\">p</script> will always come after <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-66-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-343\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-344\"><span class=\"mi\" id=\"MathJax-Span-345\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-66\">k</script>.</li>\n</ul>",
    "contentMarkdown": "*   Top-ppp is more suitable for tasks that require more fine-grained control over the diversity and fluency of the output, such as language modeling and text summarization. However, in reality, ppp is actually set a lot higher (about 75%) to limit the long tail of low probability tokens that may have been sampled.\n*   Furthermore, consider a case where a single token has a very high probability (i.e., larger than top-ppp). In this case, nucleus sampling will always sample this token. Alternatively, assigning more uniform probability across tokens may cause a larger number of tokens to be considered during decoding. Put simply, nucleus sampling can dynamically adjust the number of tokens that are considered during decoding based on their probabilities.\n*   Additionally top-kkk and top-ppp can work simultaneously, but ppp will always come after kkk.",
    "contentLength": 9306,
    "wordCount": 135,
    "hasCode": false,
    "hasMath": true,
    "hasImages": false,
    "url": "https://aman.ai/primers/ai/token-sampling/#how-is-nucleus-sampling-useful?"
  },
  {
    "id": "ai-token-sampling-nucleus-sampling-vs-temperature-10",
    "articleSlug": "token-sampling",
    "articleTitle": "Token Sampling Methods",
    "category": "Algorithms/Architecture",
    "chapter": "Top-ppp (nucleus Sampling)",
    "title": "Nucleus Sampling V/s Temperature",
    "order": 10,
    "orderInChapter": 2,
    "contentHtml": "<ul>\n  <li>Based on OpenAI’s GPT-3 <a href=\"https://platform.openai.com/docs/introduction\">API</a> below, we should only use either nucleus sampling or temperature and that these parameters cannot be used in tandem. Put simply, these are different and disjoint methods of controlling the randomness of a language model’s output.</li>\n</ul>\n<p><img src=\"/primers/ai/assets/token-sampling/API.jpg\" alt=\"\"></p>",
    "contentMarkdown": "*   Based on OpenAI’s GPT-3 [API](https://platform.openai.com/docs/introduction) below, we should only use either nucleus sampling or temperature and that these parameters cannot be used in tandem. Put simply, these are different and disjoint methods of controlling the randomness of a language model’s output.\n\n![](/primers/ai/assets/token-sampling/API.jpg)",
    "contentLength": 407,
    "wordCount": 43,
    "hasCode": false,
    "hasMath": false,
    "hasImages": true,
    "url": "https://aman.ai/primers/ai/token-sampling/#nucleus-sampling-v/s-temperature"
  }
]